@&#MAIN-TITLE@&#Continuous multifacility ordered median location problems

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           New models for continuous multifacility location with any ℓ
                                 p
                               norm are presented.


                        
                        
                           
                           For multiple allocation problems we provide SOCP formulations.


                        
                        
                           
                           For single allocation problem, the formulation becomes a MISOCO problem.


                        
                        
                           
                           Alternatively, a hierarchy of SDP problems converging to the optimal solution is given.


                        
                        
                           
                           Some computational results with the presented models are reported.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Continuous multifacility location

Ordered median problems

Semidefinite programming

Second order cone programming

@&#ABSTRACT@&#


               
               
                  In this paper we propose a general methodology for solving a broad class of continuous, multifacility location problems, in any dimension and with ℓ
                        τ
                     -norms proposing two different methodologies: (1) by a new second order cone mixed integer programming formulation and (2) by formulating a sequence of semidefinite programs that converges to the solution of the problem; each of these relaxed problems solvable with SDP solvers in polynomial time.
               
            

@&#INTRODUCTION@&#

Multifacility location problems are among the most interesting and difficult problems in Location Analysis. It is well-known that even in their discrete version the p-median and p-center problems are already NP-hard (see Kariv and Hakimi, 1979.) A lot of attention has been paid in the last decades to these classes of problems, namely location-allocation problems, since they are easy to describe and to understand and they still capture the essence of difficult problems in combinatorial optimization. A comprehensive overview over existing models and their applications is given by Drezner and Hamacher (2002) and the references therein.

On the other hand, also in the last two decades locators have devoted much effort to solve continuous location problems that fall within the general class of global optimization, i.e. convexity properties are lost. Given a set of demand points (existing facilities) the goal is to locate several facilities to provide service to the existing ones (demand points) minimizing some globalizing function of the travel distances. Assuming that each demand point will be served by its closest facility we are faced with another location-allocation problem but now the new facilities can be located anywhere in the framework space and therefore they are not confined to be in an “a priori” given set of locations. These problems are much harder than the discrete ones and not much has been obtained regarding algorithms, and general convergence results, although some exceptions can be found in the literature (see Albareda, Hinojosa, and Puerto, 2015; Brimberg, Drezner, Mladenović, and Salhi, 2014; Brimberg, Hansen, Mladenovic, and Taillard, 2000; Michelot, 1987 and the references therein).

Since the 1990s a new family of objective functions has started to be considered in the area of Location Analysis: the ordered median problem (Nickel & Puerto, 2005). Ordered median problems represent as special cases nearly all classical objective functions in location theory, including the Median, CentDian, Center and k-Centra. Hence, handling the most important objective functions in Location Analysis is possible with one unique model and also new ones may be created by adapting the parameters adequately. More precisely, the p-facility ordered median problem can be formulated as follows: a vector of weights 
                        
                           (
                           
                              λ
                              1
                           
                           ,
                           …
                           ,
                           
                              λ
                              n
                           
                           )
                        
                      is given. The problem is to find locations for the facilities that minimize the weighted sum of distances to the facilities where the distance to the closest point to its allocated facility is multiplied by the weight λn
                     , the distance to the second closest, by 
                        
                           
                              λ
                              
                                 n
                                 −
                                 1
                              
                           
                           ,
                        
                      and so on. The distance to the farthest point is multiplied by λ
                     1. As mentioned above, many location problems can be formulated as the ordered 1-median problem by selecting appropriate weights. For example, the vector for which all 
                        
                           
                              λ
                              i
                           
                           =
                           1
                        
                      is the p-median problem, the problem where 
                        
                           
                              λ
                              1
                           
                           =
                           1
                        
                      and all others are equal to zero is the p-center problem, the problem where 
                        
                           
                              λ
                              1
                           
                           =
                           …
                           =
                           
                              λ
                              k
                           
                           =
                           1
                        
                      and all others are equal to zero is the p-k-centrum. Minimizing the range of distances is achieved by 
                        
                           
                              λ
                              1
                           
                           =
                           1
                           ,
                        
                     
                     
                        
                           
                              λ
                              n
                           
                           =
                           −
                           1
                        
                      and all others are zero. Lots of results have been obtained for these problems in discrete settings, on networks and even in the continuous single facility case (see the book Nickel and Puerto, 2005 and the recent papers Blanco, El-Haj Ben-Ali, and Puerto, 2013; Boland, Dominguez-Marin, Nickel, and Puerto, 2006; Kalcsics, Nickel, Puerto, and Rodríguez-Chía, 2010; Marín, Nickel, Puerto, and Velten, 2009; Puerto, D. Pérez-Brito, and Garcia-González, 2014; Puerto and Rodriguez-Chia, 2011). However, very little is known in the continuous multifacility counterpart (Kalcsics, Nickel, Pozo, Puerto, & Rodriguez-Chia, 2014).

In this paper, we address the multifacility continuous ordered median problem in finite dimension d and for general ℓ
                        τ
                     -norm for measuring the distances between points. We show how these problems can be cast within a general family of polynomial optimization problems. Then, we show how these problems can be formulated as mixed integer second order cone programs or, using tools borrowed from the Theory of Moments (Lasserre, 2009b), they can be solved (approximated up to any degree of accuracy) by a series of relaxed problems, each one of them is a SDP, polynomially solvable. We report some computational results on a battery of problems solved with the presented models.

In this section we recall the main definitions and results on Semidefinite Programming and the Theory of Moments that will be useful for the development through this paper. We use standard notation in those fields (see e.g. Lasserre, 2009b; Wolkowicz, Saigal, & Vandenberghe, 2000).

Semidefinite programming (SDP) is relatively a new subfield of convex optimization and probably one of the most exciting development in mathematical programming. SDP is a particular case of conic programming when one considers the convex cone of positive semidefinite matrices, whereas linear programming considers the positive orthant, a polyhedral convex cone. This class of problems theoretically includes a large number of convex programming models such as convex quadratic programming (QP), or second-order cone programming (SOCP). Moreover, semidefinite programming has experienced a great growth during the 1990s, as a consequence of the adaptation of some polynomial time interior point methods firstly developed for linear optimization to solve SDP. SDP duality is not always strong because of the nonlinear positive semidefinite constraint. To avoid duality gaps, we can require the problem and its dual to satisfy some constraint qualification. The purpose of a constraint qualification is to ensure the existence of Lagrange multipliers at optimality in nonlinear problems. These multipliers are an optimal solution for the dual problem, and thus the constraint qualification ensures that strong duality holds: it is possible to achieve primal and dual feasibility with no duality gap. One common choice of constraint qualification is Slater’s constraint qualification (Boyd & Vanderberghe, 2004). The handbooks (Anjos & Lasserre, 2012) and (Wolkowicz et al., 2000) provide excellent coverage of SDP as well as extensive bibliographic reviews of the literature up to the year 2012.

On the other hand, the Theory of Moments is a powerful technique that can be applied to approximate hard global optimization problems (Lasserre, 2009b). It can be used to construct hierarchies of approximate problems whose optimal values converge to the optimal value of the multifacility location problems considered in this paper. For this reason next we describe its basic elements. We denote by 
                        
                           R
                           [
                           x
                           ]
                        
                      the ring of real polynomials in the variables 
                        
                           x
                           =
                           (
                           
                              x
                              1
                           
                           ,
                           …
                           ,
                           
                              x
                              d
                           
                           )
                           ,
                        
                      for 
                        
                           d
                           ∈
                           N
                        
                      (d ≥ 1), and by 
                        
                           R
                           
                              
                                 [
                                 x
                                 ]
                              
                              r
                           
                           ⊂
                           R
                           
                              [
                              x
                              ]
                           
                        
                      the vector space of polynomials of degree at most 
                        
                           r
                           ∈
                           N
                        
                      (here 
                        N
                      denotes the set of non-negative integers). We also denote by 
                        
                           B
                           =
                           {
                           
                              x
                              α
                           
                           :
                           α
                           ∈
                           
                              N
                              d
                           
                           }
                        
                      a canonical basis of monomials for 
                        
                           R
                           [
                           x
                           ]
                           ,
                        
                      where 
                        
                           
                              x
                              α
                           
                           =
                           
                              x
                              1
                              
                                 α
                                 1
                              
                           
                           ⋯
                           
                              x
                              d
                              
                                 α
                                 d
                              
                           
                           ,
                        
                      for any 
                        
                           α
                           ∈
                           
                              N
                              d
                           
                        
                     . Note that 
                        
                           
                              B
                              r
                           
                           =
                           
                              {
                              
                                 x
                                 α
                              
                              ∈
                              B
                              :
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 d
                              
                              
                                 α
                                 i
                              
                              ≤
                              r
                              }
                           
                        
                      is a basis for 
                        
                           R
                           
                              
                                 [
                                 x
                                 ]
                              
                              r
                           
                        
                     .

For any sequence indexed in the canonical monomial basis 
                        
                           B
                           ,
                        
                     
                     
                        
                           y
                           =
                           
                              
                                 (
                                 
                                    y
                                    α
                                 
                                 )
                              
                              
                                 α
                                 ∈
                                 
                                    N
                                    d
                                 
                              
                           
                           ⊂
                           R
                           ,
                        
                      let 
                        
                           
                              
                                 L
                              
                              y
                           
                           :
                           R
                           
                              [
                              x
                              ]
                           
                           →
                           R
                        
                      be the linear functional defined, for any 
                        
                           f
                           =
                           
                              ∑
                              
                                 α
                                 ∈
                                 
                                    N
                                    d
                                 
                              
                           
                           
                              f
                              α
                           
                           
                           
                              x
                              α
                           
                           ∈
                           R
                           
                              [
                              x
                              ]
                           
                           ,
                        
                      as 
                        
                           
                              
                                 L
                              
                              y
                           
                           
                              (
                              f
                              )
                           
                           :
                           =
                           
                              ∑
                              
                                 α
                                 ∈
                                 
                                    N
                                    d
                                 
                              
                           
                           
                              f
                              α
                           
                           
                           
                              y
                              α
                           
                        
                     .

The moment matrix M
                        r
                     (y) of order r associated with y, has its rows and columns indexed by the elements in the basis 
                        
                           B
                           =
                           {
                           
                              x
                              α
                           
                           :
                           α
                           ∈
                           
                              N
                              d
                           
                           }
                        
                      and for two elements in such a basis, 
                        
                           
                              b
                              1
                           
                           =
                           
                              x
                              α
                           
                           ,
                           
                              b
                              2
                           
                           =
                           
                              x
                              β
                           
                           ,
                        
                     
                     
                        
                           
                              
                                 M
                              
                              r
                           
                           
                              (
                              y
                              )
                           
                           
                              (
                              
                                 b
                                 1
                              
                              ,
                              
                                 b
                                 2
                              
                              )
                           
                           =
                           
                              
                                 M
                              
                              r
                           
                           
                              (
                              y
                              )
                           
                           
                              (
                              α
                              ,
                              β
                              )
                           
                           
                           :
                           =
                           
                           
                              
                                 L
                              
                              y
                           
                           
                              (
                              
                                 x
                                 
                                    α
                                    +
                                    β
                                 
                              
                              )
                           
                           
                           =
                           
                           
                              y
                              
                                 α
                                 +
                                 β
                              
                           
                           ,
                        
                      for |α|, |β| ≤ r (here |a| stands for the sum of the coordinates of 
                        
                           a
                           ∈
                           
                              N
                              d
                           
                        
                     ). Note that the moment matrix of order r has dimension 
                        
                           
                              (
                              
                                 
                                    d
                                    +
                                    r
                                 
                                 d
                              
                              )
                           
                           ×
                           
                              (
                              
                                 
                                    d
                                    +
                                    r
                                 
                                 d
                              
                              )
                           
                        
                      and that there are 
                        
                           (
                           
                              
                                 d
                                 +
                                 2
                                 r
                              
                              d
                           
                           )
                        
                      
                     y
                     
                        α
                      variables.

For 
                        
                           g
                           ∈
                           R
                           
                              [
                              x
                              ]
                           
                           
                           (
                           =
                           
                              ∑
                              
                                 γ
                                 ∈
                                 
                                    N
                                    d
                                 
                              
                           
                           
                              g
                              γ
                           
                           
                              x
                              γ
                           
                        
                     ), the localizing matrix M
                        r
                     (g
                     y) of order r associated with y and g, has its rows and columns indexed by the elements in 
                        B
                      and for 
                        
                           
                              b
                              1
                           
                           =
                           
                              x
                              α
                           
                           ,
                        
                     
                     
                        
                           
                              b
                              2
                           
                           =
                           
                              x
                              β
                           
                           ,
                        
                     
                     
                        
                           
                              
                                 M
                              
                              r
                           
                           
                              (
                              g
                              y
                              )
                           
                           
                              (
                              
                                 b
                                 1
                              
                              ,
                              
                                 b
                                 2
                              
                              )
                           
                           =
                           
                              
                                 M
                              
                              r
                           
                           
                              (
                              g
                              y
                              )
                           
                           
                              (
                              α
                              ,
                              β
                              )
                           
                           :
                           =
                           
                              
                                 L
                              
                              y
                           
                           
                              (
                              
                                 x
                                 
                                    α
                                    +
                                    β
                                 
                              
                              g
                              
                                 (
                                 x
                                 )
                              
                              )
                           
                           =
                           
                              ∑
                              γ
                           
                           
                              g
                              γ
                           
                           
                              y
                              
                                 γ
                                 +
                                 α
                                 +
                                 β
                              
                           
                           ,
                        
                      for |α|, |β| ≤ r.

Observe that a different choice for the basis of 
                        
                           R
                           [
                           x
                           ]
                           ,
                        
                      instead of the standard monomial basis, would give different moment and localizing matrices useful for instance to derive improvements in the relaxations for structured (symmetric or sparse) problems.

The main assumption to be imposed when one wants to assure convergence of some SDP relaxations for solving polynomial optimization problems is known as the Arquimedean property (see for instance Lasserre, 2009a; 2009b) and it is a consequence of Putinar’s results (Putinar, 1993).

The importance of Archimedean property stems from the link between such a condition with the semidefiniteness of the moment and localizing matrices (see Putinar, 1993). The use of this property for the particular problems that we deal with through this paper will be given in the next sections. A detailed presentation and an account of its implications can be found by Lasserre (2001). In the following we shall use the following convention: for any matrix 
                        
                           A
                           ∈
                           
                              R
                              
                                 n
                                 ×
                                 n
                              
                           
                           ,
                        
                      we denote by A≽0 (resp. A≻0) that the matrix A is positive semidefinite (resp. positive definite).

                        Proposition 1
                        
                           Lasserre (2001)
                        


                        
                           Let
                           
                              
                                 K
                                 :
                                 =
                                 
                                    {
                                    x
                                    ∈
                                    
                                       R
                                       d
                                    
                                    :
                                    
                                       g
                                       j
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    ≥
                                    0
                                    ,
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    m
                                    }
                                 
                                 ⊂
                                 
                                    R
                                    d
                                 
                              
                            
                           satisfy the Archimedean Property and let
                           
                              
                                 p
                                 ∈
                                 R
                                 [
                                 X
                                 ]
                              
                            
                           be a polynomial. Let
                           
                              
                                 r
                                 ≥
                                 
                                    r
                                    0
                                 
                                 :
                                 =
                                 max
                                 
                                    {
                                    
                                       ⌈
                                       deg
                                       
                                          p
                                          2
                                       
                                       ⌉
                                    
                                    ,
                                    
                                       ⌈
                                       deg
                                       
                                          
                                             g
                                             1
                                          
                                          2
                                       
                                       ⌉
                                    
                                    ,
                                    …
                                    ,
                                    
                                       ⌈
                                       deg
                                       
                                          
                                             g
                                             m
                                          
                                          2
                                       
                                       ⌉
                                    
                                    }
                                 
                                 ,
                              
                            
                           and consider the hierarchy of semidefinite relaxations
                           
                              
                                 (1)
                                 
                                    
                                       
                                          Q
                                          r
                                       
                                       :
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      inf
                                                      y
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      y
                                                   
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      r
                                                   
                                                   
                                                      (
                                                      y
                                                      )
                                                   
                                                
                                             
                                             
                                                ⪰
                                             
                                             
                                                
                                                   0
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         r
                                                         −
                                                         ⌈
                                                         deg
                                                         
                                                            g
                                                            j
                                                         
                                                         /
                                                         2
                                                         ⌉
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         g
                                                         j
                                                      
                                                      
                                                      y
                                                      )
                                                   
                                                
                                             
                                             
                                                ⪰
                                             
                                             
                                                
                                                   0
                                                   
                                                   ,
                                                   
                                                   1
                                                   ≤
                                                   j
                                                   ≤
                                                   m
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      y
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         0
                                                      
                                                      )
                                                   
                                                   =
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           with optimal value denoted by infQr.
                        


                           Then, the hierarchy of SDP-relaxations
                           
                              
                                 {
                                 
                                    
                                       (
                                       
                                          Q
                                          r
                                       
                                       )
                                    
                                    
                                       r
                                       ≥
                                       
                                          r
                                          0
                                       
                                    
                                 
                                 }
                              
                            
                           is monotone non-decreasing and converges to ρ
                           * ≔ min 
                              x ∈ K
                           
                           p(x).
                        

SOCP is a particular class of problems that falls within the family of SDP. SOCP refers to convex optimization problems in which a linear function is minimized over the intersection of an affine linear manifold with the Cartesian product of second-order cones. Many applications in engineering, statistics, robust optimization, finance or combinatorial optimization use SOCP models (see Lobo, Vandenberghe, Boyd, & Lebret, 1998). Although the available algorithms for SDP are clearly applicable to SOCP, specialized approaches for SOCP have been proved to be more efficient for this family of problems (see Alizadeh & Goldfarb, 2003).

For the sake of readability and to do the paper self contained we recall the following result, proved by Blanco, Puerto, and El-Haj Ben-Ali (2014b), that allows to represent several types of constraints as intersection of second order cone constraints.

                        Lemma 2
                        
                           Blanco et al. (2014b)
                        


                        
                           Let
                           
                              
                                 r
                                 ,
                                 s
                                 ∈
                                 N
                                 ∖
                                 {
                                 0
                                 }
                              
                            
                           such that
                           
                              
                                 gcd
                                 (
                                 r
                                 ,
                                 s
                                 )
                                 =
                                 1
                              
                           
                           . Then, the constraints
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   s
                                                
                                                
                                                   t
                                                   
                                                      r
                                                      −
                                                      s
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ≥
                                                
                                                   x
                                                   r
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                                ,
                                                u
                                                ,
                                                t
                                             
                                          
                                          
                                             
                                                ≥
                                                0
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           can be equivalently written as a set of at most ⌊log2(r)⌋ second order cone inequalities with ⌊log2(r)⌋ new (auxiliary) nonnegative variables.
                        

This section deals with multifacility location models where more than one new facility have to be located to improve the service for the demand points. Several results obtained in previous papers are extended or reformulated with great generality giving a panorama view of the geometric insights of location theory.

We start by considering a class of multifacility ordered median problems already introduced by Nickel and Puerto (2005) and Rodríguez-Chía, Nickel, Puerto, and Fernández (2000). We shall extend these models, originally considered only in dimension 2 and with polyhedral norms to the more general case of any dimension d > 1 and any ℓ
                        τ
                     -norm being 
                        
                           τ
                           ∈
                           Q
                           ,
                           
                           τ
                           ≥
                           1
                        
                      (here ℓ
                        τ
                      stands for the norm 
                        
                           
                              
                                 ∥
                                 x
                                 ∥
                              
                              τ
                           
                           
                              =
                              (
                           
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              d
                           
                           
                              |
                           
                           
                              x
                              i
                           
                           
                              
                                 
                                    |
                                    τ
                                 
                                 )
                              
                              
                                 1
                                 τ
                              
                           
                           ,
                        
                      for all 
                        
                           x
                           ∈
                           
                              R
                              d
                           
                        
                     ). Unlike the original approaches for the planar case by Carrizosa and Puerto (1995); Nickel and Puerto (2005); Rodríguez-Chía et al. (2000), where even for polyhedral norms there are proposed iterative algorithms for which polynomiality results can not be proven; we shall follow on a different approach. In this section, we provide efficient reformulations of these classes of multifacility continuous location models. We apply tools borrowed from conic programming to prove that these problems can be polynomially solved.

We are given a set of demand points 
                        
                           {
                           
                              a
                              1
                           
                           ,
                           …
                           ,
                           
                              a
                              n
                           
                           }
                        
                      and three sets of scalars 
                        
                           
                              {
                              
                                 ω
                                 1
                              
                              ,
                              …
                              ,
                              
                                 ω
                                 n
                              
                              }
                           
                           ⊆
                           
                              R
                              +
                           
                           ,
                        
                     
                     
                        
                           
                              {
                              
                                 λ
                                 11
                              
                              ,
                              …
                              ,
                              
                                 λ
                                 
                                    n
                                    p
                                 
                              
                              }
                           
                           ⊆
                           
                              R
                              +
                           
                        
                      and 
                        
                           
                              {
                              
                                 μ
                                 12
                              
                              ,
                              
                                 μ
                                 13
                              
                              ,
                              …
                              ,
                              
                                 μ
                                 
                                    p
                                    −
                                    1
                                    p
                                 
                              
                              }
                           
                           ⊆
                           
                              R
                              +
                           
                        
                     .

The elements ωi
                      are weights corresponding to the importance given to the existing facilities 
                        
                           
                              a
                              i
                           
                           ,
                           i
                           ∈
                           
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                        
                      and depending on the choice of the λ-weights we get different classes of problems. The μ-weights represent the penalty per distance unit given when locating two different facilities. We denote by 
                        
                           P
                           n
                        
                      the set of permutations of the first n natural numbers (i.e., 
                        
                           
                              P
                              n
                           
                           =
                           
                              {
                              σ
                              :
                              
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 }
                              
                              →
                              
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 }
                              
                              :
                              σ
                              
                              bijective
                              }
                           
                        
                     ).

Natural extensions of the multifacility models considered by Nickel and Puerto (2005) and Rodríguez-Chía et al. (2000), assume that one is looking for the location of p new facilities rather than only one. In this formulation the new facilities are chosen to provide service to all the existing facilities minimizing an ordered median objective function. These ordered problems are of course harder to handle than the classical ones not considering ordered distances. To simplify the presentation we consider that the different demand points use the same norm to measure distances, although all our results extend further to the case of mixed norms (different norm for each facility).

Let us consider a set of demand points 
                        
                           
                              {
                              
                                 a
                                 1
                              
                              ,
                              
                                 a
                                 2
                              
                              ,
                              …
                              ,
                              
                                 a
                                 n
                              
                              }
                           
                           ⊂
                           
                              R
                              d
                           
                        
                     . We want to locate p new facilities 
                        
                           X
                           =
                           {
                           
                              x
                              1
                           
                           ,
                           
                              x
                              2
                           
                           ,
                           …
                           ,
                           
                              x
                              p
                           
                           }
                        
                      which minimize the following expression:

                        
                           (2)
                           
                              
                                 
                                    
                                       f
                                       
                                          λ
                                       
                                       
                                          N
                                          I
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          1
                                       
                                       ,
                                       
                                          x
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          x
                                          p
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       λ
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       d
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          j
                                       
                                       )
                                    
                                    +
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          p
                                          −
                                          1
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             j
                                             ′
                                          
                                          =
                                          j
                                          +
                                          1
                                       
                                       p
                                    
                                    
                                       μ
                                       
                                          j
                                          
                                             j
                                             ′
                                          
                                       
                                    
                                    
                                       
                                          ∥
                                          
                                             x
                                             j
                                          
                                          −
                                          
                                             x
                                             
                                                j
                                                ′
                                             
                                          
                                          ∥
                                       
                                       τ
                                    
                                    ,
                                 
                              
                           
                        
                     where for any 
                        
                           x
                           ∈
                           
                              R
                              d
                           
                           ,
                        
                     
                     
                        
                           
                              d
                              i
                           
                           
                              (
                              x
                              )
                           
                           =
                           
                              ω
                              i
                           
                           
                              
                                 ∥
                                 
                                    a
                                    i
                                 
                                 −
                                 x
                                 ∥
                              
                              τ
                           
                        
                      and d
                     (i)(x) is the ith element in the permutation of 
                        
                           (
                           
                              d
                              1
                           
                           
                              (
                              x
                              )
                           
                           ,
                           …
                           ,
                           
                              d
                              n
                           
                           
                              (
                              x
                              )
                           
                           )
                        
                      such that 
                        
                           
                              d
                              
                                 (
                                 1
                                 )
                              
                           
                           
                              (
                              x
                              )
                           
                           ≥
                           
                              d
                              
                                 (
                                 2
                                 )
                              
                           
                           
                              (
                              x
                              )
                           
                           ≥
                           …
                           ≥
                           
                              
                                 d
                                 
                                    (
                                    i
                                    )
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           
                           ≥
                           …
                           ≥
                           
                              d
                              
                                 (
                                 n
                                 )
                              
                           
                           
                              (
                              x
                              )
                           
                        
                     . In this model, it is assumed that (see Rodríguez-Chía et al., 2000)

                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             λ
                                             
                                                1
                                                j
                                             
                                          
                                          ≥
                                          
                                             λ
                                             
                                                2
                                                j
                                             
                                          
                                          ≥
                                          …
                                          ≥
                                          
                                             λ
                                             
                                                n
                                                j
                                             
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          p
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              μ
                              
                                 j
                                 
                                    j
                                    ′
                                 
                              
                           
                           ≥
                           0
                        
                      for any 
                        
                           j
                           ,
                           
                              j
                              ′
                           
                           =
                           1
                           ,
                           …
                           ,
                           p
                        
                      and, as mention above, d
                     (i)(xj
                     ) is the expression, which appears at the ith position in the ordered version of the list

                        
                           (4)
                           
                              
                                 
                                    L
                                    j
                                    
                                       N
                                       I
                                    
                                 
                                 
                                    :
                                    =
                                    (
                                 
                                 
                                    w
                                    1
                                 
                                 
                                    ∥
                                 
                                 
                                    x
                                    j
                                 
                                 −
                                 
                                    a
                                    1
                                 
                                 
                                    
                                       ∥
                                    
                                    τ
                                 
                                 ,
                                 …
                                 ,
                                 
                                    w
                                    n
                                 
                                 
                                    ∥
                                 
                                 
                                    x
                                    j
                                 
                                 −
                                 
                                    a
                                    n
                                 
                                 
                                    
                                       ∥
                                       τ
                                    
                                    )
                                 
                                 
                                 
                                 for
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 p
                                 .
                              
                           
                        
                     Note that in this formulation we assign the lambda parameters with respect to each new facility, i.e., xj
                      is considered to be non-interchangeable with xi
                      whenever i ≠ j. For this reason we say that this model has non-interchangeable facilities.

The problem consists of

                        
                           (LOCOMF-NI)
                           
                              
                                 
                                    
                                       ρ
                                       λ
                                       
                                          N
                                          I
                                       
                                    
                                    
                                    :
                                    =
                                    
                                       min
                                       x
                                    
                                    
                                       {
                                       
                                          f
                                          
                                             λ
                                          
                                          
                                             N
                                             I
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       :
                                       x
                                       =
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          ,
                                          …
                                          ,
                                          
                                             x
                                             p
                                          
                                          )
                                       
                                       ,
                                       
                                       
                                          x
                                          j
                                       
                                       ∈
                                       
                                          R
                                          d
                                       
                                       ,
                                       
                                       ∀
                                       j
                                       =
                                       1
                                       ,
                                       ⋯
                                       ,
                                       p
                                       }
                                    
                                    ,
                                 
                              
                           
                        
                     
                  

The reader should observe that this is the extension of Problem (3) by Rodríguez-Chía et al. (2000, Section 4.1).

                        Theorem 3
                        
                           The problem 
                           
                              LOCOMF-NI
                            
                           attains an optimal solution.
                        

We know that

                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             λ
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             d
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                j
                                             
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             max
                                             σ
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             λ
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             w
                                             
                                                σ
                                                (
                                                i
                                                )
                                             
                                          
                                          
                                             
                                                ∥
                                                
                                                   x
                                                   j
                                                
                                                −
                                                
                                                   a
                                                   
                                                      σ
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                                ∥
                                             
                                             τ
                                          
                                          ,
                                       
                                    
                                 
                              
                           where σ is a permutation of the set 
                              
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 p
                                 }
                              
                           . Therefore, the first part of the objective function is a sum of maxima of convex functions. Hence, it is a convex function. Thus, 
                              
                                 f
                                 
                                    λ
                                 
                                 
                                    N
                                    I
                                 
                              
                            is a convex function as a sum of convex functions.

Next, suppose that we restrict ourselves to consider the problem where 
                              
                                 
                                    x
                                    j
                                 
                                 =
                                 x
                              
                            for all 
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                              
                           . Assume that x
                           * is a solution. Then, for any x not optimal it must exist 
                              
                                 
                                    i
                                    x
                                 
                                 ∈
                                 
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    }
                                 
                              
                            such that 
                              
                                 
                                    ∥
                                    x
                                    −
                                 
                                 
                                    a
                                    
                                       i
                                       x
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    τ
                                 
                                 ≥
                                 
                                    
                                       ∥
                                       
                                          x
                                          *
                                       
                                       −
                                       
                                          a
                                          
                                             i
                                             x
                                          
                                       
                                       ∥
                                    
                                    τ
                                 
                              
                           . Thus taking 
                              
                                 x
                                 =
                                 0
                                 ,
                              
                            we get 
                              
                                 
                                    ∥
                                 
                                 
                                    x
                                    *
                                 
                                 −
                                 
                                    a
                                    
                                       i
                                       0
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    τ
                                 
                                 ≤
                                 
                                    
                                       ∥
                                       
                                          a
                                          
                                             i
                                             0
                                          
                                       
                                       ∥
                                    
                                    τ
                                 
                              
                            which implies that 
                              
                                 
                                    
                                       ∥
                                    
                                    
                                       x
                                       *
                                    
                                    
                                       
                                          ∥
                                       
                                       τ
                                    
                                    −
                                    
                                       max
                                       
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                       
                                    
                                    
                                       ∥
                                    
                                    
                                       a
                                       i
                                    
                                    
                                       
                                          ∥
                                       
                                       τ
                                    
                                    ≤
                                    
                                       max
                                       
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                       
                                    
                                    
                                       
                                          ∥
                                          
                                             a
                                             i
                                          
                                          ∥
                                       
                                       τ
                                    
                                 
                              
                           . Hence, any candidate x
                           * to optimal solution must satisfy 
                              
                                 
                                    
                                       ∥
                                    
                                    
                                       x
                                       *
                                    
                                    
                                       
                                          ∥
                                       
                                       τ
                                    
                                    ≤
                                    2
                                    
                                       max
                                       
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                       
                                    
                                    
                                       
                                          ∥
                                          
                                             a
                                             i
                                          
                                          ∥
                                       
                                       τ
                                    
                                    =
                                    M
                                 
                              
                           .

Let us denote by 
                              X
                            the set 
                              
                                 {
                                 x
                                 ∈
                                 
                                    R
                                    
                                       p
                                       ×
                                       d
                                    
                                 
                                 :
                                 
                                 ∥
                                 
                                    x
                                    j
                                 
                                 
                                    ∥
                                    τ
                                 
                                 ≤
                                 M
                                 ,
                                 
                                 ∀
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                                 }
                              
                           . Observe that for solving LOCOMF-NI we can restrict, without loss of generality, to 
                              X
                           . Thus, it consists of minimizing the convex function 
                              
                                 f
                                 
                                    λ
                                 
                                 
                                    N
                                    I
                                 
                              
                            over 
                              X
                            which is compact in 
                              
                                 R
                                 
                                    p
                                    ×
                                    d
                                 
                              
                            and consequently by Weierstrass theorem, Problem LOCOMF-NI admits at least one optimal solution.□

The following result states a sufficient condition for uniqueness of optimal solution of Problem (LOCOMF-NI).

                        Theorem 4
                        
                           Assume that
                           
                              
                                 τ
                                 ∉
                                 {
                                 1
                                 ,
                                 +
                                 ∞
                                 }
                                 ,
                              
                            
                           the demand points in A are not collinear and for all
                           
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                            
                           there exists at least one
                           
                              
                                 j
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 p
                                 }
                              
                            
                           such that λij
                            ≠ 0. Then the optimal solution of Problem 
                           
                              (LOCOMF-NI)
                            
                           is unique.
                        

We prove that the function 
                              
                                 
                                    f
                                    
                                       λ
                                    
                                    
                                       N
                                       I
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       1
                                    
                                    ,
                                    
                                       x
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    
                                       x
                                       p
                                    
                                    )
                                 
                              
                            is strictly convex which clearly implies the result.

Since the function 
                              
                                 
                                    f
                                    
                                       λ
                                    
                                    
                                       N
                                       I
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       1
                                    
                                    ,
                                    
                                       x
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    
                                       x
                                       p
                                    
                                    )
                                 
                              
                            is globally convex we can take without loss of generality two points 
                              
                                 
                                    x
                                    ¯
                                 
                                 ,
                              
                           
                           
                              
                                 x
                                 ^
                              
                            and 
                              
                                 [
                                 
                                    x
                                    ¯
                                 
                                 ,
                                 
                                    x
                                    ^
                                 
                                 ]
                              
                            in the same ordered region and γ ∈ (0, 1). (Observe that otherwise, we can decompose the segment in subsegments satisfying the hypothesis and we apply the same argument in each of them.) In the ordered region the sorting of the distances is fixed and to simplify the presentation we suppose that this sorting is induced by the identity permutation.

By hypothesis, the demand points in A are not collinear and the ‖ · ‖
                              τ
                           -norm is strictly convex for 
                              
                                 τ
                                 ∈
                                 (
                                 1
                                 ,
                                 +
                                 ∞
                                 )
                              
                           ; thus, for each 
                              
                                 j
                                 ∈
                                 1
                                 ,
                                 …
                                 ,
                                 p
                              
                            there exists i(j) such that 
                              
                                 
                                    ∥
                                    γ
                                 
                                 
                                    
                                       x
                                       ¯
                                    
                                    j
                                 
                                 +
                                 
                                    (
                                    1
                                    −
                                    γ
                                    )
                                 
                                 
                                    
                                       x
                                       ^
                                    
                                    j
                                 
                                 −
                                 
                                    a
                                    
                                       i
                                       (
                                       j
                                       )
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    τ
                                 
                                 
                                    <
                                    γ
                                    ∥
                                 
                                 
                                    
                                       x
                                       ¯
                                    
                                    j
                                 
                                 −
                                 
                                    a
                                    
                                       i
                                       (
                                       j
                                       )
                                    
                                 
                                 
                                    
                                       ∥
                                    
                                    τ
                                 
                                 +
                                 
                                    (
                                    1
                                    −
                                    γ
                                    )
                                 
                                 
                                    
                                       ∥
                                       
                                          
                                             x
                                             ^
                                          
                                          j
                                       
                                       −
                                       
                                          a
                                          
                                             i
                                             (
                                             j
                                             )
                                          
                                       
                                       ∥
                                    
                                    τ
                                 
                                 ,
                              
                           
                           
                              
                                 j
                                 ∈
                                 1
                                 ,
                                 …
                                 ,
                                 p
                              
                           . These inequalities imply that 
                              
                                 
                                    f
                                    
                                       λ
                                    
                                    
                                       N
                                       I
                                    
                                 
                                 
                                    (
                                    γ
                                    
                                       (
                                       
                                          
                                             x
                                             ¯
                                          
                                          1
                                       
                                       ,
                                       
                                          
                                             x
                                             ¯
                                          
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             x
                                             ¯
                                          
                                          p
                                       
                                       )
                                    
                                    +
                                    
                                       (
                                       1
                                       −
                                       γ
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             x
                                             ^
                                          
                                          1
                                       
                                       ,
                                       
                                          
                                             x
                                             ^
                                          
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             x
                                             ^
                                          
                                          p
                                       
                                       )
                                    
                                    )
                                 
                                 <
                                 γ
                                 
                                    f
                                    
                                       λ
                                    
                                    
                                       N
                                       I
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ¯
                                       
                                       1
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       p
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    1
                                    −
                                    γ
                                    )
                                 
                                 
                                    f
                                    
                                       λ
                                    
                                    
                                       N
                                       I
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       1
                                    
                                    ,
                                    
                                       
                                          x
                                          ^
                                       
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                          ^
                                       
                                       p
                                    
                                    )
                                 
                                 .
                              
                           
                           □

Note that when the demand points in A are collinear one can find multiple solutions to Problem (LOCOMF-NI). The following example illustrates this situation.

                        Example 5
                        Let 
                              
                                 A
                                 =
                                 {
                                 (
                                 0
                                 ,
                                 0
                                 )
                                 ,
                                 (
                                 1
                                 ,
                                 1
                                 )
                                 ,
                                 (
                                 2
                                 ,
                                 2
                                 )
                                 ,
                                 (
                                 10
                                 ,
                                 10
                                 )
                                 }
                              
                            be a set of demand points in 
                              
                                 R
                                 2
                              
                            endowed with the ℓ2-norm and consider the following weights 
                              
                                 
                                    w
                                    i
                                 
                                 =
                                 1
                              
                            for all 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 4
                                 ,
                              
                           
                           
                              
                                 
                                    μ
                                    12
                                 
                                 =
                                 0
                              
                            and

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   11
                                                
                                                =
                                                
                                                   λ
                                                   21
                                                
                                                =
                                                
                                                   λ
                                                   31
                                                
                                                =
                                                
                                                   λ
                                                   41
                                                
                                                =
                                                1
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                   12
                                                
                                                =
                                                1
                                                ,
                                                
                                                
                                                   λ
                                                   22
                                                
                                                =
                                                
                                                   λ
                                                   32
                                                
                                                =
                                                
                                                   λ
                                                   42
                                                
                                                =
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The optimal value of (LOCOMF-NI) for 
                              
                                 p
                                 =
                                 2
                              
                            facilities is 
                              
                                 
                                    f
                                    *
                                 
                                 =
                                 16
                                 
                                    2
                                 
                              
                            which is attained by 
                              
                                 
                                    x
                                    1
                                    *
                                 
                                 ∈
                                 
                                    {
                                    
                                       (
                                       x
                                       ,
                                       x
                                       )
                                    
                                    :
                                    x
                                    ∈
                                    
                                       [
                                       1
                                       ,
                                       2
                                       ]
                                    
                                    }
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    x
                                    2
                                    *
                                 
                                 =
                                 
                                    (
                                    5
                                    ,
                                    5
                                    )
                                 
                              
                           . Fig. 1
                            shows the demand points (circles) and the optimal solutions to the problem (triangles and square).

Next we prove that Problem LOCOMF-NI can be reformulated in an appropriate way that allows us the development of an efficient algorithm based on the theory of second order cone programming.

                        Theorem 6
                        
                           Let
                           
                              
                                 τ
                                 =
                                 
                                    r
                                    s
                                 
                              
                            
                           be such that
                           
                              
                                 r
                                 ,
                                 s
                                 ∈
                                 N
                                 ∖
                                 {
                                 0
                                 }
                                 ,
                              
                            
                           r ≥ s and
                           
                              
                                 gcd
                                 (
                                 r
                                 ,
                                 s
                                 )
                                 =
                                 1
                              
                           
                           . For any set of lambda weights satisfying
                           
                              
                                 
                                    λ
                                    
                                       1
                                       j
                                    
                                 
                                 ≥
                                 …
                                 ≥
                                 
                                    λ
                                    
                                       n
                                       j
                                    
                                 
                                 ≥
                                 0
                              
                            
                           for all
                           
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                                 ,
                              
                            
                           Problem 
                           
                              (LOCOMF-NI)
                            
                           is equivalent to
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             NIMFOMP
                                             )
                                          
                                          λ
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ρ
                                             λ
                                             
                                                N
                                                I
                                             
                                          
                                          =
                                          min
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             v
                                             
                                                i
                                                j
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                ℓ
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             w
                                             
                                                ℓ
                                                j
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                p
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   j
                                                   ′
                                                
                                                =
                                                j
                                                +
                                                1
                                             
                                             p
                                          
                                          
                                             t
                                             
                                                j
                                                
                                                   j
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            
                           
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                s.t.
                                                
                                             
                                          
                                          
                                             
                                                
                                                   v
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                +
                                                
                                                   w
                                                   
                                                      ℓ
                                                      j
                                                   
                                                
                                                ≥
                                                
                                                   λ
                                                   
                                                      ℓ
                                                      j
                                                   
                                                
                                                
                                                   u
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ,
                                                ∀
                                                i
                                                ,
                                                ℓ
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                                
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   y
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   x
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                +
                                                
                                                   a
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                                ∀
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                                
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                ,
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   y
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                +
                                                
                                                   x
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   a
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                                ∀
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                                
                                                
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                ,
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   y
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                   r
                                                
                                                ≤
                                                
                                                   ς
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                   s
                                                
                                                
                                                   u
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      r
                                                      −
                                                      s
                                                   
                                                
                                                ,
                                                ∀
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                                
                                                
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                ,
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      ω
                                                      
                                                         i
                                                      
                                                      
                                                         r
                                                         s
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      d
                                                   
                                                   
                                                      ς
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   ≤
                                                   
                                                      u
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ,
                                                   ∀
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   n
                                                   ,
                                                   
                                                   j
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   z
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                
                                                −
                                                
                                                   x
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                +
                                                
                                                   x
                                                   
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                                ∀
                                                j
                                                ,
                                                
                                                   j
                                                   ′
                                                
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                ,
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (11)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   z
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                
                                                +
                                                
                                                   x
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   x
                                                   
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                                ∀
                                                j
                                                ,
                                                
                                                   j
                                                   ′
                                                
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                ,
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   z
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                   r
                                                
                                                ≤
                                                
                                                   ξ
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                   s
                                                
                                                
                                                   t
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                   
                                                   
                                                      r
                                                      −
                                                      s
                                                   
                                                
                                                ,
                                                ∀
                                                j
                                                ,
                                                
                                                   j
                                                   ′
                                                
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                ,
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      μ
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                      
                                                      
                                                         r
                                                         s
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      d
                                                   
                                                   
                                                      ξ
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                         k
                                                      
                                                   
                                                   ≤
                                                   
                                                      t
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                      
                                                   
                                                   ,
                                                   ∀
                                                   j
                                                   ,
                                                   
                                                      j
                                                      ′
                                                   
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   p
                                                   ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (14)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   ς
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                                ∀
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                                
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                ,
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (15)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   ξ
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                                ∀
                                                j
                                                ,
                                                
                                                   j
                                                   ′
                                                
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                ,
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   v
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ∈
                                                R
                                                ,
                                                
                                                   w
                                                   
                                                      ℓ
                                                      j
                                                   
                                                
                                                ∈
                                                R
                                                ,
                                                
                                                   t
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                                ∀
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                                j
                                                ,
                                                
                                                   j
                                                   ′
                                                
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   y
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                                
                                                   z
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                                ∀
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                                j
                                                ,
                                                
                                                   j
                                                   ′
                                                
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                ,
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           Moreover, (
                           NIMFOMP
                                 λ
                              
                           
                           ) satisfies Slater condition and it can be represented as a second order cone program with
                           
                              
                                 
                                    (
                                    n
                                    p
                                    +
                                    
                                       p
                                       2
                                    
                                    )
                                 
                                 
                                    (
                                    2
                                    d
                                    +
                                    1
                                    )
                                 
                                 +
                                 
                                    p
                                    2
                                 
                              
                            
                           linear inequalities and at most
                           
                              
                                 4
                                 (
                                 
                                    p
                                    2
                                 
                                 d
                                 +
                                 n
                                 p
                                 d
                                 )
                                 log
                                 r
                              
                            
                           second order cone inequalities.
                        

Note that the condition 
                              
                                 
                                    λ
                                    
                                       1
                                       j
                                    
                                 
                                 ≥
                                 …
                                 ≥
                                 
                                    λ
                                    
                                       n
                                       j
                                    
                                 
                              
                            for all 
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                                 ,
                              
                            allows us to write Problem (LOCOMF-NI) as

                              
                                 (18)
                                 
                                    
                                       
                                          
                                             min
                                             
                                                x
                                                ∈
                                                
                                                   R
                                                   
                                                      d
                                                      p
                                                   
                                                
                                             
                                          
                                          
                                             max
                                             
                                                σ
                                                ∈
                                                
                                                   P
                                                   n
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             λ
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             ω
                                             
                                                σ
                                                (
                                                i
                                                )
                                             
                                          
                                          
                                             ∥
                                          
                                          
                                             x
                                             j
                                          
                                          −
                                          
                                             a
                                             
                                                σ
                                                (
                                                i
                                                )
                                             
                                          
                                          
                                             
                                                ∥
                                             
                                             τ
                                          
                                          
                                          +
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                p
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   j
                                                   ′
                                                
                                                =
                                                j
                                                +
                                                1
                                             
                                             p
                                          
                                          
                                             μ
                                             
                                                j
                                                
                                                   j
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                ∥
                                                
                                                   x
                                                   j
                                                
                                                −
                                                
                                                   x
                                                   
                                                      j
                                                      ′
                                                   
                                                
                                                ∥
                                             
                                             τ
                                          
                                          ,
                                       
                                    
                                 
                              
                           Let us introduce the auxiliary variables uij
                            and 
                              
                                 
                                    t
                                    
                                       j
                                       
                                          j
                                          ′
                                       
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                            and 
                              
                                 j
                                 ,
                                 
                                    j
                                    ′
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                              
                            to which we impose that 
                              
                                 
                                    u
                                    
                                       i
                                       j
                                    
                                 
                                 ≥
                                 
                                    ω
                                    i
                                 
                                 
                                    
                                       ∥
                                       
                                          x
                                          j
                                       
                                       −
                                       
                                          a
                                          i
                                       
                                       ∥
                                    
                                    τ
                                 
                              
                            and 
                              
                                 
                                    t
                                    
                                       j
                                       
                                          j
                                          ′
                                       
                                    
                                 
                                 ≥
                                 
                                    μ
                                    
                                       j
                                       
                                          j
                                          ′
                                       
                                    
                                 
                                 
                                    
                                       ∥
                                       
                                          x
                                          j
                                       
                                       −
                                       
                                          x
                                          
                                             j
                                             ′
                                          
                                       
                                       ∥
                                    
                                    τ
                                 
                                 ,
                              
                            to model the problem in a convenient form.

Now, for any permutation 
                              
                                 σ
                                 ∈
                                 
                                    P
                                    n
                                 
                                 ,
                              
                            let 
                              
                                 
                                    u
                                    
                                       σ
                                       j
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       u
                                       
                                          σ
                                          (
                                          1
                                          )
                                          j
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       u
                                       
                                          σ
                                          (
                                          n
                                          )
                                          j
                                       
                                    
                                    )
                                 
                              
                            for 
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                              
                           . Moreover, let us denote by ( · ) the permutation that sorts any vector in nonincreasing sequence, i.e. 
                              
                                 
                                    u
                                    
                                       (
                                       1
                                       )
                                       j
                                    
                                 
                                 ≥
                                 
                                    u
                                    
                                       (
                                       2
                                       )
                                       j
                                    
                                 
                                 ≥
                                 …
                                 ≥
                                 
                                    u
                                    
                                       (
                                       n
                                       )
                                       j
                                    
                                 
                              
                           . Using that 
                              
                                 
                                    λ
                                    
                                       1
                                       j
                                    
                                 
                                 ≥
                                 …
                                 ≥
                                 
                                    λ
                                    
                                       n
                                       j
                                    
                                 
                              
                            and since 
                              
                                 
                                    u
                                    
                                       i
                                       j
                                    
                                 
                                 ≥
                                 0
                                 ,
                              
                            for all 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                            and 
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                              
                            then

                              
                                 (19)
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             λ
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             u
                                             
                                                (
                                                i
                                                )
                                                j
                                             
                                          
                                          =
                                          
                                             max
                                             
                                                σ
                                                ∈
                                                
                                                   P
                                                   n
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             λ
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             u
                                             
                                                σ
                                                (
                                                i
                                                )
                                                j
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        

The permutations in 
                              
                                 P
                                 n
                              
                            can be represented by the binary variables

                              
                                 
                                    
                                       
                                          p
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      1
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      if
                                                      
                                                      
                                                         u
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                      goes
                                                      
                                                      in
                                                      
                                                      position
                                                      
                                                      k
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                      otherwise
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           imposing that they verify the following constraints:

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      p
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   =
                                                   1
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                ∀
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                ,
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      p
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   =
                                                   1
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                ∀
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                                
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Next, combining the two sets of variables we obtain that righthand side of (19) can be equivalently written as

                              
                                 (20)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         p
                                                      
                                                      
                                                         λ
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         u
                                                         
                                                            (
                                                            i
                                                            )
                                                            j
                                                         
                                                      
                                                      =
                                                      
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      max
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         p
                                                      
                                                      
                                                         ∑
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         λ
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         u
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         p
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      s
                                                      .
                                                      t
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         p
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      =
                                                      1
                                                      ,
                                                      
                                                      ∀
                                                      j
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      p
                                                      ,
                                                      
                                                      k
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                      
                                                         ∑
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         p
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      =
                                                      1
                                                      ,
                                                      
                                                      ∀
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                      
                                                      j
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      p
                                                      ,
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   
                                                      p
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   ∈
                                                   
                                                      {
                                                      0
                                                      ,
                                                      1
                                                      }
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Now, we point out that for fixed j, i.e. considering the terms that contain 
                              
                                 
                                    u
                                    
                                       1
                                       j
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    u
                                    
                                       n
                                       j
                                    
                                 
                                 ,
                              
                            we have that

                              
                                 (21)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         λ
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         u
                                                         
                                                            (
                                                            i
                                                            )
                                                            j
                                                         
                                                      
                                                      =
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      max
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         ∑
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         λ
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         u
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         p
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      s
                                                      .
                                                      t
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         p
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      =
                                                      1
                                                      ,
                                                      
                                                      ∀
                                                      k
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                      
                                                         ∑
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         p
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      =
                                                      1
                                                      ,
                                                      
                                                      ∀
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   
                                                      p
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   ∈
                                                   
                                                      {
                                                      0
                                                      ,
                                                      1
                                                      }
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The problem above is an assignment problem and its constraint matrix is totally unimodular, so that solving a continuous relaxation of the problem always yields an integral solution vector (see Ahuja, Magnanti, & Orlin, 1993), and thus a valid permutation. Moreover, the dual of the linear programming relaxation of (21) is strong and also gives the value of the original binary formulation of (21). Hence, for fixed 
                              
                                 j
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 p
                                 }
                              
                            and for any vector 
                              
                                 
                                    u
                                    
                                       ·
                                       j
                                    
                                 
                                 ∈
                                 
                                    R
                                    n
                                 
                                 ,
                              
                            by using the dual of the assignment problem (21) we obtain the following expression

                              
                                 (22)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         λ
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         u
                                                         
                                                            (
                                                            i
                                                            )
                                                            j
                                                         
                                                      
                                                      =
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      min
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         v
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            l
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         w
                                                         
                                                            l
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   s
                                                   .
                                                   t
                                                   
                                                   
                                                      v
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   +
                                                   
                                                      w
                                                      
                                                         l
                                                         j
                                                      
                                                   
                                                   ≥
                                                   
                                                      λ
                                                      
                                                         l
                                                         j
                                                      
                                                   
                                                   
                                                      u
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   l
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   n
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Finally, we replace (22) in (18) and we get


                           
                              
                                 (23)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         p
                                                      
                                                      
                                                         v
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            l
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         p
                                                      
                                                      
                                                         w
                                                         
                                                            l
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            p
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            
                                                               j
                                                               ′
                                                            
                                                            =
                                                            j
                                                            +
                                                            1
                                                         
                                                         p
                                                      
                                                      
                                                         t
                                                         
                                                            j
                                                            
                                                               j
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   s
                                                   .
                                                   t
                                                   
                                                   
                                                      v
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   +
                                                   
                                                      w
                                                      
                                                         l
                                                         j
                                                      
                                                   
                                                   ≥
                                                   
                                                      λ
                                                      
                                                         l
                                                         j
                                                      
                                                   
                                                   
                                                      u
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   ∀
                                                   i
                                                   ,
                                                   l
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   n
                                                   ,
                                                   
                                                   j
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   p
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                   
                                                      u
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ≥
                                                   
                                                      ω
                                                      i
                                                   
                                                   
                                                      
                                                         ∥
                                                         
                                                            x
                                                            j
                                                         
                                                         −
                                                         
                                                            a
                                                            i
                                                         
                                                         ∥
                                                      
                                                      τ
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   n
                                                   ,
                                                   
                                                   j
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   p
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                   
                                                      t
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                      
                                                   
                                                   ≥
                                                   
                                                      μ
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∥
                                                         
                                                            x
                                                            j
                                                         
                                                         −
                                                         
                                                            x
                                                            
                                                               j
                                                               ′
                                                            
                                                         
                                                         ∥
                                                      
                                                      τ
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   j
                                                   ,
                                                   
                                                      j
                                                      ′
                                                   
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   p
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           It remains to prove that each inequality 
                              
                                 
                                    u
                                    
                                       i
                                       j
                                    
                                 
                                 ≥
                                 
                                    ω
                                    i
                                 
                                 
                                    
                                       ∥
                                       
                                          x
                                          j
                                       
                                       −
                                       
                                          a
                                          i
                                       
                                       ∥
                                    
                                    τ
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                              
                            can be replaced by the system

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   x
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                +
                                                
                                                   a
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                +
                                                
                                                   x
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   a
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                   r
                                                
                                                ≤
                                                
                                                   ς
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                   s
                                                
                                                
                                                   u
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      r
                                                      −
                                                      s
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ω
                                                      
                                                         i
                                                      
                                                      
                                                         r
                                                         s
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      d
                                                   
                                                   
                                                      ς
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   ≤
                                                   
                                                      u
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ς
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Indeed, set 
                              
                                 ρ
                                 =
                                 
                                    r
                                    
                                       r
                                       −
                                       s
                                    
                                 
                                 ,
                              
                            then 
                              
                                 
                                    1
                                    ρ
                                 
                                 +
                                 
                                    s
                                    r
                                 
                                 =
                                 1
                              
                           . Let 
                              
                                 (
                                 
                                    
                                       x
                                       ¯
                                    
                                    j
                                 
                                 ,
                                 
                                    
                                       u
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 )
                              
                            fulfil the inequality 
                              
                                 
                                    u
                                    
                                       i
                                       j
                                    
                                 
                                 ≥
                                 
                                    ω
                                    i
                                 
                                 
                                    
                                       ∥
                                       
                                          x
                                          j
                                       
                                       −
                                       
                                          a
                                          i
                                       
                                       ∥
                                    
                                    τ
                                 
                              
                           . Then we have

                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ω
                                                   i
                                                
                                                
                                                   
                                                      ∥
                                                      
                                                         
                                                            x
                                                            ¯
                                                         
                                                         j
                                                      
                                                      −
                                                      
                                                         a
                                                         i
                                                      
                                                      ∥
                                                   
                                                   τ
                                                
                                                ≤
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             ⟺
                                          
                                          
                                             
                                                
                                                   ω
                                                   i
                                                
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         d
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  x
                                                                  ¯
                                                               
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                            −
                                                            
                                                               a
                                                               
                                                                  i
                                                                  k
                                                               
                                                            
                                                            |
                                                         
                                                         
                                                            r
                                                            s
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      s
                                                      r
                                                   
                                                
                                                ≤
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      s
                                                      r
                                                   
                                                
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      1
                                                      ρ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ⟺
                                          
                                          
                                             
                                                
                                                   ω
                                                   i
                                                
                                                
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         d
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  x
                                                                  ¯
                                                               
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                            −
                                                            
                                                               a
                                                               
                                                                  i
                                                                  k
                                                               
                                                            
                                                            |
                                                         
                                                         
                                                            r
                                                            s
                                                         
                                                      
                                                      
                                                         
                                                            u
                                                            ¯
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                         
                                                            
                                                               r
                                                               s
                                                            
                                                            
                                                               (
                                                               −
                                                               
                                                                  
                                                                     r
                                                                     −
                                                                     s
                                                                  
                                                                  r
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      s
                                                      r
                                                   
                                                
                                                ≤
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      s
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ⟺
                                          
                                          
                                             
                                                
                                                   ω
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                      s
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   d
                                                
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            x
                                                            ¯
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         a
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      r
                                                      s
                                                   
                                                
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      −
                                                      
                                                         
                                                            r
                                                            −
                                                            s
                                                         
                                                         s
                                                      
                                                   
                                                
                                                ≤
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Then (24) holds if and only if 
                              
                                 ∃
                                 
                                    ς
                                    
                                       i
                                       j
                                    
                                 
                                 ∈
                                 
                                    R
                                    d
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    ς
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 ∀
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                              
                            such that

                              
                                 
                                    
                                       
                                          |
                                       
                                       
                                          
                                             x
                                             ¯
                                          
                                          
                                             j
                                             k
                                          
                                       
                                       −
                                       
                                          a
                                          
                                             i
                                             k
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             r
                                             s
                                          
                                       
                                       
                                          
                                             u
                                             ¯
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             −
                                             
                                                
                                                   r
                                                   −
                                                   s
                                                
                                                s
                                             
                                          
                                       
                                       ≤
                                       
                                          ς
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       ,
                                       
                                       
                                       satisfying
                                       
                                       
                                       
                                          ω
                                          
                                             i
                                          
                                          
                                             r
                                             s
                                          
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          d
                                       
                                       
                                          ς
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       ≤
                                       
                                          
                                             u
                                             ¯
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ,
                                    
                                 
                              
                           or equivalently,

                              
                                 (25)
                                 
                                    
                                       
                                          |
                                       
                                       
                                          
                                             x
                                             ¯
                                          
                                          
                                             j
                                             k
                                          
                                       
                                       −
                                       
                                          a
                                          
                                             i
                                             k
                                          
                                       
                                       
                                          
                                             |
                                          
                                          r
                                       
                                       ≤
                                       
                                          ς
                                          
                                             i
                                             j
                                             k
                                          
                                          s
                                       
                                       
                                          
                                             u
                                             ¯
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             r
                                             −
                                             s
                                          
                                       
                                       ,
                                       
                                       
                                          ω
                                          
                                             i
                                          
                                          
                                             r
                                             s
                                          
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          d
                                       
                                       
                                          ς
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       ≤
                                       
                                          
                                             u
                                             ¯
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       .
                                    
                                 
                              
                           Set 
                              
                                 
                                    
                                       y
                                       ¯
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 =
                                 
                                    |
                                    
                                       
                                          x
                                          ¯
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    −
                                    
                                       a
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                 
                              
                            and 
                              
                                 
                                    
                                       ς
                                       ¯
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             x
                                             ¯
                                          
                                          
                                             j
                                             k
                                          
                                       
                                       −
                                       
                                          a
                                          
                                             i
                                             k
                                          
                                       
                                       |
                                    
                                    τ
                                 
                                 
                                    
                                       u
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       −
                                       1
                                       /
                                       ρ
                                    
                                 
                              
                           . Then, clearly 
                              
                                 (
                                 
                                    
                                       x
                                       ¯
                                    
                                    j
                                 
                                 ,
                                 
                                    
                                       u
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       ς
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 )
                              
                            satisfies (6)–(9) and (14).

Conversely, let 
                              
                                 (
                                 
                                    
                                       x
                                       ¯
                                    
                                    j
                                 
                                 ,
                                 
                                    
                                       u
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       ς
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 )
                              
                            be a feasible solution of (6)–(9) and (14). Then, 
                              
                                 
                                    
                                       y
                                       ¯
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 ≥
                                 
                                    |
                                    
                                       
                                          x
                                          ¯
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    −
                                    
                                       a
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                 
                              
                            for all i, j and by (8)
                           
                              
                                 
                                    
                                       ς
                                       ¯
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 ≥
                                 
                                    
                                       y
                                       ¯
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                    
                                       (
                                       
                                          r
                                          s
                                       
                                       )
                                    
                                 
                                 
                                    u
                                    
                                       i
                                       j
                                    
                                    
                                       −
                                       
                                          
                                             r
                                             −
                                             s
                                          
                                          s
                                       
                                    
                                 
                                 ≥
                                 
                                    
                                       |
                                       
                                          
                                             x
                                             ¯
                                          
                                          
                                             j
                                             k
                                          
                                       
                                       −
                                       
                                          a
                                          
                                             j
                                             k
                                          
                                       
                                       |
                                    
                                    τ
                                 
                                 
                                    
                                       u
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       −
                                       
                                          
                                             r
                                             −
                                             s
                                          
                                          s
                                       
                                    
                                 
                              
                           . Thus,

                              
                                 
                                    
                                       
                                          ω
                                          i
                                          
                                             r
                                             s
                                          
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          d
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   x
                                                   ¯
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             −
                                             
                                                a
                                                
                                                   j
                                                   k
                                                
                                             
                                             |
                                          
                                          
                                             r
                                             s
                                          
                                       
                                       
                                          
                                             u
                                             ¯
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             −
                                             
                                                
                                                   r
                                                   −
                                                   s
                                                
                                                s
                                             
                                          
                                       
                                       ≤
                                       
                                          ω
                                          i
                                          
                                             r
                                             s
                                          
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          d
                                       
                                       
                                          
                                             ς
                                             ¯
                                          
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       ≤
                                       
                                          
                                             u
                                             ¯
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ,
                                    
                                 
                              
                           which in turns implies that 
                              
                                 
                                    
                                       ω
                                       i
                                       
                                          r
                                          s
                                       
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       d
                                    
                                    
                                       
                                          |
                                          
                                             
                                                x
                                                ¯
                                             
                                             
                                                j
                                                k
                                             
                                          
                                          −
                                          
                                             a
                                             
                                                j
                                                k
                                             
                                          
                                          |
                                       
                                       
                                          r
                                          s
                                       
                                    
                                    ≤
                                    
                                       
                                          u
                                          ¯
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          u
                                          ¯
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          
                                             r
                                             −
                                             s
                                          
                                          s
                                       
                                    
                                 
                              
                            and hence, 
                              
                                 
                                    ω
                                    i
                                 
                                 
                                    
                                       ∥
                                       
                                          
                                             x
                                             ¯
                                          
                                          j
                                       
                                       −
                                       
                                          a
                                          i
                                       
                                       ∥
                                    
                                    τ
                                 
                                 ≤
                                 
                                    
                                       u
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                 
                              
                           . In the same way we prove that each inequality 
                              
                                 
                                    t
                                    
                                       j
                                       
                                          j
                                          ′
                                       
                                    
                                 
                                 ≥
                                 
                                    μ
                                    
                                       j
                                       
                                          j
                                          ′
                                       
                                    
                                 
                                 
                                    
                                       ∥
                                       
                                          x
                                          j
                                       
                                       −
                                       
                                          x
                                          
                                             j
                                             ′
                                          
                                       
                                       ∥
                                    
                                    τ
                                 
                                 ,
                                 
                                 j
                                 ,
                                 
                                    j
                                    ′
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                              
                            can be replaced by the system

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   z
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                
                                                −
                                                
                                                   x
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                +
                                                
                                                   x
                                                   
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                
                                                +
                                                
                                                   x
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   x
                                                   
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                   r
                                                
                                                ≤
                                                
                                                   ξ
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                      k
                                                   
                                                   s
                                                
                                                
                                                   t
                                                   
                                                      j
                                                      
                                                         j
                                                         ′
                                                      
                                                   
                                                   
                                                      r
                                                      −
                                                      s
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                      
                                                      
                                                         r
                                                         s
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      d
                                                   
                                                   
                                                      ξ
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                         k
                                                      
                                                   
                                                   ≤
                                                   
                                                      t
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ξ
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                ∀
                                                
                                                k
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Next, we observe that each one of the inequalities 
                              
                                 
                                    y
                                    
                                       i
                                       j
                                       k
                                    
                                    r
                                 
                                 ≤
                                 
                                    ς
                                    
                                       i
                                       j
                                       k
                                    
                                    s
                                 
                                 
                                    u
                                    
                                       i
                                       j
                                    
                                    
                                       r
                                       −
                                       s
                                    
                                 
                                 ,
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                              
                            (respectively 
                              
                                 
                                    z
                                    
                                       j
                                       
                                          j
                                          ′
                                       
                                       k
                                    
                                    r
                                 
                                 ≤
                                 
                                    ξ
                                    
                                       j
                                       
                                          j
                                          ′
                                       
                                       k
                                    
                                    s
                                 
                                 
                                    t
                                    
                                       j
                                       
                                          j
                                          ′
                                       
                                    
                                    
                                       r
                                       −
                                       s
                                    
                                 
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                              
                           ) can be transformed, according to Lemma 2, into 4log r linear matrix inequalities (respectively 4log r linear matrix inequalities), being then exactly representable as second order cone constraints or semidefinite constraints.

Finally, it is straightforward to check Slater condition, for instance, for the system (23). Set 
                              
                                 
                                    v
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       w
                                       
                                          l
                                          j
                                       
                                    
                                    =
                                    
                                       3
                                       2
                                    
                                    M
                                    
                                       λ
                                       
                                          l
                                          j
                                       
                                    
                                    
                                       max
                                       i
                                    
                                    
                                       ω
                                       i
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    u
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    3
                                    2
                                 
                                 M
                                 
                                    ω
                                    i
                                 
                                 +
                                 2
                              
                            with M > >0 large enough and 
                              
                                 
                                    t
                                    
                                       j
                                       
                                          j
                                          ′
                                       
                                    
                                 
                                 =
                                 2
                                 M
                                 
                                    μ
                                    
                                       j
                                       
                                          j
                                          ′
                                       
                                    
                                 
                                 +
                                 1
                              
                            for 
                              
                                 i
                                 ,
                                 l
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                            and 
                              
                                 j
                                 ,
                                 
                                    j
                                    ′
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                              
                           .□

In the case that the considered norm is polyhedral (in particular if 
                        
                           τ
                           =
                           1
                        
                      or 
                        
                           τ
                           =
                           +
                           ∞
                        
                      in the theorem above), the above problem reduces to a standard linear problem and its number of variables and inequalities highly decreases.

As a consequence of Theorem 6 and Lemma 2, Problem (LOCOMF-NI) can be solved in polynomial time for any dimension d, by solving its reformulation as a SOCP problem (NIMFOMP
                           λ
                        
                     ) (see Monteiro & Tsuchiya, 2000; Nesterov, Nemirovski, & Ye, 1994). The reader may note that this is an important step forward with respect to the already stated complexity results (see e.g. Rodríguez-Chía et al., 2000). There, it was proven that these problems are solvable in polynomial time in the plane (
                        
                           d
                           =
                           2
                        
                     ) and using polyhedral norms. Here we extend this complexity result to be true in any dimension d > 1 and for any polyhedral or ℓ
                        τ
                     -norm with 
                        
                           τ
                           ∈
                           Q
                           ,
                        
                      
                     τ ≥ 1.

                        Example 7
                        Consider a two-facility problem on the Euclidean plane with a set of 4 demand points given by 
                              
                                 A
                                 =
                                 {
                                 (
                                 9.46
                                 ,
                                 9.36
                                 )
                                 ,
                                 (
                                 8.93
                                 ,
                                 7.00
                                 )
                                 ,
                                 (
                                 2.20
                                 ,
                                 1.12
                                 )
                                 ,
                                 (
                                 1.33
                                 ,
                                 8.89
                                 )
                                 }
                              
                            (A is subset of size 4 of the 50-cities data set from Eilon, Watson-Gandy, and Christofides (1971)), and (randomly generated-) lambda weights: 
                              
                                 
                                    λ
                                    11
                                 
                                 =
                                 147.31
                                 ,
                              
                           
                           
                              
                                 
                                    λ
                                    21
                                 
                                 =
                                 24.44
                                 ,
                              
                           
                           
                              
                                 
                                    λ
                                    31
                                 
                                 =
                                 24.16
                                 ,
                              
                           
                           
                              
                                 
                                    λ
                                    41
                                 
                                 =
                                 10.77
                                 ,
                              
                           
                           
                              
                                 
                                    λ
                                    12
                                 
                                 
                                    =
                                    119.08
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    λ
                                    22
                                 
                                 =
                                 0.56
                                 ,
                              
                           
                           
                              
                                 
                                    λ
                                    32
                                 
                                 =
                                 0.00
                                 ,
                              
                           
                           
                              
                                 
                                    λ
                                    42
                                 
                                 =
                                 0.00
                                 ,
                              
                           
                           
                              
                                 
                                    μ
                                    12
                                 
                                 =
                                 0.56
                              
                            and 
                              
                                 
                                    w
                                    i
                                 
                                 =
                                 1
                              
                            for all 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           .

The problem to be solved can be written as

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   min
                                                   
                                                      
                                                         x
                                                         1
                                                      
                                                      ,
                                                      
                                                         x
                                                         2
                                                      
                                                      ∈
                                                      
                                                         R
                                                         2
                                                      
                                                   
                                                
                                                147.31
                                                
                                                   d
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                24.44
                                                
                                                   d
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                24.16
                                                
                                                   d
                                                   
                                                      (
                                                      3
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                
                                                +
                                                
                                                
                                                10.77
                                                
                                                   d
                                                   
                                                      (
                                                      4
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                119.08
                                                
                                                   d
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      2
                                                   
                                                   )
                                                
                                                +
                                                
                                                0.56
                                                
                                                   d
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      2
                                                   
                                                   )
                                                
                                                +
                                                0.00
                                                
                                                   d
                                                   
                                                      (
                                                      3
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                0.00
                                                
                                                   d
                                                   
                                                      (
                                                      4
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      2
                                                   
                                                   )
                                                
                                                +
                                                0.56
                                                
                                                   
                                                      ∥
                                                      
                                                         x
                                                         1
                                                      
                                                      −
                                                      
                                                         x
                                                         2
                                                      
                                                      ∥
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We get as solution: 
                              
                                 
                                    x
                                    1
                                    *
                                 
                                 =
                                 
                                    (
                                    5.24
                                    ,
                                    6.41
                                    )
                                 
                              
                            and 
                              
                                 
                                    x
                                    2
                                    *
                                 
                                 =
                                 
                                    (
                                    5.61
                                    ,
                                    5.44
                                    )
                                 
                                 ,
                              
                            with objective value 
                              
                                 
                                    f
                                    *
                                 
                                 =
                                 1704.55
                              
                           . Fig. 2
                            shows the points and the solutions of the problem. The reader may observe that in general optimal solutions of this problem do not collocate.

The structural difference of a single allocation multifacility location problem with those considered in the previous section rests on the fact that in the former each demand point shall be directed to a unique serving facility by means of a predetermined allocation rule (usually closest distance). This little difference makes the problem much more difficult since the convexity properties exhibited in the previous models are no longer valid and more sophisticated tools must be used to solve these problems.

In this framework, we are given a set 
                        
                           
                              {
                              
                                 a
                                 1
                              
                              ,
                              …
                              ,
                              
                                 a
                                 n
                              
                              }
                           
                           ⊂
                           
                              R
                              d
                           
                        
                      endowed with a ℓ
                        τ
                     -norm; and a feasible domain 
                        
                           K
                           =
                           
                              {
                              x
                              ∈
                              
                                 R
                                 d
                              
                              :
                              
                                 g
                                 j
                              
                              
                                 (
                                 x
                                 )
                              
                              ≥
                              0
                              ,
                              j
                              =
                              1
                              ,
                              …
                              ,
                              m
                              }
                           
                           ⊂
                           
                              R
                              d
                           
                           ,
                        
                      closed and semi-algebraic. The goal is to find p points 
                        
                           
                              x
                              1
                           
                           ,
                           …
                           ,
                           
                              x
                              p
                           
                           ∈
                           K
                           ⊂
                           
                              R
                              d
                           
                        
                      minimizing some globalizing function of the shortest distances to the set of demand points.

The main feature and what distinguishes multifacility location problems from other general purpose optimization problems, is that the dependence of the decision variables is given throughout the norms to the demand points, i.e. 
                        
                           
                              ∥
                              x
                              −
                           
                           
                              a
                              i
                           
                           
                              
                                 ∥
                              
                              τ
                           
                        
                     .

For the ease of presentation we have restricted ourselves to the particular case of pure location problems, namely 
                        
                           
                              
                                 
                                    f
                                    ˜
                                 
                                 i
                              
                              
                                 (
                                 x
                                 )
                              
                              :
                              =
                              
                                 min
                                 
                                    j
                                    =
                                    1
                                    …
                                    p
                                 
                              
                              
                                 
                                    ∥
                                    
                                       x
                                       j
                                    
                                    −
                                    
                                       a
                                       i
                                    
                                    ∥
                                 
                                 τ
                              
                           
                        
                      which has attracted a lot of attention in the literature of Location Analysis. Needless to say that our methodology applies to more general forms of objective function, namely we could handle general rational functions of the distances as for instance by Blanco et al. (2013).

We shall define the dependence of the decision variables 
                        
                           
                              x
                              1
                           
                           ,
                           …
                           ,
                           
                              x
                              p
                           
                           ∈
                           
                              R
                              d
                           
                        
                      via 
                        
                           t
                           =
                           (
                           
                              t
                              1
                           
                           ,
                           …
                           ,
                           
                              t
                              n
                           
                           )
                           ,
                        
                      where 
                        
                           
                              t
                              i
                           
                           :
                           
                              R
                              
                                 p
                                 d
                              
                           
                           ↦
                           R
                           ,
                        
                     
                     
                        
                           
                              
                                 t
                                 i
                              
                              
                                 (
                                 
                                    x
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    x
                                    p
                                 
                                 )
                              
                              :
                              =
                              
                                 min
                                 j
                              
                              
                                 
                                    ∥
                                    
                                       x
                                       j
                                    
                                    −
                                    
                                       a
                                       i
                                    
                                    ∥
                                 
                                 τ
                              
                              ,
                           
                        
                     
                     
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     . Therefore, the ith component of the ordered median objective function of our problems reads as

                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                ˜
                                             
                                             i
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          :
                                       
                                    
                                    
                                       
                                          R
                                          
                                             p
                                             d
                                          
                                       
                                    
                                    
                                       ↦
                                    
                                    
                                       R
                                    
                                 
                                 
                                    
                                    
                                       
                                          x
                                          =
                                          (
                                          
                                             x
                                             1
                                          
                                          ,
                                          …
                                          ,
                                          
                                             x
                                             p
                                          
                                          )
                                       
                                    
                                    
                                       ↦
                                    
                                    
                                       
                                          
                                             
                                                t
                                                i
                                             
                                             :
                                             =
                                             
                                                min
                                                
                                                   j
                                                   =
                                                   1
                                                   …
                                                   p
                                                
                                             
                                             
                                                {
                                                ∥
                                             
                                             
                                                x
                                                j
                                             
                                             −
                                             
                                                a
                                                i
                                             
                                             
                                                
                                                   ∥
                                                   τ
                                                
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Consider the following problem

                        
                           (LOCOMF)
                           
                              
                                 
                                    
                                       ρ
                                       λ
                                    
                                    
                                    :
                                    =
                                    
                                       min
                                       x
                                    
                                    
                                       {
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          λ
                                          i
                                       
                                       
                                          
                                             f
                                             ˜
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       :
                                       x
                                       =
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          ,
                                          …
                                          ,
                                          
                                             x
                                             p
                                          
                                          )
                                       
                                       ,
                                       
                                       
                                          x
                                          j
                                       
                                       ∈
                                       K
                                       ,
                                       
                                       ∀
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       p
                                       }
                                    
                                    ,
                                 
                              
                           
                        
                     where
                        
                           •
                           
                              
                                 
                                    K
                                    ⊆
                                    
                                       R
                                       d
                                    
                                 
                               satisfies the Archimedean property. Without loss of generality we shall assume that we know M > 0 such that ‖xj
                              ‖2 ≤ M, for all 
                                 
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                 
                              .


                              
                                 
                                    τ
                                    :
                                    =
                                    
                                       r
                                       s
                                    
                                    ≥
                                    1
                                    ,
                                 
                              
                              
                                 
                                    r
                                    ,
                                    s
                                    ∈
                                    N
                                 
                               with 
                                 
                                    g
                                    c
                                    d
                                    (
                                    r
                                    ,
                                    s
                                    )
                                    =
                                    1
                                 
                              .


                              λ
                              ℓ ≥ 0 for all 
                                 
                                    ℓ
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    .
                                 
                              
                           

First of all, we observe that problem LOCOMF is well defined and that it has an optimal solution. Indeed, we are minimizing a continuous function over a compact set in 
                        
                           R
                           d
                        
                     . Thus, by Weierstrass theorem problem LOCOMF admits an optimal solution. On the other hand, unlike in the previous section uniqueness can not be easily obtained since, as proven by the following easy example, multiple solutions often occurs.

                        Example 8
                        Consider a two-facility problem on the Euclidean plane with set of demand points 
                              
                                 A
                                 =
                                 {
                              
                            (0, 0), (0, 1), (1, 1), (1, 0)}. Assume that the λ-weights are 
                              
                                 
                                    λ
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                              
                            for all 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                           
                           
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                              
                           . Then, any pair of points 
                              
                                 
                                    x
                                    1
                                    *
                                 
                                 ∈
                                 
                                    {
                                    0
                                    }
                                 
                                 ×
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                            and 
                              
                                 
                                    x
                                    2
                                    *
                                 
                                 ∈
                                 
                                    {
                                    1
                                    }
                                 
                                 ×
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                            is an optimal solution.

In this section, we present a tractable formulation of problem LOCOMF as a mixed integer nonlinear program with linear objective function. For each 
                           
                              i
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                              ,
                           
                         we set UBi
                         as a valid upper bound on the value of 
                           
                              
                                 ∥
                              
                              
                                 
                                    x
                                    ¯
                                 
                                 j
                              
                              −
                              
                                 a
                                 i
                              
                              
                                 
                                    ∥
                                 
                                 τ
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    x
                                    ¯
                                 
                                 j
                              
                              ∈
                              K
                           
                        .

We introduce the following auxiliary problem

                           
                              
                                 
                                    
                                       
                                          (
                                          MFOMP
                                          )
                                       
                                       λ
                                    
                                 
                              
                              
                                 
                                    
                                       
                                       
                                          
                                             ρ
                                             ^
                                          
                                          λ
                                       
                                       =
                                       min
                                       
                                          ∑
                                          
                                             ℓ
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          λ
                                          ℓ
                                       
                                       
                                          θ
                                          ℓ
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             s.t.
                                             
                                             
                                                h
                                                
                                                   i
                                                   l
                                                
                                                1
                                             
                                          
                                       
                                       
                                          
                                             :
                                             =
                                             
                                                t
                                                i
                                             
                                             ≤
                                             
                                                θ
                                                ℓ
                                             
                                             +
                                             U
                                             
                                                B
                                                i
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   w
                                                   
                                                      i
                                                      ℓ
                                                   
                                                
                                                )
                                             
                                             ,
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ℓ
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             h
                                             
                                                l
                                             
                                             2
                                          
                                       
                                       
                                          
                                             :
                                             =
                                             
                                                θ
                                                ℓ
                                             
                                             ≥
                                             
                                                θ
                                                
                                                   ℓ
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             ∀
                                             ℓ
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             −
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             h
                                             
                                                i
                                                j
                                             
                                             3
                                          
                                       
                                       
                                          
                                             :
                                             =
                                             
                                                u
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             
                                                t
                                                i
                                             
                                             +
                                             U
                                             
                                                B
                                                i
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             ,
                                             ∀
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             p
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             h
                                             
                                                i
                                                j
                                                k
                                             
                                             4
                                          
                                       
                                       
                                          
                                             :
                                             
                                             =
                                             
                                             
                                                v
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             −
                                             
                                                x
                                                
                                                   j
                                                   k
                                                
                                             
                                             
                                             +
                                             
                                             
                                                a
                                                
                                                   i
                                                   k
                                                
                                             
                                             ≥
                                             0
                                             ,
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             p
                                             ,
                                             
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             d
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       
                                          
                                             h
                                             
                                                i
                                                j
                                                k
                                             
                                             5
                                          
                                       
                                       
                                          
                                             :
                                             
                                             =
                                             
                                             
                                                v
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             
                                             +
                                             
                                             
                                                x
                                                
                                                   j
                                                   k
                                                
                                             
                                             −
                                             
                                                a
                                                
                                                   i
                                                   k
                                                
                                             
                                             ≥
                                             0
                                             ,
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             p
                                             ,
                                             
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             d
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             h
                                             
                                                i
                                                j
                                                k
                                             
                                             6
                                          
                                       
                                       
                                          
                                             :
                                             =
                                             
                                                v
                                                
                                                   i
                                                   j
                                                   k
                                                
                                                r
                                             
                                             ≤
                                             
                                                ζ
                                                
                                                   i
                                                   j
                                                   k
                                                
                                                s
                                             
                                             
                                                u
                                                
                                                   i
                                                   j
                                                
                                                
                                                   r
                                                   −
                                                   s
                                                
                                             
                                             ,
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             p
                                             ,
                                             
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             d
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       
                                          
                                             h
                                             
                                                i
                                                j
                                             
                                             7
                                          
                                       
                                       
                                          
                                             :
                                             =
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                d
                                             
                                             
                                                ζ
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ≤
                                             
                                                u
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             p
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       
                                          
                                             h
                                             
                                                i
                                             
                                             8
                                          
                                       
                                       
                                          
                                             
                                                :
                                                =
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   p
                                                
                                                
                                                   z
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                =
                                                1
                                                ,
                                                ∀
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             h
                                             
                                                ℓ
                                             
                                             9
                                          
                                       
                                       
                                          
                                             
                                                :
                                                =
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   w
                                                   
                                                      i
                                                      ℓ
                                                   
                                                
                                                =
                                                1
                                                ,
                                                ∀
                                                ℓ
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             h
                                             
                                                i
                                             
                                             10
                                          
                                       
                                       
                                          
                                             
                                                :
                                                =
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   w
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                =
                                                1
                                                ,
                                                ∀
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                w
                                                
                                                   i
                                                   ℓ
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             ∀
                                             
                                             i
                                             ,
                                             ℓ
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             ∀
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             p
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (38)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                θ
                                                ℓ
                                             
                                             ,
                                             
                                             
                                                t
                                                i
                                             
                                             ∈
                                             
                                                R
                                                +
                                             
                                             ,
                                             ∀
                                             i
                                             ,
                                             ℓ
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (39)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                v
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ,
                                             
                                             
                                                ζ
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ,
                                             
                                             
                                                u
                                                
                                                   i
                                                   j
                                                
                                             
                                             ∈
                                             
                                                R
                                                +
                                             
                                             ,
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             p
                                             ,
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             d
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (40)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                x
                                                j
                                             
                                             ∈
                                             K
                                             ,
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             p
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

With constraints (26) and (27), we enforce the variable θl
                         to assume the value ti
                         that is sorted in the lth position of the vector t, while constraints (28)–(32) model the evaluation of 
                           
                              
                                 ∥
                              
                              
                                 x
                                 j
                              
                              −
                              
                                 a
                                 i
                              
                              
                                 
                                    ∥
                                 
                                 τ
                              
                           
                         for all i and j. Constraints (34)–(36) model permutations, and constraints (33) and (37) are introduced to model the allocation of element indexed by i to a unique index j. Therefore, putting all the above ingredients together we get that in the optimum 
                           
                              
                                 
                                    t
                                    i
                                 
                                 =
                                 
                                    min
                                    j
                                 
                                 
                                    
                                       ∥
                                       
                                          x
                                          j
                                       
                                       −
                                       
                                          a
                                          i
                                       
                                       ∥
                                    
                                    τ
                                 
                              
                           
                        .

Let 
                           
                              N
                              :
                              =
                              3
                              n
                              +
                              
                                 n
                                 2
                              
                              +
                              n
                              −
                              1
                              +
                              n
                              p
                              
                                 (
                                 3
                                 d
                                 +
                                 2
                                 )
                              
                              =
                              
                                 n
                                 2
                              
                              +
                              4
                              n
                              +
                              n
                              p
                              
                                 (
                                 3
                                 d
                                 +
                                 2
                                 )
                              
                              −
                              1
                           
                         and denote by 
                           
                              {
                              
                                 h
                                 1
                              
                              ,
                              …
                              ,
                              
                                 h
                                 N
                              
                              }
                           
                         the constraints (26)–(35) in the problem above. Let 
                           
                              K
                              ^
                           
                         denote the feasible domain of Problem MFOMP
                              λ
                           
                        .

                           Theorem 9
                           
                              Let x be a feasible solution of 
                              
                                 LOCOMF
                               
                              then there exists a solution (x, z, u, v, ζ, w, t, θ) for 
                              MFOMP
                                    λ
                                 
                               
                              such that their objective values are equal. Conversely, if (x, z, u, v, ζ, w, t, θ) is a feasible solution for 
                              MFOMP
                                    λ
                                 
                               
                              then x is a feasible solution for 
                              
                                 LOCOMF
                              
                              . Furthermore, if K satisfies Slater condition then the feasible region of the continuous relaxation of 
                              MFOMP
                                    λ
                                 
                               
                              also satisfies Slater condition and
                              
                                 
                                    
                                       ρ
                                       λ
                                    
                                    =
                                    
                                       
                                          ρ
                                          ^
                                       
                                       λ
                                    
                                 
                              
                              .
                           

Let 
                                 
                                    
                                       x
                                       ¯
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             x
                                             ¯
                                          
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             x
                                             ¯
                                          
                                          p
                                       
                                       )
                                    
                                 
                               be a feasible solution of LOCOMF. Then, it satisfies 
                                 
                                    
                                       
                                          x
                                          ¯
                                       
                                       j
                                    
                                    ∈
                                    K
                                    ,
                                 
                               for all 
                                 
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                 
                              . Let 
                                 
                                    
                                       u
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          ∥
                                          
                                             
                                                x
                                                ¯
                                             
                                             j
                                          
                                          −
                                          
                                             a
                                             i
                                          
                                          ∥
                                       
                                       τ
                                    
                                    ,
                                 
                               based in (24) and (25), 
                                 
                                    
                                       ∥
                                    
                                    
                                       
                                          x
                                          ¯
                                       
                                       j
                                    
                                    −
                                    
                                       a
                                       i
                                    
                                    
                                       
                                          ∥
                                       
                                       τ
                                    
                                 
                               can be represented by

                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      =
                                                      
                                                         |
                                                         
                                                            
                                                               x
                                                               ¯
                                                            
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               i
                                                               k
                                                            
                                                         
                                                         |
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                         r
                                                      
                                                      =
                                                      
                                                         ζ
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                         s
                                                      
                                                      
                                                         u
                                                         
                                                            i
                                                            j
                                                         
                                                         
                                                            r
                                                            −
                                                            s
                                                         
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               k
                                                               =
                                                               1
                                                            
                                                            d
                                                         
                                                         
                                                            ζ
                                                            
                                                               i
                                                               j
                                                               k
                                                            
                                                         
                                                         =
                                                         
                                                            u
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ζ
                                                      ≥
                                                      0
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              For 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                 
                               and 
                                 
                                    k
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    d
                                    ,
                                 
                               we denote by

                                 
                                    
                                       
                                          
                                             t
                                             i
                                          
                                          =
                                          
                                             min
                                             ℓ
                                          
                                          
                                             
                                                ∥
                                                
                                                   
                                                      x
                                                      ¯
                                                   
                                                   ℓ
                                                
                                                −
                                                
                                                   a
                                                   i
                                                
                                                ∥
                                             
                                             τ
                                          
                                          
                                          
                                          and
                                          
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               min
                                                               l
                                                            
                                                            
                                                               
                                                                  ∥
                                                                  
                                                                     
                                                                        x
                                                                        ¯
                                                                     
                                                                     l
                                                                  
                                                                  −
                                                                  
                                                                     a
                                                                     i
                                                                  
                                                                  ∥
                                                               
                                                               τ
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            =
                                                            
                                                            ∥
                                                         
                                                         
                                                            
                                                               x
                                                               ¯
                                                            
                                                            j
                                                         
                                                         −
                                                         
                                                            a
                                                            i
                                                         
                                                         
                                                            
                                                               ∥
                                                            
                                                            τ
                                                         
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      otherwise.
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Observe that if it would exist 
                                 
                                    
                                       j
                                       ′
                                    
                                    ∈
                                    
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       p
                                       }
                                    
                                 
                               such that j′ ≠ j and 
                                 
                                    
                                       
                                          min
                                          l
                                       
                                       
                                          ∥
                                       
                                       
                                          
                                             x
                                             ¯
                                          
                                          l
                                       
                                       −
                                       
                                          a
                                          i
                                       
                                       
                                          
                                             ∥
                                          
                                          τ
                                       
                                       =
                                       
                                          
                                             ∥
                                             
                                                
                                                   x
                                                   ¯
                                                
                                                
                                                   j
                                                   ′
                                                
                                             
                                             −
                                             
                                                a
                                                i
                                             
                                             ∥
                                          
                                          τ
                                       
                                    
                                 
                               then we can choose arbitrarily any of them, because a client can be assigned to only one facility.

These values clearly satisfy constraints (28)–(32) and (37)–(39).

Besides, let σ be the permutation of 
                                 
                                    (
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    )
                                 
                               such that t
                              
                                 σ(1) ≥ … ≥ t
                              
                                 σ(n). Take,

                                 
                                    
                                       
                                          
                                             w
                                             
                                                i
                                                l
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         i
                                                         =
                                                         σ
                                                         (
                                                         l
                                                         )
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwize
                                                         ;
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          and
                                          
                                          
                                             θ
                                             l
                                          
                                          =
                                          
                                             t
                                             
                                                σ
                                                (
                                                l
                                                )
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           

Then the constraints (26) and (27) are also satisfied. Clearly, 
                                 
                                    
                                       ∑
                                       
                                          ℓ
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       λ
                                       ℓ
                                    
                                    
                                       θ
                                       ℓ
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       λ
                                       i
                                    
                                    
                                       
                                          f
                                          ˜
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                 
                              .

Conversely, if 
                                 
                                    (
                                    
                                       x
                                       ¯
                                    
                                    ,
                                    
                                       z
                                       ¯
                                    
                                    ,
                                    
                                       u
                                       ¯
                                    
                                    ,
                                    
                                       v
                                       ¯
                                    
                                    ,
                                    
                                       ζ
                                       ¯
                                    
                                    ,
                                    
                                       w
                                       ¯
                                    
                                    ,
                                    
                                       t
                                       ¯
                                    
                                    ,
                                    
                                       θ
                                       ¯
                                    
                                    )
                                 
                               is a feasible solution of MFOMP
                                    λ
                                 
                               then, clearly 
                                 
                                    
                                       
                                          x
                                          ¯
                                       
                                       j
                                    
                                    ∈
                                    K
                                 
                               and 
                                 
                                    x
                                    ¯
                                 
                               is a feasible point of LOCOMF.

Consider the continuous relaxation of problem (MFOMP
                                    λ
                                 
                              ). Suppose that K satisfies Slater condition. Take xj
                               for all 
                                 
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                    ,
                                 
                               in the interior of K. Set 
                                 
                                    θ
                                    =
                                    4
                                    M
                                    +
                                    
                                       1
                                       ℓ
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       t
                                       i
                                    
                                    =
                                    3
                                    M
                                 
                               and 
                                 
                                    
                                       u
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    2
                                    M
                                 
                               for 
                                 
                                    ℓ
                                    ,
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                 
                               and 
                                 
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                 
                               with M > >0 large enough. Then, for any zij, w
                              
                                 iℓ ∈ [0, 1] we get that the set of inequality constraints satisfies

                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                         ℓ
                                                      
                                                      −
                                                      
                                                         t
                                                         i
                                                      
                                                      +
                                                      U
                                                      
                                                         B
                                                         i
                                                      
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            w
                                                            
                                                               i
                                                               ℓ
                                                            
                                                         
                                                         )
                                                      
                                                      >
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                      
                                                      ℓ
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         θ
                                                         ℓ
                                                      
                                                      >
                                                      
                                                         θ
                                                         
                                                            ℓ
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      ℓ
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         t
                                                         i
                                                      
                                                      −
                                                      
                                                         u
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      +
                                                      U
                                                      
                                                         B
                                                         i
                                                      
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            z
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      >
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      ∀
                                                      
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                      
                                                      j
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      p
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      >
                                                      
                                                         
                                                            ∥
                                                            
                                                               x
                                                               j
                                                            
                                                            −
                                                            
                                                               a
                                                               i
                                                            
                                                            ∥
                                                         
                                                         τ
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      ∀
                                                      
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                      
                                                      j
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      p
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              This proves that the continuous relaxation of MFOMP
                                    λ
                                 
                               satisfies Slater condition.

By the above arguments, optimal solutions and optimal values of both formulations coincide.□

To illustrate the applicability of the above formulation, in the following we have applied it to an instance of 10 demand points extracted from the 50-points data set by Eilon et al. (1971):

(9.46, 9.36), (7.43, 1.61), (6.27, 3.66), (5.00, 9.00), (2.83, 9.88), (2.20, 1.12), (1.90, 8.35), (1.68, 6.45), (1.24, 6.69), (0.75, 4.98).

For 
                                 
                                    p
                                    =
                                    3
                                    ,
                                 
                              
                              
                                 
                                    τ
                                    =
                                    
                                       7
                                       5
                                    
                                 
                               and 
                                 
                                    λ
                                    =
                                    (
                                    2.25
                                    ,
                                    1.70
                                    ,
                                    1.14
                                    ,
                                    1.11
                                    ,
                                    1.06
                                    ,
                                    1.03
                                    ,
                                    1.01
                                    ,
                                    1.01
                                    ,
                                    1.00
                                    ,
                                    1.00
                                    )
                                    ,
                                 
                               we get the solutions 
                                 
                                    
                                       x
                                       1
                                       *
                                    
                                    =
                                    
                                       (
                                       6.19
                                       ,
                                       1.58
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       2
                                       *
                                    
                                    =
                                    
                                       (
                                       5.00
                                       ,
                                       9.36
                                       )
                                    
                                    ,
                                 
                               and 
                                 
                                    
                                       x
                                       3
                                       *
                                    
                                    =
                                    
                                       (
                                       1.44
                                       ,
                                       6.55
                                       )
                                    
                                    ,
                                 
                               with optimal objective value 
                                 
                                    
                                       f
                                       *
                                    
                                    =
                                    30.1460
                                 
                              . Fig. 3
                               shows the demand points (filled dots), solutions (filled triangles) and the allocation of the demand points to the facilities (dashed lines).

An interesting observation that follows from Problem (MFOMP
                              λ
                           
                        ) is that the unconstrained version of the location problem is an appealing mixed integer nonlinear program. Observe that the only set of nonlinear constraints that appear in (MFOMP
                              λ
                           
                        ) is (31). However, (31) can be written equivalently as a polynomial number of second order cone constraints, according to Lemma 2. This way, Problem (MFOMP
                              λ
                           
                        ) becomes a mixed integer nonlinear program with lineal objective function and only linear and second order cone constraints, although with two sets of binary variables, namely w and z. Nevertheless, there are nowadays general purpose solvers, as Gurobi, Cplex or Xpress, that implements exact B&B algorithms for this type of problems and that are rather efficient.

                           Remark 11
                           Assume that the hypothesis of Theorem 9 are satisfied. In addition, any of the following conditions hold

                                 
                                    1.
                                    
                                       gi
                                       (x) are concave for 
                                          
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             m
                                          
                                        and 
                                          
                                             −
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                μ
                                                i
                                             
                                             
                                                ∇
                                                2
                                             
                                             
                                                g
                                                i
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             ≻
                                             0
                                          
                                        for each dual pair (x, μ) of the problem of minimizing any linear functional ctx on K (Positive Definite Lagrange Hessian (PDLH)).


                                       gi
                                       (x) are sos-concave on K for 
                                          
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             m
                                          
                                        or gi
                                       (x) are concave on K and strictly concave on the boundary of K where they vanish, i.e. 
                                          
                                             ∂
                                             K
                                             ∩
                                             ∂
                                             {
                                             x
                                             ∈
                                             
                                                R
                                                d
                                             
                                             :
                                             
                                                g
                                                i
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             =
                                             0
                                             }
                                             ,
                                          
                                        for all 
                                          
                                             i
                                             =
                                             1
                                             ,
                                             ⋯
                                             ,
                                             m
                                          
                                       .


                                       gi
                                       (x) are strictly quasi-concave on K for 
                                          
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       .

Then, applying (Blanco et al., 2014b, Theorem 4) to the formulation of Problem (MFOMP
                                    λ
                                 
                              ), we get that there exists a constructive finite dimension embedding, which only depends on τ and gi
                              , 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    m
                                    ,
                                 
                               such that the problem is mixed-integer SDP representable.

From the above observation to solve Problem MFOMP
                              λ
                           
                         efficiently we have combined a branch-and-bound approach over a mixed integer nonlinear program. In that approach, one may provide two types of lower bounds in the nodes of the branching tree: a continuous relaxation and a SDP relaxation based on a hierarchy of SDP “a la Lasserre”. Clearly, the first type of bounds are only possible if in each node of the tree the continuous relaxation of MFOMP
                              λ
                           
                         satisfies Slater condition. This is ensured in Theorem 9.

The consequence of the above transformation is that one can easily put this family of problems in commercial solvers and then to get solutions without going to painful ad hoc implementations that may be problem dependent. We illustrate this approach in our computational experiments in Section 5.

Finally, we conclude this section providing some results concerning the second type of lower bounds, based on a SDP hierarchy, that can be used to approximate to any degree of accuracy the solution of the problem as well as within the branch and bound framework at each node of the branching tree.

Let 
                           
                              y
                              =
                              (
                              
                                 y
                                 α
                              
                              )
                           
                         be a real sequence indexed in the monomial basis (xβzηuγvδζκwψtτθ
                        ϑ) of 
                           
                              R
                              [
                              x
                              ,
                              z
                              ,
                              u
                              ,
                              v
                              ,
                              ζ
                              ,
                              w
                              ,
                              t
                              ,
                              θ
                              ]
                           
                         (with 
                           
                              α
                              =
                              
                                 (
                                 β
                                 ,
                                 η
                                 ,
                                 γ
                                 ,
                                 δ
                                 ,
                                 κ
                                 ,
                                 τ
                                 ,
                                 ψ
                                 ,
                                 ϑ
                                 )
                              
                              ∈
                              
                                 N
                                 
                                    p
                                    d
                                 
                              
                              ×
                              
                                 N
                                 
                                    n
                                    p
                                 
                              
                              ×
                              
                                 N
                                 
                                    n
                                    p
                                 
                              
                              ×
                              
                                 N
                                 
                                    n
                                    p
                                    d
                                 
                              
                              ×
                              
                                 N
                                 
                                    n
                                    2
                                 
                              
                              ×
                              
                                 N
                                 n
                              
                              ×
                              
                                 N
                                 n
                              
                              ×
                              
                                 N
                                 
                                    n
                                    p
                                    d
                                 
                              
                           
                        ). Denote by 
                           
                              n
                              
                                 v
                                 1
                              
                              =
                              d
                              +
                              n
                              p
                              
                                 (
                                 d
                                 +
                                 2
                                 )
                              
                              +
                              
                                 n
                                 2
                              
                              +
                              2
                              n
                              +
                              n
                              p
                              d
                           
                         the number of variables in the extended formulation of the problem.

Let 
                           
                              
                                 
                                    h
                                    0
                                 
                                 
                                    (
                                    θ
                                    )
                                 
                                 :
                                 =
                                 
                                    ∑
                                    
                                       ℓ
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    λ
                                    ℓ
                                 
                                 
                                    θ
                                    ℓ
                                 
                                 ,
                              
                           
                         and denote ξj
                         ≔ ⌈(deg gj
                        )/2⌉ and νj
                         ≔ ⌈(deg hj
                        )/2⌉, where 
                           
                              {
                              
                                 g
                                 1
                              
                              ,
                              …
                              ,
                              
                                 g
                                 
                                    n
                                    K
                                 
                              
                              }
                              ,
                           
                         and 
                           
                              {
                              
                                 h
                                 1
                              
                              ,
                              …
                              ,
                              
                                 h
                                 N
                              
                              }
                           
                         are, respectively, the polynomial constraints that define K and 
                           
                              
                                 K
                                 ^
                              
                              ∖
                              K
                           
                         in MFOMP
                              λ
                           
                        . For 
                           
                              
                                 r
                                 ≥
                                 
                                    r
                                    0
                                 
                                 
                                    :
                                    =
                                    max
                                    {
                                 
                                 
                                    max
                                    
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          n
                                          K
                                       
                                    
                                 
                                 
                                    ξ
                                    k
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    max
                                    
                                       j
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       N
                                    
                                 
                                 
                                    ν
                                    j
                                 
                                 
                                    }
                                    ,
                                 
                              
                           
                         introduce the hierarchy of semidefinite programs:

                           
                              
                                 
                                    
                                       
                                          Q
                                          1
                                       
                                       r
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                inf
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                y
                                             
                                             
                                                (
                                                
                                                   p
                                                   λ
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                r
                                             
                                             
                                                (
                                                y
                                                )
                                             
                                             ⪰
                                             0
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   r
                                                   −
                                                   
                                                      ξ
                                                      k
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   g
                                                   k
                                                
                                                ,
                                                y
                                                )
                                             
                                             ⪰
                                             0
                                             ,
                                             
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                n
                                                K
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   r
                                                   −
                                                   
                                                      ν
                                                      j
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   h
                                                   j
                                                
                                                ,
                                                y
                                                )
                                             
                                             
                                                (
                                                
                                                   ⪰
                                                   =
                                                
                                                )
                                             
                                             0
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             N
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                y
                                                0
                                             
                                             =
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        with optimal value denoted 
                           
                              inf
                              
                                 
                                    Q
                                    1
                                 
                                 r
                              
                           
                         (and min Q1
                        
                           r
                         if the infimum is attained). The reader may observe that some of the localizing constraints 
                           
                              
                                 
                                    M
                                 
                                 
                                    r
                                    −
                                    
                                       ν
                                       j
                                    
                                 
                              
                              
                                 (
                                 
                                    h
                                    j
                                 
                                 ,
                                 y
                                 )
                              
                           
                         in Q1
                        
                           r
                         are linear matrix equations since the families of constraints (33)–(35) contain several equations. This is indicated in Q1
                        
                           r
                         by our notation 
                           
                              
                                 
                                    M
                                 
                                 
                                    r
                                    −
                                    
                                       ν
                                       j
                                    
                                 
                              
                              
                                 (
                                 
                                    h
                                    j
                                 
                                 ,
                                 y
                                 )
                              
                              
                                 (
                                 
                                    ⪰
                                    =
                                 
                                 )
                              
                              0
                           
                        . Next, based on Proposition 1 and (Lasserre, 2009b, Theorem 6.1) we can state the following result.

                           Theorem 12
                           
                              Let
                              
                                 
                                    
                                       K
                                       ^
                                    
                                    ⊂
                                    
                                       R
                                       
                                          n
                                          
                                             v
                                             1
                                          
                                       
                                    
                                 
                               
                              (compact) be the feasible domain of Problem 
                              MFOMP
                                    λ
                                 
                              
                              . Let infQ1
                              
                                 r
                               
                              be the optimal value of the semidefinite program 
                              Q1
                                    r
                                 
                              
                              . Then, with the notation above:
                              
                                 
                                    (a)
                                    infQ1
                                       
                                          r
                                       ↑ρλ as r → ∞.
                                    


                                       Let 
                                       y
                                       
                                          r
                                        
                                       be an optimal solution of the SDP relaxation 
                                       Q1
                                             r
                                          
                                       
                                       . If
                                       
                                          
                                             
                                                
                                                   
                                                      rank
                                                   
                                                   
                                                   
                                                      
                                                         M
                                                      
                                                      r
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         r
                                                      
                                                      )
                                                   
                                                   
                                                   =
                                                   
                                                   
                                                      rank
                                                   
                                                   
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         r
                                                         −
                                                         
                                                            r
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         r
                                                      
                                                      )
                                                   
                                                   
                                                   =
                                                   
                                                   φ
                                                
                                             
                                          
                                       
                                       then
                                       
                                          
                                             min
                                             
                                                
                                                   Q
                                                   1
                                                
                                                r
                                             
                                             =
                                             
                                                ρ
                                                λ
                                             
                                          
                                        
                                       and one may extract φ points
                                       
                                          
                                             
                                                (
                                                
                                                   x
                                                   1
                                                   *
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   x
                                                   p
                                                   *
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                ,
                                                
                                                   z
                                                   *
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                ,
                                                
                                                   u
                                                   *
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                ,
                                                
                                                   v
                                                   *
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                ,
                                                
                                                   ζ
                                                   *
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                ,
                                                
                                                   w
                                                   *
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                   ,
                                                   
                                                      θ
                                                      *
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                φ
                                             
                                             ⊂
                                             
                                                K
                                                ^
                                             
                                             ,
                                          
                                        
                                       all global minimizers of the 
                                       MFOMP
                                             λ
                                          
                                        
                                       problem.
                                    

One of the drawbacks of using hierarchies of SDP problems to approximate the solution of our original multifacility location problem (MFOMP
                              λ
                           
                        ) is the dimension of the SDP objects that must be used when the relaxation order increases. The size of the matrices to be considered in the SDP problems that have to be solved grows exponentially with the relaxation order. Significant reductions in the sizes of the problems to be solved can be performed by exploiting the sparsity and symmetry that appear in the location problem. On the one hand, at times the number of variables that appear in the polynomial constraints of (MFOMP
                              λ
                           
                        ) can be separated in blocks so that only some of them appear together in some constraints. In those cases the SDP variables to be used can be simplified and thus, the sizes of the moment and localizing matrices are dramatically reduced. The application of this result requires the so call running intersection property (see Lasserre, 2006) that easily applies in this case. On the other hand, the invariance of this problem under the action of the symmetric group applied to the indices of the facilities (j) allows to adapt the results by Riener, Theobald, Andrén, and Lasserre (2013) to reduce the dimensionality of the matrices that appear in the hierarchy of SDP (Q1
                              r
                           
                        ) that converge to the optimal solution. The interested reader can find all the details of the application of the dimensionality reduction based on sparsity and symmetry for multifacility location problems by Blanco, Puerto, and El-Haj Ben-Ali (2014a). Combining both approaches helps to solve some problems.

We have performed a series of computational experiments to show the efficiency of all the proposed formulations and approaches. The SOCP (LOCOMF-NI) and the mixed integer SOCP (MFOMP
                           λ
                        
                     ) formulations have been coded in Gurobi 5.6 and executed in a PC with an Intel Core i7 processor at 2x 2.40 GHz and 4 GB of RAM. We have applied our formulations to the well-known 50-points data set by Eilon et al. (1971) by considering different number of facilities, norms and weights. In particular we have considered the number of facilities to be located, p, ranging in {2, 5, 10, 15, 30} and τ (the norm) in 
                        
                           {
                           
                              3
                              2
                           
                           ,
                           2
                           ,
                           3
                           }
                        
                     . We have run both the unconstrained non-interchangeable LOCOMF-NI model and the single-allocation model MFOMP
                           λ
                        
                     . For the non-interchangeable model we have considered random λ and μ weights (fulfiling the conditions described in (3)). Table 1
                      reports our results on these experiments. There, we report the average CPU times of 5 different random instances for each problem (when fixing p and τ).

For general single-allocation multifacility problems, we have consider three of the most classical multifacility models that fit within the ordered median formulation when particular λ weights are chosen: p-median problem, p-center problem and p-k-centrum problem (with 
                        
                           k
                           =
                           0.5
                           
                           n
                           =
                           25
                        
                     ). In Table 2
                      we report the overall CPU times needed to solve the problems and the optimal solutions provided by Gurobi (f
                     *). These optimal values are important to test accuracy of solutions for future authors that wish to compare new approaches to solve these problems.

We observe that the bottleneck for solving (MFOMP
                           λ
                        
                     ) is the existence of binary variables (z and w), since otherwise it would be solvable in polynomial time. Due to the high running time, optimality could not be ensured for some instances. In order to ease the resolution some improvements can be done via some preprocessing and fixing binary variables based on a geometric branch and bound phase. This preprocessing is effective whenever the dimension of the space of variables in low, namely 
                        
                           d
                           =
                           2
                           ,
                           3
                        
                     .

Finally, to illustrate the use of the hierarchy of problems Q1
                           r
                        
                     , we have applied to the same data set by Eilon et al. (1971) the SDP relaxation Q1
                     2 for p-median problems with Euclidean distances. Implementation was done in SDPT3. The results are detailed in Table 3. The reader can observe that the results obtained with this approach (in terms of accuracy) are good although we could no certify optimality since the rank condition was not satisfied. Moreover, the running times are considerably higher (by several orders of magnitude) than those needed for similar problems solved with the MISOCO implementations in Gurobi.

@&#CONCLUSIONS@&#

We propose a novel, effective mixed integer nonlinear programming formulation for the continuous multifacility ordered median location problem for any ℓ
                        τ
                     -norm and in any dimension. This formulation provides a unified approach for dealing with a broad family of multifacility location problems which up to now were usually solved only for some special cases and usually in low dimension. We also provide lower bounds for the nodes of the branching tree based on a hierarchy of SDP relaxations “a la Lasserre”. A simpler class of multifacility (multiple-allocation) location problems is also analyzed for which optimal solutions are obtained by a continuous SOCP formulation.

@&#REFERENCES@&#

