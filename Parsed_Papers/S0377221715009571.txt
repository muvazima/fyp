@&#MAIN-TITLE@&#A comprehensive annual delivery program for upstream liquefied natural gas supply chain

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop a comprehensive model for LNG ADP problem.


                        
                        
                           
                           We model several practical aspects of ADP problem overlooked in the literature.


                        
                        
                           
                           We provide insights on how additional aspects of the model affect the ADP.


                        
                        
                           
                           We develop a novel solution that affectively solves realistic size problems.


                        
                        
                           
                           We establish how various problem parameters affect solution quality.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in maritime industry

Annual delivery planning problem

LNG supply chain

Large-scale optimization

@&#ABSTRACT@&#


               
               
                  Developing a cost-effective annual delivery program (ADP) is a challenging task for liquefied natural gas (LNG) suppliers, especially for LNG supply chains with large number of vessels and customers. Given significant operational costs in LNG delivery operations, cost-effective ADPs can yield substantial savings, adding up to millions. Providing an extensive account of supply chain operations and contractual terms, this paper aims to consider a realistic ADP problem faced by large LNG suppliers; suggest alternative delivery options, such as split-delivery; and propose an efficient heuristic solution which outperforms commercial optimizers. The comprehensive numerical study in this research demonstrates that contrary to the common belief in practice, split-delivery may generate substantial cost reductions in LNG supply chains.
               
            

@&#INTRODUCTION@&#

Natural gas (NG) is the third largest energy source satisfying approximately 25 percent of the world’s energy demand (BP Department, 2014b). Pipelines are the major delivery method in global NG trade. Although pipeline delivery is highly cost efficient over short distances, it is not technically feasible and economically viable when the supplier and customers are geographically spread. In such cases, NG is transported in the form of liquefied natural gas (LNG), utilizing special ocean-going vessels over long distances. Shipping NG in the form of LNG offers gas suppliers the ability to reach distant markets.

Global LNG trade has been steadily growing for the past two decades. Its share in the global NG trade increased from 26 percent in 2000 to 32 percent in 2013 (BP Department, 2014b). This share is expected to grow to 46 percent by 2035. Similarly, LNG accounts for 10 percent of the world’s NG consumption, which is expected to increase to 15 percent by 2035, according to BP Department (2014a). This increase in LNG demand, coupled with the increasing production and delivery capacities, has led to complex global LNG supply chains. Currently, global annual liquefaction capacity is 408 billion cubic meters (BCM), which is expected to increase to 1427 BCM when the construction of new liquefaction terminals is completed (Enerdata, 2014). On the shipping side, there are currently 405 LNG vessels with a total capacity of 59.5 million cubic meters (MCM); and 132 more vessels are currently being built to increase this capacity to 81 MCM (Enerdata, 2014).

Both the production and the delivery of LNG require significant capital investments and operating expenses. Capital cost of a liquefaction plant can be as high as 600 dollars per ton per annum production while capital cost of an LNG vessel ranges between 200 and 400 million dollars. Operational costs are also significant; the cost of daily vessel charters averaging around 60,000 dollars (Tusiani & Shearer, 2007). In light of these figures, the vast majority of global LNG trade needs long-term contracts to secure intensive capital investments in the LNG supply chain and ensure income stability for LNG suppliers. Meanwhile, due to price volatility across NG markets and excess LNG production, LNG spot market has been growing very rapidly. According to Kent (2013), the share of spot sales in the LNG trade has risen from 6 percent in 2000 to 25 percent in 2012.

In order to survive in such a dynamic and complex market, suppliers should carefully plan for LNG production, inventory, and delivery in a cost effective way. Planning problems arise at strategic, tactical, and operational decision levels: Strategic planning typically involves decisions regarding production and vessel investments as well as long-term contract terms and conditions. Tactical planning involves developing an integrated fulfill, inventory, and delivery plan for a period of 12-to-18 months to satisfy the long-term contracts’ requirements. This plan is called the annual delivery program (ADP). Finally, operational planning typically includes mitigations to planned or unplanned changes in the ADP such as vessel breakdowns, port unavailability, variations in travel times, and emerging spot sales opportunities.

In this paper, focusing on tactical planning, we study the problem of preparing a cost-effective ADP for a global LNG supplier. This is an integrated production, inventory, and maritime routing problem. The supplier operates a liquefaction plant, where NG is cooled to 
                        
                           −
                           240
                        
                      degree Fahrenheit and condensed into liquid form, which is called LNG production. The LNG is temporarily kept in storage tanks at a port near the liquefaction facility before it is loaded on LNG vessels. The supplier owns and/or charters a fleet of heterogeneous vessels that are used for delivering LNG to customers with long term contracts. For each customer, there are several contracts throughout a certain year, each of which comes with differing levels of flexibility in terms of delivery volume and time. In most practical cases, total annual long term contractual demand is less than the production capacity. Due to highly limited production changes and lack of facilities to store large amounts of LNG in storage tanks, there will usually be some excess production. Therefore, the ADP should also include a provisional plan for selling the excess production in the spot market.

In the ADP problem, we would like to minimize the sum of operating costs, penalty costs due to deviations from contractual terms, and penalty costs of handling excess production. We develop a novel heuristic method to create a cost effective ADP in a short amount of time. We then interpret the results from a comprehensive computational study to gain managerial insights.

There are a handful of studies that attempt to develop cost-effective ADPs, such as Halvorsen-Weare and Fagerholt (2013), Rakke et al. (2011) and Stälhane et al. (2012). Our main contributions in this study are incorporating many practical aspects of upstream LNG operations and LNG contracts into the ADP preparation problem and proving managerial insights regarding these aspects. Furthermore, we propose a novel and efficient heuristic solution approach for this problem, which can be used as a practical decision support tool by the logistics planners of LNG suppliers. This heuristic consistently outperforms commercial optimizers by finding less-costly ADPs in a considerably shorter amount time.

The remainder of this paper is organized as follows: in Section 2, we present a review of the relevant literature and discuss the contribution of our work. In Section 3, we describe the mathematical model and present the formulation. In Section 4, we introduce our heuristic method to construct an ADP. Finally, we present our numerical analysis in Section 5 and conclude with model extensions and further research directions in Section 6.

@&#LITERATURE REVIEW@&#

Maritime transportation optimization, reviewed by Ronen (1983, 1993), Christiansen, Fagerholt, and Ronen (2004) and Christiansen, Fagerholt, Nygreen, and Ronen (2007, 2013), has long been an active and well-established area of research. The research focusing on integrated vessel scheduling and inventory management problems, referred to as maritime inventory routing problem (MIRP), are motivated by maritime supply chains in various industries where one actor is responsible for both distribution and inventory management. Researchers studied variants of MIRP that address particular aspects of specific industrial applications. For instance, Christiansen (1999) focused on a company producing and consuming ammonia, Ronen et al. (2002) and Al-Khayyal and Hwang (2007) both considered the transportation of liquid bulk such as chemicals and oil products, Persson and Gothe-Lundgren (2005) studied MIRP at a petroleum refinery, Furman, Song, Kocis, McDonald, and Warrick (2011) studied vacuum gas oil routing and inventory management, and integrated it into a decision support tool, Christiansen et al. (2011) considered a case study from the cement industry, and Agra, Christiansen, and Delgado (2013b) presented an MILP model for a short sea fuel oil distribution problem. Recently, Agra, Andersson, Christiansen, and Wolsey (2013a) developed a new model leading to new valid inequalities for a single product MIRP to tighten a discrete time model. Papageorgiou, Keha, Nemhauser, and Sokol (2014b) studied an MIRP with multiple ports per region and split pickups and split deliveries. However they restricted the planning horizon to 60 days, thus making the focus of the paper more operational rather than tactical as in the case of creating an ADP in LNG-IRP. Papageorgiou, Nemhauser, Sokol, Cheon, and Keha (2014c) focus on strategic and tactical deep-sea MIRPs in which inventory levels at all loading and discharging ports are explicitly tracked but delivery time windows requirements are not considered. Most recently, Jiang and Grossmann (2015) studied a single product MIRP by exploring the use of continuous and discrete time models. Several other versions of MIRP are presented in Christiansen and Fagerholt (2009), Engineer, Furman, Nemhauser, Savelsbergh, and Song (2012), Hewitt, Nemhauser, Savelsbergh, and Song (2013), Siswanto, Essam, and Sarker (2011), Song and Furman (2013).

As demand for LNG increases worldwide, recent literature has witnessed an increasing amount of MIRP research with specific focus on optimizing LNG supply chains. Grønhaug and Christiansen (2009) introduce the LNG inventory routing problem (LNG-IRP), which considers a central planner who designs LNG vessel routes and schedules, LNG production and regasification (sales) plans, and terminal inventory targets in order to maximize the profit of an integrated supply chain. These authors present both an arc-flow and a path-flow formulation of LNG-IRP; but these formulations can only be solved for small instances (in terms of number of vessels, ports and planning horizon) by commercial software. Later, Grønhaug, Christiansen, Desaulniers, and Desrosiers (2010) proposed a branch-and-price method to solve the same path-flow formulation of LNG-IRP given in Grønhaug and Christiansen (2009). The instances that can be solved with this method are still small for developing practical ADPs for LNG producers. Recently, Andersson, Christiansen, and Desaulniers (2015) presented a new formulation and decomposition algorithm for the LNG-IRP presented by Grønhaug and Christiansen (2009) and Grønhaug et al. (2010). In addition, Anderson, Christiansen, and Fagerholt (2010) also presented two LNG-IRP formulations; one for an LNG producer and the other for a vertically integrated company. They did not present a solution method or computational results regarding with these two formulations. Recently, Rakke, Andersson, Christiansen, and Desaulniers (2014) introduced a new formulation based on delivery patterns and developed a branch-price-and-cut method to solve it. Papageorgiou, Cheon, Nemhauser, and Sokol (2014a) departed from the traditional MIP based methods and instead used approximate dynamic programming.

Although the LNG-IRP studies above formulated detailed vertically integrated supply chains, they ignored important ADP aspects such as spot sales and penalty charges associated with contractual terms. Furthermore, the solution methods in these studies can be effective for instances with fewer ships, ports and contracts, and a much shorter planning horizon than it is generally the case in a practical ADP.

To the best of our knowledge, similar to our work, six studies have so far presented heuristic methods for solving simplified versions of LNG-IRP in an effort to develop cost-effective ADPs. Halvorsen-Weare and Fagerholt (2013) presented a decomposition based heuristic solution algorithm. They assumed full shipload loading/unloading (no split-delivery) in their formulation. In other words, a vessel is not allowed to call multiple demand (unloading) ports on a scheduled voyage before returning to the liquefaction (loading) port. Rakke et al. (2011) and Stälhane et al. (2012) develop a rolling horizon heuristic and a construction-and-improvement heuristic, respectively. Goel, Furman, Song, and El-Bakry (2012) present an optimization model for analyzing supply chain design decisions for new LNG projects. They present a set of construction and improvement heuristics to solve this model. As a follow up study to Goel et al. (2012), Goel, Slusky, van Hoeve, Furman, and Shao (2015) develop a constraint programming model and use a dedicated search heuristic that provides better solutions in less time. Shao, Furman, Goel, and Hoda (2015) also develop a suite of heuristic methods and propose a hybrid heuristic strategy to improve solutions for the LNG-IRP model proposed by Goel et al. (2012). In all of these studies, split deliveries were not allowed; penalty cost schemes associated with delivery time windows as well as under or over delivery limits specific to contracts were ignored.

Our paper aims to contribute to the LNG-IRP literature by presenting a novel heuristic method to solve a comprehensive LNG-IRP model with the purpose of developing practical ADPs of realistic problem sizes. In contrast to previous studies discussed above which ignored both early and late delivery as well as under and over delivery penalties, our model is more comprehensive and allows for split deliveries. In Section 3.2, we benchmark our model against earlier studies, which were formulated as special cases for our model.

We aim to develop a minimum cost ADP for an LNG supplier given a certain planning horizon. In broad terms, an ADP is an integrated plan of production of LNG and distribution of it to the long-term contracted customers. In this section, we describe both the ADP problem and our associated mathematical model.

A typical ADP is developed for a planning horizon of twelve months. In our model, the planning horizon is discretized into days and we represent it by the set 
                        
                           T
                           =
                           {
                           1
                           ,
                           …
                           ,
                           T
                           }
                           ,
                        
                      where T is the last day.

There are three interrelated aspects of an ADP: production of LNG, control of the LNG inventory, and delivery to the long-term contracted customers. In this model, production, i.e., liquefaction, is done at a single location. The product, LNG, is temporarily stored nearby the production terminal, and it is loaded onto the LNG carrying vessels at a port adjacent to the production facility. In the model, this integrated production, storage, and loading facility is represented by a node called loading port. Daily production decisions are represented by rt
                     . A common industry practice is to change the production rate at certain time intervals, e.g. at the beginning of each month. The production rate is bounded from below and above, Rmin
                      and Rmax
                     , respectively.

LNG is temporarily stored in cooled storage tanks until it is loaded on LNG vessels. The total tank capacity denotes the maximum amount that can be stored as inventory. In addition, storage tanks should maintain a minimum LNG level in order to remain cold. LNG inventory in storage tanks on a given day t, st
                     , should be between these minimum and maximum levels, Smin
                      and Smax
                     , respectively. These values are assumed to be parameters of the problem.

The last, and perhaps the most important, aspect of an ADP is the delivery scheduling of the LNG to the long-term contracts. For this purpose, the LNG supplier operates a fleet of specialized vessels, denoted with set 
                        
                           V
                           ,
                        
                      indexed by v. LNG is loaded on the vessels at the loading port, denoted by l. The loading port has a number of berths, B, where each one can be used to load one vessel at a time. Associated with the loading port, we also define an artificial port, ld
                     . This artificial port can be considered as a waiting area nearby the loading port. We model that the loading port l can only be accessed through ld
                     .
                        1
                     
                     
                        1
                        The only exception to this is when the vessels are coming from maintenance, which we describe later in the model.
                     
                  

Vessel v has Gv
                      identical isolated tanks to store LNG. The capacity of each tank of vessel v is denoted by Cv
                     . Inventory level in vessel v at the end of day t is expressed as the number of full tanks and denoted by the integer variable gvt
                     . We denote with qvit
                     , the number of tanks loaded to or unloaded from vessel v at port i during day t.

Vessels visit customer ports and deliver LNG in order to satisfy customers’ contract requirements. Each customer in our model is represented with a pair of ports, denoted with i and id
                     , respectively. Port i is the actual customer port that vessels deliver LNG. Port id
                      is an artificial port we created associated with the customer i as a waiting area to accommodate waiting due to berth unavailability or delivery time windows. Vessels can wait at id
                      as many days as necessary. Port i is only accessible through id
                     . We assume that each customer port has one berth for LNG delivery.

For each customer i, there is a set of contracts, 
                        
                           
                              C
                              i
                           
                           =
                           
                              {
                              
                                 C
                                 
                                    i
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 C
                                 
                                    i
                                    
                                       N
                                       i
                                    
                                 
                              
                              }
                           
                           ,
                        
                      to be satisfied during the planning horizon. Each contract Cin
                      consists of the following terms: (i) required volume, Din
                     , (ii) minimum and maximum allowed delivery volumes, 
                        D
                      
                     
                        in
                     , and 
                        
                           
                              
                                 D
                                 ¯
                              
                              
                                 i
                                 n
                              
                           
                           ,
                        
                      respectively, (iii) expected delivery time window, 
                        
                           
                              T
                              
                                 i
                                 n
                              
                              e
                           
                           ,
                        
                      and (iv) allowed delivery time window, 
                        
                           T
                           
                              i
                              n
                           
                           a
                        
                     . 
                        D
                      
                     
                        in
                     , 
                        
                           
                              
                                 D
                                 ¯
                              
                              
                                 i
                                 n
                              
                           
                           ,
                        
                      and 
                        
                           T
                           
                              i
                              n
                           
                           a
                        
                      constitute the flexibility of the contract.

In the mathematical model, locations and flow of vessels during the planning horizon is controlled by the binary variable xvijt
                     , which is 1 if vessel v arrives at port j from port i on day t, and 0 otherwise. In this notation, subscripts i and j may denote any port including customer ports, loading port, maintenance ports, and their associated artificial ports. xvijt
                      is defined for any (i, j) pair for which vessel v can travel from i to j. xvijt
                      variables help us follow the route of a vessel throughout the planning horizon. For initial and final locations of the vessels, we introduce the artificial origin, o, and destination, d, ports, respectively. We note that although one origin port is defined, physically it may represent a different location for each vessel.

There are several restrictions on vessel flows in the model due to our modeling assumptions, port-vessel compatibility issues, and that some vessels operate in joint ventures between the customers and the producer. We model that a vessel may go to l only from ld
                     , and a compatible port i only from its artificial port id
                     . It can go to artificial ports of its compatible customer ports from l. Moreover, a vessel may go to ld
                      or directly to an id
                      from the origin port, depending on its initial inventory level; and it can go to the final destination port, d, from one of its compatible customer ports, i. In the formulation, we define 
                        
                           V
                           i
                        
                      as the set of vessels that can visit port i. Similarly, 
                        
                           P
                           v
                        
                      is the set of ports that vessel v can visit. In our model, we allow for “split-delivery”, that is a vessel can sail between multiple customer ports and deliver its load partially to these ports before sailing back to the loading port. However, a vessel may not be able to sail on every 
                        
                           
                              (
                              i
                              ,
                              j
                              )
                           
                           ∈
                           
                              (
                              
                                 P
                                 v
                              
                              ,
                              
                                 P
                                 v
                              
                              )
                           
                        
                      link due to its travel range. We define 
                        
                           P
                           
                              v
                              i
                           
                        
                      to be the set of ports that vessel v can sail from port i, and 
                        
                           P
                           
                              ∘
                           
                           
                              v
                              i
                           
                        
                      to be the set of ports from where the vessel v can reach to port i.

Travel time of vessel v from port i to j is given by Tvij
                     . We model that the travel time from an artificial port to the corresponding actual port is one day. Although we are only interested in the flow of vessels during the planning horizon, 
                        
                           T
                           ,
                        
                      in order to be able to control the flow balance in our model, we also need to monitor beyond the planning horizon. Thus, we define two more sets: (i) 
                        
                           
                              T
                              0
                           
                           =
                           T
                           ∪
                           
                              {
                              0
                              }
                           
                           ,
                        
                      (ii) 
                        
                           
                              T
                              EX
                           
                           =
                           
                              T
                              0
                           
                           ∪
                           
                              {
                              T
                              +
                              1
                              ,
                              …
                              ,
                              T
                              +
                              
                                 t
                                 0
                              
                              }
                           
                           ,
                        
                      where t
                     0 is the maximum of travel times of vessels, Tvij
                     .

Vessels should go through periodic maintenance, typically in every five years. We denote the set of vessels that should go to maintenance within the planning horizon by 
                        
                           V
                           m
                        
                     . For each vessel 
                        
                           v
                           ∈
                           
                              V
                              m
                           
                           ,
                        
                      we model a maintenance time window, 
                        
                           T
                           v
                           m
                        
                     . Maintenance operation takes 
                        
                           T
                           v
                           m
                        
                      days and it should be completed within 
                        
                           
                              T
                              v
                              m
                           
                           =
                           
                              {
                              
                                 
                                    T
                                    ̲
                                 
                                 v
                                 m
                              
                              ,
                              …
                              ,
                              
                                 
                                    T
                                    ¯
                                 
                                 v
                                 m
                              
                              }
                           
                        
                     . There is one maintenance port, which is modeled with a pair of actual and artificial ports, (m, md
                     ), and the maintenance operation is modeled as the travel from m to md
                     , i.e., 
                        
                           
                              T
                              v
                              m
                           
                           =
                           
                              T
                              
                                 v
                                 m
                                 
                                    m
                                    d
                                 
                              
                           
                        
                     . The vessels with maintenance requirements should go from ld
                      to m, and then travel from m to md
                     . After the maintenance, vessels can directly sail to l or wait at the artificial port md
                      until one of the berths in the loading port becomes available. We note that 
                        
                           
                              T
                              v
                              m
                           
                           <
                           
                              |
                              
                                 T
                                 v
                                 m
                              
                              |
                           
                           ,
                        
                      to allow some flexibility for the start of the maintenance. Moreover, we assume that the maintenance time windows of different vessels are disjoint.

The objective of an ADP is to plan the production, inventory, and delivery routing decisions at the lowest possible cost. In the model, we minimize the sum of the following three types of costs: (i) the operational costs, (ii) penalty costs associated with contractual deliveries, and (iii) the operational cost for clearing excess production by spot sales.


                     Cvij
                      represents the operational cost of vessel v traveling from i to j. This includes fuel charges, personnel cost, and any additional costs such as port, channel, and demurrage fees. The variable production cost is negligible compared to the other operational costs; thus, it is not considered in the model.

The contractual penalty costs, on the other hand, are two-fold: First one is the penalty cost of over (under) delivery. We model this with a unit rate of 
                        
                           P
                           
                              i
                              n
                           
                           +
                        
                     
                     
                        
                           (
                           
                              P
                              
                                 i
                                 n
                              
                              −
                           
                           )
                        
                      for each cubic meter of over (under) delivered amount, denoted by 
                        
                           d
                           
                              i
                              n
                           
                           +
                        
                     
                     
                        
                           (
                           
                              d
                              
                                 i
                                 n
                              
                              −
                           
                           )
                           ,
                        
                      for contract n of customer i. The second penalty cost pertains to the delivery time. As discussed before, for each contract there is an expected delivery time window, 
                        
                           
                              T
                              
                                 i
                                 n
                              
                              e
                           
                           ,
                        
                      during which the vessels are expected to deliver; and there is a larger time window 
                        
                           
                              T
                              
                                 i
                                 n
                              
                              a
                           
                           ,
                        
                      during which the vessels are allowed to deliver. No penalty costs are incurred if a vessel delivers for the contract during 
                        
                           T
                           
                              i
                              n
                           
                           e
                        
                     . However, we model a piecewise increasing penalty cost, Pint
                     , if a vessel delivers the LNG for a contract within 
                        
                           T
                           
                              i
                              n
                           
                           a
                        
                      but outside 
                        
                           T
                           
                              i
                              n
                           
                           e
                        
                     .

The last cost component is the operational costs associated with spot sales. Due to supply–demand mismatch or demand seasonality, there is usually excess production in the liquefaction ports. Excess production can be stored to satisfy future demand; but due to limited storage capacity, LNG suppliers typically try to sell excess production in spot markets. We incorporate spot sales into the ADP planning model by assuming that there is one potential spot vessel, with a capacity of CS
                     , available during any day t, which is modeled with the binary variable yt
                     . The operational costs of sending a spot cargo is represented by S.

At this stage, we do not consider revenues neither from long-term contract deliveries nor from spot sales. For long-term contracts, the sales prices are fixed and under-delivery costs include the opportunity costs of such revenues. On the other hand, at the ADP preparation stage, it is difficult to precisely estimate the amount and price of spot sales. Therefore, it would be misleading to model spot sales with revenues.

Based on the above problem and model descriptions, we provide the following MIP formulation for the ADP problem:

                        
                           (1)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          min
                                          
                                             ∑
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   P
                                                   v
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   P
                                                   
                                                      v
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   EX
                                                
                                             
                                          
                                          
                                             C
                                             
                                                v
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                i
                                                j
                                                t
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   P
                                                   C
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   n
                                                   |
                                                
                                                
                                                   C
                                                   
                                                      i
                                                      n
                                                   
                                                
                                                ∈
                                                
                                                   C
                                                   i
                                                
                                             
                                          
                                          
                                             P
                                             
                                                i
                                                n
                                             
                                             −
                                          
                                          
                                             d
                                             
                                                i
                                                n
                                             
                                             −
                                          
                                          +
                                          
                                             P
                                             
                                                i
                                                n
                                             
                                             +
                                          
                                          
                                             d
                                             
                                                i
                                                n
                                             
                                             +
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   P
                                                   C
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                v
                                                ∈
                                                
                                                   V
                                                   i
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   n
                                                   |
                                                
                                                
                                                   C
                                                   
                                                      i
                                                      n
                                                   
                                                
                                                ∈
                                                
                                                   C
                                                   i
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   
                                                      i
                                                      n
                                                   
                                                   a
                                                
                                             
                                          
                                          
                                             P
                                             
                                                i
                                                n
                                                t
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                
                                                   i
                                                   d
                                                
                                                i
                                                t
                                             
                                          
                                          +
                                          S
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             y
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     subject to


                     Initialization and termination constraints:

                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             
                                                v
                                                o
                                                o
                                                0
                                             
                                          
                                          =
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          
                                          v
                                          ∈
                                          V
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   0
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   P
                                                   
                                                      v
                                                      o
                                                   
                                                
                                                
                                                   ∖
                                                   
                                                      {
                                                      o
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                o
                                                j
                                                t
                                             
                                          
                                          =
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          v
                                          ∈
                                          V
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             
                                                v
                                                o
                                                j
                                                t
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          
                                          v
                                          ∈
                                          V
                                          ,
                                          
                                          j
                                          ∈
                                          
                                             P
                                             
                                                v
                                                o
                                             
                                          
                                          
                                             ∖
                                             
                                                {
                                                o
                                                }
                                             
                                             ,
                                             
                                             t
                                             <
                                          
                                          
                                             T
                                             
                                                v
                                                o
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             
                                                v
                                                i
                                                j
                                                t
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          v
                                          ∈
                                          V
                                          ,
                                          
                                          i
                                          ∈
                                          
                                             P
                                             
                                                v
                                                o
                                             
                                          
                                          
                                             ∖
                                             
                                                {
                                                o
                                                }
                                             
                                             ,
                                             
                                             j
                                             ∈
                                          
                                          
                                             P
                                             
                                                v
                                                i
                                             
                                          
                                          ,
                                          t
                                          <
                                          
                                             T
                                             
                                                v
                                                o
                                                i
                                             
                                          
                                          +
                                          
                                             T
                                             
                                                v
                                                i
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   P
                                                   ∘
                                                   
                                                      v
                                                      d
                                                   
                                                
                                                
                                                   ∖
                                                   
                                                      {
                                                      d
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   EX
                                                
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                i
                                                d
                                                t
                                             
                                          
                                          =
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          v
                                          ∈
                                          V
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             
                                                v
                                                d
                                                d
                                                t
                                             
                                          
                                          =
                                          1
                                       
                                    
                                    
                                       
                                          
                                          
                                          v
                                          ∈
                                          V
                                          ,
                                          t
                                          ∈
                                          
                                             T
                                             EX
                                          
                                          
                                             ∖
                                          
                                          
                                             T
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     Flow constraints:
                     
                        
                           (8)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   P
                                                   ∘
                                                   
                                                      v
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                k
                                                i
                                                t
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   P
                                                   
                                                      v
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                i
                                                j
                                                (
                                                t
                                                +
                                                
                                                   T
                                                   
                                                      v
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          v
                                          ∈
                                          V
                                          ,
                                          i
                                          ∈
                                          
                                             P
                                             v
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             T
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   P
                                                   v
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   P
                                                   
                                                      v
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                i
                                                j
                                                t
                                             
                                          
                                          ≤
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          v
                                          ∈
                                          V
                                          ,
                                          t
                                          ∈
                                          
                                             T
                                             EX
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     Vessel constraints:
                     
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          
                                             g
                                             
                                                v
                                                t
                                             
                                          
                                          =
                                          
                                             g
                                             
                                                v
                                                t
                                                −
                                                1
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   P
                                                   
                                                      v
                                                      C
                                                   
                                                
                                             
                                          
                                          
                                             q
                                             
                                                v
                                                i
                                                t
                                             
                                          
                                          +
                                          
                                             q
                                             
                                                v
                                                l
                                                t
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          v
                                          ∈
                                          V
                                          ,
                                          
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          0
                                          ≤
                                          
                                             g
                                             
                                                v
                                                t
                                             
                                          
                                          ≤
                                          
                                             G
                                             v
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          v
                                          ∈
                                          V
                                          ,
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    
                                       
                                          
                                             q
                                             
                                                v
                                                i
                                                t
                                             
                                          
                                          ≤
                                          
                                             G
                                             v
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   P
                                                   o
                                                   
                                                      v
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                j
                                                i
                                                t
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          v
                                          ∈
                                          V
                                          ,
                                          
                                          i
                                          ∈
                                          
                                             P
                                             
                                                v
                                                C
                                             
                                          
                                          ∪
                                          
                                             {
                                             l
                                             }
                                          
                                          ,
                                          
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     Liquefaction port constraints:
                     
                        
                           (13)
                           
                              
                                 
                                    
                                       
                                          
                                             s
                                             t
                                          
                                          =
                                          
                                             s
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             r
                                             t
                                          
                                          −
                                          
                                             ∑
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                          
                                             q
                                             
                                                v
                                                l
                                                t
                                             
                                          
                                          
                                             C
                                             v
                                          
                                          −
                                          
                                             C
                                             S
                                          
                                          
                                             y
                                             t
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    
                                       
                                          
                                             S
                                             
                                                m
                                                i
                                                n
                                             
                                          
                                          ≤
                                          
                                             s
                                             t
                                          
                                          ≤
                                          
                                             S
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                
                                                   l
                                                   d
                                                
                                                l
                                                t
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                v
                                                ∈
                                                
                                                   V
                                                   m
                                                
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                
                                                   v
                                                   
                                                      m
                                                      d
                                                   
                                                   l
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                x
                                                
                                                   v
                                                   
                                                      m
                                                      d
                                                   
                                                   l
                                                   t
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             y
                                             t
                                          
                                          ≤
                                          B
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 
                                    
                                       
                                          
                                             r
                                             
                                                30
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             r
                                             
                                                30
                                                k
                                                +
                                                τ
                                             
                                          
                                          ,
                                          
                                          k
                                          =
                                          
                                             {
                                             0
                                             ,
                                             …
                                             ,
                                             11
                                             }
                                          
                                          ,
                                          
                                          τ
                                          =
                                          
                                             {
                                             2
                                             ,
                                             …
                                             ,
                                             30
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (17)
                           
                              
                                 
                                    
                                       
                                          
                                             R
                                             
                                                m
                                                i
                                                n
                                             
                                          
                                          ≤
                                          
                                             r
                                             t
                                          
                                          ≤
                                          
                                             R
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                          
                                          t
                                          ∈
                                          
                                             {
                                             30
                                             k
                                             +
                                             1
                                             ,
                                             k
                                             =
                                             0
                                             ,
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     Customer ports and contracts constraints:
                     
                        
                           (18)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                v
                                                ∈
                                                
                                                   V
                                                   i
                                                
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                
                                                   i
                                                   d
                                                
                                                i
                                                t
                                             
                                          
                                          ≤
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          i
                                          ∈
                                          
                                             P
                                             C
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (19)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                D
                                                ̲
                                             
                                             
                                                i
                                                n
                                             
                                          
                                          ≤
                                          
                                             ∑
                                             
                                                v
                                                ∈
                                                
                                                   V
                                                   i
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   
                                                      i
                                                      n
                                                   
                                                   a
                                                
                                             
                                          
                                          
                                             q
                                             
                                                v
                                                i
                                                t
                                             
                                          
                                          
                                             C
                                             v
                                          
                                          ≤
                                          
                                             
                                                D
                                                ¯
                                             
                                             
                                                i
                                                n
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          
                                             P
                                             C
                                          
                                          
                                             ,
                                             n
                                             |
                                          
                                          
                                             C
                                             
                                                i
                                                n
                                             
                                          
                                          ∈
                                          
                                             C
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (20)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                v
                                                ∈
                                                
                                                   V
                                                   i
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   
                                                      i
                                                      n
                                                   
                                                   a
                                                
                                             
                                          
                                          
                                             q
                                             
                                                v
                                                i
                                                t
                                             
                                          
                                          
                                             C
                                             v
                                          
                                          +
                                          
                                             d
                                             
                                                i
                                                n
                                             
                                             −
                                          
                                          −
                                          
                                             d
                                             
                                                i
                                                n
                                             
                                             +
                                          
                                          =
                                          
                                             D
                                             
                                                i
                                                n
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          
                                             P
                                             C
                                          
                                          
                                             ,
                                             n
                                             |
                                          
                                          
                                             C
                                             
                                                i
                                                n
                                             
                                          
                                          ∈
                                          
                                             C
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (21)
                           
                              
                                 
                                    
                                       
                                          
                                             d
                                             
                                                i
                                                n
                                             
                                             +
                                          
                                          ,
                                          
                                          
                                             d
                                             
                                                i
                                                n
                                             
                                             −
                                          
                                          ≥
                                          0
                                       
                                    
                                    
                                       
                                          
                                          i
                                          ∈
                                          
                                             P
                                             C
                                          
                                          
                                             ,
                                             n
                                             |
                                          
                                          
                                             C
                                             
                                                i
                                                n
                                             
                                          
                                          ∈
                                          
                                             C
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     Maintenance port constraints:
                     
                        
                           (22)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                =
                                                
                                                   
                                                      T
                                                      ̲
                                                   
                                                   v
                                                   
                                                      
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      T
                                                      ¯
                                                   
                                                   v
                                                   m
                                                
                                                −
                                                
                                                   T
                                                   
                                                      v
                                                      m
                                                      
                                                         m
                                                         d
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                
                                                   l
                                                   d
                                                
                                                m
                                                t
                                             
                                          
                                          =
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          v
                                          ∈
                                          
                                             V
                                             m
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (23)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∉
                                                
                                                   T
                                                   v
                                                   M
                                                
                                             
                                          
                                          
                                             x
                                             
                                                v
                                                
                                                   l
                                                   d
                                                
                                                m
                                                t
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          v
                                          ∈
                                          
                                             V
                                             m
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The first term in the objective function is the total operating costs of the LNG vessels over the planning horizon. The second and the third terms are the total over/under and early/late delivery penalties associated with the long-term contracts served, respectively. The last term captures the operational costs associated with spot sales deliveries.

Constraints (2)–(5) are initialization constraints. They ensure all vessels originate from the origin port, o, and prevent any vessel going to two different ports during same time intervals. Constraints (6) and (7) ensure that each vessel terminates at the artificial destination port, d. Constraint (8) controls the flow of each vessel during the planning horizon. In this constraint, if a vessel arrived at port i at time t, then it should go to another port j that is accessible from port i at time 
                        
                           t
                           +
                           
                              T
                              
                                 v
                                 i
                                 j
                              
                           
                        
                     . Constraint (9) ensures that a vessel cannot be at more than one location at any point in time. Along with the initialization constraints, our flow constraints ensure a connected route for the vessels throughout the planning horizon. Constraint (10) is the inventory balance of a given vessel; and (11) ensures vessel inventory is within the limits of the vessel. Once a vessel reaches port d, its LNG inventory level is assumed to remain constant, i.e., inventory is not tracked. Constraint (12) states loading to or unloading from a vessel at a port can only happen if the vessel is visiting the port at that time period. Constraints (13) and (14) are the inventory balance and limits constraints for the loading port, respectively; and (15) is the berth capacity constraint at the loading port. Constraint (16) enforces that production rate can only be changed once every τ days. On the customer side, (18) is the berth capacity constraint at a given customer port. Constraint (19) ensures the delivery volume is within the contract limits. Constraint (20) defines the over and under delivered volumes, and constraint (21) indicates that they are nonnegative. Finally, constraint (22) ensures the maintenance starts on time, and constraint (23) limits the access to maintenance outside the scheduled period.

To the best of our knowledge, apart from our study, there are three other papers in the literature, i.e. Halvorsen-Weare and Fagerholt (2013), Rakke et al. (2011) and Stälhane et al. (2012) that have studied the ADP preparation problem. In this section, we benchmark our model against the existing models and discuss how these formulations can be expressed as special cases of our model.

The main difference between our model and the others is that our model allows for “split-delivery”, that is a vessel can visit and deliver its LNG cargo to multiple customer ports in a single tour. In all of the previous studies, a vessel is only allowed to visit and deliver its entire LNG cargo to a single customer port and then return back to the loading port. This practice is called “shipload delivery”. Shipload deliveries are thought to be cost-effective due to the scale economies of the operational expenses related to delivery. However, shipload deliveries may lead to excessive over or under deliveries. This may result in significant penalty costs when the associated contract does not offer sufficient flexibility. To the best of our knowledge, there is no study that demonstrates the superiority of “shipload delivery” rule over allowing for “split-delivery”. On the other hand, “split-delivery” is considered unsafe due to the increased risk of sloshing, i.e. the considerable movement of the LNG inside the vessel, which creates high impact pressure on the surface of the storage tank. At certain filling levels, sloshing can lead to structural damage to the vessel. Therefore, American Bureau of Shipping regulates that the filling level of a tank should be either more than 70 percent or less than 10 percent of the tank height (ABS, 2014). However, most LNG vessels consist of 4–6 isolated tanks (Curt, 2004), which makes split-delivery technically possible and safe, provided that deliveries are full tank-loads. There are several studies in the LNG-IRP literature that allow for “split-delivery” in modeling LNG routing problems (Grønhaug & Christiansen, 2009; Grønhaug et al., 2010). Furthermore, it is a common practice to use large LNG vessels as a docking station and transfer LNG from them to smaller vessels, another example of split-delivery.

Another advantage of our model is that it provides flexibility to the planner by introducing an artificial waiting port for each customer. With this, the schedule of voyages between ports can be adjusted to satisfy constraints such as delivery time windows, berth constraints at customer ports, and berth and inventory constraints at the loading port.


                        Halvorsen-Weare and Fagerholt (2013) only consider delivery time windows and penalty costs for deviations from expected delivery times. It also has bounds on delivery volumes but does not account for penalty charges for under and over delivery. Similarly, Rakke et al. (2011) and Stälhane et al. (2012) consider only hard delivery time windows and do not consider early or late delivery penalties. Furthermore, these formulations do not impose any bounds on the contract delivery volumes. Rakke et al. (2011) charges penalty for both under and over delivery but Stälhane et al. (2012) charges penalty only for under delivery. In light of this literature, our model also stands out as the most comprehensive among the existing formulations in terms of contract terms. It includes both hard and soft delivery time windows, lower and upper limits on delivery volumes, and penalty costs associated with deviations from expected delivery times and volumes.

Moreover, in the existing studies, production rate at the loading port is considered as a given parameter; whereas we model it as a decision variable that can be changed on a monthly basis. While preparing ADP, one of the major concerns is to manage excess production after fulfilling demand from long term contracts. In all of the previous studies, since production rate is a given parameter, excess production is assumed to be sold in the spot market. However, this assumption may not hold if there is not sufficient spot demand or available shipping (vessel) capacity.

Each of the previous studies models several features related to ADP, such as spot sales, maintenance of the vessels, and chartering of the vessels, at various levels of detail. Our model is the most comprehensive of all in terms of modeling spot sales and vessel maintenance. Furthermore, our model tries to develop an ADP using only the existing vessel fleet without allowing for chartering.

Finally, our model assumes constant sailing times between two locations as opposed to Rakke et al. (2011) and Stälhane et al. (2012), who formulate time-dependent travel times that change during the planning horizon.

We now discuss how other models can be derived from our model:

                           
                              1.
                              To enforce shipload deliveries, it suffices to restrict 
                                    
                                       
                                          P
                                          
                                             v
                                             i
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             l
                                             d
                                          
                                          ,
                                          d
                                          }
                                       
                                       ,
                                    
                                  for all pairs of vessel v and customer port i, for which 
                                    
                                       P
                                       
                                          v
                                          i
                                       
                                    
                                  is defined. Moreover, qvit
                                  is no longer needed as a decision variable and constraints (10)–(12) become unnecessary.

Contract terms can be relaxed as follows.
                                    
                                       (a)
                                       If we set 
                                             
                                                
                                                   P
                                                   
                                                      i
                                                      n
                                                   
                                                   −
                                                
                                                =
                                                
                                                   P
                                                   
                                                      i
                                                      n
                                                   
                                                   +
                                                
                                                =
                                                0
                                                ,
                                             
                                           the contract terms become equivalent to those of Halvorsen-Weare and Fagerholt (2013), which do not penalize under and over delivery. With this setting, under and over delivery constraints (20) and (21) are removed. Constraints (13) and (19) need to be revised as (24) and (25) respectively, as follows:

                                             
                                                (24)
                                                
                                                   
                                                      
                                                         s
                                                         t
                                                      
                                                      =
                                                      
                                                         s
                                                         
                                                            t
                                                            −
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         r
                                                         t
                                                      
                                                      −
                                                      
                                                         ∑
                                                         
                                                            v
                                                            ∈
                                                            V
                                                         
                                                      
                                                      
                                                         G
                                                         v
                                                      
                                                      
                                                         C
                                                         v
                                                      
                                                      
                                                         x
                                                         
                                                            v
                                                            
                                                               l
                                                               d
                                                            
                                                            l
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (25)
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     D
                                                                     ̲
                                                                  
                                                                  
                                                                     i
                                                                     n
                                                                  
                                                               
                                                               ≤
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     v
                                                                     ∈
                                                                     
                                                                        V
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  ∑
                                                                  
                                                                     t
                                                                     ∈
                                                                     
                                                                        T
                                                                        
                                                                           i
                                                                           n
                                                                        
                                                                        a
                                                                     
                                                                  
                                                               
                                                               
                                                                  G
                                                                  v
                                                               
                                                               
                                                                  C
                                                                  v
                                                               
                                                               
                                                                  x
                                                                  
                                                                     v
                                                                     
                                                                        i
                                                                        d
                                                                     
                                                                     i
                                                                     t
                                                                  
                                                               
                                                               ≤
                                                               
                                                                  
                                                                     D
                                                                     ¯
                                                                  
                                                                  
                                                                     i
                                                                     n
                                                                  
                                                               
                                                               ,
                                                               
                                                               i
                                                               ∈
                                                               
                                                                  P
                                                                  C
                                                               
                                                               
                                                                  ,
                                                                  n
                                                                  |
                                                               
                                                               
                                                                  C
                                                                  
                                                                     i
                                                                     n
                                                                  
                                                               
                                                               ∈
                                                               
                                                                  C
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       

If we set 
                                             
                                                
                                                   T
                                                   
                                                      i
                                                      n
                                                   
                                                   a
                                                
                                                ≡
                                                
                                                   T
                                                   
                                                      i
                                                      n
                                                   
                                                   e
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                      ̲
                                                   
                                                   
                                                      i
                                                      n
                                                   
                                                
                                                =
                                                0
                                             
                                           and 
                                             
                                                
                                                   
                                                      D
                                                      ¯
                                                   
                                                   
                                                      i
                                                      n
                                                   
                                                
                                                =
                                                ∞
                                                ,
                                             
                                           the contract terms become equivalent to those of Rakke et al. (2011). If we further set 
                                             
                                                
                                                   P
                                                   
                                                      i
                                                      n
                                                   
                                                   +
                                                
                                                =
                                                0
                                                ,
                                             
                                           the terms become identical to those of Stälhane et al. (2012).

The number of binary flow variables, xvijt
                        , is the most critical factor in solving our MIP model. In any feasible solution, most of these binary flow variables should be zero. In this section, we exploit this fact to enhance our MIP formulation by adding the following valid inequalities.

The first set of constraints, Eq. (26), state that a vessel v cannot sail to serve port j outside the range of allowed delivery dates. Constraint set (27) asserts that a vessel v can sail from port i to port j for at most once within a certain period of time. This period is computed as the sum of travel time from i to j, Tvij
                        , and the minimum possible time to sail back to i, denoted by τvji
                        . This minimum time is obtained dynamically as follows: 
                           
                              
                                 τ
                                 
                                    v
                                    j
                                    i
                                 
                              
                              =
                              
                                 min
                                 
                                    k
                                    ∈
                                    
                                       P
                                       
                                          v
                                          j
                                       
                                    
                                 
                              
                              
                                 {
                                 
                                    T
                                    
                                       v
                                       j
                                       k
                                    
                                 
                                 +
                                 
                                    τ
                                    
                                       v
                                       k
                                       i
                                    
                                 
                                 }
                              
                           
                        . Constraint set (28) ensures that the total number of vessels that serve a contract Cjn
                         cannot be less than βjn
                        , which is computed in the preprocessing stage and representing minimum necessary number of vessels that can ensure the satisfaction of minimum demand 
                           D
                         
                        
                           jn
                         for contract Cjn
                        . Finally, constraint set (29) asserts an upper bound on the number of times that a vessel can visit the loading port during the planning horizon.

                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             x
                                             
                                                v
                                                i
                                                j
                                                t
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0
                                             ,
                                             
                                             j
                                             ∈
                                             
                                                P
                                                C
                                             
                                             ,
                                             v
                                             ∈
                                             
                                                V
                                                j
                                             
                                             ,
                                             i
                                             ∈
                                             
                                                P
                                                
                                                   o
                                                
                                                
                                                   v
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                n
                                                |
                                             
                                             
                                                C
                                                
                                                   j
                                                   n
                                                
                                             
                                             ∈
                                             
                                                C
                                                j
                                             
                                             
                                                ,
                                                t
                                                ∈
                                                T
                                                ∖
                                             
                                             
                                                T
                                                
                                                   j
                                                   n
                                                
                                                a
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   a
                                                   =
                                                   t
                                                
                                                
                                                   t
                                                   +
                                                   
                                                      T
                                                      
                                                         v
                                                         i
                                                         j
                                                      
                                                   
                                                   +
                                                   
                                                      τ
                                                      
                                                         v
                                                         j
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   v
                                                   i
                                                   j
                                                   a
                                                
                                             
                                             ≤
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                             v
                                             ∈
                                             V
                                             ,
                                             i
                                             ∈
                                             
                                                P
                                                v
                                             
                                             ,
                                             j
                                             ∈
                                             
                                                P
                                                
                                                   v
                                                   i
                                                
                                             
                                             ,
                                             a
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   v
                                                   ∈
                                                   
                                                      V
                                                      j
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      P
                                                      
                                                         o
                                                      
                                                      
                                                         v
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   
                                                      T
                                                      
                                                         j
                                                         n
                                                      
                                                      a
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   v
                                                   i
                                                   j
                                                   t
                                                
                                             
                                             ≥
                                             
                                                β
                                                
                                                   j
                                                   n
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                             j
                                             ∈
                                             
                                                P
                                                C
                                             
                                             
                                                ,
                                                n
                                                |
                                             
                                             
                                                C
                                                
                                                   j
                                                   n
                                                
                                             
                                             ∈
                                             
                                                C
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                x
                                                
                                                   v
                                                   
                                                      l
                                                      d
                                                   
                                                   l
                                                   t
                                                
                                             
                                             ≤
                                             
                                                N
                                                v
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The maximum number of times that vessel v can visit the loading port, 
                           
                              
                                 N
                                 v
                              
                              ,
                           
                         is computed by solving the following MIP model:

                           
                              (30)
                              
                                 
                                    max
                                    
                                       N
                                       v
                                    
                                 
                              
                           
                        subject to


                        (2), (4), (5), (6), (8), (9), and

                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                x
                                                
                                                   v
                                                   
                                                      l
                                                      d
                                                   
                                                   l
                                                   t
                                                
                                             
                                             ≥
                                             
                                                N
                                                v
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      P
                                                      ∘
                                                      
                                                         v
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                x
                                                
                                                   v
                                                   i
                                                   j
                                                   t
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      P
                                                      ∘
                                                      
                                                         v
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      n
                                                      |
                                                   
                                                   
                                                      C
                                                      
                                                         j
                                                         n
                                                      
                                                   
                                                   ∈
                                                   
                                                      C
                                                      j
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   
                                                      T
                                                      
                                                         j
                                                         n
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   v
                                                   i
                                                   j
                                                   t
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                             j
                                             ∈
                                             
                                                P
                                                v
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As discussed before, constraints (2)–(9) are initialization, flow, termination, and berth capacity constraints. Constraint (31) finds the maximum number of visits to loading port l and constraint (32) asserts that vessel v will not visit any customer port outside the time windows of the contracts.

Our numerical analysis reveals that for practical problem sizes, commercial solvers, such as CPLEX©, cannot provide even a feasible solution to our MIP formulation introduced in Section 3 within a reasonable run time. We also tested for fairly small problem instances, e.g., two vessels and four customers; and even these instances could not be solved optimally within 24 hours of run-time. Given this observation, we develop a novel vessel routing heuristic (VRH) that can quickly construct multiple cost-effective solutions, which can be used as a set of starting solutions to be improved by commercial solvers.

VRH iteratively constructs an ADP by ensuring the delivery time and volume requirements of each contract. The algorithm first ranks the contracts and the processes them one by one. For the contract under process, our heuristic first selects the vessels that will deliver to this contract, then schedules the travel dates of the selected vessels to the contract’s port (and the travel date to the liquefaction port if the selected vessel has to first go to the liquefaction port), and finally decides on the volume that each selected vessel will deliver to the contract. Vessel locations and inventory levels are updated before moving to the next contract. At the scheduling step, both berth and inventory availabilities at the liquefaction port are checked. However, it is not possible to ensure the maximum inventory limitation for the liquefaction port, i.e., st
                         ≤ Smax
                        , at this stage. This constraint is checked when all the contracts are processed. If there is any violation on any given day, our heuristic reschedules the arrivals of the vessels to the liquefaction port following a local search. After rescheduling, remaining excess production is scheduled for spot sales on appropriate days.

VRH develops an ADP based on a given daily production rate, rt
                        , which can directly be used by LNG suppliers. Alternatively, one may feed the constructed routes of VRH solution, i.e., the xvijt
                         values, to the MIP formulation; and the reduced problem, which includes st, rt
                        , and qvit
                        , can be solved fairly quickly. In this paper, we take the second approach. An outline of proposed VRH is given in Algorithm 1
                        .

The novelty of the proposed VRH lies in its vessel selection procedure for the contract under processing. For a given contract 
                           
                              
                                 C
                                 
                                    i
                                    n
                                 
                              
                              ,
                           
                         VRH first generates a list of vessels, Vin
                        , which can serve this contract. Vin
                         is a subset of 
                           
                              
                                 V
                                 i
                              
                              ,
                           
                         consisting of vessels that can deliver LNG within the time window of 
                           
                              C
                              
                                 i
                                 n
                              
                           
                        . Those vessels either have inventory and can reach to port i from their current location before the end date of 
                           
                              T
                              
                                 i
                                 n
                              
                              a
                           
                         or they can sail to the loading port, load LNG, and then reach to port i before the end date of 
                           
                              T
                              
                                 i
                                 n
                              
                              a
                           
                        . Furthermore, if a vessel can make several visits to port i within 
                           
                              C
                              
                                 i
                                 n
                              
                           
                         through the loading port, copies of this vessel are also added to the list. Vessels that will deliver to contract 
                           
                              C
                              
                                 i
                                 n
                              
                           
                         are selected according to the solution of the following MIP problem:

                           
                              (33)
                              
                                 
                                    min
                                    
                                       ∑
                                       
                                          v
                                          ∈
                                          
                                             V
                                             
                                                i
                                                n
                                             
                                          
                                       
                                    
                                    
                                       C
                                       v
                                    
                                    
                                       x
                                       v
                                    
                                    +
                                    
                                       P
                                       
                                          i
                                          n
                                       
                                       −
                                    
                                    
                                       d
                                       −
                                    
                                    +
                                    
                                       P
                                       
                                          i
                                          n
                                       
                                       +
                                    
                                    
                                       d
                                       +
                                    
                                    +
                                    
                                       P
                                       
                                          v
                                          i
                                          n
                                          
                                             t
                                             v
                                             e
                                          
                                       
                                    
                                    
                                       x
                                       v
                                    
                                 
                              
                           
                        subject to

                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   v
                                                   ∈
                                                   
                                                      V
                                                      
                                                         i
                                                         n
                                                      
                                                   
                                                
                                             
                                             
                                                g
                                                
                                                   v
                                                   
                                                      t
                                                      v
                                                      e
                                                   
                                                
                                             
                                             
                                                x
                                                v
                                             
                                             ≥
                                             
                                                
                                                   D
                                                   ̲
                                                
                                                
                                                   i
                                                   n
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                             v
                                             ∈
                                             
                                                V
                                                
                                                   i
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   v
                                                   ∈
                                                   
                                                      V
                                                      
                                                         i
                                                         n
                                                      
                                                   
                                                
                                             
                                             
                                                g
                                                
                                                   v
                                                   
                                                      t
                                                      v
                                                      e
                                                   
                                                
                                             
                                             
                                                x
                                                v
                                             
                                             −
                                             
                                                d
                                                +
                                             
                                             +
                                             
                                                d
                                                −
                                             
                                             =
                                             
                                                D
                                                
                                                   i
                                                   n
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                             v
                                             ∈
                                             
                                                V
                                                
                                                   i
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This MIP selects the vessels from Vin
                         that minimize the sum of the operational and penalty costs of serving to contract 
                           
                              C
                              
                                 i
                                 n
                              
                           
                        . In this formulation, xv
                         denotes the binary variable that indicates whether vessel v is selected or not; Cv
                         is the total operational cost of sending vessel v from its current location to port i; and 
                           
                              t
                              v
                              e
                           
                         is the earliest time that vessel v becomes available for the contract. If a vessel is making multiple trips for this contract, Cv
                         includes the costs of those tours as well as port visits. On the other hand, if 
                           
                              t
                              v
                              e
                           
                         is earlier than the beginning of the contract’s outer time window, then it is set to the beginning of 
                           
                              T
                              
                                 i
                                 n
                              
                              a
                           
                        .


                        Eq. (33) minimizes the total travel related costs, over and under delivery penalties, and early and late delivery penalties. Constraint (34) ensures that the total delivery is at least the minimum demand of the contract 
                           
                              C
                              
                                 i
                                 n
                              
                           
                        . In constraint (34), one can use various 
                           D
                         
                        
                           in
                         values, other than what is specified in 
                           
                              
                                 C
                                 
                                    i
                                    n
                                 
                              
                              ,
                           
                         by setting 
                           
                              
                                 
                                    D
                                    ̲
                                 
                                 
                                    i
                                    n
                                 
                              
                              =
                              α
                              
                                 D
                                 
                                    i
                                    n
                                 
                              
                              ,
                           
                         where α is a parameter between 0 and 1. This is possible due to the fact that, in practice if the planned LNG delivery volume in the ADP is less than the specified 
                           D
                         
                        
                           in
                         in the contract, the remaining amount can be outsourced from the spot market and the associated extra cost can be included in the underdelivery penalty, without loss of generality. In Section 5.2, we discuss the impact of various α values on the solution quality in our numerical study. Constraint (35) computes the under or overdelivery amount if it exists. We note that, the above model is a variant of the well-known knapsack problem, and it can be solved by commercial solvers in a very short time given the small cardinality of set Vin
                         in realistic problem sizes.

VRH, described with Algorithm 1, assigns a set of available vessels and assigns them to the contract under process. When a vessel is assigned and if it has to first go the liquefaction port, the algorithm may schedule it to wait at the artificial port of the liquefaction port before it can deliver for this contract. During this waiting period, they appear unavailable for the subsequent contracts considered in the VRH. In some cases, this waiting time can be long enough that the vessel can serve to another contract and come back within this waiting period. To exploit this opportunity, we add a post-processing step to VRH, which is described in the following Algorithm 2
                        . The checks such waiting vessels and tries to send them to underdelivered contracts when possible.

VRH starts by ranking the contracts. In fact, the order of contracts is an important factor affecting the solution quality. VRH can generate a feasible and cost effective ADP in only a few seconds. This allows us to try alternative contract permutations, and run the algorithm several times. For this purpose, we implement an iterative algorithm that updates the order of contracts and runs VRH. The algorithm, which is named as the multiple vessel routing heuristic (MVRH) is described in Algorithm 3
                        .

We follow a dual strategy for reranking the contracts. In the first strategy, we review the solution of the VRH and push the contracts with high underdelivery penalty up in the ranked list. As a second strategy, at certain iterations we randomly rerank the list of contracts. The advantage of random reranking is two-fold: first, the selective reranking can go into a loop after several iterations and does not generate a new permutation; and second, explore alternative contract rankings.

The contract reranking algorithm is described in Algorithm 4.

In our numerical study, we run the contract reranking algorithm in two alternative ways: (i) run it by only reranking the underdelivered contracts as described in Steps 2–11 of Algorithm 4
                        , namely Selective Reranking, and (ii) run it randomly as described in Steps 13–17 of Algorithm 4.

We conducted an extensive computational study with the aim of (i) assessing the performance of the proposed solution approach, (ii) analyzing the impact of various problem parameters on the solution quality, and (iii) quantifying the value of allowing for split-deliveries. For this purpose, we generated 18 problem instances using data from a commercial LNG trade database. We coded the mathematical model using C++ language with Xcode 6 IDE with IBM ILOG Concert Technology and solved the MIP using CPLEX 12.6. We performed the runs on a 2.7 gigahertz quad-core processor and 32 gigabyte RAM computer running on Mac OSx environment.

For aim (i), we first solved our MIP formulation using CPLEX with a time limit of 24 hours. We refer to this method as the exact method (EM). In addition, we solved the same problem instances employing the proposed VRH and compared the solutions of the two alternative methods.

For aim (ii), we investigated how solution quality changes as the following problem parameters vary:

                        
                           •
                           
                              Demand Seasonality (DS): This is a common phenomenon in energy demand. We quantify demand seasonality by computing the coefficient of variation of total monthly demand.


                              Demand to production capacity ratio (ρP): This is the ratio of total expected contractual volume and the annual production capacity.


                              Demand to transport capacity ratio (ρV): This is the ratio of total expected contractual volume and the total vessel capacity. ρV
                               approximates the average number of tours that a vessel should complete throughout the planning horizon.


                              Storage capacity to production capacity ratio (ρI): This is equal to Smax
                              /Rmax
                              . Having a high ρI
                               provides flexibility to the planner in terms of production and vessel scheduling at the loading port. On the other hand, a low ρI
                               necessitates a better synchronization of production and scheduling of vessels for loading.

For aim (iii), we modified our MIP formulation and problem instances as described in Section 3.1, and solved various problem instances under no-split rule. We compared the split-delivery and no-split delivery solutions.


                        Table 1
                         presents important parameters of the 18 problem instances. Those instances are categorized into three classes according to their sizes: class A problems have the size of small-to-medium LNG providers, class B problems represent medium-large suppliers, and class C problems represent the size of world’s largest LNG providers. Within each class, the first four instances have low demand seasonality, and are ranked in the increasing order of ρP
                        . The latter two in each class have high demand seasonality. In all of these instances, ρI
                         is fixed at 6.

We reiterate that the nature of contracts varies from one customer to another. Some customers may have regular monthly contracts, while others have only a few contracts throughout the planning horizon. Furthermore, some contracts may have tight delivery time windows and/or delivery volume requirements, whereas other contracts may have extended delivery time windows and less restrictive contract volume requirements. In our computational study, we generated sample problem instances to represent all of these variations.

The VRH uses several parameters (r, α, Nmax, Nimp
                        , and L) discussed in Section 4.4. In addition, the contract reranking algorithm within VRH algorithm can be implemented in two different settings, selective or random reranking. The performance of the VRH algorithm varies with the choice of parameters and the reranking rule.

We performed an extensive parameter testing in order to decide the best parameter set to use in the computational study. In this test, instead of Nmax
                        , we used a time limit of three minutes, and set 
                           
                              
                                 N
                                 
                                    i
                                    m
                                    p
                                 
                              
                              =
                              10
                           
                        . For the remaining parameters, we used the values presented in Table 2
                        .

We observed that none of the parameter set is superior to others for all the problem instances. Furthermore, there isn’t any insightful trend for the choice of parameter values. For instance, 
                           
                              r
                              =
                              
                                 R
                                 
                                    m
                                    a
                                    x
                                 
                              
                           
                         and 
                           
                              α
                              =
                              0.8
                           
                         with selective contracting reranking leads to the lowest cost for C1 problem, but the second highest cost for A1 problem. Since the VRH algorithm runs fast enough, we then solved each problem instance using each possible parameter set. Thus, VRH algorithm was run 18 times for each problem instance.
                     

On the other hand, we report that the performance of the VRH algorithm does not change with the selection of the parameters significantly. The coefficients of variation for the costs obtained by different parameters are 0.04, 0.04, and 0.03 for the A, B, and C problems, respectively.

@&#RESULTS@&#

For each of the 18 problem instances in Table 1, we first solved our MIP formulation with a fixed run time of 24 hours using CPLEX. In all instances, this exact method (EM) was able to generate the first feasible solution after more than 18 hours of run time. Furthermore, we set VRH to run for a maximum of four minutes to generate ADPs for different permutations of the contracts. For a given permutation of contracts, VRH generates an ADP approximately in one second for class A problems and in two seconds for class C problems. We ran VRH for a maximum of 180 seconds for each of the 18 heuristic parameter combinations described above. Then, we introduced the xvijt
                         variables obtained with VRH to the master problem, and solved the reduced problem either for 600 seconds, or till the optimality gap reduces below 3 percent, or the lower bound of the reduced problem exceeds the best solution obtained so far. Hence, the total run time for the VRH was limited to a maximum of 18*780 = 14040 seconds, which is approximately four hours. We experienced that the actual run time was less than four hours for all the problem instances.

The EM and VRH solutions are presented Table 3. The optimality gaps are computed by comparing the solutions of the two methods to the lower bound obtained with EM. We observe that percentage gaps, which is computed as (cost-lower bound)/lower bound, are high for both EM and VRH solutions. This is due to the weakness of the lower bound given the large number of binary variables. In terms of solution quality, VRH outperforms EM in all problem instances. The average cost savings of the VRH solutions over the EM is 20.1 percent. We also observe that the performance of the VRH is steady and predictable. On the contrary, EM performance is rather erratic. For instance, EM performs poorly for B3 but performs relatively better for C3, which is a larger problem instance.

Both EM and VRH performances reduce as the problem difficulty increases. Fig. 1 illustrates how optimality gap for VRH increases as ρP
                         increases.

Demand seasonality (DS) affects the solution quality, as well. We note that, in each class of problems studied, instances 5 and 6 are counterparts of instances 2 and 3, respectively, with higher demand seasonality. Fig. 2 presents that in all problem classes, solution quality degrades with increasing demand seasonality.

Furthermore, we performed sensitivity analysis on ρI
                        , the ratio of storage capacity at the liquefaction port to the production capacity. In our base problem instances, ρI
                         is set to 6. We also analyze the cases where ρI
                         is set to 8, 10, and 12. We first investigate the total cost of ADP developed with VRH at various ρI
                        
                         values. Fig. 3
                        
                         illustrates the average percentage cost savings over the base-case (
                           
                              
                                 ρ
                                 I
                              
                              =
                              6
                           
                        ) cost with respect to the increases in ρI
                         for each problem class. The savings can reach to 40 percent when ρI
                         (storage capacity) is doubled.

Finally, we compare the split- and no-split delivery solutions. Intuitively, the optimal split-delivery solution is better than the optimal no-split delivery one. However, it may not be possible to solve both problems optimally within a reasonable time. Considering the fact that the no-split delivery rule leads to a much smaller problem size, the best attainable solution for the no-split case could be better than the one allowing for split delivery. As shown in Table 4, allowing for split delivery in ADP planning, which was ignored by previous studies in the literature, may lead to substantial cost reductions. For our problem set, the average savings is 4.2 percent. We observe that the benefit of split-deliveries increases as the rate of contractual demand to total production capacity, i.e., ρD
                         increases.

@&#CONCLUSIONS@&#

Developing a cost effective ADP in the upstream LNG supply chains is a fairly challenging task for LNG suppliers. As opposed to earlier studies, our study incorporates many practical aspects of this planning problem. Furthermore, we propose a novel and efficient heuristic solution approach for this problem that can be used as a practical decision support tool by the logistic planners of LNG suppliers. As the extensive computational work in this study reveals, our proposed heuristic approach can generate significantly lower cost solutions compared to commercial optimizers. Furthermore, our heuristic method can generate many alternative feasible solutions in a few minutes of run time, significantly outperforming the commercial solvers. Our study also reveals as an important managerial insight: contrary to the common belief in practice, allowing for split-deliveries in ADP may lead to substantial cost reductions along the upstream LNG supply chains.

In order to cover various market conditions, we conduct an extensive sensitivity analysis on problem parameters. Due to being sensitive to global macro-economic trends, political developments, and technological advances, energy markets bear high volatility. Moreover, LNG suppliers have to cope with changing contractual terms and fluctuating prices, while investing in additional production and transportation capacities. To counter these, we solve problem instances with various degrees of supply–demand mismatch, demand seasonality and storage capacity–production capacity ratios. The proposed heuristic solution approach consistently generates high quality solutions under various market conditions.

Our work could be extended in several other directions. In this paper, we focus on ADP planning at the tactical level which spans an approximate period of one year. In operational planning, short term planning and replanning problems are other important considerations that need to be addressed. In short term planning, which is typically up to three months, the relevant portion of the ADP could be considered as an initial input and updates could be made according to the changes in vessel status, production rates, spot sales opportunities, weather and route conditions, and demand of customers.

In addition to cost minimization, profit maximization stands out as another relevant objective, when we focus on spot sales. Since spot markets are volatile, a stochastic programming might be a more appropriate approach to tackle this problem.

Developing robust ADPs with respect to capacity levels and renegotiations of contractual terms are other important considerations for LNG suppliers. An important direction for further research is developing multi-criteria optimization models for ADP preparation, which pay due attention to robustness and cost effectiveness concurrently.

@&#ACKNOWLEDGMENT@&#

This research was made possible by the NPRP award NPRP 4-453-5-059 from the Qatar National Research Fund (a member of The Qatar Foundation). The statements made herein are solely the responsibility of the authors.

@&#REFERENCES@&#

