@&#MAIN-TITLE@&#Respiratory motion correction in dynamic MRI using robust data decomposition registration – Application to DCE-MRI

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A registration technique based on low rank – sparse data decomposition is introduced.


                        
                        
                           
                           Registration is applied to dynamic contrast enhanced MRI.


                        
                        
                           
                           Errors in the monitoring of enhancement in dynamic contrast enhanced MRI are reduced.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Registration

Respiratory motion correction

Dynamic contrast-enhanced MRI

Robust principal component analysis

@&#ABSTRACT@&#


               
               
                  Motion correction in Dynamic Contrast Enhanced (DCE-) MRI is challenging because rapid intensity changes can compromise common (intensity based) registration algorithms. In this study we introduce a novel registration technique based on robust principal component analysis (RPCA) to decompose a given time-series into a low rank and a sparse component. This allows robust separation of motion components that can be registered, from intensity variations that are left unchanged. This Robust Data Decomposition Registration (RDDR) is demonstrated on both simulated and a wide range of clinical data. Robustness to different types of motion and breathing choices during acquisition is demonstrated for a variety of imaged organs including liver, small bowel and prostate. The analysis of clinically relevant regions of interest showed both a decrease of error (15–62% reduction following registration) in tissue time–intensity curves and improved areas under the curve (AUC60) at early enhancement.
               
            

@&#INTRODUCTION@&#

Dynamic Contrast-Enhanced MRI (DCE-MRI) provides a morphologic and functional depiction of pathologies and is widely used as a biomarker in oncology (Jackson et al., 2007; Türkbey et al., 2010) and for various types of diseases (Bae et al., 2012; Ziech et al., 2012). Such a technique relies on the monitoring (uptake and washout) of a contrast agent – usually Gadolinium based – providing tumor delineation and assessment of tissue vascular properties (Knopp et al., 2003). DCE-MRI is usually achieved by performing fast gradient echo MRI sequences to obtain a set of T1-weighted image frames before, during, and after the administration of contrast agent. The contrast agent concentration over time can be derived from the MR images using an assumed relationship with pixel intensities. A pharmacokinetic model is then fit at every pixel to the concentration of Gadolinium as a function of time, resulting in kinetic parameters values that may be correlated with tissue characteristics (Tofts, 2010).

In order to monitor contrast agent uptake and washout, acquisition times of the order of minutes are required. Hence patient motion (e.g. breathing, heartbeat and bowel peristalsis) during the acquisition can cause inter-frame misalignments. In extreme cases, the magnitude of motion due to breathing can be as large as 80mm (Plathow et al., 2004) along the superior–inferior axis in organs close to the diaphragm. These misalignments have a strong impact on the analysis of DCE-MR data since apparent intensity changes will be related to a mixture of motion and contrast agent changes, leading to a bias in the derived enhancement parameters and yielding incorrect information on tissue properties; in particular, motion during the contrast agent arrival phase can bias the estimation of pharmacokinetic parameters used to assess local tissue permeability.

Several strategies including image registration methods have been developed to overcome the effect of motion and provide well aligned features across the images. Nevertheless developing an (intensity based) registration scheme specific to DCE-MRI data is challenging since changes due to motion and those corresponding to contrast enhancement must be differentiated. Conventional registration algorithms are likely to fail with DCE-MRI data as important local intensity changes across the different time-points can be interpreted as motion and produce a non-realistic expansion or contraction of the volume (Rohlfing et al., 2003; Tanner et al., 2007).

The possibility of avoiding unphysical volume changes caused by local intensity variations due to contrast enhancement has been investigated in several studies. The multi-resolution fast free-form deformation (FFD) based on b-splines with normalized mutual information (NMI) as a similarity measure by Rueckert et al. (1999) has been used as a basis to address the problem of misalignments in DCE-MR time-series. In many cases a specific regularization term was introduced to limit non-realistic deformations (Tanner et al., 2000, 2007; Rohlfing et al., 2003). Zheng et al. (2010) developed a new method based on FFD in order to register breast images. In this approach a Lorentzian estimator is used as a similarity measure, combined with a reformulation of the energy function minimization using linear programming. Li et al. (2012) recently registered high temporal resolution free-breathing contrast enhanced images of the bowel. In this method a retrospective respiratory gating is applied to the data and the remaining images are sequentially registered using a transformation model based on a combination of discrete cosine transformation basis functions (Ashburner and Friston, 2003).

Another class of methods dedicated to the problem of DCE-MRI registration are those that use a pharmacokinetic model to drive the registration processes. Hayton et al. developed a registration scheme that incorporates such a model and applied it to the analysis of breast images (Hayton et al., 1997). This relies on the assumption that the better the alignment between images in the time-series, the lower the residual difference between the model fit and the actual data. Therefore model fitting results can be used as a cost function for registration. Xiaohua et al. (2005) proposed simultaneous segmentation and registration using Markov random fields combined with a similar model. Buonaccorsi et al. (2007) introduced a method based on the modified Tofts model (Tofts, 1997, 2010). By iteratively fitting such a model to the unregistered data, a motion-free synthetic time-series based on the resulting pharmacokinetic parameters map can be created and used as a reference for rigid registration. More recently Bhushan et al. proposed a joint estimation of the deformation and contrast enhancement based on a Bayesian framework (Bhushan et al., 2011).

As an alternative to registration, Filipovic et al. (2011) introduced a technique based on the generalized reconstruction by inversion of coupled systems (Odille et al., 2008) which uses extra physiological measurements (e.g. pneumatic respiratory belts) as a model and compensates motion in raw MR data.

A further approach is to separate motion from contrast enhancement before registration. Melbourne at al. introduced an algorithm named progressive principal component registration (PPCR) that gradually removes misalignments (Melbourne et al., 2007, 2011). The method is based on the iterative use of principal component analysis (PCA) combined with a standard registration algorithm such as multi-resolution FFD (Modat et al., 2010). In PCA, contrast changes are assumed to appear in the more significant principal components and motion in the less significant. This is used to create a synthetic motion-free set of target images using a limited number of principal components that correspond to contrast enhancement. It has been utilized to register both liver and breast data acquired using repeat breath-hold protocols (Melbourne et al., 2007, 2011). However, the ability of PCA to disentangle motion from contrast enhancement depends on the nature of motion: for instance, the periodic motion of free breathing can appear in the more significant principal components along with contrast changes. More recently Wollny et al. investigated the use of independent component analysis to decompose data prior to registration in free breathing cardiac MRI (Wollny et al., 2012). In this case too, the objective is to remove motion elements to form a synthetic target time-series.

In this study we introduce a novel registration approach specifically designed to address the problem of misalignments in DCE-MR time-series. Similar to (Melbourne et al., 2007; Wollny et al., 2012), our method is based on the assumption that motion can be separated from contrast enhancement, but here we chose Robust Principal Component Analysis (RPCA) for data decomposition (Candès et al., 2009). RPCA reformulates decomposition as an optimization problem to recover the sparse and low rank components of the input data. Our hypothesis is that RPCA coupled with a registration algorithm based on residual complexity minimization (Myronenko and Song, 2010) provides accurate registration of DCE time series in a broad range of organs and for various breathing protocols. Given the explicit separation of a sparse term, RPCA should allow more flexibility and a greater degree of robustness than regular PCA, and can potentially benefit DCE-MRI registration. Importantly, it is expected to have a particular impact at critical times such as the arrival of contrast agent bolus.

Several frameworks aimed at decomposing a given matrix into low-rank and sparse components have emerged recently (Candès et al., 2009; Chandrasekaran et al., 2009; Yuan and Yang, 2019). Applications include background modeling in video surveillance and facial recognition as well as medical image processing (Trémoulhéac et al., 2012). Our application of Robust PCA (RPCA) decomposes a cine series into a low rank component (e.g. smooth and slowly varying changes affecting most of the field of view) and a sparse component (e.g. rapid and local intensity changes). For DCE-MRI, we attribute the sparse component to local contrast changes and motion to the low rank.

Let M be a Casorati matrix with each column being formed from all the pixels of a 2D time-frame. RPCA splits such a matrix into a low rank component L and a sparse component S. This is achieved under the constraint that the sum of L and S must correspond exactly to the initial dataset M. It was shown that such a decomposition can be formulated as an optimization problem (Candès et al., 2009):
                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                          
                                             minimize
                                             
                                             ‖
                                             L
                                             
                                                
                                                   ‖
                                                
                                                
                                                   ∗
                                                
                                             
                                             +
                                             λ
                                             ‖
                                             S
                                             
                                                
                                                   ‖
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             subject to
                                             
                                             L
                                             +
                                             S
                                             =
                                             M
                                          
                                       
                                    
                                 
                              
                           
                        where ||·||∗ and ||·||1 respectively represent the nuclear norm (i.e. the sum of the matrix singular values) and the l
                        1-norm (i.e. the sum of the absolute values of the matrix elements). The parameter λ appearing in (1) is a trade-off parameter: for high values all the information will appear in L while S will be empty, and vice-versa. The optimal setting of λ may depend on the application and the nature of the data. However, a suggested value independent of any knowledge of expected rank or sparsity was introduced in Candès et al. (2009):
                           
                              (2)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1
                                 /
                                 
                                    
                                       max
                                    
                                 
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                           
                        where Np
                         and Nt
                         respectively represent the number of pixels in each frame and the number of time-frames in M. For practical images, this means:
                           
                              (3)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1
                                 /
                                 
                                    
                                       
                                          
                                             N
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        
                     

The information in DCE-MR time-series can be regarded as a combination of motion related changes, and local changes caused by contrast enhancement. We hypothesize that RPCA makes it possible to correct for low rank motion elements via registration without confounds from contrast agent induced changes of intensity as shown in Fig. 1
                           .

We consequently introduce a novel algorithm for DCE-MRI registration named Robust Data Decomposition Registration (RDDR). The process of RDDR can be described as follows: a given DCE time-series is reshaped as a (Np
                            by Nt
                           ) Casorati matrix and decomposed using RPCA with a starting value λ
                           init for the trade-off parameter (see Section 2.2.3). The time-frames from the resulting low-rank component are then registered. The resulting deformation fields are applied to the original time-series so that a part of the motion can be removed. The process is then repeated for increasing values of the trade-off parameter over a fixed number of iterations, independent of the number of time-points in the dataset. This process is summarized in Fig. 2
                           . One should notice that deformation fields generated at each registration stage are not directly applied to images but added to a single global deformation field so that loss of information caused by multiple resampling is avoided.

Since motion components and contrast changes cannot be perfectly separated with RPCA, an iterative approach is used. By using gradually increasing values of the trade-off parameter, it is possible to control the amount of motion included in the low-rank matrix.

In principle, any non-rigid registration technique could be used to register the low-rank frames and update the deformation field in Fig. 2. However, the separation between motion and contrast is not perfect in the decomposition and part of the changes due to contrast are likely to remain in the low rank matrix (e.g. slow washout process in healthy tissue) especially for higher values of λ. To account for such effects we chose a registration algorithm that is robust to intensity changes (Myronenko and Song, 2010). The similarity metric it utilizes, named residual complexity (RC), incorporates an intensity correction field that brings the source and the target images into agreement in the intensity space. RC favors the transformation that leads to the minimum complexity of the residual difference image. This is achieved by measuring the sparseness of the residual in terms of the discrete cosine transform (DCT) basis functions. The transformation model used is the b-spline based FFD (Rueckert et al., 1999) with a gradient descent optimization scheme.

Considering two (low-rank) time-frames L
                           target and L
                           source to be registered with the unknown transformation T
                           FFD, given the intensity correction field I
                           corr and the noise component η (both unknown). The following relationship can be written:
                              
                                 (4)
                                 
                                    
                                       
                                          I
                                       
                                       
                                          target
                                       
                                    
                                    =
                                    
                                       
                                          I
                                       
                                       
                                          source
                                       
                                    
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          FFD
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          I
                                       
                                       
                                          corr
                                       
                                    
                                    +
                                    η
                                 
                              
                           
                        

Registration can be achieved by minimizing the following objective function, E:
                              
                                 (5)
                                 
                                    E
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          corr
                                       
                                    
                                    ,
                                    
                                       
                                          T
                                       
                                       
                                          FFD
                                       
                                    
                                    )
                                    =
                                    ‖
                                    
                                       
                                          I
                                       
                                       
                                          target
                                       
                                    
                                    -
                                    
                                       
                                          I
                                       
                                       
                                          source
                                       
                                    
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          FFD
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          I
                                       
                                       
                                          corr
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    β
                                    ‖
                                    
                                       
                                          PI
                                       
                                       
                                          corr
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        

The operator ||·|| represents the Euclidean norm, and P and β respectively are the regularization operator and the regularization parameter. The form of P is chosen as the first order derivative regularizer. I
                           corr can be analytically solved, and the DCT basis function is chosen for eigen-decomposition leading to the final form of E. More details can be found in Myronenko and Song (2010).

@&#IMPLEMENTATION DETAILS@&#

The RPCA trade-off parameter λ affects the amount of information in the L and S components; Fig. 3
                            shows the variation of the rank of L with λ for a small bowel DCE-MRI dataset with no registration applied. At each iteration of the RDDR algorithm, λ is increased from a starting value chosen to yield a rank of L equal to the number of frames divided by four (with a tolerance of ±10%). This starting value was chosen empirically as a value that provides some motion information in L, but keeps much of the contrast change in S. The maximum value of λ was selected based on 5 datasets, in such a way that the quantity of non-zero pixels in the RPCA sparse component remains above a threshold of 5%. This was found to be 2.5 times the starting value. Due to the approximately exponential curve shape seen in Fig. 3, we increment λ logarithmically. We choose a number of iterations (i.e. similar to samples of the curve in Fig. 3) limited to 10 for the entire process. The same scheme for setting λ was used for all datasets presented in this paper.

At each iteration, a groupwise multi-resolution registration is used. The target image is the mean of all the low-rank frames at the current resolution stage. This target is then updated using the current deformation when moving to a finer resolution. The FFD control point spacing was set to 4 pixels, 2 resolution levels (1/2 and 1) were used and the bending used as a regularizer of the deformation field energy (Rohlfing et al., 2003). As shown in Fig. 3 some features present fuzzy contours for lower λ values, we consequently chose to use a high weight on the regularization (similar to Wollny et al. (2012)).

The performance of RDDR was assessed using two simulations. In each case a ground truth motion was derived from volunteer scans and contrast enhancement simulated using literature pharmacokinetic parameters. In the first case, a gradient echo T1-weighted DCE protocol was used to acquire liver time series data during repeat breath-holds but without the injection of contrast (3s temporal resolution, coronal plane, 155s acquisition, 1.9×1.9×5mm3 voxels). In the second case, a balanced gradient echo series of the small bowel was acquired during free breathing in the coronal plane through the abdomen (1s temporal resolution, coronal plane, 52s acquisition, 1×1×5mm3 voxels). The frames were sequentially registered using FFD non-rigid registration with NMI as a similarity measure, a control point spacing of two pixels and three subdivision levels, to provide realistic deformations. In both cases, a single time-frame was extracted and manually segmented into: liver, bowel, right and left heart, aorta, portal vein. This segmentation was used as a map to simulate contrast enhancement using the modified Tofts model (Tofts, 2010) and a population arterial input function (Parker et al., 2006). T1 values were taken from (McRobbie et al., 2007) and pharmacokinetic parameters for each organ were chosen in agreement with a previous study (Melbourne et al., 2008). The inverse ground truth transformation (computed by taking the opposite of each displacement vector) was then applied to the motion-free contrast enhanced time-series. Gaussian noise (σ
                        =0.05) and a local motion blurring (e.g. respiratory induced blurring, through plane motion) were added using image filtering to improve the realism of the data. Motion blurring was introduced by creating local point spread function filters convolved with some time frames.

Registration of these simulations was performed using FFD registration (based on both NMI and RC similarity measures), PPCR and RDDR. The performance of each method was assessed by computing the root mean squared error on the resulting displacement field.

A local ethics committee approved the retrospective use of anonymised patient data. For prospective data, all patients provided written informed consent as part of a protocol agreed by the local ethics committee.

Several kinds of DCE-MR datasets were acquired covering various temporal resolutions, breathing protocols and imaged organs. In total 7 liver time-series from both healthy volunteers and patients, 20 prostate time-series from patients diagnosed with cancer, 11 high temporal resolution and 19 lower resolution small bowel time-series from patients with Crohn’s disease were registered. Details are summarized in Table 1
                        . In all cases the acquisition started slightly before contrast agent injection. Subjects were imaged using T1-weighted gradient echo pulse sequences.

Breathing protocols were divided into three classes. First and most common is multiple breath-holds where subjects held their breath for a certain time then took a deep breath and held again. Second is acquisition with a single breath-hold followed by shallow breathing where subjects initially held their breath for a comfortable period and could then breathe gently. Finally, free breathing acquisitions were also performed.

For each dataset, registration was carried out using RDDR. For comparison, we chose a b-spline based FFD (Rueckert et al., 1999), and the PPCR algorithm as described in Melbourne et al. (2011). Sequential registration was chosen with FFD to minimize the effects of contrast changes. For improved clarity, only NMI was used as a similarity measure. This is because it is widely used in multi-modal registration and more generally accepted (compared to residual complexity). The assessment of registration accuracy was performed using four techniques:
                           
                              •
                              Qualitative assessment by generating time-cut images representing the temporal evolution of a pixel-wide line across all time-frames.

Quantitative assessment based on manually adjusted regions of interest (ROI) corresponding to clinically relevant features (disease and normal tissue). These were contoured by radiologists or clinical experts on a single slice and then propagated across all the time frames using the inverse deformation fields from registration. A pseudo ground truth (GT) was obtained by manually adjusting the position of the ROIs in every time frame to best follow the feature of interest. Time–intensity curves (TIC) were generated and the accuracy of registration was evaluated by computing the root-mean-squared error (RMSE) between TICs and corresponding GT TICs.

Additionally, area under the time–intensity curves (AUC60) for the first 60s after the start of tissue enhancement were computed for each ROI. This commonly used semi-quantitative pharmacokinetic measurement (Medved et al., 2004) is used here to assess the early enhancement period when intensity changes are the most rapid. This has the advantage of avoiding any bias due to registration of washout frames which is less challenging.

FFD registration was carried out using a highly optimized C++ implementation (Modat et al., 2010) which was also use for the underlying registration within PPCR.
                           1
                           The FFD algorithm and an implementation of the PPCR method are available open-source at http://sourceforge.net/projects/niftyreg/
                           
                        
                        
                           1
                         Registration with RDDR was run using Matlab® (The Mathworks, Natick, MA). FFD registration was used with the same tuning as described in Section 2.2.3 with the bending energy regularization weight set to 0.01. The implementation of PPCR was the same as in Melbourne et al. (2011).

Student’s t-tests (using 10% significance level) were performed to compare the error distributions for unregistered and registered data.

@&#RESULTS@&#

Overall registration showed an improved alignment with both PPCR and RDDR. For clinical data, results are presented separately for each type of imaged organ. For the different TIC examples, a heuristic model fit – based on a simple sigmoid function to mimic an uptake and a washout phase – (Melbourne et al., 2011) was used for visualization only. Error measurements were all computed using registered and GT normalized intensities. Normalization was carried out for the entire time-series so that all errors were scaled the same way.

The results obtained after registration of the simulated DCE time-series are illustrated in Fig. 4
                        . Registration with FFD (using either NMI or RC as similarity measure) tends to incorrectly deform enhancing features such as the heart and aorta. Both PPCR and RDDR show a greater robustness to contrast changes. Fig. 5
                         presents the RMSE obtain after registration of the different simulations. In all cases, both PPCR and RDDR lead to a significant reduction of error (p
                        <0.01). In the first type of simulation (liver, breath holds), the error after applying RDDR was significantly lower than after PPCR (p
                        <1e−9). However, there was no significant difference between the performance of both techniques in the second type of simulation (small bowel, free breathing) (p
                        =0.096).

Liver DCE time-series were acquired using a multiple breath-holds protocol except one dataset for which a single breath-hold plus shallow breathing strategy was chosen. Misalignments in the covered fields of view were mainly caused by breathing. In some cases the diaphragm displacement amplitude was up to 75mm in deep breathing between consecutive breath-holds.

Three classes of ROIs were obtained for liver time-series: liver parenchyma, hepatic artery and portal vein. The performances of the different methods across all ROIs (21 in total) regardless of the type of tissue are presented in Fig. 6
                        . Fig. 7
                        a shows an example of registration in a healthy volunteer. Misalignments were reduced by the three techniques. However, residual displacements appear at early enhancement, and between breath-holds, after registration with FFD and PPCR. For the latter, such residual displacements appeared in two cases where magnitude of the motion between consecutive breath holds was particularly important.

RMSE with respect to the ground truth for each type of tissue are presented in Table 2
                        . Registration with FFD resulted in an increase of error in some cases where important displacement occurred during breathing between breath holds. PPCR reduced the error in most cases. However, in smaller ROIs (e.g. vessels) the improvement was limited compared to RDDR. Fig. 7(b–e) shows the comparison of the effect of the three techniques for an example hepatic artery ROI.

Despite the error decrease in TICs, the impact on the AUC60 error appeared to be limited in these data. However, RDDR lead to a decrease of the interquartile range compared to no registration. This effect was particularly strong for ROIs placed within hepatic arteries as these present a higher maximum enhancement.

Free breathing small bowel time-series were acquired after injection of butylscopolamine (Buscopan, Boehringer, Germany) to slow down peristalsis. The remaining motion was mainly due to breathing and displacements of the bowel walls were found to be as large as 17.8mm. The wall of the small bowel is thin and such displacement amplitudes are likely to yield large errors in the monitoring of contrast enhancement.

In some cases FFD introduced additional unlikely deformations (Figs. 8 and 9
                        
                        a). Misalignments due to breathing were reduced by both PPCR and RDDR.

The action of butylscopolamine was found to be limited in 4 of the 11 datasets. In these cases residual through plane motion caused the ROIs (especially normal tissue) not to appear in some time-points making the assessment of registration accuracy difficult. Thus these cases were excluded from validation. Analysis of the remaining 12 ROIs showed a reduction of error in registered time-series for both PPCR and RDDR (Fig. 8). ROIs were small and located within bowel walls thus slight misalignments could cause large changes in RMSE. Two types of ROI corresponding to normal tissue and disease were contoured in these time series. The interquartile range was lower with PPCR in the disease ROI (Table 2), although median errors were similar for PPCR and RDDR.

Similarly, the AUC60 errors were generally lower after PPCR compared to RDDR results (Fig. 8).

Butylscopolamine was also injected in these patients before acquisition of the breath holds small bowel DCE time series. The misalignments of time frames were caused by breathing and the non-repeatability of breath-holds and were found to be as large as 23.4mm in the studied area. As previously, two of the 19 datasets were excluded from the ROI analysis due to anatomy moving out of slice.

Analysis of the 28 available ROIs showed a decrease of RMSE with respect to GT with the three techniques (Fig. 10
                        ). However, FFD increased the error in one case. ROI types corresponded to normal tissue and disease: across all datasets RDDR presented the best improvement for both types of tissue (Table 2). The effect on the error in AUC60 was similar. Fig. 11
                        a illustrates the effect of registration in these time-series.

The nature of motion in prostate DCE time-series was very different compared to the others type of data in this study. Across the 20 available datasets, 11 presented misalignments due to the presence of gas in the rectum or contraction of surrounding muscles. Although the amplitude of motion was limited, it was found to be as large 12.4mm for the prostate apex in some cases. ROIs in prostate tumors are small and even limited motion can cause important changes in TICs (Fig. 13
                        ) hence the potential importance of registration in such data.

TIC shapes after registration were in improved agreement with GT with the three techniques (Fig. 12
                        ). ROIs in the prostate were divided into two classes: tumor and normal tissue. Although both PPCR and RDDR performed equally in tumors, PPCR increased the error in some normal ROIs. Fig. 13 shows an example of motion in the prostate and the effects of registration in a cancer ROI. Across all ROIs, the error in AUC60 was increased by PPCR whilst FFD and RDDR generally decreased the error.

@&#DISCUSSION@&#

The work presented in this study addresses the problem of motion correction in DCE-MRI time-series. We introduced a novel registration method named Robust Data Decomposition Registration (RDDR). It uses robust principal component analysis to separate motion components from contrast enhancement within an iterative framework to allow progressive re-alignment of the imaged features. This gives more control on the computation of the deformation field contrary to a more direct registration scheme (e.g. single target, sequential registration). However, the hypothesis that all motion should appear in RPCA low rank component may be limiting, in particular when some motion elements occur locally over a short period of time such as in peristalsis.

In this study RDDR performance was compared to that of a popular NMI based FFD registration and to PPCR (Melbourne et al., 2007). Further comparison with existing pharmacokinetic driven approaches (Buonaccorsi et al., 2007) would also be of interest but have not been explored in this study as no T1 mapping was available. Independent components analysis based registration (Wollny et al., 2012) has been applied to myocardial perfusion data acquired during free breathing, further work would be necessary to compare it to RDDR in a wider selection of anatomical features. Both methods use data decomposition to limit the effect of contrast enhancement on the modeling of deformations. However, independent component analysis necessitates suitable component identification while RPCA provides a general model for data decomposition.

RDDR uses an iterative approach to gradually correct for motion elements. In that sense it has similarities with PPCR where the amount of information used to generate a set of synthetic target images is progressively increased at every iteration (Melbourne et al., 2007). However, important methodical differences between the two techniques lie in the fact that the decomposition output of RPCA is not used as a target but registered in a group wise manner in RDDR. Also PPCR is based on principal component analysis which is a general model for variance separable data without the explicit identification of a sparse component. This is different from RPCA and can produce very different decomposition depending on the nature of the data (e.g. type of breathing).

In this work we kept the control point spacing and transformation model the same for all methods. However, the techniques inherently use different approaches to choose the target image (e.g. groupwise, sequential, synthetic target generation). The relative benefits of each approach could be the subject of further investigation.

Results from simulated DCE-MRI data registration show that RDDR can compensate for important misalignments due to multiple breath-holds, as well as pseudo periodic motion due to free breathing, without impacting enhancing regions.

The clinical data used for assessment consisted of a broad range of imaged organs (liver, small bowel and prostate) and types of motion (e.g. breath-holds, free breathing). Registration with RDDR is more accurate in most cases where there was a preference (Figs. 6, 10 and 12). Moreover, the reduced error with respect to the ground truth time intensity profiles suggests that RDDR could allow a better discrimination between different types of tissue (normal, disease, arteries and veins). In particular the assessment of registration accuracy for early tissue enhancement (AUC60) showed that RDDR provides a robust correction in the presence of rapid and intense contrast changes. Such a measurement is particularly useful as it provides information on the accuracy of registration at early enhancement when contrast changes are the most important. This would be of particular interest when modeling the rapid contrast arrival of the arterial phase to extract pharmacokinetic parameters describing the rate of contrast agent exchange, linked to tissue permeability. This period is of particular interest for distinguishing malignancy (Medved et al., 2004). Most registration techniques are likely to produce accurate correction during the washout phase since contrast agent is now disperse and contrast change is slowly varying whilst unrealistic deformations appear in time-points corresponding to maximum enhancement. This was observed in the simulated data with FFD based on residual complexity minimization.

Interestingly, PPCR performed particularly well in small bowel data acquired during free breathing which differs from findings in simulation. This might be explained by the long acquisition time with a high temporal resolution that can catch irregularities in breathing and thus cyclic respiratory motion does not appear in the first PCA components. Also fairly slow and limited contrast changes in the field of view (e.g. no major arteries, heart, etc.) might increase their appearance in the first principal components.

One should note that AUC60 is usually measured on contrast agent concentration curves in DCE-MRI analysis (Medved et al., 2004). Here measurements were performed directly on the pixels’ TIC. The relationship between intensity and contrast agent concentration as described by the imaging equations is not linear, although it can be approximated as such over a narrow range of tissue T1 values. However, it seems reasonable to expect that a more accurate TIC after registration would result in an improved monitoring of the concentration for a given pixel.

Pharmacokinetic models are usually fit to time–concentration curves after conversion from signal intensity to contrast agent concentration, though this requires additional information about the underlying tissue T1 distribution and the arterial input function. The work presented here focussed on the effects of registration upon the time intensity curves. More accurate curves produced by successful image registration should lead to more accurate pharmacokinetic parameter estimation, though quantifying these changes before and after motion correction by RDDR will be the subject of further study.

Additionally no fitting error was used to assess the performance of the different algorithms. This is because such a measurement might be misleading outside of its context: a very low fitting error does not necessarily correspond to an improvement if the shape of the curve is significantly different from that of the ground truth (Fig. 7c and d), since it incorporates measurement of the model fit bias (Balvay et al., 2005).


                        Candès et al. (2009) provided a model-free value for the trade-off parameter in RPCA. The scheme proposed in this study to adjust this trade-off parameter was set experimentally so that enough motion is incorporated into the low rank component when initiating the registration process, whilst little contrast change appears. Future work might include investigation of an optimal value for DCE-MR time-series decompositions, or the inclusion of prior knowledge of contrast changes (e.g. general curve shapes) as a constraint in RPCA in addition to that on the rank of L and the sparsity of S. Additionally model selection theory could be applied to investigate a better tuning for data decomposition.

The choice of breathing strategy has a major influence on the efficiency of motion correction in DCE-MRI. Multiple breath-holds during continuous acquisition result in “gasp” images when the subject takes a breath (Wollny et al., 2012). Gasps contain blurring artefacts that may complicate registration. The robustness of RDDR in such cases stems from the gasps appearing in the sparse component.

Free-breathing acquisition allows more continuous monitoring of tissue enhancement but is also subject to intra-frame blurring artefacts (McRobbie et al., 2007). Moreover, if high temporal resolution is favoured over spatial resolution, features can be less well defined. However, the periodic and continuous changes related to breathing tend to reinforce the low rank characteristics of motion, leading to a robust separation from the contrast changes in the sparse component of RPCA.

A single breath-hold followed by shallow free breathing is adopted in some protocols. Early time-frames present limited misalignments which reduces the risk of error in the important uptake phase.

RDDR uses a separation of data into low-rank and sparse components. In some DCE cases, bowel peristaltic motion not stopped by butylscopolamine was observed in the sparse component and was thus not removed by the registration steps. Whilst undesirable for DCE analysis, this limitation can be exploited in non-contrast enhanced studies of small bowel motility where a separation of bowel motility from respiration is desirable. In fact RDDR can be applied to dynamic time-series where respiratory motion is coupled with rapid local intensity changes in the bowel due to peristalsis (Hamy et al., 2013). In such a situation our method allows improved quantification of small bowel motility (Odille et al., 2012) in the presence of free breathing.

The way the information is processed in RDDR can be seen as a multi-scale registration in terms of motion: the higher the value of the trade-off parameter the bigger the amount of motion appearing in the low-rank component. In other words RDDR can correct different components of motion along an iterative process.

@&#CONCLUSION@&#

The method introduced in this study allows improved registration of multiple breath-hold and free breathing DCE-MR time-series. It relies on robust decomposition of input data that separates motion from contrast enhancement and is therefore termed Robust Data Decomposition Registration (RDDR). It has been successfully applied to images of multiple organs (liver, small bowel and prostate) affected by different types of motion and compares favourably to existing state-of-the-art techniques. The novelty of RDDR resides in its robustness to contrast enhancement in tissue, particularly during initial tissue uptake.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank Benjamin Trémoulhéac for useful discussions on data decomposition. This work was supported by the National Institute for Health Research University College London Hospitals Biomedical Research Centre.

@&#REFERENCES@&#

