@&#MAIN-TITLE@&#Integrated construction and simulation of tool paths for milling dental crowns and bridges

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Integrated approach of tool path generation and simulation for milling in the field of dental technology.


                        
                        
                           
                           Implicit representations of surfaces and solids by means of level-sets.


                        
                        
                           
                           Isoplanar/isoparametric and isogeodesic sampling for finishing milling.


                        
                        
                           
                           GPU-based implementation of predictive feed rate optimization and tool path evaluation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Dental milling

Tool path construction

Tool path simulation

Implicit representations

@&#ABSTRACT@&#


               
               
                  The paper presents an integrated and therefore novel approach of tool path generation and simulation for milling in the field of dental technology. Both the geometry of the dental implants and the characteristics of the cutter, machine and raw material have an immediate influence on the stability of the milling process and the quality of the result. Regarding this issue, the paper focuses on the construction of tool path segments on a triangulated surface using an isoparametric and isogeodesic approach. The segments are subsequently chained and simulated in order to provide an optimized tool path in terms of path length and feed rate. The simulation particularly evaluates a tool load to guide feed rate selection and the distance error of the machined surface. Implicit representations of surfaces and solids by means of level sets are applied where appropriate in order to increase robustness and universality of tool path construction.
               
            

@&#INTRODUCTION@&#

As in many other industries, production stages are increasingly becoming automated in dental technology  [1]. As the price of dental laboratory work has become a major factor in treatment planning and therapy, automation could enable more competitive production in high-wage areas like Western Europe and the USA. As advances in computer technology significantly speed up calculations, using budget-priced hardware enables a cost-effective production of individual pieces.

Computer assisted and fully automatic manufacturing of dental implants offers many benefits compared to conventional manual manufacturing, including: high precision, reproducibility, efficient exploitation of raw material, unified workflow for a variety of models and materials, short processing time, efficient utilization of working steps via pipelining and low manufacturing costs.

For a common dental office/lab to profit from these benefits in daily use, as well as for broad acceptance to be obtained, computer assisted manufacturing systems must fulfill both common technical as well as end-user ergonomic requirements. Technical requirements are, e.g., compliance with a predefined precision, minimization of calculation as well as machining times and error robustness. User ergonomic requirements are e.g. universality, an obvious and intuitive course of action, minimization of mandatory interaction and modularity of the production sequence.

A schematic representation of a production sequence of dental implants is shown in Fig. 1
                     . At the beginning a point cloud is produced by a scanner facing the dental region of preparation. The scanning can be performed as extraoral (indirect) or intraoral (direct) sampling and by using an optical or a mechanical scanner. The complex geometry of the replacement body parts including additional fixation bars is modeled in the CAD (Computer Aided Design) module. Afterwards the resulting model of the replacement body can be manufactured by a CAM (Computer Aided Manufacturing) module, which uses the surface of the model as the basis for tool path calculation  [2]. Fig. 2
                      shows conceptual components of the CAM module described in this paper.

Compared to classical machining, the surface approximation error of tool paths in dental implant machining plays a slightly less important role on a microscopic scale, since the models to be machined emerge from scanned point clouds, which are in turn both discrete and defective. Furthermore, path generation relies on discrete surfaces (triangle meshes) instead of analytical representations, which rigorously restricts geometric concepts and operators needed for classical machining, like fundamental forms, curvatures and offsets. Tool pose computation and collision avoidance become a problem of interpolation and search, rather than differential geometry. Therefore path planning strategies for continuous and discrete object representations naturally differ. An essential aspect of the latter is universality and robustness, since many degenerate cases may emerge from manipulating an arbitrary (and possibly defective) triangle mesh. To account for arbitrary evolving shapes, level set representations become increasingly popular, which are used in this paper to represent surfaces and tool paths.

In dental applications, the majority of CAM processes employ ball-end tools for the following reasons: an economic and efficient usage of raw material and tools requires material waste and unnecessary chipping to be minimized—therefore, multiple objects are machined from a single blank with each cut region outline fitting tightly to the target object (cf. Fig. 4(a)). Furthermore small-sized and low-priced machines with only 4 or 4.5 axes are popular, but they also have a reduced freedom of movement. Both issues strongly restrict the accessibility of the target surface in terms of tool orientation. These facts render a tangential tool contact impossible in general, and make it convenient to employ tools whose shaping does not depend on the working angle.

Due to this circumstance, the presented tool path generation is optimized for ball-end tools, by subdividing it into a tool location sampling phase and a tool orientation optimization phase.

For a general survey of cutter path construction techniques we refer to  [3,4]. A review of the status and future perspectives of dental CAD/CAM is given by  [5]. While constant scallop tool paths are state of the art in freeform surface machining  [6], the restrictions on surface representation mentioned above apply to their applicability to dental implant machining. Especially the transformation from cutter contact to gouge-free cutter location points is cumbersome and error-prone with arbitrary triangular meshes. This fact renders the offset–surface based calculation of cutter location paths  [7–9] more attractive than an explicit construction and transformation of cutter contact paths. The approach described in this paper furthermore overcomes difficulties and error sources of conventional offset–surface based tool path calculations by representing relevant surfaces and curves implicitly by means of distance fields, which applies to both the generation as well as simulation of tool paths. Implicit representations are highly topical in the context of CAM  [10–13]. Since the computation of tool positions is only a small piece of an end-user solution to dental implant machining, this paper describes a chain of methods whose aim is the incorporation of the geometry of arbitrary dental implants as well as characteristics and influences of the milling machine and raw materials. The integrated consideration of these facts is denoted by Computer Aided Process Planning (CAPP), which is the interface between CAD and CAM and considers both geometrical and non-geometrical circumstances  [14].

The first step of dental implant machining is the automatic arrangement of a set of implant models onto the currently available blank space. This arrangement step constitutes a two-dimensional nesting problem and bases on no-fit polygons to minimize the occupied blank space–and therefore the material waste–by means of heuristic optimization. This step is not within the scope of this publication.

The paper is organized as follows: Section  2 specifies the problem of tool path generation and Section  3 presents its proposed solution. The latter is divided into different strategies of subpath sampling for roughing (Section  3.1) and finishing (Section  3.2), as well as subpath chaining and tool orientation optimization (Section  3.3). Section  4 focuses on path simulation and feed control, and Section  5 shows some exemplary results. Section  6 concludes with some remarks on the current state and further development.

After arranging a set of models in the blank, tool paths are generated and executed to machine the models, in which machining is divided into a roughing and finishing step.

Tool paths can be formalized by means of the configuration space 
                        C
                     , whose dimension equals the machine’s degrees of freedom and which contains every tool configuration that does not lead to a damage of the machined object or the machine itself. A configuration 
                        c
                        ∈
                        C
                      in turn defines the tool’s position, orientation, feed rate and spindle speed. Since the current work employs 4- and 5-axis machining, 
                        C
                      is a subspace of 
                        
                           
                              R
                           
                           
                              6
                           
                        
                      or 
                        
                           
                              R
                           
                           
                              7
                           
                        
                     . Tool path generation now denotes the problem of selecting an “appropriate” finite ordered sequence 
                        T
                        P
                        =
                        
                           (
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 c
                              
                              
                                 N
                                 −
                                 1
                              
                           
                           )
                        
                      of 
                        N
                      tool configurations with 
                        
                           
                              c
                           
                           
                              i
                           
                        
                        ∈
                        C
                      (cf. Fig. 3
                     
                     ).

Since there is no unique solution, a tool path 
                        T
                        P
                      has to fulfill specific conditions of optimality, consisting of the accuracy of fit to a given object, machining time, and machine lifetime. These generic terms in turn depend on a multitude of technical conditions like path length, path pattern, number and homogeneity of configurations, cut volumes, feed rate, direction of rotation, etc. A joint optimization of these contradicting and diffusely specified conditions using the entire configuration space 
                        C
                     –supplemented by arbitrary permutations of selected 
                        
                           
                              c
                           
                           
                              i
                           
                        
                     ’s–would turn tool path generation into a task too complex to manage efficiently, which is why demands on a resulting path pattern are typically specified to guide the selection of configuration sequences. In compliance with such a demand, conditions of optimality can be more easily concretized, e.g., isoplanar tool paths with a given accuracy of fit, minimal Euclidean length and given direction of rotation. In terms of 
                        C
                     , specifying a desired path pattern can be regarded as restricting configuration selection to subspaces of 
                        C
                     , e.g.  
                        
                           
                              c
                           
                           
                              i
                              +
                              1
                           
                        
                      is restricted to fulfill a predefined relation to 
                        
                           
                              c
                           
                           
                              i
                           
                        
                     , like having isoplanar locations. Furthermore, predefining a path pattern allows the path generation to be divided into common subproblems, which consecutively compute the coordinates of each configuration, as employed in the current work:
                        
                           1.
                           Identify a set of admissible potential tool configurations, that specify which locations the tool shall visit and various alternatives to achieve this, along with a partial ordering of configurations by means of so called partial (or sub-) paths.

Concatenate an appropriate subset of configurations from step 1 into an admissible path, ensuring each location is visited once.

Schedule feed rates and cutting speeds.

Tool path generation is divided into subpath-sampling and subpath-chaining. The former is a geometric problem, the latter mainly is a problem of combinatorial optimization. Depending on the domain and strategy underlying the subpath-sampling, either roughing or finishing tool paths emerge, as shown in the following.

The aim of rough machining is a quick removal of material to uncover a solid that will become the target object after finishing. Therefore, tool paths must not accurately adapt to a target surface, but systematically traverse the entire cutting region in order to make sure that no material is left offside the target object, except a predefined least residual stock material thickness of about 0.05–0.1 mm, dependent on the material.

This can be easily accomplished by sampling the cutting region by means of a regular grid, which defines a set of cutter location points (clp) by means of inflated and translated versions of a reference subpath 
                           
                              
                                 p
                              
                              
                                 
                                    ref
                                 
                              
                           
                        . Choosing 
                           
                              
                                 p
                              
                              
                                 
                                    ref
                                 
                              
                           
                         to resemble the outlining polygon of the cutting region, allows an accurate compliance of the machined cutting region with the specified one, since its boundary can be reproduced exactly. Sampling the reference path’s offset along the 
                           z
                        -axis as well as its inflation via a predefined path distance, yields subpaths that reproduce the cutting region outline at varying heights and sizes.

After sampling the cutting region, each clp that has a least distance of less than tool radius 
                           r
                         to the object surface is removed from its subpath. Removing a clp from a subpath splits it up into two subpaths, each containing the clps preceding and succeeding the split, respectively. Fig. 4(a) shows an exemplary cutting region, which is defined by extruding a two dimensional outlining polygon along the 
                           z
                        -axis. Fig. 4(b) shows the result of systematically filling this region with cutter location points. As can be seen, bars connected to the target object leave the cutting region to fix the machined object after surrounding material has been removed.

Up to now, only the positional coordinates of the roughing tool path were defined. The calculation of remaining coordinates as well as path chaining are described in Section  3.3.

While roughing aims at removing material from non-object regions of the blank and uncovering a coarse approximation of the target object, finishing aims at accurately shaping the object’s surface, requiring the tool path’s cutter contact points (ccp) to be exactly adapted to the target surface.

The current text describes two complementary strategies to sample the object surface by means of contact points, namely isoparametric and isogeodesic sampling. A cutter contact point (ccp) specifies the position at which shaping of a given target surface by means of the cutting tool shall take place. A ccp is inaccessible, if each tool configuration that allows shaping at the ccp will result in a damage of the target surface or the machine itself. Otherwise, the ccp is accessible by one or more corresponding tool configurations, each consisting of a tool position (cutter location point—clp) and tool orientation, which make shaping at the ccp taking place (speeds neglected). Therefore, each desired contact point has to be transformed to an appropriate tool configuration to allow for shaping the surface at the desired ccp, whereas inaccessible ccps have to be discarded. The transformation from ccp to tool configurations has to resolve direct and indirect collisions, which denote a remote penetration of the target surface via either the tool end or the tool shaft, respectively. In general, there is a multitude of tool configurations corresponding to an accessible ccp, since it is reachable in more than one way. In that case, an appropriate configuration has to be selected by means of an optimality condition on the entire path, e.g. optimal work angle or least variations of orientation (cf. Section  3.3).

Due to the restriction to ball-end tools, the computation of clps is divided into the positional and orientational part: while the position of clps which yield an adequate sampling of the object surface is performed by sampling the offset surface, the orientation of clps is optimized independently. This allows for a more efficient minimization of the total path length and machining time (cf. Section  3.3). With a non-ball-end tool, orientation affects offset as well as sampling, and therefore requires a joint optimization of surface sampling and path length, which is beyond the scope of this paper.

Due to the restricted accessibility of the target surface as mentioned in Section  1, the tool’s cutting region can only restrictedly be controlled by means of tool inclination, even with 5-axis machining. This issue raises the risk of zero-velocity cuts near the center of the tool. In fact, the resulting potential increase of tool wear turns out to be less disadvantageous to the field of application than an increase of material waste and machining time, which would otherwise accompany an arbitrary control of tool orientation.

The target surface is represented implicitly by means of a signed distance function 
                           Φ
                           
                              (
                              
                                 q
                              
                              )
                           
                           ∈
                           R
                        , which assigns each point 
                           
                              q
                           
                           =
                           
                              
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                              
                              
                                 T
                              
                           
                         its signed minimal distance to the object surface  [11]. This way, using the isosurface 
                           Φ
                           =
                           r
                         (set of points 
                           
                              q
                           
                         satisfying 
                           Φ
                           
                              (
                              
                                 q
                              
                              )
                           
                           =
                           r
                        ) as target surface to be sampled avoids the need for handling ccps and their transformation explicitly, since 
                           Φ
                         assures that every point 
                           
                              q
                           
                         satisfying 
                           Φ
                           
                              (
                              
                                 q
                              
                              )
                           
                           =
                           r
                         is a clp of some contact point(s) on the object surface—direct collisions are avoided by construction, while indirect collisions are resolved in a subsequent step.

Intersecting a plane with the target surface 
                              Φ
                              =
                              r
                            yields isoplanar curves that are sampled to get an ordered sequence of clps, also denoted as a subpath. The essential part remains the selection of planes to sample the target surface according to a predefined accuracy of fit. Besides planes, more general parametric sectional functions may be used to generate isoparametric subpaths as shown below.

The proposed approach, as given by Algorithms 1 and 2, uses a global strategy to uniformly cover the object: the sampling of the target surface by means of subpaths is recursively refined and coarsened. Due to the recursive trimming of subpaths, it contrasts with conventional isoparametric path planning. The algorithm–denoted PlacePathIsoplanar–initializes with two sectional planes bordering the processed region from opposite sides (step 1 and Fig. 5
                           (a)). Then it recursively inserts a further sectional plane in between each pair of bordering planes as long as the resulting accuracy within the bordered region is insufficient (step 2 and Algorithm 2). A predefined accuracy is given by means of a distance 
                              
                                 
                                    d
                                 
                                 
                                    
                                       tresh
                                    
                                 
                              
                            between subpaths of neighboring planes. In fact, if 
                              
                                 
                                    d
                                 
                                 
                                    
                                       tresh
                                    
                                 
                              
                            is exceeded somewhere along the subpaths of two neighboring planes, at least one more intermediate plane is needed to refine sampling (Algorithm 2 steps 2–5). Since, in general, a subpath resulting from the insertion of a middle plane in step 3 of Algorithm 2 will not be entirely necessary, the algorithm eventually trims each subpath where the path distance is unnecessarily low (Algorithm 2 step 6): a point 
                              
                                 x
                              
                            of an intermediate subpath 
                              
                                 
                                    p
                                 
                                 
                                    3
                                 
                              
                            is considered unnecessary, if the sum of the least distances between 
                              
                                 x
                              
                            and the bordering subpaths 
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                            is less than 
                              
                                 
                                    d
                                 
                                 
                                    
                                       tresh
                                    
                                 
                              
                           . In this case, a maximum path distance of 
                              
                                 
                                    d
                                 
                                 
                                    
                                       tresh
                                    
                                 
                              
                            between 
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                            will not be exceeded even if the “interstation” 
                              
                                 x
                              
                            on 
                              
                                 
                                    p
                                 
                                 
                                    3
                                 
                              
                            is removed. In this sense, every unnecessary point of the intermediate path 
                              
                                 
                                    p
                                 
                                 
                                    3
                                 
                              
                            is removed in order to reduce path length by preventing oversampling. Fig. 5 shows the first three stages of the recursive sampling and Fig. 6
                            shows an exemplary resulting path.


                           
                              
                                 
                              
                           
                        


                           
                              
                                 
                              
                           
                        

The recursive sampling is generalizable, in that other implicit functions than a plane can be used to generate subpaths. Thus, the isoplanar sampling turns into an isoparametric one, and the (iso-)parameter refers to the employed sectional function. An example is shown in Fig. 7
                           , in which spheres instead of planes are used to generate subpaths.

The disadvantage of isoparametric path planning is a non-uniform relation between the (iso-)parameter of the sectional function and the target surface. In general, this fact causes the sampling accuracy to vary and the path length to be unnecessarily long. However, its advantage is a uniform and strictly predefined path pattern, which may by beneficial on certain machines.

Isogeodesic path planning does not use an external sectional function to systematically construct partial paths, instead partial paths are exclusively defined by the target surface itself. Since each potential clp resides on a two-dimensional manifold 
                              S
                            consisting of the set of points 
                              
                                 {
                                 
                                    q
                                 
                                 |
                                 Φ
                                 
                                    (
                                    
                                       q
                                    
                                    )
                                 
                                 =
                                 r
                                 }
                              
                           , it can in principle be specified by means of two parametric coordinates 
                              
                                 q
                              
                              =
                              S
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                           . A partial path 
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                            is then defined via the property that every point 
                              
                                 q
                              
                            of the path has a constant geodesic distance 
                              
                                 
                                    ν
                                 
                                 
                                    i
                                 
                              
                            to a predefined reference point 
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                            or reference path 
                              
                                 
                                    p
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                           . More specifically, there is a two-dimensional geodesic distance function 
                              ϕ
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            defined on the surface 
                              S
                           , with the result that 
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                            is defined by a set of points satisfying 
                              
                                 {
                                 
                                    q
                                 
                                 =
                                 S
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 |
                                 ϕ
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    
                                       ν
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           . By equidistantly sampling the distance 
                              
                                 
                                    ν
                                 
                                 
                                    i
                                 
                              
                            by means of a predefined step size 
                              
                                 
                                    d
                                 
                                 
                                    
                                       tresh
                                    
                                 
                              
                           , the resulting side step between neighboring partial paths is by construction 
                              
                                 
                                    d
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       tresh
                                    
                                 
                              
                           .

The geodesic distance function 
                              ϕ
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            is numerically approximated by firstly interpolating and triangulating the offset 
                              Φ
                              =
                              r
                            by means of marching cubes  [15]. Secondly, each resulting vertex of the triangulation is assigned its distance to the reference path or point, in which the latter is computed using the approach described in  [16]. The level set 
                              ϕ
                              =
                              
                                 
                                    ν
                                 
                                 
                                    i
                                 
                              
                            can now be extracted by means of marching triangles. Therefore, a concrete parametrization of the offset surface 
                              Φ
                              =
                              r
                            is not necessary for the representation and propagation of tool location paths 
                              ϕ
                              =
                              
                                 
                                    ν
                                 
                                 
                                    i
                                 
                              
                           , and was solely used for notational purposes.

Since the height of the resulting scallop between neighboring paths 
                              ϕ
                              =
                              
                                 
                                    ν
                                 
                                 
                                    i
                                 
                              
                            and 
                              ϕ
                              =
                              
                                 
                                    ν
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            depends on the side step as well as the surface curvature in step direction, a constant (geodesic) step size does not necessarily result in a constant scallop height. More precisely, the relation between the scallop height 
                              h
                            and the side step size 
                              
                                 Δ
                              
                              ν
                              =
                              
                                 (
                                 
                                    
                                       ν
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       ν
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            on an offset surface with curvature 
                              κ
                            in the side step direction can be approximated by  [9]
                           
                              
                                 (1)
                                 
                                    
                                       Δ
                                    
                                    ν
                                    =
                                    
                                       
                                          
                                             
                                                8
                                                h
                                                r
                                                κ
                                             
                                             
                                                κ
                                                −
                                                r
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            Since 
                              ϕ
                            is a distance function, its level sets propagate in the direction given by 
                              ∇
                              ϕ
                           , which corresponds to the conventional side step. Denoting the curvature in propagation direction as 
                              κ
                              
                                 (
                                 ∇
                                 ϕ
                                 )
                              
                            a modulation of the initial distance function 
                              ϕ
                            proportional to 
                              κ
                              
                                 (
                                 ∇
                                 ϕ
                                 )
                              
                            is sufficient to convert isogeodesic into isoscallop sampling. Due to the discrete representation of 
                              ϕ
                           , its adjustment consists of approximating 
                              ∇
                              ϕ
                            as well as 
                              κ
                              
                                 (
                                 ∇
                                 ϕ
                                 )
                              
                            at each vertex numerically and adjusting the vertex distance accordingly. The definition and calculation of an appropriate distance adjustment is part of current development and beyond the scope of this paper. Note that due to the implicit representation of tool location paths by means of 
                              Φ
                            and 
                              ϕ
                           , no external guide surface is needed.


                           Fig. 8
                           (a) visualizes an exemplary geodesic distance field 
                              ϕ
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            defined on the offset surface 
                              Φ
                              =
                              r
                            of the object in Fig. 6 by means of vertex coloring. The reference point 
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                            is chosen to be the highest point of the surface. Fig. 8(b) shows the resulting partial paths corresponding to a step size 
                              
                                 
                                    d
                                 
                                 
                                    
                                       tresh
                                    
                                 
                              
                              =
                              0.2
                           , i.e.  
                              ϕ
                              =
                              
                                 
                                    ν
                                 
                                 
                                    i
                                 
                              
                            with 
                              
                                 
                                    ν
                                 
                                 
                                    i
                                 
                              
                              =
                              0.2
                              i
                           .

Until now, either the entire cutting region (in the case of roughing), or its two-dimensional subspace constituting the offset surface (in the case of finishing) has been sampled by means of a set 
                           P
                         of partial paths 
                           P
                           =
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    p
                                 
                                 
                                    M
                                    −
                                    1
                                 
                              
                              }
                           
                        , in which each path 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         is an ordered sequence of configurations solely specifying tool location. The final working step consists of defining the remaining dimensions of each configuration and sorting 
                           P
                        . Therefore, the following five steps have to be solved, which will only shortly be described below since they are technically rather than conceptually interesting:
                           
                              1.
                              for each desired location, identify configuration candidates that are free from indirect collisions

split 
                                    P
                                  into two sets 
                                    
                                       
                                          P
                                       
                                       
                                          
                                             top
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          P
                                       
                                       
                                          
                                             bottom
                                          
                                       
                                    
                                  containing configurations to be machined from top or bottom side, respectively

select a final tool configuration at each desired location according to an optimality condition, and discard locations which exclusively induce indirect collisions (since tool orientation was deferred, see above)

order the set of paths to minimize global path length

insert detours to remove collisions from path joints.

Step 1 explores a discretized subspace of the configuration space 
                           C
                        , containing only the orientational component of a tool configuration, and the positional part being fixed (for efficiency reasons, the position was computed previously by means of surface sampling, cf. Sections  3.2.1 and 3.2.2). The GPU and OpenGL is employed to accelerate exploration by means of multithreading. The result is a so-called point visibility map at each desired location—a Boolean vector (4-axes) or matrix (5-axes) indicating the occurrence of a collision at a specific orientation. Assuming 4-axis machining, Fig. 9
                         shows the visibility vectors along three exemplary partial paths concatenated into a so called path visibility map—a matrix in case of 4-axis machining.

Step 2 is justified twofold: typically the work area of miniature milling machines is too low to machine a blank at every possible work angle without penetrating the construction. Turning the blank therefore involves moving the spindle to a safe position at first, which is very time consuming. Secondly, material is removed solely in a small region around an object to save expensive raw material and avoid unnecessary cutting, which in turn prevents a fluent passage between the object’s top and bottom side.

Step 3 uses a graph search approach to find a path through each path visibility map (cf. Fig. 9) that minimizes the total number of orientation adjustments. Instead, other objective functions than total variation could be used, which incorporate an optimal work angle regarding the current surface patch, e.g. sturz milling. However, since this optimal work angle will generally not be usable due to indirect collisions or kinematic restrictions (4-axes), it is ignored.

Step 4 considers each partial path 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         as a node of a complete directed graph. The cost of each edge of the graph is the directed distance between the corresponding nodes. More specifically, the cost of an edge 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         is the length of a connecting path that safely moves the tool from the last point of partial path 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         to the first point of 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                        , including detours required to avoid collisions. The straight Euclidean distance between the end and starting point is an insufficient measure of cost, since it underestimates distance by assuming a typically unsafe connection between 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                        . The shortest possible global path is now given by means of a round trip with minimal costs (TSP). Since the computation of edge costs is time consuming due to the need for computing a potential detour, greedy search is used to compute an approximately optimal trip. Since reversing or shifting the partial paths 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         or 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         corresponding to an edge 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         may significantly reduce edge cost, there are also shifted versions (in case of a closed path) or a reversed version (in case of an open path) of each partial path included into the greedy search.

Given an ordered sequence of partial paths, step 5 employs a GPU-assisted detour planning to compute additional tool configurations that safely connect the end of a preceding and the beginning of a succeeding partial path if there would otherwise be a collision. Similarly, indirect collisions may occur on a change of tool orientation or after deletion of inadmissible configurations within a partial path, which are handled the same way.

The calculation of an ordered sequence of 
                        N
                      tool configurations 
                        
                           
                              c
                           
                           
                              0
                           
                        
                        ,
                        …
                        ,
                        
                           
                              c
                           
                           
                              N
                              −
                              1
                           
                        
                      according to Section  3 does not provide a complete parametrization of the machine’s degrees of freedom, since the speed of transition between configurations (feed rate or axial speed), as well as the tool’s number of revolutions (cutting speed or spindle speed) remained unconsidered until now in order to make tool path calculation tractable. This neglect may be unproblematic if a predefined constant speed is applicable and the tool’s maximum load will not be reached. Nevertheless, a workload-adaptive feed rate may reduce processing time in this case by using an increased speed where appropriate. If, in contrast, a constant speed causes the tool to reach its mechanical or thermal maximum load, controlling the tool’s load by means of an adaptive feed rate is essential in order to avoid damages of the tool or machined surface.

Basically, two types of speed control are distinguishable, namely a predictive control based on a preliminary offline-simulation of the machining process, and a reactive control based on measurements of appropriate features (e.g. electric current, temperature, force) during the machining process. The former denotes an open loop control, the latter a closed loop control, whereby both types are naturally combinable within an automatic manufacturing system  [17].

The current section describes an implementation of a predictive feed rate optimization in the context of dental implant machining using miniature milling machines. Besides feed rate computation, the simulation essentially serves the purpose of tool path validation, evaluation and visualization. A reactive speed control, supplemented by a tool-breakage recognition, is furthermore part of current work.

In order to achieve a universal approach that robustly allows the machined surface to change shape and topology arbitrarily, the simulation is based on an implicit representation of the material volume and the tool’s range of influence by means of level sets. The material volume needs to be approximated numerically due to its shape evolving arbitrarily in time, whereas the tool’s range of influence is specified analytically to allow for an efficient update of the material surface.

For this purpose, the cutting region is discretized by means of a grid, in which each grid point maintains the (scaled and shifted—c.f. Eq. (6)) least signed distance to the material surface. Denoting this distance field by 
                        Ψ
                        
                           (
                           
                              q
                           
                           )
                        
                     , the material surface is consequently given via the isocontour 
                        Ψ
                        =
                        ν
                     , for an appropriately chosen 
                        ν
                      which depends on scaling/shifting. For each pair of consecutive tool configurations 
                        
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                      the sweep volume, as induced by moving the (cutting part of the) tool from 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      to 
                        
                           
                              c
                           
                           
                              i
                              +
                              1
                           
                        
                     , is specified analytically by means of a distance function 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                        
                           (
                           
                              q
                           
                           )
                        
                     .

Note the following advantages over conventional approaches: 
                        
                           •
                           using level sets (i.e. signed distance fields) instead of Boolean voxels  [18] results in a superior approximation quality of the material surface with less grid points, since resulting isosurfaces are smoothly interpolated instead of piecewise constant

scaling and shifting the distance values (cf. Eq. (6)) reduces the amount of memory per grid point to a single byte (instead of 4 byte floats)

using a sparse level set representation (e.g.  [19]) instead of a dense grid to approximate 
                                 Ψ
                               significantly reduces memory usage and decouples it from the cutting region size; the concrete representation of 
                                 Ψ
                               is beyond the scope of this paper

specifying the tool’s transition from 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                               to 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                               analytically as described below results in a superior approximation quality and efficiency of the sweep volume compared to e.g. sampling the tool configuration at isolated intermediate points  [18]
                           

evolving the material surface to account for each tool path segment 
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    )
                                 
                               can be massively parallelized using OpenCL, since only grid points of the scalar field need to be updated.

By using a combination of analytical and numerical implicit representations of relevant shapes, the focus of the presented simulation is most likely comparable to that of  [13], while the latter uses a basically different approach to compute 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                        
                           (
                           
                              q
                           
                           )
                        
                     , i.e. the signed distance to the swept volume.

As mentioned above, the material volume within the cutting region is captured by a scalar function 
                        Ψ
                        
                           (
                           
                              q
                           
                           )
                        
                        ∈
                        R
                     , which in turn is numerically approximated by a set of grid points. In this paper, an equidistant grid is simplistically assumed, defined by 
                        
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       x
                                    
                                 
                                 
                                    Δ
                                 
                                 x
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       y
                                    
                                 
                                 
                                    Δ
                                 
                                 y
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       z
                                    
                                 
                                 
                                    Δ
                                 
                                 z
                                 )
                              
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                      with 
                        0
                        ≤
                        
                           
                              m
                           
                           
                              x
                           
                        
                        ≤
                        
                           
                              M
                           
                           
                              x
                           
                        
                        −
                        1
                        ,
                        0
                        ≤
                        
                           
                              m
                           
                           
                              y
                           
                        
                        ≤
                        
                           
                              M
                           
                           
                              y
                           
                        
                        −
                        1
                        ,
                        0
                        ≤
                        
                           
                              m
                           
                           
                              z
                           
                        
                        ≤
                        
                           
                              M
                           
                           
                              z
                           
                        
                        −
                        1
                     . The constants 
                        
                           (
                           
                              Δ
                           
                           x
                           ,
                           
                              Δ
                           
                           y
                           ,
                           
                              Δ
                           
                           z
                           )
                        
                      control the resolution of the cutting region, 
                        
                           (
                           
                              
                                 M
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 M
                              
                              
                                 y
                              
                           
                           ,
                           
                              
                                 M
                              
                              
                                 z
                              
                           
                           )
                        
                      its size and 
                        
                           (
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 0
                              
                           
                           )
                        
                      its position in space.

The raw material volume 
                        M
                        V
                      is a subset of 
                        
                           
                              R
                           
                           
                              3
                           
                        
                      given by 
                        
                           (2)
                           
                              M
                              V
                              =
                              
                                 {
                                 
                                    q
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 |
                                 Ψ
                                 
                                    (
                                    
                                       q
                                    
                                    )
                                 
                                 ≥
                                 ν
                                 }
                              
                              ,
                           
                        
                      while the surrounding volume 
                        S
                        V
                      (e.g. air, cooling fluid) is the complement of 
                        M
                        V
                     : 
                        
                           (3)
                           
                              S
                              V
                              =
                              M
                              
                                 
                                    V
                                 
                                 
                                    C
                                 
                              
                              =
                              
                                 {
                                 
                                    q
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 |
                                 Ψ
                                 
                                    (
                                    
                                       q
                                    
                                    )
                                 
                                 <
                                 ν
                                 }
                              
                              .
                           
                        
                      The machined material surface is given by the subset 
                        Ψ
                        =
                        ν
                     .

The simulation abstracts from real life chipping insofar as a point 
                        
                           
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                      within the cutting region “looses” material as soon as it is located within the range of influence of the tool at some time 
                        t
                     . This range of influence in turn depends on the tool’s pose, geometry and direction of movement. More precisely, the transition from configuration 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      to 
                        
                           
                              c
                           
                           
                              i
                              +
                              1
                           
                        
                      at time 
                        
                           
                              t
                           
                           
                              i
                           
                        
                      induces a sweep volume defining the range of influence 
                        R
                        
                           
                              I
                           
                           
                              i
                           
                        
                      of the tool. Representing this sweep volume implicitly by means of a signed distance function 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                        
                           (
                           
                              q
                           
                           )
                        
                        ∈
                        R
                      yields the following subset of 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     : 
                        
                           (4)
                           
                              R
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 {
                                 
                                    q
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 |
                                 
                                    
                                       Θ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       q
                                    
                                    )
                                 
                                 ≤
                                 0
                                 }
                              
                              ,
                           
                        
                      in which 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                      assigns each point in space its distance to the (boundary of the) range of influence at time 
                        
                           
                              t
                           
                           
                              i
                           
                        
                     . Notes on the computation of 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                      are given below.

The intersection of 
                        R
                        
                           
                              I
                           
                           
                              i
                           
                        
                      and the raw material volume 
                        M
                        
                           
                              V
                           
                           
                              i
                           
                        
                      at time 
                        
                           
                              t
                           
                           
                              i
                           
                        
                      yields an approximation of the cut volume, i.e. the removed material volume at the corresponding path segment 
                        
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                     . Three exemplary sweep volumes are shown in Fig. 10
                     . The material volume at the subsequent point in time 
                        
                           
                              t
                           
                           
                              i
                              +
                              1
                           
                        
                      is given by subtracting the sweep volume from the material volume at time 
                        
                           
                              t
                           
                           
                              i
                           
                        
                     : 
                        
                           (5)
                           
                              M
                              
                                 
                                    V
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              =
                              M
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              −
                              R
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              =
                              M
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              ∩
                              R
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                                 
                                    C
                                 
                              
                              .
                           
                        
                      Due to an implicit representation of 
                        M
                        V
                      (scalar field 
                        Ψ
                     ) and 
                        R
                        
                           
                              I
                           
                           
                              i
                           
                        
                      (distance function 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                     ), updating the material volume 
                        M
                        V
                      at path segment 
                        
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                      reduces to an easily parallelizable update of the cutting region grid points: 
                        
                           (6)
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              
                                 (
                                 
                                    q
                                 
                                 )
                              
                              =
                              min
                              
                                 (
                                 
                                    
                                       Ψ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       q
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          q
                                       
                                       )
                                    
                                    +
                                    ν
                                    )
                                 
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              .
                           
                        
                      Given a contour value 
                        ν
                     , the equation ensures the coincidence of the evolved region of the material surface 
                        Ψ
                        =
                        ν
                      and the boundary of the range of influence 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                        =
                        0
                     . Scaling the value range of 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                      by the factor 
                        
                           
                              s
                           
                           
                              i
                           
                        
                      allows to better exploit the (restricted) value range of 
                        Ψ
                      in order to capture the relevant material boundary in more detail. Choosing e.g.  
                        ν
                        =
                        127.5
                      and 
                        
                           
                              s
                           
                           
                              i
                           
                        
                        =
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                        /
                        r
                        +
                        1
                      results in linearly scaling the boundary region 
                        −
                        r
                        ≤
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                        ≤
                        r
                      of the tool’s range of influence to the entire interval 
                        
                           [
                           0
                           ,
                           255
                           ]
                        
                     , with the material surface being given by 
                        Ψ
                        =
                        127.5
                     . Beyond this boundary region, exact distances to 
                        Θ
                        =
                        0
                      are irrelevant and set to 0 (
                        Θ
                        <
                        −
                        r
                     ) or 255 (
                        Θ
                        >
                        r
                     ). This way, the scalar field 
                        Ψ
                      is directly visualizable using methods of direct volume visualization, e.g. ray casting  [15].

The essential part remains the analytical specification of the sweep volumes. The function 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                      assigns each point 
                        
                           q
                        
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                      in space its distance to the boundary of the tool as it transitions from 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      into 
                        
                           
                              c
                           
                           
                              i
                              +
                              1
                           
                        
                     . Since it is unknown at which intermediate configuration 
                        
                           
                              c
                           
                           
                              ∗
                           
                        
                      along the path segment the tool will be coming closest to the point 
                        
                           q
                        
                     , this task is more complicated than just sampling fixed intermediate configurations and neglecting any movement in between. However, 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                      yields a notably smoother approximation of the true cut volume, since a continuous transition is assumed. Given any point 
                        
                           q
                        
                      and a path segment 
                        
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                     , the proposed approach to compute 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                        
                           (
                           
                              q
                           
                           )
                        
                      consists of the following three steps. For the explanation, let each tool configuration 
                        c
                        =
                        
                           (
                           
                              u
                           
                           ,
                           
                              n
                           
                           )
                        
                      denote a tuple of a tool position 
                        
                           u
                        
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                      and normal vector 
                        
                           n
                        
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                      (tool orientation). 
                        
                           1.
                           Guess a configuration 
                                 c
                               that corresponds to 
                                 
                                    q
                                 
                               by interpolating the tool position 
                                 
                                    u
                                 
                               which is closest to 
                                 
                                    q
                                 
                              : presupposing linear movement, 
                                 
                                    u
                                 
                               is given by projecting 
                                 
                                    q
                                 
                               onto the line segment 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    )
                                 
                               that connects the tool positions at 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              ; the same weight is then used to interpolate the orientation 
                                 
                                    n
                                 
                               to yield the guess 
                                 c
                              .

Dependent on the guessed pose 
                                 
                                    (
                                    
                                       u
                                    
                                    ,
                                    
                                       n
                                    
                                    )
                                 
                              , correct 
                                 
                                    u
                                 
                               by displacement along the line segment 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 :
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    u
                                 
                                 +
                                 d
                                 u
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              . The displacement 
                                 d
                                 u
                                 ∈
                                 R
                               depends on the tool geometry, the angle between 
                                 
                                    n
                                 
                               and 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                               and the relative location of 
                                 
                                    q
                                 
                              . Use the interpolation weight of 
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       ∗
                                    
                                 
                               to compute 
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ∗
                                    
                                 
                               to yield the revision 
                                 
                                    
                                       c
                                    
                                    
                                       ∗
                                    
                                 
                              .

Use the revised interpolated tool pose 
                                 
                                    
                                       c
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                               along with the (analytically specified) tool geometry to compute the distance between the tool boundary and 
                                 
                                    q
                                 
                              , e.g. a point-cylinder distance in case of a flat end cutter. As usual, more complicated geometries are subdivided into simpler primitives.

A more detailed treatment of this approach on continuous implicit sweep volumes is beyond the scope of this paper and dedicated to a separate publication. Especially steps 1 and 2 are novel in the context of tool path simulation, while step 3 is common (e.g.  [18]). Step 2 treats the fact that if the tool is inclined in moving direction, the pose which corresponds to the tool position 
                        
                           u
                        
                      closest to 
                        
                           q
                        
                      (in euclidean sense), does generally not induce the least distance between 
                        
                           q
                        
                      and the tool boundary. In other words, the tool boundary comes closest to 
                        
                           q
                        
                      either before or after passing the guessed tool position 
                        
                           u
                        
                     , which is why the latter is corrected by a displacement 
                        d
                        u
                     . Fig. 11
                      depicts the idea of computing 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                        
                           (
                           
                              q
                           
                           )
                        
                      using the presented approach of predictor–corrector interpolation. If, e.g., 
                        
                           n
                        
                      is orthogonal to the moving direction, the cutter shape is convex, and certain requirements on the rate of change of tool orientation are met, then 
                        d
                        u
                        =
                        0
                     .

If a ball-end tool is used and no cutting is performed by the tool shaft, 
                        d
                        u
                      is always 0 and step 2 is omitted to reduce runtime. This is the usual setting for finishing tool paths in dental applications - cf. the simplification without shaft depicted in Fig. 10(c).

Choosing a step function with threshold 
                        ν
                        =
                        127.5
                      as opacity transfer function in conjunction with a standard raycaster yields the exemplary results shown in Fig. 12
                     .

While, in principle, Eq. (6) concerns all grid points of 
                        Ψ
                     , a potential movement of the material surface at time 
                        
                           
                              t
                           
                           
                              i
                           
                        
                      is restricted to the vicinity of 
                        R
                        
                           
                              I
                           
                           
                              i
                           
                        
                     . Therefore, to make sure the material surface is captured completely, it suffices to update the grid points of 
                        Ψ
                      within the bounding box of 
                        R
                        
                           
                              I
                           
                           
                              i
                           
                        
                      extended in each direction by the grid point spacing. This significantly reduces the number of evaluations of 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                      and unnecessary updates of 
                        Ψ
                     .

In the simulation, moving the material surface by subtracting a cut volume corresponds to an update of a subset of grid points, while in reality, mechanical work has to be performed to cut off a chip from raw material. Literature offers various approaches to transfer a concrete cut volume along with tool property definitions into physical features like force or tool deflection, which in turn allows to quantify a workload  [20–23].

Simplistically, the current work assumes the loadability of a tool to be sufficiently captured by a single scalar feature, which defines the amount of material volume the tool is able to cut per second. A deviation of the true cut amount from the given reference value must result in a feed rate update to prevent an over- or underload of the tool. Every tool path segment 
                        
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                      with a transition length 
                        
                           
                              l
                           
                           
                              i
                           
                        
                        =
                        
                           |
                           
                              
                                 
                                    u
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 
                                    u
                                 
                              
                              
                                 i
                              
                           
                           |
                        
                      is assigned an amount of cut material volume 
                        
                           
                              v
                           
                           
                              i
                           
                        
                     , which is computed from the set of grid points satisfying 
                        
                           
                              Θ
                           
                           
                              i
                           
                        
                        ≤
                        0
                     . The specification of a material removal rate 
                        m
                        r
                        r
                      as mentioned above allows a target feed rate 
                        f
                        
                           
                              r
                           
                           
                              i
                           
                        
                      to be computed by
                        
                           (7)
                           
                              f
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   Δ
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      i
                                                   
                                                
                                                m
                                                r
                                                r
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          if  
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          >
                                          0
                                       
                                    
                                    
                                       
                                          f
                                          
                                             
                                                r
                                             
                                             
                                                
                                                   max
                                                
                                             
                                          
                                       
                                       
                                          if  
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        
                      in which 
                        
                           Δ
                        
                        
                           
                              t
                           
                           
                              i
                           
                        
                      denotes the desired time lapse of the transition from 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      to 
                        
                           
                              c
                           
                           
                              i
                              +
                              1
                           
                        
                     , yielding an optimal tool workload in terms of the predefined material removal rate 
                        m
                        r
                        r
                     . Note that 
                        f
                        
                           
                              r
                           
                           
                              i
                           
                        
                      as given in Eq. (7) is valid only if 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              c
                           
                           
                              i
                              +
                              1
                           
                        
                      contain different tool positions, since only in that case 
                        
                           
                              l
                           
                           
                              i
                           
                        
                        >
                        0
                     . This corresponds to allowing cutting solely by means of the translational component of the path segment 
                        
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                      and to prohibit cutting by means of a sole change of orientation.

@&#RESULTS@&#

Besides feed rate optimization, the simulation enables the evaluation of tool paths. For that purpose, the final material surface 
                        
                           
                              Ψ
                           
                           
                              N
                              −
                              1
                           
                        
                        =
                        ν
                      is interpolated and triangulated to obtain the reconstructed surface mesh, and compared against the surface of the original model. An arbitrary point 
                        
                           x
                        
                      on the original mesh would be “hit” in a machining process, if the distance to its closest point 
                        
                           
                              
                                 x
                              
                           
                           
                              ′
                           
                        
                      on the reconstructed mesh is 
                        
                           |
                           
                              x
                           
                           −
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ′
                              
                           
                           |
                        
                        =
                        0
                     , and “missed” with a deviation 
                        
                           
                              ϵ
                           
                           
                              
                                 x
                              
                           
                        
                        >
                        0
                     , if 
                        
                           |
                           
                              x
                           
                           −
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ′
                              
                           
                           |
                        
                        =
                        
                           
                              ϵ
                           
                           
                              
                                 x
                              
                           
                        
                     . In this sense, sampling 
                        
                           
                              ϵ
                           
                           
                              
                                 x
                              
                           
                        
                      using a set of points on the original mesh–e.g. its vertices–yields an accuracy of fit of the tool path. Given an arbitrary point 
                        
                           x
                        
                     , the distance 
                        
                           
                              ϵ
                           
                           
                              
                                 x
                              
                           
                        
                      to its closest point can efficiently be computed by using a spatial map (e.g. an octree) to find all reconstructed faces close to 
                        
                           x
                        
                     , and compute the distance to each of them.


                     Fig. 13
                     (b) shows the distribution of 
                        
                           
                              ϵ
                           
                           
                              
                                 x
                              
                           
                        
                      corresponding to the finishing simulation result shown Fig. 12(b). As can be seen, some peaks indicate points on the original mesh that are missed with a maximum deviation of 
                        ≈
                        0.25
                        
                        
                           mm
                        
                     , while the mean deviation is 
                        
                           
                              
                                 
                                    ϵ
                                 
                                 
                                    
                                       x
                                    
                                 
                              
                           
                           
                              ̄
                           
                        
                        =
                        0.008
                        
                        
                           mm
                        
                     . Fig. 13(a) visualizes the spatial distribution of 
                        
                           
                              ϵ
                           
                           
                              
                                 x
                              
                           
                        
                      by means of vertex coloring, and therefore indicates regions size and large deviations.


                     Figs. 14
                      and 13(a) show four exemplary models of varying complexity in terms of the number of faces, which are used for tool path evaluation, namely a sphere, cap, bridge and Stanford-bunny. Fig. 15
                     (a) shows the relation between path distance 
                        
                           
                              d
                           
                           
                              
                                 tresh
                              
                           
                        
                      and the resulting accuracy of fit of the isogeodesically sampled finishing tool path. As can be seen, decreasing the path distance expectably improves the accuracy of fit in terms of mean deviation, which is caused by the decreasing scallop height between adjacent path segments in conjunction with the finer sampling of the target surface, that allows smaller details to be captured. However, the mean deviation will never become zero since all object surfaces contain cavities that are not contactable by the equipped tool—e.g. sharp bends at the joints of bar and model, as well as undercuts resulting from the tight cutting region and kinematic restrictions, respectively. In fact, the maximum deviation is nearly constant with varying path distances in each of the test cases, while the minimum deviation is 0.


                     Fig. 15(b) shows the corresponding computation times needed to generate and simulate the tool paths using a PC containing a Core2Quad Q9550 CPU, a GeForce 9800GTX GPU and 4 GB of RAM. Computation times increase noticeably with decreasing path distance, in which the slope of time increase depends on the size of the mesh and its number of triangles.

Milling a simple cap like the one shown in Fig. 5(a) in zirconium dioxide using the milling machine Roland DWX30 takes about 7 min roughing and 7 min finishing time, while a more complex cap as shown in Fig. 13(a) takes about 8 min roughing and 10 min finishing time, dependent on chosen parameters. Therefore, the latency of finishing tool path generation is usually imperceptible, since it is completely “hidden” behind the rough machining time. The latency of roughing tool path generation–which is significantly lower due to simplifications–in turn is “hidden” behind machine preparation time, which is about 1–3 min (clamp blank and tool, measure tool length). In that way, there is no computational delay while processing a dental model. However, complex models, like the bridge in Fig. 14(b), may be split into its components (caps and pontic, respectively), which are processed subsequently in order to further reduce latency. Lastly, Fig. 16
                      shows an exemplary milling result.

@&#DISCUSSION@&#

The paper presented a comprehensive and integrated approach of tool path generation, simulation and evaluation in the context of dental implant machining, which is based on implicit representations of relevant employed geometry. Since the input models naturally emerge from scanning instead of computer aided design, their surfaces are given by triangular meshes. The approach is shown to be robust in that nearly arbitrary models may be processed, whose boundaries are given by a triangle mesh, since surface sampling, collision detection and path chaining do not impose special conditions on the mesh.

An implicit definition of tool location paths allows their straightforward generation by means of a numerically approximated distance field 
                        ϕ
                     . Each path segment is a level set of 
                        ϕ
                     , which naturally propagates in the direction 
                        ∇
                        ϕ
                     , equaling the conventional path side step direction. However, in finishing, propagating this level set upon the offset surface results in isogeodesic paths segments whose scallop height may still vary according to the surface curvature in the direction of propagation. Therefore, modulating the distance 
                        ϕ
                      with the curvature 
                        κ
                        
                           (
                           ∇
                           ϕ
                           )
                        
                      transfers the isogeodesic propagation into an isoscallop propagation of level sets, in which an efficient numerical calculation of the modulation is part of current development. The incorporation of implicit methods into tool path generation is highly topical  [11,12], and has many benefits compared to conventional explicit approaches, including its robustness and unified handling in the presence of arbitrary shaped triangular surfaces and tool location paths. These properties render level set methods perfectly suitable for automatic manufacturing in dental applications.

However, efforts are still needed to completely “impersonate” conventional explicit path calculation methods in an implicit way. In particular, tool path generation was limited to ball-end tools. When using the machining surface concept proposed in  [6,24], generating paths for arbitrary tool shapes requires the evaluation of surfaces at multiple location-dependent offsets, which renders level sets a promising approach.

Likewise, research on level set based simulation of tool paths are equally topical  [13]. The current paper especially introduced a new approach to represent sweep volumes implicitly by means of an analytically specifiable distance function. As the approach relies on estimating and correcting the tool pose closest to the input point, the resulting surface quality depends on the exactness of the corrector step to find the true pose. Clearly, the corrector step must trade-off between exactness and runtime, and its optimization is part of current development. The presented feed-rate control, which relies on this fast sweep volume representation to minimize latencies in end-user applications, was able to significantly reduce the risk of tool breakage in experiments.

@&#ACKNOWLEDGMENT@&#

This work was kindly supported by the AiF research project (promotional reference KF2442002WO0) of the Bundesministerium für Wirtschaft und Technologie (BMWi).

@&#REFERENCES@&#

