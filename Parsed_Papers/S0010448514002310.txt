@&#MAIN-TITLE@&#Imposing angle boundary conditions on B-spline/NURBS surfaces

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study the construction of a B-spline surface satisfying prescribed angle distribution of tangent planes along its boundary curve.


                        
                        
                           
                           We prove that for a given B-spline curve, the exact solution exists only in very special cases (for a special form of an angle function).


                        
                        
                           
                           We propose an algorithm for finding an approximate solution, derive a bound on its approximation error and study the approximation order of the proposed algorithm.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

NURBS surface

B-spline surface

Pelton turbine bucket

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            


                        
                           
                              (14)
                              
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                −
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                −
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 q
                                 
                                    (
                                    t
                                    )
                                 
                                 ∈
                                 R
                                 
                                    [
                                    t
                                    ]
                                 
                                 .
                              
                           
                        
                     


                        
                           
                              
                                 cos
                                 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       2
                                       
                                          (
                                          2
                                          +
                                          3
                                          t
                                          −
                                          6
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          3
                                          
                                             
                                                t
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       
                                          
                                             5
                                             −
                                             16
                                             t
                                             +
                                             52
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             56
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             20
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             84
                                             −
                                             52
                                             t
                                             −
                                             51
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1648
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             −
                                             2518
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             −
                                             3604
                                             
                                                
                                                   t
                                                
                                                
                                                   5
                                                
                                             
                                             +
                                             15641
                                             
                                                
                                                   t
                                                
                                                
                                                   6
                                                
                                             
                                             −
                                             22072
                                             
                                                
                                                   t
                                                
                                                
                                                   7
                                                
                                             
                                             +
                                             16108
                                             
                                                
                                                   t
                                                
                                                
                                                   8
                                                
                                             
                                             −
                                             6016
                                             
                                                
                                                   t
                                                
                                                
                                                   9
                                                
                                             
                                             +
                                             916
                                             
                                                
                                                   t
                                                
                                                
                                                   10
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

B-spline and NURBS curves and surfaces are currently the standard objects used in geometric modeling (cf. e.g.  [1]) for shape representation of objects. They are based on polynomial/rational parameterizations of curves and surfaces and allow to describe complex shapes with the composition of a relatively small number of low degree patches.

Since the current CAD/CAM systems mostly rely on the description of objects based on B-spline/NURBS curves and surfaces, the standard approach in industrial engineering is to construct a model of a product in a CAD/CAM system and analyze it with the help of the follow-up computation based on Finite Element Method (FEM) or Finite Volume Method (FVM), depending on a type of an analysis necessary to perform. Such computations typically require to discretize a computational domain, i.e., to find a triangular or rectangular mesh of a surface or tetrahedral or quadrangular mesh of a volume. Obviously, the exact description of an object represented by B-spline/NURBS objects is lost. This can cause errors in the computational analysis and, eventually, in a shape optimization procedure based on the results of these computations. Recently, a modification of the well-known Finite Element Method (see e.g.  [2]) based on B-spline/NURBS objects appeared (cf.  [3,4]). The approach is known as isogeometric analysis and it is similar to FEM, only meshes typically used in FEM are replaced by meshes composed of parts of NURBS surfaces/volumes representing the computational domain. Thus, high-quality parametric geometric models with subsequent application of isogeometric analysis can serve as a cornerstone of modern automatic shape optimization algorithms.

This motivated us to focus on a modeling of a Pelton turbine bucket with the help of B-spline surfaces. Pelton turbine (see Fig. 1
                     ) is a type of an impulse turbine which extracts the energy from the impulse of moving water (see e.g.  [5]). The main component of the Pelton turbine is the runner with buckets (also called Pelton wheel) which converts kinetic energy of the flowing fluid into the rotational energy. The water flows along the tangent to the runner and a nozzle streams the flow of water against buckets (or cups) mounted around the edge of the wheel. The buckets are divided into two parts by the so-called splitter. The water jet strikes the splitter symmetrically and the flow is equally distributed into two halves of the bucket. Pelton turbines belong among the most efficient types of the water turbines and they are the preferred turbines for hydro-power, when the available water source has relatively high hydraulic head at low flow rates.

A lot of papers about numerical and experimental analyses of flow in Pelton turbines have been published in recent years—we will mention only a few of them focusing mainly on a modeling of the flow in the bucket. One of the first attempts to calculate free surface flow in a rotating bucket was done in  [6]. Paper  [7] investigates free surface flow in a Pelton turbine bucket using numerical simulations based on the two-phase homogeneous model. This paper studies the momentum transfer between the water particles and the bucket and shows the regions of the bucket contributing the most to the torque. Numerical analysis of flow in a two jet Pelton turbine with horizontal axis is studied in  [8]. The most complete analysis of flow in Pelton turbines was done in  [9] where flow in a rotating bucket was investigated experimentally through unsteady wall pressure measurements, flow visualizations and water thickness measurements and experimental results are completed with numerical computations. Two different jet configurations are analyzed and interaction between the jet and the bucket is studied in  [10]. CFD model, that predicts the torque applied to a Pelton bucket, subject to high-speed water jet, was developed and described in  [11]. There exist also several papers devoted to optimization procedures for construction of Pelton turbines, see e.g. [12,13]. However, they are not usually focused on the optimization of design parameters of a Pelton turbine bucket and if so, they optimize only basic parameters such as length, width and depth of the bucket. One of the reasons probably consists in complicated description of design parameters and shape properties of the bucket.

In general, there are not many papers concentrating only on geometric models of parts of water turbines, but there are several papers which focus on different techniques for creation of geometric models of their blades (especially for Kaplan and Francis turbines) because of their complicated shape and importance in the process of transferring energy. For example, the methods for interactive design of blades are presented in  [14]. Blades are represented with NURBS surfaces and blades sections are defined with respect to general surfaces of revolution. Another method for modeling turbine blades based on lofted B-splines is presented in  [15], where the lofting process is extended to cylindrical and to conical isoparametric lines. A computer based process for modeling blades of horizontal axis turbines using B-spline surfaces is described in  [16]. This method starts with the creation of a 3D set of offsets that constitute rotor blades based on a 2D definition of airfoils, which is normally used in the design of different stations along the rotor blade and there is an emphasis on the fitting of a blade’s leading edge. Most of the methods for modeling turbine’s blades focus on using several profiles (sections) of blades and connecting them together to obtain geometric model, whereas M. Rossgatterer et al. (see  [17]) use an approach based on medial surface of a blade and profile curves attached to it and the construction of these curves depends on B-splines. Furthermore, there exist several papers devoted to particular problems related to the construction of geometric models of parts of industrial machines. For instance, the paper  [18] presents an algorithm for generating B-spline curves with cusps or B-spline surfaces with edges containing cusps with a specific angle constraint at the cusp. In paper  [19], the authors focus on a constrained object reconstruction. In particular, as a part of the algorithm a method for joining a plane and a free-form B-spline surface with a constant angle constraint is presented in the paper.

The geometric model of a Pelton turbine bucket based on B-spline surfaces can be composed of a relatively small number of bicubic patches. Moreover, it allows to use isogeometric analysis for numerical simulations of the flow in the bucket and, consequently, for the shape optimization of the bucket. Since the bucket is usually given by several parameters (angles and distances), we investigate the imposition of these parameters to a B-spline model of the bucket. In particular, the main aim of the paper is to study given angle boundary conditions prescribed along a splitter and an outlet curve of the bucket and how they can be satisfied on the B-spline model. The main results of the paper are: (1) we prove that generally there exists no exact solution of this problem and (2) we propose an algorithm for finding an approximate solution, together with deriving a bound on its approximation error and numerical confirmation of an optimal approximation order of the algorithm.

The rest of the paper is organized as follows. Section  2 briefly reviews the fundamentals of B-spline and NURBS curves and surfaces. Section  3 is devoted to the description of the problem and mainly discusses the existence of an exact solution. In Section  4, we formulate an algorithm for computation of an approximate solution, give a bound for its approximation error, numerically derive an approximation order of the algorithm and present several examples. Section  5 then concludes the paper.

In this section, we briefly review fundamentals of the theory of B-spline/NURBS curves and surfaces, for more details see e.g.  [1].

A NURBS curve of degree 
                     
                        p
                      is determined by a control polygon of control points 
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                     , their associated weights 
                        
                           
                              w
                           
                           
                              i
                           
                        
                        ,
                        
                        i
                        =
                        0
                        ,
                        …
                        ,
                        n
                      and a knot vector 
                        T
                        =
                        
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                                 +
                                 p
                                 +
                                 1
                              
                           
                           )
                        
                     . Then its parameterization is of the form 
                        
                           (1)
                           
                              
                                 c
                              
                              
                                 (
                                 u
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              N
                           
                           
                              i
                              ,
                              p
                           
                        
                        
                           (
                           u
                           )
                        
                      are B-spline basis functions of degree 
                        p
                      corresponding to the knot vector 
                        T
                     .

For the given knot vector 
                        T
                        =
                        
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                                 +
                                 p
                                 +
                                 1
                              
                           
                           )
                        
                     , the B-spline basis functions are defined by a recursive formula 
                        
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                       ,
                                       0
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                             ,
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             ≤
                                             t
                                             <
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             otherwise ,
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       t
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             k
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                       ,
                                       k
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             k
                                             +
                                             1
                                          
                                       
                                       −
                                       t
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             k
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                       +
                                       1
                                       ,
                                       k
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                                 .
                              
                           
                        
                      The knot vector is a non-decreasing sequence of real numbers which determines the distribution of a parameter of the corresponding curve/surface/volume. In general, two different forms of the knot vector are commonly distinguished: periodic and non-periodic. Further, we distinguish uniform (uniformly distributed knots) and non-uniform (non-uniformly distributed knots) knot vectors.

One of the main properties of B-spline basis functions is a relation between the multiplicity of knots in the knot vector and the continuity of the corresponding B-spline basis functions—the B-spline basis functions are of continuity 
                        
                           
                              C
                           
                           
                              p
                              −
                              k
                           
                        
                     , where 
                        k
                      is the maximal multiplicity of inner knots in the knot vector. Among their other properties belong non-negativity, partition of unity and local support.

B-spline/NURBS curves possess a lot of important practical properties which follow from their definition and from the properties of B-spline basis functions, such as affine/projective invariance, convex hull property, local modification and variation diminishing property (see  [1]).

As a straightforward extension, we can define NURBS surfaces that share most of the properties with NURBS curves. A NURBS surface of degree 
                     
                        
                           (
                           p
                           ,
                           q
                           )
                        
                      is determined by a control net of 
                        
                           (
                           m
                           +
                           1
                           )
                        
                        ×
                        
                           (
                           n
                           +
                           1
                           )
                        
                      control points 
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              j
                           
                        
                     , their associated weights 
                        
                           
                              w
                           
                           
                              i
                              j
                           
                        
                        ,
                        
                        i
                        =
                        0
                        ,
                        …
                        ,
                        m
                        ,
                        
                        j
                        =
                        0
                        ,
                        …
                        ,
                        n
                     , and two knot vectors 
                        U
                        =
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 u
                              
                              
                                 m
                                 +
                                 p
                                 +
                                 1
                              
                           
                           )
                        
                        ,
                        
                        V
                        =
                        
                           (
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 n
                                 +
                                 q
                                 +
                                 1
                              
                           
                           )
                        
                     . Then its parameterization is of the form
                        
                           (2)
                           
                              
                                 s
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    
                                       
                                          N
                                       
                                       
                                          j
                                          ,
                                          q
                                       
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    
                                       
                                          N
                                       
                                       
                                          j
                                          ,
                                          q
                                       
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              N
                           
                           
                              i
                              ,
                              p
                           
                        
                        
                           (
                           u
                           )
                        
                      and 
                        
                           
                              N
                           
                           
                              j
                              ,
                              q
                           
                        
                        
                           (
                           v
                           )
                        
                      are B-spline basis functions of degrees 
                        p
                      and 
                        q
                      corresponding to the knot vectors 
                        U
                      and 
                        V
                     , respectively (see Fig. 2
                     ).


                     
                        Remark 1
                        Let us mention that there exist algorithms for modification of a knot vector and, concurrently, the corresponding control polygon/control net by inserting new knots or elevating degree which do not affect the shape and the parameterization of a NURBS curve/surface. Moreover, these algorithms are very simple as they require to compute only simple combinations of control points to obtain new control polygon/net. More details about knot insertion and degree elevation algorithms can be found in  [1, Sections 5.2 and 5.5].

In the rest of the paper, we will study the following problem: Let 
                        
                           
                              
                                 c
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             x
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       0
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                              
                              t
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           
                        
                      be a polynomial/rational parameterization of a given curve, e.g. B-spline/NURBS curve being a boundary curve of a general NURBS surface 
                        
                           s
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     , let 
                        
                           u
                        
                        =
                        
                           
                              
                                 (
                                 0
                                 ,
                                 0
                                 ,
                                 1
                                 )
                              
                           
                           
                              ⊤
                           
                        
                      be a given vector and let 
                        f
                        
                           (
                           t
                           )
                        
                      be a function describing desired angle distribution which we need to prescribe on 
                        
                           s
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                      along 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      with respect to 
                        
                           u
                        
                     , i.e., it holds that 
                        
                           (3)
                           
                              cos
                              
                              f
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       1
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              ⋅
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ,
                                             
                                                
                                                   c
                                                
                                                
                                                   y
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ,
                                             0
                                             )
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                    ×
                                    
                                       n
                                    
                                    
                                       (
                                       0
                                       ,
                                       t
                                       )
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                ,
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                ,
                                                0
                                                )
                                             
                                          
                                          
                                             ⊤
                                          
                                       
                                       ×
                                       
                                          n
                                       
                                       
                                          (
                                          0
                                          ,
                                          t
                                          )
                                       
                                       ‖
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 n
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          s
                                       
                                    
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    ×
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             s
                                          
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       ×
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       ‖
                                    
                                 
                              
                           
                        
                      is a normalized normal vector field of a ruled surface 
                        
                           (4)
                           
                              
                                 r
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                              =
                              
                                 (
                                 1
                                 −
                                 s
                                 )
                              
                              
                                 c
                              
                              
                                 (
                                 t
                                 )
                              
                              +
                              s
                              
                                 d
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                              ∈
                              R
                              ×
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           
                        
                      determined by the curves 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      and 
                        
                           d
                        
                        
                           (
                           t
                           )
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       x
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       y
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       z
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 )
                              
                           
                           
                              ⊤
                           
                        
                        ,
                        t
                        ∈
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                     . Is it possible to find polynomial/rational curve 
                        
                           d
                        
                        
                           (
                           t
                           )
                        
                      such that the ruled surface (4) (and also 
                        
                           s
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     ) satisfies the prescribed angle distribution 
                        f
                        
                           (
                           t
                           )
                        
                      along 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                     ?

The ruled surface 
                        
                           r
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                      represents the tangent surface to the desired surface 
                        
                           s
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                      with 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      being the boundary curve of 
                        
                           s
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                      and 
                        f
                        
                           (
                           t
                           )
                        
                      the prescribed angle distribution along 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                     . In the context of B-spline/NURBS surfaces, whereas the control polygon of 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      determines the boundary column (row) of the control net of 
                        
                           s
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     , the control polygon of 
                        
                           d
                        
                        
                           (
                           t
                           )
                        
                      (defined for the same knot vector) represents the neighboring column (row) of this control net. Altogether, control polygons of 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      and 
                        
                           d
                        
                        
                           (
                           t
                           )
                        
                      determine the control net of the ruled surface (4) representing the tangent surface to the B-spline/NURBS surface 
                        
                           s
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                      and also the first and second columns (rows) of the control net for the NURBS surface 
                        
                           s
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     .


                     
                        Remark 2
                        Let us emphasize that the angle distribution defined in (3) is independent of directions of the rulings of 
                           
                              
                                 r
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           , as it is related to the normal vector of 
                              
                                 r
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                            along 
                              
                                 c
                              
                              
                                 (
                                 t
                                 )
                              
                           .


                     
                        Remark 3
                        We study this case for the simplicity of the presented results, but exactly the same approach, presented in the following paragraphs, can be used for a general case, where 
                              
                                 c
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             x
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             z
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                              
                              t
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                            and 
                              
                                 u
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             y
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             z
                                          
                                       
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           , only the results are too long to be included into the paper.

The study of this problem is motivated by the practical problem—modeling of an inner surface of a Pelton turbine bucket, see Fig. 3
                     . Since the bucket is symmetrical with respect to the splitter, it is enough to model only one part. Usually, it is given by several angles and distances (see Fig. 4
                     ):
                        
                           •
                           length (
                                 l
                              ),

width (
                                 w
                              ),

depth (
                                 d
                              ),

length of a splitter (
                                 
                                    
                                       l
                                    
                                    
                                       s
                                    
                                 
                              ),

width of a cutout in a bucket (
                                 
                                    
                                       w
                                    
                                    
                                       c
                                    
                                 
                              ),

inclination of a splitter (
                                 
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                              ),


                              angle distribution along a splitter (
                                 
                                    
                                       a
                                    
                                    
                                       s
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              ),


                              outlet angle distribution from the bucket (
                                 
                                    
                                       a
                                    
                                    
                                       o
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              ).

Without giving all the technical details, we will briefly mention how to prescribe some of the parameters determining the shape of the bucket. One way is to start with the boundary of a B-spline surface describing the bucket, i.e., we describe the control points of the boundary curves. With the help of standard algorithms for knot insertion (see Remark 1) it is possible to satisfy given length, width, length of the splitter, inclination of the splitter and width of a cutout in the bucket, see Fig. 4. Then, we prescribe given angle distributions along a splitter and an outlet curve with the help of the algorithm presented in this paper. Further, it is necessary to preserve the given depth of the bucket. This can be done again with the help of knot insertion—a suitably chosen inner curve is included into the model via determining its control points, see Fig. 4. Finally, remaining control points are determined by minimizing the sum of the squared second order differences of control points to minimize the curvature of the resulting surface.

The most difficult part of imposing given angles and distances on the Pelton turbine bucket B-spline model is to satisfy prescribed angle along a splitter and an outlet angle distribution which relates to the problem described in the previous paragraphs and which is the main aim of the paper.

In the rest of the paper, the practical example which we will have in mind and which we will use for demonstrating most of the results, will be the uniform bicubic B-spline surface composed of 7×4 patches which is determined by the control net of 12×7 control points and knot vectors 
                        
                           
                              
                                 U
                                 =
                                 
                                    (
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    1
                                    /
                                    7
                                    ,
                                    2
                                    /
                                    7
                                    ,
                                    3
                                    /
                                    7
                                    ,
                                    4
                                    /
                                    7
                                    ,
                                    4
                                    /
                                    7
                                    ,
                                    4
                                    /
                                    7
                                    ,
                                    5
                                    /
                                    7
                                    ,
                                    6
                                    /
                                    7
                                    ,
                                    1
                                    ,
                                    1
                                    ,
                                    1
                                    ,
                                    1
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 V
                                 =
                                 
                                    (
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    1
                                    /
                                    4
                                    ,
                                    1
                                    /
                                    2
                                    ,
                                    3
                                    /
                                    4
                                    ,
                                    1
                                    ,
                                    1
                                    ,
                                    1
                                    ,
                                    1
                                    )
                                 
                                 .
                              
                           
                        
                      This B-spline surface gives enough flexibility to model the shape of the inner surface of a Pelton turbine bucket. The multiplicity of one inner knot in 
                        U
                      is increased to three to include one inner curve, representing the prescribed depth of a bucket, see Fig. 4. Despite this fact, the final B-spline surface is 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      continuous (as the conditions for 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      continuity across the inner curve are prescribed on the control points in the control net).

In this section, we will study the existence of an exact solution of the above mentioned problem. Let 
                           
                              c
                           
                           
                              (
                              t
                              )
                           
                         and 
                           
                              u
                           
                         be defined as in the beginning of Section  3 and let 
                           f
                           
                              (
                              t
                              )
                           
                         be a given function defined for 
                           t
                           ∈
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        . We want to determine if there always exists another polynomial/rational curve 
                           
                              d
                           
                           
                              (
                              t
                              )
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          z
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                              
                              
                                 ⊤
                              
                           
                           ,
                           
                           t
                           ∈
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                         such that the ruled surface 
                           
                              r
                           
                           
                              (
                              s
                              ,
                              t
                              )
                           
                         (cf. (4)) fulfills (3), or if such a curve 
                           
                              d
                           
                           
                              (
                              t
                              )
                           
                         exists only in special cases.

Thus, in the first step we need to compute 
                           
                              d
                           
                           
                              (
                              t
                              )
                           
                         for given 
                           
                              c
                           
                           
                              (
                              t
                              )
                           
                           ,
                           
                              u
                           
                         and 
                           f
                           
                              (
                              t
                              )
                           
                        . Normal vectors of 
                           
                              r
                           
                           
                              (
                              s
                              ,
                              t
                              )
                           
                         along 
                           
                              c
                           
                           
                              (
                              t
                              )
                           
                         can be written in the form (for brevity we mention not normalized form) 
                           
                              
                                 
                                    n
                                 
                                 
                                    (
                                    s
                                    ,
                                    t
                                    )
                                 
                                 
                                    
                                       |
                                    
                                    
                                       s
                                       =
                                       0
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   d
                                                
                                                
                                                   z
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   y
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   z
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                −
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                )
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                −
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                )
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   y
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Substituting to (3) we obtain 
                           
                              (5)
                              
                                 cos
                                 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             z
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   y
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         −
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         )
                                                      
                                                      +
                                                      
                                                         (
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         −
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            y
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   d
                                                
                                                
                                                   z
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         If we denote 
                           g
                           
                              (
                              t
                              )
                           
                           =
                           cos
                           
                           f
                           
                              (
                              t
                              )
                           
                        , then we compare 
                           
                              
                                 g
                              
                              
                                 2
                              
                           
                           
                              (
                              t
                              )
                           
                         with the square of the right-hand side of (5), i.e.,  
                           
                              (6)
                              
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             d
                                          
                                          
                                             z
                                          
                                       
                                       
                                          
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         and we can solve this equation with respect to 
                           
                              
                                 d
                              
                              
                                 x
                              
                           
                           
                              (
                              t
                              )
                           
                        . We arrive at 
                           
                              (7)
                              
                                 
                                    
                                       d
                                    
                                    
                                       x
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       x
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                y
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 ±
                                 
                                    
                                       d
                                    
                                    
                                       z
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                    
                                       
                                          
                                             1
                                             −
                                             
                                                
                                                   g
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       g
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   y
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                         Similarly, we can solve (6) with respect to 
                           
                              
                                 d
                              
                              
                                 y
                              
                           
                           
                              (
                              t
                              )
                           
                         to obtain 
                           
                              (8)
                              
                                 
                                    
                                       d
                                    
                                    
                                       y
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       y
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                x
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                x
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             c
                                          
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 ±
                                 
                                    
                                       d
                                    
                                    
                                       z
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                    
                                       
                                          
                                             1
                                             −
                                             
                                                
                                                   g
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       g
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   y
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             c
                                          
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                           
                         or with respect to 
                           
                              
                                 d
                              
                              
                                 z
                              
                           
                           
                              (
                              t
                              )
                           
                         to obtain 
                           
                              (9)
                              
                                 
                                    
                                       d
                                    
                                    
                                       z
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             1
                                             −
                                             
                                                
                                                   g
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          −
                                          
                                             
                                                d
                                             
                                             
                                                y
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                x
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                x
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   y
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         Thus, (7) obtained for an arbitrary 
                           
                              
                                 d
                              
                              
                                 y
                              
                           
                           
                              (
                              t
                              )
                           
                           ,
                           
                              
                                 d
                              
                              
                                 z
                              
                           
                           
                              (
                              t
                              )
                           
                         (or (8) obtained for an arbitrary 
                           
                              
                                 d
                              
                              
                                 x
                              
                           
                           
                              (
                              t
                              )
                           
                           ,
                           
                              
                                 d
                              
                              
                                 z
                              
                           
                           
                              (
                              t
                              )
                           
                        , or (9) obtained for an arbitrary 
                           
                              
                                 d
                              
                              
                                 x
                              
                           
                           
                              (
                              t
                              )
                           
                           ,
                           
                              
                                 d
                              
                              
                                 y
                              
                           
                           
                              (
                              t
                              )
                           
                        ) completes the parameterization of the curve 
                           
                              d
                           
                           
                              (
                              t
                              )
                           
                         such that the ruled surface 
                           
                              r
                           
                           
                              (
                              s
                              ,
                              t
                              )
                           
                         given in (4) satisfies the given angle distribution 
                           f
                           
                              (
                              t
                              )
                           
                         along 
                           
                              c
                           
                           
                              (
                              t
                              )
                           
                         (cf. (3)).

Further, we focus on an analysis of polynomiality/rationality of 
                           
                              d
                           
                           
                              (
                              t
                              )
                           
                        . First, if a given curve 
                           
                              c
                           
                           
                              (
                              t
                              )
                           
                         is a rationally parameterized curve, when is also the curve 
                           
                              d
                           
                           
                              (
                              t
                              )
                           
                         rational? In other words, if 
                           
                              c
                           
                           
                              (
                              t
                              )
                           
                         is a NURBS curve, when is also 
                           
                              d
                           
                           
                              (
                              t
                              )
                           
                         a NURBS curve? We can distinguish two cases: 
                           
                              1.
                              
                                 
                                    
                                       c
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  
                                 is a Pythagorean hodograph (PH) curve: the defining property of planar PH curves (for more details see  [20] and references cited therein) is that square of the norm of its hodograph is a square of some rational function. This implies that the square root 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                  in (7) cancels. Thus, 
                                    
                                       
                                          d
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  is rational if and only if 
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  and 
                                    
                                       
                                          d
                                       
                                       
                                          z
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  are rational and
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                g
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          =
                                          q
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                  for some rational function 
                                    q
                                    
                                       (
                                       t
                                       )
                                    
                                 . Thus, 
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  must be of the form 
                                    
                                       (10)
                                       
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                1
                                                +
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          ,
                                          
                                          q
                                          
                                             (
                                             t
                                             )
                                          
                                          ∈
                                          R
                                          
                                             (
                                             t
                                             )
                                          
                                          .
                                       
                                    
                                  It is obvious that expressions (8) and (9) lead to exactly the same condition.


                                 
                                    
                                       c
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  
                                 is not a Pythagorean hodograph curve: 
                                    
                                       
                                          d
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  is rational if and only if 
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  and 
                                    
                                       
                                          d
                                       
                                       
                                          z
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  are rational and 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                g
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          =
                                          q
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                  for some rational function 
                                    q
                                    
                                       (
                                       t
                                       )
                                    
                                 . Thus, 
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  must be of the form 
                                    
                                       (11)
                                       
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          ,
                                          
                                          q
                                          
                                             (
                                             t
                                             )
                                          
                                          ∈
                                          R
                                          
                                             (
                                             t
                                             )
                                          
                                          .
                                       
                                    
                                  It is again obvious that expressions (8) and (9) lead to exactly the same condition.


                              Let 
                              
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               
                              be a given NURBS curve, representing boundary curve of a NURBS surface. Then there exists another NURBS curve 
                              
                                 
                                    d
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               
                              such that the ruled surface   (4)   fulfills angle distribution   (3)   for given 
                              
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               
                              along 
                              
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               
                              if and only if either 
                              
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               
                              is a Pythagorean hodograph curve  and  
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       cos
                                    
                                    
                                       2
                                    
                                 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               
                              is of the form   (10)   for some 
                              
                                 q
                                 
                                    (
                                    t
                                    )
                                 
                                 ∈
                                 R
                                 
                                    (
                                    t
                                    )
                                 
                              
                              , or 
                              
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       cos
                                    
                                    
                                       2
                                    
                                 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               
                              is of the form   (11)   for some 
                              
                                 q
                                 
                                    (
                                    t
                                    )
                                 
                                 ∈
                                 R
                                 
                                    (
                                    t
                                    )
                                 
                              
                              .
                           

Second, we can ask, whether there exists a polynomial parameterization 
                           
                              d
                           
                           
                              (
                              t
                              )
                           
                        , if the given curve 
                           
                              c
                           
                           
                              (
                              t
                              )
                           
                         is polynomial. We can use the similar approach as above but we have to distinguish between the cases represented by (7)–(9) now:
                           
                              1.
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  is polynomial if and only if 
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  and 
                                    
                                       
                                          d
                                       
                                       
                                          z
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  are polynomial and 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          ±
                                          
                                             
                                                d
                                             
                                             
                                                z
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                g
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            y
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          =
                                          q
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                  for some polynomial function 
                                    q
                                    
                                       (
                                       t
                                       )
                                    
                                 . Thus, 
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  must be of the form 
                                    
                                       (12)
                                       
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      z
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         −
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         +
                                                         q
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               y
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      z
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          ,
                                          
                                          q
                                          
                                             (
                                             t
                                             )
                                          
                                          ∈
                                          R
                                          
                                             [
                                             t
                                             ]
                                          
                                          ;
                                       
                                    
                                 
                              


                                 
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  is polynomial if and only if 
                                    
                                       
                                          d
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  and 
                                    
                                       
                                          d
                                       
                                       
                                          z
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  are polynomial and 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          ±
                                          
                                             
                                                d
                                             
                                             
                                                z
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                g
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            y
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          =
                                          q
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                  for some polynomial function 
                                    q
                                    
                                       (
                                       t
                                       )
                                    
                                 . Thus, 
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  must be of the form 
                                    
                                       (13)
                                       
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      z
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               y
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         −
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               y
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         +
                                                         q
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      z
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          ,
                                          
                                          q
                                          
                                             (
                                             t
                                             )
                                          
                                          ∈
                                          R
                                          
                                             [
                                             t
                                             ]
                                          
                                          ;
                                       
                                    
                                 
                              


                                 
                                    
                                       
                                          d
                                       
                                       
                                          z
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  is polynomial if and only if 
                                    
                                       
                                          d
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  and 
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  are polynomial and 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            y
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          q
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                  for some polynomial function 
                                    q
                                    
                                       (
                                       t
                                       )
                                    
                                 . Thus, 
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  must be of the form given in Box I
                                 .


                        
                           Proposition 2
                           
                              Let 
                              
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               
                              be a given B-spline curve, representing a boundary curve of a B-spline surface. Then there exists another B-spline curve 
                              
                                 
                                    d
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               
                              such that the ruled surface   (4)   fulfills angle distribution   (3)   for given 
                              
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               
                              along 
                              
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               
                              if and only if 
                              
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       cos
                                    
                                    
                                       2
                                    
                                 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               
                              is of the form   (12)
                              ,   (13)   or   (14)   given in   Box I   for some 
                              
                                 q
                                 
                                    (
                                    t
                                    )
                                 
                                 ∈
                                 R
                                 
                                    [
                                    t
                                    ]
                                 
                              
                              .
                           


                        
                           Example 1
                           Let 
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               be a Bézier curve given by control points 
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          0
                                          ,
                                          0
                                          ,
                                          0
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          1
                                          ,
                                          2
                                          ,
                                          0
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          4
                                          ,
                                          1
                                          ,
                                          0
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          5
                                          ,
                                          −
                                          1
                                          ,
                                          0
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                              , i.e.,  
                                 
                                    
                                       
                                          c
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                t
                                                
                                                   (
                                                   3
                                                   +
                                                   6
                                                   t
                                                   −
                                                   4
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                ,
                                                t
                                                
                                                   (
                                                   6
                                                   −
                                                   9
                                                   t
                                                   +
                                                   2
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                ,
                                                0
                                                )
                                             
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                       
                                       t
                                       ∈
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                       ,
                                    
                                 
                               and let 
                                 cos
                                 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               is given in Box II
                              . We want to know if there exists a polynomial 
                                 
                                    d
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               (as 
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               is polynomial) such that 
                                 
                                    r
                                 
                                 
                                    (
                                    s
                                    ,
                                    t
                                    )
                                 
                               defined in (4) fulfills given 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                              . Thus, we need to check if 
                                 cos
                                 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               is of the form (12). Let us arbitrarily choose 
                                 
                                    
                                       d
                                    
                                    
                                       y
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       z
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              , e.g.  
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             y
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       t
                                       
                                          (
                                          9
                                          −
                                          18
                                          t
                                          +
                                          5
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                       
                                          
                                             d
                                          
                                          
                                             z
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       −
                                       2
                                       −
                                       3
                                       t
                                       +
                                       6
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       3
                                       
                                          
                                             t
                                          
                                          
                                             3
                                          
                                       
                                       .
                                    
                                 
                               Then, the necessary and sufficient condition for the existence of a polynomial 
                                 
                                    
                                       d
                                    
                                    
                                       x
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               is that there exists a polynomial 
                                 q
                                 
                                    (
                                    t
                                    )
                                 
                               such that (12) holds. Thus, we can substitute components of 
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       y
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       z
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               and 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               into (12) and solve for 
                                 q
                                 
                                    (
                                    t
                                    )
                                 
                              . We obtain 
                                 
                                    
                                       q
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          1
                                          −
                                          3
                                          t
                                          −
                                          3
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          5
                                          
                                             
                                                t
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                               Thus, the exact solution exists! Then, with the help of (7) we arrive at 
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             x
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          1
                                          +
                                          3
                                          t
                                          +
                                          9
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          3
                                          
                                             
                                                t
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           

It is obvious that this example is artificial. For general function 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                              , there is no polynomial 
                                 q
                                 
                                    (
                                    t
                                    )
                                 
                               and 
                                 
                                    d
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               (see below). In this particular case, we just wanted to show that if we start from the solution (we basically started with 
                                 
                                    d
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               and computed the corresponding 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               in this example), we can reconstruct the exact solution.

On the other hand, if we choose another angle function, e.g.  
                                 
                                    
                                       cos
                                       
                                       f
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                               then we can test if there exists at least some rational curve 
                                 
                                    d
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               such that 
                                 
                                    r
                                 
                                 
                                    (
                                    s
                                    ,
                                    t
                                    )
                                 
                               defined in (4) fulfills given 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               with the help of expression (11). Substituting components of 
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               and 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               to (11) and solving with respect to 
                                 q
                                 
                                    (
                                    t
                                    )
                                 
                               we obtain 
                                 
                                    
                                       q
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       ±
                                       
                                          
                                             
                                                
                                                   −
                                                   20
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   +
                                                   56
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         7
                                                      
                                                   
                                                   −
                                                   52
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                   +
                                                   16
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                   +
                                                   15
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   −
                                                   56
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   +
                                                   52
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   16
                                                   t
                                                   +
                                                   5
                                                
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                3
                                                t
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                               which is not rational. According to Proposition 1 we can conclude that there exists no exact solution of the above mentioned problem for this choice of the angle function 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                              .


                        
                           Remark 4
                           
                              Propositions 1 and 2 imply that an exact solution, represented by a B-spline/NURBS curve 
                                 
                                    d
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              , for a given B-spline/NURBS curve 
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               exists only for a very special form of the given function 
                              
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               representing an angle distribution along 
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              , i.e., only in very rare cases. In practice, 
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                               is usually given as a polynomial function which is clearly not of the form mentioned in Propositions 1 and 2. Thus, this problem does not have an exact solution in most cases. This motivates us to formulate an algorithm for finding an approximate solution which is demonstrated and studied in the next section.


                     
                        
                           
                        
                     
                  

In this section, we will formulate an algorithm for finding an approximate solution to the problem stated in the previous section, derive an upper bound for the error of approximate angle distribution and study an approximation order of the method.

Algorithm starts with a given regular B-spline curve 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                        =
                        
                           (
                           x
                           
                              (
                              t
                              )
                           
                           ,
                           y
                           
                              (
                              t
                              )
                           
                           ,
                           0
                           )
                        
                        ,
                        
                        t
                        ∈
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                     , which is described by its control polygon 
                        
                           
                              
                                 {
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                      and knot vector 
                        U
                     , and with a function 
                        f
                        
                           (
                           t
                           )
                        
                      describing the desired angle distribution along 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                     .

In the first step, we determine the exact solution 
                        
                           r
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                        =
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                        +
                        s
                        
                           v
                        
                        
                           (
                           t
                           )
                        
                        ,
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                        ∈
                        R
                        ×
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                     , where 
                        
                           v
                        
                        
                           (
                           t
                           )
                        
                      is a vector field along 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      such that 
                        
                           
                              
                                 
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       1
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              ⋅
                              
                                 
                                    
                                       v
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          v
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ‖
                                    
                                 
                              
                              =
                              cos
                              
                              f
                              
                                 (
                                 t
                                 )
                              
                              .
                           
                        
                      Thus, 
                        
                           v
                        
                        
                           (
                           t
                           )
                        
                      is of the form 
                        
                           
                              
                                 v
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 R
                              
                              
                                 (
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                                 )
                              
                              .
                              
                                 
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       1
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                           
                        
                      where 
                        
                           R
                        
                        
                           (
                           f
                           
                              (
                              t
                              )
                           
                           )
                        
                      is the rotation matrix describing the counterclockwise rotation around the unit tangent vector 
                        
                           
                              
                                 w
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       0
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                           
                        
                      i.e.,  
                        
                           
                              
                                 R
                              
                              
                                 (
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                                 )
                              
                              =
                              
                                 w
                              
                              
                                 (
                                 t
                                 )
                              
                              
                                 w
                              
                              
                                 
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              +
                              cos
                              
                              f
                              
                                 (
                                 t
                                 )
                              
                              
                                 (
                                 
                                    I
                                 
                                 −
                                 
                                    w
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                    w
                                 
                                 
                                    
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 )
                              
                              +
                              sin
                              f
                              
                                 (
                                 t
                                 )
                              
                              
                                 (
                                 
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                z
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                w
                                             
                                             
                                                y
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                z
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                x
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    
                                       
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                y
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                w
                                             
                                             
                                                x
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          0
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                      We obtain 
                        
                           (15)
                           
                              
                                 v
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             sin
                                             
                                                (
                                                f
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                )
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                       −
                                       
                                          
                                             sin
                                             
                                                (
                                                f
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                )
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                       cos
                                       
                                          (
                                          f
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              .
                           
                        
                      Thus, we found a non-rational parameterization of a ruled surface 
                        
                           r
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                      such that the angle between its ruling 
                        
                           r
                        
                        
                           (
                           s
                           ,
                           T
                           )
                        
                      and the vector 
                        
                           
                              
                                 (
                                 0
                                 ,
                                 0
                                 ,
                                 1
                                 )
                              
                           
                           
                              ⊤
                           
                        
                      is 
                        f
                        
                           (
                           T
                           )
                        
                     , for any 
                        T
                        ∈
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                     .

Then, the approximation starts with selecting a suitable initial control polygon of a B-spline curve 
                        
                           
                              
                                 c
                              
                           
                           
                              ̂
                           
                        
                        
                           (
                           t
                           )
                        
                      which will be refined to the final approximation curve 
                        
                           
                              
                                 c
                              
                           
                           
                              ̄
                           
                        
                        
                           (
                           t
                           )
                        
                      in the follow-up minimization procedure. Let us emphasize that the number of control points and the knot vector of 
                        
                           
                              
                                 c
                              
                           
                           
                              ̂
                           
                        
                        
                           (
                           t
                           )
                        
                      and 
                        
                           
                              
                                 c
                              
                           
                           
                              ̄
                           
                        
                        
                           (
                           t
                           )
                        
                      (i.e., also the degree) are not arbitrary, they must be the same as for 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      because 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      and 
                        
                           
                              
                                 c
                              
                           
                           
                              ̄
                           
                        
                        
                           (
                           t
                           )
                        
                      must fit into the same control net of a final B-spline/NURBS surface and we do not want to change the number of control points and knot vector of 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                     .

Because of our consideration the given curve 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      being a planar curve in 
                        x
                        y
                     -plane (which is motivated by the practical example of modeling an inner surface of a Pelton turbine bucket) we choose control points 
                        
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                      of 
                        
                           
                              
                                 c
                              
                           
                           
                              ̂
                           
                        
                        
                           (
                           t
                           )
                        
                      to have 
                        x
                     - and 
                        y
                     -coordinates the same as 
                        
                           
                              
                                 {
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                     , only 
                        z
                     -coordinates are changed. The choice of 
                        z
                     -coordinate 
                        
                           
                              z
                           
                           
                              i
                           
                        
                      of the point 
                        
                           
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    ̂
                                 
                              
                           
                           
                              i
                           
                        
                      is arbitrary with one exception: 
                        
                           
                              z
                           
                           
                              i
                           
                        
                        ≠
                        0
                      must hold. Thus, vector of 
                        z
                     -coordinates 
                        
                           z
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                      of control points 
                        
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                      is another input to the algorithm.

Since we need to refine the control points 
                        
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                      such that the corresponding B-spline curve is the best approximation of the selected points on 
                        
                           r
                        
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     , we introduce new control points 
                        
                           (16)
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              ,
                              
                              i
                              =
                              0
                              ,
                              …
                              ,
                              n
                           
                        
                      of the final approximation B-spline curve 
                        
                           
                              
                                 c
                              
                           
                           
                              ̄
                           
                        
                        
                           (
                           t
                           )
                        
                      with unknown shifts 
                        
                           (
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 Z
                              
                              
                                 i
                              
                           
                           )
                        
                        ,
                        
                        i
                        =
                        0
                        ,
                        …
                        ,
                        n
                     . Then we sample the B-spline curve 
                        
                           
                              
                                 c
                              
                           
                           
                              ̂
                           
                        
                        
                           (
                           t
                           )
                        
                      and for each selected point 
                        
                           
                              
                                 c
                              
                           
                           
                              ̂
                           
                        
                        
                           (
                           T
                           )
                        
                      on the curve we find the corresponding point 
                        
                           Q
                        
                        
                           (
                           T
                           )
                        
                      on the ruling 
                        
                           r
                        
                        
                           (
                           s
                           ,
                           T
                           )
                        
                     , obtained for the same parameter value 
                        T
                     , lying in the plane parallel to 
                        x
                        y
                     -plane and going through the point 
                        
                           
                              
                                 c
                              
                           
                           
                              ̂
                           
                        
                        
                           (
                           T
                           )
                        
                     . Then the differences of such points 
                        
                           Q
                        
                        
                           (
                           T
                           )
                        
                      and the corresponding points 
                        
                           
                              
                                 c
                              
                           
                           
                              ̄
                           
                        
                        
                           (
                           T
                           )
                        
                      give us an objective function 
                        
                           
                              F
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                       
                                          (
                                          i
                                          /
                                          N
                                          )
                                       
                                       −
                                       
                                          Q
                                       
                                       
                                          (
                                          i
                                          /
                                          N
                                          )
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                              i
                              =
                              0
                              ,
                              …
                              ,
                              N
                           
                        
                      which we need to minimize. Therefore, we solve the system of linear equations 
                        
                           
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              0
                              ∧
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              0
                              ∧
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              0
                              ,
                              
                              i
                              =
                              0
                              ,
                              …
                              ,
                              n
                           
                        
                      and the solution is substituted back to (16). This gives us the control points 
                        
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                      of the approximation curve 
                        
                           
                              
                                 c
                              
                           
                           
                              ̄
                           
                        
                        
                           (
                           t
                           )
                        
                     . Consequently, we obtain the approximate ruled surface 
                        
                           
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    ̄
                                 
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                              =
                              
                                 (
                                 1
                                 −
                                 s
                                 )
                              
                              
                                 c
                              
                              
                                 (
                                 t
                                 )
                              
                              +
                              s
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    ̄
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                           
                        
                      which approximately determines the tangent surface along 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      and which gives approximate angle distribution along 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                     . The obtained control points 
                        
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                      are then used as the neighboring row/column of boundary control points 
                        
                           
                              
                                 {
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                      in the control net describing a B-spline/NURBS surface and the same angle distribution along 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      is guaranteed also for the B-spline surface. The whole algorithm is summarized in Algorithm 1.


                     
                        Remark 5
                        In the previous, we chose for simplicity (and because of the motivation by the practical example of a Pelton turbine bucket) a planar input curve 
                              
                                 c
                              
                              
                                 (
                                 t
                                 )
                              
                            and an angle was determined with respect to the unit normal vector 
                              
                                 u
                              
                            of a plane containing the curve 
                              
                                 c
                              
                              
                                 (
                                 t
                                 )
                              
                           , i.e., 
                              
                                 u
                              
                              =
                              
                                 
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       1
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           .

Nevertheless, it is possible to generalize the algorithm also for an arbitrary regular curve 
                              
                                 c
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       (
                                       x
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       y
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       z
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                              
                              t
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                            and vector 
                              
                                 u
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             y
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             z
                                          
                                       
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                            which fulfill that 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            is not co-linear with 
                              
                                 u
                              
                            for all 
                              t
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . Then, 
                              
                                 w
                              
                              
                                 (
                                 t
                                 )
                              
                            is a perpendicular projection of 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            to the plane perpendicular to 
                              
                                 u
                              
                            and 
                              
                                 v
                              
                              
                                 (
                                 t
                                 )
                              
                            is computed analogously. This gives us the exact tangent surface 
                              
                                 r
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           . Further, the control points 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                            of 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    ̂
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            are chosen as translated control points 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                            in direction of 
                              
                                 u
                              
                            and the rest of the algorithm is exactly the same.

In the following we will show that the error of angle distribution approximation is bounded by the approximation error resulting from Algorithm 1.


                     
                        Theorem 1
                        
                           Let 
                           
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    ̂
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ̂
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       ̂
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       ̂
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 )
                              
                            
                           be the B-spline curve defined in Step  2  of Algorithm  1, 
                           
                              
                                 p
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       z
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 )
                              
                            
                           be the curve on the ruled surface 
                           
                              
                                 r
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                            
                           defined in Step  1  of Algorithm  1  such that 
                           
                              
                                 
                                    p
                                 
                                 
                                    z
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    z
                                 
                                 
                                    ̂
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            
                           and 
                           
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    ̄
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ̄
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       ̄
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       ̄
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 )
                              
                            
                           be its B-spline approximation computed using Algorithm  1. Let 
                           
                              f
                              
                                 (
                                 t
                                 )
                              
                            
                           and 
                           
                              
                                 
                                    f
                                 
                                 
                                    ̄
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            
                           be functions describing the exact and approximate angle distributions along 
                           
                              
                                 c
                              
                              
                                 (
                                 t
                                 )
                              
                           
                           , respectively. Then it holds
                           
                              
                                 
                                    sin
                                    
                                       |
                                       f
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             ̄
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       |
                                    
                                    ≤
                                    δ
                                    
                                       
                                          max
                                       
                                       
                                          t
                                          ∈
                                          
                                             [
                                             0
                                             ,
                                             1
                                             ]
                                          
                                       
                                    
                                    
                                       ‖
                                       
                                          p
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ‖
                                    
                                    ,
                                 
                              
                           
                           where 
                           
                              δ
                              =
                              
                                 
                                    max
                                 
                                 
                                    t
                                    ∈
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             ̂
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       z
                                       
                                          (
                                          t
                                          )
                                       
                                       |
                                    
                                 
                              
                           
                           .
                        


                     
                        Proof
                        For arbitrary 
                              t
                           , with the help of the triangle inequality (see Fig. 5
                           (left)) we obtain 
                              
                                 
                                    
                                       ‖
                                       
                                          p
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       
                                          c
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ‖
                                    
                                    ≥
                                    
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             ̂
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       z
                                       
                                          (
                                          t
                                          )
                                       
                                       |
                                    
                                    .
                                 
                              
                            Further, 
                              
                                 |
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       ̄
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 |
                              
                              ≤
                              α
                              
                                 (
                                 t
                                 )
                              
                              ,
                              α
                              
                                 (
                                 t
                                 )
                              
                              ∈
                              
                                 〈
                                 0
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 〉
                              
                            and it holds that 
                              
                                 
                                    sin
                                    α
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          
                                             ‖
                                             
                                                p
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             
                                                c
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ‖
                                          
                                       
                                    
                                    .
                                 
                              
                            Moreover, as 
                              x
                              ≤
                              
                                 ‖
                                 
                                    p
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 −
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       ̄
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ‖
                              
                            (see Fig. 5(right)) we can write 
                              
                                 
                                    sin
                                    α
                                    
                                       (
                                       t
                                       )
                                    
                                    ≤
                                    
                                       
                                          
                                             ‖
                                             
                                                p
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             
                                                
                                                   
                                                      c
                                                   
                                                
                                                
                                                   ̄
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                p
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             
                                                c
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ‖
                                          
                                       
                                    
                                    .
                                 
                              
                            Thus, we obtain 
                              
                                 
                                    sin
                                    
                                       |
                                       f
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             ̄
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       |
                                    
                                    ≤
                                    sin
                                    α
                                    
                                       (
                                       t
                                       )
                                    
                                    ≤
                                    
                                       
                                          
                                             ‖
                                             
                                                p
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             
                                                
                                                   
                                                      c
                                                   
                                                
                                                
                                                   ̄
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                p
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             
                                                c
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ‖
                                          
                                       
                                    
                                    ≤
                                    
                                       
                                          1
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   z
                                                
                                                
                                                   ̂
                                                
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             z
                                             
                                                (
                                                t
                                                )
                                             
                                             |
                                          
                                       
                                    
                                    
                                       ‖
                                       
                                          p
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ‖
                                    
                                    .
                                 
                              
                            Finally, by denoting 
                              δ
                              =
                              
                                 
                                    max
                                 
                                 
                                    t
                                    ∈
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    
                                       |
                                       
                                          
                                             z
                                          
                                          
                                             ̂
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       z
                                       
                                          (
                                          t
                                          )
                                       
                                       |
                                    
                                 
                              
                           , the statement follows.□

Apart from deriving a bound for the error of an approximate angle distribution obtained with the help of Algorithm 1, we also analyze the approximation order of our above mentioned algorithm. We apply Algorithm 1 on a given B-spline curve 
                        
                           c
                        
                        
                           (
                           t
                           )
                        
                      and a given angle function 
                        f
                        
                           (
                           t
                           )
                        
                      and we obtain a surface which approximately satisfies the given angle distribution 
                        f
                        
                           (
                           t
                           )
                        
                     . Further, we analyze the obtained angle distribution on the resulting surface—the approximation error corresponds to the Hausdorff distance between the exact and approximate angle distributions. Then, we insert a new knot into each knot span (with the help of knot insertion algorithm—see Remark 1) and the process repeats for new data. We examine the ratio of two consecutive errors and we find out that the approximation order of the mentioned algorithm is 4, see Example 2.


                     
                        Example 2
                        Let us consider the functions 
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    π
                                 
                                 
                                    6
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    π
                                 
                                 
                                    180
                                 
                              
                            and 
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    4
                                 
                                 
                                    13
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    4
                                 
                              
                              −
                              
                                 
                                    3
                                 
                                 
                                    5
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              −
                              
                                 
                                    1
                                 
                                 
                                    9
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    1
                                 
                                 
                                    12
                                 
                              
                              t
                              +
                              
                                 
                                    5
                                 
                                 
                                    9
                                 
                              
                            and the B-spline curve on the interval 
                              t
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                            with the control points 
                              
                                 {
                                 
                                    
                                       
                                          (
                                          0
                                          ,
                                          0
                                          ,
                                          0
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          (
                                          1
                                          ,
                                          2
                                          ,
                                          0
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          (
                                          2
                                          ,
                                          2
                                          ,
                                          0
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          (
                                          4
                                          ,
                                          0
                                          ,
                                          0
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 }
                              
                            and the knot vector 
                              
                                 (
                                 0
                                 ,
                                 0
                                 ,
                                 0
                                 ,
                                 0
                                 ,
                                 1
                                 ,
                                 1
                                 ,
                                 1
                                 ,
                                 1
                                 )
                              
                           . Table 1
                            summarizes the approximation error and its improvement (ratio of two consecutive errors). The error was obtained by measuring the Hausdorff distance. The improvement ratio tends to 
                              16
                              =
                              
                                 
                                    2
                                 
                                 
                                    4
                                 
                              
                            in both cases which indicates that the approximation order of the above mentioned procedure is 4.


                     
                        Remark 6
                        Let us emphasize that refining a boundary curve 
                              
                                 c
                              
                              
                                 (
                                 t
                                 )
                              
                           , i.e., increasing the number of knot spans in order to decrease the approximation error obtained in Algorithm 1, is not always appropriate because B-spline description (i.e., control net and knot vectors) of the corresponding B-spline surface becomes more complex.

In the following example, we applied Algorithm 1 to the particular case of the model of a Pelton turbine bucket and its outlet curve and we show results for different functions describing the angle distribution along the outlet curve.
                        Example 3
                        In this example, we show the results obtained for the Pelton turbine bucket model and its outlet curve with the help of Algorithm 1 for two functions, in particular, 
                              
                                 1.
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             π
                                          
                                          
                                             6
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             π
                                          
                                          
                                             180
                                          
                                       
                                       ,
                                       
                                       t
                                       ∈
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    , see Fig. 6
                                     (top row), based on the analysis of the existing and used bucket,


                                    
                                       
                                          
                                             f
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             4
                                          
                                          
                                             13
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             4
                                          
                                       
                                       −
                                       
                                          
                                             3
                                          
                                          
                                             5
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             1
                                          
                                          
                                             9
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             1
                                          
                                          
                                             12
                                          
                                       
                                       t
                                       +
                                       
                                          
                                             5
                                          
                                          
                                             9
                                          
                                       
                                       ,
                                       
                                       t
                                       ∈
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    , see Fig. 6 (bottom row), based on the recommendations presented in  [21].

@&#CONCLUSION@&#

In this paper, we studied the imposition of angle boundary conditions on B-spline surfaces. The study of this problem was motivated by a technical practice when we needed to create a parametric geometric model of a Pelton turbine bucket based on B-spline surfaces. We proved that generally it is not possible to prescribe given angle distribution exactly, only for a special choice of the angle function. Further, we proposed an algorithm for finding an approximate solution, together with the upper bound on its error and numerical derivation of its approximation order. In the future research, we will focus on the shape optimization of the bucket with the help of isogeometric analysis.

@&#ACKNOWLEDGMENTS@&#

Both authors were supported by Technology agency of the Czech Republic through the project TA03011157. The authors thank the referees for their valuable comments which have contributed to improve the manuscript.

@&#REFERENCES@&#

