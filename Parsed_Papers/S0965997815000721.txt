@&#MAIN-TITLE@&#A novel CACD/CAD/CAE integrated design framework for fiber-reinforced plastic parts

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Presents a CACD/CAD/CAE integrated design framework for fiber-reinforced plastic parts.


                        
                        
                           
                           Develops the heterogeneous feature model for fiber-reinforced object modeling.


                        
                        
                           
                           Develops the level-set structure and material optimization for conceptual design.


                        
                        
                           
                           Applies the response surface method to optimize the injection molding process conditions.


                        
                        
                           
                           Improves the design optimality and shortens the design process.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

CACD/CAD/CAE integration

Heterogeneous feature model

Level-set

Structure and material optimization

Response surface method

Fiber-reinforcement

@&#ABSTRACT@&#


               
               
                  This work presents a novel CACD/CAD/CAE integrated framework for design, modeling, and optimization of fiber-reinforced plastic parts, which can greatly enhance the current design practice by realizing partial automation and multi-stage optimization. To support this framework, a new heterogeneous feature model (HFM) has been developed to model the fiber-reinforced objects and to be transferred between engineering modules. To be specific, the CACD (computer-aided conceptual design) module employs the level-set structure and material optimization to produce the initial design with thickness control, and also the initial HFM; the CAD (computer-aided design) module allows manual editing on the HFM to reflect various design intents; then, the injection molding CAE (computer-aided engineering) simulates the manufacturing process, and the response surface method (RSM) is applied to optimize the process parameters of gate location, injection flow rate, mold temperature and melt temperature, to approach the manufactured fiber orientation distribution close to the optimized result produced by the CACD module; besides, the structural analysis CAE module generates the mechanical performance result to support the CACD module, as well as to validate the final design. By applying this framework, the final structural design including the fiber orientation distribution, will perform better in mechanical properties, and consume less matrix and fiber materials; besides, the design maturity can be approached in shorter time. To prove the effectiveness, a plastic gripper design will be comprehensively studied.
               
            

the energy bilinear form

elastic tensor

elastic tensor of the matrix material

elastic tensor of the fiber

elastic tensor of the fiber after coordinate transformation

normalization parameter of the global strength measure

signed distance function

design domain

thickness-control functional

forward and backward finite difference operators

element index

strain

Young’s modulus of the matrix material

Young’s modulus of the fiber along the longitudinal direction

local grid node index within the element

shape sensitivity density of the thickness-control functional

length of the square feature

Heaviside function

grid node index

optimization iteration index

Two-dimension grid node index

objective function of the level set structural and material optimization

the load linear form

Lagrange formulation of the optimization problem

number of elements

boundary unit vector pointing from the material domain outwards

shape interpolation function of local grid node g
                     

weighted average orientation difference

norm parameter

body force

boundary projection of 
                           Z
                        
                     

global measure of the elastic energy density

the elementary elastic energy density

the maximum allowed value of local elastic energy density

maximum elementary elastic energy density

radius of the circle feature

n-dimension space

time

targeted thickness

transformation matrix

displacement vector

the space of kinematically admissible displacement field

test vector

velocity for normal boundary propagation

adjoint variable

gate location

injection flow rate

mold temperature

melt temperature

sample vector

sample vector

center point of shape features

sample vector located on the structural boundary

sample vector located on 
                           
                              
                                 
                                    ray
                                 
                                 
                                    ∂
                                    Ω
                                 
                              
                              
                                 
                                    
                                       Y
                                    
                                 
                              
                           
                        
                     

volume ratio of the fiber

shape sensitivity density

parameters of the quadratic function

adjustment parameter of the weighting factor 
                           
                              μ
                           
                        
                     

Dirac Delta function

Dirac Delta function for auxiliary fiber orientation control

adjustment parameter of the penalization factor 
                           
                              Λ
                           
                        
                     

fiber orientation

local tangential direction of the level set contour

initial fiber orientation before controlled by the auxiliary feature

elementary fiber orientation of the simulation result

elementary fiber orientation of the optimized result

local boundary curvature

the Lagrange multiplier

weighting factor of the thickness-control functional

Poisson ratio of the matrix material

traction force

control band width of the auxiliary feature

penalization factor of the Lagrange multiplier 
                           
                              λ
                           
                        
                     

the set of projections of 
                           X
                         on 
                           
                              ∂
                              Ω
                           
                        
                     

level set function

primitive level set functions

material domain

boundary of the material domain

@&#INTRODUCTION@&#

Fiber-reinforced plastics are popular these days, and widely applied in designing light-weighted parts with superior mechanical properties, such as “components of automobiles, housings of electrical devices and internal structural components of precision instruments” [56].

However, design of fiber-reinforced plastic parts is still in immature state. The industrial practice mainly explores the experience-based approach, which is partially supported by commercial software tools. For instance, the ratio of fiber added is manually determined based on the functional requirement, and used as the input for injection molding simulation; software tools like Moldflow® and Moldex3D® can estimate the fiber orientation and output the result to structural analysis tools such as NX Nastran® or Ansys Workbench®; based on the structural analysis result, it is manually determined again whether to change the ratio or to improve the injection molding process parameters; the procedures above will be repeated until satisfaction. The current design practice is quite ineffective and nearly impossible to find the structural optima, as well as the optimal fiber orientation distribution. From the authors’ opinion, the reason leading to the current status is the lack of Computer-Aided Conceptual Design (CACD), as well as the immaturity of the CACD/CAD/CAE integrated design framework.

The introduction of fiber-reinforcement makes the CACD stage complicated and time-consuming, because fiber orientation distribution needs to be accurately decided to satisfy the mechanical requirement under the minimum fiber consumption, which is almost impossible to be done manually. In addition, structural thickness control is important for all plastic parts due to the molding process requirement to avoid cooling defects, such as warping. Therefore, design automation is in extreme need, covering both the structure and fiber orientations. An appropriate method satisfying this scheme is free material optimization (FMO), which conventionally exists as a branch of topology optimization. For FMO, the optimization variables are the local material density, as well as the discrete elastic stiffness tensor; therefore, the structure design, as well as the locally attainable materials can be decided simultaneously [21]. Currently, the works on FMO are majorly developed under the density-based scheme [3,33,7], for which blurred boundary areas and intermediate densities exist in the result and make it difficult to be directly-usable. In this work, FMO has been adapted with the level-set concept, because of its ability of clear cut boundary representation, as well as the pure “black and white” design [48,1]. Correspondingly, the level-set structure and material optimization method has been developed, and will be employed as the major component of the CACD module.

The CACD/CAD/CAE integration emerges as another problem to be solved, for which two major limitations exist hindering the integrated design environment from functioning well.

First, there is lack of a data model for fiber-reinforced objects to fully support this integration. Conventionally, there exist abundant computer representations of heterogeneous objects (HOs) [25], which majorly cover objects composed of multiple materials or the functionally graded material (FGM), manufactured by additive manufacturing. However, no HO model is specifically designed for fiber-reinforced objects manufactured by injection molding. If applying the existing HO models to represent the fiber-reinforced objects, there would appear several issues, which will be introduced in details in Section 3. Therefore, a new heterogeneous feature model (HFM) has been proposed specifically for the fiber-reinforced object modeling, but the compatibility to other HOs is also considered.

Another limitation lies in the immaturity of the CACD/CAD/CAE integrated framework. As mentioned earlier, the current design practice employs all the individual engineering modules; however, too many subjective artificial decisions are needed to make them work as a system. Correspondingly, both design efficiency and design quality cannot be guaranteed. The system framework needs to be re-produced with more automated design elements, as well as more objective optimization procedures. Therefore, we will employ multi-stage optimization procedures, to reduce the dependency on artificial decisions and to realize automation in certain design stages. To be specific, the level-set structure and material optimization is employed by the CACD stage, and the RSM is used in the injection molding CAE stage.

The following contents will be organized as follows; Section 2 describes the working rationale of the CACD/CAD/CAE integrated design framework; Section 3 reviews the existing HO models, and introduces the new HFM; the details about level-set structure and shape optimization, and RSM for injection molding process parameter optimization will be presented in Section 4 and Section 5, respectively; Section 6 demonstrates the design process of the plastic gripper under the new CACD/CAD/CAE integrated design framework, and Section 7 concludes the paper.

Conventionally, research efforts mainly focus on development of CAD/CAE integrated design frameworks [17,47]; but for fiber-reinforced plastic parts, the CACD, CAD, structural analysis CAE, injection molding CAE are all indispensable engineering modules for the product development process. Therefore, a well-defined system framework for integrating these modules is extremely important but is still lacking. Hence, we define the system framework as shown in Fig. 1
                     .

Individual modules and the systematic workflow will be introduced in details in the following paragraphs.

The CACD module employs the level-set structure and material optimization method, and thus produces the optimized conceptual design model, including both the structural feature model, as well as the fiber orientation distribution. Therefore, this is the initial step producing the complete information to form the HFM.

Then, the CAD module reads in the HFM. Normally, there could be more design details to be fulfilled which cannot be addressed in the CACD stage. Therefore, both the structure feature model and the material feature model will be manually editable.

The injection molding CAE module gets the structural feature model, as well as part of the material feature model. Thereafter, the injection molding process will be simulated, through which the most-likely fiber orientation distribution can be predicted; definitely, the predicted distribution will be different from the optimized result. However, injection molding process parameters can be edited to globally re-distribute the fibers. Therefore, another optimization process by employing the RSM will be used to find the best-suited process parameters, to approach the predicted fiber orientation distribution to the optimized result.

The structural analysis CAE module supports the CACD module, and functions to validate the final structural strength and stiffness. Normally, the fiber orientation distribution predicted by the injection molding process is in some degree distinct from the expected result, even after the RSM-based optimization. Therefore, a validation procedure is necessary before end of the design process.

It can be summarized that, all modules in this system share a common HFM, and they together form a complete and effective design process, not only satisfying the design requirements, but also deriving the result close to optima. Design automation has been realized in certain stages of this process, and the dependency on manual decisions has been evidently reduced, both of which contribute to shorten the design cycle. Till now, the conventionally tough job of designing and controlling the fiber orientation distribution has been realized.

Heterogeneous object (HO) modeling is becoming increasingly popular because of the extensive use of composite materials. As reviewed by [25], extensive research works have been done in the past two decades, and several HO models have been developed.

Voxel-based models [20,53,52] discretize the geometry into voxels or the finite element mesh, and then impose constant or continuously-variational material properties on each element. Therefore, the voxel-based models are suitable to be directly used in finite element analysis, and are potential to capture the highly-irregular material composition distribution.

Cellular model is an alternative of the geometry discretization which belongs to a bigger scale. Kumar et al. [26] applied the r-set to model the geometry, and divided it into sub-regions, each of which was mapped with certain material class. Later, Shin and Dutta [39] and Shin et al. [40] presented a constructive representation of HOs by manipulating the heterogeneous primitives with heterogeneous Boolean operations. For cellular model, the material composition function is necessary for each cellular.

Control feature-based model, developed by Siu and Tan [41], employed the source profile feature as reference, and distributed the FGMs according to the source-based material composition function. Later, the heterogeneous feature tree including multi-level source profile features, as well as the non-regular Boolean operations were applied for complex HO modeling [22,23]. B-spline-based model can be regarded as an extension of the control feature-based model. Qian and Dutta [34] proposed a feature based approach for HO modeling, in which the form and material features were separately defined; the diffusion-based B-spline method was applied to determine the material composition distribution. Yang and Qian [55] applied the B-spline finite element method to unify the design and analysis model; the heterogeneous lofting algorithms were used to determine the material composition distribution between B-spline material profiles. Recently, Samanta et al. [36] developed an optimization method for material composition blending between complex material directrices.

Other HO models like the distance field-based model [4,59] and the radial basis function-based model [57] are also robust in HO representation given certain scenarios.

In summary, two remaining issues were mentioned by [25]. First, the objects of highly-irregular material composition distribution are still not well modeled, as the majority of HO models are designed specifically for the multi-material or FGM objects. For instance, the source-based and function-based approaches are only appropriate to determine the material composition distribution of multi-material or FGM objects. Voxel-based model is an exception; however, how to generate the highly-irregular material composition distribution is not addressed. The second issue remains at the poor support of CAD/CAE/CAM integration by the current HO models. There is little work addressing the CAD/CAE integration [24], and the efforts on CAD/CAM integration mainly focus on additive manufacturing. In this work, the concentration will be the modeling of fiber-reinforced plastic parts, which definitely belongs to the objects of highly-irregular material composition distribution, and is manufactured with the traditional injection molding instead of additive manufacturing. Therefore, a new HO model is needed.

Level-set model [50,51] is relatively a novel HO representation. To be specific, each level-set function is a close contour which represents the material interface; because of overlapping, n level-set functions can represent 
                        
                           
                              
                                 2
                              
                              
                                 n
                              
                           
                        
                      material phases, which make it extremely suitable for multi-material structures. Recently, the level-set approach was also applied in representation and optimization of structures filled with FGMs [54]; in their work, fixed mesh model is used to discretize the level-set material area, and store the abundant local material composition information. Although the work of [54] targets at structures with FGMs, it has demonstrated the potential of level-set model in representing the highly-irregular material composition distribution; prominently, it also offers an optimization approach to generating the highly-irregular material composition distribution without relying on sources or functions.

Therefore, we would propose the heterogeneous feature model (HFM) as shown in Fig. 2
                      for HO representation, by re-developing the level-set model in combination with the popular feature technology. Given details about the HFM, a significant characteristic is that it includes two independent sub-feature models, the structure feature and material feature models. The structure feature model describes geometric primitives by level-set functions and forms complex structure via Boolean operations; the material feature model stores local material composition information in a fixed mesh model. These two sub-feature models are designed to be independent, as it is not necessary for them to share the same space, and one-sided design changes do not propagate to the other. This independency guarantees the modeling efficiency and the model consistency in case of design changes. To unify these two sub-feature models, the HFM stays at a higher level unifying useful structure and material information needed by certain engineering module. Effective mechanism has been developed to map the local material composition information from the material feature model onto the structure feature model. For instance as shown in Fig. 2, the structure feature model is constructed by union of two rectangular geometric primitives, and the material feature model is a fixed quadrilateral mesh model filled with local material composition information covering a larger space; the HSM used by finite element analysis extracts the structure feature model and only part of the material feature model lying inside the overlapped region.

Re-considering the two remaining issues summarized by [25], they can be well solved by applying the HFM. First, the HFM is appropriate to represent the highly-irregular material composition distribution, and relevant generation of the local information can be fulfilled by using the level-set structure and material optimization. On the other hand, the CAD/CAE integration is no longer a problem as mentioned earlier; the CAD/CAM integration, which actually is the CAD/injection molding CAE integration, is also realized and will be introduced in Section 5.

Structure feature model is generally defined as the part’s geometric information coupled with some specific engineering significance, and extensive research works have been done about its representation and modeling [29]. Commonly, the two approaches of CSG (constructive solid geometry) and B-rep (boundary representation) are widely used in commercial systems. In this work, CSG is adopted as the structure feature modeling method, majorly for two reasons: the implicit function of feature representation employed by CSG describes the volume by point sets, and supports to differentiate the inner and outer points mathematically, which makes it convenient to map the local material composition information from the material feature model onto the structure feature model. On the other hand, CSG is more appropriate to support the structural optimization process [10,11].

To be specific, the level-set function [31,37,32] has been applied to implicitly represent the geometric primitives, which is defined as 
                           
                              Φ
                              
                                 
                                    
                                       X
                                    
                                 
                              
                              :
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              
                              ↦
                              
                              R
                           
                        , 
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Φ
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                      
                                                   
                                                   >
                                                   0
                                                   ,
                                                
                                                
                                                   X
                                                   ∈
                                                   Ω
                                                   /
                                                   ∂
                                                   Ω
                                                
                                             
                                             
                                                
                                                   Φ
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                                
                                                   X
                                                   ∈
                                                   ∂
                                                   Ω
                                                
                                             
                                             
                                                
                                                   Φ
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                      
                                                   
                                                   <
                                                   0
                                                   ,
                                                
                                                
                                                   X
                                                   ∈
                                                   D
                                                   /
                                                   Ω
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        For instance, circle can be represented as,
                           
                              (2)
                              
                                 Φ
                                 
                                    
                                       
                                          X
                                       
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       c
                                    
                                 
                                 -
                                 sqrt
                                 (
                                 
                                    
                                       (
                                       x
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       (
                                       y
                                       -
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        and the square as,
                           
                              (3)
                              
                                 Φ
                                 
                                    
                                       
                                          X
                                       
                                    
                                 
                                 =
                                 min
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   xcos
                                                   θ
                                                   +
                                                   ysin
                                                   θ
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   xcos
                                                   θ
                                                   +
                                                   ysin
                                                   θ
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   -
                                                   xcos
                                                   θ
                                                   +
                                                   ysin
                                                   θ
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   -
                                                   xcos
                                                   θ
                                                   +
                                                   ysin
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Then, complex geometry can be formed by Boolean operations on the individual level-set functions as,
                           
                              (4)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Φ
                                                
                                                
                                                   1
                                                
                                             
                                             ∪
                                             
                                                
                                                   Φ
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                max
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Φ
                                                
                                                
                                                   1
                                                
                                             
                                             ∩
                                             
                                                
                                                   Φ
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                min
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Φ
                                                
                                                
                                                   1
                                                
                                             
                                             ⧹
                                             
                                                
                                                   Φ
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                min
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      -
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The core characteristic of the material feature model is that it can independently represent the complex local material composition information, and accurately map it onto the structure feature model.

To be specific, the fixed mesh model widely applied in topology optimization [48,1] is used to store the local matrix and fiber information. The advantage about this scheme is that, the structure and material optimization in the CACD stage can naturally produce the fixed mesh model and fill the grids with matrix and fiber information.

So far, the structure feature and material feature models have been defined separately, but an effective mapping mechanism is still needed to build the in-between connection. It requires that the level-set contour of structure feature model representation should be able to capture the mesh elements inside the structure, and tell the solid proportions of the mesh elements crossed by the contour. To fulfill this task, the Heaviside function plays a significant role, which is defined in Eq. (5).
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                      
                                                   
                                                   =
                                                   1
                                                   ,
                                                
                                                
                                                   Φ
                                                   ⩾
                                                   0
                                                
                                             
                                             
                                                
                                                   H
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                                
                                                   Φ
                                                   <
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Based on this definition, the grid nodes inside the structure employ the level-set value bigger than zero, therefore, the Heaviside function will be equal to 1; in contrast, the grid nodes outside the structure employ the level-set value smaller than zero, therefore, the Heaviside function will be equal to 0.

Through standard interpolation, the boundary elements can be represented as,
                           
                              (6)
                              
                                 H
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 =
                                 H
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   g
                                                   =
                                                   1
                                                
                                                
                                                   4
                                                
                                             
                                          
                                          Φ
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                g
                                             
                                          
                                          )
                                          
                                             
                                                N
                                             
                                             
                                                g
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                g
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        in which g represents the local grid node index within the element and 
                           
                              
                                 
                                    N
                                 
                                 
                                    g
                                 
                              
                              (
                              
                                 
                                    X
                                 
                                 
                                    g
                                 
                              
                              )
                           
                         is the shape interpolation function of local grid node g. Therefore, taking the elastic tensor for example, the elementary representation will be equal to 
                           
                              A
                              H
                              
                                 
                                    
                                       Φ
                                    
                                 
                              
                           
                        , in which 
                           A
                         is the material elastic tensor.

Currently, the explicit Heaviside function as presented in Eq. (5) still lacks continuity and accuracy in reflecting the boundary element properties. Therefore, the approximated Heaviside functions [49,51] in different forms are also recommended to continuously and proportionally reflect the boundary element properties (Fig. 3
                        ).

The auxiliary material feature is an additional level-set contour defined by the designer, to adjust the fiber orientations along the contour. There are several reasons for the necessity of this auxiliary material feature,
                           
                              •
                              The level-set material optimization employs the gradient-based method, which may trap the result at local minimum. Therefore, there is chance of needing manual editing on the fiber orientations.

There may exist other design requirements which cannot be addressed in the CACD stage, for which the manual editing is indispensable.

Therefore, the auxiliary material feature makes it possible to edit the fiber orientation distribution locally, and enhances the embedment of design intents.

As presented in Eqs. (7) and (8), the Dirac Delta function is used to quantify the influence of the auxiliary material feature on the local fiber orientation distribution, in which 
                           
                              Δ
                           
                         means the band width as shown in Fig. 4
                        (a), 
                           
                              
                                 
                                    θ
                                 
                                 
                                    ′
                                 
                              
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                                 
                                    ″
                                 
                              
                           
                         mean the local tangential direction of the level-set contour and the local fiber orientation before control, respectively.
                           
                              (7)
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               Δ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                      
                                                   
                                                   ⩽
                                                   Δ
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                      
                                                   
                                                   >
                                                   Δ
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 θ
                                 =
                                 (
                                 1
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 )
                                 
                                    
                                       θ
                                    
                                    
                                       ″
                                    
                                 
                                 +
                                 
                                    
                                       δ
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        For instance, Fig. 4(b) shows a random orientation field of size 80∗80 elements; Fig. 4(c-d) show the orientation field after adding a horizontal line feature in the middle with the band width of 10 and 20, respectively; Fig. 4(e-f) show the orientation field after adding a circle feature with the band width of 10 and 20, respectively. It can be concluded that, the local fiber orientation distribution can be effectively controlled by adding auxiliary material features.

The CACD process will be performed by applying the level-set structure and material optimization. Therefore, a general introduction about level-set topology optimization is presented first in sub-Section 4.1. Then, the strength-constrained optimization problem is introduced in details in sub-Section 4.2. Through sub-Section 4.3, 4.4, 4.5, the sensitivity analysis, design update, and some numerical implementation details are presented, respectively.

Osher and Sethian [31] proposed the level-set function which is a natural way of closed boundary representation. The mathematical definition has been presented in Eq. (1). Graphically as shown in Fig. 5
                        , the zero-valued level-set contour represents the material/void interface (the structure boundary) and all points employing the level-set value bigger than 0 belong to the material domain.

By taking derivative of the zero-valued level-set function (
                           
                              Φ
                              
                                 
                                    
                                       X
                                    
                                 
                              
                              =
                              0
                              )
                           
                        , the Hamilton-Jacobi equation is generated as shown in Eq. (9).
                           
                              (9)
                              
                                 
                                    
                                       ∂
                                       Φ
                                       (
                                       X
                                       )
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 -
                                 ∇
                                 Φ
                                 (
                                 X
                                 )
                                 ·
                                 V
                                 =
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 ∇
                                 Φ
                                 (
                                 X
                                 )
                                 |
                              
                           
                        in which 
                           
                              
                                 
                                    V
                                 
                                 
                                    n
                                 
                              
                              =
                              V
                              ·
                              n
                           
                         is the boundary propagating speed in the normal direction 
                           
                              n
                              =
                              -
                              
                                 
                                    ∇
                                    Φ
                                    (
                                    X
                                    )
                                 
                                 
                                    |
                                    ∇
                                    Φ
                                    (
                                    X
                                    )
                                    |
                                 
                              
                           
                         pointing from the material domain outwards (Fig. 5).


                        
                           
                              
                                 
                                    V
                                 
                                 
                                    n
                                 
                              
                           
                         could be obtained by performing the sensitivity analysis. Then, through solving the Hamilton-Jacobi equation, the level-set function could be updated which actually evolves the structure boundary. Iteratively, the boundary can propagate, merge and split according to the sensitivity analysis result until the optimization problem converges.

For more details, interested readers can refer to [38,48,1].

For fiber-reinforced plastic, the mechanical properties are complex to be determined, as they are influenced by several factors, which are majorly the fiber type [44,45], the fiber/matrix interaction [58], and the fiber length and orientation distribution [14,12,13]. Taking fiber type as example, glass fiber (GF) is traditionally applied to enhance the strength and stiffness, as well as the impact resistance; carbon fiber is popular in these day as it can offer much better enhancement in these mechanical properties; there are also other fiber types with smaller density which therefore can make even lighter-weighted structures; natural fiber is also frequently used as they are cost-effective and environmental-friendly [13]. However, in this paper, the emphasis will be optimizing the fiber orientation distribution, instead of the exploration on the micromechanical properties of fiber-reinforced plastic. Therefore, a few simplifications are made about the mechanical model: first, the fiber properties are specified but not the exact fiber type; then, the fiber–matrix de-bonding is neglected for the sake of simplicity [16], although this issue is solvable [5,6,15].

Based on the homogenization theory, macro mechanical properties of the fiber-reinforced plastic could be determined [5–7,16], and the elastic tensor is,
                           
                              (10)
                              
                                 A
                                 =
                                 (
                                 1
                                 -
                                 α
                                 )
                                 
                                    
                                       A
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 α
                                 
                                    
                                       A
                                    
                                    
                                       f
                                       0
                                    
                                 
                              
                           
                        where 
                           
                              α
                           
                         represents the volume ratio of the fiber; 
                           
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                           
                         is the elastic tensor of the isotropic matrix material and 
                           
                              
                                 
                                    A
                                 
                                 
                                    f
                                    0
                                 
                              
                           
                         is the elastic tensor of the fiber in case that the fiber direction coincides with the x-axis (as shown in Fig. 6
                        a).

Specifically, 
                           
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              
                                 
                                    A
                                 
                                 
                                    f
                                    0
                                 
                              
                           
                         are expressed by Eqs. (11) and (12), in which 
                           
                              
                                 
                                    E
                                 
                                 
                                    iso
                                 
                              
                           
                         and 
                           
                              ν
                           
                         are the Young’s modulus and Poisson ratio of the matrix material and 
                           
                              
                                 
                                    E
                                 
                                 
                                    ani
                                 
                              
                           
                         is the Young’s modulus of the fiber along the longitudinal direction.
                           
                              (11)
                              
                                 
                                    
                                       A
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             iso
                                          
                                       
                                    
                                    
                                       1
                                       -
                                       
                                          
                                             ν
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   ν
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   ν
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         (
                                                         1
                                                         +
                                                         ν
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       A
                                    
                                    
                                       f
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         ani
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Concerning the flexibility of the fiber orientation as shown in Fig. 6b, the transformation matrix 
                           
                              T
                              (
                              θ
                              )
                           
                         is needed to conduct the coordinate transformation [7].
                           
                              (13)
                              
                                 T
                                 (
                                 θ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         cos
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   θ
                                                
                                                
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   θ
                                                
                                                
                                                   -
                                                   2
                                                   cos
                                                   θ
                                                   sin
                                                   θ
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   θ
                                                
                                                
                                                   
                                                      
                                                         cos
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   θ
                                                
                                                
                                                   2
                                                   cos
                                                   θ
                                                   sin
                                                   θ
                                                
                                             
                                             
                                                
                                                   cos
                                                   θ
                                                   sin
                                                   θ
                                                
                                                
                                                   -
                                                   cos
                                                   θ
                                                   sin
                                                   θ
                                                
                                                
                                                   
                                                      
                                                         cos
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   θ
                                                   -
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Therefore, the elastic tensor of fiber in arbitrary orientation is transformed into,
                           
                              (14)
                              
                                 
                                    
                                       A
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 T
                                 (
                                 θ
                                 )
                                 
                                    
                                       A
                                    
                                    
                                       f
                                       0
                                    
                                 
                                 T
                                 
                                    
                                       (
                                       θ
                                       )
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        Consequently, the elastic tensor of the fiber-reinforced material is finalized as shown in Eq. (15), in which 
                           
                              α
                           
                         is the volume ratio of the fiber contents.
                           
                              (15)
                              
                                 A
                                 =
                                 (
                                 1
                                 -
                                 α
                                 )
                                 
                                    
                                       A
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 α
                                 
                                    
                                       A
                                    
                                    
                                       f
                                    
                                 
                              
                           
                        Another important point to be discussed is about the concept of strength, which is definitely complicated for anisotropic materials, instead of the direct von Mises measure for isotropic materials. Details about the failure criteria of anisotropic composite material are explored in [18,42]. For the sake of simplicity, the elastic energy density (EED) is applied to measure the local strength following the work [33].
                           
                              (16)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 Ae
                                 
                                    
                                       
                                          u
                                       
                                    
                                 
                                 e
                                 
                                    
                                       
                                          u
                                       
                                    
                                 
                              
                           
                        Therefore, the topology optimization problem of mass minimization under strength constraints is formulated as,
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             Min
                                             .
                                          
                                       
                                       
                                          
                                             
                                             J
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                
                                             
                                             =
                                             
                                                ∫
                                                
                                                   D
                                                
                                             
                                             H
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                
                                             
                                             d
                                             Ω
                                             +
                                             μ
                                             
                                                
                                                   D
                                                
                                                
                                                   T
                                                
                                             
                                             (
                                             Φ
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                       
                                       
                                          
                                             
                                             a
                                             
                                                
                                                   
                                                      u
                                                      ,
                                                      v
                                                      ,
                                                      Φ
                                                   
                                                
                                             
                                             =
                                             l
                                             
                                                
                                                   
                                                      v
                                                      ,
                                                      Φ
                                                   
                                                
                                             
                                             ,
                                             
                                             ∀
                                             v
                                             ∈
                                             U
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   e
                                                
                                             
                                             ⩽
                                             
                                                
                                                   Q
                                                
                                                
                                                   lim
                                                
                                             
                                             
                                             e
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   T
                                                
                                             
                                             =
                                             
                                                ∫
                                                
                                                   D
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Φ
                                                                              
                                                                                 
                                                                                    
                                                                                       X
                                                                                    
                                                                                 
                                                                              
                                                                              -
                                                                              
                                                                                 
                                                                                    T
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        +
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Φ
                                                                              
                                                                                 
                                                                                    
                                                                                       X
                                                                                    
                                                                                 
                                                                              
                                                                              -
                                                                              
                                                                                 
                                                                                    T
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        -
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             H
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                
                                             
                                             d
                                             Ω
                                          
                                       
                                    
                                 
                              
                           
                        The notations: 
                           
                              
                                 
                                    (
                                    f
                                    )
                                 
                                 
                                    +
                                 
                              
                              =
                              max
                              
                                 
                                    
                                       f
                                       ,
                                       0
                                    
                                 
                              
                              ;
                              
                                 
                                    (
                                    f
                                    )
                                 
                                 
                                    -
                                 
                              
                              =
                              min
                              (
                              f
                              ,
                              0
                              )
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             a
                                             
                                                
                                                   
                                                      u
                                                      ,
                                                      v
                                                      ,
                                                      Φ
                                                   
                                                
                                             
                                             =
                                             
                                                ∫
                                                
                                                   D
                                                
                                             
                                             Ae
                                             (
                                             u
                                             )
                                             e
                                             (
                                             v
                                             )
                                             H
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                
                                             
                                             d
                                             Ω
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             l
                                             
                                                
                                                   
                                                      v
                                                      ,
                                                      Φ
                                                   
                                                
                                             
                                             =
                                             
                                                ∫
                                                
                                                   D
                                                
                                             
                                             pv
                                             H
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                
                                             
                                             d
                                             Ω
                                             +
                                             
                                                ∫
                                                
                                                   D
                                                
                                             
                                             τ
                                             v
                                             δ
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∇
                                                      Φ
                                                   
                                                
                                             
                                             d
                                             Ω
                                          
                                       
                                    
                                 
                              
                           
                        In Eq. (17), the objective function is composed of two terms. The first term measures the material volume inside the design domain, which is to be minimized to save material. The second term 
                           
                              
                                 
                                    D
                                 
                                 
                                    T
                                 
                              
                              (
                              Φ
                              )
                           
                         is the thickness-control functional which targets at controlling all rib thickness around T. The reason of employing the second term is that constant rib thickness is a necessary requirement by injection molding for purpose of uniform cooling. 
                           
                              μ
                           
                         is the weighting factor of the thickness control.

The first constraint is the weak form of the displacement field governing equation, in which 
                           
                              a
                              
                                 
                                    
                                       u
                                       ,
                                       v
                                       ,
                                       Φ
                                    
                                 
                              
                           
                         is the energy bilinear form and 
                           
                              l
                              
                                 
                                    
                                       v
                                       ,
                                       Φ
                                    
                                 
                              
                           
                         is the load linear form. 
                           u
                         is the displacement vector and 
                           v
                         is the test vector. U is the space of kinematically admissible displacement field. 
                           A
                         is the elastic tensor of the fiber-reinforced material and 
                           
                              e
                              
                                 
                                    
                                       u
                                    
                                 
                              
                           
                         is the strain. 
                           p
                         is the body force and 
                           
                              τ
                           
                         is the boundary traction force.

The second constraint is the local strength constraint in which 
                           
                              
                                 
                                    Q
                                 
                                 
                                    e
                                 
                              
                           
                         is the elementary EED measure, m is the total number of elements, and 
                           
                              
                                 
                                    Q
                                 
                                 
                                    lim
                                 
                              
                           
                         is the maximum allowed local EED value. It’s feasible to solve the local strength constraints even in high quantity; however, the relevant computational expense will be high. Therefore, in this work, the normalized p-norm functions [27,46] are adopted to transform the numerous local strength measures into one global strength measure, in this way to save computational effort without sacrificing the strength control accuracy.
                           
                              (18)
                              
                                 
                                    
                                       
                                       
                                          
                                             cQ
                                             =
                                             c
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  e
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               e
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             ⩽
                                             
                                                
                                                   Q
                                                
                                                
                                                   lim
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   I
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         max
                                                      
                                                      
                                                         I
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         I
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In Eq. (18), p is the norm parameter to construct the global measure and c is the normalization parameter to improve the accuracy of the global measure. 
                           
                              
                                 
                                    Q
                                 
                                 
                                    max
                                 
                              
                           
                         represents the maximum local EED in the relevant iteration. The superscripts represent the iteration index.

In this work, the norm parameter 
                           
                              p
                              =
                              8
                           
                         is used. As summarized by [27], small p values cannot effectively capture the peak local EED; high p values require long iterations to converge and may cause some numerical problems. Therefore, p values of 6 to 8 are recommended. On the other hand, the normalized regional p-norm functions are recommended by the authors, because of better EED control accuracy. To be specific, the design domain is divided into regions based on the interlacing rule [27,46], which forms each region by clustering discrete EEDs spanning the whole EED range. Therefore, one global measure is divided into a few regional measures, which could more accurately evaluate the maximum local EED within each region. Additionally, the EED level based division method [19] is under exploration, which simply cluster the local EEDs into regions based on the EED levels. It has demonstrated the potential of more flexibly controlling the EED distribution, because the clustering intervals are customizable and different control strategies could be applied to regions.

In order to solve the optimization problem, the level set function 
                           
                              Φ
                           
                         determining the structural boundary is used as the design variable. The sensitivity analysis is needed to derive the boundary velocity 
                           
                              
                                 
                                    V
                                 
                                 
                                    n
                                 
                              
                           
                         to evolve the structure boundary in the steepest descent direction. In this section, the Lagrange multiplier and the adjoint method are employed to perform the shape sensitivity analysis.

The Lagrange formulation of the optimization problem is defined in Eq. (19).
                           
                              (19)
                              
                                 L
                                 =
                                 J
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 +
                                 a
                                 
                                    
                                       
                                          u
                                          ,
                                          w
                                          ,
                                          Φ
                                       
                                    
                                 
                                 -
                                 l
                                 
                                    
                                       
                                          w
                                          ,
                                          Φ
                                       
                                    
                                 
                                 +
                                 λ
                                 
                                    
                                       
                                          c
                                          
                                             
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            D
                                                         
                                                      
                                                      
                                                         
                                                            Q
                                                         
                                                         
                                                            e
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      H
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                         
                                                      
                                                      d
                                                      Ω
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                Q
                                             
                                             
                                                lim
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Then, time derivative of the Lagrange formulation is given as,
                           
                              (20)
                              
                                 
                                    
                                       L
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       J
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          u
                                          ,
                                          w
                                          ,
                                          Φ
                                       
                                    
                                 
                                 -
                                 
                                    
                                       l
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          w
                                          ,
                                          Φ
                                       
                                    
                                 
                                 +
                                 λ
                                 
                                    
                                       
                                          
                                             c
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∫
                                                            
                                                               D
                                                            
                                                         
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               e
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         H
                                                         
                                                            
                                                               
                                                                  Φ
                                                               
                                                            
                                                         
                                                         d
                                                         Ω
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        in which,
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       D
                                    
                                 
                                 
                                    
                                       
                                          1
                                          +
                                          μ
                                          G
                                       
                                    
                                 
                                 δ
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       ′
                                    
                                 
                                 d
                                 Ω
                              
                           
                        
                        
                           
                              (21)
                              
                                 G
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             ray
                                          
                                          
                                             ∂
                                             Ω
                                          
                                       
                                       
                                          
                                             
                                                Y
                                             
                                          
                                       
                                       ∩
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          2
                                          
                                             
                                                
                                                   
                                                      Φ
                                                      
                                                         
                                                            
                                                               Z
                                                            
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                +
                                             
                                          
                                          -
                                          2
                                          
                                             
                                                
                                                   
                                                      Φ
                                                      
                                                         
                                                            
                                                               Z
                                                            
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                d
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                
                                                   Z
                                                
                                             
                                          
                                          κ
                                          
                                             
                                                
                                                   Y
                                                
                                             
                                          
                                       
                                    
                                 
                                 d
                                 Z
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       a
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          u
                                          ,
                                          w
                                          ,
                                          Φ
                                       
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       D
                                    
                                 
                                 
                                    
                                       
                                          Ae
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   w
                                                
                                             
                                          
                                          +
                                          Ae
                                          
                                             
                                                
                                                   u
                                                
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 H
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       D
                                    
                                 
                                 Ae
                                 (
                                 u
                                 )
                                 e
                                 (
                                 w
                                 )
                                 δ
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       ′
                                    
                                 
                                 d
                                 Ω
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       l
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          w
                                       
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       D
                                    
                                 
                                 
                                    
                                       pw
                                    
                                    
                                       ′
                                    
                                 
                                 H
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       D
                                    
                                 
                                 
                                    
                                       
                                          pw
                                          -
                                          τ
                                          w
                                          ∇
                                          
                                             
                                                
                                                   
                                                      
                                                         ∇
                                                         Φ
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ∇
                                                                  Φ
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 δ
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       ′
                                    
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       D
                                    
                                 
                                 τ
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                                 δ
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∇
                                          Φ
                                       
                                    
                                 
                                 d
                                 Ω
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∫
                                                                        
                                                                           D
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           Q
                                                                        
                                                                        
                                                                           e
                                                                        
                                                                        
                                                                           p
                                                                        
                                                                     
                                                                     H
                                                                     
                                                                        
                                                                           
                                                                              Φ
                                                                           
                                                                        
                                                                     
                                                                     d
                                                                     Ω
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             K
                                             
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            D
                                                         
                                                      
                                                      
                                                         
                                                            Q
                                                         
                                                         
                                                            e
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      δ
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      d
                                                      Ω
                                                      +
                                                      
                                                         ∫
                                                         
                                                            D
                                                         
                                                      
                                                      
                                                         
                                                            pQ
                                                         
                                                         
                                                            e
                                                         
                                                         
                                                            p
                                                            -
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            Q
                                                         
                                                         
                                                            e
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      H
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                         
                                                      
                                                      d
                                                      Ω
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             K
                                             =
                                             
                                                
                                                   c
                                                
                                                
                                                   p
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∫
                                                            
                                                               D
                                                            
                                                         
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               e
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         H
                                                         
                                                            
                                                               
                                                                  Φ
                                                               
                                                            
                                                         
                                                         d
                                                         Ω
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   e
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             Ae
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                             e
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The process of deriving G in Eq. (21) is demonstrated in Appendix A.

Put Eq. (21)–(24) into Eq. (20). Collect all the terms including 
                           
                              
                                 
                                    w
                                 
                                 
                                    ′
                                 
                              
                           
                        , and the sum is shown in Eq. (25) which is naturally equal to zero.
                           
                              (25)
                              
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          Ae
                                          
                                             
                                                
                                                   u
                                                
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                pw
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 H
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 d
                                 Ω
                                 -
                                 
                                    ∫
                                    
                                       D
                                    
                                 
                                 τ
                                 
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                                 δ
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∇
                                          Φ
                                       
                                    
                                 
                                 d
                                 Ω
                                 =
                                 0
                              
                           
                        Then, collect the terms containing 
                           
                              
                                 
                                    u
                                 
                                 
                                    ′
                                 
                              
                           
                         and make the sum equal to zero, that is,
                           
                              (26)
                              
                                 
                                    ∫
                                    
                                       D
                                    
                                 
                                 
                                    
                                       
                                          Ae
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   w
                                                
                                             
                                          
                                          +
                                          λ
                                          
                                             
                                                KpQ
                                             
                                             
                                                e
                                             
                                             
                                                p
                                                -
                                                1
                                             
                                          
                                          Ae
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   u
                                                
                                             
                                          
                                       
                                    
                                 
                                 H
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 d
                                 Ω
                                 =
                                 0
                              
                           
                        Through solving Eq. (26), the solution of the adjoint variable 
                           w
                         can be derived.

By collecting the remaining terms, the sensitivity analysis result is obtained as,
                           
                              (27)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             
                                                ∫
                                                
                                                   D
                                                
                                             
                                             β
                                             δ
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                
                                             
                                             
                                                
                                                   Φ
                                                
                                                
                                                   ′
                                                
                                             
                                             d
                                             Ω
                                             =
                                             
                                                ∫
                                                
                                                   D
                                                
                                             
                                             β
                                             δ
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   n
                                                
                                             
                                             |
                                             ∇
                                             Φ
                                             |
                                             d
                                             Ω
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             β
                                             =
                                             1
                                             +
                                             μ
                                             G
                                             +
                                             Ae
                                             (
                                             u
                                             )
                                             e
                                             (
                                             w
                                             )
                                             +
                                             λ
                                             
                                                
                                                   KQ
                                                
                                                
                                                   e
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              β
                           
                         is called shape gradient density. Then, by following Eq. (28),
                           
                              (28)
                              
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 -
                                 β
                              
                           
                        
                     


                        L can be guaranteed to change in the descent direction, as shown in Eq. (29),
                           
                              (29)
                              
                                 
                                    
                                       L
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       D
                                    
                                 
                                 -
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                                 δ
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 |
                                 ∇
                                 Φ
                                 |
                                 d
                                 Ω
                                 ⩽
                                 0
                              
                           
                        When come to the fiber orientations, the sensitivity analysis will be as,
                           
                              (30)
                              
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       θ
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       D
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                A
                                             
                                             
                                                ∂
                                                θ
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   u
                                                
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   w
                                                
                                             
                                          
                                          +
                                          λ
                                          
                                             
                                                KpQ
                                             
                                             
                                                e
                                             
                                             
                                                p
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ∂
                                                A
                                             
                                             
                                                ∂
                                                θ
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   u
                                                
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   u
                                                
                                             
                                          
                                       
                                    
                                 
                                 H
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 d
                                 Ω
                              
                           
                        Therefore, by following Eq. (31), the change of L can be guaranteed in the steepest descent direction as shown in Eq. (32).
                           
                              (31)
                              
                                 
                                    
                                       ∂
                                       θ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                A
                                             
                                             
                                                ∂
                                                θ
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   u
                                                
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   w
                                                
                                             
                                          
                                          +
                                          λ
                                          
                                             
                                                KpQ
                                             
                                             
                                                e
                                             
                                             
                                                p
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ∂
                                                A
                                             
                                             
                                                ∂
                                                θ
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   u
                                                
                                             
                                          
                                          e
                                          
                                             
                                                
                                                   u
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 λ
                                 
                                    
                                       KpQ
                                    
                                    
                                       e
                                    
                                    
                                       p
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       ′
                                    
                                 
                                 e
                                 
                                    
                                       
                                          u
                                       
                                    
                                 
                                 e
                                 
                                    
                                       
                                          u
                                       
                                    
                                 
                              
                           
                        Where
                           
                              
                                 λ
                                 
                                    
                                       KpQ
                                    
                                    
                                       e
                                    
                                    
                                       p
                                       -
                                       1
                                    
                                 
                                 ⩾
                                 0
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       ∂
                                       L
                                    
                                    
                                       ∂
                                       θ
                                    
                                 
                                 
                                    
                                       ∂
                                       θ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       D
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   A
                                                
                                                
                                                   ∂
                                                   θ
                                                
                                             
                                             e
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                             
                                             e
                                             
                                                
                                                   
                                                      w
                                                   
                                                
                                             
                                             +
                                             λ
                                             
                                                
                                                   KpQ
                                                
                                                
                                                   e
                                                
                                                
                                                   p
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ∂
                                                   A
                                                
                                                
                                                   ∂
                                                   θ
                                                
                                             
                                             e
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                             
                                             e
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 H
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                 
                                 d
                                 Ω
                                 ⩽
                                 0
                              
                           
                        
                     

In order to update the level set function, the Hamilton–Jacobi equation as presented in Eq. (9) needs to be solved. The upwind scheme [31,48,1] is used with the following update equation for 2D problems,
                           
                              (33)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       jk
                                    
                                    
                                       I
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       Φ
                                    
                                    
                                       jk
                                    
                                    
                                       I
                                    
                                 
                                 +
                                 Δ
                                 t
                                 
                                    
                                       
                                          
                                             max
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         jk
                                                      
                                                   
                                                   ,
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                ∇
                                             
                                             
                                                +
                                             
                                          
                                          +
                                          min
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                n
                                             
                                             
                                                jk
                                             
                                          
                                          ,
                                          0
                                          )
                                          
                                             
                                                ∇
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                              
                           
                        in which,
                           
                              (34)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∇
                                                
                                                
                                                   +
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            max
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           D
                                                                        
                                                                        
                                                                           jk
                                                                        
                                                                        
                                                                           -
                                                                           x
                                                                        
                                                                     
                                                                     ,
                                                                     0
                                                                  
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         
                                                            min
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           D
                                                                        
                                                                        
                                                                           jk
                                                                        
                                                                        
                                                                           +
                                                                           x
                                                                        
                                                                     
                                                                     ,
                                                                     0
                                                                  
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         
                                                            max
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           D
                                                                        
                                                                        
                                                                           jk
                                                                        
                                                                        
                                                                           -
                                                                           y
                                                                        
                                                                     
                                                                     ,
                                                                     0
                                                                  
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         min
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     D
                                                                  
                                                                  
                                                                     jk
                                                                  
                                                                  
                                                                     +
                                                                     y
                                                                  
                                                               
                                                               ,
                                                               0
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∇
                                                
                                                
                                                   -
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            min
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           D
                                                                        
                                                                        
                                                                           jk
                                                                        
                                                                        
                                                                           -
                                                                           x
                                                                        
                                                                     
                                                                     ,
                                                                     0
                                                                  
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         
                                                            max
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           D
                                                                        
                                                                        
                                                                           jk
                                                                        
                                                                        
                                                                           +
                                                                           x
                                                                        
                                                                     
                                                                     ,
                                                                     0
                                                                  
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         
                                                            min
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           D
                                                                        
                                                                        
                                                                           jk
                                                                        
                                                                        
                                                                           -
                                                                           y
                                                                        
                                                                     
                                                                     ,
                                                                     0
                                                                  
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         max
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     D
                                                                  
                                                                  
                                                                     jk
                                                                  
                                                                  
                                                                     +
                                                                     y
                                                                  
                                                               
                                                               ,
                                                               0
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In Eq. (33) and (34), (
                           
                              j
                              ,
                              k
                              )
                           
                         denotes the two-dimension grid node index. 
                           
                              
                                 
                                    D
                                 
                                 
                                    jk
                                 
                                 
                                    ±
                                    x
                                 
                              
                           
                         and 
                           
                              
                                 
                                    D
                                 
                                 
                                    jk
                                 
                                 
                                    ±
                                    y
                                 
                              
                           
                         are the forward and backward finite difference operators. 
                           
                              Δ
                              t
                           
                         should satisfy the Courant–Friedrichs–Lewy (CFL) condition [32]. Additionally, in order to maintain the accurate boundary evolvement, the level set function 
                           
                              Φ
                           
                         should be re-initialized to be the signed distance function for every a few iterations, as,
                           
                              (35)
                              
                                 
                                    
                                       
                                          ∇
                                          Φ
                                       
                                    
                                 
                                 =
                                 1
                              
                           
                        On the other hand, the fiber orientations are updated by using Eq. (36).
                           
                              (36)
                              
                                 θ
                                 =
                                 θ
                                 +
                                 
                                    
                                       ∂
                                       θ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 Δ
                                 t
                              
                           
                        It should be noticed that, the time interval used to update the fiber orientations is not necessarily identical to that of the level set function.

As for optimal criteria, 
                           
                              
                                 
                                    L
                                 
                                 
                                    ′
                                 
                              
                              =
                              0
                           
                         and 
                           
                              cQ
                              -
                              
                                 
                                    Q
                                 
                                 
                                    lim
                                 
                              
                              ⩽
                              0
                           
                         should be satisfied. The former implies at least a local optimum, and the latter means the strength constraint is satisfied.

In this work, the finite element analysis (FEA) is implemented on fixed quadrilateral meshes to solve the linear elastic problem as depicted in Eq. (17). The artificial weak material is applied by employing the elastic tensor of 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    3
                                 
                              
                              
                              A
                           
                         for voids in order to avoid the singularity of the stiffness matrix.

The weight factor 
                           
                              μ
                           
                         of the thickness-control functional is designed to be increasing by iterations as shown in Eq. (37). The purpose of doing so is that the initial small 
                           
                              μ
                           
                         rarely influences the topological and shape changes, but can finally realize the thickness-control effect.
                           
                              (37)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   I
                                                   +
                                                   1
                                                
                                             
                                             =
                                             γ
                                             
                                                
                                                   μ
                                                
                                                
                                                   I
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             γ
                                             >
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        The strength constraint is satisfied by applying the Augmented Lagrange method which adopts the Lagrange multiplier as,
                           
                              (38)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   I
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   λ
                                                
                                                
                                                   I
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                             
                                             (
                                             cQ
                                             -
                                             
                                                
                                                   Q
                                                
                                                
                                                   lim
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Λ
                                                
                                                
                                                   I
                                                   +
                                                   1
                                                
                                             
                                             =
                                             ε
                                             
                                                
                                                   Λ
                                                
                                                
                                                   I
                                                
                                             
                                             
                                             where
                                             
                                             0
                                             <
                                             ε
                                             <
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        In summary of the complete numerical implementation, it is a two-scale optimization problem of coupled structure and material optimization. The complete implementation procedures are presented in Fig. 7
                        .

With fiber-reinforcement, the strength and resistance to deformation of the polymer can be greatly enhanced along the fiber orientation, while it’s not the case for the normal direction. Therefore, control of the fiber orientation distribution to approach the designed pattern is significant in realizing the expected strength enhancement. As mentioned in [35,28], the fiber orientation can be easily induced along a given direction, and two important rules are generally followed,
                        
                           (1)
                           Shear flows tend to align fibers in the flow direction;

Extensional flows tend to align fibers in the elongation direction.

Therefore, the fiber orientation is greatly influenced by the way the polymer flows through the mold, which is dependent on three factors: rheology of the melt material, the injection molding process parameters and also the mold geometry [35,28]. Concerning the accessibility, adjustment of the injection molding process parameters is commonly employed to control the fiber orientation distribution.

SadAbadi and Ghasemi [35] evaluated the influence of process parameters including injection flow rate, mold wall temperature, packing pressure and also fiber content on the fiber orientation distribution; they drew the conclusion that the injection flow rate has more influence than mold wall temperature on the fiber orientation distribution, and packing pressure has almost no effect on it. Chen et al. [8] used the Taguchi to find the optimal setting of process parameters including the filling time, melt temperature, mold temperature, and injection speed to maximize the shear layer thickness. Li et al. [28] reviews the mold temperature’s influence on the fiber orientation distribution.

Therefore, according to these previous works and also the authors’ experience, four process parameters – the gate location, injection flow rate, mold temperature and melt temperature – which have major influence on the fiber orientation distribution have been defined as the optimization variables.

Given the optimization method, RSM is employed in this work, as proved by [43] that RSM is an effective tool for the optimization of injection molding process parameters. RSM [30] is a method to approximate the relationship between the performance and optimization variables. It can optimize the process parameters within a continuous parameter space, which overcomes Taguchi’s limitation of only finding the best set of specified process parameter level combination. The specific procedures of applying the RSM to optimize the process parameters are listed below,
                        
                           (1)
                           Define the factor levels of each variable, and use the central composite design (CCD) to construct the experiment design [30].

Define the objective function as shown in Eq. (39).
                                 
                                    (39)
                                    
                                       Obj
                                       .
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                e
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                
                                                
                                                   max
                                                   (
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       |
                                       
                                          
                                             θ
                                          
                                          
                                             se
                                          
                                       
                                       -
                                       
                                          
                                             θ
                                          
                                          
                                             oe
                                          
                                       
                                       |
                                    
                                 
                              
                              m is the total sample element number, 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          se
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          oe
                                       
                                    
                                 
                               are the fiber orientations of sample element e from the simulation result and the optimized result, respectively. It should be noticed that in Eq. (39), there is an additional term to adjust the weight of the absolute orientation difference of each sample element, which will weaken the influence of the sample elements with low EED. Therefore, Eq. (39) actually represents the weighted average orientation difference.

Perform the numerical experiments and evaluate the results according to the predefined objective function. The quadratic polynomial function as shown in Eq. (40) is used to approximate the relationships among the objective function and the variables.
                                 
                                    (40)
                                    
                                       Obj
                                       .
                                       =
                                       
                                          
                                             β
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             5
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             6
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             7
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             8
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             9
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             10
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             11
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             12
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             13
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             14
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             15
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           

Based on the quadratic relationship, obtain the best parameter set.

As shown in Fig. 8
                     , the plastic gripper of diameter 68mm will be re-designed with fiber-reinforcement. The reasons for doing so lie in two points: the current design tends to fail during the process of assembling the rod in; and, the ribs as well as the walls are overly thickened which brings difficulties to the injection molding process. Therefore, it’s necessary to introduce fiber-reinforcement in, and modify the current design to be stronger and lighter-weighted.

Before starting the new design, the authors would investigate the current design to find out the worst case leading to the failure. It can be determined through qualitative analysis that the ultimate loading condition occurs when the part bears the largest deformation, which is equivalent to a pair of vertical force imposing on the inner convex corners oppositely, just as shown in Fig. 9
                        (a). According to the material properties listed in Table 1
                        , the maximum allowable stress is 75MPa. Based on the conditions mentioned above, it can be determined that, the forces and the deformations at the loading points are 
                           
                              ±
                           
                        73.25N (per mm in thickness) and 
                           
                              ±
                           
                        1.76mm respectively; the maximum local EED is 4.25∗10−4
                        J, as shown in Fig. 9(c). It would be special for this case to be used in optimization, as the constant deformations of 
                           
                              ±
                           
                        1.76mm at the loading points should be imposed as the loading condition because of the assembly process.

For the new design, 20 percent glass fibers (in volume) will be introduced in. The fiber employs the density of 2.4g/cm3, Young’s modulus and tensile strength along the longitudinal direction of 50GPa and 2.85GPa (including safety factor of 1.4), respectively. With this setup, the maximum local EED should still be constrained within the value of 4.25∗10−4
                        J.

Given the loading condition, optimization with constant deformations as input should be the right scheme, but it will make the conceptual design process even more complex; therefore, the assumed loading forces of 
                           
                              ±
                           
                        183.13N (per mm in thickness) will be used, which are 2.5 times of the current design. The reasonability of this assumption will be validated later.

The design domain is the gray area as shown in Fig. 10
                        (a), for which the outer profile will be reserved during the optimization process; thickness of the ribs or walls are intended to be controlled constantly of 5mm instead of the 7mm of the current design.

After proper setup of the problem, we go through the level-set structure and material optimization process and derive the result as shown in Fig. 10(b); the relevant EED distribution and fiber orientation distribution are shown in Fig. 10(c) and (d), respectively. It should be noticed that the manual editing method presented in sub-Section 3.3 is not applied to this case. Table 2
                         presents a data comparison between the current design and the new design, and a few advantages of the new design can be summarized as follows,
                           
                              •
                              The new design is light-weighted, which achieves a material volume save of 11.67 percent;

The thinner ribs and walls, as well as the bigger in-between spaces make the cooling process design easier and help produce better part quality.

The majority of the fibers employ the orientations aligning the axial directions of the ribs, which means the fibers are functioning effectively.

The deformations of the ultimate loading points of the current design are 
                                    
                                       ±
                                    
                                 1.76mm, while the values of the new design are 
                                    
                                       ±
                                    
                                 1.74mm. Therefore, it can be concluded that our approximation about the ultimate loading forces for the new design is reasonable.

To optimize the injection molding process, each variable has been assigned with three levels as presented in Table 3
                        . It should be noticed that, the gate location variable means the distance from the left gate to the left end; relatively, the right gate is in a symmetric position (see Fig. 11
                        ).

CCD, as the most popular class of second-order experiment design method, has been applied. The corresponding experiment design is shown in Table 4
                        .

The numerical experiment results are evaluated by the objective function as shown in Eq. (39), and the corresponding values are attached in Table 4. All numerical experiments are conducted with the commercial software Moldflow®. To avoid artificial errors, all properties of the materials are maintained consistent between the conceptual design and the numerical experiments.

Through single variable analysis, the individual effect of each variable on the weighted average orientation difference has been derived and presented in Fig. 12
                        . It can be seen that, the gate location has a major influence on the fiber orientations, followed by the mold temperature; the injection flow rate and melt temperature only have limited influence.

Through regression analysis, the quadratic polynomial function as shown in Eq. (40) is constructed as,
                           
                              (41)
                              
                                 Obj
                                 .
                                 =
                                 8.5215
                                 +
                                 0.4161
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 0.0478
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 0.0372
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 0.0717
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 0.0069
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 0.0094
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 -
                                 0.0106
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 -
                                 0.0131
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 0.0256
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 -
                                 0.0406
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 -
                                 0.2615
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 0.1735
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 0.3015
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 0.1585
                                 
                                    
                                       β
                                    
                                    
                                       15
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        Using this quadratic relationship, the best parameter set is obtained as presented in Table 5
                        .

To validate the result, the authors uniformly extract 5 sections with 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                           
                         equal to 10, 20, 30, 40 and 50, respectively. The strength analysis is conducted separately on each section with the constant deformation input; correspondingly, the EED and orientation (in-plane) distributions are demonstrated in Fig. 13
                        . It can be seen that the in-plane fiber orientation distributions are analogous at each section; the maximum EEDs distribute within the range of [5.43∗10−4
                        J, 5.81∗10−4
                        J], which means the safety factor reduction from 1.4 to a range of [1.197, 1.238] through the sections or effectively 1.197. These phenomena are within the expectation of the authors, and thus acceptable, because the RSM is used to reduce the relaxation of the optimized strength, instead of the complete elimination. Therefore, the safety factor should be selected higher than the recommended value at the CACD stage.

The worst case is also tested, and the safety factor is reduced to the range of [1.050, 1.197] through the sections or effectively 1.050. Therefore, it is proved that the RSM can effectively enhance the part strength by optimizing the injection molding process parameters.

In summary of the developed procedures, the following general conclusions can be drawn,
                           
                              (1)
                              The level-set topology optimization can automatically and effectively complete the conceptual design with desired characteristics of light weight and uniform rib thickness. However, the coupled fiber orientation optimization is still not very stable, as distribution discontinuity appears in the result. Therefore, for further development of the level set structural and material optimization, the emphasis will be put on improvement of the fiber orientation optimization under the coupled environment for better capability of finding global optimum.

About the injection molding process optimization, it helps to select the best process parameter set to realize the optimized fiber orientation distribution through manufacturing. However, it is non-trivial for complete realization and relaxation of the designed strength is unavoidable. Therefore, it is suggested that more stringent strength constraint than usual should be employed by the conceptual design. On the other hand, the four process parameters – gate location, mold temperature, injection flow rate, and melt temperature have been defined which have major influence on the fiber orientation distribution according to some previous works. However, based on the case study result and the authors’ cognition, the number of gates and their locations have the strongest influence. Therefore, for further work, unequal factorial experiment design is suggested, with more factors for the gate related variables.

@&#CONCLUSION@&#

This paper contributes a novel and systematic design methodology for optimizing fiber-reinforced plastic parts; it addresses issues tightly integrated from modeling, optimal design, to manufacturing.

As for specific contributions, they have been presented in the above replies. Here, a summary is given as below:
                        
                           •
                           A new heterogeneous object modeling method is proposed to address the highly-irregular material composition distribution. Importantly, the auxiliary material feature concept is developed to support the expression of design intent which cannot be addressed by optimization activities.

A two-scale level set structure and material optimization method is developed. From literature, it shows that this method has not been broadly implemented even though it has many advantages like clear-cut boundary representation and uniform thickness control.

This work optimizes injection molded fiber reinforcement with the consideration of manufacturability. It contributes by controlling the global process parameters towards the optimized fiber pattern, which is practically very meaningful as the injection molded fiber reinforcement is becoming more and more widely employed by industry.

In summary, this new CAD/CACD/CAE integrated design approach can potentially improve the design and manufacturing of fiber-reinforced plastic parts.

This integrated design framework has been proved effective using a plastic gripper case study. For further work, local fiber reinforcement is a trend of plastic part design, which should be included in this integrated design framework. On the other hand, to overcome the numerical issue of local optimum of the fiber orientations, the continuation methods or multi-start procedures will be investigated to pursue the global optimum.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to acknowledge Drader Manufacturing Pte Ltd for providing the industrial case for the investigation. We would also like to thank NSERC for their CRD and Discovery grants, MITACS for their accelerate cluster internship support, and China Scholarship Council (CSC) for their student scholarship. All the research works were carried out at University of Alberta.

Derivative of the thickness-control function on 
                        
                           Φ
                        
                      is presented in Eq. (A1)
                     
                        
                           (A1)
                           
                              
                                 
                                    ∂
                                    
                                       
                                          D
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    ∂
                                    Φ
                                 
                              
                              =
                              
                                 ∫
                                 
                                    D
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                               
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     T
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                               
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     T
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              δ
                              
                                 
                                    
                                       Φ
                                    
                                 
                              
                              d
                              Ω
                              +
                              
                                 ∫
                                 
                                    D
                                 
                              
                              
                                 
                                    
                                       2
                                       
                                          
                                             
                                                
                                                   Φ
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             +
                                          
                                       
                                       -
                                       2
                                       
                                          
                                             
                                                
                                                   Φ
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                              
                              H
                              
                                 
                                    
                                       Φ
                                    
                                 
                              
                              d
                              Ω
                           
                        
                     In Eq. (A1), the second term on the right side is field integration and needs to be transformed into boundary integration. As the basis of this transformation, a corollary is cited from [2]:
                        Corollary 1
                        
                           For a 2D integrable function 
                           
                              
                                 ϕ
                                 (
                                 X
                                 )
                              
                            
                           as demonstrated in 
                           
                              Fig. A1
                           
                           ,
                           
                              
                                 (A2)
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    ϕ
                                    (
                                    X
                                    )
                                    d
                                    X
                                    =
                                    
                                       ∫
                                       
                                          ∂
                                          Ω
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∫
                                                
                                                   
                                                      
                                                         ray
                                                      
                                                      
                                                         ∂
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Y
                                                         
                                                      
                                                   
                                                   ∩
                                                   Ω
                                                
                                             
                                             ϕ
                                             (
                                             Z
                                             )
                                             (
                                             1
                                             -
                                             
                                                
                                                   d
                                                
                                                
                                                   Ω
                                                
                                             
                                             (
                                             Z
                                             )
                                             κ
                                             (
                                             Y
                                             )
                                             )
                                             d
                                             Z
                                          
                                       
                                    
                                    d
                                    Y
                                 
                              
                           
                           Two definitions are needed to interpret this corollary.
                        

For any 
                              
                                 X
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       Π
                                    
                                    
                                       ∂
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          X
                                       
                                    
                                 
                                 ≔
                                 
                                    
                                       
                                          Y
                                          
                                             
                                             
                                                0
                                             
                                          
                                          ∈
                                          ∂
                                          Ω
                                          ,
                                          
                                             
                                                
                                                   X
                                                   -
                                                   Y
                                                   
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                inf
                                             
                                             
                                                Y
                                                ∈
                                                ∂
                                                Ω
                                             
                                          
                                          
                                             
                                                
                                                   X
                                                   -
                                                   Y
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            is the set of projections of 
                              X
                            on 
                              
                                 ∂
                                 Ω
                              
                           . When 
                              
                                 
                                    
                                       Π
                                    
                                    
                                       ∂
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          X
                                       
                                    
                                 
                              
                            reduces to a single point, it is called the projection 
                              
                                 
                                    
                                       P
                                    
                                    
                                       ∂
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          X
                                       
                                    
                                 
                              
                            of 
                              X
                            onto 
                              
                                 ∂
                                 Ω
                              
                           .

For any 
                              
                                 Y
                                 ∈
                                 ∂
                                 Ω
                                 ,
                                 
                                    
                                       ray
                                    
                                    
                                       ∂
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          Y
                                       
                                    
                                 
                                 ≔
                                 
                                    
                                       
                                          Z
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                n
                                             
                                          
                                          ,
                                          
                                             
                                                d
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                          is
                                          
                                          differentiable
                                          
                                          at
                                          
                                          Z
                                          
                                          and
                                          
                                          
                                             
                                                P
                                             
                                             
                                                ∂
                                                Ω
                                             
                                          
                                          
                                             
                                                
                                                   Z
                                                
                                             
                                          
                                          =
                                          Y
                                       
                                    
                                 
                              
                            is the ray emerging from 
                              Y
                           .

In Corollary 1, 
                              
                                 
                                    
                                       d
                                    
                                    
                                       Ω
                                    
                                 
                                 (
                                 Z
                                 )
                              
                            represents the signed distance function which is equal to 
                              
                                 ϕ
                                 (
                                 Z
                                 )
                              
                            in case of Eq. (35) satisfied. By applying Corollary 1, the sensitivity analysis is adapted into:
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                D
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          ∂
                                          Φ
                                       
                                    
                                    =
                                    
                                       ∫
                                       
                                          D
                                       
                                    
                                    G
                                    δ
                                    
                                       
                                          
                                             Φ
                                          
                                       
                                    
                                    d
                                    X
                                 
                              
                           
                           
                              
                                 (A3)
                                 
                                    G
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  T
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  T
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      -
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       ∫
                                       
                                          
                                             
                                                ray
                                             
                                             
                                                ∂
                                                Ω
                                             
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                             
                                          
                                          ∩
                                          Ω
                                       
                                    
                                    
                                       
                                          
                                             2
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                         
                                                            
                                                               
                                                                  Z
                                                               
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                             -
                                             2
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                         
                                                            
                                                               
                                                                  Z
                                                               
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   d
                                                
                                                
                                                   Ω
                                                
                                             
                                             
                                                
                                                   
                                                      Z
                                                   
                                                
                                             
                                             κ
                                             
                                                
                                                   
                                                      Y
                                                   
                                                
                                             
                                          
                                       
                                    
                                    d
                                    Z
                                 
                              
                           
                        


                           
                              Y
                            is the boundary projection point of 
                              X
                           , and 
                              Z
                            is the sample points on 
                              
                                 
                                    
                                       ray
                                    
                                    
                                       ∂
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          Y
                                       
                                    
                                 
                              
                           .

By defining:
                              
                                 (A4)
                                 
                                    
                                       
                                          ∂
                                          Φ
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    =
                                    -
                                    G
                                 
                              
                           We can make sure 
                              
                                 
                                    
                                       D
                                    
                                    
                                       T
                                    
                                 
                              
                            will change in a descent direction, as:
                              
                                 (A5)
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                D
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          ∂
                                          
                                             
                                                D
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          ∂
                                          Φ
                                       
                                    
                                    
                                       
                                          ∂
                                          Φ
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    =
                                    
                                       ∫
                                       
                                          D
                                       
                                    
                                    -
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    δ
                                    
                                       
                                          
                                             Φ
                                          
                                       
                                    
                                    d
                                    X
                                    ⩽
                                    0
                                 
                              
                           Once the sensitivity analysis is done, the result can be used to analyze the thickness-control effect. For any rib-like structure, there will be double-sided boundary movements all together influencing the rib thickness variation. It can be assumed that the curvatures at the double sides employ similar values but different signs. Therefore, the item including 
                              
                                 κ
                                 (
                                 x
                                 )
                              
                            in Eq. (A3) can be eliminated. Then, Eq. (A3) can be adapted into the form like,
                              
                                 (A6)
                                 
                                    G
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  T
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  T
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      -
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       ∫
                                       
                                          
                                             
                                                ray
                                             
                                             
                                                ∂
                                                Ω
                                             
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                             
                                          
                                          ∩
                                          Ω
                                       
                                    
                                    
                                       
                                          
                                             2
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                         
                                                            
                                                               
                                                                  Z
                                                               
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                             -
                                             2
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                         
                                                            
                                                               
                                                                  Z
                                                               
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                          
                                       
                                    
                                    d
                                    Z
                                 
                              
                           From Eq. (A6), it can be concluded that the thickness could be controlled around T, because 
                              
                                 G
                                 <
                                 0
                              
                            can be guaranteed when the actual thickness is smaller than T, which makes the rib to expand; while 
                              
                                 G
                                 >
                                 0
                              
                            is the case when the actual thickness is bigger than T, which makes the rib to shrink.

To demonstrate the effectiveness of this thickness-control functional, it is tested by the conventional compliance-minimization topology optimization problem. As shown in Fig. A2
                           , the design domain is of the size 50∗100, with its left side fixed and a unit force loaded at the middle of its right side. The material is assumed to employ the Young’s modulus of 1.3 and the Poisson ratio of 0.4. The design objective is to minimize the compliance under certain volume constraints.

To sufficiently explore the thickness control effect, the algorithm has been performed with different T values of 6, 9 and 12, respectively; the results are shown in Fig. A3
                            and Table A1
                           . Apparently, the thickness has been accurately controlled around the targeted values with very little tolerance, which is comparable with the effect presented previously in [9].

@&#REFERENCES@&#

