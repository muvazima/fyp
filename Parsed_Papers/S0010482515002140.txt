@&#MAIN-TITLE@&#Topology adaptive vessel network skeleton extraction with novel medialness measuring function

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A robust, topology adaptive tree-like structure skeleton extraction framework is proposed.


                        
                        
                           
                           A novel medialness measuring function is proposed to reduce the adjacent interferences.


                        
                        
                           
                           A wave propagation procedure is built to identify important topological nodes.


                        
                        
                           
                           The extracted curve skeletons are modeled by active contour models.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Skeleton extraction

Topology adaptive

Vessel images

Curvilinear networks

Medialness measuring function

@&#ABSTRACT@&#


               
               
                  Vessel tree skeleton extraction is widely applied in vascular structure segmentation, however, conventional approaches often suffer from the adjacent interferences and poor topological adaptability. To avoid these problems, a robust, topology adaptive tree-like structure skeleton extraction framework is proposed in this paper. Specifically, to avoid the adjacent interferences, a local message passing procedure called Gaussian affinity voting (GAV) is proposed to realize adaptive scale-growing of vessel voxels. Then the medialness measuring function (MMF) based on GAV, namely GAV–MMF, is constructed to extract medialness patterns robustly. In order to improve topological adaptability, a level-set graph embedded with GAV–MMF is employed to build initial curve skeletons without any user interaction. Furthermore, the GAV–MMF is embedded in stretching open active contours (SOAC) to drive the initial curves to the expected location, maintaining smoothness and continuity. In addition, to provide an accurate and smooth final skeleton tree topology, topological checks and skeleton network reconfiguration is proposed. The continuity and scalability of this method is validated experimentally on synthetic and clinical images for multi-scale vessels. Experimental results show that the proposed method achieves acceptable topological adaptability for skeleton extraction of vessel trees.
               
            

@&#INTRODUCTION@&#

Vessel stenosis is a common vascular pathological change, characterized by the clinical feature of the narrowing or blockage along the vessel path, eventually leading to insufficient blood supply or abnormal deformation. As the demands increase, it becomes more essential to provide an accurate and robust measurement of vascular morphology in the analysis of vascular lesion. However, the geometrical complexity is a major determinant of the computational analysis failure. Manual lumen segmentation and stenosis quantification are laborious and often suffer from inter- and intra-rate variabilities, in respond of this challenge, much research has been devoted to automatic and semi-automatic [1]. Without loss of generality, the curve skeleton is a subset of the object, consisting only of the union of curves, symmetrically placed within the object and characterized by the same topology as the original object [2]. The extracted skeleton not only represents a set of essential geometrical parameters for clinical purposes, but also serves in subsequent computations such as shape representation, pathological analysis of vascular network [3]. As a result, the quantitative approach of vessel shape abnormalities based on skeleton extraction and local width estimation achieves satisfactory results [4].

In recent years, various skeletonization algorithms and implementations have been proposed in the literature. Research on a selection of representative methods can be broadly classified into five groups: distance transform [2,5], topology preserving thinning [6], path tracking based on the minimal path [7] or ridge computation [8] and curve tracing [9,10].

Most methods based on distance transform use the Manhattan metric instead of the Euclidean metric to guarantee low complexity [11]. However, these methods are highly sensitive to the boundary noise, consequently small errors in the object boundary can drastically change the derived skeleton and yield spurious skeleton branches [12,13].

The parallel thinning algorithms proposed by Palágyi and Ma were widely used [14]. The accuracy of the result was reliable through a ‘thinning’ process like peeling onions. However, all algorithms involve a large amount of template matching operations, which are inappropriate for medical application due to the unacceptable computation cost. Though some fast variants based on Look-Up Table (LUT) were proposed, these improvements only made positive effects in processing binary templates and hardly accelerated three-color templates matching [15].

Most methods based on path tracking employ an iterative scheme where the intermediate computation determines the next search direction [16]. Some researchers trend to develop a directional growth strategy along the search path, which is designed based on local properties, such as the spatial continuity of vessel׳s centerline points, curvature, diameter, and intensity [3,17]. However, most tracking algorithms are considered to have low robustness due to indetermined image noise disturbance on edge. Furthermore, these approaches often depend on many parameters and increase the complexity due to the estimation of the next direction vector, which makes them more prone to failure especially for strongly curved structures, bifurcations or vessel with shape abnormalities [18].

The methods based on curve tracing often involve three main steps: initialization, curve construction and curve optimization. Yan [19] used a fuzzy C-means (FCM) clustering procedure to locate cluster centers as initial key skeleton points and employed relational graph analysis to build initial active curve. Finally, it produced the final smooth curve by a modified snake model, which incorporated a FCM-based medialness energy term [19]. Similarly, Spuhler and Harders proposed a skeleton extraction method using a scattered-snakelet approach [20], and Xu proposed another one using stretching open active contour [10]. Though, these methods have acceptable skeleton extraction accuracy and elegant topological adaptability, the problems of massive calculation cost for curve constructing, overlap checks and network reconfiguration are obvious.

To summarize, existing curve skeleton extraction techniques suffer from at least one of the following limitations: (1) they require manual interaction to select the starting point of each curve skeleton; (2) they have poor topological adaptability for complex vessel network; (3) in order to guide the extraction process, they require huge performance consumption to locate and classify skeletal junction nodes, which is not a trivial task and (4) finally, they are sensitive to boundary noise and adjacent interferences.

Considering the limitations above, the adjacent interferences and poor topological adaptability deteriorate the result of skeleton tree extraction seriously. To address these drawbacks, a robust, topology adaptive tree-like structure skeleton extraction framework is proposed to the segmented images. Firstly, the novel medialness measuring function, which is called GAV–MMF, is constructed based on Gaussian affinity voting to locate skeleton points precisely. The procedure can be considered as an adaptive scale-growing scheme, which can avoid usage of inappropriate scale settings as shown in Section 3.1. The GAV–MMF has superior performance on the adjacent interferences suppression, compared to other convolutional MMFs as discussed in Section 4.2.1; Secondly, during the construction of initial curve skeleton, the level-set map (LSM) and level-set graph (LSG) are built to identify important topological nodes and link relationship between them to improve topological adaptability; Thirdly, each skeleton is modeled as an active curve by stretching open active contour to meet the conditions of smoothness and medialness (Section 3.3). Some topological checks and skeleton tree reconfiguration are proposed to address the problems of spurious branches and artificial corners. Finally, the improvements of our proposed method are discussed in Section 4.

The rest of the manuscript is organized as follows. In Section 2, it starts with a general description of the proposed vessel skeleton extraction framework, and then provides exquisite motivation analysis in further sections. In Section 3, the proposed method gives details about the performed validation and experiments to evaluate robustness and accuracy of skeleton extraction framework in synthetic and clinical images. Some implementation issues and those complexity are discussed in Section 4. Finally, we draw some conclusions in Section 5.

@&#METHODOLOGY@&#

Here, we introduce a novel skeleton tree extraction method based on GAV–MMF. The proposed algorithm framework consists of three steps: (1) medialness measuring function calculation (Section 2.1); (2) initial curve skeleton construction (Section 2.2) and (3) skeleton tree optimization (Section 2.3). Firstly, the novel medialness measuring function based on Gaussian affinity voting (GAV–MMF) is calculated, extracting the distinguishable medialness pattern between the skeleton and non-skeleton points. Secondly, through a wave propagation procedure, the GAV–MMF is used to construct the LSM, which is closely related to locate initial key skeleton points. Then, the LSM is converted to LSG for connecting the curve skeleton. Finally, active curves based on the stretching open active contour are used to model the curve skeleton. In a sequential manner, some topological checks during evolution and skeleton tree reconfiguration after evolution are introduced to keep topological correct. The framework of the proposed method is shown in 
                     Fig. 1. Some basic notions are described in 
                     Table 1.

Intuitively, the skeleton point x is defined as the center of the local spherical shape 
                           
                              
                                 ψ
                              
                              
                                 ρ
                              
                           
                           
                              (
                              x
                              )
                           
                        , separated from the whole object O. Each voxel 
                           y
                           =
                           
                              {
                              
                                 y
                                 |
                                 y
                                 ∈
                                 
                                    
                                       ψ
                                    
                                    
                                       ρ
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 ,
                                 
                                 y
                                 ≠
                                 x
                              
                              }
                           
                         can be considered as ‘reference’, which reflects the medialness contribution 
                           r
                           
                              (
                              
                                 x
                                 ,
                                 y
                              
                              )
                           
                         for how well-suited x is to serve as a skeleton point to y. Due to a variety of vessel sizes 
                           ρ
                        , the initial proposed MMF is defined as follows:
                           
                              (1)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ρ
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    ∫
                                    
                                       y
                                       ∈
                                       
                                          
                                             ψ
                                          
                                          
                                             ρ
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                 
                                 
                                    b
                                    (
                                    x
                                    ,
                                    ρ
                                    )
                                    ×
                                    r
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                    d
                                    y
                                 
                              
                           
                        where 
                           b
                           (
                           x
                           ,
                           ρ
                           )
                           =
                           
                              {
                              
                                 1
                                 |
                                 y
                                 ∈
                                 
                                    
                                       ψ
                                    
                                    
                                       ρ
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                              
                              }
                           
                         is a spherical step function according to 
                           
                              
                                 ψ
                              
                              
                                 ρ
                              
                           
                           
                              (
                              x
                              )
                           
                        . By collecting the contribution from all ‘references’ with 
                           
                              
                                 ψ
                              
                              
                                 ρ
                              
                           
                           
                              (
                              x
                              )
                           
                        , analyzing the information of 
                           
                              
                                 λ
                              
                              
                                 ρ
                              
                           
                           
                              (
                              x
                              )
                           
                         has an intuitive justification in the context of skeleton points detection, assigning higher value to them.

Among most applications, the MMF based on Gaussian kernel [21] tend to be prone to inappropriate scale settings [8] and have difficulty in separating the adjacent vascular structures. Although there are some improved methods based on rectangle kernel [22] and bi-Gaussian kernel [23], the success rate has not seen a concomitant meaningful improvement despite significant advancement in the technology used in the ablation procedure. Another major challenge facing the methods above is that both methods enhance the medialness and the edge response simultaneously. Here, GAV–MMF is proposed to avoid adjacent interferences without edge enhancement. The GAV–MMF calculation is described in pseudocode as Algorithm 1.
                           Algorithm 1
                           The GAV–MMF calculation
                                 
                                    
                                       
                                       
                                          
                                             
                                                Require: The segmented vessel image I
                                                
                                                   s
                                                 and a label map M.
                                          
                                          
                                             
                                                Ensure: The medialness contribution 
                                                   r
                                                   
                                                      (
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                      )
                                                   
                                                , also called voting profile, is defined based on Gaussian function.
                                          
                                          
                                             
                                                1: Initialize the spherical neighborhood scale 
                                                   ρ
                                                   =
                                                   1
                                                .
                                          
                                          
                                             
                                                2: Label each vessel voxel x ‘active’ in M.
                                          
                                          
                                             
                                                3: while
                                             
                                          
                                          
                                             
                                                4:
                                                
                                                for each ‘active’ voxel x
                                             
                                          
                                          
                                             
                                                5:
                                                
                                                
                                                Calculate the GAV–MMF 
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         ρ
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                 using Eq. (4).
                                          
                                          
                                             
                                                6:
                                                
                                                
                                                
                                                if scale growing condition is satisfied
                                          
                                          
                                             
                                                7:
                                                
                                                
                                                
                                                
                                                
                                                x keep ‘active’.
                                          
                                          
                                             
                                                8:
                                                
                                                
                                                
                                                else
                                             
                                          
                                          
                                             
                                                9:
                                                
                                                
                                                
                                                
                                                
                                                x switch to ‘inactive’.
                                          
                                          
                                             
                                                10:
                                                
                                                
                                                
                                                end
                                             
                                          
                                          
                                             
                                                11:
                                                
                                                end
                                             
                                          
                                          
                                             
                                                12:
                                                
                                                
                                                   ρ
                                                   =
                                                   ρ
                                                   +
                                                   1
                                                .
                                          
                                          
                                             
                                                13: until (
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                 reached or no ‘active’ voxels exist)
                                          
                                       
                                    
                                 
                              
                           

Whereas the above affinity voting let all candidate skeleton points compete for wider support. If the candidate skeleton points get sufficient support, it would be eager to expand the voting region to raise its status. This ‘sufficient’ is defined that the contribution received exceed a specified ratio of the predicted amount, and the ratio can be considered as a threshold 
                           t
                           h
                           
                              
                                 s
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       x
                                    
                                 
                              
                           
                           ∈
                           
                              (
                              
                                 0
                                 ,
                                 1
                              
                              )
                           
                        . According to these considerations, the scale growing condition is defined as in Eq. (2).
                           
                              (2)
                              
                                 
                                    
                                       
                                          ∫
                                          
                                             y
                                             ∈
                                             
                                                
                                                   ψ
                                                
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                       
                                       
                                          b
                                          (
                                          x
                                          ,
                                          
                                             
                                                ρ
                                             
                                             
                                                x
                                             
                                          
                                          )
                                          ×
                                          r
                                          
                                             (
                                             
                                                x
                                                ,
                                                y
                                             
                                             )
                                          
                                          ×
                                          
                                             
                                                I
                                             
                                             
                                                s
                                             
                                          
                                          d
                                          y
                                       
                                    
                                    
                                       
                                          ∫
                                          
                                             y
                                             ∈
                                             
                                                
                                                   ψ
                                                
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                       
                                       
                                          b
                                          (
                                          x
                                          ,
                                          
                                             
                                                ρ
                                             
                                             
                                                x
                                             
                                          
                                          )
                                          ×
                                          r
                                          
                                             (
                                             
                                                x
                                                ,
                                                y
                                             
                                             )
                                          
                                          ×
                                          
                                             
                                                I
                                             
                                             
                                                1
                                             
                                          
                                          d
                                          y
                                       
                                    
                                 
                                 ≥
                                 t
                                 h
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                              
                           
                        where I
                        1 is a matrix of all ones with the same size of the segmented vessel image I
                        
                           s
                        . The growing scale 
                           
                              
                                 ρ
                              
                              
                                 x
                              
                           
                         can be perceived as the metric size of voting region, so-called the neighborhood 
                           
                              
                                 ψ
                              
                              
                                 ρ
                              
                           
                           
                              (
                              x
                              )
                           
                        . Rather than specifying the local shape within 
                           
                              
                                 ψ
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       x
                                    
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                         to a standard sphere, an adjustable factor 
                           t
                           h
                           
                              
                                 s
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       x
                                    
                                 
                              
                           
                           ∈
                           
                              (
                              
                                 0
                                 ,
                                 1
                              
                              )
                           
                         is taken to relax the boundary constraint of spherical neighborhood 
                           
                              
                                 ψ
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       x
                                    
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                        . The voting profile based on Gaussian function 
                           r
                           
                              (
                              
                                 x
                                 ,
                                 y
                              
                              )
                           
                           =
                           
                              1
                              
                                 σ
                                 
                                    
                                       2
                                       π
                                    
                                 
                              
                           
                           ×
                           exp
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             (
                                             y
                                             −
                                             x
                                             )
                                          
                                          2
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          2
                                       
                                    
                                 
                              
                              )
                           
                         is used for its natural symmetry, scalability and monotonic decreasing.

Furthermore, the contribution confidence function 
                           p
                           (
                           x
                           ,
                           ρ
                           )
                         is introduced to reduce the influence of asymmetric structures and edges [24] as follows:
                           
                              (3)
                              
                                 p
                                 (
                                 x
                                 ,
                                 ρ
                                 )
                                 =
                                 1
                                 −
                                 
                                    
                                       b
                                       (
                                       x
                                       ,
                                       ρ
                                       )
                                    
                                    
                                       
                                          ∫
                                          
                                             y
                                             ∈
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ρ
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                       
                                       
                                          b
                                          (
                                          x
                                          ,
                                          ρ
                                          )
                                          ×
                                          r
                                          
                                             (
                                             
                                                x
                                                ,
                                                y
                                             
                                             )
                                          
                                          ×
                                          
                                             
                                                I
                                             
                                             
                                                s
                                             
                                          
                                          d
                                          y
                                       
                                    
                                 
                              
                           
                        where I
                        
                           s
                         represents the segmented image. 
                           p
                           (
                           x
                           ,
                           ρ
                           )
                         is used as a weighted function, and the GAV–MMF can be written as Eq. (4).
                           
                              (4)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ρ
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    ∫
                                    
                                       y
                                       ∈
                                       
                                          
                                             ψ
                                          
                                          
                                             ρ
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                 
                                 
                                    b
                                    (
                                    x
                                    ,
                                    ρ
                                    )
                                    ×
                                    p
                                    (
                                    x
                                    ,
                                    ρ
                                    )
                                    ×
                                    r
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                    d
                                    y
                                 
                                 .
                              
                           
                        
                     

Initial curve skeleton construction consists of two steps: the key skeleton point location and linkage. To improve topological adaptability, LSM is constructed based on a wave propagation procedure. During this period, the proposed GAV–MMF is employed to assign and build propagation speed function. The LSM can decompose object O into a set of important topological nodes [25] whose prominent unit is chosen to be key skeleton point. The union of all nodes forms a tree graph which is called level set graph. The link relationship of the LSG can be used to connect the key skeleton points.

As mentioned above, P
                           
                              s
                            is the common ending node among all curves. According to the whole vessel tree, P
                           
                              s
                            is the global shape center and can be considered as the wave propagation source. Here given a sufficient large initial scale 
                              
                                 
                                    ρ
                                 
                                 
                                    (
                                    0
                                    )
                                 
                              
                           , the object shape can be covered by 
                              
                                 
                                    ψ
                                 
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           . Since 
                              
                                 
                                    λ
                                 
                                 
                                    ρ
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            does not form medial surfaces, P
                           
                              s
                            is selected as the point with global maximum in 
                              
                                 
                                    λ
                                 
                                 
                                    ρ
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            as shown in 
                           Fig. 2. If the candidate P
                           
                              s
                            is not unique, a simplification process is operated recursively as in Algorithm 2.
                              Algorithm 2
                              The global shape center P
                                 
                                    s
                                  location
                                    
                                       
                                          
                                          
                                             
                                                
                                                   Require: The initial candidate point set 
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                    and initial scale 
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                   .
                                             
                                             
                                                
                                                   1:
                                                   i=0
                                             
                                             
                                                
                                                   2:
                                                   until 
                                                   
                                                      Δ
                                                      ρ
                                                      =
                                                      
                                                         |
                                                         
                                                            
                                                               
                                                                  ρ
                                                               
                                                               
                                                                  (
                                                                  i
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  ρ
                                                               
                                                               
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                         
                                                         |
                                                      
                                                      <
                                                      ε
                                                      ,
                                                      
                                                      ε
                                                      ≈
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   3:
                                                   
                                                   
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            (
                                                            i
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        V
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        V
                                                                     
                                                                     
                                                                        s
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        
                                                                           ρ
                                                                        
                                                                        
                                                                           (
                                                                           i
                                                                           )
                                                                        
                                                                     
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   4:
                                                   
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            (
                                                            i
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      =
                                                      
                                                         {
                                                         
                                                            c
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            ∈
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  
                                                                     
                                                                        ρ
                                                                     
                                                                     
                                                                        (
                                                                        i
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  c
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            =
                                                            
                                                            max
                                                            
                                                               {
                                                               
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              ρ
                                                                           
                                                                           
                                                                              (
                                                                              i
                                                                              )
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        c
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                         }
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   5:
                                                   
                                                   i=i+1
                                             
                                             
                                                
                                                   6:
                                                   end
                                                
                                             
                                          
                                       
                                    
                                 
                              

The 
                              c
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                            is kth candidate point in set 
                              
                                 
                                    P
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                            at 
                              i
                              th
                            step. V
                           
                              s
                           , V
                           
                              x
                            denote the area of circle neighborhood and the number of voxels in the window, respectively. The iterative process runs starting from i=0 to i=i+1 until it meets the termination criterion. We set the termination criterion as 
                              Δ
                              ρ
                              =
                              
                                 |
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          (
                                          i
                                          +
                                          1
                                          )
                                       
                                    
                                    −
                                    
                                       
                                          ρ
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 |
                              
                              <
                              ε
                              ,
                              
                              ε
                              ≈
                              0
                           .

After wave propagation source location, GAV–MMF is used to build the propagation speed function SF as in Eq. (5).
                              
                                 (5)
                                 
                                    S
                                    F
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                            p
                                                         
                                                      
                                                      ⋅
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  w
                                                                  p
                                                               
                                                            
                                                            ⋅
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  
                                                                     
                                                                        ρ
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               x
                                                               )
                                                            
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      x
                                                      ∈
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      x
                                                      ∉
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    α
                                 
                                 
                                    w
                                    p
                                 
                              
                            is a propagation speed adjustment factor and 
                              
                                 
                                    β
                                 
                                 
                                    w
                                    p
                                 
                              
                            is a normalizing factor. To obtain the propagation time T, the Eikonal equation is solved by fast marching method (FMM), which is a computationally efficient, single-pass algorithm on Cartesian grids [26]. In order to construct the LSM, a new distance field 
                              D
                              =
                              ⌈
                              T
                              ⌉
                            is computed to label voxels into different clusters C
                           
                              n
                           . In LSM, each set of connected voxels having the same D value composes a cluster, which can be considered as a topological node. P
                           
                              s
                            is labeled with C
                           0 specifically. The propagation time T is the reciprocal of the propagation speed and that the speed is just numerical value of GAV–MMF dimensionlessly. So T is a computational cumulative value and used to indicate arrival order for vessel pixels. The propagation time T and the LSM are shown in 
                           Fig. 3.

Employing the speed function SF and the propagation time T, a simple front centering energy function FC is built as follows:
                              
                                 (6)
                                 
                                    F
                                    C
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    S
                                    F
                                    
                                       (
                                       x
                                       )
                                    
                                    ⋅
                                    T
                                    
                                       (
                                       x
                                       )
                                    
                                 
                              
                           
                        

Using 
                              F
                              C
                              
                                 (
                                 x
                                 )
                              
                           , the initial key skeleton point of each cluster C
                           
                              n
                            in LSM can be located with maximum 
                              F
                              C
                              
                                 (
                                 x
                                 )
                              
                            as shown in 
                           Fig. 4.

The LSM can be applied to identify important topological nodes of object O, and LSG can convert them into a graph to show the link relationship. Constructing the LSG as in [25], the initial key skeleton points can be classified and linked, obeying real topological structure of vessel tree. An additional spurious cluster check is executed to remove the spurious clusters.

The LSG contains three types of clusters: the extreme clusters 
                              
                                 
                                    χ
                                 
                                 
                                    c
                                 
                              
                           , the branching clusters B
                           
                              c
                            and the merging clusters M
                           
                              c
                           . The key skeleton points of each cluster above is named end nodes S
                           
                              e
                           , branch nodes S
                           
                              b
                            and bifurcate nodes S
                           
                              B
                           , respectively. The link relationship between nodes is determinated according to the LSG.

However, some spurious clusters appear due to the free wave propagation inevitability. Then, some tiny clusters with independent label appear at the edge of the vascular structures. If it satisfies 
                              {
                              
                                 
                                    
                                       N
                                    
                                    
                                       C
                                    
                                 
                                 ≤
                                 
                                    
                                       T
                                    
                                    
                                       r
                                       a
                                       t
                                       i
                                       o
                                    
                                 
                                 ⋅
                                 
                                    
                                       N
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             a
                                          
                                       
                                    
                                 
                                 |
                                 
                                    
                                       N
                                    
                                    
                                       C
                                    
                                 
                                 ≤
                                 
                                    
                                       n
                                    
                                    
                                       t
                                    
                                 
                              
                              }
                           , the C can be considered as a spurious cluster, which will be merged into the nearest cluster C
                           
                              a
                            
                           N
                           
                              C
                            and 
                              
                                 
                                    N
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                            are set to the number of pixels in cluster C and C
                           
                              a
                           . The 
                              
                                 
                                    T
                                 
                                 
                                    r
                                    a
                                    t
                                    i
                                    o
                                 
                              
                            is a coefficient for adjusting the upper limit of N
                           
                              C
                           , and usually 
                              
                                 
                                    T
                                 
                                 
                                    r
                                    a
                                    t
                                    i
                                    o
                                 
                              
                              ∈
                              
                                 [
                                 
                                    0.1
                                    ,
                                    0.3
                                 
                                 ]
                              
                           . Similarly, n
                           
                              t
                            is set to a constant of no more than 10 in our tests.

As mentioned above, the curve skeleton between 
                              〈
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       e
                                    
                                 
                              
                              〉
                            can be constructed through connecting the key skeleton points. However, the result of direct connection just generates some piecewise lines, which hardly meet smoothness and medialness condition. Here, each curve skeleton is modeled as an active curve by stretching open active contour (SOAC), which can generate a smooth curve elongating while conforming to the desired vascular structure feature. Meanwhile, the GAV–MMF is introduced as the medialness energy, driving the active curve to the expected skeleton location.

Mathematically, SOAC in two-dimensional space is a open parametric curve 
                              C
                              
                                 (
                                 s
                                 )
                              
                              =
                              
                                 
                                    (
                                    
                                       x
                                       
                                          (
                                          s
                                          )
                                       
                                       ,
                                       y
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                    )
                                 
                                 T
                              
                              ,
                              
                              s
                              ∈
                              
                                 [
                                 
                                    0
                                    ,
                                    L
                                 
                                 ]
                              
                           , parameterized by arc length s. The active curve evolves by minimizing an energy functional 
                              ε
                              
                                 (
                                 r
                                 )
                              
                            as in Eq. (7).
                              
                                 (7)
                                 
                                    ε
                                    
                                       (
                                       r
                                       )
                                    
                                    =
                                    
                                       ∫
                                       0
                                       L
                                    
                                    
                                       α
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                    
                                       
                                          |
                                          
                                             r
                                             ׳
                                             
                                                (
                                                s
                                                )
                                             
                                          
                                          |
                                       
                                       2
                                    
                                    +
                                    β
                                    
                                       (
                                       s
                                       )
                                    
                                    
                                       
                                          |
                                          
                                             r
                                             ׳
                                             ׳
                                             
                                                (
                                                s
                                                )
                                             
                                          
                                          |
                                       
                                       2
                                    
                                    +
                                    
                                       
                                          κ
                                       
                                       
                                          s
                                          t
                                          r
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          s
                                          t
                                          r
                                       
                                    
                                    
                                       (
                                       
                                          r
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          κ
                                       
                                       
                                          G
                                          A
                                          V
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          G
                                          A
                                          V
                                       
                                    
                                    
                                       (
                                       
                                          r
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                       )
                                    
                                    d
                                    s
                                 
                              
                           where 
                              α
                              
                                 (
                                 s
                                 )
                              
                            and 
                              β
                              
                                 (
                                 s
                                 )
                              
                            are weights for controlling the tension and rigidity of the curve, respectively. The 
                              
                                 
                                    κ
                                 
                                 
                                    G
                                    A
                                    V
                                 
                              
                            and 
                              
                                 
                                    κ
                                 
                                 
                                    s
                                    t
                                    r
                                 
                              
                            are weights for stretching energy term 
                              
                                 
                                    E
                                 
                                 
                                    s
                                    t
                                    r
                                 
                              
                            and medialness energy term 
                              
                                 
                                    E
                                 
                                 
                                    G
                                    A
                                    V
                                 
                              
                           , respectively. Until the driving forces 
                              ∇
                              
                                 
                                    ε
                                 
                                 
                                    i
                                    n
                                    t
                                 
                              
                              
                                 (
                                 
                                    r
                                    
                                       (
                                       s
                                       )
                                    
                                 
                                 )
                              
                            and 
                              ∇
                              
                                 
                                    ε
                                 
                                 
                                    e
                                    x
                                    t
                                 
                              
                              
                                 (
                                 
                                    r
                                    
                                       (
                                       s
                                       )
                                    
                                 
                                 )
                              
                            balance out and reach an equilibrium state, the curve skeleton moves to the bright intensity ridges with higher medialness value 
                              
                                 
                                    λ
                                 
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          x
                                       
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            as shown in 
                           Fig. 5.

To keep evolving curve skeleton being free of spurious topology, topological checks are built based on the prior topological knowledge. As we know, each curve skeleton is constructed as a curve between 
                              〈
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       e
                                    
                                 
                              
                              〉
                            without any loops, so both ends of curve cannot be connect to any point of curve. The length of each curve C
                           
                              i
                            must be greater than a given threshold, or it will be determined as a spurious branch. Through the processing mentioned in Section 2.2, the initial skeleton is constructed close to the actual skeleton, so tremendous shrink deformation is unreasonable. Based on these considerations, some topological checks are described as in Algorithm 3.
                              Algorithm 3
                              Skeleton topological checks
                                    
                                       
                                          
                                          
                                             
                                                
                                                   Require: The curve skeleton 
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         (
                                                         s
                                                         )
                                                      
                                                      ,
                                                      
                                                      s
                                                      ∈
                                                      
                                                         [
                                                         
                                                            0
                                                            ,
                                                            L
                                                         
                                                         ]
                                                      
                                                    between 
                                                      〈
                                                      
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               e
                                                            
                                                         
                                                      
                                                      〉
                                                   , iteration times N.
                                             
                                             
                                                
                                                   Ensure: 
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         (
                                                         0
                                                         )
                                                      
                                                   , 
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            e
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      =
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         (
                                                         L
                                                         )
                                                      
                                                    and length threshold 
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      =
                                                      ρ
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  s
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   .
                                             
                                             
                                                
                                                   1:
                                                   
                                                   for each C
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   1:
                                                   
                                                   
                                                   for 
                                                   n=1:N
                                                
                                             
                                             
                                                
                                                   2:
                                                   
                                                   
                                                   
                                                   Minimizing the energy functional 
                                                      ε
                                                      
                                                         (
                                                         r
                                                         )
                                                      
                                                    in Eq. (7)
                                                
                                             
                                             
                                                
                                                   3:
                                                   
                                                   
                                                   
                                                   Measure the current curve length 
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                   .
                                             
                                             
                                                
                                                   4:
                                                   
                                                   
                                                   
                                                   
                                                   if 
                                                   
                                                      d
                                                      i
                                                      s
                                                      t
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  e
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        C
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            ,
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  j
                                                                  ≠
                                                                  i
                                                               
                                                            
                                                            
                                                               (
                                                               s
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                      <
                                                      1
                                                    
                                                   ----------- Loop Check
                                                
                                             
                                             
                                                
                                                   4:
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   Delete 
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            e
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   .
                                             
                                             
                                                
                                                   5:
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      −
                                                      1
                                                   .
                                             
                                             
                                                
                                                   6:
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            e
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      =
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   7:
                                                   
                                                   
                                                   
                                                   
                                                   end
                                                
                                             
                                             
                                                
                                                   8:
                                                   
                                                   
                                                   
                                                   
                                                   if 
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      <
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                    
                                                   ----------- Length Check
                                                
                                             
                                             
                                                
                                                   9:
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   C
                                                   
                                                      i
                                                    is determined as a spurious branch.
                                             
                                             
                                                
                                                   10:
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   end
                                                
                                             
                                             
                                                
                                                   11:
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   if 
                                                   
                                                      Δ
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      −
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            (
                                                            
                                                               n
                                                               −
                                                               1
                                                            
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      <
                                                      0
                                                    
                                                   ----------- Shrinkage Check
                                                
                                             
                                             
                                                
                                                   12:
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   if 
                                                   
                                                      Δ
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      ≥
                                                      Δ
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            (
                                                            
                                                               n
                                                               −
                                                               1
                                                            
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   12:
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   Unreasonable shrinkage appears on the C
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   12:
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   end
                                                
                                             
                                             
                                                
                                                   13:
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   end
                                                
                                             
                                             
                                                
                                                   13:
                                                   
                                                   
                                                   end
                                                
                                             
                                             
                                                
                                                   13:
                                                   
                                                   end.
                                                
                                             
                                          
                                       
                                    
                                 
                              

After SOACs evolution, several curve skeletons can be obtained between 
                              〈
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       e
                                    
                                 
                              
                              〉
                           . In the previous process, the skeleton tree is modeled as a star network, which has a common central node P
                           
                              s
                            and several branch nodes S
                           
                              e
                           . Though the network based on star topology structure is simple and steerable, the network contains many redundant skeleton points 
                              S
                              
                                 
                                    P
                                 
                                 
                                    r
                                 
                              
                            as in 
                           Fig. 6(a) and (b), embedded in different SOACs synchronously. The redundant skeleton points 
                              S
                              
                                 
                                    P
                                 
                                 
                                    r
                                 
                              
                            should be removed using pixel labeling and morphology operation as Algorithm 4. After reconfiguring, the final skeleton tree is shown in Fig. 6(c).
                              Algorithm 4
                              Skeleton tree reconfiguration
                                    
                                       
                                          
                                          
                                             
                                                
                                                   Require: The curve skeleton C
                                                   
                                                      i
                                                    between 
                                                      〈
                                                      
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               e
                                                            
                                                         
                                                      
                                                      〉
                                                    and the segmented image I
                                                   
                                                      s
                                                   .
                                             
                                             
                                                
                                                   1:
                                                   for each C
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   2:
                                                   Run B-spline interpolation to get more skeleton points SP.
                                             
                                             
                                                
                                                   3:
                                                   Label SP on the I
                                                   
                                                      s
                                                    and output the labeled image C
                                                   
                                                      L
                                                   .
                                             
                                             
                                                
                                                   4:
                                                   Run close operation on the I
                                                   
                                                      L
                                                   .
                                             
                                             
                                                
                                                   5:
                                                   
                                                   for 
                                                   n=1:5
                                             
                                             
                                                
                                                   6:
                                                   
                                                   
                                                   Run parallel thinning on the I
                                                   
                                                      L
                                                   .
                                             
                                             
                                                
                                                   7:
                                                   
                                                   end
                                                
                                             
                                             
                                                
                                                   8:
                                                   Count adjacent edge number.
                                             
                                             
                                                
                                                   9:
                                                   Relocate end nodes S
                                                   
                                                      e
                                                   , branch nodes S
                                                   
                                                      b
                                                    and bifurcate nodes S
                                                   
                                                      B
                                                   
                                                
                                             
                                             
                                                
                                                   10:
                                                   end
                                                
                                             
                                             
                                                
                                                   11:Output the final curve skeleton network.
                                             
                                          
                                       
                                    
                                 
                              

The labeled image I
                           
                              L
                            approaches expected skeleton image and the I
                           
                              L
                            mostly represents 1-pixel width except the ‘X’ and ‘Y’ positions. Therefore, it needs just a few iterations to accomplish the thinning procedure. In this implementation, we set n to 5.

@&#EXPERIMENTS@&#

The proposed framework has elegant topological adaptability. Also, it is general and can be used for both 2D and 3D case. The performance of the proposed skeleton extraction method has been validated on both synthetic and clinical CTA images. All CTA images are obtained by SIEMENS 64 row spiral dual source CT from Guangzhou General Hospital of Guangzhou Command, and that the CTA images are segmented by employing existing COSFire filter [27] and Li׳s ACM [28]. The proposed method is implemented in MATLAB and open functions in C. The program is tested on a HP-Z800 workstation with 64-bit Windows 7 OS, CPU Intel Xeon(R) X5690 (3.47GHz), RAM 192GB DDR3 1333MHz and graphics card NVIDIA Quadro 6000 with 4GB video memory.

With an intuitive assumption, the larger scale range setting makes the computational implementation of such situation nontrivial. Here, an experiment is designed to obtain the relationship between the scale setting 
                           ρ
                           ∈
                           
                              [
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       min
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       max
                                    
                                 
                              
                              ]
                           
                         and the computational efficiency of GAV–MMF. Fifty synthetic vessel images of size 512×512 pixels are used. The lower limit of scale is set to 
                           
                              
                                 ρ
                              
                              
                                 min
                              
                           
                           =
                           1
                        , while the upper limit 
                           
                              
                                 ρ
                              
                              
                                 max
                              
                           
                         is set from 5 to 50. In 
                        Fig. 7, we present the statistical results of computation time under different 
                           
                              
                                 ρ
                              
                              
                                 max
                              
                           
                        . Due to most actual radii are less than 5, the time concentrates around 0.1632s. But given the instability on computational efficiency in the presence of a variety of vascular widths, we choose to construct an overcomplete set of invariants by setting a wide scale range. The result shows that the computation time is not sensitive to 
                           
                              
                                 ρ
                              
                              
                                 max
                              
                           
                        , for scale adaptive of GAV–MMF.

Further, another experiment is designed to study the effect of 
                           
                              
                                 ρ
                              
                              
                                 max
                              
                           
                         on the adjacent structures separation performance of the GAV–MMF. A synthetic image with two different groups of tubes, which has the same radius of 15 pixels (left) and different radii of 5, 10, 15 pixels (right), is used. To clearly show medialness variation across different vessels, two lines are manually delineated perpendicular to the direction of vessels as shown in 
                        Fig. 8(c) and (d). GAV–MMF should be calculated along these lines and the MMF based on Frangi filter [29] shows performance contrast result. We present the numerical result of both MMFs in 
                        Fig. 9.

As observed, both MMFs cannot generate acceptable result with the undersize scale, and there are two artificial vessel centers in the latter case. When the 
                           
                              
                                 ρ
                              
                              
                                 max
                              
                           
                         is set to the actual scale, both MMFs generate acceptable result and GAV–MMF is more accurate on medialness calculation. Further, the oversize scale range setting makes MMF based on Frangi filter suffer severe adjacent interferences, while GAV–MMF can retain a clear gap between the adjacent tubes. Even in the case of different radii as in Fig. 8(d), GAV–MMF with more relaxing scale setting can provide better performance, while MMF based on Frangi filter shows terrible result that merging response curve of each tube.

According to both tests above, the 
                           
                              
                                 ρ
                              
                              
                                 max
                              
                           
                         is set to guarantee that the 
                           
                              
                                 ρ
                              
                              
                                 max
                              
                           
                         is large than the actual upper limit of vessel scale. To achieve it, 
                           
                              
                                 ρ
                              
                              
                                 max
                              
                           
                         can be adaptively set by Algorithm 2 without any user interaction.

As mentioned in Section 2.1, 
                           t
                           h
                           
                              
                                 s
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       x
                                    
                                 
                              
                           
                           ∈
                           
                              (
                              
                                 0
                                 ,
                                 1
                              
                              )
                           
                         is set to relax the boundary constraint of spherical neighborhood 
                           
                              
                                 ψ
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       x
                                    
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                        . In order to test the effect of 
                           t
                           h
                           
                              
                                 s
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       x
                                    
                                 
                              
                           
                         on location accuracy of medial precision, an experiment is designed to obtain the error between the numerical result and manual result as shown in 
                        Fig. 10. The error rate reduces below 5% when 
                           t
                           h
                           
                              
                                 s
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       x
                                    
                                 
                              
                           
                         is set between 0.9383 and 0.9412. For simplicity, 
                           t
                           h
                           
                              
                                 s
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       x
                                    
                                 
                              
                           
                         is set to 0.94 in our implementation.

Firstly, the experiment studies the effect of different values of 
                           
                              
                                 α
                              
                              
                                 w
                                 p
                              
                           
                         and 
                           
                              
                                 β
                              
                              
                                 w
                                 p
                              
                           
                         on the generation of the LSM, which is the base of the initial skeleton construction. Here, the synthetic vessel images of size 512×512 pixels are used. We change the parameter 
                           
                              
                                 α
                              
                              
                                 w
                                 p
                              
                           
                         from 0 to 1 in steps of 0.1, while 
                           
                              
                                 β
                              
                              
                                 w
                                 p
                              
                           
                         is set from 10 to 100 in steps of 10. Part of experimental result is shown in 
                        Fig. 11.

As shown in Fig. 11, wave propagation time is tuned up to provide more topological nodes, while 
                           
                              
                                 α
                              
                              
                                 w
                                 p
                              
                           
                         reduces or 
                           
                              
                                 β
                              
                              
                                 w
                                 p
                              
                           
                         increases. Especially, lower 
                           
                              
                                 α
                              
                              
                                 w
                                 p
                              
                           
                         can make the shape of wave front be closer to a peak, helping to locate the key skeleton points. For further proving the effect of 
                           
                              
                                 α
                              
                              
                                 w
                                 p
                              
                           
                         on the key skeleton point location, the tests are operated to show the relationship between location accuracy and 
                           
                              
                                 α
                              
                              
                                 w
                                 p
                              
                           
                         as shown in 
                        Fig. 12. Based on the compromise between the number of topological nodes and the shape of wave front, 
                           
                              
                                 β
                              
                              
                                 w
                                 p
                              
                           
                           =
                           20
                         and 
                           
                              
                                 α
                              
                              
                                 w
                                 p
                              
                           
                           =
                           0.3
                         is selected in our implementation to generate acceptable LSM.

The experiment studies the effect of changing parameters on the skeleton extraction based on SOAC and GAV–MMF. Firstly, α and β are taken into account. We change the parameter α from 0 to 2 in steps of 0.1, while β is set from 0 to 1 in steps of 0.1. Part of experimental result is shown in 
                        Fig. 13.

As observed, a similar behavior is produced that the curve skeletons evolve more smooth while α and β increase. The smooth effect of β is stronger than α for higher order variable. The appropriate range of parameter setting is obtained from tests above, that 
                           α
                           ∈
                           
                              (
                              
                                 0
                                 ,
                                 
                                    
                                       0.5
                                    
                                    ]
                                 
                              
                           
                         and 
                           β
                           ∈
                           
                              [
                              
                                 0
                                 ,
                                 0.2
                              
                              ]
                           
                        . In our implementation, α is set to 0.2, and β is set to 0 for cutting off the redundant computation cost as shown in Fig. 13(e).

Secondly, in order to test the effect of 
                           
                              
                                 κ
                              
                              
                                 G
                                 A
                                 V
                              
                           
                        , we change the parameter 
                           
                              
                                 κ
                              
                              
                                 G
                                 A
                                 V
                              
                           
                         from 0 to 50 in steps of 0.1. The result shows that it is insensitive to 
                           
                              
                                 κ
                              
                              
                                 G
                                 A
                                 V
                              
                           
                         as shown in 
                        Fig. 14. Consequently, 
                           
                              
                                 κ
                              
                              
                                 G
                                 A
                                 V
                              
                           
                           =
                           2
                         is an acceptable selection in our implementation.

Finally, in order to test the effect of 
                           
                              
                                 κ
                              
                              
                                 s
                                 t
                                 r
                              
                           
                        , we change the parameter 
                           
                              
                                 κ
                              
                              
                                 s
                                 t
                                 r
                              
                           
                         from 0 to 1 in steps of 0.1. As observed, the stretching force is failed when 
                           
                              
                                 κ
                              
                              
                                 s
                                 t
                                 r
                              
                           
                           <
                           0.3
                        . The smoothing force is so dominant that over-smooth occurs with curve skeleton shrinkage as shown in 
                        Fig. 15. The position, where shrinkage appears, is labeled with yellow arrow. Consequently, 
                           
                              
                                 κ
                              
                              
                                 s
                                 t
                                 r
                              
                           
                           =
                           0.5
                         is an acceptable selection in our implementation.

In this section, many synthetic vessel images and clinical CTA images are used to verify the performance of the proposed skeleton tree extraction method. To the clinical images, the segmentation of vessel tree is obtained by employing COSFire filter [27] and Li׳s ACM [28], as shown in 
                        Fig. 16. For implementing the proposed method under a specified size, all the images are interpolated to size 512×512 pixels.

The experimental results of synthetic and clinical data are shown in 
                        
                        Figs. 17 and 18, respectively. The performance evaluation of synthetic and clinical images are shown in 
                        
                        Tables 2 and 3, respectively. N
                        
                           m
                         is the number of manual labeled ground truth skeleton points, and N
                        
                           a
                         is the number of skeleton points generated by our proposed method. TP, FN and FP are the true positive, false negative, and false positive parameters, respectively. Dice Similarity Coefficient (DSC) [7] measures how close between the result of proposed method r
                        
                           A
                         and the radiologist׳s delineation result r
                        
                           B
                        . Higher DSC means higher accuracy and DSC is calculated by 
                           D
                           S
                           C
                           =
                           
                              
                                 2
                                 
                                    (
                                    
                                       
                                          
                                             r
                                          
                                          
                                             A
                                          
                                       
                                       ∩
                                       
                                          
                                             r
                                          
                                          
                                             B
                                          
                                       
                                    
                                    )
                                 
                              
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       A
                                    
                                 
                                 ∪
                                 
                                    
                                       r
                                    
                                    
                                       B
                                    
                                 
                                 )
                              
                           
                        .

To judge the quality of the algorithm for noise images, different levels of Gaussian noise are superposed onto the segmented images. The distribution variance 
                           
                              
                                 σ
                              
                              
                                 n
                              
                           
                         is set from 0.3 to 0.01 in steps of 0.01. The test images are generated with Signal Noise Ratio (SNR) from −5dB to 8dB. The processing results are shown in 
                        Fig. 19.

From Fig. 19, it is shown that the performance of proposed method is affected very little. Among all the labeled skeleton points by manual, about 85.2–89.7% points are labeled correctly and average DSC is about 0.81. Under lower SNR, most performance deterioration appears due to fault localization of end points as Fig. 19(d) and (h). Further, stronger noise makes GAV–MMF contain more position deviation. To reduce deviation, reinforcing the boundary constraint of spherical window for GAV–MMF computation is a simple and efficient way. The observed result shows that higher DSC is obtained under higher boundary constraint 
                           
                              
                                 ρ
                              
                              
                                 t
                                 h
                                 s
                              
                           
                         as 
                        Fig. 20.

To test our method on clinical data with noise, different levels noise are superposed on the CTA image. The whole pipeline starts from vessel enhancement [29] to vessel segmentation [30], LSM construction, SOACs evolution and topological checks. All parameters are set as mentioned in Sections 3.1–3.3. The results are shown in 
                        Fig. 21. The LSM decomposes and identifies important topological nodes of segmented vessel tree. By Eq. (7), the key skeleton points are selected accurately from each voxel cluster as in Fig. 21(e). The LSG provides the link relationship within each curve skeleton and that the SOACs are driven to expected skeleton position by GAV–MMF as in Fig. 21(f) and (g). The final skeleton network is reconfigured to keep topology correct as in Fig. 21(h).

The method of extracting skeleton network from 2D vessel tree can be directly extensible to the 3D space. To test performance of proposed method in 3D case, a clinical data set of 10 clinical CTA scans, with 150 slices of size 512×512 pixels in each scan, is used. Each slice is of resolution 0.7mm with interslice spacing of 2mm. Similar to the situation in the 2D case, the volumetric vessel images should be segmented firstly. The pre-segmentation method based on Improved Local Shape Analysis (ILSA) is proposed in our previous work [31]. The segmented results are shown in 
                        Fig. 22.

With the same size of the segmented volumetric vessel image I
                        
                           s
                        , the Gaussian voting profile is converted to a volumetric template 
                           T
                           (
                           x
                           ,
                           ρ
                           )
                         to calculate the 3D GAV–MMF by Eq. (4) and 
                           t
                           h
                           
                              
                                 s
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                              
                           
                         is set to 0.8. Then, the variational window 
                           
                              
                                 ψ
                              
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                         is replaced by a spherical shape, and that all the voxels within the covering region are derived volumetric wave propagation to construct 3D LSM and LSG. The propagation parameter is set as 
                           
                              
                                 α
                              
                              
                                 w
                                 p
                              
                           
                           =
                           0.3
                         and 
                           
                              
                                 β
                              
                              
                                 w
                                 p
                              
                           
                           =
                           15
                        . Finally, the SOACs can be extended to 3D model by three-dimensional system of coordinate directly. The SOACs parameter is set as 
                           α
                           =
                           0.2
                        , 
                           β
                           =
                           0.2
                         and 
                           
                              
                                 κ
                              
                              
                                 G
                                 A
                                 V
                              
                           
                           =
                           0.2
                        . The volumetric results are shown in 
                        
                        Figs. 23 and 24.

As mentioned in [10], the network of converged SOACs may not be topologically correct. For sequential evolution of each curve skeleton modeled by SOAC, it is designed to form T- or corner-junctions only, without any cross-junctions or higher-degree junctions [10]. After network reconfiguration proposed in Section 2.3.3, a more physical network topology is retrieved as in 
                        Fig. 25. Some tiny spurious branch are also cut off from skeleton network by topological checks as in 
                        Fig. 26.

For optimal performance, the whole structure of the tree has to be covered with SOAC curves as shown in Fig. 23. The number of end points increases by observing in 3D while the topology complexity of vessel tree increases. Consequently, the computation time increases. The main limitation of the approach is that the skeleton extraction is influenced by the performance of pre-segmentation seriously. For example, some spurious end points maybe located in our implementation as shown in 
                        Fig. 27(a), which are possibly result from inappropriate segmentation. Artificial curve skeletons are misguided due to those unexpected end points, but not the proposed skeleton extraction method. To make corrections, it needs to support user interactions. As in Fig. 27(c), the user can easily manipulate the outcome of skeleton extraction.

@&#DISCUSSION@&#

The proposed method can be divided into three parts: (1) GAV–MMF calculation; (2) initial curve skeleton construction and (3) skeleton tree optimization.

In first step, 
                           
                              
                                 n
                              
                              
                                 ρ
                              
                           
                           =
                           
                              
                                 ρ
                              
                              
                                 max
                              
                           
                           −
                           
                              
                                 ρ
                              
                              
                                 min
                              
                           
                         iterations are taken into account. For simplicity, the Gaussian voting profile is convert to a template 
                           T
                           (
                           x
                           ,
                           ρ
                           )
                         with the same size of the segmented vessel image I
                        
                           s
                        . Rather than template convolution, frequency multiplication can cut down the calculated amount through Fast Fourier Transformation (FFT) and Inverse Fast Fourier Transformation (IFFT) [22]. 
                           
                              
                                 λ
                              
                              
                                 ρ
                              
                           
                           
                              (
                              x
                              )
                           
                         is calculated by Eq. (8).
                           
                              (8)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ρ
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 F
                                 F
                                 
                                    
                                       T
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       F
                                       F
                                       T
                                       (
                                       
                                          
                                             I
                                          
                                          
                                             s
                                          
                                       
                                       )
                                       ⋅
                                       F
                                       F
                                       T
                                       (
                                       T
                                       (
                                       x
                                       ,
                                       
                                          
                                             ρ
                                          
                                          
                                             x
                                          
                                       
                                       )
                                       )
                                    
                                    )
                                 
                              
                           
                        
                     

Specifically, each iteration can be divided into two parts with the same computation complexity, the contribution confidence function 
                           p
                           (
                           x
                           ,
                           ρ
                           )
                         and final GAV–MMF calculation. As described in Eqs. (3) and (4), 
                           
                              
                                 λ
                              
                              
                                 ρ
                              
                           
                           
                              (
                              x
                              )
                           
                         is calculated in both parts. Additionally, the time complexity is 
                           O
                           
                              (
                              
                                 N
                                 
                                 log
                                 
                                 N
                              
                              )
                           
                         for both FFT, IFFT and 
                           O
                           
                              (
                              N
                              )
                           
                         for the multiplication in Eq. (8). So the computation complexity of GAV–MMF calculation is 
                           O
                           
                              (
                              
                                 2
                                 
                                    
                                       n
                                    
                                    
                                       ρ
                                    
                                 
                                 N
                                 
                                 log
                                 
                                 N
                              
                              )
                           
                        .

After GAV–MMF calculation, Multi Stencils Fast Marching (MSFM) is used to simulate the wave propagation, further LSM and LSG. In the worst case, the complexity of MSFM is verified that 
                           O
                           
                              (
                              
                                 N
                                 
                                 log
                                 
                                 N
                              
                              )
                           
                         
                        [32]. However, MSFM can be reduced to 
                           O
                           
                              (
                              N
                              )
                           
                         by implementing the narrow band as an untidy priority queue [33].

The computational efficiency of SOACs evolution is guaranteed by the quantity of initialization. For LSM can find the important topological nodes and locate the key skeleton points, the SOACs are always initialized on the GAV–MMF ridges. Though the vessel tree is a curvilinear network with complex topology, the previous methods based on LSM and GAV–MMF reduce the iterations to about 5–7 times.

The first confessed concept of medialness was originally presented by Pizer [34] to describe how close to the medial axis of object. Presently, the MMF based on the convolutional kernel is in fashion. The familiar kernel mainly consists of the Gaussian kernels [21], the rectangle kernels [22] and the Bi-Gaussian kernels [23].

Though Gaussian convolution can provide a framework of multiscale analysis and keep second order differentiable constraints, however, it inevitably causes the isotropic diffusion of intensity information. If given an inappropriate scale range, the oversize 
                              σ
                            will generate an unexpected diffusion procedure, which leads to severe adjacent interferences as shown in Fig. 8(a)–(d).

The method based on the rectangle kernels [22] and the Bi-Gaussian kernels [23] can address the adjacent interference problem, however, both methods enhance the medialness and the edge response simultaneously. Additionally, the inherent drawback of rectangle kernels, that relaxing the homogeneity constraint and subjecting to false responses, might cause intra-region discontinuities [23].

In the proposed GAV–MMF, an adaptive scale growing scheme called GAV is used to extract the accurate scale for each voxel. As a result, the GAV can restrict the scale growing of the boundary voxels, avoiding the false over-scale medialness diffusion. Through the scale growing with restriction, the final MMF can be a monotone increasing function from shape boundary to center without edge response enhancement.

FCT is a variant of open snake method based on fuzzy clustering [19]. The clustering procedure has an averaging effect and can smooth or filter out influence of noise and outlier pixels. The clusters, each of which consists of a collection of pixels, can also be more powerful in attracting a curve than individual pixels [19]. However, FCM is just a straightforward method to cluster the points to the nearest candidate center, and it yields regardless of data topology. Consequently, the FCT can be trapped to deflected location on account of its inability to address severe adjacent interferences. The GAV–MMF, which has a remarkable ability against the interferences, is embedded into SOACs to escape from the traps. Additionally, the stretching term of SOACs produces a positive impact on avoiding skeleton shrinkage, which is derived from smoothing effect of the tension and rigidity term.

A similar method based on LSM and LSG is used in Hassouna׳s work [25] to identify the complex topology. The skeleton network is converted to a tree graph, whose root is assigned to the common starting point P
                           
                              s
                            among curve skeletons. Each leaf node of the graph represents a prominent part of the shape, whose representative point is considered as the ending point of a curve skeleton. However, this simple star topology is not appropriate for complex vessel tree. To refine the topology adaptive, reconfiguration is introduced to re-describe the topology structure, keeping topological correct and removing the redundant skeleton points. Replacing the MMF based on GVF and direct skeleton linkage, GAV–MMF and the SOAC are used to assure the smoothness and the medialness of final skeleton tree.

@&#CONCLUSION@&#

In this paper, we propose a novel skeleton extraction method of vessel tree based on curve tracing. By incorporating the new medialness measuring function GAV–MMF, local shape center and vascular radius information can be obtained synchronously, without any adjacent structure interferences. This advantage of the proposed method is extremely important to improve computation speed and topology adaptive. Some comparing experiments have been conducted to emphasize the performance of GAV–MMF and the proposed skeleton extraction algorithm. In future, the focus is mainly posed on 3D application. As mentioned in Section 3.5, inappropriate segmentation can deteriorate the result of skeleton network extraction. So, more accurate 3D vessel tree segmentation is also on our research technical route.

None declared.

@&#ACKNOWLEDGMENTS@&#

This work is supported by the National Natural Science Foundation of China (61305038, 61273249), the Natural Science Foundation of Guangdong Province, China (S2012010009886), the Public Science and Technology Research Funds Projects of Ocean (201505002), the Fundamental Research Funds for the Central Universities, SCUT (No. 2015ZZ028), the Key Laboratory of Autonomous Systems and Network Control of Ministry of Education (SCUT of China), the National Engineering Research Center for Tissue Restoration and Reconstruction, and the Guangdong Key Laboratory for Biomedical Engineering (SCUT of China).

@&#REFERENCES@&#

