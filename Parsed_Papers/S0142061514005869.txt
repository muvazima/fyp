@&#MAIN-TITLE@&#A novel three-phase four-leg inverter based load unbalance compensator for stand-alone microgrid

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           This paper proposes a novel load unbalance compensator (LUC) for the stand-alone microgrid using three-phase four-leg VSI.


                        
                        
                           
                           The model of a three-phase four-leg VSI for the LUC and the microgrid are simulated using PSCAD/EMTDC.


                        
                        
                           
                           This demonstrates that the proposed LUC increases the stability of stand-alone microgrid under unbalance load conditions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Microgrid

Power quality

Load unbalance

Three-phase four-leg inverter

@&#ABSTRACT@&#


               
               
                  This paper proposes a three-phase four-leg voltage sourced inverter (VSI) based load unbalance compensator (LUC) including its control algorithm, which is a component of a microgrid. The purpose of proposed three-phase four-leg VSI based LUC is to improve power quality of the standalone microgrid. Power quality of the microgrid which was installed in Mara-island, Korea is analyzed using a real operational data. In this work, the microgrid in Mara-island which includes a photovoltaic power generation system, a diesel generator, a battery energy storage system, and a power management system is modeled in PSCAD/EMTDC, and proposed three-phase four-leg VSI based LUC is also modeled and applies to the modeled microgrid. Power flow and stability of the modeled microgrid with the LUC is analyzed under variable irradiance and unbalance loads. The results show that the proposed LUC helps to improve stability of the stand-alone microgrid. The proposed three-phase four-leg VSI based LUC and its control algorithm can be effectively utilized to the stand alone microgrid which has large unbalance loads.
               
            

@&#INTRODUCTION@&#

A distributed generator (DG) such as photovoltaic, wind power, and geothermal is one solution to the energy demand growth and limitation caused by global warming and fossil fuels shortage. However, the power system have encountered with many problems such as increasing of complexity and changing protection rules caused by the increase of DGs. To overcome these problems, a microgrid concept was introduced which is defined as a cluster of DGs [1,2]. The microgrid consists of diesel generators, micro-turbines, wind generators, photovoltaic (PV) generation systems, local loads, and so on [3]. These DGs are managed by a power and energy management systems, which offers many advantages such as peak load shaving, reliability against the utility faults, and high power quality [4,5].

There are two different types of microgrids: grid-connected microgrid and stand-alone microgrid [6]. The grid-connected microgrid can operate either a grid-connected mode or an islanding mode. The efficient operation is the key control issue in the grid-connected mode, and the voltage and frequency control is main issue in the islanding mode when the microgrid disconnects from the utility under abnormal condition [3]. In the case of the stand-alone microgrid, it is always operates in the islanding mode without the grid-connected mode, because it is usually installed in the remote country from the city such as mountainous areas or island without power grid [7].

The stand-alone microgrid for the remote country may be small scale, and has a low voltage distribution network, in which there is the increased likelihood of significant load imbalance between phases. It causes voltage imbalance which can be problem for equipment of the microgrid such as motors [8–10]. Moreover, imbalance current of microgrid causes unclearness of power management system (PMS) because components of microgrid are three-phase three-leg voltage sourced inverter (VSI).

The imbalance compensation method is proposed using three phase three leg VSI for the islanding network in [11]. The negative-sequence conductance is controlled to compensate for the voltage unbalance in [12]. The control methods well compensate voltage unbalance using the three phase three wire VSI in [11,12]. However, it does not solve the unclearness problem of the PMS.

The control strategy for an islanded microgrid under unbalance conditions is presented in [13], a negative-sequence output impedance controller is adapted to the three wire DG. The control method for power quality enhancement using the three-phase four-leg VSI is presented in [14]. However, two inverters are necessary for the power injection and unbalance compensation.

A hierarchical control scheme for unbalance voltage compensation is adapted in [15]. The reference signals for compensation are transmitted to DGs through low bandwidth communication link. The scheme in [15] which uses each DG in microgrid can solve the voltage unbalance problem in islanded mode. However, it is also difficult to solve the unclearness problem of the PMS when the line impedance is small, especially in the case of the small-sized stand-alone microgrid.

This paper proposes a novel load unbalance compensator (LUC) for the stand-alone microgrid using three-phase four-leg VSI, which is connected in parallel with a diesel generator. The concept of the proposed compensator approaches the unbalance currents as opposed to the unbalance voltage. In the case of the existed microgrid, the unbalance currents of the loads is usually supplied by the diesel generator, because the three-phase three-wire based DGs are impossible to inject unbalance current. The proposed system directly compensates unbalance currents of the diesel generator under unbalanced conditions. For verifying effectiveness of the proposed system, the Mara-island’s microgrid in Korea including three-phase four-leg VSI based LUC is modeled and analyzed in PSCAD/EMTDC. The microgrid includes a photovoltaic (PV) power generation system, a diesel generator, a battery energy storage system (BESS), and power management system (PMS).

This paper is divided into five sections. ‘Modeling of Mara-island’s microgrid in Korea’ describes the Mara-island’s microgrid and how to modeling it using PSCAD/EMTDC. In ‘Three-phase four-leg inverter based load unbalance compensator’, the control strategy of the three-phase four-leg VSI based LUC is explained. The simulation results are shown and discussed in ‘Simulation results and discussion and Conclusions’ is the conclusion.


                     Fig. 1
                      shows configuration of the Mara-island’s microgrid in Korea, which is used for case studied. The microgrid is composed of a 380V, one-feeder distribution subsystem, which is the stand-alone system far away from utility network. It consists of a diesel generator, a PV generation system, a BESS, a PMS, and unbalance loads. These systems are connected to 380V low voltage line. The parameters of each component in the microgrid are shown in Table 1
                     . The loads of the microgrid usually vary from 40kW to 120kW.

The microgrid is modeled in PSCAD/EMTDC, which has a control problem of power management caused by unbalance load. The purpose of simulation model is to reenact the actual case using real operation data. In the case of the modeled 150kW PV generation system as illustrated in Fig. 2
                     , the current source is used. The power of the current source is controlled to actual output power data. A d–q transformation control is used for enabling independent control of the active and reactive power. A typical synchronous generator model in PSCAD/EMTDC library is used to represent diesel generator, which is equipped with a simplified 1st-order model of exciter and governor [16]. The BESS is also modeled by using the current source. The power reference of the BESS is calculated by PMS as depicted in Fig. 1.

The purpose of PMS is a high efficient operation of diesel generators and stability of the microgrid. Diesel generators are inherently inefficient when operated at light load, and which can also shorten their lifetime and result in high maintenance costs [17]. The PMS calculates the power reference of BESS in order to maintain the active power of the diesel generator between minimum and maximum value. As shown in Fig. 3
                     , the droop control is applied to the PMS for avoiding power oscillation, and the droop gain is set to kp
                     
                     =2.

The structure of three-phase four-leg VSI for the proposed LUC is shown in Fig. 4
                     , which is composed of a dc-link capacitor, a four-leg inverter, and LC filters. The output of the proposed LUC is connected to the microgrid. The operation scheme for the LUC consists of three main blocks, namely control algorithm for determining current reference, current controller, and strategy to generating PWM. The following subsections describe the functionality of each block in more detail.

The purposes of using this algorithm are to control the dc-link voltage and to determine reference current vectors for compensating load unbalance. The algorithm represents the outer control loop which is employed to generate the reference current vectors id_ref
                        , iq_ref
                        , and i0_ref
                         as shown in Fig. 5
                        . The each phase current of the microgrid img_a
                        , img_b
                        , and img_c
                         can be transformed into a rotating d–q-0 coordinate img_d
                        , img_q
                        , and img_0
                        . According to PQ theory [18], unbalance component of the three-phase four-wire system has ac value in d–q-0 reference frame as:
                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   mg
                                                   _
                                                   d
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   mg
                                                   _
                                                   d
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   mg
                                                   _
                                                   d
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   mg
                                                   _
                                                   q
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   mg
                                                   _
                                                   q
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   mg
                                                   _
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   mg
                                                   _
                                                   0
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   mg
                                                   _
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Hence, the harmonic components iub_d_ref
                         and iub_q_ref
                         are calculated using low pass filter (LPF) as shown in Fig. 5. In this work, the LPF is presented as a first-order transfer function, and cut-off frequency of the LPF is 10Hz.

The dc-link voltage is regulated by q-axis current iq_dc
                        , and the reactive power is controlled to zero [19]. Therefore, reference current vectors can be calculated by:
                           
                              (2)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   d
                                                   _
                                                   ref
                                                
                                             
                                             =
                                             
                                                
                                                   i
                                                
                                                
                                                   mg
                                                   _
                                                   d
                                                
                                             
                                             -
                                             
                                                
                                                   i
                                                
                                                
                                                   lpf
                                                   _
                                                   d
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   q
                                                   _
                                                   ref
                                                
                                             
                                             =
                                             
                                                
                                                   i
                                                
                                                
                                                   mg
                                                   _
                                                   d
                                                
                                             
                                             -
                                             
                                                
                                                   i
                                                
                                                
                                                   lpf
                                                   _
                                                   q
                                                
                                             
                                             +
                                             
                                                
                                                   i
                                                
                                                
                                                   q
                                                   _
                                                   dc
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   0
                                                   _
                                                   ref
                                                
                                             
                                             =
                                             
                                                
                                                   i
                                                
                                                
                                                   mg
                                                   _
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ilpf_d
                         and ilpf_q
                         are LPF outputs of img_d
                         and ilng_q
                         respectively.

The purpose of current controller is to ensure accurate tracking and short transients of the inverter output current [4]. Fig. 6
                         shows the control block diagram of the current controller which is based on a synchronous reference frame. The voltage phase angle θ is estimated by the phase locked loop in order to Park’s transformation in the control block diagram [20]. Three PI controllers are used to eliminate d–q-0 current components, and feed-forward loop considering grid voltage and inductance voltage is employed to improve the steady state and dynamic performance. As a result, the outputs of the controller represent the reference voltage signals (Vd_ref
                        , Vq_ref
                        , and V0_ref
                        ) in the dq0 reference frame, which are transformed into abc reference frame using inverse Park’s transformation. For the eight pulses for the PWM in order to fire the four-leg IGBT inverter, a carrier-based PWM method is used [21].

The Respective pole voltages for the four-leg IGBT valves can be calculated as given in:
                           
                              (3)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   an
                                                
                                             
                                             =
                                             
                                                
                                                   V
                                                
                                                
                                                   af
                                                
                                             
                                             +
                                             
                                                
                                                   V
                                                
                                                
                                                   fn
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   bn
                                                
                                             
                                             =
                                             
                                                
                                                   V
                                                
                                                
                                                   bf
                                                
                                             
                                             +
                                             
                                                
                                                   V
                                                
                                                
                                                   fn
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   cn
                                                
                                             
                                             =
                                             
                                                
                                                   V
                                                
                                                
                                                   cf
                                                
                                             
                                             +
                                             
                                                
                                                   V
                                                
                                                
                                                   fn
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Vaf
                        , Vbf
                        , and Vcf
                         are the each phase reference voltage, and Vfn
                         is offset voltage which can be also determined as:
                           
                              (4)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   fn
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               -
                                                               
                                                                  
                                                                     
                                                                        
                                                                           V
                                                                        
                                                                        
                                                                           max
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ,
                                                            
                                                            
                                                               
                                                                  
                                                                     V
                                                                  
                                                                  
                                                                     min
                                                                  
                                                               
                                                               >
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               -
                                                               
                                                                  
                                                                     
                                                                        
                                                                           V
                                                                        
                                                                        
                                                                           min
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ,
                                                            
                                                            
                                                               
                                                                  
                                                                     V
                                                                  
                                                                  
                                                                     max
                                                                  
                                                               
                                                               <
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               -
                                                               
                                                                  
                                                                     
                                                                        
                                                                           V
                                                                        
                                                                        
                                                                           max
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           V
                                                                        
                                                                        
                                                                           min
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ,
                                                            
                                                            
                                                               Otherwise
                                                            
                                                         
                                                         
                                                            
                                                         
                                                      
                                                      ,
                                                      that
                                                   
                                                
                                             
                                             is
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   fn
                                                
                                             
                                             =
                                             mid
                                             
                                                
                                                   
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  max
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  min
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  max
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  min
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The PWMs for the four-leg IGBT valves can be implemented with a triangular carrier, respective pole voltages and offset voltage as shown in Fig. 7
                         which reveals the lowest harmonics at a given switching frequency [22].

The model of a three-phase four-leg VSI for the LUC and the microgrid are simulated using PSCAD/EMTDC, and are illustrated in Figs. 1 and 4, and the model parameters are defined as follows: L
                     gird
                     =3mH, C
                     grid
                     =5μF, and the DC link capacitor is 10,000μF. The rated power of the VSI is 50kW, and the rated current of each phase is 75 Arms. The switching frequency of IGBT valves and sampling frequency are 10kHz.

In the simulation model, the diesel generator is controlled to min. value=35kW and max value=45kW. The PMS determines the reference of BESS which controls active power of the diesel generator. In order to verify the performance of the proposed LUC and to validate effectiveness of the LUC when it is installed in the stand alone microgrid, the simulation model is simulated for two cases as follows:

In this case, the steady-state performance of the proposed LUC is verified under unbalance load. The scenario is characterized by phase-A load of 10kW, phase-B load of 15kW, and phase-C load of 25kW. The load unbalance factor is about 56% when the average load of microgrid is 80kW. The PV, BESS is not considered in this case. At 0.1s, the LUC connects to the microgrid which compensates the unbalance current of the diesel generator. Fig. 8
                         shows the current of the diesel generator under unbalanced load conditions, and the output current of the proposed three-phase four-leg VSI for LUC is shown in Fig. 9
                        . As shown in Figs. 8 and 9, the unbalance component of diesel generator is disappeared after 0.1s. The neutral line current of the LUC is 60 Arms, and a total load of the diesel generator is 50kW.

In this case, each phase power of the diesel generator is considered with the proposed LUC and unbalance loads. Fig. 10
                         shows the active power of each component such as the PV, BESS, diesel generator, and load. The PV output power and load power are real operation data of Mara-island’s microgrid. The active power output of BESS fluctuates according to the power output of diesel generator, and the negative value of output power means that the BESS is charged. Fig. 11
                         depicts the load unbalance condition, and the each phase power of the diesel generator without the LUC is shown in Fig. 12
                        . The phase reverse power condition occurs from 120s to 290s as shown in Fig. 12. In this case, the diesel generator can be tripped by reverse power relay. On the contrary, Fig. 13
                         illustrates the each phase power of the diesel generator with the LUC, and the phase reverse power condition doesn’t occur. Fig. 14
                         shows the each phase output power of the LUC at the same time. This demonstrates that the proposed LUC increases the stability of stand-alone microgrid under unbalance load conditions.

@&#CONCLUSIONS@&#

In this paper, a three-phase four-leg VSI based LUC has been proposed for stand-alone microgrid when it has serious unbalance load. The concept of the proposed LUC directly compensates unbalance current of the load using a three-phase four-leg VSI, and its control algorithm has been also proposed which has dc-link voltage controller, current controller, and strategy to generating PWM. The modeling and simulations of the microgrid including the proposed system are carried out using PSCAD/EMTDC, and the real operation data of Mara-island’s microgrid in Korea is applied to the simulation. The simulation results demonstrate that the proposed three-phase four-leg VSI based LUC increases stability of the stand-alone microgrid under unbalance load conditions.

@&#REFERENCES@&#

