@&#MAIN-TITLE@&#Practical and accurate calibration of RGB-D cameras using spheres

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Practical, robust and accurate calibration of RGB-D cameras using spherical objects.


                        
                        
                           
                           Estimation of the intrinsic and extrinsic parameters of the RGB and depth sensors.


                        
                        
                           
                           Experimental comparison with existing RGB-D calibration algorithms.


                        
                        
                           
                           “RGB-D calibration toolbox” for MATLAB freely available on the Internet.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

RGB-D cameras

Camera calibration

Robotic vision

@&#ABSTRACT@&#


               
               
                  RGB-Depth (or RGB-D) cameras are increasingly being adopted in robotic and vision applications, including mobile robot localization and mapping, gesture recognition, and at-home healthcare monitoring. As with any other sensor, calibrating RGB-D cameras is needed to increase their sensing accuracy, especially since the manufacturer’s calibration parameters might change between models. In this paper, we present a novel RGB-D camera-calibration algorithm for the estimation of the full set of intrinsic and extrinsic parameters. Our method is easy to use, can be utilized with any arrangement of RGB and depth sensors, and only requires that a spherical object (e.g., a basketball) is moved in front of the camera for a few seconds. Our image-processing pipeline automatically and robustly detects the moving calibration object while rejecting noise and outliers in the image data. Our calibration method uses all the frames of the detected sphere and leverages novel analytical results on the multi-view projection of spheres to accurately estimate all the calibration parameters. Extensive numerical simulations and real-world experiments have been conducted to validate our algorithm and compare its performance with that of other state-of-the-art calibration methods. An RGB-D Calibration Toolbox for MATLAB is also made freely available for the scientific community.
               
            

@&#INTRODUCTION@&#

RGB-D cameras consist of an RGB sensor and a depth sensor, which capture a color image (RGB) and per-pixel depth information (depth image), respectively [1,2]. These sensors generate depth estimates by relying on either structured infrared light 
                     [2,3] or Time-of-Flight (ToF) 
                     [4,5] technology. Low-cost RGB-D cameras (e.g., Microsoft’s Kinect 
                     [3]) have been recently adopted in an increasing number of applications, such as SLAM [6], 3-D scene parsing [7], semantic mapping and telepresence [8], stereoscopic augmented reality [9], 3-D shape scanning [10], construction of dense 3-D maps [11], body tracking [12,13], gait monitoring for tele-rehabilitation [14,15], and object and gesture recognition [16–18]. All of the aforementioned applications require an accurate knowledge of the calibration parameters, i.e., of the relative position and orientation between the RGB and depth sensors, as well as of their intrinsic parameters (focal length, principal point, and lens-distortion). As shown in the visual-odometry example in Fig. 1
                     , calibrating RGB-D cameras is essential to improve their sensing accuracy, since the calibration parameters can differ in each model from those provided by the manufacturer.

Calibrating RGB-D cameras still presents numerous challenges, especially when it comes to accuracy and ease of use.

Most of the existing approaches [19–23] are tailored to the Microsoft’s Kinect since they make use of the infra-red (IR) image. As such, these approaches suffer from some important drawbacks: first, they are impractical as they require the user to adopt an external source of light (e.g., an halogen lamp) to improve the quality of the IR image. Second, the joint RGB-IR calibration can only be performed off-line, since for the Kinect, RGB and IR images cannot be acquired simultaneously.

Other methods have been devised that make use of specific calibration objects simultaneously observed by the RGB and depth sensors. In [25], the authors use a large custom-made wood panel with tens of circular holes, which however requires an extensive manual procedure to associate the holes’ centers in each RGB- and ToF-image pair. Other approaches have been proposed in [24,26,27,29,30] that use planar surfaces with a printed checkerboard pattern. The method in [24] suffers from a major limitation, since it requires the user to provide an initial estimate of some of the calibration parameters, which might not be easily available for generic RGB-Depth sensor-pairs (e.g., RGB and ToF) other than the Kinect, thus affecting the accuracy of the overall calibration. The approaches in [26,27] have two major drawbacks: first, they are time consuming, as they require an expert user to play an active role in selecting corresponding features in the depth images. Second, this selection is unreliable due to the noisy nature of the depth image (in which corners and edges are not well-defined and cannot be accurately selected). The possible errors in the manual selection of features propagate through the calibration algorithm, thus resulting in a decreased accuracy. In [29], the authors automatically extract features from both the RGB image and the 3-D point cloud generated from the depth image. A major drawback of this method is that the corresponding features between the RGB image and the sparse 3-D point cloud are difficult to locate. Finally, building upon [26], in [28,30] more sophisticated distortion-correction models have been developed for the depth image of generic Kinect-like devices. In particular, in [28] the undistortion map is estimated using SLAM in a fully unsupervised way, i.e. the user is only required to record a few minutes of data from a natural environment. However, when compared with the checkerboard-based approaches above, the computational complexity of the method in [28] appears not to be negligible.

In this paper, we present a novel calibration method for RGB-D sensors that addresses all of the aforementioned limitations: it is easy to use even for non-expert users, it is accurate, and can be adopted to calibrate any RGB-D arrangements (e.g., RGB-Lidar, RGB-ToF) which are frequently used in robotic and computer vision applications (cf. Table 1
                     ). In what follows, we highlight the major strengths of our method.
                        
                           (1)
                           Our method is practical, since the user only needs to move a spherical object (e.g., a basketball) in front of the camera and no a priori knowledge of its size is required. A robust image-processing pipeline has been designed to automatically detect and track the spherical object in both the RGB and depth image, while discarding spurious features.

Our calibration algorithm is accurate, since it leverages a novel (least-squares) analytic solution that provides an initial and robust estimate of the camera parameters. As a result, the accuracy of the final calibration is higher. It is also worth emphasizing here that our choice of spheres as calibration objects highly contributes to the accuracy of our method. In fact, the ellipse- and sphere-fitting algorithms adopted in our algorithm help in minimizing the measurement noise and the presence of outliers when compared, e.g., to methods that only use the corners of a standard calibration checkerboard. Spherical calibration objects were used in [31–35] for calibrating RGB sensors, but these methods could not be seamlessly extended to RGB-D sensors.

Our approach is widely applicable, since it can be used to calibrate RGB and depth sensors in any 3-D relative configuration (i.e., not necessarily pointing in the same direction as for the Kinect).

A new MATLAB calibration toolbox implementing our algorithm, called RGB-D Calibration Toolbox, has been developed and made available on the Internet.
                                 1
                                 
                                    http://ranger.uta.edu/∼gianluca/research/assistiverobotics_rgbdcalibration.html.
                              
                              
                                 1
                              
                           

It is important to point out here some major differences between our approach, and other existing multi-camera calibration methods, such as those based on wands [36–38] (e.g., for Vicon systems [39]), or those specifically designed for RGB-Lidar and RGB-ToF sensor pairs [40,41]. Wand-based methods assume that each camera can detect tiny, reflective, 3-D fiducial markers attached to a wand, which might not be easily detectable by generic RGB-D sensors (e.g., the Kinect). Furthermore, the position of these markers must be known, while our method does not require any knowledge about the geometry of the observed calibration object. In [40], the authors extrinsically self-calibrate an RGB camera and a 3-D laser range finder without using a calibration object. However, this method is scarcely practical since it requires constant user intervention, e.g., to manually select corresponding features in both the RGB and range images. Closely related are the works in [41,42], where the authors proposed a method to calibrate multiple RGB-ToF cameras, ultimately adopting the standard checkerboard-based calibration approach in [43]. Nevertheless, these methods may be very demanding and time consuming for the end user, because the required features (such as corners and edges) are not well-defined in ToF images.

This paper is built upon a previous conference contribution [44] over which we extend in several new directions: (1) we present here for the first time a novel formula that relates the projection of the spherical objects with the projection of the 3D sphere’s center. The adoption of this formula guarantees an accurate estimate of all the calibration parameters; (2) we provide more extensive simulation and experimental results in comparing our algorithm with more recent calibration methods; and (3) we experimentally evaluate our approach by also examining its accuracy in calibrating an RGB-D camera made of a ToF and RGB sensor in a generic relative configuration.

The rest of this paper is organized as follows: Section 2 reviews some basic facts on pinhole camera modeling and image projection of spheres. Section 3 describes our calibration algorithm, and in Section 4 extensive numerical and real-world experimental results are presented and thoroughly discussed. Finally, in Section 5, conclusions are drawn and some possible directions for future research are discussed.


                     Fig. 2
                     (a) shows the general RGB-D camera configuration considered in this work. As mentioned in Section 1, our goal consists of calibrating RGB-D cameras, i.e., estimating 
                        D
                     
                     K, the intrinsic calibration matrix of the depth sensor, 
                        R
                     
                     K, the intrinsic calibration matrix of the RGB sensor, 
                        
                           (
                           
                              
                              
                                 D
                              
                              R
                           
                           
                              R
                           
                           ,
                           
                              
                              
                                 D
                              
                              R
                           
                           
                              t
                           
                           )
                        
                     , the rigid-body transformation between the two sensors’ frames, {R} and {D}, and the radial and tangential lens-distortion parameters for both the RGB and depth sensors. Differently from existing RGB-D calibration approaches, our method automatically estimates all of these quantities by using the live data acquired by the RGB and depth sensors, without assuming any a priori knowledge about them or about the observed scene. In what follows, we introduce the notation for both the pinhole camera model and for the image projection of spheres, which will be used in the remaining of this paper.

As illustrated in Fig. 2(a), a generic 3-D point 
                           
                              
                                 
                                 D
                              
                              
                                 X
                              
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              ≜
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          X
                                       
                                       D
                                    
                                    ,
                                    
                                       
                                          0.12
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       D
                                    
                                    ,
                                    
                                       
                                          0.12
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       
                                          Z
                                       
                                       D
                                    
                                    ]
                                 
                                 T
                              
                           
                         in the depth-sensor frame {D} is projected at a pixel point 
                           
                              
                                 
                                 R
                              
                              
                                 u
                              
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              ≜
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          u
                                       
                                       R
                                    
                                    ,
                                    
                                       
                                          0.12
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       
                                          v
                                       
                                       R
                                    
                                    ]
                                 
                                 T
                              
                           
                         on the image plane of the RGB-sensor frame {R} according to the pinhole model [45]. First, 
                           D
                        
                        X is expressed in {R} as:
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                R
                                             
                                             
                                                X
                                             
                                             =
                                             
                                                [
                                                
                                                   
                                                   
                                                      D
                                                   
                                                   R
                                                
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      
                                                         0.25
                                                         e
                                                         m
                                                      
                                                      
                                                         0
                                                         e
                                                         x
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         0.12
                                                         e
                                                         m
                                                      
                                                      
                                                         0
                                                         e
                                                         x
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      D
                                                   
                                                   R
                                                
                                                
                                                   t
                                                
                                                ]
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                D
                                             
                                             
                                                
                                                   X
                                                
                                                ∼
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where the tilde indicates the extension to homogeneous coordinates of a vector. The 3-D point 
                           R
                        
                        X is then normalized as 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    x
                                 
                                 n
                              
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              ≜
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              
                                 
                                    [
                                    
                                       x
                                       
                                          n
                                       
                                       R
                                    
                                    ,
                                    
                                       
                                          0.12
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       y
                                       
                                          n
                                       
                                       R
                                    
                                    ]
                                 
                                 T
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          X
                                       
                                       R
                                    
                                    /
                                    
                                       
                                          Z
                                       
                                       R
                                    
                                    ,
                                    
                                       
                                          0.12
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       R
                                    
                                    /
                                    
                                       
                                          Z
                                       
                                       R
                                    
                                    ]
                                 
                                 T
                              
                           
                        . Similarly to [22,23,26], the lens-distortion is applied as:
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                R
                                             
                                             
                                                
                                                   x
                                                
                                                t
                                             
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               2
                                                               
                                                                  k
                                                                  3
                                                               
                                                               
                                                                  x
                                                                  
                                                                     n
                                                                  
                                                                  R
                                                               
                                                               
                                                                  y
                                                                  
                                                                     n
                                                                  
                                                                  R
                                                               
                                                               +
                                                               
                                                                  k
                                                                  4
                                                               
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     2
                                                                  
                                                                  +
                                                                  2
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           x
                                                                           
                                                                              n
                                                                           
                                                                           R
                                                                        
                                                                        )
                                                                     
                                                                     2
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                                  3
                                                               
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     2
                                                                  
                                                                  +
                                                                  2
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           y
                                                                           
                                                                              n
                                                                           
                                                                           R
                                                                        
                                                                        )
                                                                     
                                                                     2
                                                                  
                                                                  )
                                                               
                                                               +
                                                               2
                                                               
                                                                  k
                                                                  4
                                                               
                                                               
                                                                  x
                                                                  
                                                                     n
                                                                  
                                                                  R
                                                               
                                                               
                                                                  y
                                                                  
                                                                     n
                                                                  
                                                                  R
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                R
                                             
                                             
                                                
                                                   x
                                                
                                                rt
                                             
                                             =
                                             
                                                (
                                                1
                                                +
                                                
                                                   k
                                                   1
                                                
                                                
                                                   
                                                      r
                                                   
                                                   2
                                                
                                                +
                                                
                                                   k
                                                   2
                                                
                                                
                                                   
                                                      r
                                                   
                                                   4
                                                
                                                +
                                                
                                                   k
                                                   5
                                                
                                                
                                                   
                                                      r
                                                   
                                                   6
                                                
                                                )
                                             
                                             
                                                
                                                R
                                             
                                             
                                                
                                                   x
                                                
                                                n
                                             
                                             +
                                             
                                                
                                                R
                                             
                                             
                                                
                                                   x
                                                
                                                t
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 2
                              
                              =
                              
                                 
                                    (
                                    
                                       x
                                       
                                          n
                                       
                                       R
                                    
                                    )
                                 
                                 2
                              
                              +
                              
                                 
                                    (
                                    
                                       y
                                       
                                          n
                                       
                                       R
                                    
                                    )
                                 
                                 2
                              
                           
                         and 
                           
                              
                                 
                                    k
                                 
                                 c
                              
                              =
                              
                                 
                                    [
                                    
                                       k
                                       1
                                    
                                    ,
                                    
                                       k
                                       2
                                    
                                    ,
                                    
                                       k
                                       3
                                    
                                    ,
                                    
                                       k
                                       4
                                    
                                    ,
                                    
                                       k
                                       5
                                    
                                    ]
                                 
                                 T
                              
                           
                         is the lens-distortion vector. The pixel projection of 
                           D
                        
                        X onto the RGB sensor in {R} is finally obtained as:
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                R
                                             
                                             λ
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                R
                                             
                                             
                                                
                                                   u
                                                
                                                ∼
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             =
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                R
                                             
                                             
                                                K
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                R
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   ˜
                                                
                                                rt
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           R
                        
                        λ is an unknown scale factor. The intrinsic calibration matrices, 
                           R
                        
                        K and 
                           D
                        
                        K, of both the RGB and the depth sensors are defined as:
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                R
                                             
                                             
                                                K
                                             
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             ≜
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                               
                                                                  u
                                                               
                                                               R
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                               R
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               u
                                                               
                                                                  0
                                                               
                                                               R
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               f
                                                               
                                                                  v
                                                               
                                                               R
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               
                                                                  0
                                                               
                                                               R
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             ,
                                             
                                                
                                                   1
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                D
                                             
                                             
                                                K
                                             
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             ≜
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                               
                                                                  u
                                                               
                                                               D
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                               D
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               u
                                                               
                                                                  0
                                                               
                                                               D
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               f
                                                               
                                                                  v
                                                               
                                                               D
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               
                                                                  0
                                                               
                                                               D
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where (dropping the superscripts D and R for the sake of simplicity) fu
                         and fv
                         represent the focal lengths (in pixels) in both image-axes directions, 
                           
                              
                                 [
                                 
                                    u
                                    0
                                 
                                 ,
                                 
                                    
                                       0.12
                                       e
                                       m
                                    
                                    
                                       0
                                       e
                                       x
                                    
                                 
                                 
                                    v
                                    0
                                 
                                 ]
                              
                              T
                           
                         is the principal point in pixels, and s is the skew factor [45].
                     

We assume here that the depth sensor outputs a so-called depth image (map), i.e., a set of image points along with their corresponding depth value (in meters) on the z-axis. Each feature acquired by the depth sensor is thus defined as 
                           
                              
                                 
                                 D
                              
                              
                                 u
                              
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              ≜
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          u
                                       
                                       D
                                    
                                    ,
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       
                                          v
                                       
                                       D
                                    
                                    ,
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       
                                          Z
                                       
                                       D
                                    
                                    ]
                                 
                                 T
                              
                           
                        . Differently from a feature 
                           R
                        
                        u in the RGB camera, 
                           D
                        
                        u can be used to uniquely retrieve the corresponding 3-D point coordinates, 
                           D
                        
                        X, as:
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                D
                                             
                                             
                                                
                                                   X
                                                
                                                ∼
                                             
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                  D
                                                               
                                                               
                                                                  
                                                                     
                                                                        K
                                                                     
                                                                  
                                                                  
                                                                     −
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  3
                                                                  ×
                                                                  
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  1
                                                                  ×
                                                                  
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                                
                                                D
                                             
                                             
                                                
                                                   u
                                                
                                                ¯
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 0
                              
                              
                                 3
                                 ×
                                 
                                 1
                              
                           
                         denotes a 
                           
                              3
                              ×
                              
                              1
                           
                         matrix of zeros and 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    u
                                 
                                 ¯
                              
                           
                         is defined as a vector obtained from 
                           D
                        
                        u as follows:
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                D
                                             
                                             
                                                
                                                   u
                                                
                                                ¯
                                             
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             ≜
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        D
                                                                     
                                                                     
                                                                        
                                                                           Z
                                                                        
                                                                        D
                                                                     
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           v
                                                                        
                                                                        D
                                                                     
                                                                     
                                                                        
                                                                           Z
                                                                        
                                                                        D
                                                                     
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           Z
                                                                        
                                                                        D
                                                                     
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                T
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

A sphere with 3-D center 
                           D
                        
                        O
                        
                           s
                        , and radius rs
                        , (see Fig. 2(b)) can be algebraically represented by a quadric [45]:
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                D
                                             
                                             
                                                Q
                                             
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  I
                                                               
                                                               3
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               −
                                                               
                                                                  
                                                                  D
                                                               
                                                               
                                                                  
                                                                     O
                                                                  
                                                                  s
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               −
                                                               
                                                                  
                                                                  D
                                                               
                                                               
                                                                  
                                                                     O
                                                                  
                                                                  
                                                                     s
                                                                  
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                  D
                                                               
                                                               
                                                                  
                                                                     O
                                                                  
                                                                  
                                                                     s
                                                                  
                                                                  T
                                                               
                                                               
                                                                  
                                                                  D
                                                               
                                                               
                                                                  
                                                                     O
                                                                  
                                                                  s
                                                               
                                                               −
                                                               
                                                                  r
                                                                  
                                                                     s
                                                                  
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where I
                        3 denotes the 
                           
                              3
                              ×
                              
                              3
                           
                         identity matrix. In general, a sphere projects in each sensor’s image plane at an ellipse, and its projection in the RGB image, 
                           R
                        
                        C, is given by:
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                R
                                             
                                             
                                                
                                                   
                                                      C
                                                   
                                                
                                                *
                                             
                                             =
                                             
                                                
                                                
                                                   D
                                                
                                                R
                                             
                                             
                                                P
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                D
                                             
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                *
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                      
                                                         D
                                                      
                                                      R
                                                   
                                                   
                                                      P
                                                   
                                                
                                                T
                                             
                                             
                                                
                                                   1
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                where
                                             
                                             
                                                
                                                   1
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                   0.35
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                
                                                   D
                                                
                                                R
                                             
                                             
                                                P
                                             
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             ≜
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                R
                                             
                                             
                                                K
                                             
                                             
                                                [
                                                
                                                   
                                                   
                                                      D
                                                   
                                                   R
                                                
                                                
                                                   R
                                                
                                                |
                                                
                                                   
                                                   
                                                      D
                                                   
                                                   R
                                                
                                                
                                                   t
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        being 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    
                                       C
                                    
                                 
                                 *
                              
                              =
                              
                                 adj
                              
                              
                                 (
                                 
                                    
                                    R
                                 
                                 
                                    C
                                 
                                 )
                              
                           
                         (the adjugate of 
                           R
                        
                        C) the dual conic of 
                           R
                        
                        C, and 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    
                                       Q
                                    
                                 
                                 *
                              
                              =
                              
                                 adj
                              
                              
                                 (
                                 
                                    
                                    D
                                 
                                 
                                    Q
                                 
                                 )
                              
                           
                         
                        [46]. Note that the adjugate is equal to the inverse if the matrix is invertible. The conics 
                           R
                        
                        C and 
                           D
                        
                        C will play a key role in the RGB-D camera-calibration algorithm described in Section 3.

As illustrated in Fig. 2(b), the centers of the two ellipses in both {D} and {R} (
                           D
                        
                        o
                        
                           e
                        ,
                           R
                        
                        o
                        
                           e
                        ), do not correspond, in general, to the projected centers of the sphere, (
                           D
                        
                        o
                        
                           s
                        ,
                           R
                        
                        o
                        
                           s
                        ), in both images.
                           2
                           The center of the ellipse and the projected sphere center match when the 3-D sphere center lies on the camera’s z-axis.
                        
                        
                           2
                         A closed-form expression for converting o
                        
                           e
                         into o
                        
                           s
                         (dropping again the superscripts D and R for generality) is given in [35] and can be rewritten as:
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   o
                                                
                                                s
                                             
                                             =
                                             
                                                
                                                   o
                                                
                                                e
                                             
                                             
                                                (
                                                1
                                                −
                                                γ
                                                )
                                             
                                             +
                                             
                                                
                                                   [
                                                   
                                                      u
                                                      0
                                                   
                                                   ,
                                                   
                                                      
                                                         0.12
                                                         e
                                                         m
                                                      
                                                      
                                                         0
                                                         e
                                                         x
                                                      
                                                   
                                                   
                                                      v
                                                      0
                                                   
                                                   ]
                                                
                                                T
                                             
                                             γ
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              γ
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              ≜
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              
                                 
                                    (
                                    
                                       r
                                       s
                                    
                                    /
                                    
                                       
                                          O
                                       
                                       s
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                    )
                                 
                                 2
                              
                           
                         and O
                        
                           s
                        (3) is the third component of the sphere center, O
                        
                           s
                        . While the sphere radius rs
                         is unknown, γ can be equivalently expressed as a function of the observed conic and of the sensor’s parameters as follows:
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             γ
                                             =
                                             1
                                             −
                                             
                                                
                                                   
                                                      (
                                                      
                                                         C
                                                         
                                                            12
                                                         
                                                         *
                                                      
                                                      −
                                                      
                                                         C
                                                         
                                                            13
                                                         
                                                         *
                                                      
                                                      
                                                         v
                                                         0
                                                      
                                                      −
                                                      
                                                         C
                                                         
                                                            23
                                                         
                                                         *
                                                      
                                                      
                                                         u
                                                         0
                                                      
                                                      )
                                                   
                                                   /
                                                   
                                                      C
                                                      
                                                         33
                                                      
                                                      *
                                                   
                                                   +
                                                   
                                                      u
                                                      0
                                                   
                                                   
                                                      
                                                         0.12
                                                         e
                                                         m
                                                      
                                                      
                                                         0
                                                         e
                                                         x
                                                      
                                                   
                                                   
                                                      v
                                                      0
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         C
                                                         
                                                            13
                                                         
                                                         *
                                                      
                                                      /
                                                      
                                                         C
                                                         
                                                            33
                                                         
                                                         *
                                                      
                                                      −
                                                      
                                                         u
                                                         0
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         C
                                                         
                                                            23
                                                         
                                                         *
                                                      
                                                      /
                                                      
                                                         C
                                                         
                                                            33
                                                         
                                                         *
                                                      
                                                      −
                                                      
                                                         v
                                                         0
                                                      
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              C
                              
                                 ij
                              
                              *
                           
                         the (i,j)-th entry of the dual conic C*.

To the best of our knowledge, (11) is novel and introduced for the first time in this paper. The mapping in (11) is of particular importance as it allows to compute the projected center of the sphere, o
                        
                           s
                        , from the ellipse center, o
                        
                           e
                        , by only knowing the conic and camera parameters and without assuming any knowledge about the sphere’s radius (see Appendix A for more details on the mathematical derivation of (11)).

@&#OVERVIEW@&#

Our calibration method only requires the user to move a spherical object in front of the RGB-D camera for a few seconds. The captured video frames are given in input to the calibration algorithm, as shown in the work-flow diagram of Fig. 3.

The Feature-Extraction Pipeline detects in each frame the ellipses 
                           R
                        
                        C and 
                           D
                        
                        C, which correspond to the projection of the sphere in both the RGB and depth sensors. For a given set of ellipses detected over a certain time frame, our algorithm estimates the intrinsic parameters 
                           D
                        
                        K and 
                           R
                        
                        K, as well as the extrinsic parameters 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 R
                              
                           
                         and 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 t
                              
                           
                        . Additionally, our method also estimates the radial and tangential lens-distortion parameters for both sensors, 
                           
                              
                                 k
                              
                              
                                 c
                              
                              D
                           
                         and 
                           
                              
                                 k
                              
                              
                                 c
                              
                              R
                           
                         
                        [45].

Our calibration method estimates the intrinsic and extrinsic parameters in two steps: first, we leverage the centers of the two ellipses to obtain an initial robust estimate of the RGB-D camera parameters (Initial Calibration). It is worth emphasizing the novelty and importance of this first analytical step: existing approaches require prior knowledge of some of the calibration parameters (either provided by the manufacturer or based on an initial user’s guess). Since these parameters can vary significantly between models or might not be available for generic RGB- and depth-sensor arrangements, relying on such a priori information can easily lead to large errors in the final calibration. In the second phase, these initial parameters are optimized (Nonlinear Minimization) over the recorded images of the sphere. The novelty of this phase consists in adopting the analytic expression presented in Section 2.3 for extracting the projected centers of the sphere from the ellipse centers.


                        Overview: The goal of our feature-extraction pipeline is to automatically detect and track the calibration object at each frame in both the RGB and depth images. When compared to the detection and tracking of corner features in checkerboard-based methods [20,24–26], our pipeline has two major advantages: first, by adopting Hough voting and RANSAC, our method can both discard outliers (such as user’s hand or fingers holding the spherical object) as well as minimize the effect of image noise. Second, our feature-extraction pipeline is completely automatic and can recover from severe occlusions that might occur in non-lab settings. A video showing the feature-extraction pipeline is available at this link.
                           3
                           
                              http://ranger.uta.edu/∼gianluca/research/assistiverobotics_rgbdcalibration.html.
                        
                        
                           3
                        
                     


                        Ellipse detection and tracking in RGB video: For the detection of the ellipse 
                           R
                        
                        C in the RGB image, a search area is first obtained by using a Gaussian mixture-based background-segmentation algorithm [47] that detects the largest motion in the RGB image (see Fig. 4
                        (a)). Spurious motions (e.g., from the person holding the spherical object or image noise) are removed by using erosion and dilation operators, along with a threshold over the motion’s pixel area. Then, the Canny-edge detector [48] is applied to that image portion, and a circular Hough transform [49] is used to obtain the coordinates of those edge pixels belonging to an ellipse (cf., Fig. 4(b)). Note that, even if any other edge detector or voting procedure could have been adopted, we chose the Canny-edge detector and the Hough transform because of their proven efficiency and their real-time implementation in OpenCV. Finally, a RANSAC-based ellipse-fitting algorithm [50,51] is used to reject outliers and to provide a robust estimate of the ellipse, 
                           R
                        
                        C, together with its center, 
                           R
                        
                        o
                        
                           e
                         (cf., Fig. 4(c)). To track the ellipse between subsequent frames, the search area for the next frame is centered at the previous area center, while its major axis is increased of a fixed offset. This simple strategy has proven effective to run in real-time while eliminating the need for background segmentation at every frame.


                        Sphere detection and tracking in depth video: For the detection of the ellipse 
                           D
                        
                        C, adopting the strategy that we have described above for the color image would not work, since the edges in the depth image are highly irregular (cf., Fig. 5
                        (a)). We then first obtain a search area around the largest detected motion by adopting erosion and dilation operators on the binary image from the background-segmentation algorithm [47]. Once the search area has been determined, the associated depth-image pixels are projected into a 3-D point cloud by using (6) with a pre-selected 
                           D
                        
                        K. Even if away from the correct calibration, this pre-selection will only scale the resulting 3-D point cloud (i.e., no skew factor). After this, a Hough voting scheme is used to detect which 3-D points belong to the sphere and to reject the outliers with a RANSAC-based sphere-fitting algorithm. An example is shown in Fig. 5(b) where the hand holding the ball is red since it has been detected as an outlier. Finally, the center of the fitted sphere is reprojected onto the depth image, which then corresponds to the center of the ellipse, 
                           D
                        
                        o
                        
                           e
                         (red dot in Fig. 5(c)) and which will be used in our calibration algorithm. To track the sphere in the depth sensor at each frame, we adopt a strategy analogous to that described above for the RGB camera.

Differently from existing RGB-D calibration methods, our strategy does not require the intervention of an expert user to initialize the calibration parameters. While an initial estimate for 
                           R
                        
                        K can be easily obtained from the detected ellipse 
                           R
                        
                        C by using the method in [34] (see Appendix B for a short overview), the depth and the extrinsic calibration parameters are estimated as described in the following.

By substituting (6) in (4), and by using the pixels position of the sphere centers, (
                           
                              
                                 
                                 D
                              
                              
                                 
                                    o
                                 
                                 
                                    s
                                    i
                                 
                              
                              ,
                              
                                 
                                 R
                              
                              
                                 
                                    o
                                 
                                 
                                    s
                                    i
                                 
                              
                           
                        ), 
                           
                              i
                              =
                              1
                              ,
                              ⋯
                              ,
                              N
                           
                        , obtained from N frames of the calibration video, the following pinhole equation holds true:
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                R
                                             
                                             λ
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                R
                                             
                                             
                                                
                                                   
                                                      o
                                                   
                                                   ∼
                                                
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             =
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                R
                                             
                                             
                                                K
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                   
                                                      D
                                                   
                                                   R
                                                
                                                
                                                   R
                                                
                                                
                                                   
                                                   D
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      0.25
                                                      e
                                                      m
                                                   
                                                   
                                                      0
                                                      e
                                                      x
                                                   
                                                
                                                |
                                                
                                                   
                                                      0.12
                                                      e
                                                      m
                                                   
                                                   
                                                      0
                                                      e
                                                      x
                                                   
                                                
                                                
                                                   
                                                   
                                                      D
                                                   
                                                   R
                                                
                                                
                                                   t
                                                
                                                ]
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                D
                                             
                                             
                                                
                                                   
                                                      o
                                                   
                                                   ¯
                                                
                                                
                                                   s
                                                   i
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        By multiplying both sides of (12) by 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                           
                         and then by multiplying both sides by the skew-symmetric matrix associated to 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                 R
                              
                              
                                 
                                    
                                       o
                                    
                                    ∼
                                 
                                 
                                    s
                                    i
                                 
                              
                           
                         (which removes the unknown scale factor), we obtain the following constraint:
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                      R
                                                   
                                                   
                                                      
                                                         
                                                            K
                                                         
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         0.12
                                                         e
                                                         m
                                                      
                                                      
                                                         0
                                                         e
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                      R
                                                   
                                                   
                                                      
                                                         
                                                            o
                                                         
                                                         ∼
                                                      
                                                      
                                                         s
                                                         i
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   ×
                                                   
                                                
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                
                                                   D
                                                
                                                R
                                             
                                             
                                                M
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                D
                                             
                                             
                                                
                                                   
                                                      o
                                                   
                                                   ¯
                                                
                                                
                                                   s
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   0
                                                
                                                
                                                   3
                                                   ×
                                                   
                                                   1
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                
                                                   D
                                                
                                                R
                                             
                                             
                                                M
                                             
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             ≜
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                               11
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                               12
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                               13
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                               14
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                               21
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                               22
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                               23
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                               24
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                               31
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                               32
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                               33
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                               34
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             =
                                             
                                                [
                                                
                                                   
                                                   
                                                      D
                                                   
                                                   R
                                                
                                                
                                                   R
                                                
                                                
                                                   
                                                   D
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.25
                                                         e
                                                         m
                                                      
                                                      
                                                         0
                                                         e
                                                         x
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         0.12
                                                         e
                                                         m
                                                      
                                                      
                                                         0
                                                         e
                                                         x
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      D
                                                   
                                                   R
                                                
                                                
                                                   t
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        and 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    
                                       o
                                    
                                    ¯
                                 
                                 
                                    s
                                    i
                                 
                              
                              ∈
                              
                                 
                                    IR
                                 
                                 4
                              
                           
                         is obtained from 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    o
                                 
                                 
                                    s
                                    i
                                 
                              
                              ∈
                              
                                 
                                    IR
                                 
                                 3
                              
                           
                        , as 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    u
                                 
                                 ¯
                              
                           
                         in (7).

Eq. (13) can be rewritten as a homogeneous system of two linearly-independent equations of the form:
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                                T
                                             
                                             
                                                m
                                             
                                             =
                                             
                                                
                                                   0
                                                
                                                
                                                   2
                                                   ×
                                                   
                                                   1
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 m
                              
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              ≜
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              
                                 
                                    [
                                    
                                       M
                                       11
                                    
                                    ,
                                    
                                       M
                                       12
                                    
                                    ,
                                    ⋯
                                    ,
                                    
                                       M
                                       34
                                    
                                    ]
                                 
                                 T
                              
                              ∈
                              
                                 
                                    IR
                                 
                                 12
                              
                           
                        , and
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                                T
                                             
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             ≜
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  1
                                                                  ×
                                                                  
                                                                  4
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               −
                                                               
                                                                  
                                                                  D
                                                               
                                                               
                                                                  
                                                                     
                                                                        o
                                                                     
                                                                     ¯
                                                                  
                                                                  
                                                                     
                                                                        s
                                                                        i
                                                                     
                                                                  
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ξ
                                                               
                                                               
                                                                  (
                                                                  2
                                                                  )
                                                               
                                                               
                                                                  
                                                                  D
                                                               
                                                               
                                                                  
                                                                     
                                                                        o
                                                                     
                                                                     ¯
                                                                  
                                                                  
                                                                     
                                                                        s
                                                                        i
                                                                     
                                                                  
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                  D
                                                               
                                                               
                                                                  
                                                                     
                                                                        o
                                                                     
                                                                     ¯
                                                                  
                                                                  
                                                                     
                                                                        s
                                                                        i
                                                                     
                                                                  
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  1
                                                                  ×
                                                                  
                                                                  4
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               −
                                                               
                                                                  ξ
                                                               
                                                               
                                                                  (
                                                                  1
                                                                  )
                                                               
                                                               
                                                                  
                                                                  D
                                                               
                                                               
                                                                  
                                                                     
                                                                        o
                                                                     
                                                                     ¯
                                                                  
                                                                  
                                                                     
                                                                        s
                                                                        i
                                                                     
                                                                  
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           ξ
                        (j) denotes the j-th component of vector 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    0.12
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              
                                 
                                 R
                              
                              
                                 
                                    
                                       o
                                    
                                    ∼
                                 
                                 
                                    s
                                    i
                                 
                              
                           
                        .

Since m has twelve components, the minimum number of equations needed to uniquely solve the homogeneous system in (15) is eleven [45]. Since each pair (
                           
                              
                                 
                                 R
                              
                              
                                 
                                    
                                       o
                                    
                                    ∼
                                 
                                 
                                    e
                                    i
                                 
                              
                              ,
                              
                                 
                                 D
                              
                              
                                 
                                    
                                       o
                                    
                                    ¯
                                 
                                 
                                    e
                                    i
                                 
                              
                           
                        ) provides two linearly-independent constraints, this implies that N > 5, i.e., that a minimum of six RGB-depth image pairs is needed. By stacking (16) into a 
                           
                              2
                              N
                              ×
                              
                              12
                           
                         matrix, A, we obtain the linear system:
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                                m
                                             
                                             =
                                             
                                                
                                                   0
                                                
                                                
                                                   12
                                                   ×
                                                   
                                                   1
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The singular value decomposition (SVD) on A
                        
                           T
                        
                        A is used to obtain the unique non-zero solution to (17), corresponding to the eigenvector with the smallest eigenvalue subject to the constraint that 
                           
                              ∥
                              
                                 m
                              
                              ∥
                              =
                              1
                           
                         
                        [45]. In the case of noisy measurements, the rank will likely be 12 but also in this case, SVD will result in a least-squares solution.

Note that a common issue with Kinect-like sensors is that the accuracy of the depth measurements decreases as the depth increases [23,26]. This issue can affect the overall accuracy of the initial calibration stage. To address this issue, we introduced a weight factor, W, to reduce the influence of spheres observed at larger distances, i.e., those affected by larger noise. Thus, we computed the SVD of A
                        
                           T
                        
                        WA, where W is a diagonal matrix whose diagonal elements are the inverse of the squared distance between the camera and the center of the N spheres.

Once the matrix 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 M
                              
                           
                         has been estimated and normalized (so that 
                           
                              
                                 M
                                 33
                              
                              =
                              1
                           
                        ), its fourth column coincides with 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 t
                              
                           
                        . Moreover, 
                           D
                        
                        K and 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 R
                              
                           
                         are obtained from the QR factorization of the left 
                           
                              3
                              ×
                              
                              3
                           
                         submatrix of 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 M
                              
                           
                        , given by 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 R
                              
                              
                                 
                                 D
                              
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                           
                        . We adopted RANSAC [45] to robustly estimate 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 M
                              
                           
                         while rejecting possible outliers (e.g., blurred frames). In particular, the input to RANSAC is the set of 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    
                                       o
                                    
                                    ∼
                                 
                                 
                                    s
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    
                                       o
                                    
                                    ¯
                                 
                                 
                                    s
                                    i
                                 
                              
                           
                         and the initial 
                           R
                        
                        K. RANSAC randomly selects a set of six points at each iteration to estimate the calibration parameters while using all of the data points as a consensus voting process for the current estimate.

Degenerate cases in solving (17) occur when all the spheres’ centers lie on a common plane or line. While this case is quite rare in practice, we addressed this issue by checking the rank of A.

Data normalization is also necessary to improve the accuracy of our initial estimates and is performed in two steps. First, the set of 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    
                                       o
                                    
                                    ∼
                                 
                                 
                                    s
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    
                                       o
                                    
                                    ¯
                                 
                                 
                                    s
                                    i
                                 
                              
                           
                         is centered at the origin. This is done by subtracting the sample mean from each of the N observed sphere centers. Second, each centers’ pair is uniformly scaled so that their mean distance from the origin equals 
                           
                              2
                           
                        . More details on this normalization can be found in [52].

As mentioned in Section 2.3, it is impossible to know the exact projections of the sphere centers without 
                           D
                        
                        K. However, and by virtue of extensive simulation experiments (see Fig. 6
                        ), we observed that it is possible to approximate the projected sphere centers (
                           D
                        
                        o
                        
                           s
                        ,
                           R
                        
                        o
                        
                           s
                        ) with the measured ellipse centers (
                           D
                        
                        o
                        
                           e
                        ,
                           R
                        
                        o
                        
                           e
                        ). As such, the vector 
                           ξ
                         in (16) can be substituted with 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    0.12
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              
                                 
                                 R
                              
                              
                                 
                                    
                                       o
                                    
                                    ∼
                                 
                                 
                                    e
                                    i
                                 
                              
                           
                        , and 
                           D
                        
                        o
                        
                           s
                         can be substituted with 
                           D
                        
                        o
                        
                           e
                        . In our simulation experiments, we randomly placed 64 spheres within a volume of 4×4×4m in front of the camera. A zero-mean white Gaussian noise with 1pixel standard deviation was added to the image and 100 iterations were performed. The pixel distance between the ellipse center and the projected sphere center was computed as 
                           
                              
                                 ∥
                              
                              
                                 
                                 R
                              
                              
                                 
                                    o
                                 
                                 
                                    e
                                    i
                                 
                              
                              −
                              
                                 
                                 R
                              
                              
                                 
                                    o
                                 
                                 
                                    s
                                    i
                                 
                              
                              
                                 ∥
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 64
                              
                           
                        . Fig. 6 shows that the distance between the ellipse center and the projected sphere center is always less than 1pixel.

Finally, note that in order to obtain the expression for the matrix A (Eqs. (16) and (17)), a knowledge of the sphere’s center z-coordinate ZD
                         is needed. Since this value cannot be obtained without knowing an estimate of 
                           D
                        
                        K, we have empirically observed that an accurate estimate of ZD
                         can be obtained by averaging between the maximum and the median of the z-coordinates of all the visible points on each detected sphere. In averaging the maximum and the median, we are able to also remove possible outliers originated by the background (usually assigned to a zero depth).

In this phase, the initial estimate of the calibration parameters described in Section 3.3 is further improved by means of a maximum-likelihood estimate over all the calibration parameters (intrinsic, extrinsic, and lens distortion).

For a given initial estimate of the camera calibration parameters (
                           R
                        
                        K,
                           D
                        
                        K), the projected center of the sphere, 
                           R
                        
                        o
                        
                           s
                        , is now computed as in (10) and (11), and used in the nonlinear-minimization problem in order to improve the accuracy of the overall calibration.

Consider the pinhole camera model describing the projection of the sphere center (in the depth-sensor frame) into the RGB sensor:
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                R
                                             
                                             λ
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                R
                                             
                                             
                                                
                                                   
                                                      o
                                                   
                                                   ∼
                                                
                                                s
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             =
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                R
                                             
                                             
                                                K
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                   
                                                      D
                                                   
                                                   R
                                                
                                                
                                                   R
                                                
                                                
                                                   
                                                      0.25
                                                      e
                                                      m
                                                   
                                                   
                                                      0
                                                      e
                                                      x
                                                   
                                                
                                                |
                                                
                                                   
                                                      0.12
                                                      e
                                                      m
                                                   
                                                   
                                                      0
                                                      e
                                                      x
                                                   
                                                
                                                
                                                   
                                                   
                                                      D
                                                   
                                                   R
                                                
                                                
                                                   t
                                                
                                                ]
                                             
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                D
                                             
                                             
                                                
                                                   
                                                      O
                                                   
                                                   ∼
                                                
                                                s
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        By assuming that each point in {R} follows a Gaussian distribution with the ground-truth position as its mean and measurement-noise covariance 
                           Φ
                        , the log-likelihood function can be written as:
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                L
                                                1
                                             
                                             =
                                             −
                                             
                                                1
                                                
                                                   2
                                                   N
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                
                                                   ∈
                                                
                                                
                                                   i
                                                
                                                T
                                             
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   ∈
                                                
                                                i
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           ∈
                        
                        
                           i
                         is the pixel reprojection error obtained from (18), by taking into account the lens distortion models introduced in (2) and (3) for both the RGB and depth sensors.

In practice, the covariance 
                           Φ
                         is used to weigh the influence of each residual. We set 
                           Φ
                         to be the identity matrix to allow each residual to have the same importance. A similar choice was done in [24] and this worked excellently in both our simulations and experimental tests.

Another source of useful information comes from the entire conic shape itself. As such, and similarly to (19), the log-likelihood of the conic constraint (9) is:
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                L
                                                2
                                             
                                             =
                                             −
                                             
                                                1
                                                
                                                   2
                                                   N
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                1
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            σ
                                                            
                                                               q
                                                            
                                                            i
                                                         
                                                         )
                                                      
                                                   
                                                   2
                                                
                                             
                                             
                                                ∥
                                                
                                                   
                                                   R
                                                
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      i
                                                   
                                                   *
                                                
                                                −
                                                
                                                   
                                                   
                                                      D
                                                   
                                                   R
                                                
                                                
                                                   P
                                                
                                                
                                                   
                                                   D
                                                
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      i
                                                   
                                                   *
                                                
                                                
                                                   
                                                      
                                                         
                                                         
                                                            D
                                                         
                                                         R
                                                      
                                                      
                                                         P
                                                      
                                                   
                                                   T
                                                
                                                ∥
                                             
                                             
                                                
                                                
                                                   F
                                                
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where ‖ · ‖
                           F
                         denotes the Frobenius norm and the dual quadric 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    Q
                                 
                                 
                                    i
                                 
                                 *
                              
                           
                         is calculated with (8) by using the estimated 3-D center, 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    
                                       O
                                    
                                    ∼
                                 
                                 
                                    s
                                    i
                                 
                              
                           
                        , and radius, 
                           
                              r
                              
                                 s
                                 i
                              
                           
                        , of the i-th sphere computed as described in Section 3.2. Similarly to [22,23], and in order to take into account the decreasing accuracy in the depth measurements at increasing distances typically observed in Kinect-like sensors, the variance 
                           
                              
                                 (
                                 
                                    σ
                                    
                                       q
                                    
                                    i
                                 
                                 )
                              
                              2
                           
                         has been chosen to be a quadratic function of the distance ZD
                         to each sphere, which revealed to be effective.

Combining (19) and (20) together, we maximize the overall log-likelihood as:
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                max
                                                
                                                   
                                                      
                                                      R
                                                   
                                                   
                                                      K
                                                   
                                                   ,
                                                   
                                                      
                                                      D
                                                   
                                                   
                                                      K
                                                   
                                                   ,
                                                   
                                                      
                                                      
                                                         D
                                                      
                                                      R
                                                   
                                                   
                                                      R
                                                   
                                                   ,
                                                   
                                                      
                                                      
                                                         D
                                                      
                                                      R
                                                   
                                                   
                                                      t
                                                   
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         c
                                                      
                                                      R
                                                   
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         c
                                                      
                                                      D
                                                   
                                                
                                             
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                
                                                   0.25
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                ρ
                                                1
                                             
                                             
                                                L
                                                1
                                             
                                             +
                                             
                                                ρ
                                                2
                                             
                                             
                                                L
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where ρ
                        1 and ρ
                        2 are weighting parameters that we use to rescale the log-likelihood functions 
                           
                              L
                              1
                           
                         and 
                           
                              L
                              2
                           
                         so that they have comparable magnitudes. In practice, the positive weight parameters are calculated as 
                           
                              
                                 ρ
                                 i
                              
                              =
                              
                                 ⌈
                                 
                                    log
                                    10
                                 
                                 
                                    (
                                    
                                       L
                                       i
                                    
                                    )
                                 
                                 ⌉
                              
                              ,
                              i
                              =
                              1
                              ,
                              2
                           
                        , which rescales the log-likelihoods to the interval [0,1], where ⌈ · ⌉ denotes the ceiling function.


                        Fig. 7
                         illustrates the work-flow diagram of the Nonlinear Minimization Phase where the inputs are the depth-map points, the initial calibration parameters, and 
                           R
                        
                        C. During the optimization process, 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    
                                       O
                                    
                                    ∼
                                 
                                 
                                    s
                                    i
                                 
                              
                           
                         is re-computed at every iteration because of the iterative estimation of 
                           D
                        
                        K. 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    
                                       O
                                    
                                    ∼
                                 
                                 
                                    s
                                    i
                                 
                              
                           
                         is obtained by using the sphere-fitting RANSAC algorithm described in Section 3.2 where the 3-D point cloud is obtained from the depth-map and the current estimate of 
                           D
                        
                        K. This optimization process continues until a stop criterion (e.g., the difference between the residual error from the previous and the current iteration) is satisfied.

For notational convenience, in this section we will use a “hat” to denote all the estimated variables (thus, e.g., 
                        
                           
                              
                              R
                           
                           
                              
                                 K
                              
                              ^
                           
                        
                      will indicate the estimated intrinsic calibration matrix of the RGB camera).


                        Overview: A simulation scenario has been created to extensively compare the accuracy of our calibration method against the ground truth, over a large set of realizations, and for a controlled and increasing image noise power. In this scenario, a set of spherical calibration objects, evenly spaced within a large cubical volume, has been positioned in front of the camera. This arrangement has been chosen to allow our validation procedure to be repeatable and systematic: comparable results have been obtained with spheres randomly placed within the same cubical space.


                        Increasing noise: In the first test, we examined the performance of our method in the case of increasing image noise (100 iterations for each noise level), while observing 96 spheres. A zero-mean white Gaussian noise with increasing standard deviation was added to the RGB and depth images. The noise standard deviations in both images, 
                           
                              σ
                              
                                 p
                              
                              R
                           
                         and 
                           
                              σ
                              
                                 p
                              
                              D
                           
                        , were chosen in the range from 0 to 1.5pixels. A noise on the depth measurements was also simulated; in order to match existing depth-degradation models for Kinect-like sensors [22,23,26], the standard deviation 
                           
                              σ
                              
                                 m
                              
                              D
                           
                         [m] was chosen as a quadratic function of the distance between each sphere and the RGB-D camera. We also compared the performance of our calibration method against Zhang’s method [24]. Differently from the existing calibration algorithms (cf. Section 4.2), which make use of the Kinect’s depth images (which are difficult to generate with synthetic data), Zhang’s method lends itself to be simulated in MATLAB. To this end, we created a 
                           
                              9
                              ×
                              
                              9
                           
                         calibration checkerboard pattern observed from 36 different viewpoints. Note that since Zhang’s method assumes a given 
                           D
                        
                        K, we used the ground-truth in our tests (even if this might not be available in practice).


                        Fig. 8
                         reports the comparison of the calibration accuracy between our method (left column) and Zhang’s method (right column). Note that non-zero errors are observed with zero pixel noise since our simulations include a non-zero noise affecting depth measurements. In particular, Fig. 8(a) and (b) shows the standard deviation for each of the translation error-vector components, 
                           
                              
                                 e
                              
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              ≜
                              
                                 
                                    0.25
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              
                                 
                                    [
                                    
                                       e
                                       x
                                    
                                    ,
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       e
                                       y
                                    
                                    ,
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       e
                                       z
                                    
                                    ]
                                 
                                 T
                              
                              =
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 
                                    t
                                 
                                 ^
                              
                              −
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 t
                              
                           
                        . We omitted the plots of the mean errors since they were all around zero, thus indicating unbiased estimates for both methods. From the figures, we see that the error for our method is always lower than 1mm on each axis, whereas the error for Zhang’s reaches 1cm for an image noise equal to 1.5pixels. Fig. 8(c) and (d) shows the standard deviation of the estimated rotation (roll-pitch-yaw angles in degrees) between the RGB and depth cameras for the two methods. In this case the estimation error of our algorithm is almost one order of magnitude lower than Zhang’s. Fig. 8(e) and (f) reports the standard deviation of the estimated 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    K
                                 
                                 ^
                              
                           
                         parameters for our method and Zhang’s. Finally, Fig. 8(g) and (h) shows the distribution of the pixel reprojection error when 
                           
                              
                                 σ
                                 
                                    p
                                 
                                 R
                              
                              =
                              
                                 σ
                                 
                                    p
                                 
                                 D
                              
                              =
                              1
                           
                        
                        pixel for 100 realizations. Our calibration method has a reprojection error always lower than 4pixels, which is smaller than that yielded by Zhang’s (10pixels). In conclusion, these results already show the increased accuracy of our method: we believe the use of conic fitting for the initial least-squares calibration is a key player in the reported decreased sensitivity to increasing data noise. As a result, our method is capable of obtaining more accurate estimates of the calibration parameters.


                        Increasing number of spheres: In the second test, reported in Fig. 9
                        , we studied the influence that an increasing number of observed frames (from 6 to 60) of a single moving sphere has on the calibration accuracy. The standard deviation of the Gaussian image noises was fixed to 
                           
                              
                                 σ
                                 
                                    p
                                 
                                 R
                              
                              =
                              
                                 σ
                                 
                                    p
                                 
                                 D
                              
                              =
                              1
                           
                        
                        pixel. For a fixed number of frames, we considered 100 realizations. Fig. 9(a) and (b) reports the standard deviation of the translation and angular error, and shows that 20 images of a sphere are generally sufficient to get a very accurate estimate of the calibration parameters (e.g., resulting in a standard deviation smaller than 1mm for translation).

@&#EXPERIMENTAL RESULTS@&#


                        Overview: We validated the accuracy of our calibration method in two real-world scenarios: the first scenario deals with the calibration of a Microsoft Kinect, while the second of an RGB-ToF sensors-pair (cf., Fig. 14). In particular, we compared against Zhang’s method [24], Herrera’s method [26], the Robot Operating System Kinect Calibration Toolbox (ROSCalTbx) [21], and the Stereo Camera MATLAB Calibration Toolbox (CalTechTbx) [53]. We chose these particular methods because each of them best represents a family of calibration algorithms in terms of the calibration object used, parameters estimated, and ease of use.

Note that our comparison did not include Burrus’s toolbox [19] because of its similarly with the CalTechTbx. As stated in his own webpage [19], Burrus’s Kinect calibration software is an adaptation, for the Kinect, of the OpenCV’s stereo-camera-calibration functions, which are indeed an implementation of the well-known method proposed in [43]. We chose to opt for comparing against the MATLAB CalTechTbx (instead of the OpenCV implementation), because many more research papers cite this toolbox. Note that the method described in [27] is an improvement over [26] which has showed greater accuracy using less checkerboard calibration images and requiring less computational time; however, the method performs with a similar accuracy of [26] when using a large set of calibration images. For this reason, we only included a comparison with [26] since our evaluation focuses on accuracy rather than computational complexity.

As detailed below, a ground-truth set of calibration parameters was obtained by means of the CalTechTbx [53]. While it is very time consuming to use, the CalTechTbx provides highly accurate calibration results, which is why it was adopted as a ground truth.

In what follows, we will first give a brief overview of the aforementioned calibration methods and describe their pros and cons. Then, we will present the calibration results.


                        Our calibration method: For our method, we recorded a video of approximately 30s (∼900frames) by running the sphere-extraction procedure described in Section 3.2. We chose to subsample the video by sampling every 7 frames, for a total of approximately 120 frames.


                        Overview of the other calibration methods: The methods mentioned above differ from ours since they rely on corners extracted from checkerboard calibration panels that are simultaneously observed by the RGB and the depth sensor. Each method uses a set of RGB images of the checkerboard to estimate 
                           R
                        
                        K. The estimation process is very similar across these algorithms and relies on the accuracy of the corner-extraction algorithm. The user is also required in all these methods to specify the geometric properties of the checkerboard (e.g., size and number of squares).
                        
                     

The major difference among [21,24,26,53] is in the acquisition and treatment of data from the depth sensor. Zhang’s method [24] requires the user to select a certain number of points on each checkerboard plane in the depth-map. These points are then converted to 3-D and used to extract the normal to each plane. Herrera’s method [26] is similar to Zhang’s method, but it relies on the disparity image that is used to estimate a depth map. Both the ROSCalTbx [21] and CalTechTbx [53] require the IR image from the Kinect, as well as a time consuming procedure for extracting corresponding corner features in both RGB and IR images. Note that in order to ensure the checkerboard is clearly visible in the IR image, an external (halogen) light must be used to enhance the image contrast, and the IR projector of the Kinect must be covered. Note that these methods are mostly designed for the Kinect since the IR image might not be available in other depth sensors (e.g., those based on the ToF technology). Furthermore, the Kinect does not allow simultaneous acquisition of IR and RGB images. As a result, these calibration methods do not lend themselves to real time, rather to slow, asynchronous data-collection and calibration.


                        Setup of the other calibration methods: For Zhang’s method, we considered a set of 60 RGB-Depth image pairs of a single checkerboard (see Fig. 10(a)). The method requires an initial guess for 
                           D
                        
                        K; for that, we used the preset values in [24]. For both the ROSCalTbx [21] and CalTechTbx [53], we captured a set of 60 RGB-IR image pairs (see Fig. 10(b)). The geometric size of the poster board is 20×20cm while the checkerboard grid size is 2.5×2.5cm.

For Herrera’s method [26], we used a set of 60 RGB-Disparity image pairs of a single checkerboard (see Fig. 10(c)). In order to obtain comparable results, we carefully reproduced the experimental setup described in [26]. This included a poster board of size 1.5×1.0m, and a checkerboard with grid size 5×5cm. As in [26], 20 different poster board orientations were considered in our experiments.


                        Discussion of the results: While the number of images used by each method is different (e.g., in our experiments we used approximately 120 frames while Zhang’s method uses 60 image pairs), the actual number of measurements is lower in our case. In fact, our method considers each image pair of a sphere as 1 measurement for a total of 120 measurements. Instead, all of the other methods use, overall, around 2500 measurements since the checkerboard panel has approximately 50 corners in each of the 60 views. Despite this, in what follows we show that our method compares favorably with competing algorithms.

In the first experiment, we qualitatively compared the calibration parameters obtained by our method with those estimated by the other approaches. To this end, we registered the depth and color information extracted from the observation of a cardboard box on top of a desk. Such a test allows to qualitatively observe the joint effects of all the estimated calibration parameters in co-registering color and depth information. Such a registration is obtained by first mapping the depth image to 3-D using 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    K
                                 
                                 ^
                              
                           
                        , and then each 3-D point is expressed in {R} by means of 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 
                                    R
                                 
                                 ^
                              
                           
                         and 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 
                                    t
                                 
                                 ^
                              
                           
                        . Finally, a color is assigned by projecting this map onto the RGB image with 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    K
                                 
                                 ^
                              
                           
                        . Fig. 11 illustrates the results of this process: it is evident that the accuracy of ROSCalTbx and Zhang’s methods (Fig. 11(b) and (c)) is inferior to that of Herrera’s (Fig. 11(a)) and of our calibration method (Fig. 11(d)).

A quantitative assessment of the performance of each method is reported in Table 2
                        
                        , which shows the estimated calibration parameters (
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 
                                    R
                                 
                                 ^
                              
                           
                        , 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 t
                              
                           
                        , 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    K
                                 
                                 ^
                              
                           
                        , and 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    K
                                 
                                 ^
                              
                           
                        ) obtained by the four approaches under investigation. Note that while Herrera’s, the CalTechTbx, and our method are capable of estimating the lens distortion parameters, we do not report them for homogeneity.

Because of the impossibility to establish a ground truth in this experiment, we considered the results from the CalTechTbx as our ground truth. Indeed, although the CalTechTbx is impractical because of the need for an external light source and because of the time-consuming corner selection procedure, it provides accurate estimates since the RGB-IR calibration is reduced to a classical stereo-camera calibration problem.

The first three columns of Table 2 report 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 
                                    R
                                 
                                 ^
                              
                           
                         expressed as roll 
                           
                              (
                              
                                 
                                    θ
                                    ^
                                 
                                 r
                              
                              )
                           
                        , pitch 
                           
                              (
                              
                                 
                                    θ
                                    ^
                                 
                                 p
                              
                              )
                           
                        , and yaw 
                           
                              (
                              
                                 
                                    θ
                                    ^
                                 
                                 y
                              
                              )
                           
                         angles in degrees. The angles calculated from our method are comparable to those of the CalTechTbx and are consistent with the physical orientation of the depth and RGB sensors in the Kinect. Zhang’s method has an error of ∼4° along the yaw angle, while Herrera’s method, the ROSCalTbx, and our method seem to have a bias between 1° and 3° along the yaw angle with respect to the CalTechTbx. The fourth through the sixth columns of Table 2 report the three coordinates of 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 
                                    t
                                 
                                 ^
                              
                           
                         expressed in meters. The performances of our method and Zhang’s method are similar to those of the CalTechTbx and close to the ground truth for the Kinect sensor. Herrera’s method has an error of 1mm along the x-axis. Our method reports an error of 4mm along the x-axis. The ROSCalTbx estimation of the extrinsic parameters results in a large error (
                           
                              
                                 
                                    t
                                    ^
                                 
                                 y
                              
                              =
                              −
                              2.8
                           
                        
                        cm). The main reason is that the RosCalTbx only uses one RGB-IR image pair for the calibration of the extrinsic parameters. The estimate for the distance between the RGB and depth sensors obtained by our method is the closest to the real one, which is 2.5cm for the Kinect. The seventh through the tenth columns of Table 2 report 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    K
                                 
                                 ^
                              
                           
                         expressed as 
                           
                              
                                 f
                                 ^
                              
                              
                                 u
                              
                              D
                           
                         and 
                           
                              
                                 f
                                 ^
                              
                              
                                 v
                              
                              D
                           
                         for the focal length and 
                           
                              
                                 u
                                 ^
                              
                              
                                 0
                              
                              D
                           
                         and 
                           
                              
                                 v
                                 ^
                              
                              
                                 0
                              
                              D
                           
                         for the principal point. Note that Zhang’s method uses a fixed preset 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    K
                                 
                                 ^
                              
                           
                        , which is not optimized during the iterations. The estimated 
                           
                              
                                 f
                                 ^
                              
                              
                                 u
                              
                              D
                           
                         and 
                           
                              
                                 f
                                 ^
                              
                              
                                 v
                              
                              D
                           
                         for Herrera’s and ROSCalTbx have about 10pixels of error with respect to the CalTechTbx, while our method obtains estimates that are very similar to the CalTechTbx. The last four columns of Table 2 report 
                           
                              
                                 
                                 R
                              
                              
                                 
                                    K
                                 
                                 ^
                              
                           
                         expressed as 
                           
                              
                                 f
                                 ^
                              
                              
                                 u
                              
                              R
                           
                         and 
                           
                              
                                 f
                                 ^
                              
                              
                                 v
                              
                              R
                           
                         for the focal length and 
                           
                              
                                 u
                                 ^
                              
                              
                                 0
                              
                              R
                           
                         and 
                           
                              
                                 v
                                 ^
                              
                              
                                 0
                              
                              R
                           
                         for the principal point.

To further compare all calibration methods, we calculated the pixel reprojection error from a new testing set of common image triplets (RGB-IR-Depth). We captured a checkerboard panel in 30 different views. The checkerboard corners were manually selected in the IR image and the associated depth values were obtained from the depth map for each view. Note that according to [20,23], we had to manually compensate for a fixed offset between the IR image and the depth map (4pixels in both u and v directions). Similarly, each corresponding checkerboard corner was selected in the RGB image. The pixel reprojection error was obtained by substituting (6) into (4). Fig. 12 reports the distribution of the pixel reprojection error (Euclidean norm) for each method. In particular, Fig. 12(a) reports the pixel reprojection error of the CalTechTbx: the mean of the reprojection error is around 3pixels, which can be attributed to the imperfect manual selection of the checkerboard corners. Fig. 12(b)–(e) shows the distribution of the pixel reprojection error for Herrera’s method, ROSCalTbx, Zhang’s method, and our method. When compared to the CalTechTbx, we notice that ROSCalTbx and Zhang’s method perform worse due to the inaccurate estimates of rotation and translation. Herreras’s method performed better, with a mean reprojection error of 3.3pixels. At the same time, our calibration algorithm obtains a slightly lower but statistically equivalent accuracy, corresponding to a mean reprojection error of 3.8pixels.

We also studied the accuracy of 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    K
                                 
                                 ^
                              
                           
                         among all of the calibration methods by computing the estimated radius of an observed sphere. We gathered 120 depth images of a basketball with a varying distance (1–4m) to the camera and the 3-D point cloud was obtained using the depth map and the estimated 
                           D
                        
                        K. Fig. 13
                         shows the basketball’s radius estimated by our method (blue line), Zhang’s (red star line), Herrera’s (green solid line), CalTechTbx (magenta diamond line), ROSCalTbx (cyan square line): the ground-truth (0.1185m) is depicted with a black dotted line. All the algorithms are within 1cm of the ground-truth, which indicates that 
                           
                              
                                 
                                 D
                              
                              
                                 
                                    K
                                 
                                 ^
                              
                           
                        , more precisely the estimated focal length of the depth camera, affects the accuracy of 3-D geometric reconstruction of the object.

In a second experiment, we tested the precision of our method by calibrating a “generic” RGB-Depth sensor consisting of a Swissranger SR-3100 ToF camera [4] and a Logitech HD Pro webcam C910 [54] (see Fig. 14
                        (a)). The other calibration methods could not be used in this scenario since they are only tailored to the Kinect and its unique way of acquiring images. We gathered 145 image pairs of a ball as input to our calibration method. The final estimates of the calibration parameters were: 
                           
                              
                                 
                                    θ
                                    ^
                                 
                                 r
                              
                              =
                              0.55
                           
                        °, 
                           
                              
                                 
                                    θ
                                    ^
                                 
                                 p
                              
                              =
                              −
                              1.83
                           
                        °, and 
                           
                              
                                 
                                    θ
                                    ^
                                 
                                 y
                              
                              =
                              91.12
                           
                        ° for 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 
                                    R
                                 
                                 ^
                              
                           
                         and 
                           
                              
                                 
                                 
                                    D
                                 
                                 R
                              
                              
                                 
                                    t
                                 
                                 ^
                              
                              =
                              
                                 
                                    [
                                    0.0005
                                    ,
                                    0.0454
                                    ,
                                    0.0133
                                    ]
                                 
                                 T
                              
                           
                         in meters.
                           4
                           For the other calibration parameters: 
                                 
                                    
                                       
                                       R
                                    
                                    
                                       
                                          K
                                       
                                       ^
                                    
                                 
                               is given by 
                                 
                                    
                                       
                                          f
                                          ^
                                       
                                       
                                          u
                                       
                                       R
                                    
                                    =
                                    524.2
                                 
                              
                              pixels, 
                                 
                                    
                                       
                                          f
                                          ^
                                       
                                       
                                          v
                                       
                                       R
                                    
                                    =
                                    513.8
                                 
                              
                              pixels, 
                                 
                                    
                                       
                                          u
                                          ^
                                       
                                       
                                          0
                                       
                                       R
                                    
                                    =
                                    320.1
                                 
                              
                              pixels, and 
                                 
                                    
                                       
                                          v
                                          ^
                                       
                                       
                                          0
                                       
                                       R
                                    
                                    =
                                    237.1
                                 
                              
                              pixels, and 
                                 
                                    
                                       
                                       D
                                    
                                    
                                       
                                          K
                                       
                                       ^
                                    
                                 
                               is given by 
                                 
                                    
                                       
                                          f
                                          ^
                                       
                                       
                                          u
                                       
                                       D
                                    
                                    =
                                    218.2
                                 
                              
                              pixels, 
                                 
                                    
                                       
                                          f
                                          ^
                                       
                                       
                                          v
                                       
                                       D
                                    
                                    =
                                    222.1
                                 
                              
                              pixels, 
                                 
                                    
                                       
                                          u
                                          ^
                                       
                                       
                                          0
                                       
                                       D
                                    
                                    =
                                    65.8
                                 
                              
                              pixels, and 
                                 
                                    
                                       
                                          v
                                          ^
                                       
                                       
                                          0
                                       
                                       D
                                    
                                    =
                                    75.6
                                 
                              
                              pixels.
                        
                        
                           4
                         From the camera setup we indeed observe the yaw estimate to be accurate, since the webcam was rotated of 90° with respect to the Swissranger.

For a final qualitative evaluation, and similarly to what was done in Fig. 11, we visualized the textured point cloud of a cardboard box on a table as shown in Fig. 15
                        . As it is evident in the figure, the application of our method resulted in a very good alignment of the texture on top of the point cloud. This shows the flexibility of our calibration method, which is not restricted to the special features of the Kinect and is applicable to other RGB-D sensors.

@&#CONCLUSIONS AND FUTURE WORK@&#

In this work, we have presented a novel and easy-to-use calibration method for RGB-D cameras, which utilizes the image projection of a sphere (observed from multiple viewpoints) as the only calibration object. Our method relies on a novel closed-form solution for the calibration of the depth sensor, which is used to accurately initialize a nonlinear minimization strategy, providing a refined estimate of all the calibration parameters of the RGB-D camera (including lens distortion). The proposed algorithm is practical, since it does not need any user intervention in extracting the image features when compared to the existing checkerboard-based calibration methods, robust to outliers, and flexible since it works with generic arrangements of the color and depth cameras. Extensive simulation and real-world experiments validate our algorithm. A MATLAB toolbox implementing our method has been developed, and it has been made freely available for the research community.

In future research we would like to adapt our method for the simultaneous calibration of a rig of RGB-D cameras, for which no algorithm exists in the literature to our knowledge. We also aim at showing that our calibration method can improve the localization accuracy of a mobile robot equipped with a RGB-D sensor, with respect to the non-calibrated case. Finally, as far as the Kinect sensor is concerned, we plan to extend our algorithm to include other calibration parameters such as the disparity-to-depth parameters [23,24,26] used to transform the disparity image to the depth map. These parameters are important as they can dictate the distance calculated for each pixel in the depth map.

An important element of our calibration algorithm is the closed-form estimate of the projected sphere center, 
                        R
                     
                     o
                     
                        s
                     , in (11), which uses the ellipse center, 
                        R
                     
                     o
                     
                        e
                     , and the intrinsic calibration matrix, 
                        R
                     
                     K. Assuming that both the quadric 
                        R
                     
                     Q and the conic 
                        R
                     
                     C are expressed in {R}, we obtain:
                        
                           (A.22)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                             R
                                          
                                          
                                             
                                                
                                                   C
                                                
                                             
                                             *
                                          
                                          =
                                          
                                             P
                                          
                                          
                                             
                                                0.25
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          
                                             
                                             R
                                          
                                          
                                             
                                                
                                                   Q
                                                
                                             
                                             *
                                          
                                          
                                             
                                                0.12
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             T
                                          
                                          
                                             
                                                1
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          
                                             where
                                          
                                          
                                             
                                                1
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          
                                             
                                                0.12
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          
                                             
                                                0.35
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          
                                             P
                                          
                                          
                                             
                                                0.25
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          ≜
                                          
                                             
                                                0.25
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          
                                             
                                             R
                                          
                                          
                                             K
                                          
                                          
                                             [
                                             
                                                
                                                   I
                                                
                                                3
                                             
                                             |
                                             
                                                
                                                   0
                                                
                                                
                                                   3
                                                   ×
                                                   
                                                   1
                                                
                                             
                                             ]
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The dual conic, 
                        R
                     
                     C*, can be written as:
                        
                           (A.23)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                            
                                                               12
                                                            
                                                            *
                                                         
                                                         =
                                                         
                                                            u
                                                            
                                                               0
                                                            
                                                            R
                                                         
                                                         
                                                            v
                                                            
                                                               0
                                                            
                                                            R
                                                         
                                                         
                                                            (
                                                            
                                                               r
                                                               
                                                                  s
                                                               
                                                               2
                                                            
                                                            −
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        Z
                                                                     
                                                                     R
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            
                                                               X
                                                            
                                                            R
                                                         
                                                         
                                                            
                                                               Y
                                                            
                                                            R
                                                         
                                                         
                                                            f
                                                            
                                                               u
                                                            
                                                            R
                                                         
                                                         
                                                            f
                                                            
                                                               v
                                                            
                                                            R
                                                         
                                                         −
                                                         
                                                            
                                                               Y
                                                            
                                                            R
                                                         
                                                         
                                                            
                                                               Z
                                                            
                                                            R
                                                         
                                                         
                                                            f
                                                            
                                                               v
                                                            
                                                            R
                                                         
                                                         
                                                            u
                                                            
                                                               0
                                                            
                                                            R
                                                         
                                                         −
                                                         
                                                            
                                                               X
                                                            
                                                            R
                                                         
                                                         
                                                            
                                                               Z
                                                            
                                                            R
                                                         
                                                         
                                                            f
                                                            
                                                               u
                                                            
                                                            R
                                                         
                                                         
                                                            v
                                                            
                                                               0
                                                            
                                                            R
                                                         
                                                         ,
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                            
                                                               13
                                                            
                                                            *
                                                         
                                                         =
                                                         
                                                            u
                                                            
                                                               0
                                                            
                                                            R
                                                         
                                                         
                                                            (
                                                            
                                                               r
                                                               
                                                                  s
                                                               
                                                               2
                                                            
                                                            −
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        Z
                                                                     
                                                                     R
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            
                                                               X
                                                            
                                                            R
                                                         
                                                         
                                                            
                                                               Z
                                                            
                                                            R
                                                         
                                                         
                                                            f
                                                            
                                                               u
                                                            
                                                            R
                                                         
                                                         ,
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                            
                                                               22
                                                            
                                                            *
                                                         
                                                         =
                                                         
                                                            v
                                                            
                                                               0
                                                            
                                                            R
                                                         
                                                         
                                                            (
                                                            
                                                               r
                                                               
                                                                  s
                                                               
                                                               2
                                                            
                                                            −
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        Z
                                                                     
                                                                     R
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            
                                                               Y
                                                            
                                                            R
                                                         
                                                         
                                                            
                                                               Z
                                                            
                                                            R
                                                         
                                                         
                                                            f
                                                            
                                                               v
                                                            
                                                            R
                                                         
                                                         ,
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            C
                                                            
                                                               33
                                                            
                                                            *
                                                         
                                                         =
                                                         
                                                            r
                                                            
                                                               s
                                                            
                                                            2
                                                         
                                                         −
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     Z
                                                                  
                                                                  R
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           C
                           
                              ij
                           
                           *
                        
                      is the (i,j)-th entry of 
                        R
                     
                     C*,XR,YR,ZR
                      are the components of the 3-D center 
                        R
                     
                     O
                     
                        s
                     , and rs
                      is the sphere radius. From [35], 
                        
                           
                              
                              R
                           
                           γ
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           ≜
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           
                              
                                 (
                                 
                                    r
                                    s
                                 
                                 /
                                 Z
                                 
                                    
                                    R
                                 
                                 )
                              
                              2
                           
                        
                      can be rewritten as:
                        
                           (A.24)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                             R
                                          
                                          γ
                                          =
                                          1
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                         
                                                            12
                                                         
                                                         *
                                                      
                                                      −
                                                      
                                                         C
                                                         
                                                            13
                                                         
                                                         *
                                                      
                                                      
                                                         v
                                                         
                                                            0
                                                         
                                                         R
                                                      
                                                      −
                                                      
                                                         C
                                                         
                                                            23
                                                         
                                                         *
                                                      
                                                      
                                                         u
                                                         
                                                            0
                                                         
                                                         R
                                                      
                                                   
                                                   
                                                      C
                                                      
                                                         33
                                                      
                                                      *
                                                   
                                                
                                                +
                                                
                                                   u
                                                   
                                                      0
                                                   
                                                   R
                                                
                                                
                                                   v
                                                   
                                                      0
                                                   
                                                   R
                                                
                                             
                                             
                                                α
                                                β
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where
                        
                           
                              
                                 α
                                 
                                    
                                       0.25
                                       e
                                       m
                                    
                                    
                                       0
                                       e
                                       x
                                    
                                 
                                 ≜
                                 
                                    
                                       0.25
                                       e
                                       m
                                    
                                    
                                       0
                                       e
                                       x
                                    
                                 
                                 
                                    
                                       C
                                       
                                          13
                                       
                                       *
                                    
                                    
                                       C
                                       
                                          33
                                       
                                       *
                                    
                                 
                                 −
                                 
                                    u
                                    
                                       0
                                    
                                    R
                                 
                                 ,
                                 
                                    
                                       1
                                       e
                                       m
                                    
                                    
                                       0
                                       e
                                       x
                                    
                                 
                                 β
                                 
                                    
                                       0.25
                                       e
                                       m
                                    
                                    
                                       0
                                       e
                                       x
                                    
                                 
                                 ≜
                                 
                                    
                                       0.25
                                       e
                                       m
                                    
                                    
                                       0
                                       e
                                       x
                                    
                                 
                                 
                                    
                                       C
                                       
                                          23
                                       
                                       *
                                    
                                    
                                       C
                                       
                                          33
                                       
                                       *
                                    
                                 
                                 −
                                 
                                    v
                                    
                                       0
                                    
                                    R
                                 
                                 .
                              
                           
                        
                     
                  

In the case that 
                        
                           α
                           =
                           0
                        
                      and 
                        
                           β
                           =
                           0
                        
                     , then the sphere is positioned directly in front of the camera (i.e., 
                        
                           
                              
                                 X
                              
                              R
                           
                           =
                           0
                        
                      and 
                        
                           
                              
                                 Y
                              
                              R
                           
                           =
                           0
                        
                     ), and the projected center of the sphere has coordinates 
                        
                           (
                           
                              u
                              
                                 0
                              
                              R
                           
                           ,
                           
                              v
                              
                                 0
                              
                              R
                           
                           )
                        
                     , i.e., 
                        
                           
                              
                              R
                           
                           γ
                           =
                           1
                        
                     . When 
                        
                           α
                           =
                           0
                        
                      and 
                        
                           β
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           ≠
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           0
                        
                     , then the sphere 3-D center lies along the camera y-axis, (i.e., 
                        
                           
                              
                                 X
                              
                              R
                           
                           =
                           0
                        
                     ). In this case, the projected center of the sphere has u-coordinate 
                        
                           u
                           
                              0
                           
                           R
                        
                     , while its v-coordinate can be obtained from (10) by means of (A.23) with 
                        
                           
                              
                                 X
                              
                              R
                           
                           =
                           0
                        
                     , as follows:
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                                
                                                   11
                                                
                                                *
                                             
                                             =
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                r
                                                
                                                   s
                                                
                                                2
                                             
                                             
                                                
                                                   (
                                                   
                                                      f
                                                      
                                                         u
                                                      
                                                      R
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                u
                                                
                                                   0
                                                
                                                R
                                             
                                             
                                                (
                                                
                                                   r
                                                   
                                                      s
                                                   
                                                   2
                                                
                                                −
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            Z
                                                         
                                                         R
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                C
                                                
                                                   13
                                                
                                                *
                                             
                                             =
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                u
                                                
                                                   0
                                                
                                                R
                                             
                                             
                                                (
                                                
                                                   r
                                                   
                                                      s
                                                   
                                                   2
                                                
                                                −
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            Z
                                                         
                                                         R
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                C
                                                
                                                   33
                                                
                                                *
                                             
                                             =
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                r
                                                
                                                   s
                                                
                                                2
                                             
                                             −
                                             
                                                
                                                   (
                                                   
                                                      
                                                         Z
                                                      
                                                      R
                                                   
                                                   )
                                                
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     from which
                        
                           
                              
                                 
                                    
                                    R
                                 
                                 γ
                                 =
                                 1
                                 −
                                 
                                    
                                       
                                          
                                             (
                                             
                                                f
                                                
                                                   u
                                                
                                                R
                                             
                                             )
                                          
                                          2
                                       
                                       
                                          C
                                          
                                             33
                                          
                                          *
                                       
                                    
                                    
                                       
                                          C
                                          
                                             11
                                          
                                          *
                                       
                                       −
                                       
                                          C
                                          
                                             13
                                          
                                          *
                                       
                                       
                                          u
                                          
                                             0
                                          
                                          R
                                       
                                    
                                 
                                 .
                              
                           
                        
                     An analogous result is found when 
                        
                           α
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           ≠
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           0
                        
                      and 
                        
                           β
                           =
                           0
                        
                     .

The RGB calibration method in [34] is used to estimate 
                        R
                     
                     K from at least three images of a sphere by using the image of the absolute conic (IAC) defined as 
                        
                           
                              ω
                           
                           =
                           
                              
                              R
                           
                           
                              
                                 
                                    K
                                 
                              
                              
                                 −
                                 T
                              
                           
                           
                              
                              R
                           
                           
                              
                                 
                                    K
                                 
                              
                              
                                 −
                                 1
                              
                           
                        
                     . The IAC, 
                        ω
                     , satisfies the orthogonal constraint 
                        
                           
                              l
                           
                           =
                           
                              ω
                           
                           
                              v
                           
                        
                     , where v is a vanishing point and l is a vanishing line [45] which can be determined from the eigenvectors of the homography conic [34] defined as:
                        
                           (A.25)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                             R
                                          
                                          
                                             H
                                          
                                          =
                                          
                                             
                                             R
                                          
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                             R
                                          
                                          
                                             
                                                C
                                             
                                             
                                                j
                                             
                                             *
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           i
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           ≠
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           j
                           ,
                           i
                           ,
                           j
                           =
                           1
                           ,
                           ⋯
                           ,
                           N
                        
                     . In particular, the vanishing line l is obtained as the eigenvector of 
                        R
                     
                     H corresponding to a line passing through the center of both conics. Instead, the vanishing point, v, is given by the cross product of the remaining two eigenvectors. From the orthogonal constraint, a homogeneous equation is readily obtained as 
                        
                           
                              
                                 [
                                 
                                    l
                                 
                                 ]
                              
                              
                                 ×
                                 
                              
                           
                           
                              ω
                           
                           
                              v
                           
                           =
                           
                              
                                 0
                              
                              
                                 3
                                 ×
                                 
                                 1
                              
                           
                        
                      where 
                        
                           
                              [
                              
                                 x
                              
                              ]
                           
                           
                              ×
                              
                           
                        
                      denotes the skew-symmetric matrix associated to a vector x ∈ IR
                     3. Then 
                        R
                     
                     K can be estimated by using the DLT method [45]. A check on the rank of the resulting homogeneous system rules out degenerate cases (e.g., conic centers close to each other).

@&#REFERENCES@&#

