@&#MAIN-TITLE@&#The exact Gaussian likelihood estimation of time-dependent VARMA models

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider VARMA models with time-dependent coefficients.


                        
                        
                           
                           These coefficients and the error variance can be deterministic functions of time.


                        
                        
                           
                           We present an efficient algorithm for computing their exact Gaussian likelihood.


                        
                        
                           
                           It is based on an algorithm for traditional VARMA models.


                        
                        
                           
                           An illustration on financial data is provided.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Vector VARMA

Time-varying models

Cholesky decomposition method

@&#ABSTRACT@&#


               
               
                  An algorithm for the evaluation of the exact Gaussian likelihood of an 
                        r
                     -dimensional vector autoregressive-moving average (VARMA) process of order (
                        p
                     , 
                        q
                     ), with time-dependent coefficients, including a time dependent innovation covariance matrix, is proposed. The elements of the matrices of coefficients and those of the innovation covariance matrix are deterministic functions of time and assumed to depend on a finite number of parameters. These parameters are estimated by maximizing the Gaussian likelihood function. The advantages of that approach is that the Gaussian likelihood function can be computed exactly and efficiently. The algorithm is based on the Cholesky decomposition method for block-band matrices. It is shown that the number of operations as a function of 
                        p
                     , 
                        q
                      and 
                        n
                     , the size of the series, is barely doubled with respect to a VARMA model with constant coefficients. A detailed description of the algorithm followed by a data example is provided.
               
            

@&#INTRODUCTION@&#

Let 
                        
                           {
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                           :
                           t
                           ∈
                           
                              Z
                           
                           }
                        
                      be an 
                        r
                     -vector valued time series. We assume that 
                        
                           
                              x
                           
                           
                              t
                           
                        
                      follows the time dependent vector autoregressive moving average process of order (
                        p
                        ,
                        q
                     ), in short tdVARMA(
                        p
                        ,
                        q
                     ), defined by the following equations: 
                        
                           
                              (1.1)
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       t
                                       ,
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       t
                                       −
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                           
                              (1.2)
                              
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       t
                                       −
                                       j
                                    
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       t
                                       −
                                       j
                                    
                                 
                                 ,
                              
                           
                        
                      where 
                        p
                      and 
                        q
                      are positive integer constants, the coefficients 
                        
                           
                              A
                           
                           
                              t
                              ,
                              i
                           
                        
                        ,
                        i
                        =
                        1
                        ,
                        …
                        ,
                        p
                      and 
                        
                           
                              B
                           
                           
                              t
                              ,
                              j
                           
                        
                        ,
                        j
                        =
                        1
                        ,
                        …
                        ,
                        q
                     , and 
                        
                           
                              g
                           
                           
                              t
                           
                        
                     , are 
                        r
                        ×
                        r
                      matrices and their elements are deterministic functions of time and assumed to depend on a finite number of parameters, and the 
                        
                           
                              ϵ
                           
                           
                              t
                           
                        
                     ’s are independent Gaussian 
                        r
                     -dimensional random variables, with zero mean and a positive definite covariance matrix 
                        Σ
                     . A stochastic equation like (1.1)–(1.2) requires initial conditions. They will be presented later in Section  3. The vector of parameters of interest 
                        θ
                        =
                        
                           (
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                           )
                        
                      belongs to an open set 
                        Θ
                        ⊂
                        
                           
                              
                                 R
                              
                           
                           
                              m
                           
                        
                     . 
                        Σ
                      is considered as a nuisance parameter. In the following we use 
                        
                           
                           
                              T
                           
                        
                      and 
                        det
                        
                           (
                           .
                           )
                        
                      as the transpose and the determinant, respectively. If the 
                        
                           
                              A
                           
                           
                              t
                              ,
                              i
                           
                        
                     ’s, 
                        
                           
                              B
                           
                           
                              t
                              ,
                              j
                           
                        
                     ’s, and 
                        
                           
                              g
                           
                           
                              t
                           
                        
                      do not depend on 
                        t
                     , then 
                        
                           
                              g
                           
                           
                              t
                           
                        
                      can be omitted and the data generating process is the classical VARMA process of order (
                        p
                        ,
                        q
                     ), e.g. Reinsel (1998) or Lütkepohl (2005), where the standard stationarity, invertibility and identifiability conditions are stated. By the way, Lütkepohl (2005, Chapter 17) covers the tdVAR(
                        p
                     ) processes. When 
                        r
                        =
                        1
                     , we are in the case of classical ARMA processes. Note that tdARMA processes have been more deeply studied in the literature, see references in Azrak and Mélard (2006), than tdVARMA processes. Presence of 
                        
                           
                              g
                           
                           
                              t
                           
                        
                      allows for (unconditional) heteroscedasticity. Note that some recent papers deal with time-varying models using a Bayesian approach (Triantafyllopoulos and Nason, 2007), periodic coefficients (Hindrayanto et al., 2010), or focusing on tests (Chen and Hsu, 2014).

In principle, Eq. (1.1) should contain an intercept term or a deterministic trend. This has not been done here in order to simplify the related estimation algorithms. It is assumed that the possibly time-dependent mean has been subtracted prior to estimation. There would be no problem to estimate these trend parameters simultaneously with the tdVARMA parameters.

Now consider a sample size 
                        n
                      and let the 
                        n
                        r
                        ×
                        1
                      vector 
                        x
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                           
                           
                              T
                           
                        
                      be an observed time series of the process defined in (1.1)–(1.2) from which we want to estimate 
                        θ
                     . The likelihood function is a density function evaluated as a function of the parameters and 
                        x
                     . It is given by 
                        
                           (1.3)
                           
                              L
                              
                                 (
                                 θ
                                 ;
                                 x
                                 )
                              
                              =
                              
                                 
                                    
                                       (
                                       2
                                       π
                                       )
                                    
                                 
                                 
                                    −
                                    n
                                    r
                                    /
                                    2
                                 
                              
                              det
                              
                                 
                                    
                                       (
                                       S
                                       )
                                    
                                 
                                 
                                    −
                                    1
                                    /
                                    2
                                 
                              
                              exp
                              
                                 (
                                 −
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 x
                                 )
                              
                              ,
                           
                        
                      with 
                        S
                        =
                        
                           
                              
                                 cov
                              
                           
                           
                              θ
                           
                        
                        
                        
                           (
                           x
                           )
                        
                      the 
                        n
                        r
                        ×
                        n
                        r
                      covariance matrix of 
                        x
                     . Mélard (1982) showed in the scalar case, 
                        r
                        =
                        1
                     , how to use the Cholesky decomposition method to obtain the exact likelihood of an ARMA process with time dependent coefficients. Azrak and Mélard (1998) developed an algorithm based on the Kalman filter. In this article we show in detail how to compute efficiently the exact likelihood (1.3) by a generalization of Mélard (1982) to the multivariate case. The idea is to transform 
                        x
                      into another vector 
                        w
                      such that the matrix 
                        S
                      is transformed into a block band matrix depicted in Eqs. (3.2) and (3.3). The block band structure allows for an efficient evaluation of the likelihood. This is done by modifying an algorithm for standard VARMA models, i.e. with constant coefficients, developed by Jónasson and Ferrando (2008). The submatrices in (3.2) and (3.3) were used in that article without the first subscript. Consequently our paper is also a generalization of that algorithm to models with time-dependent coefficients using the Matlab implementation of Jónasson (2008).

The asymptotic properties of the estimation methods are the subject of ongoing work. The Gaussian specification is not a restriction. Indeed, the properties are valid for other distributions provided some assumptions are satisfied, such as existence of 8th-order moments. Note also that identifiability conditions should be verified on 
                        
                           
                              Σ
                           
                           
                              t
                           
                        
                        =
                        
                           
                              g
                           
                           
                              t
                           
                        
                        Σ
                        
                           
                              g
                           
                           
                              t
                           
                           
                              T
                           
                        
                     , the covariance matrix of 
                        
                           
                              g
                           
                           
                              t
                           
                        
                        
                           
                              ϵ
                           
                           
                              t
                           
                        
                     . Here we impose that the non-zero elements 
                        
                           (
                           i
                           ,
                           j
                           )
                        
                      of 
                        
                           
                              g
                           
                           
                              t
                           
                        
                      are such that 
                        
                           
                              ∏
                           
                           
                              t
                              =
                              1
                           
                           
                              n
                           
                        
                        
                           
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                           
                           
                              i
                              j
                           
                        
                        =
                        1
                     . Alternatively, a parametrization of 
                        
                           
                              Σ
                           
                           
                              t
                           
                        
                      can be used. 
                        Example 1.1
                        For simplicity, we consider the following tdVMA(1) model with 
                              r
                              =
                              2
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          B
                                       
                                       
                                          t
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          g
                                       
                                       
                                          t
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          ϵ
                                       
                                       
                                          t
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          g
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          ϵ
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    B
                                 
                                 
                                    t
                                    ,
                                    1
                                 
                              
                           , 
                              
                                 
                                    g
                                 
                                 
                                    t
                                 
                              
                            and 
                              Σ
                            are given by 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      t
                                                      ,
                                                      1
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  11
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  12
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  21
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  22
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   −
                                                   
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  11
                                                               
                                                               
                                                                  ″
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  12
                                                               
                                                               
                                                                  ″
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  21
                                                               
                                                               
                                                                  ″
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  22
                                                               
                                                               
                                                                  ″
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      t
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            exp
                                                            
                                                               {
                                                               
                                                                  
                                                                     
                                                                        
                                                                           η
                                                                        
                                                                        
                                                                           11
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     n
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  t
                                                                  −
                                                                  
                                                                     
                                                                        n
                                                                        +
                                                                        1
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                               
                                                               }
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            exp
                                                            
                                                               {
                                                               
                                                                  
                                                                     
                                                                        
                                                                           η
                                                                        
                                                                        
                                                                           22
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     n
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  t
                                                                  −
                                                                  
                                                                     
                                                                        n
                                                                        +
                                                                        1
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                and
                                                
                                                Σ
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            Then, the vector of the parameters to be estimated is 
                              
                                 
                                    θ
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   B
                                                
                                                
                                                   11
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   B
                                                
                                                
                                                   12
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   B
                                                
                                                
                                                   21
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   B
                                                
                                                
                                                   22
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   B
                                                
                                                
                                                   11
                                                
                                                
                                                   ″
                                                
                                             
                                             ,
                                             
                                                
                                                   B
                                                
                                                
                                                   12
                                                
                                                
                                                   ″
                                                
                                             
                                             ,
                                             
                                                
                                                   B
                                                
                                                
                                                   21
                                                
                                                
                                                   ″
                                                
                                             
                                             ,
                                             
                                                
                                                   B
                                                
                                                
                                                   22
                                                
                                                
                                                   ″
                                                
                                             
                                             ,
                                             
                                                
                                                   η
                                                
                                                
                                                   11
                                                
                                             
                                             ,
                                             
                                                
                                                   η
                                                
                                                
                                                   22
                                                
                                             
                                             )
                                          
                                       
                                       
                                          T
                                       
                                    
                                    .
                                 
                              
                           
                        


                     Example 1.1 can be considered as a vector generalization of the tdMA(1) univariate process given in Azrak and Mélard (2006, Example 4). Here the coefficients depend also on the length 
                        n
                      of the series but this has no effect on the algorithm.

We consider a zero mean 
                           r
                        -dimensional Gaussian VARMA(
                           p
                           ,
                           q
                        ) process, which satisfies the following equation and can be considered as a special case of (1.1) and (1.2): 
                           
                              (2.1)
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       t
                                       −
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       ϵ
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       t
                                       −
                                       j
                                    
                                 
                                 ,
                              
                           
                         where the matrices 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 A
                              
                              
                                 p
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 B
                              
                              
                                 q
                              
                           
                         are of dimension 
                           r
                           ×
                           r
                         and the 
                           
                              
                                 ϵ
                              
                              
                                 t
                              
                           
                        ’s are like in Section  1. Let us denote by 
                           θ
                         the 
                           
                              (
                              p
                              +
                              q
                              )
                           
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                        -dimensional vector of all the parameters to be estimated except for 
                           Σ
                        . In our context, we consider 
                           Σ
                         as a nuisance parameter, not as a parameter of interest. We assume stationarity and invertibility, which require that 
                           
                              (2.2)
                              
                                 det
                                 
                                    {
                                    A
                                    
                                       (
                                       z
                                       )
                                    
                                    }
                                 
                                 ≠
                                 0
                                 ,
                                 
                                 det
                                 
                                    {
                                    B
                                    
                                       (
                                       z
                                       )
                                    
                                    }
                                 
                                 ≠
                                 0
                                 ,
                                 
                                 ∀
                                 z
                                 ∈
                                 
                                    C
                                 
                                 ,
                                   such that  
                                 
                                    |
                                    z
                                    |
                                 
                                 ≤
                                 1
                                 ,
                              
                           
                         where 
                           A
                           
                              (
                              z
                              )
                           
                           =
                           
                              
                                 I
                              
                              
                                 r
                              
                           
                           −
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           z
                           −
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           
                              
                                 z
                              
                              
                                 2
                              
                           
                           −
                           ⋯
                           −
                           
                              
                                 A
                              
                              
                                 p
                              
                           
                           
                              
                                 z
                              
                              
                                 p
                              
                           
                        , 
                           B
                           
                              (
                              z
                              )
                           
                           =
                           
                              
                                 I
                              
                              
                                 r
                              
                           
                           +
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           z
                           +
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           
                              
                                 z
                              
                              
                                 2
                              
                           
                           +
                           ⋯
                           +
                           
                              
                                 B
                              
                              
                                 q
                              
                           
                           
                              
                                 z
                              
                              
                                 q
                              
                           
                        , 
                           
                              
                                 I
                              
                              
                                 r
                              
                           
                         is the identity 
                           r
                           ×
                           r
                         matrix. There are also conditions for identifiability, see e.g. Hannan and Deistler (1988) and Caines (1988). Under these conditions a single model is selected from a set of models that are likelihood equivalent. The likelihood function is given by an expression similar to (1.3), where 
                           S
                         has a simpler form than in Section  1, to be discussed below, and the log-likelihood function of (2.1) is given by 
                           
                              (2.3)
                              
                                 l
                                 
                                    (
                                    θ
                                    ;
                                    x
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    [
                                    n
                                    r
                                    log
                                    
                                       (
                                       2
                                       π
                                       )
                                    
                                    +
                                    log
                                    
                                       {
                                       det
                                       
                                          (
                                          S
                                          )
                                       
                                       }
                                    
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    x
                                    ]
                                 
                                 .
                              
                           
                         The evaluation of (2.3) requires computing both the inverse and the determinant of the symmetric matrix 
                           S
                        , hence the number of multiplications by direct evaluation is roughly proportional to 
                           
                              
                                 
                                    (
                                    n
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 3
                              
                           
                        . Some algorithms were developed to reduce substantially the computational effort, e.g. Shea (1984, 1989), Penzer and Shea (1997) via a Kalman filter and Mauricio (2002), Jónasson and Ferrando (2008) via the Cholesky decomposition method. We present an algorithm based on a Cholesky factorization of a block band matrix instead of the block matrix 
                           S
                        , like in Jónasson and Ferrando (2008). For other references, see Jónasson and Ferrando (2008). Related references are also Mauricio (2006) and Mélard et al. (2006). In the latter paper, VARMA models in echelon form are handled by maximum likelihood. In principle, this can also be done in the present context.


                        Ansley (1979) has obtained a band covariance matrix for a univariate ARMA model, which enables a simple Cholesky decomposition and computationally efficient evaluation of the likelihood. Mauricio (2002) has adapted Ansley’s algorithm to the multivariate case and argues that it is more efficient for likelihood evaluation than the Kalman filter methods. The fundamental device used by Ansley is a transformation from 
                           x
                         to a vector of random variables 
                           
                              
                                 z
                              
                              
                                 t
                              
                           
                         defined as follows: 
                           
                              (2.4)
                              
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             for  
                                             t
                                             ≤
                                             
                                                
                                                   s
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                             −
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   p
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                   −
                                                   i
                                                
                                             
                                          
                                          
                                             for  
                                             t
                                             =
                                             
                                                
                                                   s
                                                
                                                
                                                   ∗
                                                
                                             
                                             +
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 s
                              
                              
                                 ∗
                              
                           
                           =
                           max
                           
                              (
                              p
                              ,
                              q
                              )
                           
                        . In our method, we prefer to use the slightly more efficient variant where 
                           
                              
                                 s
                              
                              
                                 ∗
                              
                           
                           =
                           p
                        , first used in the univariate case by Mélard (1982) and Penzer and Shea (1997), and in the multivariate case by Jónasson and Ferrando (2008).

The idea behind it is to transform 
                           
                              
                                 x
                              
                              
                                 T
                              
                           
                           
                              
                                 S
                              
                              
                                 −
                                 1
                              
                           
                           x
                         to 
                           
                              
                                 w
                              
                              
                                 T
                              
                           
                           w
                        , with 
                           w
                         a vector of uncorrelated random variables. Let 
                           z
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          n
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                              
                              
                                 T
                              
                           
                        , then the transformation from 
                           x
                         to 
                           z
                         has unit Jacobian so that (2.3) can be expressed as: 
                           
                              (2.5)
                              
                                 −
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    [
                                    
                                       (
                                       n
                                       r
                                       log
                                       
                                          (
                                          2
                                          π
                                          )
                                       
                                       +
                                       log
                                       
                                          {
                                          det
                                          
                                             (
                                             Ω
                                             )
                                          
                                          }
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             Ω
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       z
                                       )
                                    
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           Ω
                         is a symmetric block-band matrix with blocks 
                           Ω
                           
                              
                                 
                                    (
                                    t
                                    ,
                                    s
                                    )
                                 
                              
                              
                                 r
                                 ×
                                 r
                              
                           
                           =
                           
                              cov
                           
                           
                              (
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    s
                                 
                              
                              )
                           
                        . That matrix 
                           Ω
                         contains the following covariances matrices: 
                           
                              
                                 (2.6)
                                 
                                    
                                       
                                          W
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    cov
                                    
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                             −
                                             j
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          j
                                       
                                       
                                          q
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    Σ
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          −
                                          j
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                    j
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    q
                                    ,
                                 
                              
                              
                                 (2.7)
                                 
                                    
                                       
                                          G
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    cov
                                    
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             t
                                             −
                                             j
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          W
                                       
                                       
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             min
                                          
                                          
                                             (
                                             p
                                             ,
                                             q
                                             −
                                             j
                                             )
                                          
                                       
                                    
                                    
                                       
                                          G
                                       
                                       
                                          i
                                          +
                                          j
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                    j
                                    =
                                    q
                                    ,
                                    q
                                    −
                                    1
                                    ,
                                    …
                                    ,
                                    0
                                    .
                                 
                              
                           
                         Let 
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 I
                              
                              
                                 r
                              
                           
                        , 
                           
                              
                                 W
                              
                              
                                 j
                              
                           
                           =
                           0
                         and 
                           
                              
                                 G
                              
                              
                                 j
                              
                           
                           =
                           0
                         for 
                           j
                           <
                           0
                         and 
                           j
                           >
                           q
                        . We have 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 cov
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          t
                                          −
                                          j
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 for  
                                 j
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 p
                                 ,
                              
                           
                         which satisfy the following linear system (the vector Yule–Walker equations) 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                       
                                          T
                                       
                                    
                                    −
                                    ⋯
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          p
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    
                                       
                                          G
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    −
                                    ⋯
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          p
                                          −
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (2.8)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    ⋯
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          p
                                          −
                                          2
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    ⋮
                                 
                              
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          p
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          p
                                          −
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          p
                                          −
                                          2
                                       
                                    
                                    −
                                    ⋯
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          G
                                       
                                       
                                          p
                                       
                                    
                                    .
                                 
                              
                           
                         We have a linear system with the 
                           r
                           
                              (
                              r
                              +
                              1
                              )
                           
                           /
                           2
                           +
                           p
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                         elements of 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                         (noting that 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                         is symmetric). The solution of this linear system is dealt with in Jónasson and Ferrando (2008, Appendix B) which is close to that given by Mauricio (1997). The computation of the theoretical autocovariance of a VARMA process has been considered by Ansley (1980), Hall and Nicholls (1980), Kohn and Ansley (1982) and Mauricio (1995).

The matrix 
                           Ω
                         is a block band matrix, with 
                           max
                           
                              (
                              p
                              ,
                              q
                              +
                              1
                              )
                           
                         diagonal blocks along each side of the main diagonal blocks. Its precise form in the case 
                           p
                           ≥
                           q
                         and 
                           p
                           <
                           q
                         can be seen in Section  3.2 by omitting the first subscript everywhere. Now taking the Cholesky decomposition 
                           Ω
                           =
                           L
                           
                              
                                 L
                              
                              
                                 T
                              
                           
                        , where 
                           L
                         is a block band lower triangular matrix, the rows of 
                           L
                         are evaluated recursively using a standard algorithm for block matrices and the entries in 
                           w
                           =
                           
                              
                                 L
                              
                              
                                 −
                                 1
                              
                           
                           z
                         can be calculated by block forward substitution. Then 
                           det
                           
                              (
                              Ω
                              )
                           
                           =
                           
                              
                                 ∏
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                                 r
                              
                           
                           
                              
                                 l
                              
                              
                                 i
                                 i
                              
                              
                                 2
                              
                           
                        , where 
                           
                              
                                 l
                              
                              
                                 i
                                 i
                              
                           
                         is 
                           
                              (
                              i
                              ,
                              i
                              )
                           
                           
                              th
                           
                         element of 
                           L
                         and the log-likelihood function is given by 
                           
                              (2.9)
                              
                                 −
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    {
                                    n
                                    r
                                    log
                                    
                                       (
                                       2
                                       π
                                       )
                                    
                                    +
                                    2
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                          r
                                       
                                    
                                    log
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             i
                                             i
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          T
                                       
                                    
                                    w
                                    }
                                 
                                 .
                              
                           
                        
                     


                        
                           Remark 2.1
                           The method used by Jónasson and Ferrando (2008) is slightly different from ours in the calculation of 
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                              . Their method is based on the calculations of a set of covariances 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                 
                               defined by 
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          cov
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                ϵ
                                             
                                             
                                                t
                                                −
                                                j
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                       
                                       Σ
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                min
                                             
                                             
                                                (
                                                p
                                                ,
                                                j
                                                )
                                             
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             j
                                             −
                                             i
                                          
                                       
                                       ,
                                    
                                 
                               where 
                                 
                                    
                                       B
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       I
                                    
                                    
                                       r
                                    
                                 
                               and 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 0
                               for 
                                 j
                                 <
                                 0
                               and 
                                 j
                                 >
                                 q
                              . Then from (2.7) we get 
                                 
                                    (2.10)
                                    
                                       
                                          
                                             G
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             j
                                          
                                          
                                             q
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             −
                                             j
                                          
                                          
                                             T
                                          
                                       
                                       .
                                    
                                 
                               Determining the 
                                 
                                    
                                       W
                                    
                                    
                                       j
                                    
                                 
                              ’s, 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                 
                              ’s and 
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                              ’s by using (2.6), (2.7) and (2.10) costs about 
                                 
                                    
                                       r
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    2
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                               multiplications (Jónasson and Ferrando, 2008) where 
                                 s
                                 =
                                 min
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              . However, by using our algorithm the determination of 
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                              ’s and 
                                 
                                    
                                       W
                                    
                                    
                                       j
                                    
                                 
                              ’s costs about 
                                 
                                    
                                       r
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                               multiplications if 
                                 p
                                 ≥
                                 q
                               and otherwise about 
                                 
                                    
                                       r
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    2
                                    +
                                    q
                                    p
                                    −
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    2
                                    )
                                 
                               multiplications. Thus, our variant has two advantages, since it is slightly faster, and also simpler by calculating the covariances 
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                               by a simple recurrence formula.

Thus an efficient algorithm for computing the exact likelihood function defined in (2.3) for a standard VARMA(
                           p
                           ,
                           q
                        ) process exploiting the full symmetric block-band property of 
                           Ω
                         is as follows. For a given value of 
                           θ
                        , the log-likelihood is computed through the following stages.


                        
                           
                              Stage 1:
                           
                           
                              Compute the covariances 
                                    
                                       
                                          W
                                       
                                       
                                          j
                                       
                                    
                                  and 
                                    
                                       
                                          G
                                       
                                       
                                          j
                                       
                                    
                                  for 
                                    j
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    q
                                  by using (2.6)–(2.7), and compute the covariances 
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                  for 
                                    j
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                    −
                                    1
                                 , by solving the linear system of vector-Yule–Walker equations defined in (2.8).

Compute 
                                    
                                       
                                          z
                                       
                                       
                                          t
                                       
                                    
                                  for 
                                    t
                                    =
                                    p
                                    +
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                  by (2.4).

Compute the matrix 
                                    L
                                  by a block triangularization algorithm for the block band matrix 
                                    Ω
                                 .

Determine 
                                    w
                                    =
                                    
                                       
                                          L
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    z
                                  using block forward substitution.

Compute 
                                    
                                       
                                          w
                                       
                                       
                                          T
                                       
                                    
                                    w
                                 , 
                                    log
                                    
                                       {
                                       det
                                       
                                          (
                                          Ω
                                          )
                                       
                                       }
                                    
                                    =
                                    2
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                          r
                                       
                                    
                                    log
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             i
                                             i
                                          
                                       
                                       )
                                    
                                  and (2.9).

As explained in Section  1, the tdVARMA(
                           p
                           ,
                           q
                        ) model requires initial condition. For startup reasons, as we have no information on the past behavior of the process, we assume 
                           
                              (3.1)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   t
                                                   ,
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                             ≔
                                             
                                                
                                                   A
                                                
                                                
                                                   0
                                                   ,
                                                   i
                                                
                                             
                                             
                                             for  
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             p
                                               and  
                                             t
                                             =
                                             0
                                             ,
                                             −
                                             1
                                             ,
                                             …
                                             ,
                                             −
                                             p
                                             +
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   t
                                                   ,
                                                   j
                                                
                                             
                                             =
                                             
                                                
                                                   B
                                                
                                                
                                                   j
                                                
                                             
                                             ≔
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                   ,
                                                   j
                                                
                                             
                                             
                                             for  
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             q
                                               and  
                                             t
                                             =
                                             0
                                             ,
                                             −
                                             1
                                             ,
                                             …
                                             ,
                                             −
                                             q
                                             +
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                             
                                             
                                             for  
                                             t
                                             =
                                             0
                                             ,
                                             −
                                             1
                                             ,
                                             …
                                             ,
                                             −
                                             q
                                             +
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         the last line for compatibility with the LIKAMT program (Mélard, 1982), instead of 
                           
                              
                                 g
                              
                              
                                 0
                              
                           
                         which would have been more coherent. We suppose in addition (2.2) so that the process defined in (1.1) and (1.2) is causal and invertible in the past (
                           t
                           ≤
                           0
                        ). The assumption of causality in the past implies that we can calculate the covariance of the stationary process at 
                           t
                           =
                           0
                        . For 
                           t
                           ≤
                           0
                         the covariances 
                           
                              
                                 S
                              
                              
                                 t
                                 ,
                                 j
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                           ≔
                           
                              
                                 S
                              
                              
                                 0
                                 ,
                                 j
                              
                           
                         for 
                           0
                           ≤
                           j
                           ≤
                           p
                         are obtained like in the stationary VARMA(
                           p
                           ,
                           q
                        ) models by solving the linear system of equations given in (2.8), but with 
                           Σ
                         in (2.6) replaced by 
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           Σ
                           
                              
                                 g
                              
                              
                                 1
                              
                              
                                 T
                              
                           
                        . We refer the reader to e.g. Lanne and Saikkonen (2013) for the studies of non-causal VAR models, and for (univariate) AR models, see e.g. Brockwell and Davis (1991, Chapter 3). The assumption of invertibility in the past implies that the non-stationary process is invertible (Hallin, 1978), i.e. for all finite 
                           t
                        , 
                           
                              
                                 ϵ
                              
                              
                                 t
                              
                           
                         can be expressed as a mean-square convergent limit of linear combinations of 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    t
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    t
                                    −
                                    2
                                 
                              
                              ,
                              …
                              )
                           
                        . Without that property, the process would remain unidentifiable and inefficient forecasts would be produced by the model, see Hallin (1986).

Using a transformation like in (2.4) for the model defined in (1.1)–(1.2) but with 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         replaced by 
                           
                              
                                 A
                              
                              
                                 t
                                 ,
                                 i
                              
                           
                        , we obtain 
                           z
                           =
                           Λ
                           x
                         where 
                           Λ
                         is the 
                           n
                           r
                           ×
                           n
                           r
                         lower triangular block-band matrix given by: 
                           
                              
                                 Λ
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   r
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                          
                                             ⋯
                                          
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             ⋱
                                          
                                          
                                          
                                          
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   r
                                                
                                             
                                          
                                          
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   A
                                                
                                                
                                                   p
                                                   +
                                                   1
                                                   ,
                                                   p
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             −
                                             
                                                
                                                   A
                                                
                                                
                                                   p
                                                   +
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   r
                                                
                                             
                                          
                                          
                                          
                                       
                                       
                                          
                                          
                                             ⋱
                                          
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋱
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                          
                                             −
                                             
                                                
                                                   A
                                                
                                                
                                                   n
                                                   ,
                                                   p
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             −
                                             
                                                
                                                   A
                                                
                                                
                                                   n
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         Since 
                           Λ
                         has unit diagonal, the log-likelihood (1.3) can be expressed as: 
                           
                              
                                 l
                                 
                                    (
                                    θ
                                    ;
                                    z
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    [
                                    n
                                    r
                                    log
                                    
                                       (
                                       2
                                       π
                                       )
                                    
                                    +
                                    log
                                    
                                       {
                                       det
                                       
                                          (
                                          Ω
                                          )
                                       
                                       }
                                    
                                    +
                                    
                                       
                                          z
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          Ω
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    z
                                    ]
                                 
                                 ,
                              
                           
                         but the blocks of 
                           Ω
                           =
                           
                              
                                 
                                    cov
                                 
                              
                              
                                 θ
                              
                           
                           
                           
                              (
                              z
                              )
                           
                         are now the 
                           r
                           ×
                           r
                         covariances matrices: 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   t
                                                   ,
                                                   j
                                                
                                             
                                             =
                                             cov
                                             
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      t
                                                      −
                                                      j
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                          
                                             j
                                             =
                                             0
                                             ,
                                             1
                                             ,
                                             …
                                             ,
                                             q
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   t
                                                   ,
                                                   j
                                                
                                             
                                             =
                                             cov
                                             
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                      −
                                                      j
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                          
                                             j
                                             =
                                             0
                                             ,
                                             1
                                             ,
                                             …
                                             ,
                                             q
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   t
                                                   ,
                                                   j
                                                
                                             
                                             =
                                             cov
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                      −
                                                      j
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                          
                                             j
                                             =
                                             0
                                             ,
                                             1
                                             ,
                                             …
                                             ,
                                             p
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         which depend on 
                           t
                        . We will provide relations to evaluate these matrices in Section  3.3. More precisely, if 
                           p
                           ≥
                           q
                        , 
                           
                              (3.2)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                         whereas if 
                           p
                           <
                           q
                        , the depiction is slightly different with 
                           
                              (3.3)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                        
                     

Let us now detail the computation of these blocks.

The following relations are a generalization of Mélard (1982) to the vector case.

–The covariances
                        
                           
                              
                                 W
                              
                              
                                 t
                                 ,
                                 j
                              
                           
                        
                     

For 
                           t
                           =
                           1
                           ,
                           …
                           ,
                           n
                         and 
                           j
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           q
                        , 
                           
                              
                                 
                                    
                                       W
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       0
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       t
                                       ,
                                       k
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       t
                                       −
                                       k
                                    
                                 
                                 
                                    cov
                                 
                                 
                                    (
                                    
                                       
                                          ϵ
                                       
                                       
                                          t
                                          −
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          ϵ
                                       
                                       
                                          t
                                          −
                                          j
                                          −
                                          l
                                       
                                    
                                    )
                                 
                                 
                                    
                                       g
                                    
                                    
                                       t
                                       −
                                       j
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       t
                                       −
                                       j
                                       ,
                                       l
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         and since 
                           
                              cov
                           
                           
                              (
                              
                                 
                                    ϵ
                                 
                                 
                                    t
                                    −
                                    k
                                 
                              
                              ,
                              
                                 
                                    ϵ
                                 
                                 
                                    t
                                    −
                                    j
                                    −
                                    l
                                 
                              
                              )
                           
                           =
                           Σ
                           
                              
                                 δ
                              
                              
                                 k
                                 ,
                                 j
                                 +
                                 l
                              
                           
                        , with 
                           
                              
                                 δ
                              
                              
                                 k
                                 ,
                                 j
                              
                           
                           =
                           1
                         if 
                           k
                           =
                           j
                         and 0 otherwise, letting 
                           
                              
                                 B
                              
                              
                                 t
                                 ,
                                 0
                              
                           
                           =
                           
                              
                                 I
                              
                              
                                 r
                              
                           
                        , we have 
                           
                              (3.4)
                              
                                 
                                    
                                       W
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       j
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       t
                                       ,
                                       k
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       t
                                       −
                                       k
                                    
                                 
                                 Σ
                                 
                                    
                                       g
                                    
                                    
                                       t
                                       −
                                       k
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       t
                                       −
                                       j
                                       ,
                                       k
                                       −
                                       j
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 q
                                 ,
                              
                           
                         with 
                           
                              
                                 W
                              
                              
                                 t
                                 ,
                                 k
                              
                           
                           =
                           0
                         for 
                           k
                           >
                           q
                        .

–The covariances
                        
                           
                              
                                 G
                              
                              
                                 t
                                 ,
                                 j
                              
                           
                        
                     

For 
                           t
                           =
                           1
                           ,
                           …
                           ,
                           p
                           +
                           q
                         and 
                           j
                           =
                           q
                           ,
                           q
                           −
                           1
                           …
                           ,
                           0
                        , the covariances 
                           
                              
                                 G
                              
                              
                                 t
                                 ,
                                 j
                              
                           
                         can be obtained by the recurrence formula: 
                           
                              (3.5)
                              
                                 
                                    
                                       G
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       W
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          min
                                       
                                       
                                          (
                                          p
                                          ,
                                          q
                                          −
                                          j
                                          )
                                       
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       t
                                       ,
                                       i
                                       +
                                       j
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       t
                                       −
                                       j
                                       ,
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 t
                                 ,
                                 j
                              
                           
                           =
                           0
                         for 
                           j
                           >
                           q
                        , because 
                           
                              
                                 y
                              
                              
                                 t
                              
                           
                         is composed of 
                           
                              
                                 g
                              
                              
                                 t
                                 −
                                 1
                              
                           
                           
                              
                                 ϵ
                              
                              
                                 t
                                 −
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 t
                                 −
                                 q
                              
                           
                           
                              
                                 ϵ
                              
                              
                                 t
                                 −
                                 q
                              
                           
                         which are independent from 
                           
                              
                                 x
                              
                              
                                 t
                                 −
                                 j
                              
                           
                        .

–The covariances
                        
                           
                              
                                 S
                              
                              
                                 t
                                 ,
                                 j
                              
                           
                        
                     

For 
                           t
                           =
                           1
                           ,
                           …
                           ,
                           p
                         and 
                           j
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           p
                        , the autocovariances 
                           
                              
                                 S
                              
                              
                                 t
                                 ,
                                 j
                              
                           
                         of the process are obtained by the recurrences 
                           
                              (3.6)
                              
                                 
                                    
                                       S
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       t
                                       ,
                                       i
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       t
                                       −
                                       i
                                       ,
                                       j
                                       −
                                       i
                                    
                                 
                                 ,
                              
                           
                         recalling that 
                           
                              
                                 S
                              
                              
                                 t
                                 ,
                                 j
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 t
                                 ,
                                 0
                              
                           
                         for 
                           t
                           ≤
                           0
                         and noting that for 
                           j
                           −
                           i
                           <
                           0
                        
                        
                           
                              (3.7)
                              
                                 
                                    
                                       S
                                    
                                    
                                       t
                                       −
                                       i
                                       ,
                                       j
                                       −
                                       i
                                    
                                 
                                 =
                                 cov
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          t
                                          −
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          t
                                          −
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 cov
                                 
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                t
                                                −
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                t
                                                −
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       t
                                       −
                                       j
                                       ,
                                       i
                                       −
                                       j
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

To our knowledge, this is the first algorithm which extends the Cholesky decomposition method to the tdVARMA case. In scalar tdARMA models there exist only two algorithms to compute the exact likelihood function. The first one denoted LIKAMT (see Mélard, 1982) was also based on a Cholesky decomposition. The second one TKALMAR is based on the Kalman filter (see Azrak and Mélard, 1998). In addition Azrak and Mélard (1998) have compared the two algorithms in the univariate case. Their conclusions are that LIKAMT is faster for some models. On the contrary, for models with order 
                        p
                      and 
                        q
                      equal to or larger than 13, they can observe a superiority of TKALMAR.

Now we can summarize the algorithm in the case of tdVARMA models in the 6 stages below: 
                        
                           Stage 1:
                        
                        
                           Starting conditions: 
                                 
                                    •
                                    The coefficients 
                                          
                                             
                                                A
                                             
                                             
                                                t
                                                ,
                                                i
                                             
                                          
                                        and 
                                          
                                             
                                                B
                                             
                                             
                                                t
                                                ,
                                                j
                                             
                                          
                                        for 
                                          t
                                          ≤
                                          0
                                       , 
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          p
                                       , 
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          q
                                        and the values of 
                                          
                                             
                                                g
                                             
                                             
                                                t
                                             
                                          
                                        for 
                                          t
                                          ≤
                                          1
                                        are determined by using (3.1);

The covariances 
                                          
                                             
                                                W
                                             
                                             
                                                0
                                                ,
                                                j
                                             
                                          
                                       , 
                                          
                                             
                                                G
                                             
                                             
                                                0
                                                ,
                                                j
                                             
                                          
                                        for 
                                          j
                                          =
                                          0
                                          ,
                                          …
                                          ,
                                          q
                                        are determined using (2.6) and (2.7), and the covariances 
                                          
                                             
                                                S
                                             
                                             
                                                0
                                                ,
                                                j
                                             
                                          
                                        for 
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          p
                                        are obtained by solving (2.8).

We compute: 
                                 
                                    •
                                    The covariances 
                                          
                                             
                                                W
                                             
                                             
                                                t
                                                ,
                                                j
                                             
                                          
                                        by using (3.4) for 
                                          j
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          …
                                          ,
                                          q
                                        and 
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                       ;

The covariances 
                                          
                                             
                                                G
                                             
                                             
                                                t
                                                ,
                                                j
                                             
                                          
                                        by using (3.5) for 
                                          j
                                          =
                                          q
                                          ,
                                          q
                                          −
                                          1
                                          ,
                                          …
                                          ,
                                          0
                                        and 
                                          t
                                          =
                                          p
                                          +
                                          1
                                          ,
                                          …
                                          ,
                                          p
                                          +
                                          q
                                       ;

The covariances 
                                          
                                             
                                                S
                                             
                                             
                                                t
                                                ,
                                                j
                                             
                                          
                                        by using (3.6) for 
                                          j
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          …
                                          ,
                                          p
                                        and 
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          p
                                       .


                              
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                               is computed for 
                                 t
                                 =
                                 p
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              .

Compute the matrix 
                                 L
                               by a triangularization algorithm by blocks of the block band matrix 
                                 Ω
                              .

Determine 
                                 w
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 z
                               using block forward substitution.

Compute 
                                 
                                    
                                       w
                                    
                                    
                                       T
                                    
                                 
                                 w
                              , 
                                 log
                                 
                                    {
                                    det
                                    
                                       (
                                       Ω
                                       )
                                    
                                    }
                                 
                                 =
                                 2
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                       r
                                    
                                 
                                 log
                                 
                                    (
                                    
                                       
                                          l
                                       
                                       
                                          i
                                          i
                                       
                                    
                                    )
                                 
                               and (2.9).


                     
                        Remark 4.1
                        In Mélard (1982) and its implementation for the univariate case 
                              r
                              =
                              1
                            only four square matrices of size 
                              max
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              +
                              1
                            are needed.


                     
                        Remark 4.2
                        In the case where there is a deterministic trend, as discussed in the Introduction, none of the matrix calculations in the Algorithm of Section  4 would change; only the vector computations in stages 3, 5 and 6 would be affected.


                     
                        Remark 4.3
                        It could be argued that it would be more numerically stable to use QR rather than Cholesky factorization. However, extensive numerical experiments done in Jónasson (2008), and following that work, indicate that the Cholesky method is unlikely to suffer instabilities for practical VARMA time series modeling. We see no reason why adding time dependence should change that.

We consider the following mixed 
                           r
                        -variate tdVARMA(2, 1) process, 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       t
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       A
                                    
                                    
                                       t
                                       ,
                                       2
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       t
                                       −
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       B
                                    
                                    
                                       t
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                         where the coefficients 
                           
                              
                                 A
                              
                              
                                 t
                                 ,
                                 1
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 t
                                 ,
                                 2
                              
                           
                           ,
                           
                              
                                 B
                              
                              
                                 t
                                 ,
                                 1
                              
                           
                         and 
                           
                              
                                 g
                              
                              
                                 t
                              
                           
                         are deterministic functions of time, then 
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             if  
                                             t
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             if  
                                             t
                                             =
                                             3
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 Ω
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                          
                                          
                                          
                                          
                                       
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                   ,
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   3
                                                   ,
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                          
                                          
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   3
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   3
                                                   ,
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   4
                                                   ,
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                          
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   4
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   4
                                                   ,
                                                   0
                                                
                                             
                                          
                                          
                                             ⋱
                                          
                                          
                                          
                                       
                                       
                                          
                                          
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋱
                                          
                                          
                                       
                                       
                                          
                                          
                                          
                                          
                                          
                                             ⋱
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   n
                                                   ,
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                          
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   n
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   n
                                                   ,
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         By using the previous algorithm we have: 
                           
                              •
                              
                                 Stage  1: 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            t
                                                            ,
                                                            i
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            0
                                                            ,
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                      =
                                                      −
                                                      1
                                                      ,
                                                      0
                                                      ,
                                                      
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      2
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            t
                                                            ,
                                                            j
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            0
                                                            ,
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                      =
                                                      0
                                                      ,
                                                      
                                                      j
                                                      =
                                                      1
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                      =
                                                      0
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                  and the covariances 
                                    
                                       
                                          W
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          W
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          G
                                       
                                       
                                          0
                                          ,
                                          0
                                       
                                    
                                  and 
                                    
                                       
                                          G
                                       
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                  like in Section  2.2, but with 
                                    Σ
                                  in (2.6) replaced by 
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    Σ
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 . Then the 
                                    
                                       
                                          S
                                       
                                       
                                          0
                                          ,
                                          j
                                       
                                    
                                 ’s for 
                                    j
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                  are determined by solving (2.8).


                                 Stage  2: For 
                                    t
                                    =
                                    1
                                    ,
                                    2
                                 , we should start by calculating the 
                                    
                                       
                                          W
                                       
                                       
                                          t
                                          ,
                                          j
                                       
                                    
                                 , by using (3.4): 
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                             
                                             Σ
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                             +
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                
                                             
                                             Σ
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                
                                             
                                             Σ
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   2
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             
                                                
                                                   g
                                                
                                                
                                                   2
                                                
                                             
                                             Σ
                                             
                                                
                                                   g
                                                
                                                
                                                   2
                                                
                                                
                                                   T
                                                
                                             
                                             +
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                             
                                             Σ
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                             
                                             Σ
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                             .
                                          
                                       
                                    
                                  Note that 
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          g
                                       
                                       
                                          0
                                       
                                    
                                 . Similarly 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                t
                                                ,
                                                0
                                             
                                          
                                          =
                                          
                                             
                                                g
                                             
                                             
                                                t
                                             
                                          
                                          Σ
                                          
                                             
                                                g
                                             
                                             
                                                t
                                             
                                             
                                                T
                                             
                                          
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                t
                                                ,
                                                1
                                             
                                          
                                          
                                             
                                                g
                                             
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          Σ
                                          
                                             
                                                g
                                             
                                             
                                                t
                                                −
                                                1
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                t
                                                ,
                                                1
                                             
                                             
                                                T
                                             
                                          
                                          
                                          and
                                          
                                          
                                             
                                                W
                                             
                                             
                                                t
                                                ,
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                B
                                             
                                             
                                                t
                                                ,
                                                1
                                             
                                          
                                          
                                             
                                                g
                                             
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          Σ
                                          
                                             
                                                g
                                             
                                             
                                                t
                                                −
                                                1
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                  for 
                                    t
                                    =
                                    3
                                    ,
                                    …
                                    ,
                                    n
                                 . For the covariances 
                                    
                                       
                                          G
                                       
                                       
                                          t
                                          ,
                                          k
                                       
                                    
                                  we have by using (3.5): 
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   W
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   G
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   W
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   G
                                                
                                                
                                                   3
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   W
                                                
                                                
                                                   3
                                                   ,
                                                   1
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             
                                                
                                                   W
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   G
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   G
                                                
                                                
                                                   2
                                                   ,
                                                   0
                                                
                                             
                                             =
                                             
                                                
                                                   W
                                                
                                                
                                                   2
                                                   ,
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   G
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                             .
                                          
                                       
                                    
                                  Taking care of the covariances 
                                    
                                       
                                          S
                                       
                                       
                                          t
                                          ,
                                          j
                                       
                                    
                                  by using the covariances computed before, we have for 
                                    t
                                    =
                                    1
                                 : 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   0
                                                   ,
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   G
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   0
                                                   ,
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                             .
                                          
                                       
                                    
                                  Knowing that by (3.7)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          0
                                          ,
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                       
                                          T
                                       
                                    
                                  and 
                                    
                                       
                                          S
                                       
                                       
                                          −
                                          1
                                          ,
                                          −
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                       
                                          T
                                       
                                    
                                  we have 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          =
                                          
                                             
                                                G
                                             
                                             
                                                1
                                                ,
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                A
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                             
                                                T
                                             
                                          
                                          +
                                          
                                             
                                                A
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                             
                                                T
                                             
                                          
                                          .
                                       
                                    
                                  Then, for 
                                    t
                                    =
                                    2
                                 : 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                   ,
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                   ,
                                                   2
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   G
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                   ,
                                                   2
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                          
                                       
                                    
                                  and, finally knowing that 
                                    
                                       
                                          S
                                       
                                       
                                          0
                                          ,
                                          −
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          2
                                          ,
                                          2
                                       
                                       
                                          T
                                       
                                    
                                  and 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                          ,
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          2
                                          ,
                                          1
                                       
                                       
                                          T
                                       
                                    
                                  we have 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                                ,
                                                0
                                             
                                          
                                          =
                                          
                                             
                                                G
                                             
                                             
                                                2
                                                ,
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                A
                                             
                                             
                                                2
                                                ,
                                                1
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                2
                                                ,
                                                1
                                             
                                             
                                                T
                                             
                                          
                                          +
                                          
                                             
                                                A
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                             
                                                T
                                             
                                          
                                          .
                                       
                                    
                                 
                              

By using the remaining stages of the above algorithm we can evaluate the log-likelihood function of this tdVARMA(2, 1) process.


                        
                           Remark 4.4
                           We can notice that 
                                 Ω
                               does not contain some of the computed covariances like 
                                 
                                    
                                       S
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 ,
                                 …
                              . However they are involved in the calculation of the other covariances.


                        Table 1
                         gives the total number of multiplications required by our algorithm. If 
                           p
                         is small compared to 
                           q
                         and if 
                           q
                         is small enough with respect to 
                           n
                        , the stages 4, 5 and 6 will take the most of the computation time and the total number of operations to compute 
                           
                              
                                 z
                              
                              
                                 T
                              
                           
                           
                              
                                 Ω
                              
                              
                                 −
                                 1
                              
                           
                           z
                         is 
                           O
                           
                              (
                              n
                              )
                           
                        .

Finally, the total number of multiplications is of order 
                           n
                           
                              [
                              
                                 
                                    r
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 3
                                 p
                                 /
                                 2
                                 +
                                 q
                                 )
                              
                              ]
                           
                           +
                           
                              
                                 r
                              
                              
                                 6
                              
                           
                           
                              
                                 p
                              
                              
                                 3
                              
                           
                           /
                           3
                         for a tdVARMA(
                           p
                           ,
                           q
                        ) and 
                           n
                           
                              [
                              
                                 
                                    r
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                              /
                              2
                              +
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 3
                                 p
                                 /
                                 2
                                 +
                                 q
                                 )
                              
                              ]
                           
                           +
                           
                              
                                 r
                              
                              
                                 6
                              
                           
                           
                              
                                 p
                              
                              
                                 3
                              
                           
                           /
                           3
                         in the case of a VARMA(
                           p
                           ,
                           q
                        ), by neglecting 
                           r
                        , 
                           p
                         and 
                           q
                         with respect to 
                           n
                         but not their powers or products. In addition, for the term proportional to 
                           n
                        , the total number of multiplications for tdVARMA models is about less than twice what is needed for VARMA models of the same order 
                           
                              (
                              p
                              ,
                              q
                              )
                           
                         (not counting operations for the computation of the coefficients).

In this part we illustrate the use of the algorithm and its implementation in Matlab, called AJM, which represents a generalization of Jónasson (2008) Matlab’s program to tdVARMA models. The estimation of the parameters by AJM is based on the maximization of the exact Gaussian likelihood function using the fminunc Matlab function belonging to the optimization toolbox, see Coleman et al. (1999). This function uses the BFGS quasi-Newton method with a mixed quadratic and cubic line search procedure. AJM can be summarized in three steps. In Step 1 we estimate the mean and the observation covariance matrix which will be used as initial values for 
                        μ
                      and 
                        Σ
                      in Step 2. Step 2 estimates all the parameters of the model. Finally Step 3 estimates only the parameters of interest in order to derive the covariance matrix of the estimates. This is an alternative to the Tunnicliffe Wilson (1973) method for standard VARMA models.

The series (Example 8.1 in Tsay, 2005) considered here is a bivariate (
                           r
                           =
                           2
                        ) time series 
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          t
                                          ,
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          t
                                          ,
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 T
                              
                           
                         where 
                           
                              
                                 x
                              
                              
                                 t
                                 ,
                                 1
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 t
                                 ,
                                 2
                              
                           
                         represent respectively the monthly log returns of IBM stock and S&P500 index from January 1926 to December 1999 with 
                           n
                           =
                           888
                         observations. Fig. 1
                         shows the time plots of 
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                         using the same scale.


                        Tsay (2005) showed, by using the cross-correlation matrices and other techniques (selection criteria, …), that a VMA(3) should be adequate. It is given by 
                           
                              (6.1)
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                   ,
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                   ,
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 μ
                                 +
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   1
                                                   ,
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   2
                                                   ,
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   1
                                                   ,
                                                   t
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   2
                                                   ,
                                                   t
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       B
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   1
                                                   ,
                                                   t
                                                   −
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   2
                                                   ,
                                                   t
                                                   −
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           μ
                         and 
                           Σ
                         represent respectively the mean of 
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                         and the covariance matrix of 
                           
                              
                                 ϵ
                              
                              
                                 t
                              
                           
                        , 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 3
                              
                           
                         are the coefficients. The estimation results of complete and simplified models of (6.1) are given in Table 2
                        . The simplified models were obtained by removing one by one the non-significant parameters at the 5% significant level, starting with the least significant, until all the parameters are significantly different from zero. The justification is to reduce the number of parameters to the minimum.

We can see that the estimation results found by our program and those given in Tsay (2005, Table 8.6, p. 370) and obtained by using SCA version 8.1 are very close.

Let us now assume that the bivariate series follows a tdVMA(3) model, a special case of (1.1)–(1.2). Instead of being constant like in (6.1) we assume that the coefficients are slowly varying deterministic functions of time. We use linear functions of time except for the scale 
                           
                              
                                 g
                              
                              
                                 t
                              
                           
                         which is supposed to be exponential to avoid negative values: 
                           
                              (6.2)
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                   ,
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                   ,
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 μ
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   1
                                                   ,
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   2
                                                   ,
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       B
                                    
                                    
                                       t
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   1
                                                   ,
                                                   t
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   2
                                                   ,
                                                   t
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       B
                                    
                                    
                                       t
                                       ,
                                       3
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       t
                                       −
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   1
                                                   ,
                                                   t
                                                   −
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   2
                                                   ,
                                                   t
                                                   −
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         with 
                           
                              (6.3)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   t
                                                   ,
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   ′
                                                
                                             
                                             +
                                             
                                                (
                                                t
                                                −
                                                
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   ″
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               11
                                                            
                                                            
                                                               ′
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               12
                                                            
                                                            
                                                               ′
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               21
                                                            
                                                            
                                                               ′
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               22
                                                            
                                                            
                                                               ′
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                             and
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                                
                                                   ″
                                                
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               11
                                                            
                                                            
                                                               ″
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               12
                                                            
                                                            
                                                               ″
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               21
                                                            
                                                            
                                                               ″
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               22
                                                            
                                                            
                                                               ″
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ;
                                          
                                       
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   t
                                                   ,
                                                   3
                                                
                                             
                                             =
                                             
                                                
                                                   B
                                                
                                                
                                                   3
                                                
                                                
                                                   ′
                                                
                                             
                                             +
                                             
                                                (
                                                t
                                                −
                                                
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   3
                                                
                                                
                                                   ″
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   3
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               11
                                                            
                                                            
                                                               ′
                                                               3
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               12
                                                            
                                                            
                                                               ′
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               21
                                                            
                                                            
                                                               ′
                                                               3
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               22
                                                            
                                                            
                                                               ′
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                             and
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   3
                                                
                                                
                                                   ″
                                                
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               11
                                                            
                                                            
                                                               ″
                                                               3
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               12
                                                            
                                                            
                                                               ″
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               21
                                                            
                                                            
                                                               ″
                                                               3
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               22
                                                            
                                                            
                                                               ″
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ;
                                          
                                       
                                       
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         exp
                                                         
                                                            {
                                                            
                                                               
                                                                  η
                                                               
                                                               
                                                                  11
                                                               
                                                            
                                                            
                                                               (
                                                               t
                                                               −
                                                               
                                                                  
                                                                     n
                                                                     +
                                                                     1
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               )
                                                            
                                                            }
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         exp
                                                         
                                                            {
                                                            
                                                               
                                                                  η
                                                               
                                                               
                                                                  22
                                                               
                                                            
                                                            
                                                               (
                                                               t
                                                               −
                                                               
                                                                  
                                                                     n
                                                                     +
                                                                     1
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               )
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         We have first considered a model without heteroscedasticity i.e. without 
                           
                              
                                 g
                              
                              
                                 t
                              
                           
                        , and then a model with heteroscedasticity i.e. with 
                           
                              
                                 g
                              
                              
                                 t
                              
                           
                        . Table 4 shows the estimation results of the parameters of interest of (6.2)–(6.3) using the program based on the algorithm described in this paper. For example, for the full model without heteroscedasticity 14 iterations were needed and the computation time on a computer with a 3 GHz Core Duo E8400 processor was around 385 s. The simplified model was obtained again by removing one by one the least non-significant parameters. The theory behind the use of the standard errors and 
                           t
                        -statistics for tdVARMA models is based on Alj et al. (in preparation), a generalization of Azrak and Mélard (2006) to multivariate models. Table 3
                        
                         gives the information criteria of each model, where AICc is the corrected Akaike information criterion (Hurvich and Tsai, 1989), SBC is the Schwarz Bayesian criterion (Rissanen, 1978; Schwarz, 1978), HQC is the Hannan–Quinn criterion (Hannan and Quinn, 1979) and finally FPE represents the final prediction error criterion. Note that 
                           
                              i.
                              Most of the parameters in 
                                    
                                       
                                          B
                                       
                                       
                                          1
                                       
                                       
                                          ″
                                       
                                    
                                  and 
                                    
                                       
                                          B
                                       
                                       
                                          3
                                       
                                       
                                          ″
                                       
                                    
                                  were significantly different from 0.

It even happens that the final simplified models involve no 
                                    
                                       
                                          B
                                       
                                       
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                  and 
                                    
                                       
                                          B
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                  parameters, showing that the trend in the coefficients is more important than the intercept.

The criteria in Table 3 agree in favor of the simplified model with heteroscedasticity.

Consequently, the suggested kind of models seems useful for at least one pair of series and the proposed algorithm seems justified.

Here we have modeled the time dependence with a linear function. There would be no problem to use polynomials in 
                           t
                        . For example, using a quadratic function of time would produce an increase of about 50% for the number of parameters in the full model.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank the referees, for their careful reading of the manuscript, their comments and their pertinent suggestions, and also the associate editor and the co-editor Erricos Kontoghiorghes. The third author has benefited from a Belgian research grant F.R.S.-FNRS   1.5.261.09.

@&#REFERENCES@&#

