@&#MAIN-TITLE@&#Measuring rank correlation coefficients between financial time series: A GARCH-copula based sequence alignment algorithm

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel method is presented to align numerical financial time series directly.


                        
                        
                           
                           The presented method does not transform financial time series into symbolic series.


                        
                        
                           
                           The proposed method consists of GARCH, copula, and sequence alignment technique.


                        
                        
                           
                           The proposed method is superior to traditional data synchronization method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Time series

Rank correlation

GARCH

Copula

Sequence alignment

@&#ABSTRACT@&#


               
               
                  This paper presents a novel four-stage algorithm for the measurement of the rank correlation coefficients between pairwise financial time series. In first stage returns of financial time series are fitted as skewed-t distributions by the generalized autoregressive conditional heteroscedasticity model. In the second stage, the joint probability density function (PDF) of the fitted skewed-t distributions is computed using the symmetrized Joe–Clayton copula. The joint PDF is then utilized as the scoring scheme for pairwise sequence alignment in the third stage. After solving the optimal sequence alignment problem using the dynamic programming method, we obtain the aligned pairs of the series. Finally, we compute the rank correlation coefficients of the aligned pairs in the fourth stage. To the best of our knowledge, the proposed algorithm is the first to use a sequence alignment technique to pair numerical financial time series directly, without initially transforming numerical values into symbols. Using practical financial data, the experiments illustrate the method and demonstrate the advantages of the proposed algorithm.
               
            

@&#INTRODUCTION@&#

Given the strength of interaction and dependence among international stock markets, researchers have explored methods for the measurement of the association among various markets. The linear Pearson correlation coefficient is the most popular measurement of the association among international stock markets (Forbes & Rigobon, 2002; Longin & Solnik, 2001). The linear Pearson correlation coefficient is founded on an assumption of bivariate normally distributed returns. Given that joint distribution is generally a fat tail (Engle & Gonzalez-Rivera, 1991; Nelson, 1991), the linear Pearson correlation coefficient is ineffective in measuring dependence for financial data. Embrechts, Mcneil, and Straumann (2002) discussed the disadvantages of the linear Pearson correlation coefficient. Rank correlation coefficients such as Kendall’s τ and Spearman’s ρ are used to measure the extent to which one variable increases when another increases without requiring such increase to be represented by a linear relationship. If one variable increases and the other decreases, the rank correlation coefficients will be negative. Both rank correlation coefficients measure a form of dependence known as concordance. For financial time series, these rank correlation coefficients are alternatives to Pearson’s coefficient to make the correlation less sensitive to non-normality in distributions (Nelsen, 2002).

Numerous studies have used copulas to model the dependence structure among financial markets directly (Chan & Kroese, 2010; Grundke & Polle, 2012; Ning, 2010; Patton, 2006; Sak, Hörmann, & Leydold, 2010). In this work, we utilize the dependence structure derived by a copula to present a novel method for pairing financial time series using the sequence alignment technique, which is widely employed in bioinformatics and computer science. Specifically, to measure the rank correlation coefficients between pairwise financial time series, this paper first specifies two kinds of models: the generalized autoregressive conditional heteroscedasticity (GARCH) model for the marginal distribution of each return of financial time series and the copula model for the joint distribution of pairwise return series. We then utilize the GARCH-copula based joint distribution as the scoring scheme to pair the series using the sequence alignment technique. Finally, the rank correlation coefficients of two financial series are computed based on the aligned pairs. Given that a direct relationship exists between copula and rank correlation coefficients (Joe, 1997), we compute and compare these rank correlation coefficients using the copula directly and the proposed method.

Returns of financial time series are fat tails and conditional heteroscedasticity (Engle & Gonzalez-Rivera, 1991; Nelson, 1991). The GARCH model is a common approach used to model time series with conditional heteroscedastic errors. In this paper, we use Hansen’s skewed-t (SK-t) GARCH (1994) to model each univariate marginal return series. An important property of SK-t density is that it nests the standard Student-t and normal distributions as two special cases. Copulas are widely used in quantitative finance to measure the dependence structure among financial random variables. The cumulative distribution function (CDF) of random variables is written in terms of marginal distribution functions and a copula. Marginal distribution functions describe the behavior of each random variable, and a copula describes the dependence structure among these variables. Copulas are commonly used because they can easily model and estimate the joint CDF of random variables by separately estimating marginals and copula. Joe (1997) and Nelsen (2006) provided a comprehensive introduction to copula models and their fundamental properties. Unlike the Pearson correlation coefficient, copulas do not require random variables to be elliptically distributed. Therefore, copulas are useful when modeling the dependence among financial variables. They are also invariant to increasing and continuous transformations (Ning, 2010). This property is very useful because transformation is commonly used in economics and finance. By contrast, the Pearson correlation coefficient is only invariant under linear transformations.

For the bivariate case, a rich variety of copula families is available and well investigated. For the multivariate case, the choice of adequate families is limited. Standard multivariate copulas such as the multivariate Gaussian or Student-t as well as exchangeable Archimedean copulas lack the flexibility to model the dependence among larger numbers of variables accurately. Vine copulas, initially proposed by Joe (1996) and further explored and extended by Bedford and Cooke (2001, 2002) and by Kurowicka and Cooke (2006), are unaffected by these problems. Vine copulas are a graphical model for describing multivariate copulas built using a cascade of bivariate copulas, which are also called pair-copulas. These pair-copula constructions allow for flexibilities in dependence modeling. Asymmetries and tail dependence as well as (conditional) independence are considered in modeling multivariate financial time series (Joe, Li, & Nikoloulopoulos, 2010; Nikoloulopoulos, Joe, & Li, 2012).

After joint distribution is determined, the sequence alignment technique is used to pair the financial time series. Sequence alignment is a method of arranging sequences of DNA, RNA, or proteins to identify the similarity that may be a consequence of functional, structural, or evolutionary relationships among sequences (Mount, 2004). An element in a bioinformatics sequence is generally represented by a letter/symbol, and two sequences are not required to have the same length. When aligning pairwise sequences, the order of elements in each sequence is fixed. An alignment of paired sequences is achieved by introducing gaps into the two sequences, such that the lengths of the two resulting sequences are identical, and no column contains two gaps. When determining similarities between two aligned sequences, a scoring scheme must be applied. Based on the scoring scheme, the best sequence alignment is the one that optimizes the total score.

Compared with the bioinformatics sequence of letters/symbols, a financial time series is a sequence of real numbers with each number representing a value at one time. To recognize similarity patterns of cross-market indicator time series, Yamano, Sato, Kaizoji, Rost, and Pichl (2008) separated the range of numerical indicator values into countable finite subsets and then assigned a symbol to each subset. With respect to the symbolization of indicators, a scoring scheme was developed for aligning the symbolized sequences. To quantify a similarity degree between financial time series, Hayashi, Kaizoji, and Pichl (2007) and Pichl, Yamano, and Kaizoji (2006) transformed quantitative index values into a finite set of symbols, developed a scoring scheme, and used the sequence alignment technique.

Aligning numerical financial time series directly without transforming numerical finance time series into symbolic series has been considered. However, an appropriate scoring scheme exists for numerical financial series. This paper enables the alignment between two financial time series of real numbers by using their joint probability distribution function (PDF) as the scoring scheme. This function measures the dependence structure of the two financial series.

When drawing the time series of various markets from a financial database, adjustments must be made before analyzing the correlation coefficients. However, dates are not synchronized because of different national holidays or working days across countries. The simplest and most widely used adjustment is synchronization based on common working days. However, this adjustment may result in the underestimation of true correlations among financial markets. Using data of common working days, Audrino and Bühlmann (2004) followed the technique proposed by Burns, Engle, and Mezrich (1998) and synchronized the prices/returns of multivariate financial time series at a specified time point every common working day. Unlike Burns et al. (1998), who did not test the forecasting power of synchronized data, Audrino and Bühlmann (2004) proposed the use of any reasonable multivariate model for the constructed synchronized data and tested the model’s out-of-sample predictive performance for applications in risk management.

Unlike common working days policy, this study aligns pairwise series using the following systematic mechanics: GARCH model, copula model, and sequence alignment method. No holiday or working day of the source data is deleted in the fitting of the GARCH and copula models. Source time series are matched until the sequence alignment method is applied. Three backtesting algorithms, namely, the Berkowitz (2001), Christoffersen (1998), and Kupiec (1995) tests, are used to test the performance of the proposed model against the common working days model.

In summary, to measure the rank correlation coefficients between financial time series, residuals of the series are first fitted as SK-t distributions using a GARCH model. The copula model is then utilized to compute the joint PDF of pairwise SK-t distributions. The joint PDF acts as a scoring scheme in the optimization of the financial time series alignment. Finally, the rank correlation coefficients are computed based on the aligned pairs.

The rest of this paper is organized as follows: Section 2 outlines the marginal GARCH model, joint copula model, and sequence alignment technique. Section 3 presents the data (market indexes of the Four Asian Dragons), analyzes the empirical results of the GARCH and copula models, aligns pairwise financial markets, and computes the correlation coefficients. Section 4 concludes the paper.

The GARCH model is first specified for the marginal distribution of each financial time series. Then, the copula model is specified for the joint distribution between pairwise series. Finally, the fitted copula function is used as the scoring scheme in aligning pairwise financial time series.

The GARCH model is a common approach used to model time series with conditional heteroscedastic errors. Residuals obtained from a GARCH model are generally non-normal. This suggests that we use Hansen’s SK-t GARCH model. In Hansen’s model (1994), the first four moments are conditional and time-varying. The usual GARCH model is used for the conditional mean and volatility. To control higher moments, Hansen constructed an SK-t density to model residuals of GARCH. This SK-t density maintains the assumption of a zero mean and unit variance. Conditioning is achieved by defining parameters as functions of past realizations.

Assuming r
                        
                           t
                        , t
                        =1, …, T denotes the return of a financial time series. We use an autoregressive model to decompose the return r
                        
                           t
                         into a conditional mean μ
                        
                           t
                         with returns that contain information on past returns and an innovation ε
                        
                           t
                         as follows:
                           
                              (1)
                              
                                 
                                    
                                       r
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ε
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 α
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       t
                                       -
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       ε
                                    
                                    
                                       t
                                    
                                 
                                 .
                              
                           
                        In the following GJR-GARCH model (Glosten, Jagannathan, & Runkle, 1993), Eq. (2) defines innovation ε
                        
                           t
                         as a product between conditional volatility σ
                        
                           t
                         and a residual z
                        
                           t
                        . Eq. (3) determines the dynamics of volatility σ
                        
                           t
                        .
                           
                              (2)
                              
                                 
                                    
                                       ε
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 ω
                                 +
                                 
                                    
                                       δ
                                    
                                    
                                       +
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ε
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       δ
                                    
                                    
                                       -
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ε
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                                
                                                   -
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ξ
                                 
                                    
                                       σ
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    ε
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    +
                                 
                              
                              =
                              max
                              (
                              
                                 
                                    ε
                                 
                                 
                                    t
                                 
                              
                              ,
                              0
                              )
                           
                        , and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    -
                                 
                              
                              =
                              max
                              (
                              -
                              
                                 
                                    ε
                                 
                                 
                                    t
                                 
                              
                              ,
                              0
                              )
                           
                        .

According to Glosten et al. (1993), the positivity and stationarity of the volatility process in Eq. (3) is guaranteed whenever parameters ω, δ
                        +, δ
                        −, and ξ satisfy the constraints ω
                        >0, δ
                        +, δ
                        −, ξ
                        ⩾ 0, and ξ
                        +(δ
                        +
                        +
                        δ
                        −)/2<1.

We assume that residual z
                        
                           t
                         follows Hansen’s SK-t distribution. The density of the SK-t distribution with degree-of-freedom parameter v and asymmetry parameter λ is given by
                           
                              (4)
                              
                                 SK
                                 -
                                 t
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 v
                                 ,
                                 λ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   bc
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                               +
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     v
                                                                     -
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       bz
                                                                                    
                                                                                    
                                                                                       t
                                                                                    
                                                                                 
                                                                                 +
                                                                                 a
                                                                              
                                                                              
                                                                                 1
                                                                                 -
                                                                                 λ
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                         (
                                                         v
                                                         +
                                                         1
                                                         )
                                                         /
                                                         2
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   <
                                                   -
                                                   a
                                                   /
                                                   b
                                                
                                             
                                             
                                                
                                                   bc
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                               +
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     v
                                                                     -
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       bz
                                                                                    
                                                                                    
                                                                                       t
                                                                                    
                                                                                 
                                                                                 +
                                                                                 a
                                                                              
                                                                              
                                                                                 1
                                                                                 +
                                                                                 λ
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                         (
                                                         v
                                                         +
                                                         1
                                                         )
                                                         /
                                                         2
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ⩾
                                                   -
                                                   a
                                                   /
                                                   b
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              a
                              =
                              4
                              λ
                              c
                              (
                              v
                              -
                              2
                              )
                              /
                              (
                              v
                              -
                              1
                              )
                              ,
                              b
                              =
                              
                                 
                                    1
                                    +
                                    3
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        , and 
                           
                              c
                              =
                              Γ
                              
                                 
                                    
                                       
                                          
                                             v
                                             +
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      π
                                                      (
                                                      v
                                                      -
                                                      2
                                                      )
                                                   
                                                
                                                Γ
                                                
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        .

The SK-t distribution encompasses a large set of conventional densities. If λ
                        =0, then a
                        =0, b
                        =1, and SK-t is reduced to the standard Student-t distribution. If −1<
                        λ
                        <0 (0<
                        λ
                        <1), then SK-t is negatively (positively) skewed. Parameter v(>2) measures the degree of freedom. A lower value of v results in a greater number of extrema in z
                        
                           t
                         (i.e., distribution tails are fatter than the normal distribution). When v approaches infinity, excess kurtosis becomes zero, and normal distribution is attained. Accordingly, SK-t(z
                        
                           t
                        ∣v,
                        λ) nests the standard Student-t and normal distributions as two special cases.

An important requirement of the copula model is for the probability transforms of the marginal distributions to be independent and uniformly distributed at (0,1). Following Ning (2010) and Patton (2006), we employ the Lagrange Multiplier (LM) statistic to test for serial independence of the probability transforms. Assuming that Z
                        
                           t
                         denotes the probability transforms of marginal SK-t distribution, we regress 
                           
                              
                                 
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                Z
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    k
                                 
                              
                           
                         on 10 lags for k
                        =1–4 and then compute the statistic LM
                        =(T
                        −20)R
                        2 with T and R
                        2 being the sample size and coefficient of determination, respectively. The LM statistic is distributed as χ
                        2(20) under the null that the first four moments of Z
                        
                           t
                         are serially independent. To test the hypothesis that the probability transforms of marginal SK-t distributions are uniform at the interval (0,1), we employ the Kolmogorov–Smirnov (KS) tests.

A copula is a function that joins multivariate marginal distribution functions to form a joint distribution function. In Sklar (1959) introduced one of the most important results in copula theory. According to Sklar, the joint distribution of multivariate can be decomposed into its univariate marginal distributions and a copula. A copula specifies the dependence structure among variables. Consequently, we can use copulas to model the marginal distributions and dependence structure of a multivariate random variable separately. More details on copulas and measures of dependence are found in Joe (1997) and Nelsen (2006).

Various copula functions have been established. The symmetrized Joe–Clayton (SJC) copula, proposed by Patton (2006), accommodates the following five different circumstances: (1) no tail dependence exists in the upper and lower tails; (2) tail dependence exists in and is equal across the upper and lower tails; (3) tail dependence exists in the lower but not the upper tail; (4) tail dependence exists in the upper but not the lower tail; and (5) tail dependence exists in and may be unequal across the upper and lower tails. In this paper, the SJC copula is used because of these advantages.

We consider a bivariate case for simplicity. If C
                        
                           SJC
                         is the SJC copula, X
                        1 and X
                        2 are random variables with marginal distribution F
                        1, F
                        2, and F is the joint distribution of X
                        1 and X
                        2. Assuming that u
                        1
                        =
                        F
                        1(x
                        1) and u
                        2
                        =
                        F
                        2(x
                        2). According to Sklar, F(x
                        1, x
                        2)=
                        C
                        
                           SJC
                        (F
                        1(x
                        1), F
                        2(x
                        2)). The joint PDF f(x
                        1, x
                        2) of X
                        1 and X
                        2 is given by
                           
                              (5)
                              
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ∂
                                       F
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       
                                          
                                             C
                                          
                                          
                                             SJC
                                          
                                       
                                       (
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             F
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       
                                          
                                             C
                                          
                                          
                                             SJC
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ∂
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ×
                                 
                                    
                                       ∂
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ×
                                 
                                    
                                       ∂
                                       
                                          
                                             F
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       SJC
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ×
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ×
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ,
                              
                           
                        where c
                        
                           SJC
                        (u
                        1,
                        u
                        2), f
                        1(x
                        1), and f
                        2(x
                        2) are the PDFs of the SJC copula, X
                        1, and X
                        2, respectively.

According to Patton (2006), the bivariate distribution function C
                        
                           SJC
                         is given by
                           
                              (6)
                              
                                 
                                    
                                       C
                                    
                                    
                                       SJC
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 [
                                 
                                    
                                       C
                                    
                                    
                                       JC
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       JC
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 1
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 1
                                 ]
                                 ,
                              
                           
                        where C
                        
                           JC
                        (u
                        1,
                        u
                        2) is the Joe–Clayton copula of Joe (1997).


                        Joe (1997) defines C
                        
                           JC
                        (u
                        1,
                        u
                        2) as follows:
                           
                              (7)
                              
                                 
                                    
                                       C
                                    
                                    
                                       JC
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 1
                                 -
                                 
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   [
                                                   
                                                      
                                                         (
                                                         1
                                                         -
                                                         
                                                            
                                                               (
                                                               1
                                                               -
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               η
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         -
                                                         γ
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         (
                                                         1
                                                         -
                                                         
                                                            
                                                               (
                                                               1
                                                               -
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               η
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         -
                                                         γ
                                                      
                                                   
                                                   -
                                                   1
                                                   ]
                                                
                                                
                                                   -
                                                   1
                                                   /
                                                   γ
                                                
                                             
                                          
                                       
                                    
                                    
                                       1
                                       /
                                       η
                                    
                                 
                                 ,
                              
                           
                        where η
                        =1/log2(2−
                        τ
                        
                           U
                        ), γ
                        =−1/log2(τ
                        
                           L
                        ), 0<
                        τ
                        
                           U
                        
                        <1 and 0<
                        τ
                        
                           L
                        
                        <1.

According to Patton (2006), τ
                        
                           U
                         and τ
                        
                           L
                         measure the dependence of the upper and lower tails between X
                        1 and X
                        2, respectively. Formally these measures are defined as follows:
                           
                              (8)
                              
                                 
                                    
                                       τ
                                    
                                    
                                       U
                                    
                                 
                                 =
                                 
                                    
                                       
                                          lim
                                       
                                       
                                          δ
                                          →
                                          1
                                       
                                    
                                 
                                 
                                 Pr
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 >
                                 δ
                                 |
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 >
                                 δ
                                 )
                                 =
                                 
                                    
                                       
                                          lim
                                       
                                       
                                          δ
                                          →
                                          1
                                       
                                    
                                 
                                 
                                 Pr
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 >
                                 δ
                                 |
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 >
                                 δ
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       τ
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 
                                    
                                       
                                          lim
                                       
                                       
                                          ε
                                          →
                                          0
                                       
                                    
                                 
                                 
                                 Pr
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ⩽
                                 ε
                                 |
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ⩽
                                 ε
                                 )
                                 =
                                 
                                    
                                       
                                          lim
                                       
                                       
                                          ε
                                          →
                                          0
                                       
                                    
                                 
                                 
                                 Pr
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ⩽
                                 ε
                                 |
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ⩽
                                 ε
                                 )
                                 .
                              
                           
                        
                     

Tail dependence captures the behavior between X
                        1 and X
                        2 during extreme events. Informally, upper tail dependence measures the probability that we will observe an extremely large value of F
                        1(x
                        1), given that F
                        2(x
                        2) has had an extremely large value (and vice versa). Lower tail dependence measures the probability that we will observe an extremely small value of F
                        1(x
                        1), given that F
                        2(x
                        2) has had an extremely small value (and vice versa).

According to Joe (1997), the rank correlations of Kendall’s τ and Spearman’s ρ can be directly measured using a copula as follows:
                           
                              (10)
                              
                                 τ
                                 =
                                 4
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 C
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 dC
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 -
                                 1
                                 ,
                              
                           
                        
                        
                           
                              (11)
                              
                                 ρ
                                 =
                                 12
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 {
                                 C
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 }
                                 
                                    
                                       dx
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       dx
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     

The maximum likelihood (ML) and inference functions for the margins (IFM) methods are two of the most widely used methods for parameter estimation (Joe & Xu, 1996). Joe (1997) and Patton (2006) found that the IFM method is more efficient and computationally simpler than the ML method. We use the IFM method to estimate the parameters in marginal distribution and in SJC copula. The IFM method is a two-step procedure. In the first step, we estimate v and λ in SK-t(z
                        
                           t
                        ∣v,
                        λ). In the second step, we estimate τ
                        
                           U
                         and τ
                        
                           L
                         in the SJC copula after estimating v and λ. Let θ, θ
                        
                           c
                        , θ
                        1, and θ
                        2 denote the parameters of f(x
                        1,
                        x
                        2), c
                        
                           SJC
                        (u
                        1,
                        u
                        2), f
                        1(x
                        1), and f
                        2(x
                        2), respectively. Based on Eq. (5), the following log-likelihood function is set:
                           
                              (12)
                              
                                 log
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ;
                                 θ
                                 )
                                 =
                                 log
                                 
                                    
                                       c
                                    
                                    
                                       SJC
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ;
                                 
                                    
                                       θ
                                    
                                    
                                       C
                                    
                                 
                                 )
                                 +
                                 log
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ;
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 log
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ;
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 .
                              
                           
                        The first step of the IFM method maximizes 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              log
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ;
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              log
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ;
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         to obtain the maximum likelihood estimators 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           
                        , respectively, where
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 arg
                                 
                                 max
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 log
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ;
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 
                                 and
                                 
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 arg
                                 
                                 max
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 log
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ;
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

In the second step, 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                           
                         is estimated by maximizing 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              log
                              
                                 
                                    c
                                 
                                 
                                    SJC
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ;
                              
                                 
                                    θ
                                 
                                 
                                    c
                                 
                              
                              )
                           
                        , where 
                           
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ;
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ;
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        . That is,
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 arg
                                 
                                 max
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 log
                                 
                                    
                                       c
                                    
                                    
                                       SJC
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ;
                                 
                                    
                                       θ
                                    
                                    
                                       c
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

In the literature, copulas are used to measure the dependence between financial time series after these series are matched/synchronized. Consequently, to estimate the parameters of the copula, the log-likelihood function in the second step of IFM is summed up over the log-returns of matched pairs. However, this work identifies a joint PDF of two source log-returns to enable the alignment of the source pairwise log-returns via the derived joint PDF. The log-likelihood functions log
                        f
                        1(x
                        1,
                        θ
                        1) and log
                        f
                        2(x
                        2,
                        θ
                        2) in Eq. (13) (first step of IFM) are summed up over all source log-returns x
                        1 and x
                        2, respectively. The log-likelihood function 
                           
                              log
                              
                                 
                                    c
                                 
                                 
                                    SJC
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ;
                              
                                 
                                    θ
                                 
                                 
                                    c
                                 
                              
                              )
                           
                         in Eq. (14) (second step of IFM) is summed up over all possible 
                           
                              (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         pairs from the source data, rather than over matched 
                           
                              (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         pairs.

In bioinformatics, two sequences are not required to have the same length. However, the order of elements in each sequence is fixed in the alignment. To achieve improved correspondence between two sequences, gaps can be introduced in both sequences. After alignment, the resulting sequences have the same length, and no column contains two gaps. When improved alignment is possible, a gap penalty is used to determine whether a gap can be accepted in an alignment. Together with gap penalty, a scoring scheme for letter alignment is assigned. The best sequence alignment is an alignment that optimizes the total score (Mount, 2004). For instance, in pairwise letter sequences AGGACT and ACGTACA, the scoring scheme is assigned as letter-to-letter (match): 1, letter-to-letter (mismatch): 0, letter-to-gap: −1, and gap-to-letter: −1. Let “–” denote a gap. Three possible alignments are listed in Fig. 1
                        .

Alignment-1 adds one gap at the end of first sequence to complete the alignment. Alignment-2 adds one gap in the middle of the first sequence. Alignment-2 also has the highest total score. With no mismatch, Alignment-3 adds three gaps in the first sequence and two gaps in the second sequence. The total score of Alignment-3 is the smallest among all alignments. The quality of a produced alignment depends on the quality of the scoring function. If the scoring scheme is reassigned as letter-to-letter (match): 2, letter-to-letter (mismatch): −1, letter-to-gap: 0, and gap-to-letter: 0. As shown in Fig. 2
                        , Alignment-1 has the smallest total score (0), whereas Alignment-3 has the highest total score (8). Alignment-3 has the smallest total score in Fig. 1.

With a zero gap penalty (i.e., the scores of letter-to-gap and gap-to-letter are set to zero), each letter aligned with a gap in the same column can be filtered out without changing the total score. In bioinformatics, a negative gap penalty is a tool for handling errors in experiments (Pichl et al., 2006). In finance, time series are drawn from various markets because of different holidays or working days across countries that are not synchronized despite having fixed start and end days. This paper assigns a gap penalty of zero to address this situation. As a result, a gap inserted in the financial time series filters out the value matched to the gap and implies a time delay. In economics, a gap is treated as a dummy holiday and a time delay of certain length between two sequences corresponding to the finite response time.

A financial time series is a sequence of real numbers, each of which represents one value at a time. In contrast to Hayashi et al. (2007) and Yamano et al. (2008), who transformed financial time series into symbolic sequences, this study directly aligns pairwise numerical sequences. We assume that X
                        =
                        x
                        1, x
                        2, …, x
                        
                           n
                         and Y
                        =
                        y
                        1, y
                        2, …, y
                        
                           m
                         are two real-number financial time series of lengths n and m, respectively, and that f (x,
                        y) is the PDF of X and Y derived by the SJC copula. The scores for aligning x
                        
                           i
                         to y
                        
                           j
                        , x
                        
                           i
                         to –, and – to y
                        
                           j
                         are assigned to s(x
                        
                           i
                        ,
                        y
                        
                           j
                        )=
                        f(x
                        
                           i
                        ,
                        y
                        
                           j
                        ), s(x
                        
                           i
                        ,−)=0, and s(−,
                        y
                        
                           j
                        )=0, respectively. A positive f (x
                        
                           i
                        ,
                        y
                        
                           j
                        ) measures the dependence of x
                        
                           i
                         and y
                        
                           j
                        . Zero s(x
                        
                           i
                        ,−) and s(−,
                        y
                        
                           j
                        ) imply a time delay.

The dynamic programming method introduced by Needleman and Wunsch (1970) is employed to align the pairwise financial time series to achieve the highest total score. Assuming that S(X
                        
                           i
                        ,
                        Y
                        
                           j
                        ) denotes the highest total score for aligning X
                        
                           i
                        
                        =
                        x
                        1, x
                        2, …, x
                        
                           i
                         and Y
                        
                           j
                        
                        =
                        y
                        1, y
                        2, …, y
                        
                           j
                        , the dynamic programming recursively solves the following formula until S(X
                        
                           n
                        ,
                        Y
                        
                           m
                        ) is attained:
                           
                              (15)
                              
                                 S
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    max
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         j
                                                         -
                                                         1
                                                      
                                                   
                                                   )
                                                   +
                                                   0
                                                   =
                                                   S
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         j
                                                         -
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   S
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                         -
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         j
                                                         -
                                                         1
                                                      
                                                   
                                                   )
                                                   +
                                                   f
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   S
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                         -
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   +
                                                   0
                                                   =
                                                   S
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                         -
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 for
                                 
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 n
                                 ,
                                 1
                                 ⩽
                                 j
                                 ⩽
                                 m
                                 ,
                              
                           
                        with initial conditions S(X
                        0,
                        Y
                        0)=
                        S(X
                        
                           i
                        ,
                        Y
                        0)=
                        S(X
                        0,
                        Y
                        
                           j
                        )=0.

In Eq. (15), S(X
                        
                           i
                        ,
                        Y
                        
                           j−1)+0, S(X
                        
                           i−1,
                        Y
                        
                           j−1)+
                        f(x
                        
                           i
                        ,
                        y
                        
                           j
                        ), and S(X
                        
                           i−1,
                        Y
                        
                           j
                        )+0 correspond to the last pair of elements aligned between X
                        
                           i
                        
                        =
                        x
                        1
                        x
                        2…x
                        
                           i
                         and Y
                        
                           j
                        
                        =
                        y
                        1
                        y
                        2…y
                        
                           j
                         is, namely, – to y
                        
                           j
                        , x
                        
                           i
                         to y
                        
                           j
                        , and x
                        
                           i
                         to –, respectively. Based on the efficient algorithm of Myers and Miller (1989), who recast the problem of aligning two sequences as an equivalent problem of finding a maximum-score path in a certain graph, a pseudo-code of a dynamic- programming alignment algorithm is provided in Appendix A.

We investigate the dependence among the stock indices of the Four Asian Dragons: Hong Kong (HK), South Korea (KR), Singapore (SP), and Taiwan (TW). Our data are obtained from the Taiwan Economic Journal, sampled at a daily frequency and covering 1 January 2000–31 December 2010. Table 1
                         lists observations and summary statistics on the daily returns of the first to fourth moments. Daily returns r
                        
                           t
                         are computed as 100(ln
                        p
                        
                           t
                        
                        −ln
                        p
                        
                           t−1), where p
                        
                           t
                         is the stock index value at time t. In Table 1, all skewness is negative, which implies that the returns skew to the left. All kurtosis are significantly higher than 3. In addition to skewness and excess kurtosis, which indicate that all return series are not normally distributed, the Jarque–Bera statistic JB rejects normality for all return series.

We examine the serial dependency of returns. The Ljung–Box Q-statistic up lag 10, Q(10), indicates that the returns of TW and HK are serially correlated. Engle’s ARCH statistic (1982) up lag 5, LM(5), indicates that all returns exist in conditional heteroscedasticity. In summary, the empirical distributions of returns indicate fatter tails than the normal distribution, and squared returns are serially correlated up to lag 5. Therefore, skewed SK-t distribution and the asymmetric GJR-GARCH model are used to characterize the data.

Based on statistics Q(10) and LM(5) in Table 1, we remove the serial correlation in the returns of HK and TW with autoregressive process AR (1) and filter the volatilities of HK with SK-t GJR-GARCH (1,0,1) and those of KR, SP, and TW with SK-t GJR-GARCH (1,1,1). The results are listed in Table 2
                        . All GJR-GARCH (1,0,1) parameters (δ
                        +,
                        ξ) and GJR-GARCH (1,1,1) parameters (δ
                        +,
                        δ
                        −,
                        ξ) are statistically significant, which indicates that GJR-GARCH models can capture conditional heteroscedasticity for all returns. The estimation of SK-t parameters v and λ are of particular interest. Table 2 indicates that all filtered returns are negatively skewed and have fat distribution tails, as all estimated λ (statistically significant at the 1% level) are negative and no estimated v (statistically significant at the 1% level) is greater than 10.

We use LM and KS tests as goodness-of-fit tests for our marginal distributions (Table 3
                        ). The p-values from the LM tests are all higher than 0.01, implying the null hypothesis that marginal cumulative distribution functions (CDFs) are serially independent cannot be rejected at the 1% level. The p-values from the KS tests are all higher than 0.01, indicating that the probability transforms of the marginal distributions are uniformly distributed at (0,1) at the 1% significance level. Thus, our marginal models based on Eqs. (1)–(4) have correct specifications for the returns of the four markets. As a result, the copula model can correctly capture the dependence structure of the pairwise market returns.

The computed CDFs of the marginal SK-t distributions are plugged into the copula model to estimate the SJC copula parameters by the IFM method (Section 2.4). Table 4
                         lists the estimations at the end of the convergence of the IFM method. In Table 4, τ
                        
                           U
                         for all pairs are equal to 1exp-12. The nearly zero τ
                        
                           U
                        
                        =1exp-12 indicates that no right-tail dependence occurs in all market pairs. The τ
                        
                           L
                         values, which are statistically significant, range from 2.59exp-04 to 2.77exp-04. These minimal τ
                        
                           L
                         indicate that weak left-tail dependence occurs in all pairs. An interesting and important implication of these minimal τ
                        
                           L
                         is that, although all the skewness in Table 1 are negative (i.e., each return has a fat left tail), the probability that extremely small CDFs of any two market returns exist simultaneously is low.

All of the Kendall’s τ and Spearman’s ρ, computed according to Eqs. (10) and (11), are close to 0.04, which indicates a weak concordance between any two source time series.

The joint PDF f(x,
                        y) derived by the SJC copula is then used as a scoring scheme to align observations between market pairs X and Y. Observations of markets X and Y are also synchronized based on common working days. Hereafter, SA-based (sync-based) market pairs denote the observations between market pairs that are matched based on the sequence alignment (common working days) method. The numbers of matched observations in SA- and sync-based market pairs are listed in Table 5
                        .

To represent time delay for achieving optimal alignment, we treat a gap as a dummy holiday and assign zero gap penalty (i.e., f(x
                        
                           i
                        ,−)=0 and f(−,
                        y
                        
                           j
                        )=0) to filter out a value by aligning it with a gap. We assume that ∣(·,·)∣ denotes the number of (·,·). In Table 5, for all market pairs, ∣(x
                        
                           i
                        ,−)∣>∣(w
                        
                           t
                        ,
                        h
                        
                           t
                        )∣,∣(x
                        
                           i
                        ,
                        y
                        
                           j
                        )∣<∣(w
                        
                           t
                        ,
                        w
                        
                           t
                        )∣, and ∣(−,
                        y
                        
                           j
                        )∣>∣(h
                        
                           t
                        ,
                        w
                        
                           t
                        )∣. This means that to obtain the highest score in the optimization alignment between markets X and Y, some common working days in both X and Y are not aligned together (with respect to ∣(x
                        
                           i
                        ,
                        y
                        
                           j
                        )∣<∣(w
                        
                           t
                        ,
                        w
                        
                           t
                        )∣), some working days in X are treated as dummy holidays in Y (with respect to ∣(x
                        
                           i
                        ,−)∣>∣(w
                        
                           t
                        ,
                        h
                        
                           t
                        )∣), and some working days in Y are treated as dummy holidays in X (with respect to ∣(−,
                        y
                        
                           j
                        )∣>∣(h
                        
                           t
                        ,
                        w
                        
                           t
                        )∣).

For a comparison of the performance of the proposed model with that of the common working days model, we backtest the value-at-risk quantities of the paired market portfolios by the Berkowitz (2001), Christoffersen (1998) and Kupiec (1995) tests. The Kupiec test (1995) is known as the POF-test (proportion of failures). It tests the null-hypothesis that whether the number of exceptions is consistent with the confidence level. Christoffersen (1998) used the same log-likelihood testing framework as Kupiec, but included a separate statistic for the independence of exceptions. The null-hypothesis of Christoffersen test is that the expected proportion of exceptions equals to the expected one and the exceptions occur independently. Berkowitz (2001) proposed a methodology for jointly testing uniformity and independence. He transformed the probability integral transformations to make themselves iid standard normal under the null-hypothesis. The monograph of Jorion (2007) provides an extensive development of value-at-risk as well as backtesting methods. According to Jorion (2007), a confidence level of 95% suits well for backtesting purposes. We estimate the value-at-risk of the paired market portfolio returns at 95% confidence level. The number of exceptions is the number of portfolio returns that are out of the confidence level. The periods of becktests for SA-based and sync-based portfolios, respectively, are one duration between aligned pairs and one duration between common working days. The results of the backtests are displayed in Table 6
                        . For SA-based portfolios, p-values are all higher than 0.30, which implies that the SA-based model passes the Kupiec, Christoffersen, and Berkowitz tests at the 95% confidence level. By contrast, for sync-based portfolios, the HK–SP pair does not pass the Christoffersen test, and the KR–TW and SP–TW pairs do not pass the Berkowitz test all at the 95% confidence level. Thus, from the value-at-risk perspective, the proposed method outperforms the common working days method in modeling the dependence of financial returns. To provide an overall graphical review of portfolio returns and the number of exceptions of value-at-risk at the 95% confidence level (i.e., a 5% significance level for p-value), we plot the SA-based HK–KR portfolio returns and the 95% confidence level estimations in Fig. 3
                         as an illustration.

In Table 7
                        , we compute the Pearson r, Kendall’s τ, and Spearman’s ρ correlations of the SA- and sync-based market pairs. We observe that
                           
                              (1)
                              All Kendall’s τ and Spearman’s ρ correlations in Table 7 are significantly higher than the values computed directly from the copula (Eqs. (10) and (11)) of the source series in Table 4. This implies that we filter the source data to obtain good concordances by SA- and sync-based pairs.

For the SA-based market pairs, Kendall’s τ and Spearman’s ρ are consistent with each other. HK–SP has the strongest dependence, followed by HK–KR, KR–SP, HK–TW, and SP–TW; the weakest is KR–TW. For the sync-based market pairs, Kendall’s τ and Spearman’s ρ are also consistent with each other. However, the order is different from that of the SA-based pairs: HK–SP has the strongest dependence, followed by HK–KR, KR–TW, KR–SP, and HK–TW; the weakest is SP–TW. The only difference between SA- and sync-based market pairs is that the τ and ρ of KR–TW are the lowest in SA-based pairs, but the third highest in sync-based pairs. The magnitudes of the other five market pairs have the same order in both SA- and sync-based pairs. The descending order is HK–SP, HK–KR, KR–SP, HK–TW, and SP–TW.

Both the Kendall’s τ and Spearman’s ρ of the SA-based market pairs are higher than the corresponding values of the sync-based market pairs. This indicates that stronger concordant and rank dependence between financial series can be obtained by the GARCH-copula based sequence alignment rather than by traditional common working days synchronization method.

For Pearson r correlations, the values of the SA-based market pairs are higher than those of the sync-based market pairs in HK–TW and SP–TW. In the four other market pairs, SA-based values are lower than sync-based values. The inconsistent values between SA- and sync-based pairs are reasonable because (1) Pearson’s r, which assumes bivariate normally distributed returns, is an ineffective measure of dependence for fat-tailed financial data (Embrechts et al., 2002) and (2) all the empirical distributions of market returns display fatter tails than the normal distribution.

@&#CONCLUSION@&#

In contrast to traditional synchronization procedure, which matches financial time series based on common working days, this paper proposes a novel method of matching financial time series systematically to measure rank correlations between the series. The algorithm comprises four stages. First, returns of the series are fitted as skewed-t distributions by the GJR-GARCH model. Next, the SJC copula is used to compute the joint probability density function between the fitted skewed-t distributions. Then, we employ the joint probability density function as the scoring scheme and solve the optimal sequence alignment problem via dynamic programming. Based on the optimality of sequence alignment, SA-based pairs are obtained between the financial time series. Finally, the rank correlation coefficients between the financial time series are computed in terms of the SA-based pairs. Illustrations of the proposed algorithm are conducted with the empirical financial data of the Four Asian Dragons. The results of backtests on portfolio value-at-risk evaluation reveal that the proposed method outperforms the standard common working days policy. Based on rank correlation coefficients, Kendall’s τ and Spearman’s ρ, we compare popular sync-based pairs with the proposed SA-based pairs. Empirical experiments show that (1) the values of the rank correlations computed directly from the SJC copulas fitted for source pair time series are small, (2) both the Kendall’s τ and Spearman’s ρ correlations are consistent with each other among the SA- and sync-based market pairs, and (3) both the Kendall’s τ and Spearman’s ρ correlations of the SA-based market pairs are higher than those of the sync-based market pairs. Thus, stronger concordant and rank dependence between financial series can be obtained by the proposed algorithm rather than by the traditional common working days method.

Finally, it is noted here that, to estimate a time-varying rank correlation, we can apply the rolling-window periodic sampling technique (Hill, 2007; Swanson, 1998) and repeat the proposed four-stage algorithm at each sample period.

@&#ACKNOWLEDGEMENTS@&#

The author is grateful to Editor Immanuel Bomze and three anonymous referees for constructive comments and suggestions to improve the content and exposition of this paper. This research is partially supported by the National Science Council (Taiwan, ROC) under Grant NSC102-2410-H-275-007.


                     
                        
                           
                              
                              
                                 
                                    
                                       Input: 
                                       X
                                       =
                                       x
                                       1
                                       x
                                       2…x
                                       
                                          n
                                       , Y
                                       =
                                       y
                                       1
                                       y
                                       2…y
                                       
                                          m
                                       , and f(x
                                       
                                          i
                                       ,
                                       y
                                       
                                          j
                                       ) for 1⩽
                                       i
                                       ⩽
                                       n, 1⩽
                                       j
                                       ⩽
                                       m
                                    
                                 
                                 
                                    
                                       Output: Aligned pairs (x
                                       
                                          k
                                       ,
                                       y
                                       
                                          k
                                       )
                                 
                                 
                                    
                                       Procedure:
                                    
                                 
                                 
                                    
                                       
                                       For 
                                       i
                                       =1 to n
                                    
                                 
                                 
                                    
                                       
                                       For 
                                       j
                                       =1 to m
                                    
                                 
                                 
                                    
                                       
                                       
                                       S(X
                                       
                                          i
                                       ,
                                       Y
                                       
                                          j
                                       )=
                                       S(X
                                       
                                          i
                                       ,
                                       Y
                                       
                                          j−1)
                                 
                                 
                                    
                                       
                                       Pathtype (i,
                                       j)=1
                                 
                                 
                                    
                                       
                                       
                                       If 
                                       S(X
                                       
                                          i
                                       ,
                                       Y
                                       
                                          j
                                       )<
                                       S(X
                                       
                                          i−1,
                                       Y
                                       
                                          j−1)+
                                       f(x
                                       
                                          i
                                       ,
                                       y
                                       
                                          j
                                       )
                                 
                                 
                                    
                                       
                                       
                                       Then
                                       
                                       S(X
                                       
                                          i
                                       ,
                                       Y
                                       
                                          j
                                       )=
                                       S(X
                                       
                                          i−1,
                                       Y
                                       
                                          j−1)+
                                       f(x
                                       
                                          i
                                       ,
                                       y
                                       
                                          j
                                       )
                                 
                                 
                                    
                                       
                                       
                                       Pathtype (i,
                                       j)=2
                                 
                                 
                                    
                                       
                                       
                                       If 
                                       S(X
                                       
                                          i
                                       ,
                                       Y
                                       
                                          j
                                       )<
                                       S(X
                                       
                                          i−1,
                                       Y
                                       
                                          j
                                       )
                                 
                                 
                                    
                                       
                                       
                                       Then
                                       
                                       S(X
                                       
                                          i
                                       ,
                                       Y
                                       
                                          j
                                       )=
                                       S(X
                                       
                                          i−1,
                                       Y
                                       
                                          j
                                       )
                                 
                                 
                                    
                                       
                                       
                                       Pathtype (i,
                                       j)=3
                                 
                                 
                                    
                                       
                                       End 
                                       j loop
                                 
                                 
                                    
                                       
                                       End 
                                       i loop
                                 
                                 
                                    
                                       
                                       i
                                       =
                                       n
                                    
                                 
                                 
                                    
                                       
                                       j
                                       =
                                       m
                                    
                                 
                                 
                                    
                                       
                                       length
                                       =0
                                 
                                 
                                    
                                       
                                       Do
                                    
                                 
                                 
                                    
                                       
                                       length
                                       =
                                       length
                                       +1
                                 
                                 
                                    
                                       
                                       If Pathtype (i,
                                       j)=1
                                 
                                 
                                    
                                       
                                       
                                       Then
                                       Aligned_x_backward (length)=“–”
                                 
                                 
                                    
                                       
                                       Aligned_y_backward (length)=“y
                                       
                                          j
                                       ”
                                 
                                 
                                    
                                       
                                       
                                       j
                                       =
                                       j
                                       −1
                                 
                                 
                                    
                                       
                                       
                                       ElseIF
                                       Pathtype (i,
                                       j)=2
                                 
                                 
                                    
                                       
                                       
                                       Then Aligned_x_backward (length)=“x
                                       
                                          i
                                       ”
                                 
                                 
                                    
                                       
                                       
                                       
                                       Aligned_y_backward (length)=“y
                                       
                                          j
                                       ”
                                 
                                 
                                    
                                       
                                       
                                       
                                       i
                                       =
                                       i
                                       −1
                                 
                                 
                                    
                                       
                                       
                                       
                                       j
                                       =
                                       j
                                       −1
                                 
                                 
                                    
                                       
                                       
                                       ElseIF Pathtype (i,
                                       j)=3
                                 
                                 
                                    
                                       
                                       
                                       
                                       Then Aligned_x_backward (length)=“x
                                       
                                          i
                                       ”
                                 
                                 
                                    
                                       
                                       
                                       
                                       Aligned_y_backward (length)=“–”
                                 
                                 
                                    
                                       
                                       
                                       
                                       i
                                       =
                                       i
                                       −1
                                 
                                 
                                    
                                       
                                       EndIf
                                    
                                 
                                 
                                    
                                       
                                       Until 
                                       i
                                       =0 & j
                                       =0
                                 
                                 
                                    
                                       For 
                                       i
                                       =1 to length
                                    
                                 
                                 
                                    
                                       Aligned_x_forward (i)=Aligned_x_backward (length
                                       +1−
                                       i)
                                 
                                 
                                    
                                       Aligned_y_forward (i)=Aligned_y_backward (length
                                       +1−
                                       i)
                                 
                                 
                                    
                                       End 
                                       i loop
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

