@&#MAIN-TITLE@&#Extended-dimensional anisotropic diffusion using diffusion paths on inter-color planes for noise reduction

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We extend the diffusion dimension of typical anisotropic diffusion for denoising.


                        
                        
                           
                           Diffusion dimension is extended by producing diffusion paths on inter-color planes.


                        
                        
                           
                           Inter-color prediction is proposed to properly utilize an inter-color correlation.


                        
                        
                           
                           Regionally and directionally varying diffusion threshold is proposed.


                        
                        
                           
                           In the results, the proposed method showed an outstanding denoising performance.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image denoising

Extended anisotropic diffusion

Inter-color diffusion

Inter-color prediction

@&#ABSTRACT@&#


               
               
                  This paper presents an anisotropic diffusion (AD)-based noise reduction that extends the diffusion dimensions of a typical AD by producing diffusion paths on inter-color planes. To properly utilize an inter-color correlation for the AD-based noise reduction, inter-color planes from different color planes are predicted by adjusting their local mean values. Then, diffusion path-based kernels (DPKs) for the current color plane and predicted inter-color planes (PIPs) are generated to transform the iterative AD into a single-pass smoothing, which can avoid iterative region analysis. Simultaneously, a regionally and directionally varying diffusion threshold is adopted for the current color plane to preserve image details and to improve the quality of noise elimination near strong edges. For the PIPs, diffusion thresholds are regionally adjusted depending on local correlations between the current color plane and each of the PIPs to optimize the performance of noise reduction obtained from the extended diffusion dimension. Lastly, DPK-based filtering is performed in the current color plane and PIPs by using selected diffusion thresholds for the noise reduction. The experimental results demonstrate that the proposed method successfully improves the quality of denoising by greatly increasing the peak signal-to-noise ratio and structural similarity indexes by up to 4.921 dB and 0.090, respectively, compared with benchmark methods. In addition, the proposed method effectively reduces the computational complexity by avoiding the use of an expensive region analysis.
               
            

@&#INTRODUCTION@&#

Image and video signals are often contaminated by image noise during acquisition, transmission, or recording processes. Because this image noise significantly degrades the image quality, image denoising is exploited in many digital image processing applications. Linear smoothing is the most fundamental and intuitive image denoising approach, where all pixels are averaged evenly without incorporation of structural information, such as image details or image boundaries. Thus, it causes severe loss of structural information during the smoothing process. To alleviate this problem, structure-preserving image denoising, which eliminates image noise by incorporating structural information, has been extensively exploited [6,14,23,25]. This approach can be broadly divided into two categories [18]: the kernel-based method and the partial differential equation (PDE)-based method [2,15,28]. The kernel-based method makes a filter kernel by considering structural information for grouping similar pixels when it restores a current pixel value. Adaptive smoothing [26], bilateral filtering [30,35], non-local means filtering [5], and mean-shift filtering [11] are included in the kernel-based method. The PDE-based method utilizes a PDE for formulating the denoising process and restores a pixel value by solving the PDE. Several methods, such as total variation diffusion [8,29] and anisotropic diffusion (AD) [24], have been proposed. Among the PDE-based methods, AD is widely used in image denoising because of its high denoising performance and low computational cost.

AD, often called the Perona and Malik (PM) model, applies a diffusion process on an image domain to remove gray-level variations caused by image noise. During the diffusion process, it utilizes a time- and spatially varying diffusivity to preserve structural information while removing image noise. The diffusivity is adjusted by gray-level differences between a pixel and its neighboring pixels. Accordingly, the diffusivity is reduced at a region where the gradients are high, thereby decreasing smoothing strength. Therefore, the structural information in this region is preserved or even enhanced. Based on this approach, various research studies have been proposed to enhance the quality of the structural information preservation and noise reduction by modifying the diffusivity selection or the gradient calculation. Catté et al. [7] utilized Gaussian smoothing before the gradients calculation to solve the ill-posed problem of AD for various images and to improve the accuracy of the gradient calculation. Weickert [33] indicated that the PM model cannot consider the edge direction of a pixel because it uses a scalar-valued diffusion coefficient. As a result, the PM model could not successfully remove the image noise in a region having a low diffusivity. To alleviate this problem, Weickert introduced a diffusion tensor to accelerate diffusion along the edge direction while preventing the diffusion perpendicular to the direction of the edge. Consequently, it improves the performance of noise elimination in a region near strong edges. Yu et al. [34] introduced the kernelized gradient operator to improve the separation between the image signal and noise signal during the gradient calculation. In [9] and [21], the diffusion threshold for a pixel is adaptively determined by utilizing a local variance to preserve structural information. Cho et al. [10] proposed a dictionary-based AD method (DAD) that regionally selects the optimal diffusion threshold using a pre-trained dictionary. In addition, the iterative AD operations are transformed into single-pass smoothing by using a diffusion path-based kernel (DPK). By using DPK-based filtering with the optimal diffusion threshold, the performance of noise reduction and the computational efficiency were greatly improved over typical AD. Moreover, this architecture of single-pass filtering makes it easier to implement a real-time HW of AD-based noise reduction.

Although the DAD method shows the most promising noise reduction performance from among the conventional AD-based methods, further improvements can be possible by following feasible strategies.

First, in the conventional AD-based methods, the diffusion process is naturally applied channel-wise while the diffusivity is coupled across all channels by combining the gradient values in multi-channels. In this scheme, conventional AD-based methods cannot utilize pixel values (not a gradient) in the other channels when the diffusivity-based restoration of a pixel value in the current channel is performed. In most images, RGB color channels are highly correlated [17]. Hence, if these highly correlated pixel values are used for the diffusivity-based pixel value restoration in an efficient way (such as multi-channel diffusion), the quality of denoising can be significantly improved. Specifically, if this inter-color correlation is utilized with DPK-based filtering, which enhances the efficiency of AD-based noise reduction, the denoising performance can be further improved. Second, the conventional AD-based methods, including DAD, cannot successfully remove image noise near strong edges when they utilize the regionally adaptive diffusion threshold for structural information preservation. This is because they apply a low smoothing strength for all directions of a pixel near strong edges. This problem can be alleviated by selectively applying the directionally varying diffusion threshold for a pixel near strong edges.

In this paper, we propose a novel AD-based noise reduction method that extends the dimension of diffusion by considering inter-color planes which mean the other two color planes from one color plane (the current color plane) in a given RGB input image [16,20]. In this method, the inter-color planes predicted from different color planes, and an extended DPK is produced by analyzing diffusion paths in the predicted inter-color planes (PIPs) in addition to the current color plane. Simultaneously, by exploiting a local correlation between each pair of color planes, regionally adaptive diffusion thresholds for the PIPs are used to generate the extended DPK. For the current color plane, the directionally varying diffusion threshold is selectively adopted for a pixel having a low diffusion threshold to mitigate the unsuccessful removal of image noise near strong edges.

The remainder of this paper is organized as follows. In Section 2, the operation of the proposed method is described. In Section 3, the experimental results are demonstrated. Finally, Section 4 concludes the paper.

@&#PROPOSED METHOD@&#

The proposed method is based on DPK-based filtering, which transforms the iterative AD into a single-pass adaptive smoothing for avoiding the iterative region analysis and enhancing the noise filtering efficiency. As shown in Fig. 1
                     , the proposed method extends the diffusion dimension of typical AD by producing DPK for inter-color planes (
                        
                           
                              DPK
                           
                           
                              PIP
                           
                        
                     ) in addition to DPK for the current color plane (
                        
                           
                              DPK
                           
                           
                              C
                           
                        
                     ). For this, the proposed method produces the predicted inter-color planes (PIPs) from different inter color planes (IPs). Then, it extracts regionally adaptive diffusion thresholds for the current color plane and PIPs (
                        
                           
                              K
                           
                           
                              C
                           
                        
                      and 
                        
                           
                              K
                           
                           
                              PIP
                           
                        
                     s) by performing a region analysis in each color plane. After determining K values, 
                        
                           
                              DPK
                           
                           
                              C
                           
                        
                      and 
                        
                           
                              DPK
                           
                           
                              PIP
                           
                        
                      are generated by analyzing the diffusion process of the extended AD. Finally, the DPK-based filtering is performed in a combined color plane (the current color plane and PIPs) by utilizing 
                        
                           
                              DPK
                           
                           
                              C
                           
                        
                      and 
                        
                           
                              DPK
                           
                           
                              PIP
                           
                        
                      to restore a pixel value. The operation of the proposed method is described in detail as follows.


                        Fig. 2
                         shows the current color plane (R plane) and its inter-color planes (G and B planes) of 17th image in Kodak image set. As shown in this figure, the R, G, and B color planes are generally highly correlated. Before utilizing inter-color planes (IPs) directly, it should be modified to be suitable for the AD-based image denoising. Although the current color plane and IPs are highly correlated, the gray levels of local regions can be very different when the local region has a high chroma value. Because the AD adjusts the diffusion strength depending on the gray-level difference, gray levels in the IP should be modified before generating inter-color diffusion by matching local mean values between the current color plane and IP. The prediction of the IP is performed by adjusting the local mean value as follows [12]:
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             PIP
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          
                                             I
                                          
                                          
                                             IP
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       +
                                       
                                          
                                             O
                                          
                                          
                                             C
                                             -
                                             
                                                IP
                                             
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             O
                                          
                                          
                                             C
                                             -
                                             
                                                IP
                                             
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          I
                                          ‾
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       −
                                       
                                          
                                             
                                                I
                                                ‾
                                             
                                          
                                          
                                             IP
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ,
                                    
                                 
                              
                           
                         where 
                           I
                           (
                           x
                           ,
                           y
                           )
                         and 
                           
                              
                                 I
                              
                              
                                 IP
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         are gray levels of a pixel (
                           x
                           ,
                           y
                        ) in the current color plane and the IP, respectively. 
                           
                              
                                 O
                              
                              
                                 C
                                 -
                                 
                                    IP
                                 
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         is the offset value between the current color plane and IP. 
                           
                              
                                 I
                              
                              
                                 PIP
                              
                           
                         denotes the gray level of a pixel at (
                           x
                           ,
                           y
                        ) in the PIP, which is directly used to produce inter-color diffusion. 
                           
                              I
                              ‾
                           
                           (
                           x
                           ,
                           y
                           )
                         and 
                           
                              
                                 
                                    I
                                    ‾
                                 
                              
                              
                                 IP
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         are the mean values of blocks centered at a pixel (
                           x
                           ,
                           y
                        ) in the current color plane and the IP, respectively. When each color plane is contaminated by AWGN (the image noise, especially an additive white Gaussian noise (AWGN), which is most widely used for the image noise model [3,22]), Eq. (1) is a good approach for the inter-color prediction because a mean value can be used as the estimation of the noise-free gray level in a smooth region. Hence, it can extract the accurate offset values from noisy images. By adding the offset value to the 
                           
                              
                                 I
                              
                              
                                 IP
                              
                           
                        , it can match the mean value of local regions between 
                           
                              
                                 I
                              
                              
                                 IP
                              
                           
                         and 
                           
                              
                                 I
                              
                              
                                 C
                              
                           
                         while maintaining the spatial gradients in 
                           
                              
                                 I
                              
                              
                                 IP
                              
                           
                        . As a result, PIP can be used as the extension of the current color plane. The block size (
                           
                              
                                 BS
                              
                              
                                 M
                              
                           
                        ) for the local mean value calculation is set to 
                           7
                           ×
                           7
                         pixels, which is the same size with the DPK filtering in the current color plane (DPK filtering will be explained in Section 2.2). Fig. 2 shows the result of the inter-color prediction.

After the inter-color prediction, we analyze the diffusion paths in the current color plane and PIP to produce the 
                           
                              
                                 DPK
                              
                              
                                 C
                              
                           
                         and 
                           
                              
                                 DPK
                              
                              
                                 PIP
                              
                           
                        , respectively. By using the DPKs, the iterative AD is transformed into a single-pass smoothing. In DAD [10], DPK-based filtering successfully improved the efficiency of the AD-based noise reduction by enhancing the maximum smoothing strength and avoiding the expensive iterative region analysis. Thus, by utilizing DPK-based filtering, the above benefits can be applied to the proposed method. Before we design the DPKs for the current color plane and PIPs, the iteration number of typical AD should be determined. Hence, after applying the typical AD to extensive training data set, we set the number of iterations to three because the performance of the typical AD is saturated when the iteration number is close to three [10]. In some instances, an increase in the iteration number can improve the quality of denoised image; however, this can also lead to an increase in computational costs. Hence, we select three as the optimal iteration number of the typical AD and transform this three-stage AD into single-pass smoothing.

For producing DPKs, we first explain the operation of the typical AD. In a continuous domain, the typical AD can be formulated as follows:
                           
                              (2)
                              
                                 
                                    ∂
                                    I
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    t
                                    )
                                    /
                                    ∂
                                    t
                                    =
                                    
                                       div
                                    
                                    
                                       (
                                       g
                                       
                                          (
                                          ∇
                                          I
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          t
                                          )
                                          )
                                       
                                       ⋅
                                       ∇
                                       I
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       t
                                       )
                                       )
                                    
                                    ,
                                 
                              
                           
                         where div denotes the divergence operator and ∇ denotes the gradient operator. 
                           I
                           (
                           x
                           ,
                           y
                           ,
                           t
                           )
                         and 
                           g
                           (
                           ∇
                           I
                           (
                           x
                           ,
                           y
                           ,
                           t
                           )
                           )
                         denote the gray level of a pixel (
                           x
                           ,
                           y
                        ) at time t and its diffusion coefficient, respectively. The diffusivity function, 
                           g
                           (
                           ⋅
                           )
                        , to determine the diffusion coefficient is generally defined as follows [24]:
                           
                              (3)
                              
                                 
                                    g
                                    (
                                    ∇
                                    I
                                    )
                                    =
                                    1
                                    /
                                    
                                       (
                                       1
                                       +
                                       
                                          
                                             (
                                             |
                                             ∇
                                             I
                                             |
                                             /
                                             K
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                         where K denotes the diffusion threshold. K plays the role of a discrimination point between forward and backward modes. In the forward mode, gray-level variations are considered as image noise; thus, they are suppressed by the smoothing process. In the backward mode, gray-level variations are considered as image details, and they are preserved or even enhanced by increasing the slope of the edge. Consequently, the increase of K leads to the increase of the smoothing strength and the increase of the range for gray-level variations to be suppressed. Following the K value determination, in order to apply the continuous PDE to a discrete two-dimensional image domain, Eq. (2) can be discretely implemented by the following numerical approximation:
                           
                              (4)
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          I
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    +
                                    τ
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       D
                                    
                                    
                                       [
                                       g
                                       
                                          (
                                          ∇
                                          
                                             
                                                I
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          )
                                       
                                       ⋅
                                       ∇
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ]
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         denotes the gray level of a pixel (
                           x
                           ,
                           y
                        ) at time t. τ is a time step that determines the diffusion rate. D and i are the total number of diffusion directions and an index for direction, respectively. 
                           ∇
                           
                              
                                 I
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         represents the gradient between the current pixel (
                           x
                           ,
                           y
                        ) and its neighboring pixel in direction i at time t. To ensure the numerical stability of Eq. (4), τ should satisfy the following condition [32]:
                           
                              (5)
                              
                                 
                                    τ
                                    ≤
                                    1
                                    /
                                    
                                       (
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                D
                                             
                                             
                                                n
                                             
                                          
                                       
                                       2
                                       /
                                       
                                          
                                             L
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                         where i and 
                           
                              
                                 D
                              
                              
                                 n
                              
                           
                         denote a dimension index and the number of dimensions, respectively. 
                           
                              
                                 L
                              
                              
                                 i
                              
                           
                         is a neighborhood length in direction i. In short, the typical AD eliminates image noise by iteratively applying Eq. (4) to a given noisy image. Based on Eq. (4), the single stage of the AD in 1D space can be described as follows:
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       =
                                       τ
                                       
                                          [
                                          
                                             (
                                             
                                                
                                                   ∇
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                
                                                
                                                   W
                                                
                                             
                                             )
                                          
                                          
                                             
                                                g
                                             
                                             
                                                ∇
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      W
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             (
                                             
                                                
                                                   ∇
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                
                                                
                                                   E
                                                
                                             
                                             )
                                          
                                          
                                             
                                                g
                                             
                                             
                                                ∇
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      E
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       +
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ∇
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             W
                                          
                                       
                                       =
                                       
                                          
                                             I
                                          
                                          
                                             x
                                             −
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       −
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             ∇
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             E
                                          
                                       
                                       =
                                       
                                          
                                             I
                                          
                                          
                                             x
                                             +
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       −
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             g
                                          
                                          
                                             ∇
                                             I
                                          
                                       
                                       =
                                       g
                                       (
                                       ∇
                                       I
                                       )
                                       ,
                                    
                                 
                              
                           
                         where 
                           τ
                           =
                           1
                           /
                           2
                        , 
                           g
                           (
                           ⋅
                           )
                         is the diffusivity function and Eq. (3) is used for 
                           g
                           (
                           ⋅
                           )
                        . 
                           
                              
                                 I
                              
                              
                                 x
                              
                              
                                 t
                              
                           
                         denotes the gray level of a pixel (x) in the current color plane at time t.

For the extended dimensional AD, we transform Eq. (2) into Eq. (7) by extending the dimension of diffusion.
                           
                              (7)
                              
                                 
                                    ∂
                                    I
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    ,
                                    t
                                    )
                                    /
                                    ∂
                                    t
                                    =
                                    
                                       div
                                    
                                    
                                       (
                                       g
                                       
                                          (
                                          ∇
                                          I
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          ,
                                          t
                                          )
                                          )
                                       
                                       ⋅
                                       ∇
                                       I
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       ,
                                       t
                                       )
                                       )
                                    
                                    ,
                                 
                              
                           
                         where z is an index for the color plane in a given RGB image while x and y denote indexes for 2D spatial domain in each color plane. As described in Eq. (7), in the extended AD, the diffusion path between the current color plane and PIP (z axis) is generated in addition to the diffusion path in 2D spatial domain (x and y axes). By using the same scheme with the typical AD (Eqs. (2)–(5)), Eq. (7) can be discretely implemented by the following numerical approximation:
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                    
                                    
                                       
                                          
                                          =
                                          
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                          +
                                          τ
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         D
                                                      
                                                      [
                                                      g
                                                      (
                                                      ∇
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                      )
                                                      ⋅
                                                      ∇
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      +
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                      
                                                      [
                                                      g
                                                      (
                                                      ∇
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                      )
                                                      ⋅
                                                      ∇
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                      ]
                                                   
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                         denotes the gray level of a pixel (
                           x
                           ,
                           y
                           ,
                           z
                        ) at time t. 
                           
                              
                                 D
                              
                              
                                 I
                              
                           
                         and j are the total number of diffusion directions (in this case, it is set to two because there are two PIPs for a given RGB input image) and an index for direction on PIPs, respectively. 
                           ∇
                           
                              
                                 I
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                         denotes the gradient between the current pixel (
                           x
                           ,
                           y
                           ,
                           z
                        ) and its neighboring pixel in direction i at time t in the current color plane as in Eq. (4). 
                           ∇
                           
                              
                                 I
                              
                              
                                 j
                              
                              
                                 t
                              
                           
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                         represents the gradient between the current pixel (
                           x
                           ,
                           y
                           ,
                           z
                        ) and the pixel (
                           x
                           ,
                           y
                           ,
                           
                              
                                 z
                              
                              
                                 ′
                              
                           
                        ) located in PIP at time t. Actually, DPKc and 
                           
                              
                                 DPK
                              
                              
                                 PIP
                              
                           
                         in the proposed method will be derived from this discrete process. Hence, more precisely, the DPK-based filtering can be defined as a diffusion-inspired space-discrete filtering.

For the DPK derivation, first, we describe the single stage of the extended AD (Eq. (8)) as follows:
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       =
                                       τ
                                       
                                          [
                                          
                                             (
                                             
                                                
                                                   ∇
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                
                                                
                                                   W
                                                
                                             
                                             )
                                          
                                          
                                             
                                                g
                                             
                                             
                                                ∇
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      W
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             (
                                             
                                                
                                                   ∇
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                
                                                
                                                   E
                                                
                                             
                                             )
                                          
                                          
                                             
                                                g
                                             
                                             
                                                ∇
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      E
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            IP
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         ∇
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               IP
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             
                                                DIP
                                             
                                          
                                          ]
                                       
                                       +
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ∇
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             W
                                          
                                       
                                       =
                                       
                                          
                                             I
                                          
                                          
                                             x
                                             −
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       −
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             ∇
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             E
                                          
                                       
                                       =
                                       
                                          
                                             I
                                          
                                          
                                             x
                                             +
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       −
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             ∇
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             IP
                                          
                                       
                                       =
                                       
                                          
                                             I
                                          
                                          
                                             x
                                             ,
                                             
                                                PIP
                                             
                                          
                                          
                                             t
                                          
                                       
                                       −
                                       
                                          
                                             I
                                          
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                         where 
                           τ
                           =
                           1
                           /
                           3
                        , and 
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 
                                    PIP
                                 
                              
                              
                                 t
                              
                           
                         denotes the gray level of a pixel (x) in the PIP at time t. For simplicity, 1D spatial domain and one PIP are considered. DIP is the diffusion path on the PIP. If this extended AD is iteratively applied twice, the result can be expressed as follows:
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                x
                                             
                                             
                                                t
                                                +
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          =
                                          τ
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            τ
                                                            [
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                                  −
                                                                  1
                                                               
                                                               
                                                                  W
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        −
                                                                        1
                                                                     
                                                                     
                                                                        W
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                                  −
                                                                  1
                                                               
                                                               
                                                                  E
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        −
                                                                        1
                                                                     
                                                                     
                                                                        E
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                                  −
                                                                  1
                                                               
                                                               
                                                                  IP
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  ∇
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        −
                                                                        1
                                                                     
                                                                     
                                                                        IP
                                                                     
                                                                  
                                                               
                                                            
                                                            ]
                                                            +
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                                  −
                                                                  1
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            τ
                                                            [
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  W
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        W
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  E
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        E
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  IP
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  ∇
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        IP
                                                                     
                                                                  
                                                               
                                                            
                                                            ]
                                                            −
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ︷
                                             
                                             
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      W
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          ×
                                          
                                             
                                                g
                                             
                                             
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      W
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          +
                                          τ
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            τ
                                                            [
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  W
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        +
                                                                        1
                                                                     
                                                                     
                                                                        W
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  E
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        +
                                                                        1
                                                                     
                                                                     
                                                                        E
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  IP
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  ∇
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        +
                                                                        1
                                                                     
                                                                     
                                                                        IP
                                                                     
                                                                  
                                                               
                                                            
                                                            ]
                                                            +
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            τ
                                                            [
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  W
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        W
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  E
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        E
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  IP
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  ∇
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        IP
                                                                     
                                                                  
                                                               
                                                            
                                                            ]
                                                            −
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ︷
                                             
                                             
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      E
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          ×
                                          
                                             
                                                g
                                             
                                             
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      E
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          +
                                          τ
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            τ
                                                            [
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                                  ,
                                                                  
                                                                     PIP
                                                                  
                                                               
                                                               
                                                                  W
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        ,
                                                                        
                                                                           PIP
                                                                        
                                                                     
                                                                     
                                                                        W
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                                  ,
                                                                  
                                                                     PIP
                                                                  
                                                               
                                                               
                                                                  E
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        ,
                                                                        
                                                                           PIP
                                                                        
                                                                     
                                                                     
                                                                        E
                                                                     
                                                                  
                                                               
                                                            
                                                            −
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  IP
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        IP
                                                                     
                                                                  
                                                               
                                                            
                                                            ]
                                                            +
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                                  ,
                                                                  
                                                                     PIP
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            τ
                                                            [
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  W
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        W
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  E
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        E
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  ∇
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  IP
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        IP
                                                                     
                                                                  
                                                               
                                                            
                                                            ]
                                                            −
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ︸
                                             
                                             
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      IP
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          ×
                                          
                                             
                                                g
                                             
                                             
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      IP
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          +
                                          τ
                                          
                                             [
                                             
                                                (
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      W
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         W
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      E
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         E
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      IP
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         IP
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          +
                                          
                                             
                                                I
                                             
                                             
                                                x
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∇
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                W
                                             
                                          
                                          =
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                −
                                                1
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                          −
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                ∇
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                E
                                             
                                          
                                          =
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                +
                                                1
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                          −
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                         Eq. (10) can be re-formulated into an adaptive-smoothing formula as follows:
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                
                                                
                                                   t
                                                   +
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   τ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   
                                                      
                                                         ∇
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         −
                                                         1
                                                      
                                                      
                                                         W
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   
                                                      
                                                         ∇
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         W
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                   −
                                                   2
                                                
                                                
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   τ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   
                                                      
                                                         ∇
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         +
                                                         1
                                                      
                                                      
                                                         E
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   g
                                                
                                                
                                                   
                                                      
                                                         ∇
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         E
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                   +
                                                   2
                                                
                                                
                                                   t
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   S
                                                
                                                
                                                   w
                                                
                                             
                                             )
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             +
                                             
                                                (
                                                τ
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            W
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         
                                                            
                                                               τ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 W
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     (
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                                 −
                                                                                 1
                                                                              
                                                                              
                                                                                 W
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     2
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                                 −
                                                                                 1
                                                                              
                                                                              
                                                                                 E
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                                 −
                                                                                 1
                                                                              
                                                                              
                                                                                 IP
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     +
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                                 −
                                                                                 1
                                                                              
                                                                              
                                                                                 E
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 E
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 W
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 IP
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         τ
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               
                                                                  
                                                                     ∇
                                                                  
                                                                  
                                                                     t
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     W
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ︷
                                                   
                                                   A
                                                
                                                )
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                   −
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             +
                                             
                                                (
                                                τ
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            E
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         
                                                            
                                                               τ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 E
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     (
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                                 +
                                                                                 1
                                                                              
                                                                              
                                                                                 E
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     2
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                                 +
                                                                                 1
                                                                              
                                                                              
                                                                                 W
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                                 +
                                                                                 1
                                                                              
                                                                              
                                                                                 IP
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     +
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                                 +
                                                                                 1
                                                                              
                                                                              
                                                                                 W
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 W
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 E
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 IP
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         τ
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               
                                                                  
                                                                     ∇
                                                                  
                                                                  
                                                                     t
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     E
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ︷
                                                   
                                                   B
                                                
                                                )
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                   +
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             +
                                             
                                                (
                                                τ
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            IP
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         
                                                            
                                                               τ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 IP
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     (
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                                 ,
                                                                                 
                                                                                    PIP
                                                                                 
                                                                              
                                                                              
                                                                                 W
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     2
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 IP
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                                 ,
                                                                                 
                                                                                    PIP
                                                                                 
                                                                              
                                                                              
                                                                                 E
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     +
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 IP
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 E
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 IP
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ∇
                                                                              
                                                                              
                                                                                 t
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 W
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         τ
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               
                                                                  
                                                                     ∇
                                                                  
                                                                  
                                                                     t
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     IP
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ︷
                                                   
                                                   C
                                                
                                                )
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                   ,
                                                   
                                                      PIP
                                                   
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             +
                                             
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                            ,
                                                            
                                                               PIP
                                                            
                                                         
                                                         
                                                            W
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            IP
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                            −
                                                            1
                                                         
                                                         
                                                            IP
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            W
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                   −
                                                   1
                                                   ,
                                                   
                                                      PIP
                                                   
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             +
                                             
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                            ,
                                                            
                                                               PIP
                                                            
                                                         
                                                         
                                                            E
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            IP
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                            +
                                                            1
                                                         
                                                         
                                                            IP
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            E
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                   +
                                                   1
                                                   ,
                                                   
                                                      PIP
                                                   
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 S
                              
                              
                                 w
                              
                           
                         is the summation of weights for neighboring pixels of the current pixel, 
                           
                              
                                 I
                              
                              
                                 x
                              
                              
                                 t
                              
                           
                        . The third stages of the AD can also be expressed by using the above approach. Because of its immensely high complexity, the result of the third stage of AD is omitted in this paper. When the third stage of AD is applied, the pixels marked as 1–11 in Fig. 3
                         are utilized for restoring the current pixel value. As shown in Eq. (11), a huge number of operations are required to transform the iterative AD into single-pass AD. Hence, as in [10], we approximate this equation by assuming that 
                           
                              
                                 g
                              
                              
                                 ∇
                              
                           
                           s
                         in A, B, and C are approximately 0.5 which is a median value of the range of 
                           
                              
                                 g
                              
                              
                                 ∇
                              
                           
                        . Then, A, B, and C can be removed. In addition, 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       Δ
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                              
                                 Ix
                              
                           
                         is replaced with 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       Δ
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 I
                                 x
                              
                           
                         considering that 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       Δ
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                              
                                 I
                                 x
                              
                           
                           s
                         and 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       Δ
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 I
                                 x
                              
                           
                           s
                         are highly correlated because they are the diffusion coefficients at the same location with time 
                           t
                           +
                           1
                         and t, respectively. As a result, Eq. (11) can be transformed as follows:
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                x
                                             
                                             
                                                t
                                                +
                                                2
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               −
                                                               1
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➁
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                −
                                                2
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   τ
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➂
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                −
                                                1
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             (
                                             1
                                             −
                                             
                                                (
                                                
                                                   
                                                      
                                                         ➁
                                                         +
                                                         ➂
                                                         +
                                                         ➃
                                                         +
                                                         ➄
                                                      
                                                   
                                                   
                                                      
                                                         +
                                                         ➆
                                                         +
                                                         ➇
                                                         +
                                                         ➈
                                                      
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   τ
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➃
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                +
                                                1
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               +
                                                               1
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➄
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                +
                                                2
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        ,
                                                                        
                                                                           PIP
                                                                        
                                                                     
                                                                     
                                                                        W
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        IP
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        −
                                                                        1
                                                                     
                                                                     
                                                                        IP
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        W
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ︷
                                             
                                             ➆
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                −
                                                1
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   τ
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               IP
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➇
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        ,
                                                                        
                                                                           PIP
                                                                        
                                                                     
                                                                     
                                                                        E
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        IP
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                        +
                                                                        1
                                                                     
                                                                     
                                                                        IP
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∇
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        E
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ︷
                                             
                                             ➈
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                +
                                                1
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

To simplify Eq. (12) more, we replace the 
                           
                              
                                 D
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                         with 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                        , respectively, by assuming that the current color plane and PIP have a high correlation. (Theoretically, 
                           
                              
                                 D
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 E
                              
                              
                                 k
                              
                           
                         have the same value when the correlation between the current color plane and IP is one.) Then, as shown in Eq. (12), each weight for a neighboring pixel is determined by the product of the diffusion coefficients on the path from the current pixel to its neighboring pixel, as shown in Fig. 3. In particular, the diffusion path along the PIP starts from 
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 
                                    PIP
                                 
                              
                           
                         (the nearest pixel to the current pixel) and spreads into its adjacent pixels (
                           
                              
                                 I
                              
                              
                                 x
                                 −
                                 1
                                 ,
                                 
                                    PIP
                                 
                              
                           
                         and 
                           
                              
                                 I
                              
                              
                                 x
                                 +
                                 1
                                 ,
                                 
                                    PIP
                                 
                              
                           
                        ).

Following this diffusion path, three stages of the extended AD can be approximated by determining the weights for each neighboring as follows:
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                x
                                             
                                             
                                                t
                                                +
                                                3
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               −
                                                               2
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               −
                                                               1
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➀
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                −
                                                3
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               −
                                                               1
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➁
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                −
                                                2
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   τ
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➂
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                −
                                                1
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             (
                                             1
                                             −
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                11
                                             
                                             ⓘ
                                             )
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   τ
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➃
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                +
                                                1
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               +
                                                               1
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➄
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                +
                                                2
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               +
                                                               1
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               +
                                                               2
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➅
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                +
                                                3
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   2
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               ,
                                                               
                                                                  PIP
                                                               
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               IP
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ︷
                                             
                                             ➆
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                −
                                                1
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   τ
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               IP
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︷
                                             
                                             ➇
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   2
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               IP
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               ,
                                                               
                                                                  PIP
                                                               
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ︷
                                             
                                             ➈
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                +
                                                1
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   (
                                                   2
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               IP
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               ,
                                                               
                                                                  PIP
                                                               
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               −
                                                               1
                                                               ,
                                                               
                                                                  PIP
                                                               
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ︷
                                             
                                             ➉
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                −
                                                2
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   (
                                                   2
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               IP
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               ,
                                                               
                                                                  PIP
                                                               
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         
                                                            
                                                               ∇
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               +
                                                               1
                                                               ,
                                                               
                                                                  PIP
                                                               
                                                            
                                                            
                                                               E
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ︷
                                             
                                             ⑪
                                          
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                +
                                                2
                                                ,
                                                
                                                   PIP
                                                
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                         where 7 to 11 represent the weights of pixels in PIP. As in Eq. (13), weights in the current color plane and PIP are also determined by the product of the diffusion coefficients on the path from the current pixel to its neighboring pixels. 8 and (7, 9) are generated by the first and second diffusion steps, respectively. 10 and 11 are generated by the third diffusion step. Because Eq. (13) was derived using some approximation, the numerical stability cannot be guaranteed. To preserve the numerical stability, weights are normalized after τ is set to one [18].

This weight determination approach can be applied to the 2D image domain. For generating 
                           
                              
                                 DPK
                              
                              
                                 C
                              
                           
                        , we utilize the approach to the DPK generation in DAD as shown in Fig. 4
                        (a) (black arrows). Briefly, for the 
                           
                              
                                 DPK
                              
                              
                                 C
                              
                           
                         generation, this approach selects the shortest and simplest diffusion path among the various diffusion paths by considering that the weight of a pixel is most influenced by its nearest-neighboring pixels in the AD. For a detailed explanation, refer to Cho et al. [10]. Eq. (14) describes the weight (
                           
                              
                                 w
                              
                              
                                 x
                              
                              
                                 y
                              
                           
                        ) calculation for neighboring pixels on the northwest side of the current pixel (Fig. 4(b)).
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             st
                                          
                                       
                                       
                                       
                                          DS
                                       
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         1
                                                      
                                                      
                                                         y
                                                         −
                                                         1
                                                      
                                                   
                                                   =
                                                   g
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                      
                                                         NW
                                                      
                                                   
                                                   )
                                                   ,
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         y
                                                         −
                                                         1
                                                      
                                                   
                                                   =
                                                   g
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         +
                                                         1
                                                      
                                                      
                                                         y
                                                         −
                                                         1
                                                      
                                                   
                                                   =
                                                   g
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                      
                                                         NE
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             2
                                          
                                          
                                             nd
                                          
                                       
                                       
                                       
                                          DS
                                       
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         y
                                                         −
                                                         2
                                                      
                                                   
                                                   =
                                                   (
                                                   1
                                                   /
                                                   3
                                                   )
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         1
                                                      
                                                      
                                                         y
                                                         −
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         y
                                                         −
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         +
                                                         1
                                                      
                                                      
                                                         y
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                   g
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         ,
                                                         y
                                                         −
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         1
                                                      
                                                      
                                                         y
                                                         −
                                                         2
                                                      
                                                   
                                                   =
                                                   (
                                                   1
                                                   /
                                                   2
                                                   )
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         y
                                                         −
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         1
                                                      
                                                      
                                                         y
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                   g
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         ,
                                                         y
                                                         −
                                                         1
                                                      
                                                      
                                                         NW
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         2
                                                      
                                                      
                                                         y
                                                         −
                                                         2
                                                      
                                                   
                                                   =
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         1
                                                      
                                                      
                                                         y
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                   g
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         −
                                                         1
                                                         ,
                                                         y
                                                         −
                                                         1
                                                      
                                                      
                                                         NW
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             3
                                          
                                          
                                             rd
                                          
                                       
                                       
                                       
                                          DS
                                       
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         1
                                                      
                                                      
                                                         y
                                                         −
                                                         3
                                                      
                                                   
                                                   =
                                                   (
                                                   1
                                                   /
                                                   3
                                                   )
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         y
                                                         −
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         1
                                                      
                                                      
                                                         y
                                                         −
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         2
                                                      
                                                      
                                                         y
                                                         −
                                                         2
                                                      
                                                   
                                                   )
                                                   g
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         ,
                                                         y
                                                         −
                                                         2
                                                      
                                                      
                                                         NW
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         2
                                                      
                                                      
                                                         y
                                                         −
                                                         3
                                                      
                                                   
                                                   =
                                                   (
                                                   1
                                                   /
                                                   2
                                                   )
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         1
                                                      
                                                      
                                                         y
                                                         −
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         2
                                                      
                                                      
                                                         y
                                                         −
                                                         2
                                                      
                                                   
                                                   )
                                                   g
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         −
                                                         1
                                                         ,
                                                         y
                                                         −
                                                         2
                                                      
                                                      
                                                         NW
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         3
                                                      
                                                      
                                                         y
                                                         −
                                                         3
                                                      
                                                   
                                                   =
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         −
                                                         2
                                                      
                                                      
                                                         y
                                                         −
                                                         2
                                                      
                                                   
                                                   )
                                                   g
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         −
                                                         2
                                                         ,
                                                         y
                                                         −
                                                         2
                                                      
                                                      
                                                         NW
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where DS denotes the diffusion step, and 
                           ∇
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                         is the gray-level difference of a pixel (
                           x
                           ,
                           y
                        ) and its neighboring pixel. (N, S, W, E) denote (north, south, west, east). For example, 
                           ∇
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 y
                              
                              
                                 S
                              
                           
                         means (
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 y
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                        ). In this equation, an average value of the weights is used as the diffusion coefficient of the previous diffusion step. For example, 
                           (
                           
                              
                                 w
                              
                              
                                 x
                              
                              
                                 y
                                 −
                                 1
                              
                           
                           +
                           
                              
                                 w
                              
                              
                                 x
                                 −
                                 1
                              
                              
                                 y
                                 −
                                 1
                              
                           
                           )
                           /
                           2
                         is used as the diffusion coefficient of the 1st DS for determining 
                           
                              
                                 w
                              
                              
                                 x
                                 −
                                 1
                              
                              
                                 y
                                 −
                                 2
                              
                           
                        , which is calculated in the 2nd DS. This is to consider the diffusion effect from other paths adjacent to the selected diffusion path. The other weights in the 
                           
                              
                                 DPK
                              
                              
                                 C
                              
                           
                         are calculated using the same approach in Eq. (14). For the multi-channels (R, G, and B color planes), a common 
                           
                              
                                 DPK
                              
                              
                                 C
                              
                           
                         (weights in Eq. (14)) is used for all channels by replacing 
                           ∇
                           I
                           s
                         in Eq. (14) with the average values of ∇Is in RGB color planes. In addition to this, 
                           
                              
                                 K
                              
                              
                                 C
                              
                           
                         values for 
                           g
                           (
                           ⋅
                           )
                         in Eq. (14) are also coupled for the utilization of a common 
                           
                              
                                 DPK
                              
                              
                                 C
                              
                           
                         (This will be explained in Section 2.3.1).

Next, 
                           
                              
                                 DPK
                              
                              
                                 PIP
                              
                           
                         is generated by following the rules for the 
                           
                              
                                 DPK
                              
                              
                                 C
                              
                           
                         generation. As shown in Fig. 4(a) (red arrows), and weights for 
                           
                              
                                 DPK
                              
                              
                                 PIP
                              
                           
                         can be calculated as follows:
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                st
                                             
                                          
                                          
                                          
                                             DS
                                          
                                          
                                             {
                                             
                                                
                                                   w
                                                
                                                
                                                   x
                                                   ,
                                                   P
                                                
                                                
                                                   y
                                                
                                             
                                             =
                                             g
                                             
                                                (
                                                ∇
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                   
                                                      IP
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                2
                                             
                                             
                                                nd
                                             
                                          
                                          
                                          
                                             DS
                                          
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            ,
                                                            p
                                                         
                                                         
                                                            y
                                                            −
                                                            1
                                                         
                                                      
                                                      =
                                                      (
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            ,
                                                            P
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      )
                                                      g
                                                      (
                                                      ∇
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                            ,
                                                            y
                                                            ,
                                                            P
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            −
                                                            1
                                                            ,
                                                            p
                                                         
                                                         
                                                            y
                                                            −
                                                            1
                                                         
                                                      
                                                      =
                                                      (
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            ,
                                                            P
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      )
                                                      g
                                                      (
                                                      ∇
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                            ,
                                                            y
                                                            ,
                                                            P
                                                         
                                                         
                                                            NW
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            −
                                                            1
                                                            ,
                                                            p
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      =
                                                      (
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            ,
                                                            P
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      )
                                                      g
                                                      (
                                                      ∇
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                            ,
                                                            y
                                                            ,
                                                            P
                                                         
                                                         
                                                            W
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                3
                                             
                                             
                                                rd
                                             
                                          
                                          
                                          
                                             DS
                                          
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            ,
                                                            P
                                                         
                                                         
                                                            y
                                                            −
                                                            2
                                                         
                                                      
                                                      =
                                                      (
                                                      1
                                                      /
                                                      3
                                                      )
                                                      (
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            −
                                                            1
                                                            ,
                                                            P
                                                         
                                                         
                                                            y
                                                            −
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            ,
                                                            P
                                                         
                                                         
                                                            y
                                                            −
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            +
                                                            1
                                                            ,
                                                            P
                                                         
                                                         
                                                            y
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               x
                                                               ,
                                                               P
                                                            
                                                            
                                                               y
                                                               −
                                                               2
                                                            
                                                         
                                                         =
                                                      
                                                      ×
                                                      g
                                                      (
                                                      ∇
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                            ,
                                                            y
                                                            −
                                                            1
                                                            ,
                                                            p
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            −
                                                            1
                                                            ,
                                                            P
                                                         
                                                         
                                                            y
                                                            −
                                                            2
                                                         
                                                      
                                                      =
                                                      (
                                                      1
                                                      /
                                                      2
                                                      )
                                                      (
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            ,
                                                            P
                                                         
                                                         
                                                            y
                                                            −
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            −
                                                            1
                                                            ,
                                                            P
                                                         
                                                         
                                                            y
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                      g
                                                      (
                                                      ∇
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                            ,
                                                            y
                                                            −
                                                            1
                                                            ,
                                                            p
                                                         
                                                         
                                                            NW
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 w
                              
                              
                                 x
                                 ,
                                 p
                              
                              
                                 y
                              
                           
                         is the weight for a pixel at (
                           x
                           ,
                           y
                        ) in the PIP (Fig. 4(c)). 
                           ∇
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 y
                              
                              
                                 IP
                              
                           
                         and 
                           ∇
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 y
                                 ,
                                 P
                              
                              
                                 N
                              
                           
                         imply (
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 y
                                 ,
                                 
                                    PIP
                                 
                              
                           
                           −
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                        ) and (
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 y
                                 −
                                 1
                                 ,
                                 
                                    PIP
                                 
                              
                           
                           −
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 y
                                 ,
                                 
                                    PIP
                                 
                              
                           
                        ), respectively. Other weights of 
                           
                              
                                 DPK
                              
                              
                                 PIP
                              
                           
                         are calculated using the same approach described in Eq. (15).

Before gradients (∇Is) for the 
                           
                              
                                 DPK
                              
                              
                                 C
                              
                           
                         and 
                           
                              
                                 DPK
                              
                              
                                 PIP
                              
                           
                         generations are calculated, a Gaussian filtering is applied to a gray level to suppress strong image noise, which can significantly degrade the accuracy of gradient calculation results. As a result, I in Eqs. (14)–(15) can be replaced with 
                           
                              
                                 I
                              
                              
                                 σ
                              
                           
                         which is the result of a Gaussian filtering. In addition to this, to reduce the computational complexity of the weight determination, the resultant weight for a pixel (
                           x
                           ,
                           y
                        ) in the current color plane is utilized when the weight for a pixel (
                           x
                           ,
                           y
                        ) in the PIPs is calculated by considering that the current color plane and the PIPs have a high correlation. For example, 
                           
                              
                                 w
                              
                              
                                 x
                                 ,
                                 p
                              
                              
                                 y
                                 −
                                 1
                              
                           
                         which is the weight value for a pixel (
                           x
                           ,
                           y
                           −
                           1
                        ) in PIP (in Eq. (15)) is calculated by multiplication of 
                           
                              
                                 w
                              
                              
                                 x
                                 ,
                                 p
                              
                              
                                 y
                              
                           
                         and 
                           
                              
                                 w
                              
                              
                                 x
                              
                              
                                 y
                                 −
                                 1
                              
                           
                         (
                           =
                           g
                           (
                           ∇
                           
                              
                                 I
                              
                              
                                 x
                                 ,
                                 y
                              
                              
                                 N
                              
                           
                           )
                         which is calculated in the current color plane).

To maximize the performance of the DPK-based filtering, K used in 
                              g
                              (
                              ⋅
                              )
                            is determined depending on a local variance of a given noisy image. As in ∇I calculation, 
                              
                                 
                                    I
                                 
                                 
                                    σ
                                 
                              
                            used as an input for the local variance calculation to reduce the influence of strong image noise during the local variance calculation, as shown in Fig. 5
                           (b). The local variance 
                              
                                 
                                    P
                                 
                                 
                                    
                                       class
                                    
                                 
                                 
                                    C
                                 
                              
                           , as shown in Fig. 5(c), can be calculated as follows:
                              
                                 (16)
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             
                                                class
                                             
                                          
                                          
                                             C
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          ⌊
                                          
                                             {
                                             
                                                1
                                                25
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ,
                                                   j
                                                   =
                                                   −
                                                   2
                                                
                                                2
                                             
                                             
                                                
                                                   [
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         σ
                                                      
                                                   
                                                   (
                                                   x
                                                   +
                                                   i
                                                   ,
                                                   y
                                                   +
                                                   j
                                                   )
                                                   −
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   2
                                                
                                             
                                             }
                                          
                                          /
                                          32
                                          ⌋
                                       
                                       +
                                       1
                                       ,
                                    
                                 
                              
                            where 
                              
                                 
                                    m
                                 
                                 
                                    I
                                 
                                 
                                    x
                                    ,
                                    y
                                 
                              
                            is the local mean of the 
                              5
                              ×
                              5
                            pixel block centered at a pixel (
                              x
                              ,
                              y
                           ). The maximum value of this local variation is limited to 255, and this value is quantized into eight classes, as shown in Eq. (16). The initial 
                              
                                 
                                    K
                                 
                                 
                                    C
                                 
                              
                            is determined to be inversely proportional to 
                              
                                 
                                    P
                                 
                                 
                                    
                                       class
                                    
                                 
                                 
                                    C
                                 
                              
                            as follows:
                              
                                 (17)
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             x
                                             ,
                                             y
                                          
                                          
                                             C
                                          
                                       
                                       =
                                       2
                                       ⋅
                                       
                                          
                                             σ
                                          
                                          
                                             n
                                          
                                       
                                       /
                                       
                                          
                                             P
                                          
                                          
                                             
                                                class
                                             
                                          
                                          
                                             C
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ,
                                    
                                 
                              
                            where 
                              
                                 
                                    σ
                                 
                                 
                                    n
                                 
                              
                            is the standard deviation value of AWGN. By this simple approach, we can reduce the computational complexity of K value determination compared with that of DAD, which performs a multi-scale region analysis with the training process. In addition, for the regions having structural information, the smoothing strength is reduced to preserve the image details, as shown in Fig. 5(d). However, the reduction of the 
                              
                                 
                                    K
                                 
                                 
                                    C
                                 
                              
                            value leads to unsuccessful removal of image noise near strong edges because the reduced smoothing strength is used for all directions. To alleviate this problem, as shown in Figs. 5(e) and (f), the 
                              
                                 
                                    K
                                 
                                 
                                    C
                                 
                              
                            value is increased horizontally (x) or vertically (y) for a pixel having a very low 
                              
                                 
                                    K
                                 
                                 
                                    C
                                 
                              
                            value depending on the edge direction that is extracted from the following structure tensor [33].
                              
                                 (18)
                                 
                                    
                                       J
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                    
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                    
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      ∇
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            σ
                                                         
                                                      
                                                       
                                                   
                                                   
                                                      ∇
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            y
                                                         
                                                         
                                                            σ
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         σ
                                                      
                                                   
                                                    
                                                
                                                
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         σ
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       ,
                                    
                                 
                              
                            where 
                              ∇
                              
                                 
                                    I
                                 
                                 
                                    x
                                 
                                 
                                    σ
                                 
                              
                            and 
                              ∇
                              
                                 
                                    I
                                 
                                 
                                    x
                                 
                                 
                                    σ
                                 
                              
                            are the gradient values of 
                              
                                 
                                    I
                                 
                                 
                                    σ
                                 
                              
                            along x and y directions, respectively. From the structure tensor, two eigenvectors are extracted using the following equations:
                              
                                 (19)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   →
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ‖
                                       
                                          
                                             [
                                             2
                                             
                                                
                                                   s
                                                
                                                
                                                   12
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   11
                                                
                                             
                                             −
                                             
                                                
                                                   s
                                                
                                                
                                                   22
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               11
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               22
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   4
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         12
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   →
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ⊥
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   →
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                    
                                 
                              
                            where 
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          1
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          1
                                          y
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              )
                            is a vector perpendicular to the direction of the edge (parallel to 
                              ∇
                              
                                 
                                    I
                                 
                                 
                                    σ
                                 
                              
                           ) while 
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          2
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          2
                                          y
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              )
                            is a vector parallel to the edge direction (perpendicular to 
                              ∇
                              
                                 
                                    I
                                 
                                 
                                    σ
                                 
                              
                           ). Using 
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    
                                       class
                                    
                                 
                                 
                                    C
                                 
                              
                           , we modify the 
                              
                                 
                                    K
                                 
                                 
                                    C
                                 
                              
                            value. Eq. (20) shows the modification factors of 
                              
                                 
                                    K
                                 
                                 
                                    C
                                 
                              
                            along x and y directions.
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                x
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               class
                                                            
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      /
                                                      4
                                                      )
                                                      ⋅
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            1
                                                            x
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      if 
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               class
                                                            
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      >
                                                      max
                                                      ⁡
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               class
                                                            
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      )
                                                      /
                                                      2
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      1
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                y
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               class
                                                            
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      /
                                                      4
                                                      )
                                                      ⋅
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            1
                                                            y
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      if 
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               class
                                                            
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      >
                                                      max
                                                      ⁡
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               class
                                                            
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      )
                                                      /
                                                      2
                                                   
                                                
                                                
                                                   
                                                      1
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In the smooth region, the edge direction is meaningless because this region does not have the variations caused by image details, and thereby a gradient is likely to be generated by image noise. In addition, if the directional modification of 
                              
                                 
                                    K
                                 
                                 
                                    C
                                 
                              
                            is applied to the smooth region, it can induce edge-like errors, which will be demonstrated in Section 3. Because high 
                              
                                 
                                    P
                                 
                                 
                                    
                                       class
                                    
                                 
                                 
                                    C
                                 
                              
                            means strong image details, only a pixel having 
                              
                                 
                                    P
                                 
                                 
                                    
                                       class
                                    
                                 
                                 
                                    C
                                 
                              
                            higher than four (= median value of the range of 
                              
                                 
                                    P
                                 
                                 
                                    
                                       class
                                    
                                 
                                 
                                    C
                                 
                              
                           ) takes the directional modification of 
                              
                                 
                                    K
                                 
                                 
                                    C
                                 
                              
                            to prevent edge-like errors as shown in Eq. (20). By using 
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                            and 
                              
                                 
                                    R
                                 
                                 
                                    y
                                 
                              
                           , the 
                              
                                 
                                    K
                                 
                                 
                                    C
                                 
                              
                            value is modified along the horizontal and vertical lines by 
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                            and 
                              
                                 
                                    R
                                 
                                 
                                    y
                                 
                              
                            as follows:
                              
                                 (21)
                                 
                                    
                                       
                                          g
                                          
                                             (
                                             ∇
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                   ,
                                                   y
                                                
                                                
                                                   N
                                                
                                             
                                             )
                                          
                                          =
                                          1
                                          /
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   /
                                                   
                                                      (
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            x
                                                            ,
                                                            y
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      ⋅
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          g
                                          
                                             (
                                             ∇
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                   ,
                                                   y
                                                
                                                
                                                   S
                                                
                                             
                                             )
                                          
                                          =
                                          1
                                          /
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                   /
                                                   
                                                      (
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            x
                                                            ,
                                                            y
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      ⋅
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          g
                                          
                                             (
                                             ∇
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                   ,
                                                   y
                                                
                                                
                                                   W
                                                
                                             
                                             )
                                          
                                          =
                                          1
                                          /
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                      
                                                         W
                                                      
                                                   
                                                   /
                                                   
                                                      (
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            x
                                                            ,
                                                            y
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      ⋅
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          g
                                          
                                             (
                                             ∇
                                             
                                                
                                                   I
                                                
                                                
                                                   x
                                                   ,
                                                   y
                                                
                                                
                                                   E
                                                
                                             
                                             )
                                          
                                          =
                                          1
                                          /
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   (
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                      
                                                         E
                                                      
                                                   
                                                   /
                                                   
                                                      (
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            x
                                                            ,
                                                            y
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      ⋅
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        

Consequently, for a pixel having strong edge directivity, the diffusion strength along the direction of the edge is increased while decreasing the diffusion strength for a perpendicular direction of the edge. By this, the quality of noise elimination is improved for a pixel near strong edges. For the utilization of a common 
                              
                                 
                                    DPK
                                 
                                 
                                    C
                                 
                              
                            for all channels, 
                              
                                 
                                    K
                                 
                                 
                                    x
                                    ,
                                    y
                                 
                                 
                                    C
                                 
                              
                           , 
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                           , and 
                              
                                 
                                    R
                                 
                                 
                                    y
                                 
                              
                            values are coupled across all color planes by using the average value of 
                              
                                 
                                    P
                                 
                                 
                                    
                                       class
                                    
                                 
                                 
                                    C
                                 
                              
                           , 
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                           , and 
                              
                                 
                                    R
                                 
                                 
                                    y
                                 
                              
                            of each RGB color plane, respectively.

In some cases having a low inter-color correlation, the accuracy of inter-color prediction can be decreased. Thus, for the efficient 
                              
                                 
                                    DPK
                                 
                                 
                                    PIP
                                 
                              
                           -based filtering, the diffusion strength for the PIPs should be adjusted depending on the similarity between spatial gradients of local regions in the current color plane and each of the PIPs. In this paper, the similarity of spatial gradients between local regions in the current color plane and PIP is estimated by calculating the absolute difference between their respective gradients along x and y directions as follows:
                              
                                 (22)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   S
                                                
                                             
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          
                                             =
                                          
                                          
                                             
                                                ⌊
                                                
                                                   (
                                                   
                                                      |
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      −
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            IP
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      |
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             +
                                             
                                                |
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      C
                                                   
                                                
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                −
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      IP
                                                   
                                                
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                |
                                             
                                             )
                                             /
                                             16
                                             ⌋
                                             +
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    G
                                 
                                 
                                    x
                                 
                                 
                                    C
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            and 
                              
                                 
                                    G
                                 
                                 
                                    y
                                 
                                 
                                    C
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            are the gradient values at pixel (
                              x
                              ,
                              y
                           ) along x and y directions in the current color plane, respectively. 
                              
                                 
                                    G
                                 
                                 
                                    x
                                 
                                 
                                    IP
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            and 
                              
                                 
                                    G
                                 
                                 
                                    y
                                 
                                 
                                    IP
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            are the gradient values at pixel (
                              x
                              ,
                              y
                           ) along x and y directions in the IPs, respectively. The maximum value of this gradient difference is limited to 127, and this value is quantized into eight classes, as shown in Eq. (22). Based on the 
                              
                                 
                                    S
                                 
                                 
                                    S
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            (shown in Fig. 6
                           (d)), 
                              
                                 
                                    K
                                 
                                 
                                    PIP
                                 
                              
                            (shown in Fig. 6(f)), which is the diffusion threshold for the PIP, is determined as follows:
                              
                                 (23)
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             x
                                             ,
                                             y
                                          
                                          
                                             PIP
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          
                                             K
                                          
                                          
                                             C
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       /
                                       
                                          
                                             S
                                          
                                          
                                             S
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       .
                                    
                                 
                              
                           
                        

As shown in Eq. (23), diffusion is prohibited when the similarity of spatial gradients between the current color plane and PIP is very low. When the 
                              
                                 
                                    S
                                 
                                 
                                    S
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            is less than or equal to one, 
                              
                                 
                                    K
                                 
                                 
                                    PIP
                                 
                              
                            is set to 
                              
                                 
                                    K
                                 
                                 
                                    C
                                 
                              
                            by considering that local regions in the current color plane and PIP have a high similarity of spatial gradients.

Using the 
                              
                                 
                                    K
                                 
                                 
                                    C
                                 
                              
                            and 
                              
                                 
                                    K
                                 
                                 
                                    PIP
                                 
                              
                           , the final weights for 
                              
                                 
                                    DPK
                                 
                                 
                                    C
                                 
                              
                            and 
                              
                                 
                                    DPK
                                 
                                 
                                    PIP
                                 
                              
                            in Eqs. (14) and (15) are determined. To extract the denoising results, DPK filtering is performed in the current color plane and PIPs by using 
                              
                                 
                                    DPK
                                 
                                 
                                    C
                                 
                              
                            and 
                              
                                 
                                    DPK
                                 
                                 
                                    PIP
                                 
                              
                            as follows:
                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         out
                                                      
                                                   
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                
                                                   =
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ,
                                                            j
                                                            =
                                                            −
                                                            3
                                                         
                                                         3
                                                      
                                                      
                                                         [
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               x
                                                               +
                                                               i
                                                            
                                                            
                                                               y
                                                               +
                                                               j
                                                            
                                                         
                                                         ⋅
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               x
                                                               +
                                                               i
                                                               ,
                                                               y
                                                               +
                                                               j
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      2
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ,
                                                         j
                                                         =
                                                         −
                                                         1
                                                      
                                                      1
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            x
                                                            +
                                                            i
                                                            ,
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                         
                                                            y
                                                            +
                                                            j
                                                         
                                                      
                                                      ⋅
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                            +
                                                            i
                                                            ,
                                                            y
                                                            +
                                                            j
                                                            ,
                                                            
                                                               
                                                                  PIP
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   )
                                                   /
                                                   Z
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          Z
                                          =
                                          
                                             ∑
                                             
                                                i
                                                ,
                                                j
                                                =
                                                −
                                                3
                                             
                                             3
                                          
                                          
                                             [
                                             
                                                
                                                   w
                                                
                                                
                                                   x
                                                   +
                                                   i
                                                
                                                
                                                   y
                                                   +
                                                   j
                                                
                                             
                                             ]
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             2
                                          
                                          
                                             ∑
                                             
                                                i
                                                ,
                                                j
                                                =
                                                −
                                                1
                                             
                                             1
                                          
                                          
                                             [
                                             
                                                
                                                   w
                                                
                                                
                                                   x
                                                   +
                                                   i
                                                   ,
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   y
                                                   +
                                                   j
                                                
                                             
                                             ]
                                          
                                          ,
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    I
                                 
                                 
                                    out
                                 
                              
                            is the denoised pixel value of a given pixel. k is the index for the PIPs.

To enhance the denoising quality in smooth regions contaminated by the strong image noise, we propose a distant AD which uses pixels away from a current pixel (not adjacent pixels of a current pixel) when it performs the AD filtering. This distant AD can be used as a post processing of the DPK-based filtering. For the smooth region, the quality of denoising can be increased when the number of pixels used for the noise filtering is increased. Therefore, for the strong image noise (
                              
                                 
                                    σ
                                 
                                 
                                    n
                                 
                              
                              >
                              20
                           ), we perform the distant AD on the results of the DPK-based filtering so that a large number of pixels are effectively utilized for the noise filtering. The distant AD can be formulated as follows:
                              
                                 (25)
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             out
                                          
                                          
                                             P
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          
                                             I
                                          
                                          
                                             out
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       +
                                       τ
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          D
                                       
                                       
                                          [
                                          g
                                          
                                             (
                                             ∇
                                             
                                                
                                                   I
                                                
                                                
                                                   i
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             x
                                             ,
                                             y
                                             )
                                             )
                                          
                                          ⋅
                                          ∇
                                          
                                             
                                                I
                                             
                                             
                                                i
                                             
                                             
                                                d
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          ]
                                       
                                       ,
                                    
                                 
                              
                            where 
                              ∇
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                                 
                                    d
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            represents the gray level difference between the current pixel (
                              x
                              ,
                              y
                           ) and the pixel which is 14 pixels away from the current pixel in direction i (in the typical AD shown in Eq. (4), 
                              ∇
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            is the gradient between the current pixel (
                              x
                              ,
                              y
                           ) and its adjacent pixel in direction i at time t). As in the typical AD, D and τ are set to 4 and 1/4, respectively. The distant AD is applied on the smooth regions whose 
                              
                                 
                                    P
                                 
                                 
                                    
                                       class
                                    
                                 
                                 
                                    C
                                 
                              
                            value is lower than (
                              
                                 
                                    σ
                                 
                                 
                                    n
                                 
                              
                              /
                              5
                           ). Because 
                              
                                 
                                    I
                                 
                                 
                                    out
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            is acquired by the DPK filtering which uses 
                              7
                              ×
                              7
                            pixels in the current plane (with PIPs) for a pixel, 
                              D
                              ×
                              7
                              ×
                              7
                            pixels in the current color plane can be utilized when the resultant pixel (
                              
                                 
                                    I
                                 
                                 
                                    out
                                 
                                 
                                    p
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                           ) is calculated by the distant AD. By using this distant AD which consists of simple operations, much larger number of pixels can be effectively utilized for the noise filtering in smooth region than the DPK filtering. As a result, the quality of denoising in smooth region can be improved as shown in Fig. 7
                           . Table 1
                            shows the improvements of PSNR and SSIM values obtained by the distant AD. PSNR values were increased by up to 0.431 dB compared with the DPK-based filtering. Compared to the increase of PSNR values, the increase of SSIM values was relatively small because the distant AD was only applied on smooth regions, not structural regions where SSIM values could be influenced.

@&#EXPERIMENTAL RESULTS@&#

In the experiments, six image sets were used as test images. Kodak, misc1, and Cannon were acquired from the CIPR image database (CIPR). ISO is ISO12640-2 standard image set. IEC was ranSdomly captured from an IEC62087 video. Football is one of the most widely used image sets in image and video processing. AWGN with 15 and 25 standard deviations (
                        
                           
                              σ
                           
                           
                              n
                           
                        
                     s), which are typical values in practical applications, was used as the image noise model [13,19,36]. In addition to six test image sets, an actual noisy image, captured as RAW data with a mirror-less digital camera, was used as a test image.

For the image quality evaluation, peak signal-to-noise ratio (PSNR), structural similarity index (SSIM) [31] were used. In addition, figure of merit (FOM) [1] was used to evaluate the quality of edge preservation. In FOM, edges were extracted using a Sobel operator on a luminance component of a given image. Threshold for defining edge was set to 
                        (
                        
                           
                              σ
                           
                           
                              n
                           
                        
                        /
                        3
                        )
                        ×
                        average
                      value of squared luminance of a given image.

For the benchmark methods, the colored version of NLM (
                        
                           
                              NLM
                           
                           
                              C
                           
                        
                     ) [5] which is a popular approach to image denoising and a recent total generalized variation (TGV)-based approach [27,4] were used. For the implementation of TGV, the fast Fourier transform-based method [27] was used. Typical AD (TAD) method [24] and Weickert's AD (WAD) method [33], which are the most representative AD methods, were also used as benchmark methods. Specifically, among various methods proposed by Weickert, the edge-enhancing diffusion (EED) method was used as the WAD method. Other recent methods utilizing the region adaptive K, such as Chao's AD (CAD) [9] and Li's AD (LAD) [21], were also used as benchmark methods. Lastly, Cho's dictionary-based AD (DAD) method [10], which performs DPK filtering in the current color plane, was used as a benchmark method.

In all benchmarks, various parameters used were optimized to produce the highest PSNR and SSIM values throughout the experiments for fair comparison. Tables 2 and 3
                     
                      show the selected parameters of the benchmark and proposed methods. The parameters, which are not included in Tables 2 and 3, are set to the values guided by their corresponding papers. For fair comparison, the same Gaussian filtering which is applied to the proposed method as a pre-processing of the gradient calculation was also applied to TAD, CAD and LAD. In the case of WAD, a Gaussian filtering was used for the generation of the structure tensor. The scales of the Gaussian filtering for the AD-based benchmark methods are denoted in Table 3.

We evaluated the performance of the proposed method in two ways. First, we assessed the improvements obtained from the inter-color diffusion of the proposed extended dimensional AD (EAD) without utilization of DPK (
                        
                           
                              EAD
                           
                           
                              N
                              _
                              
                                 DPK
                              
                           
                        
                     ) over the typical AD. In this experiment, only the effect of the inter-color diffusion was considered by eliminating the influences of other variables. (Any pre-processing such as a Gaussian filtering for the gradient calculation was ignored.) We call the typical AD without the Gaussian filtering for the gradient calculation as 
                        
                           
                              TAD
                           
                           
                              N
                              _
                              G
                           
                        
                      in this experiment. Second, the overall performance of the proposed method with DPK (
                        
                           
                              EAD
                           
                           
                              DPK
                           
                        
                     ) was evaluated in terms of the quality of denoised images and computational complexity.

For the first evaluation, 
                        
                           
                              EAD
                           
                           
                              N
                              _
                              
                                 DPK
                              
                           
                        
                      was implemented by Eq. (8) and time step (τ) in Eq. (8) was set to 1/10. The same diffusivity function (Eq. (3)) and the method for inter-color prediction (Eq. (1)) with 
                        
                           
                              EAD
                           
                           
                              DPK
                           
                        
                      were used. In addition, a constant K value was used in the current color plane and PIPs. Table 4
                      shows improvements obtained by 
                        
                           
                              EAD
                           
                           
                              N
                              _
                              
                                 DPK
                              
                           
                        
                      over 
                        
                           
                              TAD
                           
                           
                              N
                              _
                              G
                           
                        
                      that also uses Eq. (3) for the diffusivity function (In the case of 
                        
                           
                              TAD
                           
                           
                              N
                              _
                              G
                           
                        
                     , τ in Eq. (4) was set to 1/8). As shown in this table, 
                        
                           
                              EAD
                           
                           
                              N
                              _
                              
                                 DPK
                              
                           
                        
                     , which extends the dimension of AD, successfully improved PSNR and SSIM values up to 0.898 dB and 0.006, respectively. This is because the high inter-color correlation was effectively utilized for diffusion process. Specifically, by extending the dimension of diffusion, the larger number of pixels similar with a current pixel to be restored were successfully used for noise reduction, compared to 
                        
                           
                              TAD
                           
                           
                              N
                              _
                              G
                           
                        
                     .

In the second evaluation, we compared the qualities of denoised images and computational complexities of the proposed method with DPK (
                        
                           
                              EAD
                           
                           
                              DPK
                           
                        
                     ) and seven benchmark methods. As shown in Tables 5 and 6
                     
                     , the proposed method provided the highest PSNR, SSIM, and FOM values for most test image sets. In particular, the PSNR value was significantly improved up to 4.932 dB compared to the benchmark methods. Compared to DAD, the proposed method increased the PSNR value by 2.392 dB on average. In the case of SSIM, the noticeable improvement was obtained when the level of image noise increased. These improvements were achieved by effectively utilizing K value modification and the diffusion acceleration by DPK in addition to the inter-color diffusion of the extended AD.


                     Figs. 8 and 9
                     
                      show the resultant images generated by the benchmark and the proposed method for AWGN and actual image noise, respectively. 
                        
                           
                              NLM
                           
                           
                              C
                           
                        
                      (Figs. 8(c) and 9(c)) and TGV (Figs. 8(d) and 9(d)) showed the better quality of noise suppression in the smooth regions. Specifically, TGV showed the better qualities of noise elimination in the smooth and detail regions than the other AD-based benchmark methods. However, the over-smoothing in some detail regions occurs. Moreover, it requires the higher computational complexity than the other AD-based benchmark methods. (This will be analyzed in the next paragraph.) TAD showed poor qualities of detail preservation in detailed regions and noise suppression in the smooth region (Figs. 8(e) and 9(e)). WAD demonstrated good results for the noise elimination near strong edges because it utilizes the diffusion tensor to suppress diffusion across the direction of edges. However, it showed the poorer performance for the noise elimination of smooth regions when compared with the proposed method, and its computational complexity is higher than those of other AD-based methods (Figs. 8(f) and 9(f)). CAD produced better preservation of strong image boundaries than the TAD by using a region adaptive K. However, it could not remove the strong image noise effectively (Figs. 8(g) and 9(g)). LAD also demonstrated better quality of detail preservation than TAD by utilizing the region adaptive K (Fig. 8(h)). However, LAD showed poor quality of noise suppression in the smooth region (specifically for the actual noisy image as shown in Fig. 9(h)), and it requires much more computation time than the other benchmarks. DAD demonstrated an improved resultant image compared to other benchmark methods in terms of noise suppression in the smooth region by applying the dictionary-based DPK filtering (Figs. 8(i) and 9(i)). However, it could not successfully eliminate image noise near the strong edges, such as the horizontal lines in the green window. The proposed method showed the best denoising results when compared to the other methods, featuring an improved quality of noise elimination in smooth regions and regions near strong edges compared to DAD (Figs. 8(j) and (k)). The superiority of the proposed method was clearly demonstrated by the residual image which presents the squared error of the denoised image and is located in left-top of each resultant image in Fig. 8. For the actual image noise (Fig. 9(j)), the propose method showed the outstanding denoising result by effectively removing the strong image noise and preserving image details.

Next, we evaluated the computational complexities of the benchmark and the proposed methods. Table 7
                      demonstrates the number of operations per pixel (
                        
                           
                              N
                           
                           
                              oper
                           
                        
                     ) of the benchmark methods and the proposed method. In this table, TGV was excluded because it has the much higher computational complexity than the other benchmark methods. Specifically, TGV has the time complexity of O (iteration 
                        number
                        ⋅
                        6
                        ⋅
                        N
                        
                           
                              log
                           
                           
                              2
                           
                        
                        ⁡
                        N
                     ) while the other benchmark methods have the linear time complexity for the input image size. As shown in this table, AD-based methods generally have a lower computational complexity than 
                        
                           
                              NLM
                           
                           
                              C
                           
                        
                     . Among these methods, except for TAD, which provides poor quality for the denoised image, DAD exhibited the smallest number of operations. This is because DAD can avoid the use of expensive iterative region analysis by using the single-pass filtering-based architecture. The proposed method also uses single-pass filtering-based architecture, but it extends the diffusion domain, thus the increase of computational complexity was inevitable. To reduce the increase of computational complexity, we simplified the region analysis and removed the use of the dictionary for K extraction. As a result, 
                        
                           
                              N
                           
                           
                              oper
                           
                        
                      of the proposed method was only 9.66% higher than that of DAD while the denoising quality of the proposed method was significantly increased compared with DAD. Thanks to fast computation and single-pass based architecture, the proposed method can be very efficient for real-time HW applications.

@&#CONCLUSION@&#

In this paper, we proposed an improved AD-based noise reduction method that utilizes the extended diffusion paths along PIPs. In the proposed method, IPs are successfully predicted from different color planes to directly utilize the inter-color correlations for the AD-based noise reduction by adjusting local mean values of the IPs. Then, by producing the DPKs for the current color plane and PIPs, the inter-color correlation is effectively utilized while avoiding expensive iterative region analysis. In addition, the diffusion threshold for the inter-color diffusion is adjusted by the similarity of spatial gradients between the current color plane and each of the PIPs to maximize the performance of noise reduction obtained by the extended diffusion paths. For the current color plane, the spatially and directionally varying diffusion threshold is used to enhance the qualities of image detail preservation and noise elimination in strong boundaries. The experimental results verified that the proposed method shows significant improvements in PSNR and SSIM values over the benchmark methods.

@&#ACKNOWLEDGEMENTS@&#

This research was supported by IDEC and the MSIP (Ministry of Science, ICT and Future Planning), Korea, under the “IT Consilience Creative Program” (NIPA-2014-H0201-14-1001) supervised by the NIPA (National IT Industry Promotion Agency).

@&#REFERENCES@&#

