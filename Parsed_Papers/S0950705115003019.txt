@&#MAIN-TITLE@&#A novel ordinal learning strategy: Ordinal nearest-centroid projection

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Propose an Ordinal Nearest-Centroid Projection (OrNCP) for ordinal regression (OR).


                        
                        
                           
                           Relax OrNCP to quadratic programming that covers the KDLOR and MOR as special cases.


                        
                        
                           
                           Experimentally demonstrate the effectiveness and superiority of our strategy for OR.


                        
                        
                           
                           Study the influences of the form and the granularity of ordinal constraints on OR.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ordinal regression

Ordinal nearest-centroid projection

Combinatorial optimization

Quadratic programming

@&#ABSTRACT@&#


               
               
                  Ordinal regression (OR) is a learning paradigm lying between classification and regression and has been attracting increasing attention in recent years due to its wide applications such as human age estimation. To date, there have been a variety of methods proposed for OR, among which the category of threshold-based OR becomes one of the representatives with preferable performance. Typical threshold-based methods, such as discriminant learning for OR (i.e., KDLOR), OR via manifold learning (i.e., MOR), usually seek an OR projection direction along which to maximally separate classes by a sequence of ordinal thresholds. Although having yielded encouraging results, they still leave a performance space that can be further improved since (1) the thresholds involved are optimized independently from each other, and (2) the ordinal constraints just associate with class means (or say centroids) which are generally under-represented for class distributions. Motivated by the analysis, in this work we propose to jointly learn the thresholds across samples and class centroids by seeking an optimal direction along which all the samples are distributed as in order as possible and maximally cater for nearest-centroid distributions, which we call Ordinal Nearest-Centroid Projection (OrNCP) and is formulated as a combinatorial optimization problem. For efficiency of optimization, we further relax the problem to a quadratic programming (QP-OrNCP) that in form covers the KDLOR and MOR as its special cases. Finally, through extensive experiments on synthetic and real ordinal datasets, we demonstrate the superiority of the proposed method, over state-of-the-art methods.
               
            

@&#INTRODUCTION@&#

In the community of machine learning, ordinal regression (OR) has been attracting increasing attentions due to its dual nature of discrete regression and ordinal classification, and especially wide applications in recommender system [1], web page ranking [13], image retrieval [32], medical image diagnosis [33], and facial age estimation [5,6].

To date, many varieties of methods have been proposed to implement OR, which mainly can be grouped into three categories. The main idea of the first family is to conduct OR straightforwardly by means of the off-the-shelf regressors. For example, Kramer et al. [15] first converted the ordinal labels into real values, and then borrowed the standard regressor for ordinal learning. However, an associated problem is that it is usually difficult to naturally measure the distance between the ordinal labels [4].

The methods of the second category reported in literature perform OR by referring to classification with single or multiple output codings. In [9], Frank et al. represented the ordinal labels with a batch of binary numbers, and then obtained the OR result by combining the outputs of many nested binary classifiers that are independent to each other. Along the line of Frank and Hall [9], Waegeman and Boullart [31] further assigned weights for the involved binary classifiers to promote the generalization ability. To better achieve the goal of ordinal learning with a single augmented binary classifier, Cardoso and De Costa [4] took the way of training data replication. And recently, Lin and Li [16] even unified the methods of this family through modeling with cost matrix.

In order to more naturally conduct OR learning in accordance with its nature of lying between the classification and the regression, the third category assumes that the naturally ordinal classes can be orderly separated by a sequence of monotonous thresholds along the projection direction, thus which is also called the threshold-based. Along this way, the proportional odds model (POM) proposed in McCullagh [20] is the first attempt by modeling a linear combination of the training data for ordinal output, which later was extended non-linearly by neural network [19] and kernel mapping [24], respectively. After the POM, Crammer et al. [8] introduced a set of separation thresholds to the perception algorithm to perform online OR learning. Shashua and Levin [27] carried out the OR learning based on the principle of fixed-margin and sum-of-margin, respectively. Based on the work of Kramer et al. [15], Chu and Keerthi [7] developed ordinal variations of the SVM, called SVOR-IMC and SVOR-EXC, respectively associated with implicit and explicit ordinal thresholds. More recently, in order to generate a more discriminative OR estimator, Sun et al. [28] developed a discriminative OR learning model, KDLOR, by imposing order constraints between each two neighboring class means, and experimentally demonstrated the superiority of KDLOR to the SVORs. Considering the success of KDLOR, Pérez-Ortiz et al. [23] proposed to optimize the thresholds by means of maximum likelihood estimations; and in Tian et al. [30], Tian et al. incorporated the spatial information of images into the OR. Using the same form of ordinal constraints as in Sun et al. [28], Liu et al. [17] proposed the manifold ordinal regression (MOR) by preserving geometrical manifold embedded in data. More recently, Sun et al. [29] and Liu et al. [18], respectively, extended their methods to multidirectional versions, with the same form of ordinal constraints in each direction as in KDLOR or MOR. With a same goal of seeking for multidirectional OR projections, Gutiérrez et al. [12] even employed the complex neural networks to train a set of concentric hyperspheres for OR. Considering that in most cases unidirectional OR can be similarly extended to corresponding multidirectional counterpart, so in this work we just focus on the unidirectional OR. As typical unidirectional OR methods with preferable performance, although the KDLOR and MOR can yield more competitive results than other ones including the SVORs, they still mainly suffer from two problems:
                        
                           1.
                           Their ordinal constraints are built on a sequence of partial order constraints each of which just associates with one threshold between two neighboring classes. That is, the thresholds involved are optimized independently from each other such that the global optimality is difficult to guarantee.

The constraints involved associate with just class means (i.e., class centroids), which may be under-represented for the individual distributions of data classes, as demonstrated in Fig. 1
                              .

Motivated by the above analysis, as well as the threshold-based OR decision rule (i.e., actually, a test instance is assigned into the ordinal class whose centroid is nearest to the instance), in this work we propose to jointly learn the ordinal thresholds across training samples and class centroids through seeking for an optimal projection direction along which all the samples are distributed as in order as possible and maximally cater for a nearest-centroid distribution for each class. As a result, such a learning problem can be formulated as a combinatorial optimization problem. For efficiency of implementation, we relax the problem to a quadratic programming that can be easily solved and makes the KDLOR and MOR become its reduced cases. Finally, through extensive comparative experiments on a toy problem, hand-written digit recognition and human facial age estimation, we demonstrate the superiority of our strategy in performing OR. To our knowledge, this is the first work to learning OR directly from the perspective of threshold-based OR decision rule.

Our main contributions in this paper are as follows:
                        
                           •
                           Propose a novel ordinal regression (OR) learning strategy, namely Ordinal Nearest-Centroid Projection (OrNCP), specially following the threshold-based OR decision rule and formulate it as a combinatorial optimization problem.

For efficiency of implementation, relax the OrNCP to a quadratic programming problem (QP-OrNCP) that covers two typical OR approaches KDLOR and MOR as its special cases.

Experimentally demonstrate the effectiveness and superiority of our strategy in performing OR, on both synthetic and real-world datasets, in which we also investigate the influences of the form and the granularity of the ordinal constraints on OR performance, finding that our ordinal nearest-centroid constraints imposed across class centroids and data samples are superior to those either just on class centroids or just on class samples.

The rest of this paper is organized as follows. In Section 2, we briefly review two typical threshold-based OR methods, i.e., the KDLOR and MOR, and especially show their strategy in preserving the order of data. In Section 3, we propose our learning strategy for OR, directly following the threshold-based OR decision rule. And to evaluate the effectiveness of our strategy, we conduct comparative experiments on synthetic and real world datasets in Section 4. Finally, we conclude the paper in Section 5.

@&#RELATED WORK@&#

Prior to introducing our work, we first give a brief review for the KDLOR and MOR, two typical threshold-based OR methods closely-related to our work, and analyze their limitations in OR learning.

In Sun et al. [28], an ordinal counterpart of discriminant learning (i.e., KDLOR
                           1
                           Unless otherwise specified, in this paper we do not explicitly distinguish between the linear and non-linear cases.
                        
                        
                           1
                        ) was proposed for catering for ordinality of data classes. With the goal of minimizing the within-class scatter and simultaneously preserving the order structure among the data classes, Sun et al. designed the following formulation
                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      w
                                                      ,
                                                      ρ
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             
                                                
                                                   S
                                                
                                                
                                                   w
                                                
                                             
                                             ·
                                             w
                                             -
                                             C
                                             ·
                                             ρ
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             ⩾
                                             ρ
                                             ,
                                             
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             K
                                             -
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    S
                                 
                                 
                                    w
                                 
                              
                           
                         denotes the whole within-class scatter matrix, C is a trade-off parameter, 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                           
                         represents the class mean of the kth class, and 
                           
                              ρ
                           
                         denotes the margin between two neighboring classes after projected along the w.

Based on the assumption that many observations usually comply with certain low-dimensional manifold distribution, Liu et al. [17] proposed to employ the manifold learning to OR, and presented the ordinal regression with manifold preservation, called MOR formulated as
                           
                              (2)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      w
                                                      ,
                                                      ρ
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             X
                                             ·
                                             L
                                             ·
                                             
                                                
                                                   X
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             w
                                             -
                                             C
                                             ·
                                             ρ
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             ⩾
                                             ρ
                                             ,
                                             
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             K
                                             -
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        in which X denotes the training data matrix, L is the Laplacian matrix as defined in Belkin and Niyogi [2], and the meanings of other symbols here are the same as those in Section 2.1.

Comparing Eqs. (1) and (2), it can be seen that the ordinal constraints of
                           
                              (3)
                              
                                 
                                    
                                       w
                                    
                                    
                                       T
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       m
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ⩾
                                 ρ
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 K
                                 -
                                 1
                                 ,
                              
                           
                        are the same in the form, which restrict the projected means of classes to be arranged in order by combining a sequence of partial order constraints between the means of two neighboring classes. However, such type of constraints leaves a performance space that can be further improved, since that
                           
                              1.
                              The thresholds, lying between every two neighboring classes, just associate with their corresponding partial order constraint and are optimized independently from each other, by which the global ordinal optimality is difficult to guarantee.

The partial order constraints are built upon the means of classes, which are generally under-represented for distributions of data classes. As a result, the performance of OR learning will be deteriorated, as demonstrated in Fig. 1.

@&#PROPOSED METHOD@&#

To mitigate the problems aforementioned, in what follows we propose a novel strategy to jointly learn the ordinal thresholds across training samples and class centroids (i.e., class means), motivated by the analysis of threshold-based OR decision rule.

Through the literature review about the threshold-based OR methods aforementioned in Section 1, we can summarize the main idea of threshold-based OR learning as follows:
                           
                              •
                              
                                 In the training phase: on the training set, seek for an optimal projection direction (here denoted as w) along which all the samples are arranged as consistent with their orders as possible and every two neighboring classes are separated by thresholds, which are constrained to be ordinal.


                                 In the test phase: for a new test instance, project it along the direction w, and compare its resulting projection with the OR thresholds to make an order decision.

From the analysis above, it can be seen that the threshold-based OR learning is quite similar to the nearest-centroid projection learning [10], as demonstrated in Fig. 2
                        . More importantly, in the learning of the nearest-centroid projection, the distances of each sample to class-centroids of all classes are considered together. That is, in seeking for the optimal nearest-centroid projection direction, all the thresholds associated between classes are adjusted simultaneously.

Motivated by the analysis above, in what follows we propose a novel OR learning strategy to jointly learn the thresholds involved across samples and class centroids through seeking for an optimal direction along which all the samples are distributed as in order as possible and meanwhile maximally cater for a nearest-centroid distribution for each class, coined as OrNCP. More concretely, we assume that there are a set of 
                           
                              
                                 
                                    {
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                           
                         samples associated with ordinal class labels 
                           
                              
                                 
                                    {
                                    l
                                    }
                                 
                                 
                                    l
                                    =
                                    1
                                 
                                 
                                    K
                                 
                              
                           
                         from totally K classes and the kth class-set as 
                           
                              
                                 
                                    {
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                        . In addition, let 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                         denote the class mean of the kth class. Then, the optimization objective for the nearest-centroid projection, as demonstrated in Fig. 2, can be formulated as
                           
                              (4)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          w
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ≠
                                             k
                                          
                                       
                                       I
                                       [
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             T
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       |
                                       >
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             T
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       |
                                       ]
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             K
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       K
                                       -
                                       1
                                       )
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              |
                              ·
                              |
                           
                         represents the absolute value operator, w denotes the optimal projection vector to seek and 
                           
                              I
                           
                        [
                           
                              ·
                           
                        ] is the indicator function which returns 1 if the argument is true and 0 otherwise. However, it can be seen that the ordinal relationship among the classes has not been reflected in Eq. (4) yet. Therefore, we reformulate (4) by taking the ordinal information into account to cater for the OR and thus propose our OR strategy, which we call ordinal nearest-centroid projection learning, or OrNCP for short, whose objective is formulated as
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      w
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         l
                                                         <
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ikl
                                                      
                                                   
                                                   ·
                                                   I
                                                   [
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   )
                                                   >
                                                   k
                                                   -
                                                   l
                                                   ]
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   K
                                                   -
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             +
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         h
                                                         >
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ikh
                                                      
                                                   
                                                   ·
                                                   I
                                                   [
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   >
                                                   h
                                                   -
                                                   k
                                                   ]
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   (
                                                   K
                                                   -
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             +
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   I
                                                   [
                                                   |
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   |
                                                   <
                                                   1
                                                   ]
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   K
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    w
                                 
                                 
                                    ikl
                                 
                              
                           
                         (and similarly 
                           
                              
                                 
                                    w
                                 
                                 
                                    ikh
                                 
                              
                           
                        ) denotes the ordinal weight defined jointly on the ith sample from the kth class and the class centroids of the kth and pth classes. It can be found that by taking account of the ordinal relationships among data classes into learning, the nondirectional nearest-centroid projection learning of (4) is transformed into an ordinal counterpart of (5). More specifically, instead of selecting a projection for nondirectional nearest-centroid distribution, we propose to seek for an optimal projection along which all class samples are distributed as in order as possible and maximally cater for a nearest-centroid distribution for each class, as depicted by the first two terms and the third one of (5). It is worth to point out that it is these critical modifications that casts the ordinary nearest-centroid projection learning into an ordinal counterpart for OR, and by optimizing Eq. (5), the ordinal thresholds involved between the classes can be jointly learned, which, to our knowledge, is the first work to perform OR specifically following the threshold-based OR decision rule.

Although the OrNCP formulated in Eq. (5) shows us a novel strategy to perform OR directly according to the threshold-based OR decision rule, the OrNCP itself is a bit difficult to be optimized since that it is a combinatorial optimization problem. In practice, it is extremely time-consuming to seek for the optimal solution, especially when the size of training set is large.

To reduce the computational complexity, we relax (5) by introducing the hinge loss function [11] and enforcing the with-class scatters to be compact to approximate the first two and the third indicator functions 
                           
                              I
                           
                        [
                           
                              ·
                           
                        ] in (5), respectively. As a result, we can reformulate (5) as
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      w
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      K
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      l
                                                      <
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   ikl
                                                
                                             
                                             ·
                                             max
                                             
                                                
                                                   
                                                      (
                                                      k
                                                      -
                                                      l
                                                      )
                                                      -
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      )
                                                      ,
                                                      
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      K
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      h
                                                      >
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   ikh
                                                
                                             
                                             ·
                                             max
                                             
                                                
                                                   
                                                      (
                                                      h
                                                      -
                                                      k
                                                      )
                                                      -
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      ,
                                                      
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      K
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             ‖
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             
                                                
                                                   ‖
                                                
                                                
                                                   2
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        For simplicity of deriving the dual problem, we rearrange (6) into an equivalent quadratic programming (QP) problem, as the optimization surrogate to approximate OrNCP, and we call the QP problem QP-OrNCP and write it as
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      w
                                                      ,
                                                      ξ
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             
                                                
                                                   S
                                                
                                                
                                                   w
                                                
                                             
                                             ·
                                             w
                                             +
                                             λ
                                             ·
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      K
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                      ≠
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   ikp
                                                
                                             
                                             ·
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ikp
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   l
                                                
                                             
                                             )
                                             ⩾
                                             (
                                             k
                                             -
                                             l
                                             )
                                             -
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ikl
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ikl
                                                
                                             
                                             ⩾
                                             0
                                             
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             K
                                             ,
                                             
                                             l
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             k
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   h
                                                
                                             
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             ⩾
                                             (
                                             h
                                             -
                                             k
                                             )
                                             -
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ikh
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ikh
                                                
                                             
                                             ⩾
                                             0
                                             
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             K
                                             ,
                                             
                                             h
                                             =
                                             k
                                             +
                                             1
                                             ,
                                             k
                                             +
                                             2
                                             ,
                                             …
                                             ,
                                             K
                                          
                                       
                                    
                                 
                              
                           
                        in which 
                           
                              
                                 
                                    S
                                 
                                 
                                    w
                                 
                              
                           
                         represents within-class scatters matrix, 
                           
                              
                                 
                                    w
                                 
                                 
                                    ikp
                                 
                              
                           
                        
                        
                           2
                           In this work, we set 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ikp
                                       
                                    
                                    =
                                    |
                                    k
                                    -
                                    p
                                    |
                                 
                              . Actually, other reasonable definitions are acceptable as well.
                        
                        
                           2
                         denotes the ordinal weight defined jointly on the ith sample from the kth class and the class centroids of the kth and pth classes, 
                           
                              λ
                           
                         is the trade-off parameter to control the model complexity, and 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    ikp
                                 
                              
                           
                         denotes the slack variables to regularize the solution space. It can be seen that the QP problem in (7) seeks for an optimal projection vector w along which (1) the within-class scatters are compacted maximally, i.e., the sum of distances of samples to their individual class centroids are minimized, as formulated in the objective of (7), and (2) the distances of samples from each class to the centroids of all the other classes are enlarged proportionally to corresponding class centroid–centroid discrepancies, as expressed in the constraints of (7). When taking the (1) and (2) together into account, the QP-OrNCP of (7) can be seen as a relaxation approximation to the OrNCP of (5). More importantly, compared with OrNCP of (5), QP-OrNCP can be more efficiently optimized.

As a standard QP problem, the QP-OrNCP of (7) can be solved by a variety of off-the-shelf optimization algorithms, such as interior point 
                        [21] and conjugate gradient descent 
                        [22], etc. On the other hand. we can also derive and optimize its dual problem instead, which is also a QP problem written as
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      α
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   4
                                                
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             
                                                
                                                   A
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             
                                                
                                                   S
                                                
                                                
                                                   w
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             ·
                                             A
                                             ·
                                             α
                                             -
                                             B
                                             ·
                                             α
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             0
                                             ⩽
                                             α
                                             ⩽
                                             λ
                                             ·
                                             vec
                                             
                                                
                                                   (
                                                   W
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              A
                              ≔
                              [
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    3
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    K
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    K
                                    -
                                    1
                                 
                              
                              ]
                              ,
                              
                              B
                              ≔
                              [
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              1
                              ]
                           
                        , 
                           3
                           Note that the 
                                 
                                    A
                                 
                               and 
                                 
                                    B
                                 
                               in Eq. (8) are defined in order according to the left-hand and right-hand terms of the first and third lines of constraints in Eq. (7), respectively.
                        
                        
                           3
                         
                        W is a tensor with the ikpth entry 
                           
                              
                                 
                                    w
                                 
                                 
                                    ikp
                                 
                              
                           
                         being the ordinal weight defined as in Eq. (7), and 
                           
                              vec
                              (
                              ·
                              )
                           
                         is the vectorization operator. Once the dual variable 
                           
                              α
                           
                         has been obtained by optimizing Eq. (8), the primal variable w can be calculated by
                           
                              (9)
                              
                                 w
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       w
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 A
                                 α
                                 .
                              
                           
                        
                     

With the projection vector w, the order of an unseen instance x can be predicted by the following decision rule
                           4
                           It is worth to point out that for simplicity, the nearest centroid rule can also be used for decision making.
                        
                        
                           4
                        :
                           
                              (10)
                              
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                 {
                                 k
                                 :
                                 
                                    
                                       w
                                    
                                    
                                       T
                                    
                                 
                                 x
                                 -
                                 
                                    
                                       b
                                    
                                    
                                       k
                                    
                                 
                                 <
                                 0
                                 }
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    b
                                 
                                 
                                    k
                                 
                              
                              ≔
                              
                                 
                                    w
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    N
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                              /
                              (
                              
                                 
                                    N
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    k
                                 
                              
                              )
                           
                        .

To better handle the real-world possible non-linear OR problems, we can extend the QP-OrNCP to its non-linear counterpart by using kernel trick. In accordance with the Representer Theorem [26] associated with a feature mapping function 
                           
                              ϕ
                              :
                              x
                              
                              ↦
                              
                              ϕ
                              (
                              x
                              )
                           
                        , the original projection vector w can be represented by a combination of the training set as
                           
                              (11)
                              
                                 w
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 ϕ
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 .
                              
                           
                        Substituting w by (11) into (7), we can derive the non-linear version of QP-OrNCP as
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      β
                                                      ,
                                                      ξ
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             Θ
                                             ·
                                             β
                                             +
                                             λ
                                             ·
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      K
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                      ≠
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   ikp
                                                
                                             
                                             ·
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ikp
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   T
                                                
                                             
                                             (
                                             
                                                
                                                   Ker
                                                
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         Ker
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   l
                                                
                                             
                                             )
                                             ⩾
                                             (
                                             k
                                             -
                                             l
                                             )
                                             -
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ikl
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ikl
                                                
                                             
                                             ⩾
                                             0
                                             
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             K
                                             ,
                                             
                                             l
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             k
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   T
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         Ker
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   h
                                                
                                             
                                             -
                                             
                                                
                                                   Ker
                                                
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             ⩾
                                             (
                                             h
                                             -
                                             k
                                             )
                                             -
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ikh
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ikh
                                                
                                             
                                             ⩾
                                             0
                                             
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             K
                                             ,
                                             
                                             h
                                             =
                                             k
                                             +
                                             1
                                             ,
                                             k
                                             +
                                             2
                                             ,
                                             …
                                             ,
                                             K
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              Θ
                              ≔
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    K
                                 
                              
                              
                                 
                                    Ker
                                 
                                 
                                    k
                                 
                              
                              (
                              I
                              -
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    Ker
                                 
                                 
                                    k
                                 
                                 
                                    T
                                 
                              
                           
                         with I being an identity matrix and 
                           
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                         a matrix of all entries equaling 
                           
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              Ker
                           
                         denotes the N-by-N kernel matrix with the ijth entry defined as 
                           
                              
                                 
                                    Ker
                                 
                                 
                                    ij
                                 
                              
                              ≔
                              ϕ
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                              ·
                              ϕ
                              (
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        , the N-by-
                           
                              
                                 
                                    N
                                 
                                 
                                    k
                                 
                              
                           
                         matrix 
                           
                              
                                 
                                    Ker
                                 
                                 
                                    k
                                 
                              
                           
                        , corresponding to the kth class, is a sub-matrix of 
                           
                              Ker
                              ,
                              
                                 
                                    
                                       
                                          Ker
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              ≔
                              
                                 
                                    [
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    ϕ
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    ·
                                    ϕ
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    ϕ
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    ·
                                    ϕ
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          N
                                       
                                    
                                    )
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                         denotes the new centroid of the kth class in the mapped feature space, and 
                           
                              
                                 
                                    Ker
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              ≔
                              
                                 
                                    [
                                    ϕ
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    ·
                                    ϕ
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    ϕ
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                N
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    ·
                                    ϕ
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                         stands for the ith column of 
                           
                              
                                 
                                    Ker
                                 
                                 
                                    k
                                 
                              
                           
                        . Through substituting the inner-product 
                           
                              ϕ
                              
                                 
                                    (
                                    ·
                                    )
                                 
                                 
                                    T
                                 
                              
                              ·
                              ϕ
                              (
                              ·
                              )
                           
                         defined in Eq. (12) with Mercer kernel functions such as radial basis function (RBF), we can map the samples from original feature space into a higher or even infinite-dimensional space. In form, the non-linear QP-OrNCP of (12) is analogous to its linear case of (7) and thus can be solved in a similar way.

In this subsection, we provide a complexity analysis to the QP-OrNCP. After analyzing the QP-OrNCP upon its primal and dual formulations, it can be found that solving the primal QP problem in (7) involves a 
                           
                              d
                              ×
                              d
                           
                         Hessian matrix associated with a total of 
                           
                              2
                              N
                              (
                              K
                              -
                              1
                              )
                           
                         linear constraints, where d denotes the feature dimension and N is the size of training set, while its dual problem in (8) involves a 
                           
                              [
                              N
                              (
                              K
                              -
                              1
                              )
                              ]
                              ×
                              [
                              N
                              (
                              K
                              -
                              1
                              )
                              ]
                           
                         Hessian matrix also with totally 
                           
                              2
                              N
                              (
                              K
                              -
                              1
                              )
                           
                         linear constraints. In our implementations, we adopt the interior-point algorithm [3] to solve the QP-OrNCP by optimizing its primal problem or dual form, respectively with a total complexity 
                           
                              O
                              (
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         and 
                           
                              O
                              (
                              
                                 
                                    N
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    (
                                    K
                                    -
                                    1
                                    )
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        , and it depends on the original feature dimension, the number of data classes, and the size of training set to whether solve the primal QP-OrNCP or its dual problem.


                        KDLOR vs QP-OrNCP: Comparing KDLOR of (1) with QP-OrNCP of (7), it can be proved that KDLOR actually is a reduced case of QP-OrNCP. Specifically, if we just consider two neighboring classes with equal ordinal weight 
                           
                              
                                 
                                    w
                                 
                                 
                                    ikp
                                 
                              
                              =
                              1
                           
                         in the constraints of (7), then it degenerates into the following form
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      w
                                                      ,
                                                      ξ
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             
                                                
                                                   S
                                                
                                                
                                                   w
                                                
                                             
                                             ·
                                             w
                                             +
                                             λ
                                             ·
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      2
                                                   
                                                   
                                                      K
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ik
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   k
                                                   -
                                                   1
                                                
                                             
                                             )
                                             ⩾
                                             1
                                             -
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ik
                                                
                                             
                                             ,
                                             
                                             k
                                             =
                                             2
                                             ,
                                             3
                                             ,
                                             …
                                             K
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   N
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ik
                                                
                                             
                                             ⩾
                                             0
                                             ,
                                             
                                             k
                                             =
                                             2
                                             ,
                                             3
                                             ,
                                             …
                                             K
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   N
                                                
                                                
                                                   k
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Summing up all the constraints associated with the 
                           
                              
                                 
                                    N
                                 
                                 
                                    k
                                 
                              
                           
                         samples of the kth class and making an average, then Eq. (13) degenerates into
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      w
                                                      ,
                                                      σ
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             
                                                
                                                   S
                                                
                                                
                                                   w
                                                
                                             
                                             ·
                                             w
                                             +
                                             λ
                                             ·
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      2
                                                   
                                                   
                                                      K
                                                   
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             ⩾
                                             1
                                             -
                                             
                                                
                                                   σ
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                             k
                                             =
                                             2
                                             ,
                                             3
                                             ,
                                             …
                                             K
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   k
                                                
                                             
                                             ⩾
                                             0
                                             ,
                                             
                                             k
                                             =
                                             2
                                             ,
                                             3
                                             ,
                                             …
                                             K
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        that is,
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      w
                                                      ,
                                                      σ
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             ·
                                             
                                                
                                                   S
                                                
                                                
                                                   w
                                                
                                             
                                             ·
                                             w
                                             +
                                             λ
                                             ·
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      2
                                                   
                                                   
                                                      K
                                                   
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   T
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   k
                                                   -
                                                   1
                                                
                                             
                                             )
                                             ⩾
                                             1
                                             -
                                             
                                                
                                                   σ
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                             k
                                             =
                                             2
                                             ,
                                             3
                                             ,
                                             …
                                             K
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   k
                                                
                                             
                                             ⩾
                                             0
                                             ,
                                             
                                             k
                                             =
                                             2
                                             ,
                                             3
                                             ,
                                             …
                                             K
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    σ
                                 
                                 
                                    k
                                 
                              
                              ≔
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    ξ
                                 
                                 
                                    ik
                                 
                              
                           
                        . Till here, it can be found that (15) is essentially equivalent to KDLOR of (1) in strategy for OR, despite they differ in the scale of the thresholds. Therefore, KDLOR can be viewed as a reduced case of our QP-OrNCP.


                        MOR vs QP-OrNCP: Comparing (2) with (15), it can be found that if we define the 
                           
                              
                                 
                                    S
                                 
                                 
                                    w
                                 
                              
                           
                         in (15) as the 
                           
                              X
                              ·
                              L
                              ·
                              
                                 
                                    X
                                 
                                 
                                    T
                                 
                              
                           
                         in (2), then MOR, in form, can also be regarded as a reduced case of QP-OrNCP, and the inference is similar to that for KDLOR above (from (13)–(15)).

Moreover, empirical comparisons between KDLOR/MOR and QP-OrNCP will be conducted in Section 4.

@&#EXPERIMENTS@&#

To make evaluations on our proposed OR learning strategy, in this section we conduct a series of comparative experiments on synthetic and real-world datasets, respectively.

In all experiments, we adopt the cross-validation technique for model selection. In non-linear cases, we uniformly adopt the RBF as mapping function, defined as 
                           
                              ϕ
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                              ·
                              ϕ
                              (
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              )
                              ≔
                              exp
                              
                                 
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where the bandwidth 
                           
                              δ
                           
                         is tuned in the range of 
                           
                              {
                              0.01
                              
                                 
                                    D
                                 
                                 
                                    ‾
                                 
                              
                              ,
                              0.1
                              
                                 
                                    D
                                 
                                 
                                    ‾
                                 
                              
                              ,
                              0.2
                              
                                 
                                    D
                                 
                                 
                                    ‾
                                 
                              
                              ,
                              …
                              ,
                              0.9
                              
                                 
                                    D
                                 
                                 
                                    ‾
                                 
                              
                              ,
                              
                                 
                                    D
                                 
                                 
                                    ‾
                                 
                              
                              ,
                              10
                              
                                 
                                    D
                                 
                                 
                                    ‾
                                 
                              
                              }
                           
                         with 
                           
                              
                                 
                                    D
                                 
                                 
                                    ‾
                                 
                              
                              ≔
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        .

We apply the Mean Absolute Error (MAE) as the performance measure, defined as 
                           
                              MAE
                              ≔
                              
                                 
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                                 
                                    N
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         with 
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                         denoting the predicted and ground-truth OR values, respectively.

In order to make an intuitive comparison between our method (referring to the QP-OrNCP) and the KDLOR and MOR on their ability of performing OR, especially the ability to learn according to the distributions of data classes, in this subsection we conduct comparative experiment on a synthetic dataset.

For convenience of visual illustration, we generate a set of totally 4 ordinal classes, each with 20 two-dimensional examples sampled randomly (15 for training and the rest 5 for test), according to the specified means and covariances listed in Table 1
                        . On the generated dataset, we respectively seek for the optimal OR projection direction using the KDLOR, MOR, and our method, and show the comparative results in Fig. 3
                        .

As shown in Fig. 3, compared with the projection direction (represented by the line in orange-yellow
                           5
                           For interpretation of color in Fig. 3, the reader is referred to the web version of this article.
                        
                        
                           5
                        ) trained using either the KDLOR or MOR, the direction (according to the line drawn in green) trained via our method, QP-OrNCP, can coincide more with the distribution trend of training data. Moreover, our method can yield a much smaller MAE of 0.3010 opposite to 0.3209 by the other two methods.

The experiment above shows the superiority of our method in performing OR, especially in capturing the distributions of data classes and taking such distribution information as side-information to optimize the solution space, compared with such typical methods like KDLOR and MOR.

To make further evaluation on the effectiveness of our strategy in handling real-world OR, in this section we conduct experiments on eight widely-used ordinal benchmark datasets,
                           6
                           available at: http://www.liacc.up.pt/∼ltorgo/Regression/DataSets.html.
                        
                        
                           6
                         hand-written digit recognition and human facial age estimation, respectively. Moreover, Besides the KDLOR and MOR, we also introduce the SVOR-IMX [7] and OHRank [6] into experiments for comparison due to their promising performance on OR. More importantly, to further investigate (1) the effectiveness of our strategy in jointly learning the thresholds and (2) the influence of granularity
                           7
                           The terminology “granularity” of data in this paper refers to such an unit for data partition, in which the class sample corresponds to a single data point, while the class centroid to an entire class, hence the granularity of the latter is larger than that of the former.
                        
                        
                           7
                         of ordinal constraints on OR, we specially design two Foil methods for comparison, namely OR-M2M and OR-S2S, both of which share the same form of objective as QP-OrNCP of (7) but are imposed ordinal constraints, respectively just on class centroids and just on class samples (please refer to the Appendix for their detailed formulations).

Firstly, we make comparative experiments on the eight benchmark ordinal datasets to evaluate the effectiveness and superiority of our proposed OR learning strategy (i.e., the QP-OrNCP) in optimizing the thresholds in a joint way. Specifically, we group each of the 8 datasets into 10 equal-frequency bins (i.e., 10 classes), and report the comparative results over 10 random trials in Table 2
                           .

It can be found from the results shown in Table 2 that among the 6 typical threshold-based OR methods, the proposed QP-OrNCP generates the lowest MAEs on the latter 5 of the totally 8 datasets. It is worth noting that in most cases, the QP-OrNCP defeats the SVOR-IMX which optimizes the thresholds automatically and jointly. It demonstrates the effectiveness and superiority of the proposed learning strategy in optimizing the ordinal thresholds on the eight benchmark datasets.

We also conduct digit OR on two widely-used digit datasets
                              8
                              Note that the hand digit datasets may be used for cost-sensitive estimations, besides for OR [17].
                           
                           
                              8
                            USPS and MNIST. Specifically, the USPS database contains a total of 11,000 samples for digits ‘0’ to ‘9’, each with 1100 samples. As for MNIST, it also consists of 10 digits of ‘0’ to ‘9’, and each digit has a quantity of 6313 samples. To exclude the interference caused by feature representation, we directly extract raw-pixels to represent the digit samples, and with consideration of mitigating the over-fitting, we uniformly normalize the digit images to 8×8 and the resulting feature dimension is 64. Examples from the USPS and MNIST are shown in Fig. 4
                           (a) and (b), respectively.

For the hand-written digit recognition on the USPS and MNIST databases, we adopt 5-fold cross-validation for model selection, and show the experimental results averaged over 5 random runs in Figs. 5 and 6
                           
                           , respectively. From them, it can be found that,
                              
                                 1.
                                 Generally, MAEs of all the methods are decreasing with increasing training data. Moreover, in non-linear cases the performance difference among the methods is not so obvious as in linear cases, especially on USPS shown in Fig. 5(b). The reason can be found from the fact that MAEs of non-linear cases shown in Figs. 5(b) and 6(b) are correspondingly smaller than those of linear cases shown in 5(a) and 6(a), respectively, so the performance space is relatively smaller in non-linear feature space than in linear.

In most cases, the MAEs of OR-M2M are respectively smaller than those of KDLOR. By comparing (1) for KDLOR with (16) for OR-M2M, it can be found that the key difference between them relies on the form of constraints: in the OR-M2M the ordinal constraints are jointly imposed on all the class centroids (except for the difference in constraint granularity, OR-M2M takes the same form of ordinal constraints as our method QP-OrNCP), while in KDLOR the ordinality is imposed on a sequence of partial order constraints between neighboring two class centroids. Therefore, it demonstrates the superiority of jointly optimizing the ordinal thresholds.

In all cases, the MAEs of QP-OrNCP are respectively smaller than those of OR-M2M, which demonstrates that relatively coarse granularity of constraints unfavorably influences the OR performance and may be insufficient to preserve the ordinality of data. On the other hand, excessively fine granularity of ordinal constraints not only increases the computing complexity, but also likely to lead to over-fitting with poor OR performance as the OR-S2S which purely imposes ordinal constraints on the samples. Therefore, it demonstrates that the granularity of constraints is another crucial factor to OR.

Interestingly, the MAEs of the QP-OrNCP (the proposed method) are mostly lower than those of the SVOR-IMX which optimizes the thresholds in a joint and automatic way. It demonstrates the effectiveness, especially the superiority, of the QP-OrNCP in performing OR.

Besides the above OR experiments, human age estimation is another typical real-world OR problem. So in this subsection we additionally conduct experiments on two well known aging datasets: the FG-NET and Morph.

In the experiment, to generate equal amount of samples for each age class, we respectively select a subset from the FG-NET and the Morph Album 1. More concretely, from FG-NET we randomly select 23 images for each age ranging from 0 to 19years old, accounting for 20 age classes and some examples are shown in Fig. 7
                           (a). As for Morph dataset, we randomly pick a number of 23 age classes from 16years old to 38, each containing 31 images as shown in Fig. 7(b). Then, on the selected FG-NET and Morph sets, we uniformly crop the interested face regions from the raw images and normalize them to 16×16 pixels based on eye centers. With consideration of excluding the performance benefit brought by feature representation, we directly extract raw pixels as feature representation with dimension 256. Moreover, to mitigate the small samples problem as possible, we adopt the PCA [14] on the feature to extract 95 percent principle components as new feature representation with resulting dimension of 10 and 18, on the FG-NET and Morph, respectively.

On the generated aging datasets FG-NET and Morph, we perform age estimation using related OR methods, in which we uniformly adopt 2-fold cross-validation for optimal model selection. The experimental results averaged over 5 random runs are shown in Figs. 8 and 9
                           
                           , respectively. And it can be found from them that,
                              
                                 1.
                                 In all cases, the MAEs yielded by our method QP-OrNCP are correspondingly smaller than those by OR-M2M, OR-S2S, KDLOR and MOR. More importantly, compared with the state-of-the-art age estimation approach OHRank, our method QP-OrNCP can yield quite competitive estimation results, especially on the FG-NET. The results above prove the effectiveness and superiority of our learning strategy in performing ordinal age estimation.

The MAEs of the methods on Morph are correspondingly about 2 up to 3 times larger than those on FG-NET, which implies that the Morph dataset is relatively more difficult to identify than the FG-NET.

Following the success of ensemble learning in OR [25], we here consider to incorporate the QP-OrNCP as the ordinal classification method in ensemble learning for OR. Specially, without loss of generality, we respectively take the binary SVM and the QP-OrNCP as binary and three-class ordinal classification methods to construct our ensemble model, coined as Ensemble(SVM+QP-OrNCP). To evaluate the effectiveness of the QP-OrNCP in promoting the ensemble learning, we make experimental comparisons on the relatively complex OR problem-human age estimation, and present the comparative results in Fig. 10
                        .

By making a comparison between Figs. 10(a) and 8(a), and between Figs. 10(b) and 9(a), it can be found that:
                           
                              1.
                              The age estimation MAEs yielded by the ensemble methods are significantly lower than corresponding those by the standalone OR methods. It shows the superiority of ensemble strategy over the standalone.

The MAEs of the Ensemble(SVM+QP-OrNCP) are mostly lower than those of the Ensemble(SVM+SVOR-IMX), especially on the Morph. It demonstrates that besides in the standalone OR learning, our proposed OR strategy, i.e., the QP-OrNCP, is also effective in promoting the ensemble based OR.

@&#CONCLUSION@&#

To perform better OR, in this work we proposed a novel strategy to jointly learn the thresholds that separate two neighboring ordinal classes across samples and class centroids through seeking for an optimal OR projection direction along which all the samples are distributed as in order as possible and simultaneously cater for a nearest-centroid distribution for each class. We call such a learning strategy ordinal nearest-centroid projection learning and for efficiency of optimization, we further relaxed it to a quadratic programming problem that in form covers the KDLOR and MOR as its special cases. Through extensive experiments on synthetic and real ordinal datasets, we demonstrated the effectiveness and superiority of our strategy in either standalone or ensemble OR learning.

@&#ACKNOWLEDGMENTS@&#

This work was partially supported by the National Natural Science Foundation of China under Grant 61472186, the Specialized Research Fund for the Doctoral Program of Higher Education under Grant 20133218110032, the Funding of Jiangsu Innovation Program for Graduate Education under Grant 
                     CXLX13_159, and the Fundamental Research Funds for the Central Universities and Jiangsu Qing-Lan Project
                  .


                     OR-M2M: Shares the same form of objective as QP-OrNCP of (7) but has global ordinal constraints imposed just on class centroids, formulated as
                        
                           (16)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   w
                                                   ,
                                                   ξ
                                                
                                             
                                          
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                T
                                             
                                          
                                          ·
                                          
                                             
                                                S
                                             
                                             
                                                w
                                             
                                          
                                          ·
                                          w
                                          +
                                          λ
                                          ·
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   K
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   p
                                                   ≠
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                kp
                                             
                                          
                                          ·
                                          
                                             
                                                ξ
                                             
                                             
                                                kp
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                T
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                l
                                             
                                          
                                          )
                                          ⩾
                                          (
                                          k
                                          -
                                          l
                                          )
                                          -
                                          
                                             
                                                ξ
                                             
                                             
                                                kl
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                kl
                                             
                                          
                                          ⩾
                                          0
                                          
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          K
                                          ,
                                          
                                          l
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          k
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                T
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                h
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          ⩾
                                          (
                                          h
                                          -
                                          k
                                          )
                                          -
                                          
                                             
                                                ξ
                                             
                                             
                                                kh
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                kh
                                             
                                          
                                          ⩾
                                          0
                                          
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          K
                                          ,
                                          
                                          h
                                          =
                                          k
                                          +
                                          1
                                          ,
                                          k
                                          +
                                          2
                                          ,
                                          …
                                          ,
                                          K
                                       
                                    
                                 
                              
                           
                        
                     where all the notations here have the same meanings as those in (7).


                     OR-S2S: Shares the same form of objective as QP-OrNCP of (7) but has global ordinal constraints imposed just on class samples, formulated as
                        
                           (17)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   w
                                                   ,
                                                   ξ
                                                
                                             
                                          
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                T
                                             
                                          
                                          ·
                                          
                                             
                                                S
                                             
                                             
                                                w
                                             
                                          
                                          ·
                                          w
                                          +
                                          λ
                                          ·
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   K
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   p
                                                   ≠
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                kpij
                                             
                                          
                                          ·
                                          
                                             
                                                ξ
                                             
                                             
                                                kpij
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                T
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                             
                                                l
                                             
                                          
                                          )
                                          ⩾
                                          (
                                          k
                                          -
                                          l
                                          )
                                          -
                                          
                                             
                                                ξ
                                             
                                             
                                                klij
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                klij
                                             
                                          
                                          ⩾
                                          0
                                          
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          K
                                          ,
                                          
                                          l
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          k
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                T
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                             
                                                h
                                             
                                          
                                          -
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          ⩾
                                          (
                                          h
                                          -
                                          k
                                          )
                                          -
                                          
                                             
                                                ξ
                                             
                                             
                                                khij
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                khij
                                             
                                          
                                          ⩾
                                          0
                                          
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          K
                                          ,
                                          
                                          h
                                          =
                                          k
                                          +
                                          1
                                          ,
                                          k
                                          +
                                          2
                                          ,
                                          …
                                          ,
                                          K
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The problems (16) and (17) are in form similar to (7), therefore, both can be solved by the same way for (7).

@&#REFERENCES@&#

