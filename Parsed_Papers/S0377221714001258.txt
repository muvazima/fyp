@&#MAIN-TITLE@&#Two-level decomposition algorithm for crew rostering problems with fair working condition

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Two-level decomposition algorithm is proposed for crew rostering problem.


                        
                        
                           
                           The original problem is decomposed into the upper level master problem and the lower level subproblems.


                        
                        
                           
                           Effective cuts are developed to reduce search space.


                        
                        
                           
                           Computational results show that 1.6% of the duality gap can be obtained for a practical problem with 81 duties and 6 rosters.


                        
                        
                           
                           The performance is shown to be effective by comparing with that of the constraint programming solver.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Railway scheduling

Crew rostering

Two-level decomposition algorithm

Cut generation

@&#ABSTRACT@&#


               
               
                  A typical railway crew scheduling problem consists of two phases: a crew pairing problem to determine a set of crew duties and a crew rostering problem. The crew rostering problem aims to find a set of rosters that forms workforce assignment of crew duties and rest periods satisfying several working regulations. In this paper, we present a two-level decomposition approach to solve railway crew rostering problem with the objective of fair working condition. To reduce computational efforts, the original problem is decomposed into the upper-level master problem and the lower-level subproblem. The subproblem can be further decomposed into several subproblems for each roster. These problems are iteratively solved by incorporating cuts into the master problem. We show that the relaxed problem of the master problem can be formulated as a uniform parallel machine scheduling problem to minimize makespan, which is NP-hard. An efficient branch-and-bound algorithm is applied to solve the master problem. Effective valid cuts are developed to reduce feasible search space to tighten the duality gap. Using data provided by the railway company, we demonstrate the effectiveness of the proposed method compared with that of constraint programming techniques for large-scale problems through computational experiments.
               
            

@&#INTRODUCTION@&#

The crew scheduling problem is a significant problem for railway companies. The problem is currently solved in two phases: a crew pairing problem to find a set of a crew duties and crew rostering problem to construct a set of working schedules for crew members that is called a roster. The crew rostering problem is a rotating workforce scheduling problem that has high relevance for a broad range of work places in railway companies. The problem seeks to determine a set of rosters that is a cyclic sequence of daily shifts when a set of crew duties is given. Each crew duty has a start time and finish time. The aim is to find an assignment of duties and cyclic schedules that satisfy several workforce requirements. It is extremely difficult to solve the problems due to the complexity of several workforce regulations and personnel requirements.

Railway crew rostering problems have been widely studied (Caprara et al., 1998, Caprara, Toth, Vigo, & Fischetti, 1998; Hartog, Huisman, Erwin, & Kroon, 1998; Sodhi & Norris, 2004). Heuristic methods (Bianco, Bielli, Mingozzi, Ricciardelli, & Spadoni, 1992; Caprara et al., 1998; Maenhout & Vanhoucke, 2010; Teodorovic & Lucic, 1996; Zeghal & Minoux, 2006) and meta-heuristic methods (Lucic & Teodorovic, 1999; Souai & Teghem, 2009) and their integration with constraint programming techniques (Caprara et al., 1998; Dawid, Konig, & Strauss, 2001; Medard & Sawhney, 2007; Sellmann, Zervoudakis, Stamatopoulos, & Fahle, 2002) have been addressed. Column generation methods are used to solve the problem efficiently in (Freling, Lentink, & Wagelmans, 2004; Gamache, Soumis, Marquis, & Desrosiers, 1999; Saddoune, Desaulniers, Elhallaoui, & Soumis, 2011; Sellmann et al., 2002).

Fairness of working condition can be achieved by embedding the objective of the minimization of the maximum working times for crews. A common approach to considering fair working condition is to minimize the sum of the deviation of average working time or to impose the minimum and maximum working time constraints. However, it requires appropriate parameters of average or minimum and maximum working times. In this study, we examine the min–max approach to obtain a fair working condition that does not require any parameters. It becomes extremely difficult for column generation methods to treat the min–max type problems such as minimization of maximum working time.

A decomposition approach for the crew rostering problem with a graph-based model has been developed (Sugiyama, Nishi, Inuiguchi, Takahashi, & Ueda, 2012). In this work, we propose a two-level decomposition algorithm with the improvement of lower bounds by using a cell-based model with application to practical-sized instances. Also, we study the two-level decomposition algorithm for the crew rostering problem with aiming for fair working condition. The contributions of this paper are summarized as follows.
                        
                           •
                           The crew rostering problem for fair working condition is formulated as a large scale integer programming problem to minimize the weighted sum of total days of rosters and the maximum value of working time.

A two-level decomposition algorithm is presented. The original problem is decomposed into the upper-level master problem and the lower-level subproblems. The upper-level master problem determines an assignment of duties to the set of rosters. The lower-level subproblem generates a feasible cyclic sequence with considering several workforce regulations. Effective cuts are developed to reduce the feasible search space to tighten the duality gap.

We show that no more than 1.6% of the duality gap can be obtained by the proposed method for the practical data with 81 duties and 6 rosters.

The performance of the proposed method is shown to be effective by comparing the performance with that of constraint programming techniques.

@&#LITERATURE REVIEW@&#

The crew management problem in railway companies is mainly divided into a crew scheduling problem and a crew rostering problem. The crew scheduling problem (Nishi, Muroi, & Inuiguchi, 2011a) determines a daily schedule for crew members that is called duty. After duties are generated, rosters are created to assign duties to workforce rotations. The crew rostering problem determines an assignment of duties to rosters that is the set of the cyclic sequence of duties and rest periods. In this paper, we focus on the second phase of the crew rostering problem. The crew rostering problem appears in not only railway companies but also other transportation such as airline industries (Cappanera & Gallo, 2004; Dawid et al., 2001; Lucic & Teodorovic, 1999; Maenhout & Vanhoucke, 2010; Medard & Sawhney, 2007; Ryan, 2002; Saddoune et al., 2011; Sellmann et al., 2002; Souai & Teghem, 2009; Teodorovic & Lucic, 1996; Zeghal & Minoux, 2006), bus and mass transit (Ryan, 2002).

Several methods have been studied for solving crew rostering problems. The hierarchical decomposition approach is effective for solving the problems (Hartog et al., 1998; Sodhi & Norris, 2004). In Sodhi and Norris (2004), the crew rostering problem is decomposed into two stages: generation of rest-day pattern including shifts and assignment of duties to the rest-day pattern. In Hartog et al. (1998), the cyclic crew rostering problem is solved in two steps: the allocation of duties to crew members and the actual construction of rosters for each group. However, the optimality of the solution for the hierarchical decomposition algorithms is not ensured. For a heuristic approach (Bianco et al., 1992), hybrid scatter search (Maenhout & Vanhoucke, 2010), neighborhood search (Saddoune et al., 2011), Lagrangian heuristic (Caprara et al., 1998), rounding heuristic embedded in a partial tree search procedure (Zeghal & Minoux, 2006), and a fuzzy set theory approach (Teodorovic & Lucic, 1996) have been reported. For a meta-heuristic approach, GA based solution approach (Souai & Teghem, 2009), and simulated annealing (Lucic & Teodorovic, 1999) have been addressed. Mathematical programming approaches based on column generation methods have been extensively studied. Column generation methods integrated with heuristics (Gamache et al., 1999; Saddoune et al., 2011; Sellmann et al., 2002) or branch-and-bound called branch-and-price (Freling et al., 2004) have been addressed. For the model of rostering problems, set-partitioning model (Ryan, 2002) and 0–1 multi-commodity flow model (Cappanera & Gallo, 2004) have been studied. The fair working condition is one of the most important performance indices. A few studies that consider the fair working condition have been reported (Hartog et al., 1998; Maenhout & Vanhoucke, 2010). Fairness of working condition has been implemented by the minimization of the maximum working conditions. However, min–max type problems, such as minimizing makespan (Guignard, 1993), and decomposition scheme cannot be applied easily (Xu & Nagi, 2013). At the same time, the time index formulation for the problem leads to a limit on the efficiency of the approaches (van den Akker, Hoogeveen, & van Kempen, 2010). The main feature of this paper is to present the two-level decomposition approach to the crew rostering problem to achieve fairness of working condition that is required from theoretical and practical points of view.

A duty is a daily working plan for each crew member. A roster is a cyclic sequence of duties and rest periods. It represents a monthly working plan for a set of crew members. The cyclic crew scheduling problem aims at finding a set of rosters that is a feasible cyclic sequence of duties and rest periods when the number of rosters is given. Each duty identified by index i has start time 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                           
                        , finish time 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                           
                         and working duration 
                           
                              
                                 
                                    W
                                 
                                 
                                    i
                                 
                              
                           
                        . Each duty i has an attribute whether a duty is overnight one which requires working during the overnight or not. We construct a set of several rosters to partition all of given duties. A number of constraints are imposed by the regulations and labor laws. The constraints are listed as follows.
                           
                              (i)
                              Each week has equal or more than 
                                    
                                       D
                                       1
                                    
                                  rest days.

The minimum rest time between the consecutive two duties is equal to the working time of the previous duty.

The minimum rest time between two duties before and after a rest day is 
                                    
                                       H
                                       3
                                    
                                 .

A finish time of a duty before a rest day is before 
                                    
                                       H
                                       4
                                    
                                 .

A start time of a duty after a rest day is after 
                                    
                                       H
                                       5
                                    
                                 .

The number of consecutive overnight duties are at most two.

The maximum days for each roster is 
                                    
                                       D
                                       7
                                    
                                  (
                                    
                                       D
                                       7
                                       ⩾
                                       7
                                    
                                 ).
                                    
                                       
                                          
                                             
                                                H
                                                3
                                             
                                           [minute]: minimum rest time between two duties


                                          
                                             
                                                H
                                                4
                                             
                                           [minute]: latest finish time of duty before a rest day


                                          
                                             
                                                H
                                                5
                                             
                                           [minute]: earliest start time of duty after a rest day


                                          
                                             
                                                D
                                                1
                                             
                                           [day]: minimum rest days for a week


                                          
                                             
                                                D
                                                7
                                             
                                           [day]: maximum days for a roster.

An example of duties and rosters are shown in Fig. 1
                        . A roster is created by assigning a set of duties and rest days. In practice, a crew is assigned to a day in a roster. The crew members assigned to a roster performs a set of duties cyclically in a rotation as shown in Fig. 1. Therefore, fairness of working condition for rosters is highly desired. If the working condition for each roster is equalized, the total duration of a roster is increased. The performance indices consist of the fairness of labor conditions for rosters and the total duration of rosters. In this study, fairness of the rosters is represented by the first objective of the minimization of the monthly average working time of rosters. The objective function is the total cost of the rosters represented by the weighted sum of the maximum monthly average working time and the total periods of rosters. The empty day that has no duty is also permitted. An empty day cannot be a rest day due to violations of constraints (iii)–(v).


                        I is the set of given duties and K is that of rosters are to be constructed. We assign each duty 
                           
                              i
                              ∈
                              I
                           
                         to one of 
                           
                              |
                              K
                              |
                              ×
                              D
                              7
                           
                         cells. In each roster, the rest day, the last day at the end of the roster, and the other empty days should be determined. We assume that the last day of the roster is a rest day and it is directly connected to the first day of the next roster.


                        
                           
                              
                                 
                                 
                                    
                                       
                                          Sets
                                       
                                    
                                    
                                       
                                          I:set of duties
                                    
                                    
                                       
                                          K:set of rosters
                                    
                                    
                                       
                                          D:set of days 
                                             
                                                (
                                                D
                                                =
                                                {
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                D
                                                7
                                                }
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      M
                                                   
                                                
                                             
                                          :set of night duties 
                                             
                                                (
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      M
                                                   
                                                
                                                ⊂
                                                I
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                    
                                    
                                       
                                          Constants
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           [minute]:start time of duty 
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           [minute]:finish time of duty 
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           [minute]:working time of duty 
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                H
                                                0
                                             
                                          :constant (one hour)
                                    
                                    
                                       
                                          M:sufficiently large positive number
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          :weighting factors
                                    
                                    
                                       
                                          
                                       
                                    
                                    
                                       
                                          Decision variables
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                      ,
                                                      k
                                                      ,
                                                      d
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  if
                                                                  
                                                                  duty
                                                                  
                                                                  i
                                                                  
                                                                  is
                                                                  
                                                                  performed
                                                                  
                                                                  on
                                                                  
                                                                  day
                                                                  
                                                                  d
                                                                  
                                                                  in
                                                                  
                                                                  roster
                                                                  
                                                                  k
                                                               
                                                            
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  otherwise
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      k
                                                      ,
                                                      d
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  if
                                                                  
                                                                  day
                                                                  
                                                                  d
                                                                  
                                                                  in
                                                                  
                                                                  roster
                                                                  
                                                                  k
                                                                  
                                                                  is
                                                                  
                                                                  the
                                                                  
                                                                  rest
                                                                  
                                                                  day
                                                               
                                                            
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  otherwise
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      k
                                                      ,
                                                      d
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  if
                                                                  
                                                                  day
                                                                  
                                                                  d
                                                                  
                                                                  in
                                                                  
                                                                  roster
                                                                  
                                                                  k
                                                                  
                                                                  is
                                                                  
                                                                  the
                                                                  
                                                                  last
                                                                  
                                                                  day
                                                                  
                                                                  (
                                                                  rest
                                                                  
                                                                  day
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  otherwise
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                α
                                                ∈
                                                R
                                             
                                          :maximum value of monthly average working time
                                    
                                 
                              
                           
                        
                        
                           
                              (1)
                              
                                 (
                                 IP
                                 )
                                 
                                 min
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                1
                                             
                                          
                                          α
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                
                                                   D
                                                   7
                                                
                                             
                                          
                                          d
                                          
                                          
                                             
                                                f
                                             
                                             
                                                k
                                                ,
                                                d
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                   ,
                                                   k
                                                   ,
                                                   d
                                                
                                             
                                             +
                                             
                                                
                                                   h
                                                
                                                
                                                   k
                                                   ,
                                                   d
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   ,
                                                   d
                                                
                                             
                                             ⩽
                                             1
                                             ,
                                             
                                             
                                             d
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             D
                                             7
                                             ,
                                             ∀
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 I
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                          +
                                          6
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 +
                                 M
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                          +
                                          6
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 ⩾
                                 D
                                 1
                                 ,
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 D
                                 7
                                 -
                                 6
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                       +
                                       1
                                    
                                 
                                 +
                                 24
                                 H
                                 0
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                    
                                 
                                 )
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                       +
                                       1
                                    
                                 
                                 )
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                    
                                 
                                 ,
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 d
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 D
                                 7
                                 -
                                 1
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                       +
                                       1
                                    
                                 
                                 +
                                 48
                                 H
                                 0
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                       -
                                       1
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       h
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 )
                                 +
                                 M
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                ,
                                                k
                                                ,
                                                d
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 +
                                 M
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                ,
                                                k
                                                ,
                                                d
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 H
                                 3
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 d
                                 =
                                 2
                                 ,
                                 3
                                 ,
                                 …
                                 ,
                                 D
                                 7
                                 -
                                 1
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       1
                                    
                                 
                                 +
                                 48
                                 H
                                 0
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                       -
                                       1
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 )
                                 +
                                 M
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                ,
                                                k
                                                ,
                                                1
                                             
                                          
                                       
                                    
                                 
                                 +
                                 M
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                ,
                                                k
                                                ,
                                                d
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 H
                                 3
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 d
                                 =
                                 2
                                 ,
                                 3
                                 ,
                                 …
                                 ,
                                 D
                                 7
                                 -
                                 1
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                       -
                                       1
                                    
                                 
                                 -
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       h
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 )
                                 ⩽
                                 H
                                 4
                                 ,
                                 
                                 d
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 D
                                 7
                                 ,
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                       -
                                       1
                                    
                                 
                                 -
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 )
                                 ⩽
                                 H
                                 4
                                 ,
                                 
                                 d
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 D
                                 7
                                 ,
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                       +
                                       1
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       h
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 )
                                 +
                                 M
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                ,
                                                k
                                                ,
                                                d
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 H
                                 5
                                 ,
                                 
                                 d
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 D
                                 7
                                 -
                                 1
                                 ,
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       1
                                    
                                 
                                 ⩾
                                 H
                                 5
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                          +
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                I
                                             
                                             
                                                M
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                    
                                 
                                 ⩽
                                 2
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 D
                                 7
                                 -
                                 2
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       28
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 α
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 )
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 d
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 D
                                 7
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       h
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 )
                                 
                                 d
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 D
                                 7
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 d
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 D
                                 7
                                 ,
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                       ,
                                       d
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 
                                    
                                       h
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 d
                              
                           
                        The objective function (1) involves the minimization of the weighted sum of the maximum monthly average working time and the total days. Constraints (2) ensure that a duty, a rest day or a last day is assigned to each cell of a roster. Constraints (3) enforce that each duty 
                           
                              i
                              ∈
                              I
                           
                         is performed. Constraints (4) state that each week has equal or more than 
                           
                              D
                              1
                           
                         rest days from (i). Constraints (5) indicate that the minimum resting time between the consecutive two duties is the same as the working time of a previous duty from (ii). Constraints (6) imply that 
                           
                              H
                              3
                           
                         resting time is required between the finish time and the start time of the two duties before and after a rest day from (iii). Constraints (7) ensure that 
                           
                              H
                              3
                           
                         resting time is required between the finish time and start time of the two duties on the last day (rest day) and the first day from (iii). Constraints (8) and (9) restrict that the finish time of a duty before a rest day is before 
                           
                              H
                              4
                           
                         from (iv). Constraints (10) and (11) represent that the start time of a duty after a rest day is after 
                           
                              H
                              5
                           
                         from (v). Constraints (12) prohibit three or more than three consecutive night duties (vi). Constraints (13) are ignored if the value of d is not equal to the total days of roster k. If d is the total days of the roster, the left hand-side of the equation is equal to the average working time of the roster in terms of four weeks. Hence, 
                           
                              α
                           
                         is the monthly maximum average working time. Constraints (14) mean that the last day is assigned to each roster. Constraints (15) ensure that all days after the last day are empty days.

The decomposition algorithm is originated from the logic-based Benders decomposition method developed by Hooker (2007). The idea can be applied to a variety of discrete optimization problems such as the production planning and scheduling problems (Hooker & Ottosson, 2003; Nishi, Hiranaka, & Grossmann, 2011b). In the proposed method, an original problem 
                           
                              (
                              IP
                              )
                           
                         is decomposed into an upper-level master problem and the lower-level subproblems. The lower bound of the original problem is obtained from the solution of the master problem. The upper bound is obtained from the solutions of the subproblem where some decision variables of the master problem are fixed. These problems are iteratively solved. The cuts are embedded into the master problem in order to eliminate the non-promising candidates of solution. We provide the following propositions and proofs for the development of the proposed algorithm.
                           Proposition 1
                           
                              If the aggregated variable 
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          d
                                       
                                    
                                 
                               
                              is introduced, the relaxed problem eliminating some constraints from the original problem 
                              
                                 
                                    (
                                    IP
                                    )
                                 
                               
                              can be formulated as the master problem (MP) that determines 
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          d
                                       
                                    
                                 
                              
                              . The optimal value of (MP) provides the lower bound of 
                              
                                 
                                    (
                                    IP
                                    )
                                 
                              
                              .
                           


                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                 
                               represents whether duty i is assigned to the roster k or not from 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          d
                                       
                                    
                                    =
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    ,
                                    
                                    ∀
                                    i
                                    ∈
                                    I
                                    ,
                                    ∀
                                    k
                                    ∈
                                    K
                                 
                              . The problem 
                                 
                                    (
                                    IP
                                    )
                                 
                               can be reformulated as 
                                 
                                    (
                                    
                                       
                                          IP
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               by replacing 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          d
                                       
                                    
                                 
                               with 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                 
                               and replacing constraints (3) and (13) by (18)–(20).
                                 
                                    (17)
                                    
                                       (
                                       
                                          
                                             IP
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       
                                       
                                       
                                          min
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                α
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         K
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         d
                                                         ∈
                                                         D
                                                      
                                                   
                                                
                                                d
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      k
                                                      ,
                                                      d
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (18)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   s
                                                   .
                                                   t
                                                   .
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            d
                                                            =
                                                            1
                                                         
                                                         
                                                            D
                                                            7
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                         ,
                                                         k
                                                         ,
                                                         d
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         ,
                                                         k
                                                      
                                                   
                                                   ,
                                                   
                                                   
                                                   ∀
                                                   i
                                                   ∈
                                                   I
                                                   ,
                                                   ∀
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (19)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                ∈
                                                K
                                             
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                       =
                                       1
                                       ,
                                       
                                       
                                       ∀
                                       i
                                       ∈
                                       I
                                    
                                 
                              
                              
                                 
                                    (20)
                                    
                                       
                                          
                                             28
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                       ⩽
                                       α
                                       +
                                       M
                                       (
                                       1
                                       -
                                       
                                          
                                             f
                                          
                                          
                                             k
                                             ,
                                             d
                                          
                                       
                                       )
                                       ,
                                       
                                       ∀
                                       k
                                       ∈
                                       K
                                       ,
                                       
                                       d
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       D
                                       7
                                    
                                 
                              
                              (2), (4)–(12), (14)–(16)
                              
                                 
                                    (21)
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                       ∈
                                       {
                                       0
                                       ,
                                       1
                                       }
                                       ,
                                       
                                       ∀
                                       i
                                       ∈
                                       I
                                       ,
                                       
                                       ∀
                                       k
                                       ∈
                                       K
                                       ,
                                       
                                       d
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       D
                                       7
                                    
                                 
                              Clearly, 
                                 
                                    (
                                    
                                       
                                          IP
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               is equivalent to 
                                 
                                    (
                                    IP
                                    )
                                 
                              . The problem 
                                 
                                    (
                                    MP
                                    )
                                 
                               is obtained by eliminating all constraints except (19)–(21), and (14) from 
                                 
                                    (
                                    
                                       
                                          IP
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              . These removed constraints are related to the sequence of duties (decision variables d). The relaxed problem 
                                 
                                    (
                                    MP
                                    )
                                 
                               is formulated as follows.
                                 
                                    (22)
                                    
                                       (
                                       MP
                                       )
                                       
                                       
                                       
                                          min
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                α
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         K
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         d
                                                         ∈
                                                         D
                                                      
                                                   
                                                
                                                d
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      k
                                                      ,
                                                      d
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              s.t. (14), (19)–(21)
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                             ,
                                             d
                                          
                                       
                                       ∈
                                       {
                                       0
                                       ,
                                       1
                                       }
                                       ,
                                       ∀
                                       k
                                       ∈
                                       K
                                       ,
                                       
                                       d
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       D
                                       7
                                    
                                 
                              
                           

The objective function of 
                                 
                                    (
                                    MP
                                    )
                                 
                               is equal to that of (IP) and some constraints are removed from 
                                 
                                    (
                                    IP
                                    )
                                 
                              . Therefore, 
                                 
                                    (
                                    MP
                                    )
                                 
                               is a relaxed problem for (IP).□


                              Once an assignment of duties and the last day of rosters are determined, the problem 
                              
                                 
                                    (
                                    
                                       
                                          IP
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               
                              is reformulated as a feasibility problem 
                              
                                 
                                    (
                                    SP
                                    )
                                 
                               
                              that determines the sequence of duties satisfying constraints with fixed variables 
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          d
                                       
                                    
                                 
                              
                              .
                           

Suppose the decision variables 
                                 
                                    {
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          d
                                       
                                    
                                    ,
                                    α
                                    }
                                 
                               are fixed to 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          k
                                          ,
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          ‾
                                       
                                    
                                    }
                                 
                               derived by solving 
                                 
                                    (
                                    MP
                                    )
                                 
                              . Since all decision variables in (1) are fixed, the objective function for 
                                 
                                    (
                                    
                                       
                                          IP
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               is constant. 
                                 
                                    (
                                    
                                       
                                          IP
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               can be reformulated as the problem that determines the variable 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          k
                                          ,
                                          d
                                       
                                    
                                 
                               to satisfy the constraints of 
                                 
                                    (
                                    
                                       
                                          IP
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              . The constraints (14), (16), (19) and (20) are always satisfied because they are satisfied for (MP). 
                                 
                                    (
                                    
                                       
                                          IP
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               is reformulated as 
                                 
                                    (
                                    SP
                                    )
                                 
                               as follows.
                                 
                                    (23)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   (
                                                   SP
                                                   )
                                                   
                                                   min
                                                   
                                                   1
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   s
                                                   .
                                                   t
                                                   .
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                         ,
                                                         k
                                                         ,
                                                         d
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         k
                                                         ,
                                                         d
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                         ,
                                                         d
                                                      
                                                   
                                                   ⩽
                                                   1
                                                   ,
                                                   
                                                   d
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   …
                                                   ,
                                                   D
                                                   7
                                                   ,
                                                   ∀
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (24)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                d
                                                ∈
                                                D
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             d
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                       ,
                                       
                                       
                                       ∀
                                       i
                                       ∈
                                       I
                                       ,
                                       
                                       ∀
                                       k
                                       ∈
                                       K
                                    
                                 
                              
                              
                                 
                                    (25)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                d
                                                =
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                +
                                                6
                                             
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             k
                                             ,
                                             d
                                          
                                       
                                       +
                                       M
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                d
                                                =
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                +
                                                6
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             k
                                             ,
                                             d
                                          
                                       
                                       ⩾
                                       D
                                       1
                                       ,
                                       
                                       
                                       ∀
                                       k
                                       ∈
                                       K
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       D
                                       7
                                       -
                                       6
                                    
                                 
                              
                              
                                 
                                    (26)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             1
                                          
                                       
                                       +
                                       48
                                       H
                                       0
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             d
                                             -
                                             1
                                          
                                       
                                       +
                                       M
                                       (
                                       1
                                       -
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             k
                                             ,
                                             d
                                          
                                       
                                       )
                                       +
                                       M
                                       
                                          
                                             
                                                1
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                      ,
                                                      k
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       M
                                       
                                          
                                             
                                                1
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                      ,
                                                      k
                                                      ,
                                                      d
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       ⩾
                                       H
                                       3
                                       ,
                                       
                                       ∀
                                       k
                                       ∈
                                       K
                                       ,
                                       
                                       d
                                       =
                                       2
                                       ,
                                       3
                                       ,
                                       …
                                       ,
                                       D
                                       7
                                       -
                                       1
                                    
                                 
                              
                              
                                 
                                    (27)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             i
                                          
                                       
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             d
                                             -
                                             1
                                          
                                       
                                       -
                                       M
                                       (
                                       1
                                       -
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             k
                                             ,
                                             d
                                          
                                       
                                       )
                                       ⩽
                                       H
                                       4
                                       ,
                                       
                                       ∀
                                       k
                                       ∈
                                       K
                                       ,
                                       
                                       d
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       D
                                       7
                                    
                                 
                              
                              
                                 
                                    (28)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       ⩽
                                       M
                                       (
                                       1
                                       -
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       )
                                       ,
                                       
                                       d
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       D
                                       7
                                       ,
                                       
                                       
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       d
                                       +
                                       1
                                       ,
                                       …
                                       .
                                       ,
                                       D
                                       7
                                       ,
                                       
                                       ∀
                                       k
                                       ∈
                                       K
                                    
                                 
                              
                              (5), (6), (8), (10)–(12), (16)
                           

The problem is a feasibility problem that determines the sequence of duties 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          d
                                       
                                    
                                 
                               and the rest days 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          k
                                          ,
                                          d
                                       
                                    
                                 
                               with fixed assignment, the last day and the maximum value of monthly average working time 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          k
                                          ,
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          ‾
                                       
                                    
                                    }
                                 
                               of rosters.□

The master problem determines an assignment of crew duties to the set of rosters and the period of days of each roster in order to minimize the weighted sum of the average working time and the period of days. The following constraints related to rest periods are imposed to 
                           
                              (
                              MP
                              )
                           
                        .
                           
                              (29)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                 
                                 d
                                 
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 ⩾
                                 
                                    
                                       7
                                    
                                    
                                       7
                                       -
                                       D
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                        Constraints (29) ensure that the total period of days for roster k should be greater than the sum of the number of duties 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ∈
                                    I
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    D
                                    1
                                 
                                 
                                    7
                                    -
                                    D
                                    1
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ∈
                                    I
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           
                         rest days because each roster should have 
                           
                              D
                              1
                           
                         rest days per 
                           
                              (
                              7
                              -
                              D
                              1
                              )
                           
                         duties from (4). Since the feasible solution for 
                           
                              (
                              MP
                              )
                           
                         satisfies (29), the constraints do not eliminate the optimal solution of 
                           
                              (
                              MP
                              )
                           
                        .
                           Lemma 1
                           
                              Once the period of days for roster k is fixed, 
                              
                                 
                                    (
                                    MP
                                    )
                                 
                               
                              can be reformulated as a uniform parallel machines scheduling problem to minimize makespan.
                           

Let 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          k
                                       
                                    
                                 
                               be the period of days of the roster k. 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          d
                                       
                                    
                                 
                               is fixed by 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          d
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      if
                                                      
                                                      d
                                                      =
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              . The master problem 
                                 
                                    (
                                    MP
                                    )
                                 
                               is formulated as 
                                 
                                    (
                                    MP
                                    -
                                    2
                                    )
                                 
                               if the constraints (29) are ignored.
                                 
                                    (30)
                                    
                                       (
                                       MP
                                       -
                                       2
                                       )
                                       
                                          min
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                α
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         K
                                                      
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (31)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   s
                                                   .
                                                   t
                                                   .
                                                   
                                                   
                                                   
                                                   
                                                      (19)
                                                   
                                                   
                                                   and
                                                   
                                                   
                                                      (21)
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         28
                                                         
                                                            
                                                               W
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         ,
                                                         k
                                                      
                                                   
                                                   ⩽
                                                   α
                                                   ,
                                                   
                                                   ∀
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    MP
                                    -
                                    2
                                    )
                                 
                               is a uniform parallel machines scheduling problem to minimize makespan. The processing time of job i is 
                                 
                                    28
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                 
                               and the speed of machine k is 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          k
                                       
                                    
                                 
                              . This problem is known for NP-hard (Lin & Liao, 2008).□

Since 
                           
                              (
                              MP
                              -
                              2
                              )
                           
                         is NP-hard, the master problem is solved through an efficient branch-and-bound algorithm. The outline of the branch-and-bound algorithm is explained as follows.


                        Branching: The nodes in the branching tree are branched firstly by the period of days of each roster 
                           
                              {
                              
                                 
                                    f
                                 
                                 
                                    k
                                    ,
                                    d
                                 
                              
                              =
                              1
                              }
                              ,
                              {
                              
                                 
                                    f
                                 
                                 
                                    k
                                    ,
                                    d
                                 
                              
                              =
                              0
                              }
                           
                         
                        
                           
                              (
                              k
                              =
                              1
                              ,
                              …
                              ,
                              K
                              ,
                              
                              d
                              =
                              1
                              ,
                              …
                              ,
                              D
                              7
                              )
                           
                         and then branched by the assignment of duties 
                           
                              {
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              =
                              0
                              }
                              ,
                              {
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              =
                              1
                              }
                              (
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              ,
                              k
                              =
                              1
                              ,
                              …
                              ,
                              K
                              )
                           
                        .


                        Node priority: Three criteria of selecting the branching nodes are defined. The first priority is to select the node that has the lowest lower bound. The second priority is to select the node that has the deepest branching tree. The third priority is to choose the node that has the least number of days or the node that has the minimum makespan.


                        Constraints: During the best bound search, constraints satisfaction of (29) and cuts (see the following section) are checked. We generate the new branching nodes only when all constraints are satisfied.

The algorithm requires huge memory to solve the master problem if the information of all nodes are kept during the search. In order to avoid this situation, we apply the best-bound search based algorithm. In the algorithm, a pruning lower bound 
                           
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                 
                              
                           
                         and an upper bound UB are defined. A feasible solution with the objective function which is equal or less than 
                           
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                 
                              
                           
                         is searched until 
                           
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                 
                              
                              =
                              UB
                           
                         is satisfied. If the lower bound of a generated node is equal or more than the current 
                           
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                 
                              
                           
                        , the node is discarded from the search. The upper bound UB is also updated during the search. 
                           
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                 
                              
                           
                         is firstly set to 0 and 
                           
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                 
                              
                              +
                              1
                           
                         if all nodes are pruned. K is the set of rosters and 
                           
                              
                                 
                                    I
                                 
                                 
                                    ′
                                 
                              
                           
                         is the set of duties that has been already assigned. Each roster has at most 
                           
                              7
                              -
                              D
                              1
                           
                         duties per 7days. Therefore, the maximum number of duties 
                           
                              
                                 
                                    n
                                 
                                 
                                    k
                                 
                              
                           
                         is computed by 
                           
                              
                                 
                                    n
                                 
                                 
                                    k
                                 
                              
                              =
                              [
                              
                                 
                                    7
                                    -
                                    D
                                    1
                                 
                                 
                                    7
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                              ]
                           
                         (
                           
                              [
                              
                              ]
                           
                         is Gauss symbol) if the period of duty k is 
                           
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                           
                        . The minimum number of duties 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                           
                         that can be assigned to roster k can also be obtained by 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                              =
                              |
                              K
                              |
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    ≠
                                    k
                                 
                              
                              
                                 
                                    n
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        . 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                                 
                                    min
                                 
                              
                           
                         is the minimal set of duties whose cardinality is 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                           
                         and they are chosen from I by the ascending order of working time. 
                           
                              
                                 
                                    K
                                 
                                 
                                    max
                                 
                              
                           
                         is the set of rosters whose cardinality is 
                           
                              
                                 
                                    n
                                 
                                 
                                    k
                                 
                              
                           
                         and the set of duties is maximally assigned. The lower bound of a generated node is obtained by the following equations.
                           
                              (32)
                              
                                 LB
                                 =
                                 
                                    max
                                 
                                 {
                                 
                                    
                                       LB
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       LB
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       LB
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       LB
                                    
                                    
                                       4
                                    
                                 
                                 }
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       LB
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       LB
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          max
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                          
                                          /
                                          
                                             
                                                d
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       LB
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          max
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                          
                                          )
                                          /
                                          
                                             
                                                d
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       LB
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            ∈
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  max
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                          ⧹
                                          
                                             
                                                K
                                             
                                             
                                                max
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          K
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        Eq. (32) means that the lower bound LB is the maximum value of 
                           
                              
                                 
                                    LB
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    LB
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    LB
                                 
                                 
                                    3
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    LB
                                 
                                 
                                    4
                                 
                              
                           
                        . 
                           
                              
                                 
                                    LB
                                 
                                 
                                    1
                                 
                              
                           
                         is the weighted sum of the average working time and total period of days. 
                           
                              
                                 
                                    LB
                                 
                                 
                                    2
                                 
                              
                           
                         is the weighted sum of the maximum average working time and total period of days. 
                           
                              
                                 
                                    LB
                                 
                                 
                                    3
                                 
                              
                           
                         is the weighted sum of the maximum average working time when the minimum number of duties 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                                 
                                    min
                                 
                              
                           
                         for roster k is assigned. 
                           
                              
                                 
                                    LB
                                 
                                 
                                    4
                                 
                              
                           
                         is the weighted sum of the maximum average working time when the minimum number of duties is already assigned to the set of rosters 
                           
                              
                                 
                                    K
                                 
                                 
                                    max
                                 
                              
                           
                        .

The lower-level subproblem can be formulated as the problem to generate a feasible sequence of rosters with several workforce regulations on the condition that the assignment of duties and the total days are fixed. The problem is a feasibility problem without the objective function. In order to solve the subproblem effectively, we provide the following proposition.
                           Proposition 3
                           
                              
                                 
                                    (
                                    SP
                                    )
                                 
                               
                              can be decomposed into subproblems (
                              
                                 
                                    SP
                                    -
                                    k
                                 
                              
                              ) for each roster k.
                           

All constraints can be decomposed into each roster k and the objective function is constant for (SP). Therefore, the problem 
                                 
                                    (
                                    SP
                                    )
                                 
                               is a block structured problem and it can be decomposed into each roster k. Because of constraints (24), 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          d
                                       
                                    
                                    =
                                    0
                                 
                               for all 
                                 
                                    d
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    D
                                    7
                                 
                               if 
                                 
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                 
                               is equal to 0. Therefore, a duty i can be ignored in 
                                 
                                    (
                                    SP
                                    -
                                    k
                                    )
                                 
                               if 
                                 
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    =
                                    0
                                 
                              .□

Let 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                           
                         be the set of duties assigned to the roster k in the master problem and 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                                 
                                    M
                                 
                              
                           
                         be the set of night duties assigned to the roster k in the master problem. The formulation of each 
                           
                              (
                              SP
                              -
                              k
                              )
                           
                         is totally equal to 
                           
                              (
                              SP
                              )
                           
                        . For 
                           
                              (
                              SP
                              -
                              k
                              )
                           
                        , we replace I with 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    M
                                 
                              
                           
                         with 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                                 
                                    M
                                 
                              
                           
                         and 
                           
                              K
                              =
                              {
                              k
                              }
                           
                        .

If all of solutions obtained by solving 
                              
                                 (
                                 SP
                                 -
                                 k
                                 )
                              
                            are feasible, the set of solutions is feasible for 
                              
                                 (
                                 IP
                                 )
                              
                           . However, it is not always that the solution of 
                              
                                 (
                                 SP
                                 -
                                 k
                                 )
                              
                            is feasible. If the solution of 
                              
                                 (
                                 SP
                                 -
                                 k
                                 )
                              
                            is infeasible, the constraints related to the period of days are relaxed and a roster with less days can be generated. For the purpose, we formulate new subproblems 
                              
                                 (
                                 
                                    
                                       SP
                                    
                                    
                                       ′
                                    
                                 
                                 -
                                 k
                                 )
                              
                            in which the objective function is the total period of days for each roster k with the constraints that the period of days is greater than 
                              
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                              
                           .

Since the size of each subproblem is sufficiently small, each problem can be easily solved by a general-purpose solver.

At each iteration, a new solution is searched at the master problem until the duality gap between the upper bound and the lower bound exists within a tolerance. The cuts are used to exclude a set of previously searched solutions of 
                           
                              {
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    d
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    ‾
                                 
                              
                              }
                           
                         in order to expedite new solutions in the master problem. In this section, we propose effective cuts to reduce search space.

The integer cuts exclude the previously obtained feasible configuration of the generated solutions from the master problem. We set the solution of the master problem at iteration r as 
                              
                                 Δ
                                 (
                                 r
                                 )
                                 =
                                 {
                                 (
                                 i
                                 ,
                                 k
                                 )
                                 |
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 =
                                 1
                                 }
                              
                            and 
                              
                                 F
                                 (
                                 r
                                 )
                                 =
                                 {
                                 (
                                 k
                                 ,
                                 d
                                 )
                                 |
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 =
                                 1
                                 }
                              
                           . The following constraints are embedded into the master problem at iteration 
                              
                                 (
                                 r
                                 +
                                 1
                                 )
                              
                           .
                              
                                 (37)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             i
                                             ,
                                             k
                                             )
                                             ∈
                                             Δ
                                             (
                                             r
                                             )
                                          
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             k
                                             ,
                                             d
                                             )
                                             ∈
                                             F
                                             (
                                             r
                                             )
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          d
                                       
                                    
                                    ⩽
                                    |
                                    I
                                    |
                                    +
                                    |
                                    K
                                    |
                                    -
                                    1
                                    ,
                                    
                                    ∀
                                    r
                                 
                              
                           The left hand-side of (37) is equal or more than 
                              
                                 |
                                 I
                                 |
                                 +
                                 |
                                 K
                                 |
                                 -
                                 1
                              
                            if and only if the solution and the previously obtained solution at iteration r are equal.

The set of assignments to all rosters which includes an infeasible assignment to a roster is also infeasible. It is effective to exclude such infeasible solutions. If the subproblem for roster k is infeasible at iteration r, we set 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       rst
                                    
                                 
                                 (
                                 r
                                 )
                                 =
                                 {
                                 i
                                 
                                 |
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 =
                                 1
                                 }
                              
                           . The following cut (38) is used.
                              
                                 (38)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   Δ
                                                
                                                
                                                   rst
                                                
                                             
                                             (
                                             r
                                             )
                                          
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    ⩽
                                    |
                                    
                                       
                                          Δ
                                       
                                       
                                          rst
                                       
                                    
                                    (
                                    r
                                    )
                                    |
                                    -
                                    1
                                    ,
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    ∀
                                    r
                                 
                              
                           All the superset of rosters with a roster of the assignment of 
                              
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                              
                            are infeasible.

If a feasible roster with the total days 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ∗
                                    
                                 
                              
                            is generated by relaxing total period of days, a feasible roster with the same assignment requires at least 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ∗
                                    
                                 
                              
                            days. The solutions of the subproblems with less than 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ∗
                                    
                                 
                              
                            days are also infeasible. We use the following cut.
                              
                                 (39)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   Δ
                                                
                                                
                                                   ∗
                                                   rst
                                                
                                             
                                             (
                                             r
                                             )
                                          
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             d
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ∗
                                                   rst
                                                
                                             
                                             (
                                             r
                                             )
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          d
                                       
                                    
                                    ⩽
                                    |
                                    
                                       
                                          Δ
                                       
                                       
                                          ∗
                                          rst
                                       
                                    
                                    (
                                    r
                                    )
                                    |
                                    ,
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    ∀
                                    r
                                 
                              
                           where 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       ∗
                                       rst
                                    
                                 
                                 (
                                 r
                                 )
                                 =
                                 {
                                 i
                                 
                                 |
                                 
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 =
                                 1
                                 }
                              
                            and 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ∗
                                       rst
                                    
                                 
                                 (
                                 r
                                 )
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       ∗
                                    
                                 
                              
                            when the subproblem for roster k at iteration r is infeasible. All the roster with less than 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ∗
                                    
                                 
                              
                            days satisfies 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       d
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ∗
                                             rst
                                          
                                       
                                       (
                                       r
                                       )
                                       -
                                       1
                                       
                                          
                                             f
                                          
                                          
                                             k
                                             ,
                                             d
                                          
                                       
                                    
                                 
                                 =
                                 1
                              
                           . All the superset of rosters with a roster of the assignment of 
                              
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                              
                            with less than 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ∗
                                    
                                 
                              
                            days are infeasible by (39).

We prove the validity of cuts as follows.
                              Proposition 4
                              
                                 Cuts 
                                 (37)–(39) 
                                 or their combination never exclude the optimal solutions of 
                                 
                                    
                                       (
                                       IP
                                       )
                                    
                                 
                                 .
                              

Suppose that a cut (37) that is embedded into the master problem at iteration r excludes the optimal solution. Then 
                                    
                                       {
                                       Δ
                                       (
                                       r
                                       )
                                       ,
                                       F
                                       (
                                       r
                                       )
                                       }
                                    
                                  is the combination of the optimal solution of 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                             ,
                                             d
                                          
                                       
                                    
                                 . In this case, the solution of the subproblems at iteration r is feasible and the algorithm is finished with zero duality gap. It contradicts to the addition of the cut (37) to the master problem without completion of the algorithm in the assumption. Suppose that a cut (38) excludes the optimal solutions. Since the solutions which are excluded by (38) are infeasible, it contradicts to the assumption. It can be proved that cuts (39) never exclude an optimal solution in the same way.□

The integer cut excludes only a single solution from the master problem. On the other hand, the infeasible assignment cut and the infeasible day cut can exclude many non-promising solutions in the master problem. These cuts can effectively reduce the feasible search space.

To improve the upper bound derived by solving the subproblems, a local search is executed to improve the upper bound. The local search is started from the solution when the rosters are obtained by solving the subproblems at each iteration. A schedule of a day is selected from the rosters and inserted to another day. It is repeated until the upper bound is not updated.

The overall algorithm of the proposed method is as follows.
                           
                              
                                 Step 1
                              
                              Initialization.

Solve the master problem.
                                    
                                       
                                          Step 2–1 Generate an initial node 
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                           and 
                                             
                                                A
                                                ≔
                                                {
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      0
                                                   
                                                
                                                }
                                             
                                          .


                                          Step 2–2 If 
                                             
                                                A
                                                =
                                                ∅
                                             
                                          , then 
                                             
                                                
                                                   
                                                      LB
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                ≔
                                                
                                                   
                                                      LB
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                +
                                                1
                                             
                                           and go to Step 2–1. Otherwise go to Step 2–3.


                                          Step 2–3 Choose 
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                A
                                             
                                           according to node priority.


                                          Step 2–4 If 
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                           is a solution of the master problem (depth is 
                                             
                                                |
                                                K
                                                |
                                                +
                                                |
                                                I
                                                |
                                             
                                          ), go to Step 2–7.


                                          Step 2–5 Compute a lower bound for 
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          . If the lower bound is less than 
                                             
                                                
                                                   
                                                      LB
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                ,
                                                A
                                                ≔
                                                A
                                                -
                                                {
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                   
                                                
                                                }
                                             
                                          .


                                          Step 2–6 The new branched nodes 
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                      2
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      jq
                                                   
                                                
                                             
                                           that satisfy all constraints are generated from a node 
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          . 
                                             
                                                A
                                                ≔
                                                A
                                                ∪
                                                {
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                      2
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      jq
                                                   
                                                
                                                }
                                                -
                                                {
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                   
                                                
                                                }
                                             
                                          .


                                          Step 2–7 If the derived upper bound for master problem is equal to 
                                             
                                                
                                                   
                                                      LB
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          , the algorithm of solving master problem is finished and go to Step 3. Otherwise go to Step 2–2.

Solve the subproblems with a fixed assignment of duties and the total days of rosters.

The local search is executed from the solution of a feasible solution.

Evaluate convergence. If the lower bound is equal to the upper bound or both of them are not updated pre-determined number of times, the algorithm is finished.

Cut generation. Then return to Step 2.

The optimality of the decomposition algorithm can be ensured by the following proposition.
                           Proposition 5
                           
                              The decomposition algorithm finds an optimal solution in finite number of iterations.
                           

From the Proposition 4, cuts (37)–(39) never exclude optimal solutions. Cuts (37) are always embedded into the master problem at each iteration and reduce one solution. Since the solution space is finite, the algorithm can find the optimal solution in finite number of iterations.□

The lower bound for the proposed method explained in the previous section is weak because all constraints related to the connection between duties are not considered in the master problem. In the lower-level subproblems, several empty days should be inserted in most cases due to the constraints of the connections between duties in the subproblems. The difference of the period of days causes a large duality gap between the solutions of the master problem and the lower-level subproblems. In order to improve the quality of the lower bound, we consider the connection between two duties partly. The binary variable 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         that takes 1 if the next day of duty i is 
                           
                              j
                              ∈
                              J
                           
                         and 0 otherwise (J is a set of duties, rest day or empty day), is introduced to the master problem. If the connection between i and j is infeasible for ((ii))–((v)), a constraint that 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              0
                           
                         is added to the master problem. We also introduce 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           
                        , which is the period of days of duty i in the roster k and the following constraints.
                           
                              (40)
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       0
                                    
                                 
                                 +
                                 3
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 ⩽
                                 2
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 +
                                 1
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                        
                        
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ,
                                    0
                                 
                              
                           
                         takes a value of 1 if the next day of the duty i is an empty day and zero otherwise. 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           
                         takes a value of 1 if duty i is assigned to roster k and it takes a value of 2 if the next day of duty i is an empty day. It indicates the days after duty i to the next duty for roster k. The constraints (29) are replaced by constraints (41).
                           
                              (41)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                 
                                 d
                                 
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 ⩾
                                 
                                    
                                       7
                                    
                                    
                                       7
                                       -
                                       D
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                        The constraints (41) enforce that it takes two days to perform a duty if the next day is an empty day. The period of days of each roster derived by solving (MP) is improved by (41) taking into account the connection between duty i and the next day. The number of variables that is necessary to improve the lower bound is 
                           
                              |
                              I
                              
                                 
                                    |
                                 
                                 
                                    2
                                 
                              
                              +
                              |
                              I
                              |
                              |
                              K
                              |
                           
                        .

The objective cut (42) is included in the master problem 
                           
                              (
                              MP
                              )
                           
                         in order to reduce the computation time of the master problem.
                           
                              (42)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 α
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                 
                                 d
                                 
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 ⩾
                                 
                                    
                                       LB
                                    
                                    
                                       ∗
                                       ∗
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                    ∗
                                 
                              
                           
                         is obtained by solving the master problem with single objective of the number of total days only. Let 
                           
                              
                                 
                                    α
                                 
                                 
                                    ∗
                                 
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    k
                                    ,
                                    d
                                 
                                 
                                    ∗
                                 
                              
                           
                         be an optimal solution of 
                           
                              (
                              IP
                              )
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    k
                                    ,
                                    d
                                 
                                 
                                    ∗
                                    ∗
                                 
                              
                           
                         is the optimal solution of master problem with single objective function. 
                           
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                    ∗
                                 
                              
                           
                         is the lower bound of (IP) because
                           
                              (43)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       ∗
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                 
                                 
                                    
                                       df
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                 
                                 ⩾
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                 
                                 
                                    
                                       df
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                    
                                       ∗
                                    
                                 
                                 ⩾
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                          7
                                       
                                    
                                 
                                 
                                    
                                       df
                                    
                                    
                                       k
                                       ,
                                       d
                                    
                                    
                                       ∗
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       LB
                                    
                                    
                                       ∗
                                       ∗
                                    
                                 
                                 .
                              
                           
                        
                        
                           
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                    ∗
                                 
                              
                           
                         can be obtained easily because the equalization of the average working time is not considered. The master problem with objective cuts (42) can be solved by the best-bound search algorithm.

Computational experiments are executed to investigate the performance of the proposed method for a variety of problem instances.

Eight cases of randomly generated problem instances with different problem size (Case 1–8) were created according to the reference Nishi et al. (2011a). The program is coded by C language with Visual C++ 2010 Express environment. An Intel (R) Core (TM) i7 870 CPU 2.93gigahertz was used for computations. The weighting factor 
                           
                              
                                 
                                    μ
                                 
                                 
                                    1
                                 
                              
                              =
                              1
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    2
                                 
                              
                              =
                              280
                           
                         throughout the experiments because the cost of a day for a roster corresponds to the cost of 10minute of average working time. The parameters 
                           
                              D
                              1
                              =
                              1
                              ,
                              D
                              7
                              =
                              28
                              ,
                              H
                              3
                              =
                              2400
                              ,
                              H
                              4
                              =
                              1080
                              ,
                              H
                              5
                              =
                              510
                           
                         were used. The termination condition is that the difference of the upper bound and the lower bound is not updated 50 times or the total computation time is greater than 3600seconds because the computation time over 3600seconds is impractical from the practitioners comments. We compare the computational results of the proposed method with or without cuts in order to confirm the effectiveness of the proposed cuts. NO-CUT is the proposed method when the master problem and the lower-level subproblem are solved once without cuts. INT-CUT is the proposed method with integer cut only. ALL-CUT is the proposed method with all cuts. Table 1
                         shows the computational results. LB, UB, and time are the lower bound, the upper bound and the total computation time, respectively. The upper bound of INT-CUT is better than that of NO-CUT in all cases when the cut patterns NO-CUT and INT-CUT are compared. The upper bound of ALL-CUTS is better than that of INT-CUT in case 5–8. The results indicate that the integer cut is effective to reduce the upper bound. It is also effective to use the cut for infeasible assignment and the cut for infeasible day. The improvement percentage of ALL-CUTS with respect to NO-CUT is average 0.73% and maximum 1.52% that can improve the performance. The total computation time for ALL-CUTS is increased because the number of iterations is increased. There is a tradeoff between the computation time and the performance of the solution.

The proposed method with the lower bound improvement and without lower bound improvement in Table 1 were compared. The computational results for the proposed method with the improvement of lower bound are summarized in Table 2
                        . In this table, a case is represented by the number of duties and rosters. itr. is the number of iterations and time is the total computation time. From the results of Table 2, the value of lower bound for the proposed method with improvement is significantly increased. The average improvement of LB is 6.08% and the maximum is 8.12%. The improvement is only the lower bound. The optimal solutions are derived for case 1 and case 2 for the proposed method with the improved lower bound. The average duality gap is 0.97%. Since the number of binary variables is increased to improve the lower bound, the computation time is significantly increased. However, the computation time is reduced in average 41% by the improvement of the lower bound. This is due to the effect of incorporating objective cut can significantly reduce the number of nodes in the search tree of the master problem. The proposed method with the improvement of the lower bound can find near-optimal solutions for all cases.

The comparison of the proposed method with a general-purpose integer programming solver and constraint programming solver (CP) was executed. Since the lower bound is not obtained for CP, we compare the upper bound of the proposed method with that of the conventional method. CPLEX 12.1 (IBM ILOG) is used to solve the problem (IP) and CP Optimizer (IBM ILOG) for CP. Table 3
                            shows the comparison of the performance of the proposed method, those of CPLEX and CP. 
                              
                                 UB
                                 1
                              
                            is the upper bound by the proposed method without local search. 
                              
                                 UB
                                 2
                              
                            is the upper bound by the proposed method with local search. The maximum time limit of 3600 seconds was fixed. The values in () indicate the time when the last upper bound is obtained. The local search is effective to reduce the upper bound since 
                              
                                 UB
                                 1
                              
                            is better than 
                              
                                 UB
                                 2
                              
                           . The CPLEX solver fails to provide the optimal solution for case 6 and 8 within 3600second of computation time. The results of the upper bound 
                              
                                 UB
                                 2
                              
                            for the proposed method are slightly worse than that of CPLEX for case 3–5. However, the upper bound 
                              
                                 UB
                                 2
                              
                            by the proposed method is better than those by CPLEX for large-scale instances of case 6–8. Also, the upper bounds 
                              
                                 UB
                                 1
                              
                            and 
                              
                                 UB
                                 2
                              
                            for the proposed method are better than that of CP for almost all cases with less computation time. The proposed method is effective for solving large scale problems with more than 30 duties.

The proposed method was applied to the practical instances which are provided by the Japanese railway company. The data contains 121 duties and they are divided into two cases: 40 duties – 3 rosters and 81 duties – 6 rosters. Two types of the proposed methods: the proposed method without lower bound improvement (PM1) and the proposed method with lower bound improvement (PM2) were applied. The computational results are shown in Table 4
                        . The values in ( ) indicate the time when the last upper bound is obtained. For the small scale instance of 40–3, the proposed method with and without improvement can obtain solutions of the same quality as those of CPLEX and CP within less computation time. For the large scale instance of 81–6, however, CPLEX cannot find a feasible solution. The upper bound of the proposed method with improvement is slightly worse than the proposed method without improvement, the lower bound for the proposed method with improvement finds better solution with less computation time. The duality gap for PM2 is 1.6% for large scale instance with 81 duties and 6 rosters. The benefit of using the lower bound improvement is to reduce the duality gap. The results of each objective value are shown in the columns of 
                           
                              α
                           
                         and d in Table 4. The value of d for the proposed method is 9.2% better than that of CP. Even the value of 
                           
                              α
                           
                         is larger than that of CP, the maximum difference of average working time for the proposed method is reduced from 127minute to 31minute. The performance is satisfactory to practitioners for fair working condition with less cost.

@&#CONCLUSIONS@&#

In this article, we proposed a two-level decomposition approach to solve the railway crew rostering problem with the objective of fair working condition. In the proposed approach, the original problem is decomposed into the upper-level master problem and the lower-level subproblem. Effective cuts were proposed to reduce the feasible search space to tighten the duality gap. Computational results demonstrated the advantage of the proposed method. In future works, more effective cuts should be developed. We will further apply the proposed approach to shift scheduling problems.

@&#ACKNOWLEDGEMENTS@&#

We thank Dr. Satoru Takahashi and Dr. Kenji Ueda with Advanced Technology R&D Center, Mitsubishi Electric Corporation for helpful suggestion and providing real data.

@&#REFERENCES@&#

