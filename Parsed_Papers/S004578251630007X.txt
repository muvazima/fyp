@&#MAIN-TITLE@&#Topology optimization for turbulent flow with Spalart–Allmaras model

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We solve the stress-based topology optimization considering turbulent flow.


                        
                        
                           
                           The Spalart–Allmaras model which is one of RANS models is employed.


                        
                        
                           
                           Some novel modifications of the original S–A model are proposed.


                        
                        
                           
                           The effect of the eddy viscosity plays an important role in optimization.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Topology optimization

Turbulent flow

Spalart–Allmaras

One-equation turbulent model

@&#ABSTRACT@&#


               
               
                  In this research, a new finite element (FE) based topology optimization (TO) for turbulent flow was developed using the Spalart–Allmaras (S–A) equation, which is one of the Reynolds-Averaged Navier–Stokes (RANS) equations. Despite many innovative works on the subject of fluidic TO, it is rare to consider the influence of turbulent flow in TO. To consider the effect of complex turbulent fluid motion, this research considered the S–A model developed mainly for aerodynamic flows. For a successful TO, one primary issue is modification of the S–A turbulent model to account for topological evolution during the optimization process. To address this issue, we proposed the addition of penalization terms to the original governing equations. To show the validity of the present approach and the effect of turbulent flow on optimal layouts, some two dimensional benchmark designs studied for laminar flow were reconsidered. By considering the effect of turbulent flow, the eddy viscosity values were increased at some local regions due to the Boussinesq hypothesis, and naturally optimal layouts affected by the spatially varying viscosity were obtained in turbulent flow. It was also found that the balance between the inertia force and the viscosity force plays an important role in topological designs.
               
            

@&#INTRODUCTION@&#

The goal of this research was to develop a new FE-based topology optimization (TO) for turbulent flow using the Spalart–Allmaras (S–A) model, which is one of the RANS models. Simulation and optimization with computational fluid dynamics (CFD) are important subjects with a very wide range of scientific and engineering applications (see [1–5] and the references therein). Due to the development of commercial and open source CFD packages such as Fluent, STAR-CD, and OpenFoam, obtaining numerical simulations of complex fluid motions has become easier than at any other time  [6,7]. Many theoretical and experimental works have been conducted to solve several challenging engineering problems based on these previous developments. Nevertheless, it is rare to conduct TO for turbulent flow. To contribute to this research field, we employ the S–A model, which is a one-equation turbulent model, and present several modifications of the standard S–A model suitable for structural TO for turbulent flow  [3,4,8,9]. Unlike the previous researches, the finite element based analysis is employed and the involved equations are modified in order to consider material distributions.

The computational simulation of turbulent flow is a very perplexing topic. From the research by Ruelle and Takens in 1971, it was illustrated that the Navier–Stokes (NS) equations are capable of producing solutions which are chaotic and sensitive to initial boundary conditions  [10]. Furthermore, their research also indicates the sequence of transitions (bifurcations) that a flow will experience as Reynolds number is increased, i.e., as the system approaches a chaotic state as shown in Fig. 1
                     . Depending primarily on the magnitude of the Reynolds number, the sequence of transitions (bifurcations) in flow are: laminar attached steady flow, laminar separated steady flow, laminar separated periodic flow, laminar separation/turbulent wake periodic flow, and chaotic turbulent separation  [11,12] (see any book on fluid mechanics and fluid machinery). The physical characteristics of these flows with different Reynolds numbers are literally distinct from each other, and one computational approach successfully applicable to one type flow may not be pertinent to other types of flows  [11]. Therefore, the simulation of a fluid with one numerical method should be very carefully performed with the core knowledge of the hypothesis, the restriction, and the application scope of the numerical method to obtain physically acceptable and reasonable computational results. Not considering the computational burden, it is possible to solve the direct Navier–Stokes (DNS) equation for turbulent fluid flow, but it takes a lot of time and it is not reasonable from an engineering point of view (see  [13] and references therein). Due to the computational burden for the simulation of turbulent flow, many researchers have considered time averages and the time variations of velocities and pressure. For example, there are one-equation turbulent models, two-equation turbulent models, and three-equation turbulent models  [7,11,14]. Therefore, the simulation of turbulent flow is a complex and difficult topic.

In addition, based on the developed computational approaches, size and shape optimization of laminar and turbulent flows have been studied. (See  [15–29] and the references therein.) As many numerical methods for turbulent flows have been used for various objective and constraint functions, it is not a simple task to categorize the developed optimization studies  [15–17,23,24]. From a shape optimization point of view, the aerodynamic performance and the heat transfer efficiency have mainly been considered until now  [26,30–33]. In  [17], the continuous adjoint method was developed to compute shape sensitivities for aerodynamic design with the turbulent flow model. They also employed the S–A turbulent model. From a topological optimization point of view, mainly laminar flows have been considered and there has been pioneering research about turbulent flow by using the OpenFoam CFD package  [15]. In [15,25,27], the continuous adjoint approach was developed for S–A turbulent flow model. In  [16], the topology optimization of unsteady incompressible Navier–Stokes flow is developed based on the continuous adjoint method and the finite element method. In  [18], the porosity model for topology optimization for laminar fluid model was developed. This research also applies this porosity model and presents some new penalization functions to the transport equation and the Eikonal equation to represent solid and fluid domains. For topology optimization considering incompressible media, there are some researches using the mixed finite elements in  [19,34,35]. This approach only can consider the effect of steady incompressible media in topology optimization. In  [20], with a simple kinetic model approximating the Navier–Stokes system, the topology optimization problem is solved. In  [21], the level set method for topology optimization was proposed. In  [29], an extension to unsteady flow problems at low Reynolds numbers is presented. In  [36], the lattice Boltzmann method (LBM) is applied for transient flow. The present study employs the finite element based approach for the solution of the S–A turbulent model, proposes some modifications of the original S–A model to allow spatial varying topologies, and shows the effects of turbulent flows in topology optimization.

In this research, we developed a new TO method for turbulent flow with the S–A model (one-equation turbulent model)  [15–24]. First, the Reynolds stresses are defined in terms of averaged quantities with the Boussinesq hypothesis resulting in the use of the eddy viscosity concept. Based on the hypothesis of the isotropic eddy viscosity concept, various theoretical models such as one-equation models, two-equation models, three-equation models, and four-equation models have been developed with specific application purposes. In the present research, one of the one-equation models called the S–A model is employed. This S–A model has been mainly developed for turbulent simulations for aerodynamic and turbo machinery  [1–14,37]. It consists of the NS equation with the eddy viscosity (the turbulent viscosity), the equation for the eddy viscosity, and the wall functions  [1–14,37]. With this one equation turbulent model, we can develop a topological optimization process.

For a successful TO method, some necessary conditions of fluid velocities, pressure and some parameters for solid and fluid domains should be derived, and these conditions should be imposed for solid and fluid domains. Obviously for solid domains, fluid velocities should be set to zero. In addition, the wall equation and the transport equation for the eddy viscosity should be modified for TO. To our knowledge, this aspect has not been rigorously considered yet before this research. To satisfy these conditions, we added some modifications to the original S–A turbulent model and interpolated the involved material properties with respect to the spatially varying design variables. Through this, optimal topologies can be designed for turbulent flows.

This paper is organized as follows: Section  2 describes the basic equations for turbulent flow and the Spalart–Allmaras model. Section  3.1 describes our development of the present S–A turbulent model. In Section  3.2, we present several optimization examples to show the advantages and disadvantages of the present procedure in TO. In Section  4, we present our conclusions and suggest directions for future research topics.

As turbulent flow contains small scale flows as well as large scale flows, as shown in Fig. 2
                        , it is challenging to simulate the behavior of turbulent flows. The large scale motions of turbulent flow are dominated by the object shape and dimensions, and the small scale motions of turbulent flow are dominated by the movements and evolutions of small eddies. Due to the unsteady periodic motion, fluid properties exhibit random spatial variations, a strong dependence on initial conditions and a wide range of scales (eddies). As it is difficult to apply a computational method to simulate these multiscale phenomena, many theories and numerical approaches have been proposed  [1–14,37,38].

One of the promising and widely adopted engineering methods may be the Reynolds-Averaged Navier–Stokes equations (RANS equations) proposed by Osborne Reynolds  [3,6,10,12,14], i.e., the time-averaged equations of motion for fluid flow. In the RANS equation, it is assumed that an instantaneous quantity, e.g., velocity or pressure, can be decomposed into its time-averaged and fluctuating quantities. This assumption can be used with a rough calculation based on knowledge of the properties of flow turbulence to give time-averaged solutions to stochastic turbulent flows. For example, the fluid velocity in the 
                           i
                        th direction, 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              ,
                              t
                              )
                           
                        , can be regarded as a function of the spatial coordinates, 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                        , and the time, 
                           t
                        . In the RANS assumption, the velocity is decomposed into the time-averaged term, 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           
                              (
                              x
                              )
                           
                        , and the fluctuating term, 
                           
                              
                                 u
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                           
                              (
                              x
                              ,
                              t
                              )
                           
                        , as follows: 
                           
                              
                                 (1)
                                 
                                    Fluid velocity in the  
                                    i
                                    th direction:  
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   ,
                                                   z
                                                   )
                                                
                                             
                                             ︸
                                          
                                       
                                       
                                          
                                             Time
                                          
                                          -
                                          
                                             averaged term
                                          
                                       
                                    
                                    +
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   ,
                                                   z
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                             ︸
                                          
                                       
                                       
                                          
                                             Fluctuating term
                                          
                                       
                                    
                                 
                              
                              
                                 (2)
                                 
                                    Fluid pressure:  
                                    
                                       
                                          p
                                       
                                       
                                          t
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                p
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   ,
                                                   z
                                                   )
                                                
                                             
                                             ︸
                                          
                                       
                                       
                                          
                                             Time
                                          
                                          -
                                          
                                             averaged term
                                          
                                       
                                    
                                    +
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   ,
                                                   z
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                             ︸
                                          
                                       
                                       
                                          
                                             Fluctuating term
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

For an arbitrary time span, 
                           T
                        , the integration of the fluctuating quantity can be assumed to be zero and the time-averaged term is obtained from Eq. (3). The RANS equation focuses on these averaged terms in the NS equation 
                           
                              (3)
                              
                                 Reynolds-averaged quantities:  
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 =
                                 
                                    
                                       lim
                                    
                                    
                                       T
                                       →
                                       ∞
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    ,
                                    t
                                    )
                                 
                                 d
                                 t
                                 .
                              
                           
                         By inserting the above relationship between the time averaged term and the fluctuating term to the NS equation, we can define the following equation and the Reynolds stress 
                           
                              
                                 (4)
                                 
                                    ρ
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          ∂
                                          p
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ∂
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       (
                                       μ
                                       
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    ρ
                                    
                                       
                                          ∂
                                          
                                             (
                                             −
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                ¯
                                             
                                             )
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    0
                                 
                              
                              
                                 (5)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    −
                                    ρ
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       ¯
                                    
                                 
                              
                           
                         where the Reynolds stress is defined by 
                           
                              
                                 R
                              
                              
                                 i
                                 j
                              
                           
                         and the fluid density is denoted by 
                           ρ
                        . For the additional unknown fluctuating term, the Boussinesq hypothesis, i.e., the simple relationship between Reynolds stresses and velocity gradients through the scalar and isotropic eddy viscosity, 
                           
                              
                                 μ
                              
                              
                                 
                                    T
                                 
                              
                           
                        ,—is adopted: 
                           
                              (6)
                              
                                 Boussinesq hypothesis:  
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 −
                                 ρ
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    ¯
                                 
                                 =
                                 2
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         The final NS equation after the above procedures can be stated as follows: 
                           
                              (7)
                              
                                 ρ
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       ∂
                                       p
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       ∂
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       (
                                       μ
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                         The tensor form is given as follows: 
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                                
                                                   (
                                                   
                                                      u
                                                   
                                                   ⋅
                                                   ∇
                                                   )
                                                
                                                
                                                   u
                                                
                                             
                                             ︷
                                          
                                       
                                       
                                          
                                             Convective
                                          
                                          
                                          
                                             acceleration
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∇
                                                ⋅
                                                
                                                   [
                                                   −
                                                   p
                                                   
                                                      I
                                                   
                                                   +
                                                   
                                                      (
                                                      μ
                                                      +
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      ∇
                                                      
                                                         u
                                                      
                                                      +
                                                      ∇
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                         
                                                         
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                             
                                             ︸
                                          
                                       
                                       
                                          
                                             Divergence
                                          
                                          
                                          
                                             of
                                          
                                          
                                          
                                             stress
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    ∇
                                    ⋅
                                    
                                       u
                                    
                                    =
                                    0
                                    .
                                 
                              
                           
                        
                     

From a fluid analysis point of view, one of the remaining issues in Eq. (8) is to calculate the constant and isotropic eddy viscosity which reflects turbulent energy dissipations. Depending on the physical interpretation of the eddy viscosity models for particular scientific and engineering applications, various approaches have been developed, and they can be classified in terms of the number of the transport equations solved in addition to the RANS equations, i.e., the zero-equation or algebraic model, one-equation models, two equation models, three equation models, and four equation models  [7,11,14,38]. For the zero-equation model, there are the Prandtl’s mixing length, the Smagorinsky model for the sub-grid scale eddy, the Cebeci–Smith model, and the Baldwin–Lomax model. Let us consider Prandtl’s mixing length model, which varies the eddy viscosity with distance from the wall with the concept of a ‘mixing length’ as follows: 
                           
                              (9)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 =
                                 
                                    |
                                    
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   stream
                                                
                                                
                                                
                                                   velocity
                                                
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                y
                                             
                                             
                                                
                                                   normal
                                                
                                                
                                                
                                                   direction
                                                
                                             
                                          
                                       
                                    
                                    |
                                 
                                 
                                    
                                       l
                                    
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    (
                                    
                                       
                                          l
                                       
                                       
                                          m
                                       
                                    
                                    :
                                      the mixing length
                                    )
                                 
                              
                           
                         where the partial derivative of the streamwise velocity with respect to the wall normal direction and the mixing length are denoted by 
                           
                              
                                 ∂
                                 
                                    
                                       u
                                    
                                    
                                       
                                          stream
                                       
                                       
                                       
                                          velocity
                                       
                                    
                                 
                              
                              
                                 ∂
                                 
                                    
                                       y
                                    
                                    
                                       
                                          normal
                                       
                                       
                                       
                                          direction
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 l
                              
                              
                                 m
                              
                           
                        , respectively. This simplest model becomes the basis for the law of the wall. For the one-equation model, there are Woflstein, Baldwin–Barth, Spalart–Allmaras (S–A), and 
                           k
                        -models, among others. For the two equation models, standard or RNG 
                           k
                        -
                           ε
                        , 
                           k
                        -
                           ω
                        , 
                           k
                        -
                           τ
                        , and 
                           k
                        -L models have been developed. A three equation model, the 
                           k
                        -
                           ε
                        -A model, has been developed, as has a four equation model, the 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 2
                              
                           
                        -f model. The mixing length models are easy to implement and fast calculations are possible. Through experimental correlations for the mixing length, good predictions are also possible. However these models are completely incapable of considering flows where the turbulent length scale varies. The S–A model solving only one equation for the eddy viscosity is economic as described and appropriate for intermediate complex boundary layer type of flows. This model however lacks submodels such as combustion or buoyancy. The standard 
                           k
                        -
                           ε
                         is robust and economical reasonably accurate and good for long accumulated performance data. For flow simulations with severe pressure gradients, streamline curvature or swirl and rotation, this model provides mediocre results. To overcome this limitation, RNG 
                           k
                        -
                           ε
                         or Realizable 
                           k
                        -
                           ε
                         was presented but these models have the limitation of isotropic eddy viscosity assumption. The other models have been proposed to overcome some limitations of these models. In conclusion, the numerical implementation of turbulence models involves many theoretical and algorithmic components, all of which may have a decisive influence on the quality of turbulent simulation results  [7,11,14]. Considering the effectiveness and the availability of the turbulent models based on the previous research in  [15,17,27], the present approach uses the S–A model, a one-equation model.

For a successful TO procedure, we should consider the suitability of a turbulent model for TO and its computational burden and time as some successive analyses are inevitably involved during a TO process. The suitability indicates how easy it is to modify a turbulent model with respect to the spatial varying design variables, i.e., SIMP or homogenization method for TO.

As stated before, we choose the S–A model, which is designed for aerodynamic and turbo-machinery applications  [3–5,9,11]. As this model introduces just one more equation to the S–A equation, it is a computationally inexpensive model compared with other turbulent models. Furthermore, it is known that it allows the use of coarser meshes  [11]. Further, it has shown reasonable predictions for boundary layers subject to adverse pressure gradients; it has also recently gained popularity for turbo-machinery applications, but with some limitations in terms of its applicability to all types of complex turbulent flows. From a TO point of view, this turbulent model was adopted for research in the framework of OpenFoam  [15,17,27]. In the pioneering work, the adjoint sensitivity analysis for structural optimization was introduced. In this present study, we introduce the penalization terms of the spatial design variables to the equations consisting of the S–A model solved by the finite element procedure. And the effect of the eddy viscosity on topological layout will be researched.

Adopting the Boussinesq hypothesis, the following transportation equation is introduced in the S–A model: 
                           
                              (10)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 ≡
                                 ρ
                                 
                                    
                                       f
                                    
                                    
                                       v
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             ν
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       
                                          t
                                       
                                    
                                 
                              
                           
                         where the auxiliary variable to the modified eddy viscosity is 
                           
                              
                                 
                                    
                                       ν
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 
                                    t
                                 
                              
                           
                         and this variable is calculated by solving the following nonlinear transportation equation with the involved auxiliary parameters and conditions 
                           
                              
                                 (11)
                                 
                                    
                                       (
                                       
                                          u
                                       
                                       ⋅
                                       ∇
                                       )
                                    
                                    
                                       
                                          
                                             
                                                ν
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      b
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ν
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             ︸
                                          
                                       
                                       
                                          
                                             Production
                                          
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ω
                                                      1
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ω
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           ν
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     ω
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             ︸
                                          
                                       
                                       
                                          
                                             Destruction
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  ̄
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ∇
                                                ⋅
                                                
                                                   (
                                                   
                                                      (
                                                      ν
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  ν
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ∇
                                                   
                                                      
                                                         
                                                            
                                                               ν
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            b
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  ̄
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ∇
                                                
                                                   
                                                      
                                                         
                                                            ν
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                
                                                ⋅
                                                ∇
                                                
                                                   
                                                      
                                                         
                                                            ν
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             ︸
                                          
                                       
                                       
                                          
                                             Diffusion
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          C
                                       
                                       
                                          b
                                          1
                                       
                                    
                                    =
                                    0.1355
                                    ,
                                    
                                    
                                       
                                          C
                                       
                                       
                                          b
                                          2
                                       
                                    
                                    =
                                    0.6220
                                 
                              
                              
                                 (12)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          v
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                v
                                                1
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    
                                    with  
                                    χ
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          ν
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          f
                                       
                                       
                                          v
                                          2
                                       
                                    
                                    =
                                    1
                                    −
                                    
                                       
                                          χ
                                       
                                       
                                          1
                                          +
                                          χ
                                          
                                             
                                                f
                                             
                                             
                                                v
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (13)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ω
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                b
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                C
                                             
                                             
                                                b
                                                1
                                             
                                          
                                       
                                       
                                          σ
                                       
                                    
                                    ,
                                    
                                    σ
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                    κ
                                    =
                                    0.41
                                    ,
                                    
                                    
                                       
                                          C
                                       
                                       
                                          ω
                                          2
                                       
                                    
                                    =
                                    0.3
                                    ,
                                    
                                    
                                       
                                          C
                                       
                                       
                                          ω
                                          3
                                       
                                    
                                    =
                                    2
                                    ,
                                    
                                    
                                       
                                          C
                                       
                                       
                                          v
                                          1
                                       
                                    
                                    =
                                    7.1
                                 
                              
                              
                                 (14)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ̃
                                       
                                    
                                    =
                                    S
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          v
                                          2
                                       
                                    
                                    ,
                                    
                                    S
                                    =
                                    
                                       
                                          2
                                          
                                             Ω
                                          
                                          :
                                          
                                             Ω
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       Ω
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       ∇
                                       
                                          u
                                       
                                       −
                                       ∇
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (15)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ω
                                       
                                    
                                    =
                                    g
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   1
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ω
                                                         3
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ω
                                                         3
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          1
                                          /
                                          6
                                       
                                    
                                    ,
                                    
                                    g
                                    =
                                    r
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          ω
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             r
                                          
                                          
                                             6
                                          
                                       
                                       −
                                       r
                                       )
                                    
                                    ,
                                    
                                    r
                                    =
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ̃
                                             
                                          
                                          
                                             
                                                κ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                ω
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          l
                                       
                                       
                                          ω
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          G
                                       
                                    
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          G
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                r
                                                e
                                                f
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                         It is worth noticing that the distance of a spatial point inside an analysis domain to the closest wall defining the analysis domain, 
                           
                              
                                 l
                              
                              
                                 ω
                              
                           
                        , is computed through Eq. (15), where the reciprocal distance value with the offset distance to the nearest solid wall is denoted by 
                           G
                        . This distance value to the closest wall is required for most turbulent models in order to approximate the mixing length and regulate computational procedures. To calculate the distance value, many numerical approaches have been developed and one popular numerical approach is to compute wall distance by solving the so called Eikonal equation: 
                           
                              (16)
                              
                                 Original
                                 
                                 
                                    Eikonal
                                 
                                 
                                 equation:  
                                 
                                    |
                                    ∇
                                    D
                                    |
                                 
                                 =
                                 F
                                   subject to  
                                 D
                                 =
                                 0
                                   at boundary
                              
                           
                         where 
                           F
                         is a time cost function with positive values, and 
                           D
                         is the exact distance to the closest wall. Physically, the solution of the Eikonal equation becomes the shortest length needed to travel from the boundary to a specific point. In the special case of 
                           F
                           =
                           1
                        , the solution becomes the signed distance from the boundary. From a computational point of view, the solution procedure of the above Eikonal equation involves very compound and sophisticated mathematical theories. Using one of these theories, the modified equation is obtained with the reciprocal of the distance values as follows: 
                           
                              (17)
                              
                                 
                                    
                                       
                                          |
                                          ∇
                                          G
                                          |
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       4
                                    
                                 
                                 
                                 with  
                                 D
                                 =
                                 1
                                 /
                                 G
                                 
                                 and
                                 
                                 
                                    
                                       
                                          |
                                          ∇
                                          G
                                          |
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 ∇
                                 
                                    (
                                    G
                                    ⋅
                                    ∇
                                    G
                                    )
                                 
                                 −
                                 G
                                 ⋅
                                 
                                    (
                                    
                                       
                                          ∇
                                       
                                       
                                          2
                                       
                                    
                                    G
                                    )
                                 
                                 .
                              
                           
                        
                     

In addition, an elliptic diffusion term, 
                           
                              
                                 σ
                              
                              
                                 w
                              
                           
                           G
                           
                              (
                              ∇
                              ⋅
                              ∇
                              G
                              )
                           
                        , is added where 
                           
                              
                                 σ
                              
                              
                                 w
                              
                           
                         is a positive value 
                           
                              (18)
                              
                                 
                                    
                                       
                                          |
                                          ∇
                                          G
                                          |
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       w
                                    
                                 
                                 G
                                 
                                    (
                                    ∇
                                    ⋅
                                    ∇
                                    G
                                    )
                                 
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       4
                                    
                                 
                                 .
                              
                           
                         Because of the introduction of the diffusion term, the inverse linear behavior of the distance function is not satisfied in (18). Therefore, we multiply the right term by a factor of 
                           
                              (
                              1
                              +
                              2
                              
                                 
                                    σ
                                 
                                 
                                    w
                                 
                              
                              )
                           
                        . 
                           
                              (19)
                              
                                 Relaxed wall equation:  
                                 ∇
                                 G
                                 ⋅
                                 ∇
                                 G
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       w
                                    
                                 
                                 G
                                 
                                    (
                                    ∇
                                    ⋅
                                    ∇
                                    G
                                    )
                                 
                                 =
                                 
                                    (
                                    1
                                    +
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          w
                                       
                                    
                                    )
                                 
                                 
                                    
                                       G
                                    
                                    
                                       4
                                    
                                 
                              
                           
                         where a smaller value less than 0.5 is set to 
                           
                              
                                 σ
                              
                              
                                 w
                              
                           
                        . In the present research, this value is set to 0.1. In (19), this Eikonal equation also uses a reference length to put more emphasis on solid objects larger than the reference length, 
                           
                              
                                 l
                              
                              
                                 r
                                 e
                                 f
                              
                           
                           =
                           1
                           /
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                         in (15), and reduces the emphasis on smaller objects.

One of the important features of TO (compared to size or shape optimization) is allowing topological or connectivity alterations inside a design domain  [39–41]. This unique feature makes it necessary to add some modifications to an original governing equation of any physics through the material interpolation function with respect to the spatially varying design variables. The most popular interpolation function may be the SIMP (Solid Isotropic Material with Penalization) function. For instance, in the case of a TO structure problem, heat transfer problem or electrostatic problem, the material properties such as Young modulus, thermal conductivity, or electric conductivity are interpolated with respect to the spatially varying design variables. In a laminar fluid problem, an additional force term, sometimes called the Darcy force, the damping force, or the Lagrange force, is added to the direct NS equations. Regardless of any interpretation, the extra forces are added to make the velocities of spatial domains be modeled as solid domains for smaller values near zero for the zero-velocity or the no-slip condition  [16,18,19,23,29–31,42–46]. It is our main idea that these kinds of modifications can also be proposed to the governing equations of one of the turbulent models. To our knowledge, before the present work, the pioneering work in  [15,27] is the first contribution to the framework of the finite volume method of the S–A turbulent model. The present study extended previous work by adding interpolations of the transportation equation and the wall equation in the framework of the FE method.

The original S–A models also should be modified to allow free material distribution. To achieve this, the special conditions of the S–A models for a solid domain are imposed: zero velocities in NS equations, zero eddy viscosity (no turbulent energy dissipation), and a non-zero value, i.e.,  
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                        , for the reciprocal distance value. Bearing these in mind, the following modifications can be devised: 
                           
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             ρ
                                             
                                                (
                                                
                                                   u
                                                
                                                ⋅
                                                ∇
                                                )
                                             
                                             
                                                u
                                             
                                             =
                                             ∇
                                             ⋅
                                             
                                                [
                                                −
                                                p
                                                
                                                   I
                                                
                                                +
                                                
                                                   (
                                                   μ
                                                   +
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   ∇
                                                   
                                                      u
                                                   
                                                   +
                                                   ∇
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            α
                                                            
                                                               u
                                                            
                                                            )
                                                         
                                                      
                                                      ︸
                                                   
                                                
                                                
                                                   
                                                      Added penalty term
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∇
                                             ⋅
                                             
                                                (
                                                ρ
                                                
                                                   u
                                                
                                                )
                                             
                                             =
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 (21)
                                 
                                    
                                       (
                                       
                                          u
                                       
                                       ⋅
                                       ∇
                                       )
                                    
                                    
                                       
                                          
                                             
                                                ν
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          b
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ν
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    −
                                    
                                       
                                          C
                                       
                                       
                                          ω
                                          1
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ν
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         ω
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ∇
                                    ⋅
                                    
                                       (
                                       
                                          (
                                          ν
                                          +
                                          
                                             
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                             
                                          
                                          )
                                       
                                       ∇
                                       
                                          
                                             
                                                
                                                   ν
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             
                                                t
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                b
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ∇
                                    
                                       
                                          
                                             
                                                ν
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    ⋅
                                    ∇
                                    
                                       
                                          
                                             
                                                ν
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                −
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ν
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ν
                                                                     
                                                                     
                                                                        ̃
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ν
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             ︸
                                          
                                       
                                       
                                          
                                             Added penalty term
                                          
                                       
                                    
                                 
                              
                              
                                 (22)
                                 
                                    α
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             
                                                min
                                             
                                          
                                       
                                       −
                                       
                                          
                                             α
                                          
                                          
                                             
                                                max
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   u
                                                
                                             
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             γ
                                             )
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             γ
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   u
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       (
                                       
                                          Pa
                                       
                                       
                                          
                                             
                                                s
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          
                                             min
                                          
                                       
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             
                                                max
                                             
                                          
                                       
                                       −
                                       
                                          
                                             α
                                          
                                          
                                             
                                                min
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   u
                                                
                                             
                                             γ
                                          
                                          
                                             
                                                (
                                                1
                                                −
                                                γ
                                                +
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      u
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          Pa
                                       
                                       
                                          
                                             
                                                s
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                         where the spatially varying design variable is denoted by 
                           γ
                        . The interpolation function in (22) is different to that used in some relevant researches  [16,18,19,23,30,31,42–46]; in the previous research, the interpolation, 
                           α
                           =
                           
                              
                                 α
                              
                              
                                 
                                    min
                                 
                              
                           
                           +
                           
                              (
                              
                                 
                                    α
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              −
                              
                                 
                                    α
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              )
                           
                           
                              
                                 q
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          γ
                                       
                                       
                                          p
                                          r
                                          e
                                          v
                                          i
                                          o
                                          u
                                          s
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    (
                                    q
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          p
                                          r
                                          e
                                          v
                                          i
                                          o
                                          u
                                          s
                                       
                                    
                                    )
                                 
                              
                           
                        , is used when the design variable is 
                           
                              
                                 γ
                              
                              
                                 p
                                 r
                                 e
                                 v
                                 i
                                 o
                                 u
                                 s
                              
                           
                         and the penalization is 
                           q
                        . The one difference between the present function and the previous interpolation is only the physical status of the design variables. The penalization values of the design variables are denoted by 
                           
                              
                                 n
                              
                              
                                 u
                              
                           
                        , 
                           
                              
                                 n
                              
                              
                                 
                                    
                                       
                                          
                                             ν
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                              
                           
                         and, 
                           
                              
                                 n
                              
                              
                                 G
                              
                           
                        , respectively. In Eq. (20), i.e., the momentum equation, the Darcy force terms, 
                           α
                           
                              u
                           
                        , are added with the maximum factor, 
                           
                              
                                 α
                              
                              
                                 
                                    max
                                 
                              
                           
                        , and the minimum factor, 
                           
                              
                                 α
                              
                              
                                 
                                    min
                                 
                              
                           
                        . In the transportation equation, i.e., Eq. (21), the penalization term, 
                           −
                           
                              
                                 α
                              
                              
                                 
                                    
                                       ν
                                       
                                          t
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       ν
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 
                                    t
                                 
                              
                           
                           
                              
                                 γ
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ν
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        , is added to consider the zero eddy viscosity condition at the solid wall, where the maximum penalty value is 
                           
                              
                                 α
                              
                              
                                 
                                    
                                       
                                          
                                             ν
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       
                                          t
                                       
                                    
                                 
                              
                           
                        .

For the Eikonal equation, the effect of the spatial design variables can be imposed as follows: 
                           
                              (23)
                              
                                 
                                    |
                                    ∇
                                    D
                                    |
                                 
                                 =
                                 1
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                
                                                
                                                   D
                                                
                                             
                                             ×
                                             
                                                (
                                                D
                                                )
                                             
                                             ×
                                             
                                                
                                                   γ
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                
                                             
                                          
                                          ︸
                                       
                                    
                                    
                                       
                                          Added penalty term
                                       
                                    
                                 
                                 
                                   subject to  
                                 D
                                 =
                                 0
                                   at boundary  
                              
                           
                         where 
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 D
                              
                           
                         is the penalization value to impose a homogeneous value to the nodes of corresponding finite elements with ones for the design variables with 
                           
                              
                                 n
                              
                              
                                 D
                              
                           
                         for the SIMP penalization. Then, one intermediate form with a relaxed coefficient and term can be presented as follows: 
                           
                              (24)
                              
                                 
                                    
                                       
                                          |
                                          ∇
                                          G
                                          |
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       w
                                    
                                 
                                 G
                                 
                                    (
                                    ∇
                                    ⋅
                                    ∇
                                    G
                                    )
                                 
                                 =
                                 
                                    (
                                    1
                                    +
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          w
                                       
                                    
                                    )
                                 
                                 ×
                                 
                                    
                                       G
                                    
                                    
                                       4
                                    
                                 
                                 ×
                                 
                                    (
                                    1
                                    +
                                    
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          G
                                       
                                    
                                    ×
                                    
                                       (
                                       1
                                       /
                                       G
                                       )
                                    
                                    ×
                                    
                                       
                                          γ
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                D
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         As the above equation is difficult to implement and solve, the condition of the wall in the reciprocal of the distance is directly imposed 
                           
                              (25)
                              
                                 ∇
                                 G
                                 ⋅
                                 ∇
                                 G
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       w
                                    
                                 
                                 G
                                 
                                    (
                                    ∇
                                    ⋅
                                    ∇
                                    G
                                    )
                                 
                                 =
                                 
                                    (
                                    1
                                    +
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          w
                                       
                                    
                                    )
                                 
                                 
                                    
                                       G
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   G
                                                
                                             
                                             ×
                                             
                                                (
                                                G
                                                −
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                             ×
                                             
                                                
                                                   γ
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         G
                                                      
                                                   
                                                
                                             
                                          
                                          ︸
                                       
                                    
                                    
                                       
                                          Added penalty term
                                       
                                    
                                 
                                 .
                              
                           
                         Note that the non-homogeneous boundary condition, 
                           G
                           =
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                        , is considered for the relaxed wall equation in Eq. (25). The penalization factor and the final penalization value are denoted by 
                           
                              
                                 n
                              
                              
                                 G
                              
                           
                         and 
                           
                              
                                 α
                              
                              
                                 G
                              
                           
                        , respectively. The penalization value, 
                           
                              
                                 α
                              
                              
                                 G
                              
                           
                        , is chosen by considering the size of design domain geometry. For example, if the characteristic length of a design domain is about 1 m, the value 
                           
                              
                                 α
                              
                              
                                 G
                              
                           
                         can be a positive value above 
                           
                              
                                 10
                              
                              
                                 3
                              
                           
                        .

In order to solve the above coupled equations, the 2 dimensional FE procedure is employed. The weak forms of the S–A equations can be written as follows: 
                           
                              
                                 (26)
                                 
                                    
                                       
                                          
                                             −
                                             ρ
                                             
                                                (
                                                u
                                                ⋅
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                
                                                +
                                                v
                                                ⋅
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   ̄
                                                
                                             
                                             +
                                             
                                                (
                                                −
                                                p
                                                +
                                                2
                                                
                                                   (
                                                   μ
                                                   +
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                
                                             
                                             +
                                             
                                                (
                                                μ
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      
                                                         T
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                
                                             
                                             +
                                             u
                                             α
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             −
                                             ρ
                                             
                                                (
                                                u
                                                ⋅
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                
                                                +
                                                v
                                                ⋅
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   ̄
                                                
                                             
                                             +
                                             
                                                (
                                                μ
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      
                                                         T
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                
                                             
                                             +
                                             
                                                (
                                                −
                                                p
                                                +
                                                2
                                                
                                                   (
                                                   μ
                                                   +
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                
                                             
                                             +
                                             v
                                             α
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             ρ
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   ̄
                                                
                                             
                                             =
                                             0
                                          
                                       
                                    
                                 
                              
                              
                                 (27)
                                 
                                    −
                                    
                                       (
                                       u
                                       
                                          
                                             
                                                
                                                   ν
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       v
                                       
                                          
                                             
                                                
                                                   ν
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             y
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             b
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ν
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             
                                                t
                                             
                                          
                                       
                                       −
                                       
                                          
                                             C
                                          
                                          
                                             ω
                                             1
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             ω
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ν
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            ω
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    −
                                    
                                       (
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          (
                                          ν
                                          +
                                          
                                             
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   ν
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       (
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          (
                                          ν
                                          +
                                          
                                             
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   ν
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             y
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   b
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               ν
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               ν
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ]
                                       
                                       )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    −
                                    
                                       
                                          α
                                       
                                       
                                          
                                             
                                                ν
                                             
                                             
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          ν
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    =
                                    0
                                 
                              
                              
                                 (28)
                                 
                                    −
                                    
                                       
                                          σ
                                       
                                       
                                          w
                                       
                                    
                                    G
                                    
                                       (
                                       
                                          
                                             G
                                          
                                          
                                             x
                                          
                                       
                                       
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       
                                          
                                             G
                                          
                                          
                                             y
                                          
                                       
                                       
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             y
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       (
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                σ
                                             
                                             
                                                w
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                G
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          (
                                          1
                                          +
                                          2
                                          
                                             
                                                σ
                                             
                                             
                                                w
                                             
                                          
                                          )
                                       
                                       
                                          
                                             G
                                          
                                          
                                             4
                                          
                                       
                                       −
                                       
                                          
                                             α
                                          
                                          
                                             G
                                          
                                       
                                       
                                          (
                                          G
                                          −
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          
                                             γ
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   G
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          G
                                       
                                       
                                          ̄
                                       
                                    
                                    =
                                    0
                                 
                              
                           
                         where the components of the fluid velocities are 
                           u
                         and 
                           v
                        , and the pressure component is 
                           p
                        . Virtual fluid velocities and the virtual pressure are denoted by 
                           
                              
                                 u
                              
                              
                                 ̄
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 ̄
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 ̄
                              
                           
                        , respectively. The virtual eddy viscosity and the virtual reciprocal of distance are denoted by 
                           
                              
                                 
                                    
                                       
                                          
                                             ν
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 ̄
                              
                           
                        , respectively. The 2nd order shape function and the 1st order shape function are used for fluid velocities and fluid pressure, respectively. Further, the 2nd order shape functions are used for the transportation equation and the wall equation, Fig. 3
                        . Here it can be found that the cost of the turbulent flow analysis to that of the laminar flow analysis is much expensive. The number of degrees of freedom per element for laminar flow is 40 where it becomes 76 for turbulent flow.


                        Sensitivity analysis
                     

For the analytical sensitivity analysis of the discrete response, the adjoint variable method is employed; the content of this subsection has been developed widely  [17,26,39]. For the simple notations, the vector of the state variables of fluid velocities, pressure, eddy viscosity, and distance is denoted by 
                           
                              S
                           
                        . With an objective function, 
                           ϕ
                        , the sensitivity value can be defined with the Lagrange multiplier, 
                           
                              λ
                           
                        
                        
                           
                              (29)
                              
                                 L
                                 =
                                 ϕ
                                 +
                                 
                                    
                                       
                                          λ
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    R
                                 
                                 
                                 
                                    (
                                    
                                       R
                                    
                                    
                                       (
                                       
                                          S
                                       
                                       )
                                    
                                    =
                                    
                                       0
                                    
                                    )
                                 
                              
                           
                         where the residual vector of the governing equation is denoted by 
                           
                              R
                           
                        . The derivatives of 
                           L
                         with respect to the design variable using 
                           
                              R
                           
                           
                              (
                              
                                 S
                              
                              )
                           
                           =
                           
                              0
                           
                         and 
                           ϕ
                           =
                           ϕ
                           
                              (
                              
                                 S
                              
                              
                                 (
                                 
                                    γ
                                 
                                 )
                              
                              ,
                              
                                 γ
                              
                              )
                           
                         are summarized as follows: 
                           
                              (30)
                              
                                 
                                    
                                       d
                                       L
                                    
                                    
                                       d
                                       
                                          λ
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       
                                          λ
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          λ
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ∂
                                          
                                             R
                                          
                                       
                                       
                                          ∂
                                          
                                             λ
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          ∂
                                          ϕ
                                       
                                       
                                          ∂
                                          
                                             S
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             λ
                                          
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          ∂
                                          
                                             R
                                          
                                       
                                       
                                          ∂
                                          
                                             S
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       d
                                       
                                          S
                                       
                                    
                                    
                                       d
                                       
                                          λ
                                       
                                    
                                 
                                 .
                              
                           
                         The last term in Eq. (30) is eliminated with the Lagrange multiplier by solving the following 
                           
                              (31)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       
                                          S
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          λ
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          R
                                       
                                    
                                    
                                       ∂
                                       
                                          S
                                       
                                    
                                 
                                 =
                                 
                                    0
                                 
                                 .
                              
                           
                         The term, 
                           
                              
                                 ∂
                                 
                                    R
                                 
                              
                              
                                 ∂
                                 
                                    S
                                 
                              
                           
                        , becomes the tangent stiffness matrix of the nonlinear governing equations. After that, the optimization procedure in Fig. 4
                         can be developed based on the script FE implementation, COMSOL.


                        Analysis example of the modified wall equation
                     

The relaxed wall equation, i.e., Eq. (25), is important in calculating the eddy viscosity values through the S–A model. To test the added modification of (25), Fig. 5
                         considers a rectangular box with upper and bottom slots, and a box with a circular hole. For the boundary conditions of the boxes in Fig. 5(a, b), the non-homogeneous Dirichlet boundary conditions, i.e.,  
                           G
                           =
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                        , are imposed at the upper and the bottom lines, and the zero Neumann boundary conditions are imposed for the left and the right lines. In Fig. 5(a), rectangular slots are located at the bottom and the lower center sides. To model the slots, the design variables of the finite elements inside the slots are set to 1, and the non-homogeneous boundary conditions, i.e.,  
                           G
                           =
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                        , are only imposed at the nodes inside the top and bottom slots. By the modifications of (25) and by assigning a value of one to the design variables of the finite elements inside the slots, the nodes along the vertical and the horizontal lines of the slots inside the rectangular domains have 
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                        , which simulates the non-homogeneous Dirichlet boundary condition. Further, values of 
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                         of the nodes artificially introduce the effects of the slots inside the box. In Fig. 5(b), the distance values are computed after locating a circular hole at the center of the box. Here, the design variables of the finite elements of the hole are set to 1. All the computed results show that the added penalization term of the relaxed wall equation correctly reflects the changes of the skylines of solid domains by assigning values of one to the design variables of the solid domains.

In the modified transportation equation, (25), the relaxation factor, 
                           
                              
                                 σ
                              
                              
                                 w
                              
                           
                        , is introduced in order to make the nonlinear equation easy to solve. Without this value, the wall equation becomes too nonlinear and the solution process becomes unstable. However, an excessively large value for the relaxation factor causes numerical errors. To show this side effect, Fig. 6
                         provides a calculation of the line values with a few relaxation factors. With positive values of 0.02 or 0.01, the computed distances are accurate enough from an engineering point of view. However, with a positive value of 0.1, the damping of the wall equation is too large and the damped distance values are too erratic. In our numerical tests, a value between 0.02 and 0.005 shows good convergence.

To show the validity of the present TO formulation and the effect of turbulent flow on an optimized layout, this subsection solves the TO problems for 2-dimensional fluid channel designs and compares the obtained layouts with the layouts computed with the laminar flow assumption; it is one of our computational and theoretical limitations that two dimensional steady-state analysis and design domains are considered. In transient systems, the adjoint sensitivity analysis approach should be modified.


                        Example 1: two dimensional pipe design problem
                     

For the first numerical example, the pipe design problems whose optimal layouts in laminar flow have been researched are considered in Fig. 7
                        . For TO, the following optimization formulation of Eq. (32) minimizing the energy dissipation rate (or sometimes called the fluid loss) subject to the mass constraint is solved by the gradient based optimizer  [47]. Note that the total viscosity being composed with the constant viscosity and the spatially varying eddy viscosity in the S–A turbulent model, the viscosity term of the objective function becomes 
                           μ
                           +
                           
                              
                                 μ
                              
                              
                                 
                                    T
                                 
                              
                           
                        . 
                           
                              
                                 (32)
                                 
                                    
                                       
                                          
                                             Minimize  
                                             ϕ
                                             =
                                             
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   f
                                                   l
                                                   u
                                                   d
                                                   i
                                                   c
                                                
                                             
                                          
                                       
                                       
                                          
                                             Subject to  
                                             V
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   E
                                                
                                             
                                             
                                                
                                                   γ
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             ≥
                                             
                                                
                                                   V
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (33)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          f
                                          l
                                          u
                                          d
                                          i
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                Ω
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       μ
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       ∇
                                       
                                          u
                                       
                                       +
                                       ∇
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       )
                                    
                                    ⋅
                                    
                                       (
                                       ∇
                                       
                                          u
                                       
                                       +
                                       ∇
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    α
                                    
                                       u
                                    
                                    ⋅
                                    
                                       u
                                    
                                    d
                                    Ω
                                    
                                    
                                       (
                                       
                                          Pa
                                       
                                       
                                       
                                          
                                             
                                                m
                                             
                                          
                                          
                                             3
                                          
                                       
                                       /
                                       
                                          s
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                         The volume and the upper limit of the mass usage are 
                           V
                         and 
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                        , respectively. The number of the design variables, the 
                           i
                        th elementary volume and the 
                           i
                        th design variables are NE, 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 γ
                              
                              
                                 i
                              
                           
                        , respectively. The design domain is denoted by 
                           
                              
                                 Ω
                              
                              
                                 d
                              
                           
                        . Note that the mass constraint becomes a “greater-than” constraint by following the work in  [18,43,44]; when values of one are selected for the design variables, the corresponding finite elements represent solid regions. Therefore, the physical meaning of the volume constraint is the same as those of the previous works. One of the reasons to use these interpolations and the volume constraint is the employment of the formulations from (20) to (22). Fig. 8
                         shows the C-shape curved channel layout in (a) and the optimal straight layout in (b) with the laminar flow condition with parabolic fluid velocity inputs at the two input ports and the zero pressure at the two output ports.

With a fluid at high speed, i.e., high Reynolds numbers, the fluidic inertia term, 
                           α
                           
                              u
                           
                           ⋅
                           
                              u
                           
                        , becomes dominant compared with the viscosity term, 
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           
                              (
                              μ
                              +
                              
                                 
                                    μ
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              )
                           
                           
                              (
                              ∇
                              
                                 u
                              
                              +
                              ∇
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              )
                           
                           ⋅
                           
                              (
                              ∇
                              
                                 u
                              
                              +
                              ∇
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              )
                           
                        , and the balance between the inertia and the viscosity terms is reflected in the optimal layouts. In the relevant research  [18], it is known that the C-shape curved design is better than the straight line in the laminar flow condition due to the difficulties in the local optima issue. In our present development, we have the same conclusions about the local optima issue and the objective values.

Considering the turbulent flow model with a small Reynolds number, the design with the two C-shape curved channels also become an optimal layout in Fig. 9
                         (Reynolds 
                           
                              number
                           
                           =
                           50
                        ), as expected. However, for a flow with 3000 for Reynolds number, the design with a design mixing the C-shaped curved pipes and the straight line design is obtained as shown in Fig. 10
                        . From a physical point of view, it can be postulated that, due to the added eddy viscosity on the NS equation, the fluidic energy is dissipated in some regions with high eddy viscosity values. Consequently, the averaged fluid velocity becomes slow. Further, the design with the C-shape curved channels connecting the closest short pipes among the left and the right side channels can be a local optimal layout, as shown in Fig. 10. This observation is also confirmed by the straight pipe result of Fig. 11
                        , which shows an optimal layout with the same conditions except the low eddy viscosity of Fig. 10. In addition, an alternative interpretation may be that, to minimize the fluidic resistances of the spatially varying eddy viscosity, the locally enlarged components become preferred, and the mixed design with the C-shape curved channels and the straight line design are obtained in Fig. 10 compared with the optimal layout of Fig. 8(b); this feature will be further tested in the next example. In our present developments, some designs with some gray elements (intermediate design) can be obtained; the physical meaning of the elements with the intermediate design variables may be porous materials but it needs more researches to identify the corresponding micro-structures. To remove them and make the interpretation clear, the explicit penalization 
                           
                              
                                 ∑
                              
                              
                                 e
                                 =
                                 1
                              
                              
                                 N
                                 E
                              
                           
                           
                              
                                 γ
                              
                              
                                 e
                              
                           
                           
                              (
                              1
                              −
                              
                                 
                                    γ
                                 
                                 
                                    e
                                 
                              
                              )
                           
                         can be used. It is our belief that this example illustrates the importance of the consideration of the turbulent effect in TO for fluidic devices. Further, if an optimal layout should be designed within a limited time, an optimal layout with laminar flow but with a spatially higher eddy viscosity determined based on the order of the kinetic energy dissipation and the velocity oscillations may be an alternative approach.


                        Table 1
                         compares the objectives of the designs (Figs. 8–10). First of all, the dissipation energy of the parallel pipe design whose fluidic flow can be regarded as the pressure derived flow between stationary parallel plates or Poiseuille flow can be obtained as follows: 
                           
                              
                                 (34a)
                                 
                                    The energy dissipation of Poiseuille flow
                                    :
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          f
                                          l
                                          u
                                          i
                                          d
                                          i
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          96
                                       
                                       
                                          9
                                       
                                    
                                    
                                       (
                                       4
                                       +
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       )
                                    
                                    η
                                    
                                       
                                          v
                                       
                                       
                                          
                                             max
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    74.6666
                                    
                                       
                                          v
                                       
                                       
                                          
                                             max
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 (34b)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          f
                                          l
                                          u
                                          i
                                          d
                                          i
                                          c
                                       
                                    
                                    =
                                    1.8666
                                    ×
                                    
                                       
                                          10
                                       
                                       
                                          5
                                       
                                    
                                    
                                    for  
                                    
                                       
                                          v
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    =
                                    50
                                    ,
                                    
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          f
                                          l
                                          u
                                          i
                                          d
                                          i
                                          c
                                       
                                    
                                    =
                                    6.7200
                                    ×
                                    
                                       
                                          10
                                       
                                       
                                          8
                                       
                                    
                                    
                                    for  
                                    
                                       
                                          v
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    =
                                    3000
                                    .
                                 
                              
                           
                        
                     

From Table 1, the followings are observed.

Observation 1: In the laminar flow reanalysis, the parallel pipe design in Fig. 8(b) becomes almost similar to the above formulations as 
                           1.8329
                           ×
                           
                              
                                 10
                              
                              
                                 5
                              
                           
                         for Reynolds 
                           
                              number
                           
                           =
                           50
                         and 
                           6.7045
                           ×
                           
                              
                                 10
                              
                              
                                 8
                              
                           
                         for Reynolds 
                           
                              number
                           
                           =
                           3000
                        ; some differences are due to the numerical solution and the impervious of rigid walls. For the turbulent reanalyzes for the design, the objective values become higher due to the eddy viscosity.

Observation 2: The objective values of the C-shape curved design in Fig. 8(a) for Reynolds 
                           
                              number
                           
                           =
                           50
                         and Reynolds 
                           
                              number
                           
                           =
                           3000
                         are better than those of the parallel pipe design in Fig. 8(b) due to the local optima issue that was extensively studied in  [18].

Observation 3: With the laminar flow assumption, the turbulent designs are inferior to the laminar designs.

Observation 4: The turbulent design of Fig. 9 is the C-shape curved design which is similar to the C-shape design in Fig. 8(a) but the objective values are slightly different; it is due to the local optima.

Observation 5: The turbulent designs of Figs. 9 and 10 are the best designs for the turbulent flow of Reynolds 
                           
                              number
                           
                           =
                           50
                         and Reynolds 
                           
                              number
                           
                           =
                           3000
                        , respectively.

Observation 6: the optimal design depends on the flow theory. In the transition region 
                           
                              (
                              2100
                              <
                              R
                              e
                              <
                              4000
                              )
                           
                        , it is our proposal to use the turbulent flow theory as turbulent flow can occur in some regions. From an optimization point of view, local optima can be obtained.

The postprocessed designs in Figs. 8 and 10 are presented in Fig. 12
                        . Due to the meshes differences, some changes in the objective values are observed.


                        Example 2: bend pipe design problem
                     

For the next numerical example, the bend pipe design in Fig. 13
                         is considered; the optimal layouts in laminar flow also have been researched for this example. The optimization problem of the first numerical example is solved as well.

For laminar flow with a Reynolds number of 100, the design with a straight line channel in Fig. 14
                         is obtained. The manually postprocessed design is also reanalyzed and the responses of the designs are similar to each other as shown in Fig. 14(b). For the turbulent flows of 
                           R
                           e
                           =
                           3000
                         and 
                           R
                           e
                           =
                           5000
                         with the S–A model, the designs with a straight center channel but with an enlarged inlet and an enlarged outlet can be obtained in Figs. 15 and 16
                        
                        . With the higher eddy viscosity at the inlet and the outlet, the fluid velocities become slow, and the enlarged parts minimizing flow resistance at these edges are configured. The first numerical example reflects this feature too for optimization.

The sensitive stochastic and chaotic behavior of turbulent flow, which is one of the important basic features of turbulent flow, should be considered in connection with the present TO approach. In other words, it is known in fluid mechanics that turbulent flow is chaotic and some small geometry changes in size and shape cause different flows. As the present analysis and design formulations are based on the material interpolation schemes of TO with a fixed grid finite element, the above characteristic of turbulent flow may not be well reflected in terms of analysis and design. In order to test these features in analysis and design, Fig. 17
                        (a) shows the optimal layouts with the three different mesh refinements, i.e., 30 by 30, 60 by 60, and 90 by 90. From a topological optimization point of view, the similar topologies, i.e., the straight but partially curved center channel and the enlarged inlet and outlet structures, can fortunately be obtained. These results imply the robustness relative to the mesh refinement. However, with different mesh refinements, the length and sizes of the zigzag structures defining the rims of the channels are different, which can be regarded as small geometric changes from a turbulent analysis point of view. Despite these geometric changes, the similar designs are obtained, and the similar fluid motions can be obtained with some discrepancy in the objective functions. However, some changes in the objective functions exist.


                        Table 2
                         compares the objectives of the designs of Figs. 14–16. As the eddy viscosity at the input is effectively diffused to the designs, the objective values of the laminar designs with Reynolds number 
                           =
                         100 are significantly increased even for the turbulent flow with Reynolds number 
                           =
                         100. In the turbulent flow with Reynolds number 
                           =
                         3000 and 5000, the turbulent designs of Figs. 15 and 16 are better than the straight design of Fig. 14. As the eddy viscosity value for laminar flow becomes zero, the objective values for laminar flow with Reynolds number 
                           =
                         100 are lower than those of turbulent flow.


                        Fig. 18
                         shows some intermediate design layouts and the objective history of the design.

Furthermore, Fig. 19
                         shows two optimal layouts for a different eddy viscosity boundary condition. Because of the change in the boundary condition, the inlet channel becomes wider, and the outlet channel becomes relatively narrow in Fig. 19(a). With a higher Reynolds number in Fig. 19(b), a design with a relatively straight line can be obtained.


                        Example 3: two dimensional diffuser design problem
                     

For the last numerical example, we consider the diffuser design problem by minimizing the energy dissipation rate in a fluidic domain shown in Fig. 20
                        ; the analysis and design size is 
                           l
                         by 
                           l
                         and is discretized by rectangular FE meshes. The left side has the parabolic fluid input, 
                           
                              
                                 u
                              
                              
                                 i
                                 n
                              
                           
                        , towards the right side, and the right side has the parabolic fluid output, 
                           
                              
                                 u
                              
                              
                                 o
                                 u
                                 t
                              
                           
                        , at the one-third center. By comparing the optimal layouts of laminar flow and turbulent flow, the validity of the present approach can be verified and the effect of turbulent flow on optimal layout can be illustrated. For TO, the same optimization formulation of Eq. (32) by minimizing the energy dissipation rate (or sometimes called the fluid loss) subject to the mass constraint can be considered.


                        Figs. 21 and 22
                        
                         show the optimal layouts considering laminar flow and turbulent flow. With the simulations assuming laminar flow, a cone shaped diffuser can be obtained in Fig. 21 whose shape is similar as the layouts provided by some relevant previous work. With the simulations assuming turbulent flow, the enlarged areas at the inlet and the outlet can be obtained with 1 for 
                           
                              
                                 
                                    
                                       ν
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 t
                              
                           
                         in Fig. 22. In Spalart–Allmaras theory, these values indicate how much turbulent flow is developed and how much energy dissipation happens. In addition, what we observe and understand is that the magnitudes of the Reynolds stresses at the input and the output are increased to have turbulent effects. From a physical point of view, as the eddy viscosity becomes higher and the fluid near the solid domains becomes slow, the areas at the outlet should be increased. To verify these designs, the postprocessed designs are reanalyzed with fine meshes in Fig. 23
                        . As shown, the turbulent design shows the better performances in terms of the objective function.

@&#CONCLUSION@&#

In this research, we developed a new TO for turbulent flow based on the S–A turbulent flow model. Unlike laminar flow analysis, the standard turbulent models add the eddy viscosity value calculated by the transportation equation to the NS equation. As the distance values toward the nearest solid wall are also used while calculating the eddy viscosity, the relaxed wall distance equation should be solved simultaneously. Consequently, with the S–A turbulent model (one equation turbulent model), four nonlinear equations should be iteratively solved with the proper boundary conditions. The present analysis approach solves these nonlinear equations with the FE procedure. For TO, the four equations should be modified with respect to the spatially varying design variables. In the momentum equations, the Darcy damping forces are inserted to model solid regions by the spatially varying design variables. In the transportation equation used to compute the eddy viscosity, zero eddy viscosity conditions should be imposed along the boundary curves defining solid parts. Therefore, we found that the damping force terms similar to the Darcy’s damping force in the momentum equations can be added in the transportation equation. In the relaxed wall distance equation, a new damping term is added to the relaxed wall distance equation as a non-zero value imposed along the boundaries of the solid domain. For the sensitivity analysis, the adjoint design sensitivity analysis was performed with respect to the design variables. After all the developments and implementations, we solved the TO problems considering the effects of turbulent flows. Comparing the optimal layouts for turbulent flows with the optimal layouts for laminar flows, clear design differences were observed. It turns out that the S–A model makes inhomogeneous distributions of the summation of the constant viscosity and the spatially varying eddy viscosity, and the averaged fluidic velocities changed accordingly. By considering the effect of the turbulent flow, the eddy viscosity is added to the NS equation and it naturally increases the effect of the viscosity force; the balance between the inertia force and the viscosity force is important in structural optimization designs. This aspect is naturally considered in the structural TO. Furthermore, the impervious condition with the added Darcy force for structural optimization should be modeled properly. If not, the solid boundary condition of the obtained design with Darcy’s force should be reinterpreted as the optimization algorithm considering the slightly impervious condition of Darcy’s force in the Navier–Stokes equation. In addition, the designs for laminar flow are not effective in turbulent flow cases, indicating the necessity of considering the effect of turbulent flow in structural TO.

The present research has highlighted the following points, which can be improved on in future research. (1) In general, as turbulent flow is time-dependent, rotational, and three dimensional, three dimensional transient computations should be conducted. The present study conducted two dimensional steady-state simulations as we intended to concentrate on the possibility of the application of the turbulent model in TO and hoped to see the effects of the eddy viscosity effect on the optimal layout. (2) The boundary conditions are artificial, especially for the eddy viscosity. Thus, further study is necessary. (3) The effects of different fluidic motions should be studied as a function of the turbulent model used. In our exercises, a positive-preserving discretization of the troublesome convective acceleration terms was important for the robustness of the analysis and the optimization algorithms. Thus, it is very challenging to incorporate this method with other turbulent flow models with other discretization methods such as finite volume methods, finite difference methods, lattice Boltzmann methods and particle-based methods. For examples, one turbulent model suitable for a range of Reynolds numbers is not suitable for other Reynolds number ranges. But we expect that the approaches of the present study may be applied.

@&#ACKNOWLEDGMENT@&#

This work was supported by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MEST) (NRF-2015R1A2A2A11027580).

@&#REFERENCES@&#

