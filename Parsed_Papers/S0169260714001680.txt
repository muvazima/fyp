@&#MAIN-TITLE@&#Fast computation of Hessian-based enhancement filters for medical images

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A method for fast computation of Hessian-based enhancement filters is proposed.


                        
                        
                           
                           The method relies on avoiding computation of Hessian eigenvalues.


                        
                        
                           
                           The percentage reductions in processing time can be over 65%.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Hessian-based enhancement filter

Routh–Hurwitz criterion

Selective enhancement filter

Hessian eigenvalue

@&#ABSTRACT@&#


               
               
                  This paper presents a method for fast computation of Hessian-based enhancement filters, whose conditions for identifying particular structures in medical images are associated only with the signs of Hessian eigenvalues. The computational costs of Hessian-based enhancement filters come mainly from the computation of Hessian eigenvalues corresponding to image elements to obtain filter responses, because computing eigenvalues of a matrix requires substantial computational effort. High computational cost has become a challenge in the application of Hessian-based enhancement filters. Using a property of the characteristic polynomial coefficients of a matrix and the well-known Routh–Hurwitz criterion in control engineering, it is shown that under certain conditions, the response of a Hessian-based enhancement filter to an image element can be obtained without having to compute Hessian eigenvalues. The computational cost can thus be reduced. Experimental results on several medical images show that the method proposed in this paper can reduce significantly the number of computations of Hessian eigenvalues and the processing times of images. The percentage reductions of the number of computations of Hessian eigenvalues for enhancing blob- and tubular-like structures in two-dimensional images are approximately 90% and 65%, respectively. For enhancing blob-, tubular-, and plane-like structures in three-dimensional images, the reductions are approximately 97%, 75%, and 12%, respectively. For the processing times, the percentage reductions for enhancing blob- and tubular-like structures in two-dimensional images are approximately 31% and 7.5%, respectively. The reductions for enhancing blob-, tubular-, and plane-like structures in three-dimensional images are approximately 68%, 55%, and 3%, respectively.
               
            

@&#INTRODUCTION@&#

Image pre-processing plays an important role in medical image processing. Many pre-processing techniques have been developed [1–3]. Among those techniques, the Hessian-based enhancement filter is one of the most widely used. Hessian-based enhancement filters have been developed and adopted to process blob-, tubular-, and plane-like structures in medical images [4–15].

High computational cost is one of the main drawbacks of Hessian-based enhancement filters [12,16,17]. The Hessian-based enhancement filter technique is based on the eigenvalue analysis of the Hessian matrix corresponding to each image element in two-dimensional (2D) or three-dimensional (3D) images. To obtain the response of a Hessian-based enhancement filter to an image element, the Hessian eigenvalues corresponding to the element are first computed and arranged in some order. The filter response is then obtained by computing the designed response function with the arranged Hessian eigenvalues. Computing eigenvalues of a matrix requires substantial computational effort. Moreover, Hessian-based enhancement filters are commonly applied in multiscale frameworks. One has to compute Hessian eigenvalues for each image element for every selected scale. Consequently, high computational cost becomes a challenge in the application of Hessian-based enhancement filters.

Few efforts have been dedicated to solving the problem of high computational cost in the application of Hessian-based enhancement filters. Orlowski and Orkisz [17] proposed a method to reduce the computational costs of Hessian-based enhancement filters for tubular-like structures in 3D images. Their method is based on the fact that the response of a Hessian-based enhancement filter to an image element is zero if the specified condition in the response function of the filter for identifying a particular structure is not satisfied. They showed that for a voxel, one can conclude by performing two tests that the condition for identifying tubular-like structures is not satisfied. The first test checks the sign of the Hessian trace, and the second test examines the sign of the Hessian determinant and whether the Hessian matrix is negative-definite. If the two tests conclude that the condition is not satisfied, the response of the Hessian-based enhancement filter to the voxel can be determined to be zero without having to compute the corresponding Hessian eigenvalues. The computational cost of the Hessian-based enhancement filter can thus be reduced.

In this paper, a method is proposed for reducing the computational costs of Hessian-based enhancement filters for blob-, tubular-, and plane-like structures in 2D and 3D images. It is shown that for an image element, under certain conditions, we can conclude that the conditions in the response functions of the Hessian-based enhancement filters are not satisfied without having to compute the corresponding Hessian eigenvalues. These conditions are developed by using a property of the characteristic polynomial coefficients of the Hessian matrix corresponding to the image element and the well-known Routh–Hurwitz criterion in control engineering. They can be checked with very low computational costs. As a result, the number of computations of Hessian eigenvalues required by the filters to process images can be reduced with very low computational cost. The computational costs of the filters are thereby reduced.

The rest of the paper is organized as follows. Section 2 reviews Hessian-based enhancement filters for 2D and 3D images. Section 3 develops the method for reducing the computational costs of Hessian-based enhancement filters for blob-, tubular-, and plane-like structures in 2D and 3D images. The experimental results are given in Section 4 to show the effectiveness of the method. The results are discussed in Section 5, and conclusions are drawn in Section 6.

Let f(x) be the intensity function of an image, where x is the location in the image space. For a 2D image, the Hessian matrix, H
                     2(x), corresponding to the pixel at x
                     =(x,y) is given by
                        
                           (1)
                           
                              
                                 
                                    
                                       H
                                    
                                    2
                                 
                                 (
                                 
                                    x
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         
                                                            x
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         x
                                                         ∂
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         y
                                                         ∂
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         
                                                            y
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ≜
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                      
                                                         x
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      f
                                                      
                                                         x
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                      
                                                         y
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      f
                                                      
                                                         y
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 
                                    ∂
                                    2
                                 
                                 f
                              
                              
                                 ∂
                                 
                                    x
                                    2
                                 
                              
                           
                           ,
                           
                              f
                              
                                 x
                                 x
                              
                           
                        
                     , 
                        
                           
                              
                                 
                                    ∂
                                    2
                                 
                                 f
                              
                              
                                 ∂
                                 x
                                 ∂
                                 y
                              
                           
                           ,
                           
                              f
                              
                                 x
                                 y
                              
                           
                        
                     , etc. are the second order partial derivatives of f.
                  

Similarly, for a 3D image, the Hessian matrix, H
                     3(x), corresponding to the voxel at x
                     =(x,y,z) is given by
                        
                           (2)
                           
                              
                                 
                                    
                                       H
                                    
                                    3
                                 
                                 (
                                 
                                    x
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         
                                                            x
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         x
                                                         ∂
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         x
                                                         ∂
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         y
                                                         ∂
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         
                                                            y
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         y
                                                         ∂
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         z
                                                         ∂
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         z
                                                         ∂
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         f
                                                      
                                                      
                                                         ∂
                                                         
                                                            z
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ≜
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                      
                                                         x
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      f
                                                      
                                                         x
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      f
                                                      
                                                         x
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                      
                                                         y
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      f
                                                      
                                                         y
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      f
                                                      
                                                         y
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                      
                                                         z
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      f
                                                      
                                                         z
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      f
                                                      
                                                         z
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     For convenience and without causing ambiguity, let Λ
                     =(λ
                     1, λ
                     2) with 
                        
                           
                              
                                 
                                    λ
                                    1
                                 
                              
                           
                           ≥
                           
                              
                                 
                                    λ
                                    2
                                 
                              
                           
                        
                      and Λ
                     =(λ
                     1, λ
                     2, λ
                     3) with 
                        
                           
                              
                                 
                                    λ
                                    1
                                 
                              
                           
                           ≥
                           
                              
                                 
                                    λ
                                    2
                                 
                              
                           
                           ≥
                           
                              
                                 
                                    λ
                                    3
                                 
                              
                           
                        
                      be the eigenvalues of H
                     2(x) and H
                     3(x), respectively. The response function, Φ(x), of a Hessian-based enhancement filter has the form
                        
                           (3)
                           
                              
                                 
                                    Φ
                                 
                                 (
                                 
                                    x
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ϕ
                                                   (
                                                   Λ
                                                   )
                                                   ,
                                                    
                                                   if
                                                    
                                                   condition
                                                    
                                                   
                                                      Ω
                                                      Λ
                                                   
                                                    
                                                   is
                                                    
                                                   satisfied
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                    
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     In designing the response function Φ(x) , the condition Ω
                     
                        Λ
                      is specified according to the structure to be enhanced. The image element at x is determined to belong to the structure if the Hessian eigenvalues corresponding to the image element satisfy the condition Ω
                     
                        Λ
                     . If this is the case, the filter response to the image element is given by the designed function, ϕ(Λ); otherwise, the filter response is zero.

The condition Ω
                     
                        Λ
                      in the response function Φ(x) in Eq. (3) is associated only with the signs of Hessian eigenvalues. The derivation of the condition Ω
                     
                        Λ
                      for identifying blob-, tubular-, and plane-like bright structures in a dark background can be found in [9,12]. Typically, the conditions, Ω
                     
                        Λ,b2 and Ω
                     
                        Λ,t2, for identifying blob- and tubular-like bright structures, respectively, in 2D images and the conditions, Ω
                     
                        Λ,b3, Ω
                     
                        Λ,t3, and Ω
                     
                        Λ,p3, for identifying blob-, tubular-, and plane-like bright structures, respectively, in 3D images, are given by
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                Ω
                                                
                                                   Λ
                                                   ,
                                                   b
                                                   2
                                                
                                             
                                             :
                                             
                                                λ
                                                1
                                             
                                             <
                                             0
                                             ,
                                             
                                                λ
                                                2
                                             
                                             <
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Ω
                                                
                                                   Λ
                                                   ,
                                                   t
                                                   2
                                                
                                             
                                             :
                                             
                                                λ
                                                1
                                             
                                             <
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Ω
                                                
                                                   Λ
                                                   ,
                                                   b
                                                   3
                                                
                                             
                                             :
                                             
                                                λ
                                                1
                                             
                                             <
                                             0
                                             ,
                                             
                                                λ
                                                2
                                             
                                             <
                                             0
                                             ,
                                             
                                                λ
                                                3
                                             
                                             <
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Ω
                                                
                                                   Λ
                                                   ,
                                                   t
                                                   3
                                                
                                             
                                             :
                                             
                                                λ
                                                1
                                             
                                             <
                                             0
                                             ,
                                             
                                                λ
                                                2
                                             
                                             <
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Ω
                                                
                                                   Λ
                                                   ,
                                                   p
                                                   3
                                                
                                             
                                             :
                                             
                                                λ
                                                1
                                             
                                             <
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     However, usage of these conditions can differ. For example, the filter designed by Zhou et al. [11] uses the condition Ω
                     
                        Λ,b3 to identify both blob- and tubular-like structures in 3D images. The discrimination between a blob-like structure and a tubular-like structure is achieved by setting the value of a constant in the function ϕ(Λ) in Eq. (3). Although there can be different usage of the conditions in Eq. (4), the fact that condition Ω
                     
                        Λ
                      in Eq. (3) is associated only with the signs of Hessian eigenvalues does not change. In this paper, this characteristic of condition Ω
                     
                        Λ
                      plays the key role in the development of the method for reducing the computational costs of Hessian-based enhancement filters.

To enhance objects of different sizes, Hessian-based enhancement filters are commonly applied in multiscale frameworks. For example, Li et al. [12] designed selective enhancement filters as follows:
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                Φ
                                                
                                                   b
                                                   2
                                                
                                             
                                             (
                                             
                                                x
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    λ
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              λ
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               ,
                                                                
                                                               if
                                                                
                                                               
                                                                  λ
                                                                  1
                                                               
                                                               <
                                                               0
                                                               ,
                                                               
                                                                  λ
                                                                  2
                                                               
                                                               <
                                                               0
                                                               ;
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                                
                                                               otherwise
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Φ
                                                
                                                   t
                                                   2
                                                
                                             
                                             (
                                             
                                                x
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        λ
                                                                        1
                                                                     
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        λ
                                                                        2
                                                                     
                                                                  
                                                               
                                                               ,
                                                                
                                                               if
                                                                
                                                               
                                                                  λ
                                                                  1
                                                               
                                                               <
                                                               0
                                                               ;
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                                
                                                               otherwise
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Φ
                                                
                                                   b
                                                   3
                                                
                                             
                                             (
                                             
                                                x
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    λ
                                                                                    3
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              λ
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               ,
                                                                
                                                               if
                                                                
                                                               
                                                                  λ
                                                                  1
                                                               
                                                               <
                                                               0
                                                               ,
                                                               
                                                                  λ
                                                                  2
                                                               
                                                               <
                                                               0
                                                               ,
                                                               
                                                                  λ
                                                                  3
                                                               
                                                               <
                                                               0
                                                               ;
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                                
                                                               otherwise
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Φ
                                                
                                                   t
                                                   3
                                                
                                             
                                             (
                                             
                                                x
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              λ
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    λ
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                           −
                                                                           
                                                                              
                                                                                 
                                                                                    λ
                                                                                    3
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              λ
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               ,
                                                                
                                                               if
                                                                
                                                               
                                                                  λ
                                                                  1
                                                               
                                                               <
                                                               0
                                                               ,
                                                               
                                                                  λ
                                                                  2
                                                               
                                                               <
                                                               0
                                                               ;
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                                
                                                               otherwise
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Φ
                                                
                                                   p
                                                   3
                                                
                                             
                                             (
                                             
                                                x
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        λ
                                                                        1
                                                                     
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        λ
                                                                        2
                                                                     
                                                                  
                                                               
                                                               ,
                                                                
                                                               i
                                                               f
                                                                
                                                               
                                                                  λ
                                                                  1
                                                               
                                                               <
                                                               0
                                                               ;
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                                
                                                               otherwise
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where Φ
                        b2(x) and Φ
                        t2(x) are for blob- and tubular-like structures, respectively, in 2D images, and Φ
                        b3(x), Φ
                        t3(x), and Φ
                        p3(x) are for blob-, tubular-, and plane-like structures, respectively, in 3D images. They also designed the algorithm of multiscale selective enhancement filters for enhancing objects with diameters lying in a given interval, as follows [12]:
                        Algorithm 1
                        Algorithm of multiscale selective enhancement filters
                              
                                 Step 1:
                                 Determine empirically the number, N
                                    
                                       s
                                    , of scales to be used for enhancing objects with diameters lying in the interval [d
                                    0,d
                                    1].

Compute the N
                                    
                                       s
                                     individual scales σ
                                    
                                       i
                                    , i
                                    =1, …, N
                                    
                                       s
                                     using the formula
                                       
                                          (6)
                                          
                                             
                                                
                                                   σ
                                                   1
                                                
                                                =
                                                
                                                   
                                                      
                                                         d
                                                         0
                                                      
                                                   
                                                   4
                                                
                                                ,
                                                 
                                                
                                                   σ
                                                   2
                                                
                                                =
                                                r
                                                
                                                   σ
                                                   1
                                                
                                                ,
                                                 
                                                
                                                   σ
                                                   3
                                                
                                                =
                                                
                                                   r
                                                   2
                                                
                                                
                                                   σ
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   σ
                                                   N
                                                
                                                =
                                                
                                                   r
                                                   
                                                      
                                                         N
                                                         s
                                                      
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   σ
                                                   1
                                                
                                                =
                                                
                                                   
                                                      
                                                         d
                                                         1
                                                      
                                                   
                                                   4
                                                
                                             
                                          
                                       
                                    where r
                                    =(d
                                    1/d
                                    0)1/(N
                                       
                                          s
                                       −1).

For each scale σ
                                    
                                       i
                                    , i
                                    =1, …, N
                                    
                                       s
                                    , perform Steps 4 through 9.

Compute the convolution, T
                                    
                                       i
                                    , of the image and a Gaussian function of scale σ
                                       i
                                    .

For each image element at x in T
                                    
                                       i
                                    , perform Steps 6 through 8.

Compute the Hessian eigenvalues corresponding to the image element at x.

Compute the filter response Φ(x) .

End the loop for x.

End the loop for σ
                                       i
                                    
                                 

For each image element at x, the final filter response is 
                                       
                                          max
                                          
                                             
                                                
                                                   σ
                                                   i
                                                   2
                                                
                                                Φ
                                                (
                                                
                                                   x
                                                
                                                )
                                                ,
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                   N
                                                   s
                                                
                                             
                                          
                                       
                                    .

It can be seen from Algorithm 1 that the filter response to every image element of the image must be computed once for each scale. This leads to high computational cost, especially for a large number of scales N
                     
                        s
                     , because it requires computing the eigenvalues of a large number of Hessian matrices. In the next section, theorems for checking the conditions in Eq. (4) without having to compute Hessian eigenvalues are developed. With these theorems, the computational costs of multiscale Hessian-based enhancement filters can be reduced remarkably.

Let A be an n
                        ×
                        n matrix. The characteristic polynomial of A is given by
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   A
                                                
                                                (
                                                λ
                                                )
                                             
                                          
                                          
                                             
                                                =
                                                det
                                                
                                                   
                                                      λ
                                                      
                                                         
                                                            I
                                                         
                                                         n
                                                      
                                                      −
                                                      
                                                         A
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                              
                                          
                                          
                                             
                                                =
                                                
                                                   λ
                                                   n
                                                
                                                +
                                                
                                                   c
                                                   1
                                                
                                                
                                                   λ
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                +
                                                ⋯
                                                +
                                                
                                                   c
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                λ
                                                +
                                                
                                                   c
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where det(.) and I
                        
                           n
                         are the determinant of the indicated matrix and the identity matrix of size n, respectively. The coefficient c
                        1 of p
                        A(λ) has the property that
                           
                              (8)
                              
                                 
                                    
                                       c
                                       1
                                    
                                    =
                                    −
                                    t
                                    r
                                    (
                                    
                                       A
                                    
                                    )
                                 
                              
                           
                        where tr(.) is the trace of the indicated matrix [18]. The roots, λ
                        1, λ
                        2, …, λ
                        
                           n
                        , of p
                        A(λ) are the eigenvalues of A. Moreover, the sum of the eigenvalues of A is equal to the trace of A 
                        [19], i.e.,
                           
                              (9)
                              
                                 
                                    t
                                    r
                                    (
                                    
                                       A
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       
                                          λ
                                          k
                                       
                                    
                                 
                              
                           
                        
                     

From Eqs. (8) and (9)
                        
                           
                              (10)
                              
                                 
                                    
                                       c
                                       1
                                    
                                    =
                                    −
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       
                                          λ
                                          k
                                       
                                    
                                 
                              
                           
                        
                     

Let p(s) be a real polynomial of degree n given by
                           
                              (11)
                              
                                 
                                    p
                                    (
                                    s
                                    )
                                    =
                                    
                                       a
                                       0
                                    
                                    
                                       s
                                       n
                                    
                                    +
                                    
                                       a
                                       1
                                    
                                    
                                       s
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       a
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    s
                                    +
                                    
                                       a
                                       n
                                    
                                    ,
                                     
                                    
                                       a
                                       n
                                    
                                    ≠
                                    0
                                 
                              
                           
                        The following theorem states a condition for all the roots of p(s) to lie in the open left-hand complex plane, i.e., for the real parts of all the roots of p(s) to be negative.
                           Theorem 1
                           
                              [20]
                           


                           
                              If all the roots of the polynomial p(s) lie in the open left-hand complex plane, then all the coefficients of p(s) are nonzero and have the same sign.

From Theorem 1, if any of the coefficients of p(s) are zero or have different signs from other coefficients, we can immediately conclude that some of the roots of p(s) do not lie in the open left-hand complex plane. However, if all the coefficients of p(s) are nonzero and have the same sign, no conclusion can be made. In other words, Theorem 1 is only a necessary condition. The Routh–Hurwitz criterion in control engineering gives a necessary and sufficient condition for all the roots of p(s) to lie in the open left-hand complex plane. For the polynomial p(s) in Eq. (11), the Routh array, shown in Table 1
                        , can be constructed using
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                   
                                                      0
                                                      ,
                                                      j
                                                   
                                                
                                                =
                                                
                                                   a
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                ,
                                                 
                                                j
                                                =
                                                0,1
                                                ,
                                                …
                                                ,
                                                
                                                   n
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                   
                                                      1
                                                      ,
                                                      j
                                                   
                                                
                                                =
                                                
                                                   a
                                                   
                                                      2
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                                ,
                                                 
                                                j
                                                =
                                                0,1
                                                ,
                                                …
                                                ,
                                                
                                                   n
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                   
                                                      i
                                                      +
                                                      1
                                                      ,
                                                      j
                                                   
                                                
                                                =
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         
                                                            i
                                                            −
                                                            1
                                                            ,
                                                            j
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         a
                                                         
                                                            i
                                                            ,
                                                            0
                                                         
                                                      
                                                      −
                                                      
                                                         a
                                                         
                                                            i
                                                            −
                                                            1,0
                                                         
                                                      
                                                      
                                                         a
                                                         
                                                            i
                                                            ,
                                                            j
                                                            +
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         a
                                                         
                                                            i
                                                            ,
                                                            0
                                                         
                                                      
                                                   
                                                
                                                ,
                                                 
                                                j
                                                =
                                                0,1
                                                ,
                                                …
                                                ,
                                                
                                                   n
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                ;
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 n
                                 i
                              
                              =
                              
                                 
                                    (
                                    n
                                    −
                                    i
                                    )
                                    /
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 ⋅
                              
                           
                         is the floor function. With the Routh array, the Routh–Hurwitz criterion can be stated as follows:
                           Theorem 2
                           (Routh–Hurwitz criterion) [20]
                           


                           
                              
                                 
                                    (i)
                                    
                                       The number of roots of the polynomial p(s) that lie in the open right-hand complex plane is equal to the number of sign changes in the first column of the Routh array of p(s).


                                       The polynomial p(s) has roots that are symmetrically located about the origin of the complex plane if all the elements of a row of the Routh array of p(s) are zero.

Computing eigenvalues of a matrix is time-consuming. In this paper, we are concerned with fast computation of the eigenvalues of the 2×2 Hessian matrix, H
                        2(x), in Eq. (1) and the 3×3 Hessian matrix, H
                        3(x), in Eq. (2), when the computation of Hessian eigenvalues cannot be avoided. Therefore, the analytical methods given below for computing 2×2 and 3×3 Hessian matrices are adopted.

The eigenvalues of the 2×2 Hessian matrix, H
                        2(x), in Eq. (1) can be computed fast by solving analytically for the roots of the quadratic characteristic polynomial of the matrix. Let 
                           
                              
                                 p
                                 
                                    
                                       
                                          H
                                       
                                       2
                                    
                                 
                              
                              (
                              λ
                              )
                           
                         be the characteristic polynomial of H
                        2(x). It is easy to derive the formula
                           
                              (13)
                              
                                 
                                    
                                       p
                                       
                                          
                                             H
                                             2
                                          
                                       
                                    
                                    (
                                    λ
                                    )
                                    =
                                    
                                       λ
                                       2
                                    
                                    +
                                    
                                       α
                                       1
                                    
                                    λ
                                    +
                                    
                                       α
                                       2
                                    
                                 
                              
                           
                        where
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                   1
                                                
                                                =
                                                −
                                                (
                                                
                                                   f
                                                   
                                                      x
                                                      x
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      y
                                                      y
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   α
                                                   2
                                                
                                                =
                                                
                                                   f
                                                   
                                                      x
                                                      x
                                                   
                                                
                                                
                                                   f
                                                   
                                                      y
                                                      y
                                                   
                                                
                                                −
                                                
                                                   f
                                                   
                                                      x
                                                      y
                                                   
                                                
                                                
                                                   f
                                                   
                                                      y
                                                      x
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The two eigenvalues of H
                        2(x) are precisely the roots of 
                           
                              
                                 p
                                 
                                    
                                       
                                          H
                                       
                                       2
                                    
                                 
                              
                              (
                              λ
                              )
                           
                        , which can be computed analytically using the formulas
                           
                              (15)
                              
                                 
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          −
                                          
                                             α
                                             1
                                          
                                          +
                                          
                                             
                                                
                                                   α
                                                   1
                                                   2
                                                
                                                −
                                                4
                                                
                                                   α
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          −
                                          
                                             α
                                             1
                                          
                                          −
                                          
                                             
                                                
                                                   α
                                                   1
                                                   2
                                                
                                                −
                                                4
                                                
                                                   α
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The eigenvalues of the 3×3 Hessian matrix, H
                        3(x), in Eq. (2) can be computed fast using the analytical method developed by Kopp [21], which has been proved more efficient than iterative algorithms, such as the Jacobi and QL algorithms [21]. Let 
                           
                              
                                 p
                                 
                                    
                                       
                                          H
                                       
                                       3
                                    
                                 
                              
                              (
                              λ
                              )
                           
                         be the characteristic polynomial of H
                        3(x), which can be derived easily as
                           
                              (16)
                              
                                 
                                    
                                       p
                                       
                                          
                                             H
                                             3
                                          
                                       
                                    
                                    (
                                    λ
                                    )
                                    =
                                    
                                       λ
                                       3
                                    
                                    +
                                    
                                       β
                                       1
                                    
                                    
                                       λ
                                       2
                                    
                                    +
                                    
                                       β
                                       2
                                    
                                    λ
                                    +
                                    
                                       β
                                       3
                                    
                                 
                              
                           
                        where
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                   1
                                                
                                                =
                                                −
                                                (
                                                
                                                   f
                                                   
                                                      x
                                                      x
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      y
                                                      y
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      z
                                                      z
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                   2
                                                
                                                =
                                                
                                                   f
                                                   
                                                      x
                                                      x
                                                   
                                                
                                                
                                                   f
                                                   
                                                      y
                                                      y
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      x
                                                      x
                                                   
                                                
                                                
                                                   f
                                                   
                                                      z
                                                      z
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      y
                                                      y
                                                   
                                                
                                                
                                                   f
                                                   
                                                      z
                                                      z
                                                   
                                                
                                                −
                                                
                                                   f
                                                   
                                                      x
                                                      y
                                                   
                                                
                                                
                                                   f
                                                   
                                                      y
                                                      x
                                                   
                                                
                                                −
                                                
                                                   f
                                                   
                                                      x
                                                      z
                                                   
                                                
                                                
                                                   f
                                                   
                                                      z
                                                      x
                                                   
                                                
                                                −
                                                
                                                   f
                                                   
                                                      y
                                                      z
                                                   
                                                
                                                
                                                   f
                                                   
                                                      z
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                   3
                                                
                                                =
                                                
                                                   f
                                                   
                                                      x
                                                      x
                                                   
                                                
                                                
                                                   f
                                                   
                                                      y
                                                      z
                                                   
                                                
                                                
                                                   f
                                                   
                                                      z
                                                      y
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      x
                                                      y
                                                   
                                                
                                                
                                                   f
                                                   
                                                      y
                                                      x
                                                   
                                                
                                                
                                                   f
                                                   
                                                      z
                                                      z
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      x
                                                      z
                                                   
                                                
                                                
                                                   f
                                                   
                                                      y
                                                      y
                                                   
                                                
                                                
                                                   f
                                                   
                                                      z
                                                      x
                                                   
                                                
                                                −
                                                
                                                   f
                                                   
                                                      x
                                                      x
                                                   
                                                
                                                
                                                   f
                                                   
                                                      y
                                                      y
                                                   
                                                
                                                
                                                   f
                                                   
                                                      z
                                                      z
                                                   
                                                
                                                −
                                                
                                                   f
                                                   
                                                      x
                                                      y
                                                   
                                                
                                                
                                                   f
                                                   
                                                      y
                                                      z
                                                   
                                                
                                                
                                                   f
                                                   
                                                      z
                                                      x
                                                   
                                                
                                                −
                                                
                                                   f
                                                   
                                                      x
                                                      z
                                                   
                                                
                                                
                                                   f
                                                   
                                                      y
                                                      x
                                                   
                                                
                                                
                                                   f
                                                   
                                                      z
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Let
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                η
                                                =
                                                
                                                   β
                                                   1
                                                   2
                                                
                                                −
                                                3
                                                
                                                   β
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                μ
                                                =
                                                −
                                                
                                                   
                                                      27
                                                   
                                                   2
                                                
                                                
                                                   β
                                                   3
                                                
                                                −
                                                
                                                   β
                                                   1
                                                   3
                                                
                                                +
                                                
                                                   9
                                                   2
                                                
                                                
                                                   β
                                                   1
                                                
                                                
                                                   β
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                θ
                                                =
                                                
                                                   1
                                                   3
                                                
                                                
                                                   
                                                      tan
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            27
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           β
                                                                           2
                                                                           2
                                                                        
                                                                        (
                                                                        η
                                                                        −
                                                                        
                                                                           β
                                                                           2
                                                                        
                                                                        )
                                                                     
                                                                     /
                                                                     4
                                                                  
                                                                  +
                                                                  
                                                                     β
                                                                     3
                                                                  
                                                                  (
                                                                  μ
                                                                  +
                                                                  
                                                                     
                                                                        27
                                                                        
                                                                           β
                                                                           3
                                                                        
                                                                     
                                                                     /
                                                                     4
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   μ
                                                
                                                ,
                                                 
                                                0
                                                ≤
                                                θ
                                                ≤
                                                π
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Moreover, let
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   1
                                                
                                                =
                                                2
                                                cos
                                                θ
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                   2
                                                
                                                =
                                                −
                                                cos
                                                θ
                                                −
                                                
                                                   3
                                                
                                                sin
                                                θ
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                   3
                                                
                                                =
                                                −
                                                cos
                                                θ
                                                +
                                                
                                                   3
                                                
                                                sin
                                                θ
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The three eigenvalues of H
                        3(x) can be computed using the following formula [21]:
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             η
                                          
                                       
                                       3
                                    
                                    
                                       x
                                       i
                                    
                                    −
                                    
                                       1
                                       3
                                    
                                    
                                       β
                                       1
                                    
                                    ,
                                     
                                    i
                                    =
                                    1,2,3
                                 
                              
                           
                        
                     

To determine whether the conditions Ω
                        
                           Λ,b2 and Ω
                        
                           Λ,t2 in Eq. (4) are not satisfied without computing the eigenvalues of H
                        2(x), the following two theorems are established.
                           Theorem 3
                           
                              The condition Ω
                              
                                 Λ,b2
                               
                              in Eq. 
                              (4) 
                              is not satisfied if any of the coefficients of the polynomial 
                              
                                 
                                    
                                       p
                                       
                                          
                                             
                                                H
                                             
                                             2
                                          
                                       
                                    
                                    (
                                    λ
                                    )
                                 
                               
                              in Eq. 
                              (13) 
                              are nonpositive.

Since the leading coefficient of 
                                 
                                    
                                       p
                                       
                                          
                                             
                                                H
                                             
                                             2
                                          
                                       
                                    
                                    (
                                    λ
                                    )
                                 
                               is positive, from Theorem 1, it is obvious that the condition Ω
                              
                                 Λ,b2 is not satisfied if any of the coefficients of 
                                 
                                    
                                       p
                                       
                                          
                                             
                                                H
                                             
                                             2
                                          
                                       
                                    
                                    (
                                    λ
                                    )
                                 
                               are nonpositive.□


                              The condition Ω
                              
                                 Λ,t2
                               
                              in Eq. 
                              (4) 
                              is not satisfied if one of the following conditions associated with the coefficients of the polynomial 
                              
                                 
                                    
                                       p
                                       
                                          
                                             
                                                H
                                             
                                             2
                                          
                                       
                                    
                                    (
                                    λ
                                    )
                                 
                               
                              in Eq. 
                              (13) 
                              holds:
                                 
                                    •
                                    
                                       α
                                       1
                                       <0


                                       α
                                       1
                                       =
                                       α
                                       2
                                       =0


                              
                                 
                                    (i)
                                    From Eq. (10), α
                                       1
                                       =−(λ
                                       1
                                       +
                                       λ
                                       2). Since 
                                          
                                             
                                                
                                                   
                                                      λ
                                                      1
                                                   
                                                
                                             
                                             ≥
                                             
                                                
                                                   
                                                      λ
                                                      2
                                                   
                                                
                                             
                                          
                                       , if α
                                       1
                                       <0, we can conclude that λ
                                       1
                                       >0, and the condition Ω
                                       
                                          Λ,t2 is not satisfied.

It is obvious that λ
                                       1
                                       =
                                       λ
                                       2
                                       =0 if α
                                       1
                                       =
                                       α
                                       2
                                       =0. Therefore, the condition Ω
                                       
                                          Λ,t2 is not satisfied.□

To establish theorems that can determine whether the conditions Ω
                        
                           Λ,b3, Ω
                        
                           Λ,t3, and Ω
                        
                           Λ,p3 in Eq. (4) are not satisfied without computing the eigenvalues of H
                        3(x), the Routh array of the polynomial 
                           
                              
                                 p
                                 
                                    
                                       
                                          H
                                       
                                       3
                                    
                                 
                              
                              (
                              λ
                              )
                           
                         in Eq. (16) is first constructed using the formulas in Eq. (12), as follows:
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   β
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   β
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         β
                                                         1
                                                      
                                                      
                                                         β
                                                         2
                                                      
                                                      −
                                                      
                                                         β
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                              
                                          
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                   3
                                                
                                             
                                          
                                          
                                              
                                          
                                       
                                    
                                 
                              
                           
                        
                     

With the Routh array of 
                           
                              
                                 p
                                 
                                    
                                       
                                          H
                                       
                                       3
                                    
                                 
                              
                              (
                              λ
                              )
                           
                        , the theorems can now be established as follows.
                           Theorem 5
                           
                              The condition Ω
                              
                                 Λ,b3
                               
                              in Eq. 
                              (4) 
                              is not satisfied if one of the following conditions associated with the coefficients of the polynomial 
                              
                                 
                                    
                                       p
                                       
                                          
                                             
                                                H
                                             
                                             3
                                          
                                       
                                    
                                    (
                                    λ
                                    )
                                 
                               
                              in Eq. 
                              (16) 
                              holds:
                                 
                                    (i)
                                    
                                       Any of the coefficients of the polynomial 
                                       
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        
                                       are nonpositive.


                                       β
                                       1
                                       β
                                       2
                                       ≤
                                       β
                                       3
                                    


                              
                                 
                                    (i)
                                    Since the leading coefficient of 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        is positive, from Theorem 1, it is obvious that the condition Ω
                                       
                                          Λ,b3
                                        is not satisfied if any of the coefficients of 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        are nonpositive.

If β
                                       1
                                       β
                                       2
                                       ≤
                                       β
                                       3, the Routh array of 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        in Eq. (21) has a negative element in the first column or has a row whose elements are all zero. Since the leading coefficient of 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        is positive, from Theorem 2 and Eq. (21), the polynomial 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        has roots lying in the open right-hand complex plane or symmetrically located about the origin of the complex plane. Therefore, the condition Ω
                                       
                                          Λ,b3 is not satisfied.□


                              The condition Ω
                              
                                 Λ,t3
                               
                              in Eq. 
                              (4) 
                              is not satisfied if one of the following conditions associated with the coefficients of the polynomial 
                              
                                 
                                    
                                       p
                                       
                                          
                                             
                                                H
                                             
                                             3
                                          
                                       
                                    
                                    (
                                    λ
                                    )
                                 
                               
                              in Eq. 
                              (16) 
                              holds:
                                 
                                    (i)
                                    
                                       β
                                       1
                                       ≤0


                                       β
                                       2
                                       ≤0 and β
                                       3
                                       =0


                                       β
                                       1
                                       >0, β
                                       3
                                       >0, and β
                                       1
                                       β
                                       2
                                       <
                                       β
                                       3
                                    


                              
                                 
                                    (i)
                                    From Eq. (10), 
                                          
                                             
                                                β
                                                1
                                             
                                             =
                                             −
                                             
                                                
                                                   
                                                      λ
                                                      1
                                                   
                                                   +
                                                   
                                                      λ
                                                      2
                                                   
                                                   +
                                                   
                                                      λ
                                                      3
                                                   
                                                
                                             
                                          
                                       . If β
                                       1
                                       ≤0, then λ
                                       1
                                       +
                                       λ
                                       2
                                       +
                                       λ
                                       3
                                       ≥0. Since 
                                          
                                             
                                                
                                                   
                                                      λ
                                                      1
                                                   
                                                
                                             
                                             ≥
                                             
                                                
                                                   
                                                      λ
                                                      2
                                                   
                                                
                                             
                                             ≥
                                             
                                                
                                                   
                                                      λ
                                                      3
                                                   
                                                
                                             
                                          
                                       , it is obvious that λ
                                       1
                                       +
                                       λ
                                       2
                                       +
                                       λ
                                       3
                                       <0 if λ
                                       1
                                       <0 and λ
                                       2
                                       <0. Therefore, the condition Ω
                                       
                                          Λ,t3 is not satisfied if β
                                       1
                                       ≤0.

If β
                                       3
                                       =0, the polynomial 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        can be rewritten as 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                             =
                                             λ
                                             
                                                p
                                                ˜
                                             
                                             (
                                             λ
                                             )
                                          
                                       , where 
                                          
                                             
                                                p
                                                ˜
                                             
                                             (
                                             λ
                                             )
                                             =
                                             
                                                λ
                                                2
                                             
                                             +
                                             
                                                β
                                                1
                                             
                                             λ
                                             +
                                             
                                                β
                                                2
                                             
                                          
                                       . Since the leading coefficient of 
                                          
                                             
                                                p
                                                ˜
                                             
                                             (
                                             λ
                                             )
                                          
                                        is positive, from Theorem 1, the roots of 
                                          
                                             
                                                p
                                                ˜
                                             
                                             (
                                             λ
                                             )
                                          
                                        are not all negative if β
                                       2
                                       ≤0. Therefore, if β
                                       2
                                       ≤0 and β
                                       3
                                       =0, then the polynomial 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        has at least two nonnegative roots and the condition Ω
                                       
                                          Λ,t3 is not satisfied.

If β
                                       1
                                       >0, β
                                       3
                                       >0, and β
                                       1
                                       β
                                       2
                                       <
                                       β
                                       3, from Eq. (21), there are two sign changes in the first column of the Routh array of 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                       . From Theorem 2, the polynomial 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        has two positive roots. Therefore, the condition Ω
                                       
                                          Λ,t3
                                        is not satisfied.□


                              The condition Ω
                              
                                 Λ,p3
                               
                              in Eq. 
                              (4) 
                              is not satisfied if one of the following conditions associated with the coefficients of the polynomial 
                              
                                 
                                    
                                       p
                                       
                                          
                                             
                                                H
                                             
                                             3
                                          
                                       
                                    
                                    (
                                    λ
                                    )
                                 
                               
                              in Eq. 
                              (16) 
                              holds:
                                 
                                    (i)
                                    
                                       β
                                       1
                                       ≤0 and β
                                       2
                                       =
                                       β
                                       3
                                       =0


                                       β
                                       1
                                       <0, β
                                       2
                                       >0, and β
                                       3
                                       =0


                                       β
                                       1
                                       <0, β
                                       3
                                       <0, and β
                                       1
                                       β
                                       2
                                       <
                                       β
                                       3
                                    


                              
                                 
                                    (i)
                                    It is obvious that if β
                                       1
                                       ≤0 and β
                                       2
                                       =
                                       β
                                       3
                                       =0, then all three roots of 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        are nonnegative. Therefore, the condition Ω
                                       
                                          Λ,p3 is not satisfied.

If β
                                       3
                                       =0, the polynomial 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        can be written as 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                             =
                                             λ
                                             
                                                p
                                                ˜
                                             
                                             (
                                             λ
                                             )
                                          
                                       , where 
                                          
                                             
                                                p
                                                ˜
                                             
                                             (
                                             λ
                                             )
                                             =
                                             
                                                λ
                                                2
                                             
                                             +
                                             
                                                β
                                                1
                                             
                                             λ
                                             +
                                             
                                                β
                                                2
                                             
                                          
                                       . Moreover, from Eq. (12), the Routh array of 
                                          
                                             
                                                p
                                                ˜
                                             
                                             (
                                             λ
                                             )
                                          
                                        is
                                          
                                             (22)
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  β
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                             
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                             
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

If β
                                       1
                                       <0 and β
                                       2
                                       >0, then there are two sign changes in the first column of the Routh array in (22). Therefore, from Theorem 2, the polynomial 
                                          
                                             
                                                p
                                                ˜
                                             
                                             (
                                             λ
                                             )
                                          
                                        has two positive roots. In other words, if β
                                       1
                                       <0, β
                                       2
                                       >0, and β
                                       3
                                       =0, then all three roots of 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        are nonnegative. Therefore, the condition Ω
                                       
                                          Λ,p3 is not satisfied.

If β
                                       1
                                       <0, β
                                       3
                                       <0, and β
                                       1
                                       β
                                       2
                                       <
                                       β
                                       3, from Eq. (21), there are three sign changes in the first column of the Routh array of 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                       . From Theorem 2, the polynomial 
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      3
                                                   
                                                
                                             
                                             (
                                             λ
                                             )
                                          
                                        has three positive roots. Therefore, the condition Ω
                                       
                                          Λ,t3 is not satisfied.□


                        Theorems 3–7 can be applied to reduce the computational costs of Hessian-based enhancement filters, because they can determine that the conditions in Eq. (4) are not satisfied without computing the eigenvalues of the Hessian matrices H
                        2(x) and H
                        3(x). To compute the response of a Hessian-based enhancement filter to an image element, the theorem corresponding to the condition Ω
                        
                           Λ
                         in the response function Φ(x) in Eq. (3) is used first to determine if the condition Ω
                        
                           Λ
                         is not satisfied. If the condition is not satisfied, the response of the filter to the image element can be determined immediately to be zero. It is not necessary to compute the Hessian eigenvalues corresponding to the image element. With Theorems 3–7, Algorithm 1 can be improved as follows:
                           Algorithm 2
                           Improved algorithm of multiscale selective enhancement filters
                                 
                                    Step 1:
                                    Determine empirically the number, N
                                       
                                          s
                                       , of scales to be used for enhancing objects with diameters lying in the interval [d
                                       0, d
                                       1].

Compute the N
                                       
                                          s
                                        individual scales σ
                                       
                                          i
                                       , i
                                       =1, …, N
                                       
                                          s
                                        using the formula in Eq. (6).

For each scale σ
                                       
                                          i
                                       , i
                                       =1, …, N
                                       
                                          s
                                       , perform Steps 4 through 9.

Compute the convolution, T
                                       
                                          i
                                       , of the image and a Gaussian function of scale σ
                                          i
                                       .

For each image element at x in T
                                       
                                          i
                                       , perform Steps 6 through 8.

Determine whether the condition Ω
                                       
                                          Λ
                                        is not satisfied by using the corresponding theorem. If the condition Ω
                                       
                                          Λ
                                        is not satisfied, set Φ(x)=0. Goto Step 8.

Compute the Hessian eigenvalues corresponding to the image element at x and then compute the filter response Φ(x).

End the loop for x.

End the loop for σ
                                          i
                                       
                                    

For each image element at x, the final filter response is 
                                          max
                                          
                                             
                                                
                                                   σ
                                                   i
                                                   2
                                                
                                                Φ
                                                (
                                                
                                                   x
                                                
                                                )
                                                ,
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                   N
                                                   s
                                                
                                             
                                          
                                       .

@&#EXPERIMENTAL RESULTS@&#

This section presents experimental results to show the effectiveness of the proposed method. To test the effectiveness of the method, Algorithms 1 and 2 with the response functions in Eq. (5) were used to process the thoracic computed tomography (CT) images contained in twelve cases downloaded from the Lung Image Database Consortium image collection (LIDC-IDRI) [22] contained in The Cancer Imaging Archive (TCIA), which is accessible for public download. Among the twelve downloaded cases, six cases with Subject IDs LIDC-IDRI-0396, LIDC-IDRI-0504, LIDC-IDRI-0509, LIDC-IDRI-0706, LIDC-IDRI-0741, and LIDC-IDRI-0957 were processed using Algorithms 1 and 2 with response functions Φ
                        b
                     
                     2(x) and Φ
                        t
                     
                     2(x). The images contained in the other six downloaded cases, whose Subject IDs are LIDC-IDRI-0002, LIDC-IDRI-0006, LIDC-IDRI-0009, LIDC-IDRI-0030, LIDC-IDRI-0300, and LIDC-IDRI-0412, were first re-sampled to be isotropic 3D images using tri-linear interpolation. Then, the isotropic 3D images were processed using Algorithms 1 and 2 with response functions Φ
                        b3(x), Φ
                        t3(x), and Φ
                        p3(x). To compare the effectiveness of the proposed method with that of the method in [17], the isotropic 3D images were also processed using the algorithm in [17] with the response function Φ
                        t3(x). For all twelve cases, only the image elements in the lung regions were used for the test. The chosen values of the parameters N
                     
                        s
                     , d
                     0, and d
                     1 for Algorithms 1 and 2 with different response functions are shown in Table 2
                     .

The programs were coded in MATLAB. The experiments were performed on a 64-bit Windows 7 personal computer equipped with an Intel Core i5-750 2.67GHz CPU and 4 GB RAM. The equipped CPU has four cores, but only one core was used to run the programs to avoid miscalculation of image processing times caused by communication among the cores.

To verify the correctness of the images processed using Algorithm 2, the mean squared error (MSE) was computed for each processed image, as follows:
                        
                           (23)
                           
                              
                                 M
                                 S
                                 E
                                 =
                                 
                                    1
                                    
                                       
                                          N
                                          p
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          N
                                          p
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                f
                                                ˆ
                                             
                                             i
                                          
                                          −
                                          
                                             f
                                             i
                                          
                                          )
                                       
                                       2
                                    
                                 
                              
                           
                        
                     where N
                     
                        p
                      is the number of processed image elements, and for i
                     =1, …, N
                     
                        p
                     , f
                     
                        i
                      and 
                        
                           
                              
                                 f
                                 ˆ
                              
                              i
                           
                        
                      are the intensity values of image elements of the images processed using Algorithms 1 and 2, respectively, with the same response function. It was found that every computed MSE is zero. In other words, the images processed using Algorithm 2 are correct in the sense that they are identical to the images processed by Algorithm 1.

To show the abilities of the multiscale selective enhancement filters for processing 2D and 3D images, a 2D and a 3D image and the images processed using the filters are shown in Figs. 1 and 2
                     
                     , respectively. The original 2D image shown in Fig. 1(a) contains the lung regions segmented from the slice with InstanceNumber 28 that belongs to the case with Subject ID LIDC-IDRI-0509. The original 3D image shown as maximum intensity projection (MIP) in Fig. 2(a) contains the lung regions segmented from the isotropic 3D image generated by re-sampling the 3D image that belongs to the case with Subject ID LIDC-IDRI-0009. Notice that because the images obtained by Algorithms 1 and 2 are identical, it is not necessary to distinguish which algorithm is used to process the images. Interested readers can refer to [12] for more examples and detailed information on selective enhancement filters.

The results concerning the numbers of image elements of 2D and 3D images whose corresponding Hessian eigenvalues were not computed are shown in Tables 3 and 4
                     
                     , respectively. In the two tables, N
                     
                        t
                      is the total number of processed image elements. N
                     
                        e,a
                      and N
                     
                        e,b
                      are the numbers of image elements whose corresponding Hessian eigenvalues were not computed owing to the use of Algorithm 2 and the algorithm in [17], respectively. Furthermore, r
                     
                        e,a
                      and r
                     
                        e,b
                      are the percentage reductions in the number of computations of Hessian eigenvalues owing to the use of Algorithm 2 and the algorithm in [17], respectively. These are computed, respectively, using
                        
                           (24)
                           
                              
                                 
                                    r
                                    
                                       e
                                       ,
                                       a
                                    
                                 
                                 =
                                 
                                    
                                       
                                          N
                                          
                                             e
                                             ,
                                             a
                                          
                                       
                                    
                                    
                                       
                                          N
                                          t
                                       
                                    
                                 
                                 ×
                                 100
                              
                           
                        
                     and
                        
                           (25)
                           
                              
                                 
                                    r
                                    
                                       e
                                       ,
                                       b
                                    
                                 
                                 =
                                 
                                    
                                       
                                          N
                                          
                                             e
                                             ,
                                             b
                                          
                                       
                                    
                                    
                                       
                                          N
                                          t
                                       
                                    
                                 
                                 ×
                                 100
                              
                           
                        
                     From the values of r
                     
                        e,a
                      in Tables 3 and 4, it is obvious that the proposed method can reduce significantly the number of computations of Hessian eigenvalues in applying Hessian-based enhancement filters. Moreover, the values of r
                     
                        e,a
                      and r
                     
                        e,b
                      corresponding to Φ
                        t3(x) in Table 4 show that the proposed method is superior to the method in [17] in reducing the number of computations of Hessian eigenvalues.

The times required for the filters to process the 2D and 3D images are shown in Tables 5 and 6
                     
                     , respectively. In the tables, r
                     
                        t,a
                      and r
                     
                        t,b
                      are the percentage reductions in processing time owing to the use of Algorithm 2 and the algorithm in [17], respectively. These are computed, respectively, using
                        
                           (26)
                           
                              
                                 
                                    r
                                    
                                       t
                                       ,
                                       a
                                    
                                 
                                 =
                                 
                                    
                                       
                                          t
                                          1
                                       
                                       −
                                       
                                          t
                                          a
                                       
                                    
                                    
                                       
                                          t
                                          1
                                       
                                    
                                 
                                 ×
                                 100
                              
                           
                        
                     and
                        
                           (27)
                           
                              
                                 
                                    r
                                    
                                       t
                                       ,
                                       b
                                    
                                 
                                 =
                                 
                                    
                                       
                                          t
                                          1
                                       
                                       −
                                       
                                          t
                                          b
                                       
                                    
                                    
                                       
                                          t
                                          1
                                       
                                    
                                 
                                 ×
                                 100
                              
                           
                        
                     where t
                     1, t
                     
                        a
                     , and t
                     
                        b
                      are the processing times required by Algorithms 1 and 2, and the algorithm in [17], respectively. The values of r
                     
                        t,a
                      in Tables 5 and 6 show that the proposed method can reduce the processing times of images significantly. Moreover, from the values of r
                     
                        t,a
                      and r
                     
                        t,b
                      corresponding to Φ
                        t3(x) in Table 6, it is obvious that the proposed method is faster than the method in [17].

@&#DISCUSSION@&#

This paper has presented a method for reducing the computational costs of Hessian-based enhancement filters for medical images. The computational costs of the filters are reduced by avoiding computation of the Hessian eigenvalues corresponding to image elements. Experiments were performed using the original and improved multiscale selective enhancement filters, as specified in Algorithms 1 and 2, to process 2D and 3D thoracic CT images. The results show that the proposed method can reduce significantly the number of computations of Hessian eigenvalues and the processing times of images.

As shown in the experimental results, the percentage reductions in processing time between Algorithms 1 and 2, shown as r
                     
                        t,a
                      in Tables 5 and 6, respectively, are not as great as the percentage reductions in the number of computations of Hessian eigenvalues, shown as r
                     
                        e,a
                      in Tables 3 and 4. The reason is two-fold. First, some computational costs are required for Theorems 3–7 to determine the satisfaction of the conditions in Eq. (4). In other words, the reduction in the number of computations of Hessian eigenvalues cannot contribute fully to the reduction in processing time. Second, additional computational costs arise when the theorem corresponding to a condition in Eq. (4) fails to determine that the condition is not satisfied, and the Hessian eigenvalues must still be computed to obtain the filter response, as can be seen from Steps 6 and 7 of Algorithm 2. Consequently, the additional computational costs lead to smaller percentage reductions in processing time.

From the experimental results, we can also observe that the values of r
                     
                        e,a
                      in Table 3 decrease according to the response functions used. More precisely, let r
                     
                        e,a,b2 and r
                     
                        e,a,t2 be the values of r
                     
                        e,a
                      corresponding to the response functions Φ
                        b2(x) and Φ
                        t2(x), respectively, in Table 3. Then, we can observe that r
                     
                        e,a,b2
                     >
                     r
                     
                        e,a,t2. The reason is simple. The conditions used in Φ
                        b2(x) and Φ
                        t2(x) are Ω
                     
                        Λ,b2 and Ω
                     
                        Λ,t2, respectively. It is obvious that Ω
                     
                        Λ,b2 is stricter than Ω
                     
                        Λ,t2. Therefore, there must be more image elements for which the condition Ω
                     
                        Λ,b2 is not satisfied. As a result, r
                     
                        e,a,b2 is greater than r
                     
                        e,a,t2. A similar result can be observed in Table 4 for a similar reason.

Before leaving this section, it is worth noticing that the proposed method is also applicable to response functions with more conditions and response functions with conditions combined with the logical operation OR. For response functions of the form
                        
                           (28)
                           
                              
                                 
                                    Φ
                                    n
                                 
                                 (
                                 
                                    x
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                      1
                                                   
                                                   (
                                                   Λ
                                                   )
                                                   ,
                                                    
                                                   if
                                                    
                                                   condition
                                                    
                                                   
                                                      Ω
                                                      
                                                         Λ
                                                         ,
                                                         1
                                                      
                                                   
                                                    
                                                   is
                                                    
                                                   satisfied
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                      2
                                                   
                                                   (
                                                   Λ
                                                   )
                                                   ,
                                                    
                                                   if
                                                    
                                                   condition
                                                    
                                                   
                                                      Ω
                                                      
                                                         Λ
                                                         ,
                                                         2
                                                      
                                                   
                                                    
                                                   is
                                                    
                                                   satisfied
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                      n
                                                   
                                                   (
                                                   Λ
                                                   )
                                                   ,
                                                    
                                                   if
                                                    
                                                   condition
                                                    
                                                   
                                                      Ω
                                                      
                                                         Λ
                                                         ,
                                                         n
                                                      
                                                   
                                                    
                                                   is
                                                    
                                                   satisfied
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                    
                                                    
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     it is easy, using the materials in Sections 3.1 and 3.2, to establish conditions to determine that all the conditions Ω
                     
                        Λ,1, …, Ω
                     
                        Λ,n
                      are unsatisfied without computing Hessian eigenvalues Λ. For example, consider the response function given in [8], which has the form
                        
                           (29)
                           
                              
                                 
                                    Φ
                                    2
                                 
                                 (
                                 
                                    x
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                      1
                                                   
                                                   (
                                                   Λ
                                                   )
                                                   ,
                                                    
                                                   if
                                                    
                                                   condition
                                                    
                                                   
                                                      Ω
                                                      
                                                         Λ
                                                         ,
                                                         1
                                                      
                                                   
                                                    
                                                   is
                                                    
                                                   satisfied
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                      2
                                                   
                                                   (
                                                   Λ
                                                   )
                                                   ,
                                                    
                                                   if
                                                    
                                                   condition
                                                    
                                                   
                                                      Ω
                                                      
                                                         Λ
                                                         ,
                                                         2
                                                      
                                                   
                                                   is
                                                    
                                                   satisfied
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                    
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where λ
                     1
                     >
                     λ
                     2
                     >
                     λ
                     3 and
                        
                           (30)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                Ω
                                                
                                                   Λ
                                                   ,
                                                   1
                                                
                                             
                                             :
                                             
                                                λ
                                                3
                                             
                                             <
                                             
                                                λ
                                                2
                                             
                                             <
                                             
                                                λ
                                                1
                                             
                                             ≤
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Ω
                                                
                                                   Λ
                                                   ,
                                                   2
                                                
                                             
                                             :
                                             
                                                λ
                                                3
                                             
                                             <
                                             
                                                λ
                                                2
                                             
                                             <
                                             0
                                             <
                                             
                                                λ
                                                1
                                             
                                             <
                                             
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                            2
                                                         
                                                      
                                                   
                                                
                                                α
                                             
                                             ,
                                             0
                                             <
                                             α
                                             ≤
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                     Obviously, both conditions Ω
                     
                        Λ,1 and Ω
                     
                        Λ,2 are unsatisfied if there are two or three positive Hessian eigenvalues. Therefore, it can be derived easily from Theorem 2 that both Ω
                     
                        Λ,1 and Ω
                     
                        Λ,2 are unsatisfied if one of the following conditions holds:
                        
                           (i)
                           
                              β
                              1
                              >0, β
                              3
                              >0 and β
                              1
                              β
                              2
                              <
                              β
                              3
                           


                              β
                              1
                              <0, β
                              3
                              <0 and β
                              1
                              β
                              2
                              <
                              β
                              3
                           

Response functions with conditions combined with the logical operation OR can be shown easily to be special cases of Φ
                        n
                     (x). Therefore, the proposed method can be applied. For example, the following response function
                        
                           (31)
                           
                              
                                 
                                    Φ
                                    
                                       OR
                                    
                                 
                                 (
                                 
                                    x
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ϕ
                                                   (
                                                   Λ
                                                   )
                                                   ,
                                                    
                                                   if
                                                    
                                                   condition
                                                    
                                                   
                                                      Ω
                                                      
                                                         Λ
                                                         ,
                                                         1
                                                      
                                                   
                                                    
                                                   OR
                                                    
                                                   
                                                      Ω
                                                      
                                                         Λ
                                                         ,
                                                         2
                                                      
                                                   
                                                    
                                                   is
                                                    
                                                   satisfied
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                    
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     is equivalent to
                        
                           (32)
                           
                              
                                 
                                    Φ
                                    
                                       OR
                                    
                                 
                                 (
                                 
                                    x
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ϕ
                                                   (
                                                   Λ
                                                   )
                                                   ,
                                                    
                                                   if
                                                    
                                                   condition
                                                    
                                                   
                                                      Ω
                                                      
                                                         Λ
                                                         ,
                                                         1
                                                      
                                                   
                                                    
                                                   is
                                                    
                                                   satisfied
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                   (
                                                   Λ
                                                   )
                                                   ,
                                                    
                                                   if
                                                    
                                                   condition
                                                    
                                                   
                                                      Ω
                                                      
                                                         Λ
                                                         ,
                                                         2
                                                      
                                                   
                                                    
                                                   is
                                                    
                                                   satisfied
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                    
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     which is obviously a special case of Φ
                        n
                     (x). Therefore, the proposed method is applicable.

@&#CONCLUSIONS@&#

This paper has presented a method for fast computation of Hessian-based enhancement filters for medical images. The computational costs of Hessian-based enhancement filters come mainly from the computation of Hessian eigenvalues to obtain filter responses. Theorems have been established to determine if the conditions in the response functions of the filters are not satisfied without having to compute Hessian eigenvalues. With the theorems, the filter responses can be obtained without computing Hessian eigenvalues. The computational costs of the filters can thus be reduced. Experiments were performed using the original and improved multiscale selective enhancement filters to process 2D and 3D thoracic CT images. The results show that the proposed method can reduce significantly the number of computations of Hessian eigenvalues and the processing time in applying Hessian-based enhancement filters to the processing of medical images.

None.

@&#REFERENCES@&#

