@&#MAIN-TITLE@&#Lifted Euclidean inequalities for the integer single node flow set with upper bounds

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We introduce the family of lifted Euclidean inequalities for an integer single node flow set


                        
                        
                           
                           We provide a polyhedral description of the convex hull of the feasible set


                        
                        
                           
                           We test the effectiveness of these inequalities in three mixed integer problems


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Valid inequalities

Mixed integer programming

Polyhedral description

Single node flow set

@&#ABSTRACT@&#


               
               
                  In this paper we discuss the polyhedral structure of the integer single node flow set with two possible values for the upper bounds on the arc flows. Such mixed integer sets arise as substructures in complex mixed integer programs for real application problems.
                  This work builds on results for the integer single node flow polytope with two arcs given by Agra and Constantino, 2006a. Valid inequalities are extended to a new family, the lifted Euclidean inequalities, and a complete description of the convex hull is given. All the coefficients of the facet-defining inequalities can be computed in polynomial time.
                  We report on some computational experimentations for three problems: an inventory distribution problem, a facility location problem and a multi-item production planning model.
               
            

@&#INTRODUCTION@&#

The description of the convex hull of elementary mixed integer sets has been useful in the generation of strong valid inequalities for general mixed integer problems. Particular cases of such elementary sets are the Single Node Flow (SNF) sets (see Fig. 1):

                        
                           
                              
                                 {
                                 
                                    (
                                    y
                                    ,
                                    x
                                    )
                                 
                                 ∈
                                 
                                    Z
                                    +
                                    
                                       ∣
                                       N
                                       ∣
                                    
                                 
                                 ×
                                 
                                    R
                                    
                                       ∣
                                       N
                                       ∣
                                    
                                 
                                 :
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                                 
                                    x
                                    t
                                 
                                 ≤
                                 
                                    (
                                    =
                                    )
                                 
                                 
                                    (
                                    ≥
                                    )
                                 
                                 D
                                 ,
                                 
                                    ℓ
                                    t
                                 
                                 
                                    y
                                    t
                                 
                                 ≤
                                 
                                    x
                                    t
                                 
                                 ≤
                                 
                                    u
                                    t
                                 
                                 
                                    y
                                    t
                                 
                                 ,
                                 t
                                 ∈
                                 N
                                 }
                                 .
                              
                           
                        
                     These sets are very common structures that occur after the aggregation of variables and/or constraints of more complex fixed charge capacitated network flow sets.

The single node flow sets have been studied for more than three decades. Padberg, Roy, and Wolsey (1985) studied the case where the yi
                      are binary and the ℓ
                        j
                      are null. They introduced the so called flow cover inequalities and showed this class of valid inequalities suffices to describe the convex hull of the feasible set when 
                        
                           
                              u
                              j
                           
                           =
                           U
                           ,
                           ∀
                           j
                           ∈
                           N
                        
                     . The binary case was also studied in Goemans (1985). Roy and Wolsey (1986) derived the so called generalized flow cover inequalities and Stallaert (1997) introduced a new class of valid inequalities by complementing binary variables. For a survey on valid inequalities for this and other related sets from the perspective of lifting see Louveaux & Wolsey, 2003. Special cases where considered by several authors. Constantino (1998) describes the convex hull of several related regions, in particular, the integer single node flow set with U a large positive constant, U > D. Agra and Constantino (2006b) provide a polyhedral characterization when 
                        
                           
                              ℓ
                              j
                           
                           =
                           L
                        
                      and 
                        
                           
                              u
                              j
                           
                           =
                           U
                        
                      for all j. In Agra and Doostmohammadi (2013) several inequalities are extended for the case where there is a set-up variable associated to the node itself.

In this paper we describe the convex hull of the integer SNF set with two possible values for the upper bounds on each arc capacity:

                        
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             (
                                             y
                                             ,
                                             x
                                             )
                                          
                                          ∈
                                          
                                             Z
                                             +
                                             
                                                ∣
                                                N
                                                ∣
                                             
                                          
                                          ×
                                          
                                             R
                                             
                                                ∣
                                                N
                                                ∣
                                             
                                          
                                          :
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                N
                                             
                                          
                                          
                                             x
                                             t
                                          
                                          ≤
                                          D
                                          ,
                                          0
                                          ≤
                                          
                                             x
                                             t
                                          
                                          ≤
                                          
                                             a
                                             1
                                          
                                          
                                             y
                                             t
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             N
                                             1
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             x
                                             t
                                          
                                          ≤
                                          
                                             a
                                             2
                                          
                                          
                                             y
                                             t
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             N
                                             2
                                          
                                          
                                             }
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     where {N
                     1, N
                     2} define a partition of N. We assume that the coefficients a
                     1, a
                     2 and D are positive integers and D > max {a
                     1, a
                     2}. While in the classical SNF set the y variables are binary, here they are assumed to be integer. Set 
                        X
                      arises as relaxation of several fixed charge capacitated network flow sets when arc capacities may assume one of the two possible values. See Section 4
for several applications.

The description of 
                        
                           P
                           =
                           c
                           o
                           n
                           v
                           (
                           X
                           )
                        
                      by linear inequalities is obtained from the description of integer single node flow set involving only two arcs,

                        
                           
                              
                                 
                                    
                                       Z
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             (
                                             
                                                y
                                                1
                                             
                                             ,
                                             
                                                y
                                                2
                                             
                                             ,
                                             
                                                x
                                                1
                                             
                                             ,
                                             
                                                x
                                                2
                                             
                                             )
                                          
                                          :
                                          
                                             x
                                             1
                                          
                                          +
                                          
                                             x
                                             2
                                          
                                          ≤
                                          D
                                          ,
                                          
                                          0
                                          ≤
                                          
                                             x
                                             1
                                          
                                          ≤
                                          
                                             a
                                             1
                                          
                                          
                                             y
                                             1
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             x
                                             2
                                          
                                          ≤
                                          
                                             a
                                             2
                                          
                                          
                                             y
                                             2
                                          
                                          ,
                                          
                                          
                                             y
                                             1
                                          
                                          ,
                                          
                                             y
                                             2
                                          
                                          
                                             
                                             integer
                                             }
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     given in Agra and Constantino (2006a). It has similarities with the description of the convex hull of the integer single node flow set with constant lower and upper bounds (Agra & Constantino, 2006b).

In Section 2 we summarize the results concerned with the description of the SNF problem with two arcs and, in Section 3 we introduce the lifted Euclidean inequalities to generalize those results for the SNF problem with two possible values for the upper bounds. Then, in Section 4 we test the inclusion of those inequalities in a branch and cut scheme to solve three mixed integer programs: an inventory-distribution problem, a facility location problem, and a lot-sizing multi-item problem.

The results in this section were published in Agra and Constantino (2006a).

First we consider the single node flow set with one arc, 
                        
                           {
                           
                              (
                              y
                              ,
                              x
                              )
                           
                           ∈
                           
                              Z
                              +
                           
                           ×
                           
                              R
                              +
                           
                           :
                           x
                           ≤
                           D
                           ,
                           x
                           ≤
                           a
                           y
                           }
                           .
                        
                      The convex hull of this set is completely described by the inequalities x ≥ 0, x ≤ ay, x ≤ D, and 
                        
                           x
                           −
                           γ
                           y
                           ≤
                           (
                           a
                           −
                           γ
                           )
                           ⌊
                           D
                           /
                           a
                           ⌋
                           ,
                        
                      where 
                        
                           γ
                           =
                           D
                           −
                           a
                           ⌊
                           D
                           /
                           a
                           ⌋
                           .
                        
                      The last inequality is the so-called Mixed Integer Rounding inequality (Nemhauser & Wolsey, 1988).

Next we consider the set with two arcs, 
                        
                           Z
                           .
                        
                      It is important to notice that there are only two integer variables involved in this model and so, for this particular structure, all the information needed to describe 
                        
                           c
                           o
                           n
                           v
                           (
                           Z
                           )
                        
                      can also be obtained from the 2-integer knapsack sets that result from the elimination of the continuous variables.

All the extreme points of 
                        
                           c
                           o
                           n
                           v
                           (
                           Z
                           )
                        
                      lie in the intersection of two of the following three hyperplanes defined by 
                        
                           
                              x
                              1
                           
                           =
                           
                              a
                              1
                           
                           
                              y
                              1
                           
                           ,
                        
                     
                     
                        
                           
                              x
                              2
                           
                           =
                           
                              a
                              2
                           
                           
                              y
                              2
                           
                        
                      and 
                        
                           
                              x
                              1
                           
                           +
                           
                              x
                              2
                           
                           =
                           D
                           .
                        
                      Thus, every extreme point of 
                        
                           c
                           o
                           n
                           v
                           (
                           Z
                           )
                        
                      has to satisfy one of the following set of conditions: (i) 
                        
                           
                              x
                              1
                           
                           =
                           
                              a
                              1
                           
                           
                              y
                              1
                           
                           ,
                        
                     
                     
                        
                           
                              x
                              2
                           
                           =
                           
                              a
                              2
                           
                           
                              y
                              2
                           
                           ,
                        
                      (ii) 
                        
                           
                              x
                              2
                           
                           =
                           
                              a
                              2
                           
                           
                              y
                              2
                           
                           ,
                        
                     
                     
                        
                           
                              x
                              1
                           
                           =
                           D
                           −
                           
                              x
                              2
                           
                           ,
                        
                      (iii) 
                        
                           
                              x
                              1
                           
                           =
                           
                              a
                              1
                           
                           
                              y
                              1
                           
                           ,
                        
                     
                     
                        
                           
                              x
                              2
                           
                           =
                           D
                           −
                           
                              x
                              1
                           
                           ,
                        
                     
                  

In case (i) we have 
                        
                           
                              (
                              
                                 y
                                 1
                              
                              ,
                              
                                 y
                                 2
                              
                              )
                           
                           ∈
                           
                              Y
                              ≤
                           
                        
                      where 
                        
                           
                              Y
                              ≤
                           
                           =
                           
                              {
                              
                                 (
                                 
                                    y
                                    1
                                 
                                 ,
                                 
                                    y
                                    2
                                 
                                 )
                              
                              ∈
                              
                                 Z
                                 +
                                 2
                              
                              :
                              
                                 a
                                 1
                              
                              
                                 y
                                 1
                              
                              +
                              
                                 a
                                 2
                              
                              
                                 y
                                 2
                              
                              ≤
                              D
                              }
                           
                           .
                        
                      In case (ii), noticing that 0 ≤ x
                     1 ≤ a
                     1
                     y
                     1 imply 
                        
                           0
                           ≤
                           D
                           −
                           
                              a
                              2
                           
                           
                              y
                              2
                           
                           ≤
                           
                              a
                              1
                           
                           
                              y
                              1
                           
                           ,
                        
                      we have 
                        
                           
                              (
                              
                                 y
                                 1
                              
                              ,
                              
                                 y
                                 2
                              
                              )
                           
                           ∈
                           
                              Y
                              1
                           
                        
                      where

                        
                           
                              
                                 
                                    Y
                                    1
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       
                                          y
                                          1
                                       
                                       ,
                                       
                                          y
                                          2
                                       
                                       )
                                    
                                    ∈
                                    
                                       Z
                                       +
                                       2
                                    
                                    :
                                    
                                       a
                                       1
                                    
                                    
                                       y
                                       1
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       y
                                       2
                                    
                                    ≥
                                    D
                                    ,
                                    
                                       y
                                       2
                                    
                                    ≤
                                    D
                                    /
                                    
                                       a
                                       2
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     Note that constraint y
                     2 ≤ D/a
                     2 is implied by the non-negativity constraint x
                     1 ≥ 0. Similarly, in case (iii) we have 
                        
                           
                              (
                              
                                 y
                                 1
                              
                              ,
                              
                                 y
                                 2
                              
                              )
                           
                           ∈
                           
                              Y
                              2
                           
                        
                      where

                        
                           
                              
                                 
                                    Y
                                    2
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       
                                          y
                                          1
                                       
                                       ,
                                       
                                          y
                                          2
                                       
                                       )
                                    
                                    ∈
                                    
                                       Z
                                       +
                                       2
                                    
                                    :
                                    
                                       a
                                       1
                                    
                                    
                                       y
                                       1
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       y
                                       2
                                    
                                    ≥
                                    D
                                    ,
                                    
                                       y
                                       1
                                    
                                    ≤
                                    D
                                    /
                                    
                                       a
                                       1
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     
                  

Let us define 
                        
                           
                              Y
                              
                                 1
                                 >
                              
                           
                           =
                           
                              Y
                              1
                           
                           ∖
                           
                              Y
                              =
                           
                        
                      and 
                        
                           
                              Y
                              
                                 2
                                 >
                              
                           
                           =
                           
                              Y
                              2
                           
                           ∖
                           
                              Y
                              =
                           
                        
                      where 
                        
                           
                              Y
                              =
                           
                           =
                           
                              {
                              
                                 (
                                 
                                    y
                                    1
                                 
                                 ,
                                 
                                    y
                                    2
                                 
                                 )
                              
                              ∈
                              
                                 Z
                                 +
                                 2
                              
                              :
                              
                                 a
                                 1
                              
                              
                                 y
                                 1
                              
                              +
                              
                                 a
                                 2
                              
                              
                                 y
                                 2
                              
                              =
                              D
                              }
                           
                           .
                        
                     
                  

In Agra and Constantino (2006a) it is shown that all the coefficients involved in the computation of the extreme points and facets of the two dimensional polyhedra 
                        
                           c
                           o
                           n
                           v
                           (
                           
                              Y
                              ≤
                           
                           )
                           ,
                        
                     
                     
                        
                           c
                           o
                           n
                           v
                           (
                           
                              Y
                              1
                           
                           )
                           ,
                        
                     
                     
                        
                           c
                           o
                           n
                           v
                           (
                           
                              Y
                              2
                           
                           )
                        
                      can be obtained in 
                        
                           O
                           (
                           l
                           o
                           g
                           
                              (
                              D
                              /
                              min
                              
                                 {
                                 
                                    a
                                    1
                                 
                                 ,
                                 
                                    a
                                    2
                                 
                                 }
                              
                              )
                           
                           )
                        
                      elementary operations using a version of the Hirschberg and Wong’s algorithm, (Hirschberg & Wong, 1976). This algorithm is based on the Euclidean Algorithm. Hence, the inequalities we describe next, and are based on these two dimensional polyhedra, are referred to as Euclidean inequalities.

First we consider the valid inequalities obtained from the lifting of facet-defining inequalities for 
                        
                           c
                           o
                           n
                           v
                           (
                           
                              Y
                              ≤
                           
                           )
                        
                      (corresponding to case (i)).

                        Proposition 2.1
                        
                           If
                           
                              
                                 
                                    α
                                    1
                                 
                                 
                                    y
                                    1
                                 
                                 +
                                 
                                    α
                                    2
                                 
                                 
                                    y
                                    2
                                 
                                 ≤
                                 α
                              
                            
                           is a valid facet-defining inequality for
                           
                              
                                 c
                                 o
                                 n
                                 v
                                 (
                                 
                                    Y
                                    ≤
                                 
                                 )
                              
                            
                           then the inequality
                           
                              
                                 (2.1)
                                 
                                    
                                       
                                          β
                                          1
                                       
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          −
                                          
                                             a
                                             1
                                          
                                          
                                             y
                                             1
                                          
                                          )
                                       
                                       +
                                       
                                          β
                                          2
                                       
                                       
                                          (
                                          
                                             x
                                             2
                                          
                                          −
                                          
                                             a
                                             2
                                          
                                          
                                             y
                                             2
                                          
                                          )
                                       
                                       +
                                       
                                          α
                                          1
                                       
                                       
                                          y
                                          1
                                       
                                       +
                                       
                                          α
                                          2
                                       
                                       
                                          y
                                          2
                                       
                                       ≤
                                       α
                                    
                                 
                              
                           
                           is a valid facet-defining inequality for
                           
                              
                                 c
                                 o
                                 n
                                 v
                                 (
                                 Z
                                 )
                                 ,
                              
                            
                           where
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                   1
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                max
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            α
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         +
                                                         
                                                            α
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                         −
                                                         α
                                                      
                                                      
                                                         
                                                            a
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         +
                                                         
                                                            a
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                         −
                                                         D
                                                      
                                                   
                                                   :
                                                   
                                                      (
                                                      
                                                         y
                                                         1
                                                      
                                                      ,
                                                      
                                                         y
                                                         2
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      Y
                                                      
                                                         1
                                                         >
                                                      
                                                   
                                                   }
                                                
                                                
                                                and
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                   2
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                max
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            α
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         +
                                                         
                                                            α
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                         −
                                                         α
                                                      
                                                      
                                                         
                                                            a
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         +
                                                         
                                                            a
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                         −
                                                         D
                                                      
                                                   
                                                   :
                                                   
                                                      (
                                                      
                                                         y
                                                         1
                                                      
                                                      ,
                                                      
                                                         y
                                                         2
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      Y
                                                      
                                                         2
                                                         >
                                                      
                                                   
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Next, from the lifting of the facet defining inequalities of 
                        
                           c
                           o
                           n
                           v
                           (
                           
                              Y
                              1
                           
                           )
                        
                      the following family of valid inequalities for 
                        
                           c
                           o
                           n
                           v
                           (
                           Z
                           )
                        
                      is obtained.

                        Proposition 2.2
                        
                           If
                           
                              
                                 
                                    α
                                    1
                                 
                                 
                                    y
                                    1
                                 
                                 +
                                 
                                    α
                                    2
                                 
                                 
                                    y
                                    2
                                 
                                 ≥
                                 α
                              
                            
                           is a valid facet-defining inequality for
                           
                              
                                 c
                                 o
                                 n
                                 v
                                 (
                                 
                                    Y
                                    1
                                 
                                 )
                              
                            
                           containing only points in
                           
                              
                                 Y
                                 
                                    1
                                    >
                                 
                              
                            
                           then the inequality
                           
                              
                                 (2.2)
                                 
                                    
                                       
                                          α
                                          1
                                       
                                       
                                          y
                                          1
                                       
                                       +
                                       
                                          α
                                          2
                                       
                                       
                                          y
                                          2
                                       
                                       ≥
                                       α
                                       +
                                       
                                          β
                                          1
                                       
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          +
                                          
                                             x
                                             2
                                          
                                          −
                                          D
                                          )
                                       
                                       +
                                       
                                          β
                                          2
                                       
                                       
                                          (
                                          
                                             x
                                             2
                                          
                                          −
                                          
                                             a
                                             2
                                          
                                          
                                             y
                                             2
                                          
                                          )
                                       
                                    
                                 
                              
                           
                           is a valid facet-defining inequality for
                           
                              
                                 c
                                 o
                                 n
                                 v
                                 (
                                 Z
                                 )
                                 ,
                              
                            
                           where
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                   1
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                max
                                                
                                                   {
                                                   
                                                      
                                                         α
                                                         −
                                                         
                                                            α
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         −
                                                         
                                                            α
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                      
                                                      
                                                         D
                                                         −
                                                         
                                                            a
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         −
                                                         
                                                            a
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                      
                                                   
                                                   :
                                                   
                                                      (
                                                      
                                                         y
                                                         1
                                                      
                                                      ,
                                                      
                                                         y
                                                         2
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      Y
                                                      <
                                                   
                                                   }
                                                
                                                
                                                and
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                β
                                                2
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                max
                                                
                                                   {
                                                   
                                                      
                                                         α
                                                         −
                                                         
                                                            α
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         −
                                                         
                                                            α
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            a
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         +
                                                         
                                                            a
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                         −
                                                         D
                                                      
                                                   
                                                   :
                                                   
                                                      (
                                                      
                                                         y
                                                         1
                                                      
                                                      ,
                                                      
                                                         y
                                                         2
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      Y
                                                      
                                                         2
                                                         >
                                                      
                                                   
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Finally we consider the lifting of the facet defining inequalities of 
                        
                           c
                           o
                           n
                           v
                           (
                           
                              Y
                              2
                           
                           )
                           .
                        
                     
                     
                        Proposition 2.3
                        
                           If
                           
                              
                                 
                                    α
                                    1
                                 
                                 
                                    y
                                    1
                                 
                                 +
                                 
                                    α
                                    2
                                 
                                 
                                    y
                                    2
                                 
                                 ≥
                                 α
                              
                            
                           is a valid facet-defining inequality for
                           
                              
                                 c
                                 o
                                 n
                                 v
                                 (
                                 
                                    Y
                                    2
                                 
                                 )
                              
                            
                           containing only points in
                           
                              
                                 Y
                                 
                                    2
                                    >
                                 
                              
                            
                           the inequality
                           
                              
                                 (2.3)
                                 
                                    
                                       
                                          α
                                          1
                                       
                                       
                                          y
                                          1
                                       
                                       +
                                       
                                          α
                                          2
                                       
                                       
                                          y
                                          2
                                       
                                       ≥
                                       α
                                       +
                                       
                                          β
                                          1
                                       
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          −
                                          
                                             a
                                             1
                                          
                                          
                                             y
                                             1
                                          
                                          )
                                       
                                       +
                                       
                                          β
                                          2
                                       
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          +
                                          
                                             x
                                             2
                                          
                                          −
                                          D
                                          )
                                       
                                    
                                 
                              
                           
                           is a valid facet-defining inequality for
                           
                              
                                 c
                                 o
                                 n
                                 v
                                 (
                                 Z
                                 )
                                 ,
                              
                            
                           where
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                   1
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                max
                                                
                                                   {
                                                   
                                                      
                                                         α
                                                         −
                                                         
                                                            α
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         −
                                                         
                                                            α
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            a
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         +
                                                         
                                                            a
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                         −
                                                         D
                                                      
                                                   
                                                   :
                                                   
                                                      (
                                                      
                                                         y
                                                         1
                                                      
                                                      ,
                                                      
                                                         y
                                                         2
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      Y
                                                      
                                                         1
                                                         >
                                                      
                                                   
                                                   }
                                                
                                                
                                                and
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                β
                                                2
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                max
                                                
                                                   {
                                                   
                                                      
                                                         α
                                                         −
                                                         
                                                            α
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         −
                                                         
                                                            α
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                      
                                                      
                                                         D
                                                         −
                                                         
                                                            a
                                                            1
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                         −
                                                         
                                                            a
                                                            2
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                      
                                                   
                                                   :
                                                   
                                                      (
                                                      
                                                         y
                                                         1
                                                      
                                                      ,
                                                      
                                                         y
                                                         2
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      Y
                                                      <
                                                   
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In Agra and Constantino (2006a) it is shown that the lifting coefficients β
                     1 and β
                     2 in each Euclidean inequality (2.1), (2.2), (2.3), can be obtained directly (in constant time) from the information required to derive the corresponding two-dimensional polyhedra 
                        
                           c
                           o
                           n
                           v
                           (
                           
                              Y
                              ≤
                           
                           )
                           ,
                        
                     
                     
                        
                           c
                           o
                           n
                           v
                           (
                           
                              Y
                              1
                           
                           )
                           ,
                        
                     
                     
                        
                           c
                           o
                           n
                           v
                           (
                           
                              Y
                              2
                           
                           )
                        
                     . So all the coefficients involved in the Euclidean inequalities can be obtained in 
                        
                           O
                           (
                           l
                           o
                           g
                           
                              (
                              D
                              /
                              min
                              
                                 {
                                 
                                    a
                                    1
                                 
                                 ,
                                 
                                    a
                                    2
                                 
                                 }
                              
                              )
                           
                           )
                        
                      elementary operations.

Now we consider two unbounded facet-defining inequalities that can be obtained by the MIR procedure.

                        Proposition 2.4
                        
                           The inequality
                           
                              
                                 (2.4)
                                 
                                    
                                       
                                          x
                                          t
                                       
                                       −
                                       
                                          γ
                                          t
                                       
                                       
                                          y
                                          t
                                       
                                       ≤
                                       
                                          (
                                          
                                             a
                                             t
                                          
                                          −
                                          
                                             γ
                                             t
                                          
                                          )
                                       
                                       
                                          ⌊
                                          D
                                          /
                                          
                                             a
                                             t
                                          
                                          ⌋
                                       
                                    
                                 
                              
                           
                           where
                           
                              
                                 
                                    γ
                                    t
                                 
                                 =
                                 D
                                 −
                                 
                                    a
                                    t
                                 
                                 
                                    ⌊
                                    D
                                    /
                                    
                                       a
                                       t
                                    
                                    ⌋
                                 
                                 ,
                              
                            
                           and t ∈ {1, 2}, is valid for
                           
                              
                                 Z
                                 .
                              
                           
                        


                           
                              (Agra and Constantino (2006a))
                           
                           
                              
                                 c
                                 o
                                 n
                                 v
                                 (
                                 Z
                                 )
                              
                            
                           is completely described by the trivial facet-defining inequalities and the families 
                           
                              (2.1)
                           
                           , 
                           
                              (2.2)
                           
                           , 
                           
                              (2.3)
                            
                           and 
                           
                              (2.4)
                           
                           .
                        

Consider the set, 
                              
                                 Z
                                 =
                                 {
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 ∈
                                 
                                    R
                                    +
                                    2
                                 
                                 ×
                                 
                                    Z
                                    +
                                    2
                                 
                                 :
                                 
                                    x
                                    1
                                 
                                 +
                                 
                                    x
                                    2
                                 
                                 ≤
                                 1154
                                 ,
                                 
                                 
                                    x
                                    1
                                 
                                 ≤
                                 21
                                 
                                    y
                                    1
                                 
                                 ,
                                 
                                 
                                    x
                                    2
                                 
                                 ≤
                                 76
                                 
                                    y
                                    2
                                 
                                 }
                              
                            and the following restrictions 
                              
                                 
                                    Y
                                    ≤
                                 
                                 =
                                 
                                    {
                                    y
                                    ∈
                                    
                                       Z
                                       +
                                       2
                                    
                                    :
                                    21
                                    
                                       y
                                       1
                                    
                                    +
                                    76
                                    
                                       y
                                       2
                                    
                                    ≤
                                    1154
                                    }
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    Y
                                    1
                                 
                                 =
                                 
                                    {
                                    y
                                    ∈
                                    
                                       Z
                                       +
                                       2
                                    
                                    :
                                    21
                                    
                                       y
                                       1
                                    
                                    +
                                    76
                                    
                                       y
                                       2
                                    
                                    ≥
                                    1154
                                    ,
                                    
                                       y
                                       2
                                    
                                    ≤
                                    15
                                    }
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    Y
                                    2
                                 
                                 =
                                 
                                    {
                                    y
                                    ∈
                                    
                                       Z
                                       +
                                       2
                                    
                                    :
                                    21
                                    
                                       y
                                       1
                                    
                                    +
                                    76
                                    
                                       y
                                       2
                                    
                                    ≥
                                    1154
                                    ,
                                    
                                       y
                                       1
                                    
                                    ≤
                                    54
                                    }
                                 
                                 .
                              
                            The polyhedral description of these sets was given in Agra and Constantino (2006a).


                           
                              
                                 c
                                 o
                                 n
                                 v
                                 
                                    (
                                    
                                       Y
                                       ≤
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    y
                                    ∈
                                    
                                       R
                                       +
                                       2
                                    
                                    :
                                    
                                       y
                                       1
                                    
                                    +
                                    3
                                    
                                       y
                                       2
                                    
                                    ≤
                                    54
                                    ,
                                    
                                    2
                                    
                                       y
                                       1
                                    
                                    +
                                    7
                                    
                                       y
                                       2
                                    
                                    ≤
                                    109
                                    ,
                                    
                                    5
                                    
                                       y
                                       1
                                    
                                    +
                                    18
                                    
                                       y
                                       2
                                    
                                    ≤
                                    274
                                    ,
                                    3
                                    
                                       y
                                       1
                                    
                                    +
                                    11
                                    
                                       y
                                       2
                                    
                                    ≤
                                    166
                                    ,
                                    
                                    
                                       y
                                       1
                                    
                                    +
                                    4
                                    
                                       y
                                       2
                                    
                                    ≤
                                    60
                                    }
                                 
                                 .
                              
                            From Proposition 2.1 we obtain the following facet-defining Euclidean inequalities.

                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                1
                                             
                                          
                                          
                                             +
                                          
                                          
                                             
                                                3
                                                
                                                   y
                                                   2
                                                
                                                +
                                                
                                                   1
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   −
                                                   21
                                                   
                                                      y
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                
                                                   1
                                                   14
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      2
                                                   
                                                   −
                                                   76
                                                   
                                                      y
                                                      2
                                                   
                                                   )
                                                
                                                ≤
                                                54
                                             
                                          
                                       
                                       
                                          
                                             
                                                2
                                                
                                                   y
                                                   1
                                                
                                             
                                          
                                          
                                             +
                                          
                                          
                                             
                                                7
                                                
                                                   y
                                                   2
                                                
                                                +
                                                
                                                   1
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   −
                                                   21
                                                   
                                                      y
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                
                                                   1
                                                   6
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      2
                                                   
                                                   −
                                                   76
                                                   
                                                      y
                                                      2
                                                   
                                                   )
                                                
                                                ≤
                                                109
                                             
                                          
                                       
                                       
                                          
                                             
                                                5
                                                
                                                   y
                                                   1
                                                
                                             
                                          
                                          
                                             +
                                          
                                          
                                             
                                                18
                                                
                                                   y
                                                   2
                                                
                                                +
                                                
                                                   1
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   −
                                                   21
                                                   
                                                      y
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                
                                                   1
                                                   3
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      2
                                                   
                                                   −
                                                   76
                                                   
                                                      y
                                                      2
                                                   
                                                   )
                                                
                                                ≤
                                                274
                                             
                                          
                                       
                                       
                                          
                                             
                                                3
                                                
                                                   y
                                                   1
                                                
                                             
                                          
                                          
                                             +
                                          
                                          
                                             
                                                11
                                                
                                                   y
                                                   2
                                                
                                                +
                                                
                                                   1
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   −
                                                   21
                                                   
                                                      y
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                
                                                   1
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      2
                                                   
                                                   −
                                                   76
                                                   
                                                      y
                                                      2
                                                   
                                                   )
                                                
                                                ≤
                                                166
                                             
                                          
                                       
                                       
                                          
                                             
                                                y
                                                1
                                             
                                          
                                          
                                             +
                                          
                                          
                                             
                                                4
                                                
                                                   y
                                                   2
                                                
                                                +
                                                
                                                   1
                                                   7
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   −
                                                   21
                                                   
                                                      y
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                
                                                   1
                                                   7
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      2
                                                   
                                                   −
                                                   76
                                                   
                                                      y
                                                      2
                                                   
                                                   )
                                                
                                                ≤
                                                60
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           
                              
                                 c
                                 o
                                 n
                                 v
                                 
                                    (
                                    
                                       Y
                                       1
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    y
                                    ∈
                                    
                                       R
                                       +
                                       2
                                    
                                    :
                                    8
                                    
                                       y
                                       1
                                    
                                    +
                                    29
                                    
                                       y
                                       2
                                    
                                    ≥
                                    440
                                    ,
                                    
                                    5
                                    
                                       y
                                       1
                                    
                                    +
                                    18
                                    
                                       y
                                       2
                                    
                                    ≥
                                    274
                                    ,
                                    
                                    2
                                    
                                       y
                                       1
                                    
                                    +
                                    7
                                    
                                       y
                                       2
                                    
                                    ≥
                                    107
                                    }
                                 
                                 .
                              
                            Only 
                              
                                 2
                                 
                                    y
                                    1
                                 
                                 +
                                 7
                                 
                                    y
                                    2
                                 
                                 ≥
                                 107
                              
                            defines a non-trivial facet that includes only points in 
                              
                                 
                                    Y
                                    
                                       1
                                       >
                                    
                                 
                                 .
                              
                            Based on that inequality we obtain:

                              
                                 
                                    
                                       2
                                       
                                          y
                                          1
                                       
                                       +
                                       7
                                       
                                          y
                                          2
                                       
                                       ≥
                                       107
                                       +
                                       
                                          1
                                          6
                                       
                                       
                                          (
                                          
                                             x
                                             1
                                          
                                          +
                                          
                                             x
                                             2
                                          
                                          −
                                          D
                                          )
                                       
                                       +
                                       0
                                       
                                          (
                                          
                                             x
                                             2
                                          
                                          −
                                          76
                                          
                                             y
                                             2
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        


                           
                              
                                 c
                                 o
                                 n
                                 v
                                 
                                    (
                                    
                                       Y
                                       2
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    y
                                    ∈
                                    
                                       R
                                       +
                                       2
                                    
                                    :
                                    
                                       y
                                       2
                                    
                                    ≥
                                    1
                                    ,
                                    
                                    
                                       y
                                       1
                                    
                                    +
                                    4
                                    
                                       y
                                       2
                                    
                                    ≥
                                    56
                                    ,
                                    
                                    3
                                    
                                       y
                                       1
                                    
                                    +
                                    11
                                    
                                       y
                                       2
                                    
                                    ≥
                                    166
                                    ,
                                    
                                    5
                                    
                                       y
                                       1
                                    
                                    +
                                    18
                                    
                                       y
                                       2
                                    
                                    ≥
                                    274
                                    ,
                                    
                                    2
                                    
                                       y
                                       1
                                    
                                    +
                                    7
                                    
                                       y
                                       2
                                    
                                    ≥
                                    107
                                    ,
                                    
                                    
                                       y
                                       1
                                    
                                    +
                                    
                                       y
                                       2
                                    
                                    ≥
                                    16
                                    }
                                 
                                 .
                              
                            Based on these inequalities we derive the following set of facet-defining Euclidean inequalities for 
                              
                                 c
                                 o
                                 n
                                 v
                                 (
                                 Z
                                 )
                                 :
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   2
                                                
                                                ≥
                                                1
                                                +
                                                
                                                   1
                                                   20
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   
                                                      x
                                                      2
                                                   
                                                   −
                                                   1154
                                                   )
                                                
                                                +
                                                
                                                   1
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   −
                                                   21
                                                   
                                                      y
                                                      1
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                   1
                                                
                                                +
                                                4
                                                
                                                   y
                                                   2
                                                
                                                ≥
                                                56
                                                +
                                                
                                                   1
                                                   7
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   
                                                      x
                                                      2
                                                   
                                                   −
                                                   1154
                                                   )
                                                
                                                +
                                                
                                                   1
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   −
                                                   21
                                                   
                                                      y
                                                      1
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                2
                                                
                                                   y
                                                   1
                                                
                                                +
                                                7
                                                
                                                   y
                                                   2
                                                
                                                ≥
                                                107
                                                +
                                                
                                                   1
                                                   6
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   
                                                      x
                                                      2
                                                   
                                                   −
                                                   1154
                                                   )
                                                
                                                +
                                                0
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   −
                                                   21
                                                   
                                                      y
                                                      1
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                   1
                                                
                                                +
                                                
                                                   y
                                                   2
                                                
                                                ≥
                                                16
                                                +
                                                
                                                   1
                                                   14
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   
                                                      x
                                                      2
                                                   
                                                   −
                                                   1154
                                                   )
                                                
                                                +
                                                0
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   −
                                                   21
                                                   
                                                      y
                                                      1
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In this section we give a description of 
                        
                           P
                           =
                           c
                           o
                           n
                           v
                           (
                           X
                           )
                        
                      by linear inequalities.

The following main result uses the fact that we are dealing with integer (not binary) variables. It establishes the link between sets with dimension determined by the number of different coefficients with sets in higher dimensions.

                           Lemma 3.1
                           
                              Consider nonempty sets
                              
                                 
                                    
                                       S
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       S
                                       k
                                    
                                    ,
                                 
                               
                              with Si
                               ⊂ N
                              1, 
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    k
                                    }
                                    ,
                                 
                               
                              and
                              
                                 
                                    
                                       S
                                       i
                                    
                                    ∩
                                    
                                       S
                                       j
                                    
                                    =
                                    ∅
                                    ,
                                 
                               
                              for all
                              
                                 
                                    i
                                    ,
                                    j
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    k
                                    }
                                    ,
                                 
                               
                              such that i ≠ j. Consider nonempty sets
                              
                                 
                                    
                                       S
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       S
                                       p
                                    
                                    ,
                                 
                               
                              with Si
                               ⊂ N
                              2, 
                                 
                                    i
                                    ∈
                                    {
                                    k
                                    +
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                    }
                                    ,
                                 
                               
                              and
                              
                                 
                                    
                                       S
                                       i
                                    
                                    ∩
                                    
                                       S
                                       j
                                    
                                    =
                                    ∅
                                    ,
                                 
                               
                              for all
                              
                                 
                                    i
                                    ,
                                    j
                                    ∈
                                    {
                                    k
                                    +
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                    }
                                    ,
                                 
                               
                              such that i ≠ j. Consider the set
                              
                                 
                                    
                                       
                                          
                                             Σ
                                             
                                                {
                                                k
                                                ,
                                                p
                                                }
                                             
                                          
                                          
                                             =
                                             {
                                          
                                          
                                             (
                                             
                                                Y
                                                1
                                             
                                             ,
                                             …
                                             ,
                                             
                                                Y
                                                p
                                             
                                             ,
                                             
                                                X
                                                1
                                             
                                             ,
                                             …
                                             ,
                                             
                                                X
                                                p
                                             
                                             )
                                          
                                          ∈
                                          
                                             Z
                                             +
                                             p
                                          
                                          ×
                                          
                                             R
                                             p
                                          
                                          :
                                          
                                             ∑
                                             
                                                t
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             X
                                             t
                                          
                                          ≤
                                          D
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          0
                                          ≤
                                          
                                             X
                                             t
                                          
                                          ≤
                                          
                                             a
                                             1
                                          
                                          
                                             Y
                                             t
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             k
                                             }
                                          
                                          ,
                                          0
                                          ≤
                                          
                                             X
                                             t
                                          
                                          ≤
                                          
                                             a
                                             2
                                          
                                          
                                             Y
                                             t
                                          
                                          
                                             ,
                                             t
                                             ∈
                                             
                                                {
                                                k
                                                +
                                                1
                                                ,
                                                …
                                                ,
                                                p
                                                }
                                             
                                             }
                                             .
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (i)
                                    The inequality

                                          
                                             (3.1)
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      p
                                                   
                                                   
                                                      α
                                                      t
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            S
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      p
                                                   
                                                   
                                                      β
                                                      t
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            S
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      x
                                                      j
                                                   
                                                   ≤
                                                   α
                                                
                                             
                                          
                                       is valid for 
                                          X
                                        iff

                                          
                                             (3.2)
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      p
                                                   
                                                   
                                                      α
                                                      t
                                                   
                                                   
                                                      Y
                                                      t
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      p
                                                   
                                                   
                                                      β
                                                      t
                                                   
                                                   
                                                      X
                                                      t
                                                   
                                                   ≤
                                                   α
                                                
                                             
                                          
                                       is valid for Σ
                                       {k, p}.

If (3.1) and (3.2) are valid for 
                                          X
                                        and Σ
                                       {k, p}, respectively, then (3.1) defines a facet of 
                                          P
                                        iff (3.2) defines a facet of conv(Σ
                                       {k, p}).

Since (i) can be easily checked, we only show (ii). We assume that (3.1) and (3.2) are valid for 
                                 X
                               and Σ
                              {k, p}, respectively. Suppose (3.1) defines a facet, 
                                 
                                    F
                                    ,
                                 
                               of 
                                 P
                               and (3.2) does not define a facet of conv(Σ
                              {k, p}). Let 
                                 
                                    
                                       F
                                    
                                    a
                                 
                               be the face of conv(Σ
                              {k, p}) defined by (3.2). Since 
                                 
                                    
                                       F
                                    
                                    a
                                 
                               is not a facet of conv(Σ
                              {k, p}) there must exist a valid inequality, which is not a multiple of (3.2) (observe that both polyhedra are full dimensional), for conv(Σ
                              {k, p}), 
                                 
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       α
                                       t
                                       ′
                                    
                                    
                                       Y
                                       t
                                    
                                    +
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       β
                                       t
                                       ′
                                    
                                    
                                       X
                                       t
                                    
                                    ≤
                                    
                                       α
                                       ′
                                    
                                 
                               satisfied as equation by every point in 
                                 
                                    
                                       
                                          F
                                       
                                       a
                                    
                                    .
                                 
                               Hence 
                                 
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       α
                                       t
                                       ′
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             S
                                             t
                                          
                                       
                                    
                                    
                                       y
                                       j
                                    
                                    +
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       β
                                       t
                                       ′
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             S
                                             t
                                          
                                       
                                    
                                    
                                       x
                                       j
                                    
                                    ≤
                                    
                                       α
                                       ′
                                    
                                 
                               is not a multiple of (3.1), and, by (i), is valid for 
                                 
                                    P
                                    .
                                 
                               In order to obtain a contradiction, it suffices to prove that each point in 
                                 F
                               also satisfies this inequality as equation. Suppose not, that is, there is 
                                 
                                    (
                                    
                                       y
                                       ′
                                    
                                    ,
                                    
                                       x
                                       ′
                                    
                                    )
                                    ∈
                                    F
                                 
                               satisfying 
                                 
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       α
                                       t
                                       ′
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             S
                                             t
                                          
                                       
                                    
                                    
                                       y
                                       j
                                    
                                    +
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       β
                                       t
                                       ′
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             S
                                             t
                                          
                                       
                                    
                                    
                                       x
                                       j
                                    
                                    <
                                    
                                       α
                                       ′
                                    
                                    .
                                 
                               Then a contradiction is obtained by considering the point 
                                 
                                    
                                       (
                                       
                                          Y
                                          ′
                                       
                                       ,
                                       
                                          X
                                          ′
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             
                                                S
                                                1
                                             
                                          
                                       
                                       
                                          y
                                          j
                                          ′
                                       
                                       ,
                                       …
                                       ,
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             
                                                S
                                                p
                                             
                                          
                                       
                                       
                                          y
                                          j
                                          ′
                                       
                                       ,
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             
                                                S
                                                1
                                             
                                          
                                       
                                       
                                          x
                                          j
                                          ′
                                       
                                       ,
                                       …
                                       ,
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             
                                                S
                                                p
                                             
                                          
                                       
                                       
                                          x
                                          j
                                          ′
                                       
                                       )
                                    
                                 
                               that belongs to 
                                 
                                    
                                       F
                                    
                                    a
                                 
                               and verifies 
                                 
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       α
                                       t
                                       ′
                                    
                                    
                                       Y
                                       t
                                       ′
                                    
                                    +
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       β
                                       t
                                       ′
                                    
                                    
                                       X
                                       t
                                       ′
                                    
                                    <
                                    
                                       α
                                       ′
                                    
                                    .
                                 
                              
                           

Now, suppose (3.2) defines a facet of conv(Σ
                              {k, p}) and let 
                                 F
                               be the face defined by (3.1). Consider a generic facet for 
                                 P
                               defined by

                                 
                                    (3.3)
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                N
                                             
                                          
                                          
                                             μ
                                             j
                                          
                                          
                                             y
                                             j
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                N
                                             
                                          
                                          
                                             ν
                                             j
                                          
                                          
                                             x
                                             j
                                          
                                          ≤
                                          π
                                       
                                    
                                 
                              containing 
                                 
                                    F
                                    .
                                 
                               We will show that (3.3) is a multiple of (3.1).

Since both polyhedra are full dimensional, the facet of conv(Σ
                              {k, p}) defined by (3.2) must contain 2p affinely independent points, 
                                 
                                    (
                                    
                                       Y
                                       j
                                    
                                    ,
                                    
                                       X
                                       j
                                    
                                    )
                                    ,
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    2
                                    p
                                    .
                                 
                               Construct 2p points in 
                                 
                                    F
                                    ,
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       j
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       j
                                    
                                    )
                                 
                               as follows: For each 
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                    }
                                    ,
                                 
                               set 
                                 
                                    
                                       
                                          y
                                          ¯
                                       
                                       t
                                       j
                                    
                                    =
                                    
                                       Y
                                       i
                                       j
                                    
                                 
                               and 
                                 
                                    
                                       
                                          x
                                          ¯
                                       
                                       t
                                       j
                                    
                                    =
                                    
                                       X
                                       i
                                       j
                                    
                                 
                               for 
                                 
                                    t
                                    =
                                    
                                       t
                                       i
                                    
                                    =
                                    a
                                    r
                                    g
                                    m
                                    i
                                    n
                                    
                                       {
                                       j
                                       ∈
                                       
                                          S
                                          i
                                       
                                       }
                                    
                                 
                               and 
                                 
                                    
                                       
                                          y
                                          ¯
                                       
                                       t
                                       j
                                    
                                    =
                                    
                                       
                                          x
                                          ¯
                                       
                                       t
                                       j
                                    
                                    =
                                    0
                                    ,
                                 
                               otherwise.

Consider the point 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       1
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       1
                                    
                                    )
                                    ,
                                 
                               and for each t ∈ N∖S, with 
                                 
                                    S
                                    =
                                    
                                       ⋃
                                       
                                          i
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       S
                                       i
                                    
                                    ,
                                 
                               consider the point (yt, xt
                              ) belonging to 
                                 
                                    F
                                    ,
                                 
                               where (yt, xt
                              ) coincides with 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       1
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       1
                                    
                                    )
                                 
                               for all coordinates except for 
                                 
                                    
                                       y
                                       i
                                       t
                                    
                                    =
                                    1
                                 
                               when 
                                 
                                    i
                                    =
                                    t
                                    .
                                 
                               As 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       1
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       1
                                    
                                    )
                                 
                               and (yt, xt
                              ), satisfy (3.3) as equation, it follows that 
                                 
                                    
                                       μ
                                       t
                                    
                                    =
                                    0
                                    .
                                 
                               Hence we have 
                                 
                                    
                                       μ
                                       t
                                    
                                    =
                                    0
                                    ,
                                    ∀
                                    t
                                    ∈
                                    N
                                    ∖
                                    S
                                    .
                                 
                              
                           

We assume 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       1
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       1
                                    
                                    )
                                 
                               satisfies 
                                 
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                    
                                       
                                          x
                                          ¯
                                       
                                       k
                                       1
                                    
                                    <
                                    D
                                    .
                                 
                               Next, consider the point 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       1
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       1
                                    
                                    )
                                 
                               and for each t ∈ N∖S, consider (y′
                                 t
                              , x′
                                 t
                              ) belonging to 
                                 F
                               where (y′
                                 t
                              , x′
                                 t
                              ) coincides with 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       1
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       1
                                    
                                    )
                                 
                               for all coordinates except for 
                                 
                                    
                                       y
                                       i
                                       
                                          ′
                                          t
                                       
                                    
                                    =
                                    1
                                    ,
                                    
                                       x
                                       i
                                       
                                          ′
                                          t
                                       
                                    
                                    =
                                    ϵ
                                 
                               when 
                                 
                                    i
                                    =
                                    t
                                    ,
                                 
                               where t ∈ N∖S, and 
                                 
                                    0
                                    <
                                    ϵ
                                    <
                                    min
                                    {
                                    
                                       a
                                       1
                                    
                                    ,
                                    
                                       a
                                       2
                                    
                                    ,
                                    D
                                    −
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    
                                       
                                          x
                                          ¯
                                       
                                       j
                                       1
                                    
                                    }
                                    .
                                 
                               As 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       1
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       1
                                    
                                    )
                                 
                               and (y′
                                 t
                              , x′
                                 t
                              ), satisfy (3.3) as equation, it follows that 
                                 
                                    
                                       ν
                                       t
                                    
                                    =
                                    0
                                    ,
                                    ∀
                                    t
                                    ∈
                                    N
                                    ∖
                                    S
                                    .
                                 
                              
                           

For each 
                                 
                                    t
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                    }
                                    ,
                                 
                               consider two affinely independent points (Ya, Xa
                              ), (Yb, Xb
                              ) with 
                                 
                                    
                                       Y
                                       t
                                       a
                                    
                                    >
                                    0
                                    ,
                                    
                                       Y
                                       t
                                       b
                                    
                                    >
                                    0
                                 
                               and assume that 
                                 
                                    
                                       (
                                       
                                          Y
                                          t
                                          a
                                       
                                       ,
                                       
                                          X
                                          t
                                          a
                                       
                                       )
                                    
                                    ,
                                    
                                       (
                                       
                                          Y
                                          t
                                          b
                                       
                                       ,
                                       
                                          X
                                          t
                                          b
                                       
                                       )
                                    
                                 
                               are affinely independent (observe that such two points must exist since (3.2) defines a facet). As before, define 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       a
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       a
                                    
                                    )
                                 
                               and 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       b
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       b
                                    
                                    )
                                 
                               as follows: for each 
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                    }
                                    ,
                                 
                               set 
                                 
                                    
                                       
                                          y
                                          ¯
                                       
                                       t
                                       a
                                    
                                    =
                                    
                                       Y
                                       i
                                       a
                                    
                                 
                               and 
                                 
                                    
                                       
                                          x
                                          ¯
                                       
                                       t
                                       a
                                    
                                    =
                                    
                                       X
                                       i
                                       a
                                    
                                 
                               for 
                                 
                                    t
                                    =
                                    
                                       t
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       
                                          y
                                          ¯
                                       
                                       t
                                       j
                                    
                                    =
                                    
                                       
                                          x
                                          ¯
                                       
                                       t
                                       j
                                    
                                    =
                                    0
                                    ,
                                 
                               otherwise. Similarly for 
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       b
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       b
                                    
                                    )
                                    .
                                 
                              
                           

Now, for each 
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                    }
                                    ,
                                 
                               and each k ∈ Si
                              ∖{ti
                              } we construct two points (y′
                                 a
                              , x′
                                 a
                              ) and (y′
                                 b
                              , x′
                                 b
                              ) in 
                                 
                                    F
                                    ,
                                 
                               such that 
                                 
                                    
                                       y
                                       t
                                       
                                          ′
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          y
                                          ¯
                                       
                                       t
                                       a
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       t
                                       
                                          ′
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          x
                                          ¯
                                       
                                       t
                                       a
                                    
                                    ,
                                 
                               for t ≠ ti
                               and t ≠ k, and 
                                 
                                    
                                       y
                                       
                                          t
                                          i
                                       
                                       
                                          ′
                                          a
                                       
                                    
                                    =
                                    
                                       x
                                       
                                          t
                                          i
                                       
                                       
                                          ′
                                          a
                                       
                                    
                                    =
                                    0
                                 
                               and 
                                 
                                    
                                       y
                                       k
                                       
                                          ′
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          y
                                          ¯
                                       
                                       
                                          t
                                          i
                                       
                                       a
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       k
                                       
                                          ′
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          x
                                          ¯
                                       
                                       
                                          t
                                          i
                                       
                                       a
                                    
                                    .
                                 
                               Point (y′
                                 b
                              , x′
                                 b
                              ) is constructed similarly. Using these points we obtain 
                                 
                                    
                                       μ
                                       i
                                    
                                    =
                                    
                                       
                                          α
                                          ¯
                                       
                                       t
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       ν
                                       i
                                    
                                    =
                                    
                                       
                                          β
                                          ¯
                                       
                                       t
                                    
                                    ,
                                    ∀
                                    i
                                    ∈
                                    
                                       S
                                       t
                                    
                                    ,
                                    t
                                    ∈
                                    
                                       {
                                       1
                                       ,
                                       2
                                       }
                                    
                                    .
                                 
                              
                           

Finally, since the 2p points in 
                                 
                                    F
                                    ,
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          y
                                          ¯
                                       
                                       j
                                    
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       j
                                    
                                    )
                                    ,
                                 
                               are affinely independent (as all its non-null components coincide with the non-null components of the affinely independent points (Yj, Xj
                              )), then we conclude that (3.3) must be a multiple of (3.1).□


                        Lemma 3.1 states that from each facet defining inequality of 
                           
                              c
                              o
                              n
                              v
                              (
                              Z
                              )
                           
                         we obtain facet defining inequalities for 
                           
                              P
                              .
                           
                        
                        
                           Corollary 3.2
                           
                              The inequality
                              
                                 
                                    (3.4)
                                    
                                       
                                          
                                             α
                                             1
                                          
                                          
                                             y
                                             1
                                          
                                          +
                                          
                                             α
                                             2
                                          
                                          
                                             y
                                             2
                                          
                                          +
                                          
                                             β
                                             1
                                          
                                          
                                             x
                                             1
                                          
                                          +
                                          
                                             β
                                             2
                                          
                                          
                                             x
                                             2
                                          
                                          ≤
                                          α
                                       
                                    
                                 
                              
                              defines a facet of
                              
                                 
                                    c
                                    o
                                    n
                                    v
                                    (
                                    Z
                                    )
                                 
                               
                              if and only if
                              
                                 
                                    (3.5)
                                    
                                       
                                          
                                             α
                                             1
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   S
                                                   1
                                                
                                             
                                          
                                          
                                             y
                                             j
                                          
                                          +
                                          
                                             α
                                             2
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   S
                                                   2
                                                
                                             
                                          
                                          
                                             y
                                             j
                                          
                                          +
                                          
                                             β
                                             1
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   S
                                                   1
                                                
                                             
                                          
                                          
                                             x
                                             j
                                          
                                          +
                                          
                                             β
                                             2
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   S
                                                   2
                                                
                                             
                                          
                                          
                                             x
                                             j
                                          
                                          ≤
                                          α
                                          .
                                       
                                    
                                 
                              
                              defines a facet for
                              
                                 P
                               
                              for all ∅ ≠ S
                              1⊆N
                              1, ∅ ≠ S
                              2⊆N
                              2.

In this section we present the families of valid inequalities necessary for the description of 
                           P
                         that cannot be obtained directly from the aggregated model 
                           
                              Z
                              .
                           
                        
                     

The following family of valid inequalities is necessary when the equation 
                           
                              
                                 a
                                 1
                              
                              
                                 Y
                                 1
                              
                              +
                              
                                 a
                                 2
                              
                              
                                 Y
                                 2
                              
                              =
                              D
                           
                         has no nonnegative integer solutions.

                           Proposition 3.3
                           
                              Let
                              
                                 
                                    γ
                                    =
                                    D
                                    −
                                    max
                                    {
                                    
                                       a
                                       1
                                    
                                    
                                       Y
                                       1
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       Y
                                       2
                                    
                                    :
                                    
                                       (
                                       
                                          Y
                                          1
                                       
                                       ,
                                       
                                          Y
                                          2
                                       
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       ≤
                                    
                                    }
                                    ,
                                 
                              
                              
                                 
                                    
                                       ϵ
                                       1
                                    
                                    =
                                    m
                                    i
                                    n
                                    
                                       {
                                       
                                          a
                                          1
                                       
                                       
                                          Y
                                          1
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          Y
                                          2
                                       
                                       :
                                       
                                          (
                                          
                                             Y
                                             1
                                          
                                          ,
                                          
                                             Y
                                             2
                                          
                                          )
                                       
                                       ∈
                                       
                                          Y
                                          1
                                       
                                       }
                                    
                                    −
                                    D
                                    ,
                                 
                               
                              and
                              
                                 
                                    
                                       ϵ
                                       2
                                    
                                    =
                                    m
                                    i
                                    n
                                    
                                       {
                                       
                                          a
                                          1
                                       
                                       
                                          Y
                                          1
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          Y
                                          2
                                       
                                       :
                                       
                                          (
                                          
                                             Y
                                             1
                                          
                                          ,
                                          
                                             Y
                                             2
                                          
                                          )
                                       
                                       ∈
                                       
                                          Y
                                          2
                                       
                                       }
                                    
                                    −
                                    D
                                    .
                                 
                               
                              If γ > 0, then the following inequality is valid for
                              
                                 
                                    X
                                    ,
                                 
                              
                              
                                 
                                    (3.6)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      a
                                                      1
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            S
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                   +
                                                   
                                                      a
                                                      2
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            S
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                   +
                                                   
                                                      
                                                         γ
                                                         +
                                                         
                                                            ϵ
                                                            1
                                                         
                                                      
                                                      
                                                         ϵ
                                                         1
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            S
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         j
                                                      
                                                      −
                                                      
                                                         a
                                                         1
                                                      
                                                      
                                                         y
                                                         j
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   +
                                                   
                                                   
                                                      
                                                         γ
                                                         +
                                                         
                                                            ϵ
                                                            2
                                                         
                                                      
                                                      
                                                         ϵ
                                                         2
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            S
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         j
                                                      
                                                      −
                                                      
                                                         a
                                                         2
                                                      
                                                      
                                                         y
                                                         j
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         N
                                                         ∖
                                                         (
                                                         
                                                            S
                                                            1
                                                         
                                                         ∪
                                                         
                                                            S
                                                            2
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         j
                                                      
                                                      −
                                                      γ
                                                      
                                                         y
                                                         j
                                                      
                                                      )
                                                   
                                                   ≤
                                                   D
                                                   −
                                                   γ
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where S
                              1 ⊂ N
                              1 
                              and S
                              2 ⊂ N
                              2.

Observe that γ > 0 implies ϵ1 > 0 and ϵ2 > 0. Conversely, the two conditions ϵ1 > 0, ϵ2 > 0 imply γ > 0. The proof of Proposition 3.3 is left to the Appendix.

Next we explain how to obtain facet-defining inequalities from lifting of the Euclidean inequalities. For ease of notation, for a subset S we will denote by 
                           
                              X
                              
                                 (
                                 S
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    j
                                    ∈
                                    S
                                 
                              
                              
                                 x
                                 j
                              
                           
                         and 
                           
                              Y
                              
                                 (
                                 S
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    j
                                    ∈
                                    S
                                 
                              
                              
                                 y
                                 j
                              
                              .
                           
                        
                     

Let Λ denote the set of the coefficients of all Euclidean facet-defining inequalities of types (2.1), (2.2), (2.3): 
                           
                              Λ
                              =
                              {
                              
                                 (
                                 
                                    μ
                                    1
                                 
                                 ,
                                 
                                    μ
                                    2
                                 
                                 ,
                                 
                                    ν
                                    1
                                 
                                 ,
                                 
                                    ν
                                    2
                                 
                                 ,
                                 λ
                                 )
                              
                              :
                              
                                 μ
                                 1
                              
                              
                                 y
                                 1
                              
                              +
                              
                                 μ
                                 2
                              
                              
                                 y
                                 2
                              
                              +
                              
                                 ν
                                 1
                              
                              
                                 x
                                 1
                              
                              +
                              
                                 ν
                                 2
                              
                              
                                 x
                                 2
                              
                              ≤
                              λ
                           
                         is a facet-defining inequality of one of the types (2.1), (2.2), (2.3) for Z}.

Consider an inequality for the restriction of 
                           X
                         to S
                        1 ∪ S
                        2, S
                        1⊆N
                        1, S
                        2⊆N
                        2, obtained from the Euclidean inequality defined by (μ
                        1, μ
                        2, ν
                        1, ν
                        2, λ) ∈ Λ:

                           
                              (3.7)
                              
                                 
                                    
                                       μ
                                       1
                                    
                                    Y
                                    
                                       (
                                       
                                          S
                                          1
                                       
                                       )
                                    
                                    +
                                    
                                       μ
                                       2
                                    
                                    Y
                                    
                                       (
                                       
                                          S
                                          2
                                       
                                       )
                                    
                                    +
                                    
                                       ν
                                       1
                                    
                                    X
                                    
                                       (
                                       
                                          S
                                          1
                                       
                                       )
                                    
                                    +
                                    
                                       ν
                                       2
                                    
                                    X
                                    
                                       (
                                       
                                          S
                                          2
                                       
                                       )
                                    
                                    ≤
                                    λ
                                    .
                                 
                              
                           
                        
                     

From Lemma 3.1 it follows that (3.7) defines a facet of the restricted set resulting from X by considering only the subset of variables in S
                        1⊆N
                        1 and S
                        2⊆N
                        2.

We assume henceforward 
                           
                              
                                 
                                    
                                       
                                          μ
                                          2
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          ν
                                          2
                                       
                                    
                                    
                                       
                                          μ
                                          1
                                       
                                       +
                                       
                                          a
                                          1
                                       
                                       
                                          ν
                                          1
                                       
                                    
                                 
                                 ≠
                                 
                                    
                                       a
                                       2
                                    
                                    
                                       a
                                       1
                                    
                                 
                                 .
                              
                           
                         It can be shown that the lifting of inequality (3.7) when 
                           
                              
                                 
                                    
                                       
                                          μ
                                          2
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          ν
                                          2
                                       
                                    
                                    
                                       
                                          μ
                                          1
                                       
                                       +
                                       
                                          a
                                          1
                                       
                                       
                                          ν
                                          1
                                       
                                    
                                 
                                 =
                                 
                                    
                                       a
                                       2
                                    
                                    
                                       a
                                       1
                                    
                                 
                              
                           
                         gives inequalities (3.6). We omit the proof of this statement since it is too technical and this result will not be used in the remaining of the paper.

Next we discuss the computation of the lifting coefficients of the variable pairs (yj, xj
                        ), for 
                           
                              j
                              ∈
                              I
                              =
                              
                                 I
                                 1
                              
                              ∪
                              
                                 I
                                 2
                              
                              ,
                           
                         with I
                        1 ∈ N
                        1∖S
                        1, I
                        2 ∈ N
                        2∖S
                        2, when 
                           
                              
                                 
                                    
                                       
                                          μ
                                          2
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          ν
                                          2
                                       
                                    
                                    
                                       
                                          μ
                                          1
                                       
                                       +
                                       
                                          a
                                          1
                                       
                                       
                                          ν
                                          1
                                       
                                    
                                 
                                 ≠
                                 
                                    
                                       a
                                       2
                                    
                                    
                                       a
                                       1
                                    
                                 
                              
                           
                         in order to obtain a valid inequality for 
                           X
                        :

                           
                              (3.8)
                              
                                 
                                    
                                       μ
                                       1
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             S
                                             1
                                          
                                       
                                    
                                    
                                       y
                                       j
                                    
                                    
                                    +
                                    
                                    
                                       μ
                                       2
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             S
                                             2
                                          
                                       
                                    
                                    
                                       y
                                       j
                                    
                                    
                                    +
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          I
                                       
                                    
                                    
                                       θ
                                       j
                                    
                                    
                                       y
                                       j
                                    
                                    +
                                    
                                       ν
                                       1
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             S
                                             1
                                          
                                       
                                    
                                    
                                       x
                                       j
                                    
                                    +
                                    
                                       ν
                                       2
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             S
                                             2
                                          
                                       
                                    
                                    
                                       x
                                       j
                                    
                                    +
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          I
                                       
                                    
                                    
                                       ξ
                                       j
                                    
                                    
                                       x
                                       j
                                    
                                    ≤
                                    λ
                                 
                              
                           
                        
                     

The lifting function associated with inequality (3.7) is given by

                           
                              (3.9)
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                             (
                                             z
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             min
                                             λ
                                             −
                                             
                                                μ
                                                1
                                             
                                             Y
                                             
                                                (
                                                
                                                   S
                                                   1
                                                
                                                )
                                             
                                             −
                                             
                                                μ
                                                2
                                             
                                             Y
                                             
                                                (
                                                
                                                   S
                                                   2
                                                
                                                )
                                             
                                             −
                                             
                                                ν
                                                1
                                             
                                             X
                                             
                                                (
                                                
                                                   S
                                                   1
                                                
                                                )
                                             
                                             −
                                             
                                                ν
                                                2
                                             
                                             X
                                             
                                                (
                                                
                                                   S
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3.10)
                              
                                 
                                    
                                       
                                       
                                          
                                             s.
                                             
                                             to
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   
                                                      S
                                                      1
                                                   
                                                   ∪
                                                   
                                                      S
                                                      2
                                                   
                                                
                                             
                                             
                                                x
                                                t
                                             
                                             ≤
                                             D
                                             −
                                             z
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3.11)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                x
                                                j
                                             
                                             ≤
                                             
                                                a
                                                t
                                             
                                             
                                                y
                                                j
                                             
                                             ,
                                             t
                                             ∈
                                             
                                                {
                                                1
                                                ,
                                                2
                                                }
                                             
                                             ,
                                             j
                                             ∈
                                             
                                                S
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3.12)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                y
                                                j
                                             
                                             ∈
                                             
                                                Z
                                                +
                                             
                                             ,
                                             j
                                             ∈
                                             
                                                S
                                                1
                                             
                                             ∪
                                             
                                                S
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The lifing function of the following Euclidean inequality given in Example 2.6,

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             2
                                             
                                                y
                                                1
                                             
                                             +
                                             7
                                             
                                                y
                                                2
                                             
                                             +
                                             
                                                1
                                                1
                                             
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                −
                                                21
                                                
                                                   y
                                                   1
                                                
                                                )
                                             
                                             +
                                             
                                                1
                                                6
                                             
                                             
                                                (
                                                
                                                   x
                                                   2
                                                
                                                −
                                                76
                                                
                                                   y
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ≤
                                             
                                             109
                                             ⇔
                                             −
                                             114
                                             
                                                y
                                                1
                                             
                                             −
                                             34
                                             
                                                y
                                                2
                                             
                                             +
                                             6
                                             
                                                x
                                                1
                                             
                                             +
                                             
                                                x
                                                2
                                             
                                             ≤
                                             654
                                          
                                       
                                    
                                 
                              
                           
                        is depicted in Fig. 2
                        .

The set of possible lifting coefficients for inequality (3.8) is denoted by 
                           
                              Θ
                              
                                 (
                                 
                                    μ
                                    1
                                 
                                 ,
                                 
                                    μ
                                    2
                                 
                                 ,
                                 
                                    ν
                                    1
                                 
                                 ,
                                 
                                    ν
                                    2
                                 
                                 )
                              
                           
                         and can be rewritten as

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                Θ
                                                
                                                   (
                                                   
                                                      μ
                                                      1
                                                   
                                                   ,
                                                   
                                                      μ
                                                      2
                                                   
                                                   ,
                                                   
                                                      ν
                                                      1
                                                   
                                                   ,
                                                   
                                                      ν
                                                      2
                                                   
                                                   )
                                                
                                             
                                             =
                                             
                                                {
                                                
                                                   (
                                                   θ
                                                   ,
                                                   ξ
                                                   )
                                                
                                                ∈
                                                
                                                   R
                                                   
                                                      2
                                                      |
                                                      I
                                                      |
                                                   
                                                
                                                :
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   θ
                                                   k
                                                
                                                
                                                   y
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                                +
                                                
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   ξ
                                                   k
                                                
                                                
                                                   x
                                                   k
                                                
                                                ≤
                                                ϕ
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      x
                                                      k
                                                   
                                                   )
                                                
                                                ,
                                                ∀
                                                
                                                   (
                                                   y
                                                   ,
                                                   x
                                                   )
                                                
                                                ∈
                                                X
                                                
                                                   (
                                                   I
                                                   )
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where

                           
                              
                                 
                                    
                                       
                                          
                                             X
                                             (
                                             I
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             ∈
                                             :
                                             
                                                R
                                                +
                                                
                                                   ∣
                                                   I
                                                   ∣
                                                
                                             
                                             ×
                                             
                                                Z
                                                +
                                                
                                                   ∣
                                                   I
                                                   ∣
                                                
                                             
                                             :
                                             X
                                             
                                                (
                                                I
                                                )
                                             
                                             ≤
                                             D
                                             ,
                                             
                                                x
                                                j
                                             
                                             ≤
                                             
                                                a
                                                1
                                             
                                             
                                                y
                                                j
                                             
                                             ,
                                             j
                                             ∈
                                             
                                                I
                                                1
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             x
                                             j
                                          
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             
                                                a
                                                2
                                             
                                             
                                                y
                                                j
                                             
                                             ,
                                             j
                                             ∈
                                             
                                                I
                                                2
                                             
                                             
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The interesting cases are those where (θj, ξj
                        ) ≠ (0, 0), ∀j ∈ I, (θj, ξj
                        ) ≠ (μ
                        1, ν
                        1) if j ∈ I
                        1 and (θj, ξj
                        ) ≠ (μ
                        2, ν
                        2) if j ∈ I
                        2.

In order to compute the lifting coefficients only extreme points and extreme rays of 
                           P
                         need to be considered in the definition of 
                           
                              X
                              (
                              I
                              )
                              .
                           
                         Extreme rays are of the form (0, ej
                        ) where ej
                         is the unit vector with one in position j and zero elsewhere. Extreme rays imply θj
                         ≤ 0, j ∈ I. The following lemma considers extreme points of 
                           
                              P
                              .
                           
                        
                        
                           Lemma 3.4
                           
                              Assume 
                              
                                 (3.8)
                               
                              defines a facet of
                              
                                 
                                    P
                                    ,
                                 
                               
                              with (μ
                              1, μ
                              2, ν
                              1, ν
                              2) ∈ Λ, and (μ
                              1, ν
                              1) ≠ (θj, ηj
                              ), j ∈ I
                              1, (μ
                              2, ν
                              2) ≠ (θj, ηj
                              ), j ∈ I
                              2. If (x, y) is a tight extreme point of
                              
                                 P
                               
                              in the face defined by 
                              
                                 (3.8)
                               
                              and if yk
                               > 0, for some k ∈ I
                              1 ∪ I
                              2, then (i)
                              
                                 
                                    
                                       y
                                       k
                                    
                                    =
                                    1
                                    ;
                                 
                               
                              (ii)
                              
                                 
                                    
                                       y
                                       j
                                    
                                    =
                                    0
                                    ,
                                    j
                                    ∈
                                    
                                       I
                                       1
                                    
                                    ∪
                                    
                                       I
                                       2
                                    
                                    ∖
                                    
                                       {
                                       k
                                       }
                                    
                                    ;
                                 
                               
                              (iii)
                              
                                 
                                    0
                                    <
                                    
                                       x
                                       k
                                    
                                    =
                                    D
                                    −
                                    X
                                    
                                       (
                                       
                                          S
                                          1
                                       
                                       ∪
                                       
                                          S
                                          2
                                       
                                       )
                                    
                                    <
                                    
                                       a
                                       t
                                    
                                 
                               
                              where
                              
                                 
                                    t
                                    =
                                    1
                                 
                               
                              if k ∈ I
                              1 
                              and
                              
                                 
                                    t
                                    =
                                    2
                                 
                               
                              if k ∈ I
                              2; (iv)
                              
                                 
                                    X
                                    
                                       (
                                       
                                          S
                                          1
                                       
                                       )
                                    
                                    =
                                    
                                       a
                                       1
                                    
                                    Y
                                    
                                       (
                                       
                                          S
                                          1
                                       
                                       )
                                    
                                    ;
                                 
                              
                              
                                 
                                    X
                                    
                                       (
                                       
                                          S
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       a
                                       2
                                    
                                    Y
                                    
                                       (
                                       
                                          S
                                          2
                                       
                                       )
                                    
                                    .
                                 
                              
                           

The proof is given in the Appendix.

We can restrict 
                           
                              X
                              (
                              I
                              )
                           
                         to the set of points obtained by projecting the extreme points of 
                           P
                         into the space of the lifting variables. We denote the restricted set as 
                           
                              
                                 X
                                 ¯
                              
                              
                                 (
                                 I
                                 )
                              
                              .
                           
                         Using (i) and (ii) from Lemma 3.4 we can write set 
                           
                              Θ
                              
                                 (
                                 
                                    μ
                                    1
                                 
                                 ,
                                 
                                    μ
                                    2
                                 
                                 ,
                                 
                                    ν
                                    1
                                 
                                 ,
                                 
                                    ν
                                    2
                                 
                                 )
                              
                           
                         as follows.

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                Θ
                                                
                                                   (
                                                   
                                                      μ
                                                      1
                                                   
                                                   ,
                                                   
                                                      μ
                                                      2
                                                   
                                                   ,
                                                   
                                                      ν
                                                      1
                                                   
                                                   ,
                                                   
                                                      ν
                                                      2
                                                   
                                                   )
                                                
                                             
                                             
                                                =
                                                {
                                                
                                                   (
                                                   θ
                                                   ,
                                                   ξ
                                                   )
                                                
                                                ∈
                                             
                                             
                                                R
                                                
                                                   −
                                                
                                                
                                                   |
                                                   I
                                                   |
                                                
                                             
                                             ×
                                             
                                                R
                                                
                                                   |
                                                   I
                                                   |
                                                
                                             
                                             :
                                             
                                                θ
                                                k
                                             
                                             +
                                             
                                                ξ
                                                k
                                             
                                             
                                                x
                                                k
                                             
                                             ≤
                                             ϕ
                                             
                                                (
                                                
                                                   x
                                                   k
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             
                                             
                                                (
                                                y
                                                ,
                                                x
                                                )
                                             
                                             ∈
                                             
                                                X
                                                ¯
                                             
                                             
                                                (
                                                I
                                                )
                                             
                                             ,
                                             
                                                y
                                                k
                                             
                                             
                                                =
                                                1
                                                ,
                                                k
                                                ∈
                                                I
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        From condition (iii) and (iv), if (x, y) is an extreme point of 
                           P
                         and 
                           
                              
                                 y
                                 k
                              
                              =
                              1
                              ,
                              k
                              ∈
                              I
                              ,
                           
                         then 
                           
                              0
                              ≤
                              
                                 x
                                 k
                              
                              =
                              D
                              −
                              X
                              
                                 (
                                 
                                    S
                                    1
                                 
                                 ∪
                                 
                                    S
                                    2
                                 
                                 )
                              
                              =
                              D
                              −
                              
                                 a
                                 1
                              
                              Y
                              
                                 (
                                 
                                    S
                                    1
                                 
                                 )
                              
                              −
                              
                                 a
                                 2
                              
                              Y
                              
                                 (
                                 
                                    S
                                    2
                                 
                                 )
                              
                              ≤
                              
                                 a
                                 t
                              
                              .
                           
                         Hence 
                           
                              D
                              −
                              
                                 a
                                 t
                              
                              ≤
                              
                                 a
                                 1
                              
                              Y
                              
                                 (
                                 
                                    S
                                    1
                                 
                                 )
                              
                              +
                              
                                 a
                                 2
                              
                              Y
                              
                                 (
                                 
                                    S
                                    2
                                 
                                 )
                              
                              ≤
                              D
                              .
                           
                        
                     

For t ∈ {1, 2}, let us define 
                           
                              
                                 Σ
                                 t
                              
                              =
                              
                                 {
                                 
                                    (
                                    
                                       Y
                                       1
                                    
                                    ,
                                    
                                       Y
                                       2
                                    
                                    )
                                 
                                 ∈
                                 
                                    Z
                                    +
                                    2
                                 
                                 :
                                 D
                                 −
                                 
                                    a
                                    t
                                 
                                 ≤
                                 
                                    a
                                    1
                                 
                                 
                                    Y
                                    1
                                 
                                 +
                                 
                                    a
                                    2
                                 
                                 
                                    Y
                                    2
                                 
                                 ≤
                                 D
                                 }
                              
                              ;
                           
                        
                        V(Σt
                        ) as the set of extreme points of conv(Σt
                        ), and 
                           
                              
                                 Γ
                                 t
                              
                              =
                              
                                 {
                                 γ
                                 :
                                 γ
                                 =
                                 D
                                 −
                                 
                                    a
                                    1
                                 
                                 
                                    Y
                                    1
                                 
                                 −
                                 
                                    a
                                    2
                                 
                                 
                                    Y
                                    2
                                 
                                 
                                 for
                                 
                                 some
                                 
                                 
                                    (
                                    
                                       Y
                                       1
                                    
                                    ,
                                    
                                       Y
                                       2
                                    
                                    )
                                 
                                 ∈
                                 V
                                 
                                    (
                                    
                                       Σ
                                       t
                                    
                                    )
                                 
                                 }
                              
                              .
                           
                         Then

                           Proposition 3.5
                           
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         Θ
                                                         
                                                            (
                                                            
                                                               μ
                                                               1
                                                            
                                                            ,
                                                            
                                                               μ
                                                               2
                                                            
                                                            ,
                                                            
                                                               ν
                                                               1
                                                            
                                                            ,
                                                            
                                                               ν
                                                               2
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         =
                                                         {
                                                         
                                                            (
                                                            θ
                                                            ,
                                                            ξ
                                                            )
                                                         
                                                         ∈
                                                      
                                                      
                                                         R
                                                         
                                                            −
                                                         
                                                         
                                                            |
                                                            I
                                                            |
                                                         
                                                      
                                                      ×
                                                      
                                                         R
                                                         
                                                            |
                                                            I
                                                            |
                                                         
                                                      
                                                      :
                                                      
                                                         θ
                                                         j
                                                      
                                                      +
                                                      
                                                         ξ
                                                         j
                                                      
                                                      γ
                                                      ≤
                                                      ϕ
                                                      
                                                         (
                                                         γ
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ∀
                                                   
                                                   t
                                                   ∈
                                                   
                                                      {
                                                      1
                                                      ,
                                                      2
                                                      }
                                                   
                                                   ,
                                                   j
                                                   ∈
                                                   
                                                      I
                                                      t
                                                   
                                                   ,
                                                   γ
                                                   ∈
                                                   
                                                      Γ
                                                      t
                                                   
                                                   
                                                      }
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Since each inequality defining 
                           
                              Θ
                              
                                 (
                                 
                                    μ
                                    1
                                 
                                 ,
                                 
                                    μ
                                    2
                                 
                                 ,
                                 
                                    ν
                                    1
                                 
                                 ,
                                 
                                    ν
                                    2
                                 
                                 )
                              
                           
                         involves only one variable pair, set 
                           
                              Θ
                              
                                 (
                                 
                                    μ
                                    1
                                 
                                 ,
                                 
                                    μ
                                    2
                                 
                                 ,
                                 
                                    ν
                                    1
                                 
                                 ,
                                 
                                    ν
                                    2
                                 
                                 )
                              
                           
                         can be decomposed accordingly to variables pairs:

                           
                              
                                 
                                    
                                       Θ
                                       
                                          (
                                          
                                             μ
                                             1
                                          
                                          ,
                                          
                                             μ
                                             2
                                          
                                          ,
                                          
                                             ν
                                             1
                                          
                                          ,
                                          
                                             ν
                                             2
                                          
                                          )
                                       
                                    
                                    =
                                    
                                       ×
                                       
                                          j
                                          ∈
                                          I
                                       
                                    
                                    
                                       Θ
                                       
                                          (
                                          
                                             μ
                                             1
                                          
                                          ,
                                          
                                             μ
                                             2
                                          
                                          ,
                                          
                                             ν
                                             1
                                          
                                          ,
                                          
                                             ν
                                             2
                                          
                                          )
                                       
                                    
                                    
                                       (
                                       j
                                       )
                                    
                                 
                              
                           
                        where

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                Θ
                                                
                                                   (
                                                   
                                                      μ
                                                      1
                                                   
                                                   ,
                                                   
                                                      μ
                                                      2
                                                   
                                                   ,
                                                   
                                                      ν
                                                      1
                                                   
                                                   ,
                                                   
                                                      ν
                                                      2
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   (
                                                   j
                                                   )
                                                
                                                =
                                                {
                                             
                                             
                                                (
                                                
                                                   θ
                                                   j
                                                
                                                ,
                                                
                                                   ξ
                                                   j
                                                
                                                )
                                             
                                             ∈
                                             
                                                R
                                                −
                                             
                                             ×
                                             R
                                             :
                                             
                                                θ
                                                j
                                             
                                             +
                                             
                                                ξ
                                                j
                                             
                                             γ
                                             ≤
                                             ϕ
                                             
                                                (
                                                γ
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             t
                                             ∈
                                             
                                                {
                                                1
                                                ,
                                                2
                                                }
                                             
                                             ,
                                             j
                                             ∈
                                             
                                                I
                                                t
                                             
                                             ,
                                             γ
                                             ∈
                                             
                                                Γ
                                                t
                                             
                                             
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Henceforward we focus on computing the lifting coefficients from 
                           
                              
                                 Θ
                                 
                                    (
                                    
                                       μ
                                       1
                                    
                                    ,
                                    
                                       μ
                                       2
                                    
                                    ,
                                    
                                       ν
                                       1
                                    
                                    ,
                                    
                                       ν
                                       2
                                    
                                    )
                                 
                              
                              
                                 (
                                 j
                                 )
                              
                           
                         only. We can observe that for each t ∈ {1, 2}, the set 
                           
                              
                                 Θ
                                 
                                    (
                                    
                                       μ
                                       1
                                    
                                    ,
                                    
                                       μ
                                       2
                                    
                                    ,
                                    
                                       ν
                                       1
                                    
                                    ,
                                    
                                       ν
                                       2
                                    
                                    )
                                 
                              
                              
                                 (
                                 j
                                 )
                              
                           
                         is always the same for every j ∈ It
                        . Hence, for t ∈ {1, 2}, we define 
                           
                              
                                 Θ
                                 
                                    (
                                    
                                       μ
                                       1
                                    
                                    ,
                                    
                                       μ
                                       2
                                    
                                    ,
                                    
                                       ν
                                       1
                                    
                                    ,
                                    
                                       ν
                                       2
                                    
                                    )
                                 
                                 t
                              
                              =
                              
                                 {
                                 
                                    (
                                    θ
                                    ,
                                    ξ
                                    )
                                 
                                 ∈
                                 
                                    R
                                    −
                                 
                                 ×
                                 R
                                 :
                                 θ
                                 +
                                 ξ
                                 γ
                                 ≤
                                 ϕ
                                 
                                    (
                                    γ
                                    )
                                 
                                 ,
                                 γ
                                 ∈
                                 
                                    Γ
                                    t
                                 
                                 }
                              
                              =
                              
                                 Θ
                                 
                                    (
                                    
                                       μ
                                       1
                                    
                                    ,
                                    
                                       μ
                                       2
                                    
                                    ,
                                    
                                       ν
                                       1
                                    
                                    ,
                                    
                                       ν
                                       2
                                    
                                    )
                                 
                              
                              
                                 (
                                 j
                                 )
                              
                              ,
                              j
                              ∈
                              
                                 I
                                 t
                              
                              .
                           
                        
                     

It is well known that only extreme points of 
                           
                              Θ
                              
                                 (
                                 
                                    μ
                                    1
                                 
                                 ,
                                 
                                    μ
                                    2
                                 
                                 ,
                                 
                                    ν
                                    1
                                 
                                 ,
                                 
                                    ν
                                    2
                                 
                                 )
                              
                              t
                           
                         lead to facet defining inequalities of type (3.8). Since 
                           
                              
                                 Θ
                                 
                                    (
                                    
                                       μ
                                       1
                                    
                                    ,
                                    
                                       μ
                                       2
                                    
                                    ,
                                    
                                       ν
                                       1
                                    
                                    ,
                                    
                                       ν
                                       2
                                    
                                    )
                                 
                                 t
                              
                              ,
                              t
                              ∈
                              
                                 {
                                 1
                                 ,
                                 2
                                 }
                              
                           
                         are two dimensional polyhedra the set of extreme points can be computed efficiently (Hirschberg & Wong, 1976).

The set of extreme points of 
                           
                              Θ
                              
                                 (
                                 
                                    μ
                                    1
                                 
                                 ,
                                 
                                    μ
                                    2
                                 
                                 ,
                                 
                                    ν
                                    1
                                 
                                 ,
                                 
                                    ν
                                    2
                                 
                                 ,
                                 λ
                                 )
                              
                              t
                           
                         will be denoted by 
                           
                              
                                 
                                    
                                       Θ
                                       ¯
                                    
                                    
                                       (
                                       
                                          μ
                                          1
                                       
                                       ,
                                       
                                          μ
                                          2
                                       
                                       ,
                                       
                                          ν
                                          1
                                       
                                       ,
                                       
                                          ν
                                          2
                                       
                                       ,
                                       λ
                                       )
                                    
                                    t
                                 
                                 
                                    =
                                    {
                                 
                                 
                                    (
                                    
                                       θ
                                       t
                                       k
                                    
                                    ,
                                    
                                       ξ
                                       t
                                       k
                                    
                                    :
                                    k
                                    ∈
                                    
                                       T
                                       t
                                    
                                    }
                                 
                              
                           
                         where 
                           
                              
                                 T
                                 t
                              
                              =
                              
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    n
                                    t
                                 
                                 }
                              
                           
                         and nt
                         denotes the number of extreme points which is 
                           
                              O
                              (
                              l
                              o
                              g
                              
                                 (
                                 D
                                 /
                                 min
                                 
                                    {
                                    
                                       a
                                       1
                                    
                                    ,
                                    
                                       a
                                       2
                                    
                                    }
                                 
                                 )
                              
                              )
                              .
                           
                         These sets can be computed in the same time complexity.

                           Example 3.6
                           Consider the mixed integer set 
                                 
                                    X
                                    =
                                    {
                                    
                                       (
                                       y
                                       ,
                                       x
                                       )
                                    
                                    ∈
                                    
                                       Z
                                       +
                                       3
                                    
                                    ×
                                    
                                       R
                                       +
                                       3
                                    
                                    :
                                    
                                       x
                                       1
                                    
                                    +
                                    
                                       x
                                       2
                                    
                                    +
                                    
                                       x
                                       3
                                    
                                    ≤
                                    1154
                                    ,
                                    
                                       x
                                       1
                                    
                                    ≤
                                    21
                                    
                                       y
                                       j
                                    
                                    ,
                                    
                                       x
                                       2
                                    
                                    ≤
                                    76
                                    
                                       y
                                       2
                                    
                                    ,
                                    
                                       x
                                       3
                                    
                                    ≤
                                    76
                                    
                                       y
                                       3
                                    
                                    }
                                    .
                                 
                               The full polyhedral description for the restricted set with 
                                 
                                    
                                       x
                                       3
                                    
                                    =
                                    
                                       y
                                       3
                                    
                                    =
                                    0
                                 
                               was given in Example 2.6. Next we discuss the lifting of variable pair (x
                              3, y
                              3). Hence 
                                 
                                    
                                       I
                                       1
                                    
                                    =
                                    ∅
                                 
                               and 
                                 
                                    
                                       I
                                       2
                                    
                                    =
                                    
                                       {
                                       3
                                       }
                                    
                                    .
                                 
                              
                           

Observe that Σ
                              1 and Σ
                              2 do not depend on the particular facet-defining inequality we are considering. Fig. 3
                               depicts the set

                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   V
                                                   
                                                      (
                                                      
                                                         Σ
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                      =
                                                      {
                                                   
                                                   
                                                      (
                                                      54
                                                      ,
                                                      0
                                                      )
                                                   
                                                   ,
                                                   
                                                      (
                                                      51
                                                      ,
                                                      1
                                                      )
                                                   
                                                   ,
                                                   
                                                      (
                                                      44
                                                      ,
                                                      3
                                                      )
                                                   
                                                   ,
                                                   
                                                      (
                                                      26
                                                      ,
                                                      8
                                                      )
                                                   
                                                   ,
                                                   
                                                      (
                                                      4
                                                      ,
                                                      14
                                                      )
                                                   
                                                   ,
                                                   
                                                      (
                                                      0
                                                      ,
                                                      15
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   (
                                                   8
                                                   ,
                                                   12
                                                   )
                                                   ,
                                                   (
                                                   26
                                                   ,
                                                   7
                                                   )
                                                   ,
                                                   (
                                                   48
                                                   ,
                                                   1
                                                   )
                                                   ,
                                                   (
                                                   52
                                                   ,
                                                   0
                                                   )
                                                   }
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Now consider the Euclidean inequality

                                 
                                    
                                       
                                          
                                             
                                                
                                                   2
                                                   
                                                      y
                                                      1
                                                   
                                                   +
                                                   7
                                                   
                                                      y
                                                      2
                                                   
                                                   +
                                                   
                                                      1
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         1
                                                      
                                                      −
                                                      21
                                                      
                                                         y
                                                         1
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      1
                                                      6
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         2
                                                      
                                                      −
                                                      76
                                                      
                                                         y
                                                         2
                                                      
                                                      )
                                                   
                                                   ≤
                                                   109
                                                
                                             
                                          
                                       
                                    
                                 
                              which is equivalent to

                                 
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   114
                                                   
                                                      y
                                                      1
                                                   
                                                   −
                                                   34
                                                   
                                                      y
                                                      2
                                                   
                                                   +
                                                   6
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   
                                                      x
                                                      2
                                                   
                                                   ≤
                                                   654
                                                
                                             
                                          
                                       
                                    
                                 
                              Based on the points in V(Σ
                              2) we obtain 
                                 
                                    
                                       Γ
                                       t
                                    
                                    =
                                    
                                       {
                                       20
                                       ,
                                       7
                                       ,
                                       2
                                       ,
                                       0
                                       ,
                                       6
                                       ,
                                       14
                                       ,
                                       74
                                       ,
                                       76
                                       ,
                                       70
                                       ,
                                       62
                                       }
                                    
                                 
                               and (see Fig. 2) 
                                 
                                    ϕ
                                    (
                                    20
                                    )
                                    =
                                    6
                                    ,
                                 
                              
                              
                                 
                                    ϕ
                                    (
                                    7
                                    )
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    ϕ
                                    (
                                    2
                                    )
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    ϕ
                                    (
                                    0
                                    )
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    ϕ
                                    (
                                    6
                                    )
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    ϕ
                                    (
                                    14
                                    )
                                    =
                                    6
                                    ,
                                 
                              
                              
                                 
                                    ϕ
                                    (
                                    74
                                    )
                                    =
                                    40
                                    ,
                                 
                              
                              
                                 
                                    ϕ
                                    (
                                    76
                                    )
                                    =
                                    42
                                    ,
                                 
                              
                              
                                 
                                    ϕ
                                    (
                                    70
                                    )
                                    =
                                    36
                                    ,
                                 
                              
                              
                                 
                                    ϕ
                                    (
                                    62
                                    )
                                    =
                                    30
                                    .
                                 
                               Thus 
                                 
                                    
                                       Θ
                                       
                                          (
                                          
                                             μ
                                             1
                                          
                                          ,
                                          
                                             μ
                                             2
                                          
                                          ,
                                          
                                             ν
                                             1
                                          
                                          ,
                                          
                                             ν
                                             2
                                          
                                          ,
                                          λ
                                          )
                                       
                                       2
                                    
                                    =
                                    
                                       {
                                       
                                          (
                                          θ
                                          ,
                                          ξ
                                          )
                                       
                                       ∈
                                       
                                          R
                                          −
                                       
                                       ×
                                       R
                                       :
                                       θ
                                       +
                                       20
                                       ξ
                                       ≤
                                       6
                                       ,
                                       θ
                                       +
                                       7
                                       ξ
                                       ≤
                                       0
                                       ,
                                       θ
                                       +
                                       2
                                       ξ
                                       ≤
                                       0
                                       ,
                                       θ
                                       ≤
                                       0
                                       ,
                                       θ
                                       +
                                       6
                                       ξ
                                       ≤
                                       0
                                       ,
                                       θ
                                       +
                                       14
                                       ξ
                                       ≤
                                       6
                                       ,
                                       θ
                                       +
                                       74
                                       ξ
                                       ≤
                                       40
                                       ,
                                       θ
                                       +
                                       76
                                       ξ
                                       ≤
                                       42
                                       ,
                                       θ
                                       +
                                       70
                                       ξ
                                       ≤
                                       36
                                       ,
                                       θ
                                       +
                                       62
                                       ξ
                                       ≤
                                       30
                                       }
                                    
                                    .
                                 
                               The extreme points are:

                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         Θ
                                                         ¯
                                                      
                                                      
                                                         (
                                                         
                                                            μ
                                                            1
                                                         
                                                         ,
                                                         
                                                            μ
                                                            2
                                                         
                                                         ,
                                                         
                                                            ν
                                                            1
                                                         
                                                         ,
                                                         
                                                            ν
                                                            2
                                                         
                                                         ,
                                                         λ
                                                         )
                                                      
                                                      2
                                                   
                                                   
                                                      =
                                                      {
                                                      
                                                         (
                                                         −
                                                         34
                                                         ,
                                                         1
                                                         )
                                                      
                                                      ,
                                                   
                                                   
                                                      (
                                                      −
                                                      
                                                         42
                                                         13
                                                      
                                                      ,
                                                      
                                                         6
                                                         13
                                                      
                                                      )
                                                   
                                                   ,
                                                   
                                                      (
                                                      −
                                                      
                                                         38
                                                         7
                                                      
                                                      ,
                                                      
                                                         4
                                                         7
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   
                                                      (
                                                      −
                                                      
                                                         33
                                                         2
                                                      
                                                      ,
                                                      
                                                         3
                                                         4
                                                      
                                                      )
                                                   
                                                   
                                                      ,
                                                      
                                                         (
                                                         0
                                                         ,
                                                         0
                                                         )
                                                      
                                                      }
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              Hence we obtain the following set of facet-defining inequalities with (θ, ξ) ≠ (0, 0) and 
                                 
                                    (
                                    θ
                                    ,
                                    ξ
                                    )
                                    ≠
                                    (
                                    −
                                    34
                                    ,
                                    1
                                    )
                                 
                              :

                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   −
                                                   114
                                                   
                                                      y
                                                      1
                                                   
                                                   −
                                                   34
                                                   
                                                      y
                                                      2
                                                   
                                                   −
                                                   
                                                      42
                                                      13
                                                   
                                                   
                                                      y
                                                      3
                                                   
                                                   +
                                                   6
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   
                                                      x
                                                      2
                                                   
                                                   +
                                                   
                                                      6
                                                      13
                                                   
                                                   
                                                      x
                                                      3
                                                   
                                                   ≤
                                                   654
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   −
                                                   114
                                                   
                                                      y
                                                      1
                                                   
                                                   −
                                                   34
                                                   
                                                      y
                                                      2
                                                   
                                                   −
                                                   
                                                      38
                                                      7
                                                   
                                                   
                                                      y
                                                      3
                                                   
                                                   +
                                                   6
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   
                                                      x
                                                      2
                                                   
                                                   +
                                                   
                                                      4
                                                      7
                                                   
                                                   
                                                      x
                                                      3
                                                   
                                                   ≤
                                                   654
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   −
                                                   114
                                                   
                                                      y
                                                      1
                                                   
                                                   −
                                                   34
                                                   
                                                      y
                                                      2
                                                   
                                                   −
                                                   
                                                      33
                                                      2
                                                   
                                                   
                                                      y
                                                      3
                                                   
                                                   +
                                                   6
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   
                                                      x
                                                      2
                                                   
                                                   +
                                                   
                                                      3
                                                      4
                                                   
                                                   
                                                      x
                                                      3
                                                   
                                                   ≤
                                                   654
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Now we summarize the above discussion.

                           Proposition 3.7
                           
                              Consider (μ
                              1, μ
                              2, ν
                              1, ν
                              2, λ) ∈ Λ and consider the disjoint sets S
                              1, I
                              1, ∅ ≠ S
                              1 ⊂ N
                              1, ∅ ≠ I
                              1 ⊂ N
                              1, and S
                              2, I
                              2, ∅ ≠ S
                              2 ⊂ N
                              2, ∅ ≠ I
                              2 ⊂ N
                              2. For t ∈ {1, 2}, let
                              
                                 
                                    {
                                    
                                       I
                                       t
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       I
                                       t
                                       
                                          n
                                          t
                                       
                                    
                                    }
                                 
                               
                              define a partition of It. Then the following lifted Euclidean inequality is valid for X:

                                 
                                    (3.13)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                      1
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            S
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                
                                             
                                             
                                                +
                                             
                                             
                                                
                                                   
                                                      μ
                                                      2
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            S
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ∈
                                                         
                                                            T
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            I
                                                            1
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      θ
                                                      1
                                                      k
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ∈
                                                         
                                                            T
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            I
                                                            2
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      θ
                                                      2
                                                      k
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                   +
                                                   
                                                      ν
                                                      1
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            S
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                +
                                             
                                             
                                                
                                                   
                                                      ν
                                                      2
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            S
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      x
                                                      j
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ∈
                                                         
                                                            T
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            I
                                                            1
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      ξ
                                                      1
                                                      k
                                                   
                                                   
                                                      x
                                                      j
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ∈
                                                         
                                                            T
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            I
                                                            2
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      ξ
                                                      2
                                                      k
                                                   
                                                   
                                                      x
                                                      j
                                                   
                                                   ≤
                                                   λ
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where
                              
                                 
                                    
                                       (
                                       
                                          θ
                                          t
                                          k
                                       
                                       ,
                                       
                                          ξ
                                          t
                                          k
                                       
                                       )
                                    
                                    ∈
                                    
                                       Θ
                                       
                                          (
                                          
                                             μ
                                             1
                                          
                                          ,
                                          
                                             μ
                                             2
                                          
                                          ,
                                          
                                             ν
                                             1
                                          
                                          ,
                                          
                                             ν
                                             2
                                          
                                          ,
                                          λ
                                          )
                                       
                                       t
                                    
                                 
                               
                              for t ∈ {1, 2}, k ∈ Tt
                              .

Note that all the coefficients involved in these valid inequalities can be computed in polynomial time since the information required can be obtained by computing the extreme points of two dimensional polyhedra, using a version of the Hirschberg and Wong’s algorithm (which is based on the Euclidean Algorithm).

Here we establish the main result of this paper.

                           Theorem 3.1
                           
                              The inequalities xj
                               ≥ 0, j ∈ N, xj
                               ≤ a
                              1
                              yj, j ∈ S, xj
                               ≤ a
                              2
                              yj, j ∈ N∖S, 
                                 
                                    
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             N
                                          
                                       
                                       
                                          x
                                          j
                                       
                                       ≤
                                       D
                                       ,
                                    
                                 
                               
                              
                                 (3.6)
                               
                              and the lifted Euclidean inequalities 
                              
                                 (3.13)
                               
                              suffice to describe
                              
                                 
                                    P
                                    =
                                    c
                                    o
                                    n
                                    v
                                    (
                                    X
                                    )
                                    .
                                 
                              
                           

To prove this theorem we assume that the inequality

                                 
                                    (3.14)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         N
                                                      
                                                   
                                                   
                                                      μ
                                                      j
                                                   
                                                   
                                                      y
                                                      j
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         N
                                                      
                                                   
                                                   
                                                      ν
                                                      j
                                                   
                                                   
                                                      x
                                                      j
                                                   
                                                   ≤
                                                   λ
                                                
                                             
                                          
                                       
                                    
                                 
                              defines a non-trivial facet, 
                                 
                                    
                                       F
                                       
                                          (
                                          μ
                                          ,
                                          ν
                                          ,
                                          λ
                                          )
                                       
                                    
                                    ,
                                 
                               of P (we call inequalities xj
                               ≥ 0, j ∈ N, xj
                               ≤ a
                              1
                              yj, j ∈ S, xj
                               ≤ a
                              2
                              yj, j ∈ N∖S, ∑
                                 j ∈ N
                              
                              xj
                               ≤ D, trivial facets) and show that either it belongs to one of the families for the two dimensional case (3.5) or it belongs to one of the families (3.6) or (3.13) (which includes inequalities (3.5)). From Lemma 3.1 we may assume w.l.o.g. (μj, νj
                              ) ≠ (0, 0), j ∈ N.

We will use the following notation for each t ∈ {1, 2} such that Nt
                               ≠ ∅, ℓ
                                 t
                               ∈ argmin {μj, j ∈ Nt
                              }, 
                                 
                                    
                                       S
                                       t
                                    
                                    =
                                    
                                       {
                                       j
                                       ∈
                                       
                                          N
                                          t
                                       
                                       :
                                       
                                          μ
                                          j
                                       
                                       =
                                       
                                          μ
                                          
                                             ℓ
                                             t
                                          
                                       
                                       }
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       I
                                       t
                                    
                                    =
                                    
                                       N
                                       t
                                    
                                    ∖
                                    
                                       S
                                       t
                                    
                                 
                               and 
                                 
                                    I
                                    =
                                    
                                       I
                                       1
                                    
                                    ∪
                                    
                                       I
                                       2
                                    
                                    .
                                 
                               We also define the following aggregated variables: 
                                 
                                    
                                       Y
                                       t
                                    
                                    =
                                    Y
                                    
                                       (
                                       
                                          S
                                          t
                                       
                                       )
                                    
                                    ,
                                    
                                       X
                                       t
                                    
                                    =
                                    X
                                    
                                       (
                                       
                                          S
                                          t
                                       
                                       )
                                    
                                    ,
                                    t
                                    ∈
                                    
                                       {
                                       1
                                       ,
                                       2
                                       }
                                    
                                    .
                                 
                              
                           

As the null vector is in X then λ > 0.

The following properties hold:

                                 
                                    (i)
                                    For all j ∈ N
                                       1 ∪ N
                                       2, μj
                                        < 0.

For all j ∈ N
                                       1 ∪ N
                                       2, νj
                                        > 0.

(a) 
                                          
                                             
                                                ν
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                             >
                                             
                                                ν
                                                j
                                             
                                          
                                        for all j ∈ N
                                       1∖S
                                       1; (b) 
                                          
                                             
                                                ν
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                             >
                                             
                                                ν
                                                j
                                             
                                          
                                        for all j ∈ N
                                       2∖S
                                       2.

(a) 
                                          
                                             
                                                μ
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                             +
                                             
                                                a
                                                1
                                             
                                             
                                                ν
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                             >
                                             
                                                μ
                                                j
                                             
                                             +
                                             
                                                a
                                                1
                                             
                                             
                                                ν
                                                j
                                             
                                          
                                        for all j ∈ N
                                       1∖S
                                       1; (b) 
                                          
                                             
                                                μ
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                             +
                                             
                                                a
                                                2
                                             
                                             
                                                ν
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                             >
                                             
                                                μ
                                                j
                                             
                                             +
                                             
                                                a
                                                2
                                             
                                             
                                                ν
                                                j
                                             
                                          
                                        for all j ∈ N
                                       2∖S
                                       2.

If 
                                          
                                             
                                                (
                                                
                                                   x
                                                   *
                                                
                                                ,
                                                
                                                   y
                                                   *
                                                
                                                )
                                             
                                             ∈
                                             
                                                F
                                                
                                                   (
                                                   μ
                                                   ,
                                                   ν
                                                   ,
                                                   λ
                                                   )
                                                
                                             
                                             ∩
                                             X
                                          
                                        then 
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                y
                                                j
                                                *
                                             
                                             ≤
                                             1
                                             .
                                          
                                       
                                    

As the unit vector with 1 in position corresponding to yj
                               and 0 elsewhere is a ray of P, then μj
                               ≤ 0. If 
                                 
                                    
                                       μ
                                       j
                                    
                                    =
                                    0
                                 
                               then as we are assuming (μj, νj
                              ) ≠ (0, 0) we must have νj
                               > 0. Then each point in the facet 
                                 F
                               must satisfy 
                                 
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    
                                       x
                                       j
                                    
                                    =
                                    D
                                    ,
                                 
                               (since otherwise, if there is a point 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    ∈
                                    F
                                 
                               with ∑
                                 j ∈ N
                              
                              xj
                               < D, then we can increase the value of yj
                               and xj
                               obtaining a violated point) which is a contradiction. Thus condition (i) must hold.

Property (ii) follows from the fact that if νj
                               ≤ 0, then 
                                 
                                    
                                       x
                                       j
                                    
                                    =
                                    
                                       y
                                       j
                                    
                                    =
                                    0
                                 
                               for every point in 
                                 F
                               (otherwise, if there is a solution 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    ∈
                                    F
                                 
                               with yj
                               > 0 a new point in X can be constructed from (x, y) by decreasing the value of xj
                               and yj
                               to zero which violates (3.14)).

To prove (iii) (a), observe that if 
                                 
                                    
                                       ν
                                       
                                          ℓ
                                          1
                                       
                                    
                                    ≤
                                    
                                       ν
                                       j
                                    
                                 
                               for some j ∈ N
                              1∖S
                              1, then 
                                 
                                    
                                       y
                                       j
                                    
                                    =
                                    
                                       x
                                       j
                                    
                                    =
                                    0
                                 
                               for every point in 
                                 
                                    F
                                    .
                                 
                               Similarly for (b).

To prove (iv), suppose 
                                 
                                    
                                       μ
                                       
                                          ℓ
                                          1
                                       
                                    
                                    +
                                    
                                       a
                                       1
                                    
                                    
                                       ν
                                       
                                          ℓ
                                          1
                                       
                                    
                                    ≤
                                    
                                       μ
                                       j
                                    
                                    +
                                    
                                       a
                                       1
                                    
                                    
                                       ν
                                       j
                                    
                                 
                               for some j ∈ N
                              1∖S
                              1. Then 
                                 
                                    
                                       μ
                                       
                                          ℓ
                                          1
                                       
                                    
                                    +
                                    γ
                                    
                                       ν
                                       
                                          ℓ
                                          1
                                       
                                    
                                    <
                                    
                                       μ
                                       j
                                    
                                    +
                                    γ
                                    
                                       ν
                                       j
                                    
                                 
                               for each 0 < γ < a
                              1. This implies that for each 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    ∈
                                    F
                                 
                               either 
                                 
                                    
                                       x
                                       
                                          ℓ
                                          1
                                       
                                    
                                    =
                                    0
                                 
                               if 
                                 
                                    
                                       y
                                       
                                          ℓ
                                          1
                                       
                                    
                                    =
                                    0
                                 
                               or 
                                 
                                    
                                       x
                                       
                                          ℓ
                                          1
                                       
                                    
                                    =
                                    
                                       a
                                       1
                                    
                                    
                                       y
                                       
                                          ℓ
                                          1
                                       
                                    
                                 
                               if 
                                 
                                    
                                       y
                                       
                                          ℓ
                                          1
                                       
                                    
                                    >
                                    0
                                 
                               (otherwise, if there is a solution 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    ∈
                                    F
                                 
                               with 
                                 
                                    
                                       x
                                       
                                          ℓ
                                          1
                                       
                                    
                                    <
                                    
                                       a
                                       1
                                    
                                    
                                       y
                                       
                                          ℓ
                                          1
                                       
                                    
                                 
                               then a violated point can be obtained by transferring the values of 
                                 
                                    x
                                    
                                       ℓ
                                       1
                                    
                                 
                               and 
                                 
                                    y
                                    
                                       ℓ
                                       1
                                    
                                 
                               to variables xj
                               and yj
                              , respectively). In each case the condition 
                                 
                                    
                                       x
                                       
                                          ℓ
                                          1
                                       
                                    
                                    =
                                    
                                       a
                                       1
                                    
                                    
                                       y
                                       
                                          ℓ
                                          1
                                       
                                    
                                 
                               holds, which is a contradiction.

To prove (v) suppose 
                                 
                                    
                                       y
                                       j
                                       *
                                    
                                    ≥
                                    2
                                 
                               with j ∈ I
                              1. If 
                                 
                                    
                                       x
                                       j
                                       *
                                    
                                    ≤
                                    
                                       a
                                       1
                                    
                                    
                                       (
                                       
                                          y
                                          j
                                          *
                                       
                                       −
                                       1
                                       )
                                    
                                 
                               a new point violating (3.14) can be obtained by decreasing 
                                 
                                    y
                                    j
                                    *
                                 
                               since, by (i), μj
                               < 0. If 
                                 
                                    
                                       x
                                       j
                                       *
                                    
                                    >
                                    
                                       a
                                       1
                                    
                                    
                                       (
                                       
                                          y
                                          j
                                          *
                                       
                                       −
                                       1
                                       )
                                    
                                 
                               a new point violating (3.14) can be obtaining, using (iv), by decreasing 
                                 
                                    
                                       x
                                       j
                                       *
                                    
                                    ,
                                    
                                       y
                                       j
                                       *
                                    
                                 
                               and increasing 
                                 
                                    
                                       x
                                       
                                          
                                             ℓ
                                             1
                                          
                                       
                                       *
                                    
                                    ,
                                    
                                       y
                                       
                                          
                                             ℓ
                                             1
                                          
                                       
                                       *
                                    
                                 
                               in the same amounts. The case with j ∈ I
                              2 is similar. Finally the case where 
                                 
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          I
                                       
                                    
                                    
                                       y
                                       j
                                       *
                                    
                                    >
                                    1
                                 
                               and 
                                 
                                    
                                       y
                                       j
                                       *
                                    
                                    ≤
                                    1
                                    ,
                                    ∀
                                    j
                                    ∈
                                    I
                                 
                               can be reduced to one of the previous ones by changing, appropriately, the values of the x variables.

First notice that if 
                                 
                                    I
                                    =
                                    ∅
                                 
                               then, from Lemma 3.1, (3.14) is one of the valid inequalities (3.5) obtained from the aggregated model with two integer variables which is a particular case of (3.13).

Next we show that if 
                                 
                                    
                                       N
                                       1
                                    
                                    =
                                    ∅
                                 
                               or 
                                 
                                    
                                       N
                                       2
                                    
                                    =
                                    ∅
                                    ,
                                 
                               then inequality (3.14) is an inequality (3.1) obtained from one of the inequalities (2.4).

Suppose 
                                 
                                    
                                       N
                                       1
                                    
                                    =
                                    ∅
                                    .
                                 
                               Next we show that μj
                              , and νj
                              , are constant for all j ∈ N
                              2. Let 
                                 
                                    
                                       j
                                       *
                                    
                                    ∈
                                    a
                                    r
                                    g
                                    m
                                    a
                                    x
                                    
                                       {
                                       
                                          μ
                                          j
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          ν
                                          j
                                       
                                       :
                                       j
                                       ∈
                                       
                                          N
                                          2
                                       
                                       }
                                    
                                    .
                                 
                               There must exist a point (x, y) in 
                                 
                                    F
                                    
                                       (
                                       μ
                                       ,
                                       ν
                                       ,
                                       λ
                                       )
                                    
                                 
                               satisfying ∑
                                 j ∈ N
                              
                              xj
                               < D. This point must satisfy 
                                 
                                    
                                       x
                                       j
                                    
                                    =
                                    
                                       a
                                       2
                                    
                                    
                                       y
                                       j
                                    
                                    ,
                                    
                                    ∀
                                    j
                                    ∈
                                    
                                       N
                                       2
                                    
                                 
                               since νj
                               > 0, j ∈ N
                              2. Thus, 
                                 
                                    λ
                                    =
                                    
                                       ⌊
                                       D
                                       /
                                       
                                          a
                                          2
                                       
                                       ⌋
                                    
                                    
                                       (
                                       
                                          μ
                                          
                                             j
                                             *
                                          
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          ν
                                          
                                             j
                                             *
                                          
                                       
                                       )
                                    
                                    .
                                 
                               This implies that 
                                 
                                    
                                       μ
                                       j
                                    
                                    +
                                    
                                       γ
                                       2
                                    
                                    
                                       ν
                                       j
                                    
                                    ≤
                                    0
                                 
                               for all j ∈ N
                              2, where 
                                 
                                    
                                       γ
                                       2
                                    
                                    =
                                    D
                                    −
                                    
                                       a
                                       2
                                    
                                    
                                       ⌊
                                       D
                                       /
                                       
                                          a
                                          2
                                       
                                       ⌋
                                    
                                    ,
                                 
                               since otherwise, if 
                                 
                                    
                                       μ
                                       j
                                    
                                    +
                                    
                                       γ
                                       2
                                    
                                    
                                       ν
                                       j
                                    
                                    >
                                    0
                                    ,
                                 
                               then the point obtained by setting 
                                 
                                    
                                       y
                                       
                                          j
                                          *
                                       
                                    
                                    =
                                    
                                       ⌊
                                       D
                                       /
                                       
                                          a
                                          2
                                       
                                       ⌋
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       
                                          j
                                          *
                                       
                                    
                                    =
                                    
                                       a
                                       2
                                    
                                    
                                       y
                                       
                                          j
                                          *
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       y
                                       j
                                    
                                    =
                                    1
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       j
                                    
                                    =
                                    
                                       γ
                                       2
                                    
                                    ,
                                 
                               and the remaining variables to zero, violates (3.14). Hence, if there is j ∈ N
                              2 such that 
                                 
                                    
                                       μ
                                       j
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       ν
                                       j
                                    
                                    <
                                    
                                       μ
                                       
                                          j
                                          *
                                       
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       ν
                                       
                                          j
                                          *
                                       
                                    
                                    ,
                                 
                               then each point in 
                                 
                                    F
                                    
                                       (
                                       μ
                                       ,
                                       ν
                                       ,
                                       λ
                                       )
                                    
                                 
                               satisfies 
                                 
                                    
                                       x
                                       j
                                    
                                    =
                                    
                                       γ
                                       2
                                    
                                    
                                       y
                                       j
                                    
                                    ,
                                 
                               which is a contradiction since (3.14) defines a facet. Thus 
                                 
                                    
                                       μ
                                       j
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       ν
                                       j
                                    
                                    =
                                    
                                       μ
                                       
                                          j
                                          *
                                       
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       ν
                                       
                                          j
                                          *
                                       
                                    
                                 
                               for all j ∈ N
                              2. It remains to prove that 
                                 
                                    
                                       μ
                                       
                                          j
                                          *
                                       
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       ν
                                       
                                          j
                                          *
                                       
                                    
                                    =
                                    
                                       μ
                                       j
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       ν
                                       j
                                    
                                 
                               implies 
                                 
                                    
                                       μ
                                       
                                          j
                                          *
                                       
                                    
                                    =
                                    
                                       μ
                                       j
                                    
                                 
                               and 
                                 
                                    
                                       ν
                                       
                                          j
                                          *
                                       
                                    
                                    =
                                    
                                       ν
                                       j
                                    
                                    .
                                 
                               Suppose not. Assume 
                                 
                                    
                                       μ
                                       
                                          j
                                          *
                                       
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       ν
                                       
                                          j
                                          *
                                       
                                    
                                    =
                                    
                                       μ
                                       j
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       ν
                                       j
                                    
                                 
                               and 
                                 
                                    
                                       μ
                                       j
                                    
                                    >
                                    
                                       μ
                                       
                                          j
                                          *
                                       
                                    
                                    .
                                 
                               This implies 
                                 
                                    
                                       ν
                                       j
                                    
                                    <
                                    
                                       ν
                                       
                                          j
                                          *
                                       
                                    
                                    .
                                 
                               Thus, if there exists a tight point with 
                                 
                                    
                                       x
                                       
                                          j
                                          *
                                       
                                    
                                    <
                                    
                                       a
                                       2
                                    
                                    
                                       y
                                       
                                          j
                                          *
                                       
                                    
                                    ,
                                 
                               one can obtain a feasible solution violating (3.14) by increasing xj
                               in 
                                 
                                    
                                       x
                                       
                                          j
                                          *
                                       
                                    
                                    −
                                    
                                       a
                                       2
                                    
                                    
                                       (
                                       
                                          y
                                          
                                             j
                                             *
                                          
                                       
                                       −
                                       1
                                       )
                                    
                                    ,
                                 
                               
                              yj
                               in one unit, and decreasing 
                                 
                                    x
                                    
                                       j
                                       *
                                    
                                 
                               and 
                                 
                                    y
                                    
                                       j
                                       *
                                    
                                 
                               by the same amounts. This implies 
                                 
                                    
                                       x
                                       
                                          j
                                          *
                                       
                                    
                                    =
                                    
                                       a
                                       2
                                    
                                    
                                       y
                                       
                                          j
                                          *
                                       
                                    
                                 
                               for every point in 
                                 
                                    F
                                    
                                       (
                                       μ
                                       ,
                                       ν
                                       ,
                                       λ
                                       )
                                    
                                 
                               which is a contradiction. The proof for the case 
                                 
                                    
                                       μ
                                       
                                          j
                                          *
                                       
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       ν
                                       
                                          j
                                          *
                                       
                                    
                                    =
                                    
                                       μ
                                       j
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       ν
                                       j
                                    
                                 
                               and 
                                 
                                    
                                       μ
                                       j
                                    
                                    <
                                    
                                       μ
                                       
                                          j
                                          *
                                       
                                    
                                 
                               is similar and implies 
                                 
                                    
                                       x
                                       j
                                    
                                    =
                                    
                                       a
                                       2
                                    
                                    
                                       y
                                       j
                                    
                                 
                               for every point in 
                                 
                                    F
                                    
                                       (
                                       μ
                                       ,
                                       ν
                                       ,
                                       λ
                                       )
                                    
                                 
                              . Thus 
                                 
                                    
                                       μ
                                       j
                                    
                                    =
                                    
                                       μ
                                       
                                          j
                                          *
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       ν
                                       j
                                    
                                    =
                                    
                                       ν
                                       
                                          j
                                          *
                                       
                                    
                                    ,
                                 
                               for all j ∈ N
                              2. Using Lemma 3.1, we conclude that (3.14) must be obtained from a facet-defining inequality for the set with 
                                 
                                    n
                                    =
                                    1
                                    .
                                 
                               Thus (3.14) belongs to family (3.5) obtained from a inequality (2.4) with 
                                 
                                    t
                                    =
                                    2
                                    .
                                 
                               Similarly, if 
                                 
                                    
                                       N
                                       2
                                    
                                    =
                                    ∅
                                    ,
                                 
                               then (3.5) results from (2.4) with 
                                 
                                    t
                                    =
                                    1
                                    .
                                 
                              
                           

Henceforth we assume N
                              1 ≠ ∅, N
                              2 ≠ ∅. If 
                                 
                                    I
                                    =
                                    ∅
                                    ,
                                 
                               then 
                                 
                                    
                                       μ
                                       j
                                    
                                    =
                                    
                                       μ
                                       
                                          ℓ
                                          t
                                       
                                    
                                    ,
                                 
                               and 
                                 
                                    
                                       ν
                                       j
                                    
                                    =
                                    
                                       ν
                                       
                                          ℓ
                                          t
                                       
                                    
                                    ,
                                 
                               
                              j ∈ Nt, t ∈ {1, 2}. From Lemma 3.1 we conclude that (3.14) must be obtained from a facet-defining inequality for the set conv(Z) with 
                                 
                                    ∣
                                    
                                       N
                                       1
                                    
                                    ∣
                                    =
                                    ∣
                                    
                                       N
                                       2
                                    
                                    ∣
                                    =
                                    1
                                    .
                                 
                               By Theorem (2.5) we conclude that coefficients 
                                 
                                    (
                                    
                                       μ
                                       
                                          ℓ
                                          1
                                       
                                    
                                    ,
                                    
                                       ν
                                       
                                          ℓ
                                          1
                                       
                                    
                                    ,
                                    
                                       μ
                                       
                                          ℓ
                                          2
                                       
                                    
                                    ,
                                    
                                       ν
                                       
                                          ℓ
                                          2
                                       
                                    
                                    ,
                                    λ
                                    )
                                 
                               of (3.14) belong to Λ, that is, they result from (2.1), (2.2), (2.3).

Henceforth we assume I ≠ ∅. We will also use the notation 
                                 
                                    
                                       X
                                       t
                                    
                                    =
                                    X
                                    
                                       (
                                       
                                          S
                                          t
                                       
                                       )
                                    
                                    ,
                                    
                                    
                                       Y
                                       t
                                    
                                    =
                                    Y
                                    
                                       (
                                       
                                          S
                                          t
                                       
                                       )
                                    
                                    ,
                                    t
                                    ∈
                                    
                                       {
                                       1
                                       ,
                                       2
                                       }
                                    
                                    .
                                 
                              
                           

Let j ∈ I and consider a point 
                                 
                                    
                                       (
                                       
                                          y
                                          *
                                       
                                       ,
                                       
                                          x
                                          *
                                       
                                       )
                                    
                                    ∈
                                    
                                       F
                                       
                                          (
                                          μ
                                          ,
                                          ν
                                          ,
                                          λ
                                          )
                                       
                                    
                                    ∩
                                    X
                                 
                               such that 
                                 
                                    
                                       y
                                       j
                                       *
                                    
                                    >
                                    0
                                    .
                                 
                               From (v) we have 
                                 
                                    
                                       y
                                       j
                                       *
                                    
                                    =
                                    1
                                 
                               and from (i)-(iv) it follows 
                                 
                                    
                                       x
                                       j
                                       *
                                    
                                    =
                                    D
                                    −
                                    
                                       X
                                       
                                          1
                                       
                                       *
                                    
                                    −
                                    
                                       X
                                       
                                          2
                                       
                                       *
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       X
                                       
                                          1
                                       
                                       *
                                    
                                    =
                                    
                                       a
                                       1
                                    
                                    
                                       Y
                                       
                                          1
                                       
                                       *
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       X
                                       
                                          2
                                       
                                       *
                                    
                                    =
                                    
                                       a
                                       2
                                    
                                    
                                       Y
                                       
                                          2
                                       
                                       *
                                    
                                    .
                                 
                               Suppose j ∈ I
                              1. As 
                                 
                                    0
                                    <
                                    
                                       x
                                       j
                                       *
                                    
                                    <
                                    
                                       a
                                       1
                                    
                                    
                                       y
                                       j
                                       *
                                    
                                 
                               implies 
                                 
                                    0
                                    <
                                    D
                                    −
                                    
                                       X
                                       
                                          1
                                       
                                       *
                                    
                                    −
                                    
                                       X
                                       
                                          2
                                       
                                       *
                                    
                                    <
                                    
                                       a
                                       1
                                    
                                    ⇒
                                    0
                                    <
                                    D
                                    −
                                    
                                       a
                                       1
                                    
                                    
                                       Y
                                       
                                          1
                                       
                                       *
                                    
                                    −
                                    
                                       a
                                       2
                                    
                                    
                                       Y
                                       
                                          2
                                       
                                       *
                                    
                                    <
                                    
                                       a
                                       1
                                    
                                    ⇒
                                    
                                       (
                                       
                                          Y
                                          
                                             1
                                          
                                          *
                                       
                                       ,
                                       
                                          Y
                                          
                                             2
                                          
                                          *
                                       
                                       )
                                    
                                    ∈
                                    
                                       Σ
                                       1
                                    
                                    .
                                 
                               Since (y
                              *, x
                              *) belongs to 
                                 
                                    
                                       F
                                       
                                          (
                                          μ
                                          ,
                                          ν
                                          ,
                                          λ
                                          )
                                       
                                    
                                    ,
                                 
                               it satisfies (3.14) at equality. Thus, setting 
                                 
                                    
                                       x
                                       j
                                       *
                                    
                                    =
                                    D
                                    −
                                    
                                       X
                                       
                                          1
                                       
                                       *
                                    
                                    −
                                    
                                       X
                                       
                                          2
                                       
                                       *
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       X
                                       
                                          1
                                       
                                       *
                                    
                                    =
                                    
                                       a
                                       1
                                    
                                    
                                       Y
                                       
                                          1
                                       
                                       *
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       X
                                       
                                          2
                                       
                                       *
                                    
                                    =
                                    
                                       a
                                       2
                                    
                                    
                                       Y
                                       
                                          2
                                       
                                       *
                                    
                                    ,
                                 
                               and 
                                 
                                    
                                       x
                                       
                                          j
                                          ′
                                       
                                       *
                                    
                                    =
                                    0
                                    ,
                                    
                                       j
                                       ′
                                    
                                    ∉
                                    
                                       S
                                       1
                                    
                                    ∪
                                    
                                       S
                                       2
                                    
                                    ∪
                                    
                                       {
                                       j
                                       }
                                    
                                    ,
                                 
                               then we have 
                                 
                                    
                                       Y
                                       
                                          1
                                       
                                       *
                                    
                                    
                                       (
                                       
                                          μ
                                          
                                             ℓ
                                             1
                                          
                                       
                                       +
                                       
                                          a
                                          1
                                       
                                       
                                          ν
                                          
                                             ℓ
                                             1
                                          
                                       
                                       −
                                       
                                          a
                                          1
                                       
                                       
                                          ν
                                          j
                                       
                                       )
                                    
                                    +
                                    
                                       Y
                                       
                                          2
                                       
                                       *
                                    
                                    
                                       (
                                       
                                          μ
                                          
                                             ℓ
                                             2
                                          
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          ν
                                          
                                             ℓ
                                             2
                                          
                                       
                                       −
                                       
                                          a
                                          2
                                       
                                       
                                          ν
                                          j
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    =
                                    λ
                                    −
                                    D
                                    
                                       ν
                                       j
                                    
                                    −
                                    
                                       μ
                                       j
                                    
                                    .
                                 
                               Therefore 
                                 
                                    (
                                    
                                       Y
                                       
                                          1
                                       
                                       *
                                    
                                    ,
                                    
                                       Y
                                       
                                          2
                                       
                                       *
                                    
                                    )
                                 
                               must be optimal to

                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   (AP1):
                                                   
                                                   max
                                                   {
                                                   
                                                      (
                                                      
                                                         μ
                                                         
                                                            ℓ
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         a
                                                         1
                                                      
                                                      
                                                         ν
                                                         
                                                            ℓ
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         a
                                                         1
                                                      
                                                      
                                                         ν
                                                         j
                                                      
                                                      )
                                                   
                                                   
                                                      Y
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   +
                                                   
                                                   
                                                      (
                                                      
                                                         μ
                                                         
                                                            ℓ
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         a
                                                         2
                                                      
                                                      
                                                         ν
                                                         
                                                            ℓ
                                                            2
                                                         
                                                      
                                                      −
                                                      
                                                         a
                                                         2
                                                      
                                                      
                                                         ν
                                                         j
                                                      
                                                      )
                                                   
                                                   
                                                      Y
                                                      2
                                                   
                                                   :
                                                   
                                                      (
                                                      
                                                         Y
                                                         1
                                                      
                                                      ,
                                                      
                                                         Y
                                                         2
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      Σ
                                                      1
                                                   
                                                   
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              (otherwise, considering an optimal solution to AP1 we could construct a point violating (3.14)). Similarly, if j ∈ I
                              2 then 
                                 
                                    (
                                    
                                       Y
                                       
                                          1
                                       
                                       *
                                    
                                    ,
                                    
                                       Y
                                       
                                          2
                                       
                                       *
                                    
                                    )
                                 
                               must be optimal to

                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   (AP2):
                                                   
                                                   max
                                                   {
                                                   
                                                      (
                                                      
                                                         μ
                                                         
                                                            ℓ
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         a
                                                         1
                                                      
                                                      
                                                         ν
                                                         
                                                            ℓ
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         a
                                                         1
                                                      
                                                      
                                                         ν
                                                         j
                                                      
                                                      )
                                                   
                                                   
                                                      Y
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   +
                                                   
                                                   
                                                      (
                                                      
                                                         μ
                                                         
                                                            ℓ
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         a
                                                         2
                                                      
                                                      
                                                         ν
                                                         
                                                            ℓ
                                                            2
                                                         
                                                      
                                                      −
                                                      
                                                         a
                                                         2
                                                      
                                                      
                                                         ν
                                                         j
                                                      
                                                      )
                                                   
                                                   
                                                      Y
                                                      2
                                                   
                                                   :
                                                   
                                                      (
                                                      
                                                         Y
                                                         1
                                                      
                                                      ,
                                                      
                                                         Y
                                                         2
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      Σ
                                                      2
                                                   
                                                   
                                                      }
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              Case 1. There is a i ∈ I such that

                                 
                                    (3.15)
                                    
                                       
                                          
                                             μ
                                             
                                                ℓ
                                                1
                                             
                                          
                                          +
                                          
                                             a
                                             1
                                          
                                          
                                             ν
                                             
                                                ℓ
                                                1
                                             
                                          
                                          −
                                          
                                             a
                                             1
                                          
                                          
                                             ν
                                             i
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    (3.16)
                                    
                                       
                                          
                                             μ
                                             
                                                ℓ
                                                2
                                             
                                          
                                          +
                                          
                                             a
                                             2
                                          
                                          
                                             ν
                                             
                                                ℓ
                                                2
                                             
                                          
                                          −
                                          
                                             a
                                             2
                                          
                                          
                                             ν
                                             i
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                 
                              which implies 
                                 
                                    
                                       
                                          
                                             
                                                μ
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                             +
                                             
                                                a
                                                2
                                             
                                             
                                                ν
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                μ
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                             +
                                             
                                                a
                                                1
                                             
                                             
                                                ν
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             a
                                             2
                                          
                                          
                                             a
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           

There must exist solutions (y, x) in 
                                 
                                    F
                                    
                                       (
                                       μ
                                       ,
                                       ν
                                       ,
                                       λ
                                       )
                                    
                                 
                               satisfying 
                                 
                                    
                                       y
                                       i
                                    
                                    =
                                    0
                                 
                               and 
                                 
                                    
                                       X
                                       1
                                    
                                    +
                                    
                                       X
                                       2
                                    
                                    <
                                    D
                                 
                               (since yj
                               > 0 for some j ∈ I implies 
                                 
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    
                                       x
                                       j
                                    
                                    =
                                    D
                                 
                               because νj
                               > 0). Then 
                                 
                                    
                                       x
                                       j
                                    
                                    =
                                    
                                       y
                                       j
                                    
                                    =
                                    0
                                    ,
                                    j
                                    ∈
                                    I
                                    .
                                 
                               In those cases 
                                 
                                    
                                       X
                                       1
                                    
                                    =
                                    
                                       a
                                       1
                                    
                                    
                                       Y
                                       1
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       X
                                       2
                                    
                                    =
                                    
                                       a
                                       2
                                    
                                    
                                       Y
                                       2
                                    
                                    ,
                                 
                               because 
                                 
                                    
                                       ν
                                       
                                          ℓ
                                          1
                                       
                                    
                                    ,
                                    
                                       ν
                                       
                                          ℓ
                                          2
                                       
                                    
                                    >
                                    0
                                    .
                                 
                               Hence, 
                                 
                                    
                                       μ
                                       
                                          ℓ
                                          1
                                       
                                    
                                    
                                       Y
                                       1
                                    
                                    +
                                    
                                       μ
                                       
                                          ℓ
                                          2
                                       
                                    
                                    
                                       Y
                                       2
                                    
                                    +
                                    
                                       ν
                                       
                                          ℓ
                                          1
                                       
                                    
                                    
                                       X
                                       1
                                    
                                    +
                                    
                                       ν
                                       
                                          ℓ
                                          2
                                       
                                    
                                    
                                       Y
                                       2
                                    
                                    =
                                    λ
                                 
                              
                              
                                 
                                    ⇔
                                    
                                       (
                                       
                                          μ
                                          
                                             ℓ
                                             1
                                          
                                       
                                       +
                                       
                                          a
                                          1
                                       
                                       
                                          ν
                                          
                                             ℓ
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       Y
                                       1
                                    
                                    +
                                    
                                       (
                                       
                                          μ
                                          
                                             ℓ
                                             2
                                          
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          ν
                                          
                                             ℓ
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       Y
                                       2
                                    
                                    =
                                    λ
                                    .
                                 
                               Using Eqs. (3.15) and (3.16) it follows that 
                                 
                                    
                                       a
                                       1
                                    
                                    
                                       ν
                                       i
                                    
                                    
                                       Y
                                       1
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       ν
                                       i
                                    
                                    
                                       Y
                                       2
                                    
                                    =
                                    λ
                                    .
                                 
                               Noticing that 
                                 
                                    
                                       (
                                       
                                          Y
                                          1
                                       
                                       ,
                                       
                                          Y
                                          2
                                       
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       ≤
                                    
                                 
                               then 
                                 
                                    λ
                                    =
                                    
                                       ν
                                       i
                                    
                                    max
                                    
                                       {
                                       
                                          a
                                          1
                                       
                                       
                                          Y
                                          1
                                          ′
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          Y
                                          2
                                          ′
                                       
                                       :
                                       
                                          (
                                          
                                             Y
                                             1
                                             ′
                                          
                                          ,
                                          
                                             Y
                                             2
                                             ′
                                          
                                          )
                                       
                                       ∈
                                       
                                          Y
                                          ≤
                                       
                                       }
                                    
                                    ⇒
                                    λ
                                    =
                                    
                                       ν
                                       i
                                    
                                    
                                       (
                                       D
                                       −
                                       γ
                                       )
                                    
                                    ,
                                 
                               where 
                                 
                                    γ
                                    =
                                    D
                                    −
                                    max
                                    {
                                    
                                       a
                                       1
                                    
                                    
                                       Y
                                       1
                                       ′
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       Y
                                       2
                                       ′
                                    
                                    :
                                    
                                       (
                                       
                                          Y
                                          1
                                          ′
                                       
                                       ,
                                       
                                          Y
                                          2
                                          ′
                                       
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       ≤
                                    
                                    }
                                    .
                                 
                              
                           

There must exist solutions in 
                                 
                                    F
                                    
                                       (
                                       μ
                                       ,
                                       ν
                                       ,
                                       λ
                                       )
                                    
                                 
                               satisfying 
                                 
                                    
                                       y
                                       i
                                    
                                    =
                                    0
                                 
                               and 0 < X
                              1 < a
                              1
                              Y
                              1 (otherwise 
                                 
                                    
                                       X
                                       1
                                    
                                    =
                                    
                                       a
                                       1
                                    
                                    
                                       Y
                                       1
                                    
                                 
                               for every point in 
                                 F
                              ). Again 
                                 
                                    
                                       x
                                       j
                                    
                                    =
                                    
                                       y
                                       j
                                    
                                    =
                                    0
                                    ,
                                    j
                                    ∈
                                    I
                                    .
                                 
                               In this case it must occur 
                                 
                                    
                                       X
                                       2
                                    
                                    =
                                    
                                       a
                                       2
                                    
                                    
                                       Y
                                       2
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       X
                                       1
                                    
                                    =
                                    D
                                    −
                                    
                                       X
                                       2
                                    
                                    =
                                    D
                                    −
                                    
                                       a
                                       2
                                    
                                    
                                       Y
                                       2
                                    
                                    .
                                 
                               Thus,

                                 
                                    
                                       
                                          
                                             μ
                                             
                                                ℓ
                                                1
                                             
                                          
                                          
                                             Y
                                             1
                                          
                                          +
                                          
                                             (
                                             D
                                             −
                                             
                                                a
                                                2
                                             
                                             
                                                Y
                                                2
                                             
                                             )
                                          
                                          
                                             ν
                                             
                                                ℓ
                                                1
                                             
                                          
                                          +
                                          
                                             (
                                             
                                                μ
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                             +
                                             
                                                a
                                                2
                                             
                                             
                                                ν
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             Y
                                             2
                                          
                                          =
                                          λ
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          ⇔
                                          
                                             μ
                                             
                                                ℓ
                                                1
                                             
                                          
                                          
                                             Y
                                             1
                                          
                                          +
                                          
                                             (
                                             
                                                μ
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                             +
                                             
                                                a
                                                2
                                             
                                             
                                                ν
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                             −
                                             
                                                a
                                                2
                                             
                                             
                                                ν
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             Y
                                             2
                                          
                                          =
                                          λ
                                          −
                                          
                                             ν
                                             
                                                ℓ
                                                1
                                             
                                          
                                          D
                                          .
                                       
                                    
                                 
                              Using (3.15) and (3.16) it follows that

                                 
                                    
                                       
                                          
                                             a
                                             1
                                          
                                          
                                             (
                                             
                                                ν
                                                i
                                             
                                             −
                                             
                                                ν
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             Y
                                             1
                                          
                                          +
                                          
                                             a
                                             2
                                          
                                          
                                             (
                                             
                                                ν
                                                i
                                             
                                             −
                                             
                                                ν
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             Y
                                             2
                                          
                                          =
                                          λ
                                          −
                                          
                                             ν
                                             
                                                ℓ
                                                1
                                             
                                          
                                          D
                                          .
                                       
                                    
                                 
                              Noticing that 
                                 
                                    
                                       (
                                       
                                          Y
                                          1
                                       
                                       ,
                                       
                                          Y
                                          2
                                       
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       1
                                    
                                 
                               and by (iii) 
                                 
                                    
                                       ν
                                       i
                                    
                                    −
                                    
                                       ν
                                       
                                          ℓ
                                          1
                                       
                                    
                                    <
                                    0
                                    ,
                                 
                               then 
                                 
                                    λ
                                    −
                                    
                                       ν
                                       
                                          ℓ
                                          1
                                       
                                    
                                    D
                                    =
                                    
                                       (
                                       
                                          ν
                                          i
                                       
                                       −
                                       
                                          ν
                                          
                                             ℓ
                                             1
                                          
                                       
                                       )
                                    
                                    min
                                    
                                       {
                                       
                                          a
                                          1
                                       
                                       
                                          Y
                                          1
                                          ′
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          Y
                                          2
                                          ′
                                       
                                       :
                                       
                                          (
                                          
                                             Y
                                             1
                                             ′
                                          
                                          ,
                                          
                                             Y
                                             2
                                             ′
                                          
                                          )
                                       
                                       ∈
                                       
                                          Y
                                          1
                                       
                                       }
                                    
                                    =
                                    
                                       (
                                       
                                          ν
                                          i
                                       
                                       −
                                       
                                          ν
                                          
                                             ℓ
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       D
                                       +
                                       
                                          ϵ
                                          1
                                       
                                       )
                                    
                                    ,
                                 
                               where 
                                 
                                    
                                       ϵ
                                       1
                                    
                                    =
                                    min
                                    
                                       {
                                       
                                          a
                                          1
                                       
                                       
                                          Y
                                          1
                                          ′
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          Y
                                          2
                                          ′
                                       
                                       :
                                       
                                          (
                                          
                                             Y
                                             1
                                             ′
                                          
                                          ,
                                          
                                             Y
                                             2
                                             ′
                                          
                                          )
                                       
                                       ∈
                                       
                                          Y
                                          1
                                       
                                       }
                                    
                                    −
                                    D
                                    .
                                 
                               Similarly, using a solution in 
                                 
                                    F
                                    
                                       (
                                       μ
                                       ,
                                       ν
                                       ,
                                       λ
                                       )
                                    
                                 
                               satisfying 
                                 
                                    
                                       y
                                       i
                                    
                                    =
                                    0
                                 
                               and 0 < X
                              2 < a
                              2
                              Y
                              2 we conclude 
                                 
                                    λ
                                    −
                                    
                                       ν
                                       
                                          ℓ
                                          2
                                       
                                    
                                    D
                                    =
                                    
                                       (
                                       
                                          ν
                                          t
                                       
                                       −
                                       
                                          ν
                                          
                                             ℓ
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       D
                                       +
                                       
                                          ϵ
                                          2
                                       
                                       )
                                    
                                 
                               where 
                                 
                                    
                                       ϵ
                                       1
                                    
                                    =
                                    min
                                    
                                       {
                                       
                                          a
                                          1
                                       
                                       
                                          Y
                                          1
                                          ′
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          Y
                                          2
                                          ′
                                       
                                       :
                                       
                                          (
                                          
                                             Y
                                             1
                                             ′
                                          
                                          ,
                                          
                                             Y
                                             2
                                             ′
                                          
                                          )
                                       
                                       ∈
                                       
                                          Y
                                          2
                                       
                                       }
                                    
                                    −
                                    D
                                    .
                                 
                              
                           

Next we show that

                                 
                                    (3.17)
                                    
                                       
                                          
                                             μ
                                             j
                                          
                                          =
                                          
                                             μ
                                             i
                                          
                                          
                                          and
                                          
                                          
                                             ν
                                             j
                                          
                                          =
                                          
                                             ν
                                             i
                                          
                                          ,
                                          ∀
                                          j
                                          ∈
                                          I
                                       
                                    
                                 
                              Suppose conditions (3.17) do not hold for some j ∈ I
                              1 (for j ∈ I
                              2 the proof is similar). For each point in 
                                 
                                    F
                                    
                                       (
                                       μ
                                       ,
                                       ν
                                       ,
                                       λ
                                       )
                                    
                                 
                               with xj
                               > 0 we have

                                 
                                    
                                       
                                          
                                             (
                                             
                                                μ
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                             +
                                             
                                                a
                                                1
                                             
                                             
                                                ν
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             Y
                                             1
                                          
                                          +
                                          
                                             (
                                             
                                                μ
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                             +
                                             
                                                a
                                                2
                                             
                                             
                                                ν
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             Y
                                             2
                                          
                                          +
                                          
                                             μ
                                             j
                                          
                                          +
                                          
                                             ν
                                             j
                                          
                                          
                                             x
                                             j
                                          
                                          =
                                          λ
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          ⇔
                                          
                                             a
                                             1
                                          
                                          
                                             ν
                                             i
                                          
                                          
                                             Y
                                             1
                                          
                                          +
                                          
                                             a
                                             2
                                          
                                          
                                             ν
                                             i
                                          
                                          
                                             Y
                                             2
                                          
                                          +
                                          
                                             μ
                                             j
                                          
                                          +
                                          
                                             ν
                                             j
                                          
                                          
                                             (
                                             D
                                             −
                                             
                                                a
                                                1
                                             
                                             
                                                Y
                                                1
                                             
                                             −
                                             
                                                a
                                                2
                                             
                                             
                                                Y
                                                2
                                             
                                             )
                                          
                                          =
                                          λ
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          ⇔
                                          
                                             a
                                             1
                                          
                                          
                                             (
                                             
                                                ν
                                                i
                                             
                                             −
                                             
                                                ν
                                                j
                                             
                                             )
                                          
                                          
                                             Y
                                             1
                                          
                                          +
                                          
                                             a
                                             2
                                          
                                          
                                             (
                                             
                                                ν
                                                i
                                             
                                             −
                                             
                                                ν
                                                j
                                             
                                             )
                                          
                                          
                                             Y
                                             2
                                          
                                          =
                                          λ
                                          −
                                          
                                             ν
                                             j
                                          
                                          D
                                          −
                                          
                                             μ
                                             j
                                          
                                          .
                                       
                                    
                                 
                              Thus 
                                 
                                    
                                       (
                                       
                                          Y
                                          1
                                       
                                       ,
                                       
                                          Y
                                          2
                                       
                                       )
                                    
                                    =
                                    a
                                    r
                                    g
                                    m
                                    a
                                    x
                                    
                                       {
                                       
                                          a
                                          1
                                       
                                       
                                          Y
                                          1
                                          ′
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          Y
                                          2
                                          ′
                                       
                                       :
                                       
                                          (
                                          
                                             Y
                                             1
                                             ′
                                          
                                          ,
                                          
                                             Y
                                             2
                                             ′
                                          
                                          )
                                       
                                       ∈
                                       
                                          Σ
                                          1
                                       
                                       }
                                    
                                 
                               if νi
                               > νj
                               and 
                                 
                                    
                                       (
                                       
                                          Y
                                          1
                                       
                                       ,
                                       
                                          Y
                                          2
                                       
                                       )
                                    
                                    =
                                    a
                                    r
                                    g
                                    m
                                    i
                                    n
                                    
                                       {
                                       
                                          a
                                          1
                                       
                                       
                                          Y
                                          1
                                          ′
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       
                                          Y
                                          2
                                          ′
                                       
                                       :
                                       
                                          (
                                          
                                             Y
                                             1
                                             ′
                                          
                                          ,
                                          
                                             Y
                                             2
                                             ′
                                          
                                          )
                                       
                                       ∈
                                       
                                          Σ
                                          1
                                       
                                       }
                                    
                                    ,
                                 
                               otherwise. Let us define 
                                 
                                    φ
                                    =
                                    D
                                    −
                                    max
                                    {
                                    
                                       a
                                       1
                                    
                                    
                                       Y
                                       1
                                       ′
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       Y
                                       2
                                       ′
                                    
                                    :
                                    
                                       (
                                       
                                          Y
                                          1
                                          ′
                                       
                                       ,
                                       
                                          Y
                                          2
                                          ′
                                       
                                       )
                                    
                                    ∈
                                    
                                       Σ
                                       1
                                    
                                    }
                                 
                               if νt
                               > νj
                               and 
                                 
                                    φ
                                    =
                                    D
                                    −
                                    m
                                    i
                                    n
                                    {
                                    
                                       a
                                       1
                                    
                                    
                                       Y
                                       1
                                       ′
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       Y
                                       2
                                       ′
                                    
                                    :
                                    
                                       (
                                       
                                          Y
                                          1
                                          ′
                                       
                                       ,
                                       
                                          Y
                                          2
                                          ′
                                       
                                       )
                                    
                                    ∈
                                    
                                       Σ
                                       1
                                    
                                    }
                                 
                               otherwise. Hence 
                                 
                                    
                                       x
                                       j
                                    
                                    =
                                    φ
                                    
                                       y
                                       j
                                    
                                 
                               for each point in 
                                 
                                    
                                       F
                                       
                                          (
                                          μ
                                          ,
                                          ν
                                          ,
                                          λ
                                          )
                                       
                                    
                                    ,
                                 
                               which is a contradiction.

Using (3.17) and the six equations: (3.15); (3.16); 
                                 
                                    λ
                                    =
                                    D
                                    
                                       ν
                                       i
                                    
                                    +
                                    
                                       μ
                                       i
                                    
                                    ;
                                 
                              
                              
                                 
                                    λ
                                    =
                                    
                                       ν
                                       i
                                    
                                    
                                       (
                                       D
                                       −
                                       γ
                                       )
                                    
                                    ;
                                 
                              
                              
                                 
                                    λ
                                    −
                                    
                                       ν
                                       
                                          ℓ
                                          1
                                       
                                    
                                    D
                                    =
                                    
                                       (
                                       
                                          ν
                                          i
                                       
                                       −
                                       
                                          ν
                                          
                                             ℓ
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       D
                                       +
                                       
                                          ϵ
                                          1
                                       
                                       )
                                    
                                    ;
                                 
                              
                              
                                 
                                    λ
                                    −
                                    
                                       ν
                                       
                                          ℓ
                                          2
                                       
                                    
                                    D
                                    =
                                    
                                       (
                                       
                                          ν
                                          i
                                       
                                       −
                                       
                                          ν
                                          
                                             ℓ
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       D
                                       +
                                       
                                          ϵ
                                          2
                                       
                                       )
                                    
                                    ;
                                 
                               we conclude that the facet is defined by inequality (3.6).


                              Case 2.
                              
                                 
                                    
                                       
                                          
                                             
                                                μ
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                             +
                                             
                                                a
                                                2
                                             
                                             
                                                ν
                                                
                                                   ℓ
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                μ
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                             +
                                             
                                                a
                                                1
                                             
                                             
                                                ν
                                                
                                                   ℓ
                                                   1
                                                
                                             
                                          
                                       
                                       ≠
                                       
                                          
                                             a
                                             2
                                          
                                          
                                             a
                                             1
                                          
                                       
                                       .
                                    
                                 
                               Next we show that the inequality defined by 
                                 
                                    (
                                    
                                       μ
                                       
                                          ℓ
                                          1
                                       
                                    
                                    ,
                                    
                                       μ
                                       
                                          ℓ
                                          2
                                       
                                    
                                    ,
                                    
                                       ν
                                       
                                          ℓ
                                          1
                                       
                                    
                                    ,
                                    
                                       ν
                                       
                                          ℓ
                                          2
                                       
                                    
                                    ,
                                    λ
                                    )
                                    :
                                 
                              
                              
                                 
                                    (3.18)
                                    
                                       
                                          
                                             μ
                                             1
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   S
                                                   1
                                                
                                             
                                          
                                          
                                             y
                                             j
                                          
                                          +
                                          
                                             μ
                                             2
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   S
                                                   2
                                                
                                             
                                          
                                          
                                             y
                                             j
                                          
                                          +
                                          
                                             ν
                                             1
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   S
                                                   1
                                                
                                             
                                          
                                          
                                             x
                                             j
                                          
                                          +
                                          
                                             ν
                                             2
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   S
                                                   2
                                                
                                             
                                          
                                          
                                             x
                                             j
                                          
                                          ≤
                                          λ
                                       
                                    
                                 
                              must define a facet of the polyhedron with 
                                 
                                    
                                       N
                                       ′
                                    
                                    =
                                    N
                                    ∖
                                    I
                                    .
                                 
                               Since 
                                 
                                    F
                                    
                                       (
                                       μ
                                       ,
                                       ν
                                       ,
                                       λ
                                       )
                                    
                                 
                               is a facet of P it includes a set 
                                 A
                               with 2n affinely independent points. For each i ∈ I there must exist in 
                                 A
                               at least two points with 
                                 
                                    
                                       y
                                       i
                                    
                                    =
                                    1
                                    .
                                 
                               However, since each point in 
                                 
                                    
                                       F
                                       
                                          (
                                          μ
                                          ,
                                          ν
                                          ,
                                          λ
                                          )
                                       
                                    
                                    ∈
                                    X
                                 
                               with 
                                 
                                    
                                       y
                                       i
                                    
                                    =
                                    1
                                    ,
                                 
                               
                              i ∈ I
                              1, corresponds to an optimal solution to AP1, it follows that there are in 
                                 A
                               exactly two points with 
                                 
                                    
                                       y
                                       i
                                    
                                    =
                                    1
                                 
                               for each i ∈ I
                              1 (observe that the hypothesis 
                                 
                                    
                                       
                                          
                                             μ
                                             
                                                ℓ
                                                2
                                             
                                          
                                          +
                                          
                                             a
                                             2
                                          
                                          
                                             ν
                                             
                                                ℓ
                                                2
                                             
                                          
                                       
                                       
                                          
                                             μ
                                             
                                                ℓ
                                                1
                                             
                                          
                                          +
                                          
                                             a
                                             1
                                          
                                          
                                             ν
                                             
                                                ℓ
                                                1
                                             
                                          
                                       
                                    
                                    ≠
                                    
                                       
                                          a
                                          2
                                       
                                       
                                          a
                                          1
                                       
                                    
                                 
                               implies that the coefficients of the objective function of AP1 are not simultaneously null). Thus 
                                 A
                               includes 
                                 
                                    2
                                    (
                                    n
                                    −
                                    ∣
                                    
                                       I
                                       1
                                    
                                    ∣
                                    )
                                 
                               affinely independent points with 
                                 
                                    
                                       x
                                       i
                                    
                                    =
                                    
                                       y
                                       i
                                    
                                    =
                                    0
                                 
                               for i ∈ I
                              1. Similarly, considering i ∈ I
                              2, we conclude that 
                                 A
                               includes 
                                 
                                    2
                                    (
                                    n
                                    −
                                    ∣
                                    
                                       I
                                       2
                                    
                                    ∣
                                    )
                                 
                               affinely independent points with 
                                 
                                    
                                       x
                                       i
                                    
                                    =
                                    
                                       y
                                       i
                                    
                                    =
                                    0
                                 
                               for i ∈ I
                              2. This implies that (3.18) defines a facet of the polyhedron with 
                                 
                                    
                                       N
                                       ′
                                    
                                    =
                                    N
                                    ∖
                                    I
                                    .
                                 
                               From Lemma 3.1, we conclude that it defines a facet for the 2-integer variables model Z.

As (3.14) is valid, then 
                                 
                                    
                                       (
                                       
                                          μ
                                          i
                                       
                                       ,
                                       
                                          ν
                                          i
                                       
                                       )
                                    
                                    ∈
                                    
                                       Θ
                                       
                                          (
                                          
                                             μ
                                             u
                                          
                                          ,
                                          
                                             μ
                                             ℓ
                                          
                                          ,
                                          
                                             ν
                                             u
                                          
                                          ,
                                          
                                             ν
                                             ℓ
                                          
                                          ,
                                          λ
                                          )
                                       
                                       1
                                    
                                    .
                                 
                               Observe that the points in 
                                 
                                    
                                       F
                                       
                                          (
                                          μ
                                          ,
                                          ν
                                          ,
                                          λ
                                          )
                                       
                                    
                                    ∩
                                    X
                                 
                               with 
                                 
                                    
                                       y
                                       i
                                    
                                    =
                                    1
                                 
                               are obtained from two optimal solutions to AP1 which belong to V(Σ
                              1). These two extreme points in V(Σ
                              1) give the two tight constraints of 
                                 
                                    Θ
                                    
                                       (
                                       
                                          μ
                                          u
                                       
                                       ,
                                       
                                          μ
                                          ℓ
                                       
                                       ,
                                       
                                          ν
                                          u
                                       
                                       ,
                                       
                                          ν
                                          ℓ
                                       
                                       ,
                                       λ
                                       )
                                    
                                    1
                                 
                               defining the extreme point (μi, νi
                              ).

Hence, (3.14) is of type (3.13).□

In this section we study the separation problems associated with the families of valid inequalities derived for X. Consider a point 
                           
                              
                                 (
                                 y
                                 ,
                                 x
                                 )
                              
                              ∈
                              
                                 R
                                 
                                    2
                                    n
                                 
                              
                              .
                           
                         For each family of valid inequalities the separation problem is: find an inequality that is violated by (y, x) or show that no such inequality exists.

First we consider inequalities (3.6). Sets S
                        1, S
                        2 maximize the left-hand side of (3.6) if and only if:

                           
                              
                                 
                                    
                                       {
                                       j
                                       ∈
                                       
                                          N
                                          1
                                       
                                       :
                                       
                                          x
                                          j
                                       
                                       −
                                       γ
                                       
                                          y
                                          j
                                       
                                       <
                                       
                                          a
                                          1
                                       
                                       
                                          y
                                          j
                                       
                                       +
                                       
                                          
                                             γ
                                             +
                                             
                                                ϵ
                                                1
                                             
                                          
                                          
                                             ϵ
                                             1
                                          
                                       
                                       
                                          x
                                          j
                                       
                                       −
                                       
                                          a
                                          1
                                       
                                       
                                          
                                             γ
                                             +
                                             
                                                ϵ
                                                1
                                             
                                          
                                          
                                             ϵ
                                             1
                                          
                                       
                                       
                                          y
                                          j
                                       
                                       }
                                    
                                    ⊆
                                    
                                       S
                                       1
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       {
                                       j
                                       ∈
                                       
                                          N
                                          1
                                       
                                       :
                                       
                                          x
                                          j
                                       
                                       −
                                       γ
                                       
                                          y
                                          j
                                       
                                       >
                                       
                                          a
                                          1
                                       
                                       
                                          y
                                          j
                                       
                                       +
                                       
                                          
                                             γ
                                             +
                                             
                                                ϵ
                                                1
                                             
                                          
                                          
                                             ϵ
                                             1
                                          
                                       
                                       
                                          x
                                          j
                                       
                                       −
                                       
                                          a
                                          1
                                       
                                       
                                          
                                             γ
                                             +
                                             
                                                ϵ
                                                1
                                             
                                          
                                          
                                             ϵ
                                             1
                                          
                                       
                                       
                                          y
                                          j
                                       
                                       }
                                    
                                    ⊆
                                    N
                                    ∖
                                    
                                       S
                                       1
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       {
                                       j
                                       ∈
                                       
                                          N
                                          2
                                       
                                       :
                                       
                                          x
                                          j
                                       
                                       −
                                       γ
                                       
                                          y
                                          j
                                       
                                       <
                                       
                                          a
                                          2
                                       
                                       
                                          y
                                          j
                                       
                                       +
                                       
                                          
                                             γ
                                             +
                                             
                                                ϵ
                                                2
                                             
                                          
                                          
                                             ϵ
                                             2
                                          
                                       
                                       
                                          x
                                          j
                                       
                                       −
                                       
                                          a
                                          2
                                       
                                       
                                          
                                             γ
                                             +
                                             
                                                ϵ
                                                2
                                             
                                          
                                          
                                             ϵ
                                             2
                                          
                                       
                                       
                                          y
                                          j
                                       
                                       }
                                    
                                    ⊆
                                    
                                       S
                                       2
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       {
                                       j
                                       ∈
                                       
                                          N
                                          2
                                       
                                       :
                                       
                                          x
                                          j
                                       
                                       −
                                       γ
                                       
                                          y
                                          j
                                       
                                       >
                                       
                                          a
                                          2
                                       
                                       
                                          y
                                          j
                                       
                                       +
                                       
                                          
                                             γ
                                             +
                                             
                                                ϵ
                                                2
                                             
                                          
                                          
                                             ϵ
                                             2
                                          
                                       
                                       
                                          x
                                          j
                                       
                                       −
                                       
                                          a
                                          2
                                       
                                       
                                          
                                             γ
                                             +
                                             
                                                ϵ
                                                2
                                             
                                          
                                          
                                             ϵ
                                             2
                                          
                                       
                                       
                                          y
                                          j
                                       
                                       }
                                    
                                    ⊆
                                    N
                                    ∖
                                    
                                       S
                                       2
                                    
                                    .
                                 
                              
                           
                        For those cases where the equality 
                           
                              
                                 x
                                 j
                              
                              −
                              γ
                              
                                 y
                                 j
                              
                              =
                              
                                 a
                                 t
                              
                              
                                 y
                                 j
                              
                              +
                              
                                 
                                    γ
                                    +
                                    
                                       ϵ
                                       t
                                    
                                 
                                 
                                    ϵ
                                    t
                                 
                              
                              
                                 x
                                 j
                              
                              −
                              
                                 a
                                 t
                              
                              
                                 
                                    γ
                                    +
                                    
                                       ϵ
                                       t
                                    
                                 
                                 
                                    ϵ
                                    t
                                 
                              
                              
                                 y
                                 j
                              
                           
                         holds, for t ∈ {1, 2}, choose arbitrarily between the corresponding sets St, N∖St
                        . The separation problem can be solved in 
                           
                              O
                              (
                              n
                              )
                              .
                           
                         Next we describe a simple separation procedure for the lifted Euclidean inequalities.

For each Euclidean inequality of type (2.1), (2.2), (2.3) we construct a lifted Euclidean inequality (3.13). In order to maximize the left-hand side we choose the set in which to put j ∈ N as follows:

For j ∈ N
                        1 we determine 
                           
                              max
                              {
                              0
                              ,
                              
                                 μ
                                 1
                              
                              
                                 y
                                 j
                              
                              +
                              
                                 ν
                                 1
                              
                              
                                 x
                                 j
                              
                              ,
                              
                                 θ
                                 1
                                 k
                              
                              
                                 y
                                 j
                              
                              +
                              
                                 ξ
                                 1
                                 k
                              
                              
                                 x
                                 j
                              
                              }
                           
                         where 
                           
                              k
                              =
                              a
                              r
                              g
                              m
                              a
                              
                                 x
                                 
                                    ℓ
                                    ∈
                                    
                                       T
                                       1
                                    
                                 
                              
                              
                                 {
                                 
                                    θ
                                    1
                                    ℓ
                                 
                                 
                                    y
                                    j
                                 
                                 +
                                 
                                    ξ
                                    1
                                    ℓ
                                 
                                 
                                    x
                                    j
                                 
                                 }
                              
                              .
                           
                         Then put j in N
                        1∖{S
                        1 ∪ I
                        1} if the maximum is 0; put j in S
                        1 if the maximum is 
                           
                              
                                 μ
                                 1
                              
                              
                                 y
                                 j
                              
                              +
                              
                                 ν
                                 1
                              
                              
                                 x
                                 j
                              
                              ;
                           
                         and put 
                           
                              j
                              ∈
                              
                                 I
                                 1
                                 k
                              
                           
                         otherwise.

For j ∈ N
                        2 we determine 
                           
                              max
                              {
                              0
                              ,
                              
                                 μ
                                 2
                              
                              
                                 y
                                 j
                              
                              +
                              
                                 ν
                                 2
                              
                              
                                 x
                                 j
                              
                              ,
                              
                                 θ
                                 2
                                 k
                              
                              
                                 y
                                 j
                              
                              +
                              
                                 ξ
                                 2
                                 k
                              
                              
                                 x
                                 j
                              
                              }
                           
                         where 
                           
                              k
                              =
                              a
                              r
                              g
                              m
                              a
                              
                                 x
                                 
                                    ℓ
                                    ∈
                                    
                                       T
                                       2
                                    
                                 
                              
                              
                                 {
                                 
                                    θ
                                    2
                                    ℓ
                                 
                                 
                                    y
                                    j
                                 
                                 +
                                 
                                    ξ
                                    2
                                    ℓ
                                 
                                 
                                    x
                                    j
                                 
                                 }
                              
                              .
                           
                         Then put j in N
                        2∖{S
                        2 ∪ I
                        2} if the maximum is 0; put j in S
                        2 if the maximum is 
                           
                              
                                 μ
                                 2
                              
                              
                                 y
                                 j
                              
                              +
                              
                                 ν
                                 2
                              
                              
                                 x
                                 j
                              
                              ;
                           
                         and put 
                           
                              j
                              ∈
                              
                                 I
                                 2
                                 k
                              
                           
                         otherwise.

The number of different coefficients in I is 
                           
                              O
                              (
                              b
                              )
                           
                         where 
                           
                              b
                              =
                              l
                              o
                              g
                              (
                              D
                              /
                              min
                              
                                 {
                                 
                                    a
                                    1
                                 
                                 ,
                                 
                                    a
                                    2
                                 
                                 }
                              
                              )
                              }
                           
                         and the time complexity to compute those coefficients is similar. The overall procedure is 
                           
                              O
                              (
                              n
                              b
                              )
                           
                        .

In this section we discuss three possible applications: an inventory-distribution problem, a capacitated facility location problem, and a muti-item production planning problem. The main purpose is to illustrate and explain how the lifted Euclidean inequalities can be used in practical problems. We report on computational experimentations on small sets of instances for each one of these three problems. With the first two problems we also illustrate how these inequalities can be used in sets that are very similar to set 
                        X
                      but do not coincide with 
                        
                           X
                           .
                        
                     
                  

For each problem we compare the value of the linear relaxation with the value of the linear relaxation after the inclusion of cuts from the lifted Euclidean inequalities. In order to derive these cuts, we consider a single node flow set obtained by relaxation of the original feasible set. Then we add all valid inequalities derived for the corresponding single node flow set that are violated by the fractional linear programming solution. We repeat this process until no further violated valid inequalities are obtained.

For the computation we use the optimization package Xpress Optimizer, Version 25.01.05, with MOSEL in a computer with a Intel Core I7, 2.4GHz processor with 16GB RAM.

The Vendor Management Problem (VMP) occurs when a distributor/producer controls the inventory at the retailers. Given a set of n retailers and a demand in each period of each retailer during a time horizon of m periods, the VMP aims to find the amount to order in each time period of a given item and the amount to send to each retailer in each period, in order to minimize the holding, backlogging, distribution and fixed ordering costs.

Define 
                           
                              T
                              =
                              {
                              1
                              ,
                              …
                              ,
                              m
                              }
                           
                         and 
                           
                              I
                              =
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                         the set of time periods and retailers, respectively. We assume there is a fleet with two types of vehicles with capacities C
                        1 and C
                        2, and each retailer is visited by one type of vehicle only. Let I
                        1, I
                        2 define the subsets of I that are served by vehicles with capacity C
                        1, C
                        2, respectively.

For each period t ∈ T and each retailer i ∈ I, consider the variables 
                           
                              
                                 x
                                 i
                                 t
                              
                              ,
                              
                                 y
                                 i
                                 t
                              
                              ,
                           
                        
                        
                           
                              s
                              i
                              t
                           
                         that represent, respectively, the amount sent, in time period t, to client i; the number of vehicles used to serve retailer i, in period t; and the stock level in retailer i at the end of time period t. The binary variable zt
                         indicates whether a fixed cost is incurred in period t or not.

For each time period t and each retailer i, 
                           
                              d
                              i
                              t
                           
                         represents the demand, 
                           
                              
                                 p
                                 i
                                 t
                              
                              ,
                           
                         represents the unit product transportation cost, 
                           
                              f
                              i
                              t
                           
                         represents the fixed transportation cost per vehicle, and 
                           
                              h
                              i
                              t
                           
                         represents the unit product holding cost. M is distribution capacity in each time period and gt
                         is the fixed cost for distributing in period t. The VMP can be written as follows.

                           
                              (4.1)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                
                                                   p
                                                   i
                                                   t
                                                
                                                
                                                   x
                                                   i
                                                   t
                                                
                                                +
                                                
                                                   f
                                                   i
                                                   t
                                                
                                                
                                                   y
                                                   i
                                                   t
                                                
                                                +
                                                
                                                   h
                                                   i
                                                   t
                                                
                                                
                                                   s
                                                   i
                                                   t
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                g
                                                t
                                             
                                             
                                                z
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                s
                                                i
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                x
                                                i
                                                t
                                             
                                             =
                                             
                                                d
                                                i
                                                t
                                             
                                             +
                                             
                                                s
                                                i
                                                t
                                             
                                             ,
                                             
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.2)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             ≤
                                             
                                                C
                                                1
                                             
                                             
                                                y
                                                i
                                                t
                                             
                                             ,
                                             
                                             i
                                             ∈
                                             
                                                I
                                                1
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.3)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             ≤
                                             
                                                C
                                                2
                                             
                                             
                                                y
                                                i
                                                t
                                             
                                             ,
                                             
                                             i
                                             ∈
                                             
                                                I
                                                2
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.4)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                x
                                                i
                                                t
                                             
                                             ≤
                                             M
                                             
                                                z
                                                t
                                             
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.5)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             ,
                                             
                                                s
                                                i
                                                t
                                             
                                             ≥
                                             0
                                             ,
                                             
                                                y
                                                i
                                                t
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.6)
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                                i
                                                0
                                             
                                             =
                                             
                                                s
                                                i
                                                m
                                             
                                             =
                                             0
                                             
                                             i
                                             ∈
                                             I
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.7)
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                                t
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             t
                                             ∈
                                             T
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Constraints (4.1) are the usual flow conservation constraints at each retailer and for each time period. Constraints (4.2) and (4.3) are the variable upper bound constraints. Constraints (4.4) impose a maximum amount to distribute in each period and impose a setup cost whenever there is distribution. Constraints (4.5)–(4.7) are the sign constraints. The set defined by (4.1)–(4.7) will be denoted by XVMP
                        .

Consider the relaxation of the VMP obtained by eliminating the flow conservation constraints. The relaxed model is separable into several subproblems, one for each period t. For each period t, the feasible set, denoted by 
                           
                              
                                 X
                                 t
                                 
                                    V
                                    M
                                    P
                                 
                              
                              ,
                           
                         is the integer single node flow set with two capacities and with a set-up variable associated to the node itself:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                X
                                                t
                                                
                                                   V
                                                   M
                                                   P
                                                
                                             
                                             
                                                =
                                                {
                                                
                                                   (
                                                   z
                                                   ,
                                                   y
                                                   ,
                                                   x
                                                   )
                                                
                                                ∈
                                                
                                                   {
                                                   0
                                                   ,
                                                   1
                                                   }
                                                
                                                ×
                                             
                                             
                                                Z
                                                +
                                                n
                                             
                                             ×
                                             
                                                R
                                                n
                                             
                                             :
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                x
                                                i
                                             
                                             ≤
                                             M
                                             z
                                             ,
                                             0
                                             ≤
                                             
                                                x
                                                i
                                             
                                             ≤
                                             
                                                C
                                                1
                                             
                                             
                                                y
                                                i
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             i
                                             ∈
                                             
                                                I
                                                1
                                             
                                             ,
                                             0
                                             ≤
                                             
                                                x
                                                i
                                             
                                             ≤
                                             
                                                C
                                                2
                                             
                                             
                                                y
                                                i
                                             
                                             ,
                                             i
                                             ∈
                                             
                                                I
                                                2
                                             
                                             
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Set XVMP
                         differs from X (considering I as N and C
                        1, C
                        2 as a
                        1, a
                        2) since it includes the set-up variable z. Following Proposition 4 in Agra and Doostmohammadi (2013), one can easily show that if

                           
                              (4.8)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                α
                                                j
                                             
                                             
                                                x
                                                j
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                β
                                                j
                                             
                                             
                                                y
                                                j
                                             
                                             ≤
                                             δ
                                          
                                       
                                    
                                 
                              
                           
                        is valid for X, then (4.8) is valid for XVMP
                        . Conversely, if βj
                         ≤ 0, ∀j ∈ N, then inequality (4.8) is valid for X, if and only if

                           
                              (4.9)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                α
                                                j
                                             
                                             
                                                x
                                                j
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                β
                                                j
                                             
                                             
                                                y
                                                j
                                             
                                             ≤
                                             δ
                                             z
                                          
                                       
                                    
                                 
                              
                           
                        is valid for 
                           
                              
                                 X
                                 t
                                 
                                    V
                                    M
                                    P
                                 
                              
                              .
                           
                         Hence all the inequalities derived for X can be used directly to tighten the linear relaxation of XVMP
                        , and tighter inequalities can be derived by multiplying the RHS of inequalities (3.6) and (3.13) by zt
                        .

Such problem occurs, for instance, within maritime transportation, in a medium-term planning, when a product is supplied by large ships (batches in our model), and then distributed among a set of ports using an heterogeneous fleet (with two types) of smaller ships. Each port is served by one type of ship (accordingly to the characteristics of each port). The set-up variable zt
                         indicates whether a large shipment must occur in that time period and the y variables indicate the number of smaller ships of type t that must be sent to a given port.

We consider instances with 
                           
                              m
                              =
                              20
                              ,
                           
                        
                        
                           
                              n
                              =
                              5
                              .
                           
                         Demands 
                           
                              d
                              i
                              t
                           
                         were randomly generated in [1, 25], and we set the unit transportation costs to 
                           
                              
                                 p
                                 i
                                 t
                              
                              =
                              2
                              ,
                           
                         the fixed transportation costs to 
                           
                              
                                 f
                                 i
                                 t
                              
                              =
                              1001
                              ,
                           
                         the unit holding costs 
                           
                              
                                 h
                                 i
                                 t
                              
                              =
                              0
                              .
                           
                        
                        
                           
                              M
                              =
                              1000
                              .
                           
                         We consider 5 instances with 
                           
                              
                                 C
                                 1
                              
                              =
                              10
                              ,
                              
                                 C
                                 2
                              
                              =
                              17
                              ,
                           
                         labeled as 
                           
                              i
                              1
                              a
                              ,
                              …
                              ,
                              i
                              5
                              a
                           
                         and 5 instances with capacities 
                           
                              
                                 C
                                 1
                              
                              =
                              30
                              ,
                              
                                 C
                                 2
                              
                              =
                              50
                              ,
                           
                         which are labeled as 
                           
                              i
                              1
                              b
                              ,
                              …
                              ,
                              i
                              5
                              b
                              .
                           
                        
                     

The computational results after 5 minutes of computer time are reported in Table 1
                        
                        . Column LR indicates the linear relaxation value, BFB gives the Best known Feasible Solution, Gap gives the corresponding gap 
                           
                              (
                              G
                              a
                              p
                              =
                              
                                 
                                    B
                                    F
                                    B
                                    −
                                    L
                                    R
                                 
                                 
                                    B
                                    F
                                    B
                                 
                              
                              *
                              100
                              %
                              )
                              .
                           
                         Columns 
                           
                              L
                              R
                              +
                              C
                           
                         and 
                           
                              G
                              a
                              p
                              +
                              C
                           
                         give the linear relaxation value and the corresponding gap after the cuts have been added at the root node. Column Cuts gives the number of cuts added. The last columns give the Best Feasible Solution (BFS), the Best Lower Bound (BLB), which is the best lower bound obtained at the end of the running time, and the corresponding gap (Gap) for the cases with inclusion of cuts and without inclusion of cuts.

We can see that the inclusion of cuts reduced both the initial gap and the gap after 5 minutes of running time.

Consider the following capacitated facility location problem (CFLP). We are given a set 
                           
                              N
                              =
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                         of clients and a set 
                           
                              L
                              =
                              {
                              1
                              ,
                              …
                              ,
                              m
                              }
                           
                         of possible facility locations. Let dt
                         represent the demand of client t, and Cj
                         represent the capacity of each facility j ∈ L. Parameter fj
                         indicates the fixed cost for installing a facility in j ∈ L and pjt
                         indicates the cost of satisfying one unit of demand of client t ∈ N from a facility j ∈ L. The variables xjt
                         indicate the amount of the demand of client t, that is satisfied by the facilities located at j. The integer variables yj
                         represent the number of facilities open at location j. The CFLP can be described as follows.

                           
                              (4.10)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   L
                                                
                                             
                                             
                                                p
                                                
                                                   j
                                                   t
                                                
                                             
                                             
                                                x
                                                
                                                   j
                                                   t
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   L
                                                
                                             
                                             
                                                f
                                                j
                                             
                                             
                                                y
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   L
                                                
                                             
                                             
                                                x
                                                
                                                   j
                                                   t
                                                
                                             
                                             =
                                             
                                                d
                                                t
                                             
                                             ,
                                             
                                             t
                                             ∈
                                             N
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.11)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                x
                                                
                                                   j
                                                   t
                                                
                                             
                                             ≤
                                             
                                                C
                                                j
                                             
                                             
                                                y
                                                j
                                             
                                             ,
                                             
                                             j
                                             ∈
                                             L
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.12)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   j
                                                   t
                                                
                                             
                                             ≤
                                             
                                                d
                                                t
                                             
                                             
                                                y
                                                j
                                             
                                             ,
                                             
                                             j
                                             ∈
                                             L
                                             ,
                                             t
                                             ∈
                                             N
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.13)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   j
                                                   t
                                                
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             j
                                             ∈
                                             L
                                             ,
                                             t
                                             ∈
                                             N
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.14)
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                j
                                             
                                             ∈
                                             
                                                Z
                                                0
                                                +
                                             
                                             ,
                                             
                                             j
                                             ∈
                                             L
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Constraints (4.10) ensure that the demand of each client is satisfied. Constraints (4.11) impose the capacity of each facility. Constraints (4.12) are the usual variable upper bound constraints, used to tighten the formulation .

Considering a subset T ⊆ N of clients, and aggregating the corresponding variables 
                           
                              
                                 w
                                 j
                              
                              =
                              
                                 ∑
                                 
                                    t
                                    ∈
                                    T
                                 
                              
                              
                                 x
                                 
                                    j
                                    t
                                 
                              
                           
                         we obtain the following single node flow set:

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                                
                                                   F
                                                   C
                                                
                                             
                                             =
                                             
                                                {
                                                
                                                   (
                                                   y
                                                   ,
                                                   w
                                                   )
                                                
                                                ∈
                                                
                                                   Z
                                                   n
                                                
                                                ×
                                                
                                                   R
                                                   +
                                                   n
                                                
                                                :
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      L
                                                   
                                                
                                                
                                                   w
                                                   j
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   d
                                                   t
                                                
                                                ,
                                                
                                                
                                                   w
                                                   j
                                                
                                                ≤
                                                
                                                   C
                                                   j
                                                
                                                
                                                   y
                                                   j
                                                
                                                ,
                                                
                                                j
                                                ∈
                                                L
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Assume there are only two possible values for capacity Cj
                        . Set XFC
                         differs from X because it has the equality constraint 
                           
                              
                                 ∑
                                 
                                    j
                                    ∈
                                    L
                                 
                              
                              
                                 w
                                 j
                              
                              =
                              
                                 ∑
                                 
                                    t
                                    ∈
                                    T
                                 
                              
                              
                                 d
                                 t
                              
                              .
                           
                         Obviously, valid inequalities for set X (with ≤ constraints) are valid for XFC
                         since XFC
                         is a restriction of X. For the equality case the families (3.6) are void (since it assumes γ > 0, ϵ1 > 0, and ϵ2 > 0). Similarly, in family (3.8) we have 
                           
                              I
                              =
                              ∅
                              .
                           
                        
                     

We consider instances with 
                           
                              n
                              =
                              100
                              ,
                           
                        
                        
                           
                              m
                              =
                              10
                              .
                           
                         Parameters dt, fj
                         were randomly generated in [100, 150], and [9000, 10, 000], respectively. And 
                           
                              
                                 p
                                 
                                    j
                                    t
                                 
                              
                              =
                              2
                              ,
                              ∀
                              j
                              ,
                              t
                              .
                           
                         Again we consider 5 instances with 
                           
                              
                                 C
                                 1
                              
                              =
                              100
                              ,
                              
                                 C
                                 2
                              
                              =
                              170
                              ,
                           
                         labeled as 
                           
                              i
                              1
                              a
                              ,
                              …
                              ,
                              i
                              5
                              a
                           
                         and 5 instances with 
                           
                              
                                 C
                                 1
                              
                              =
                              300
                              ,
                              
                                 C
                                 2
                              
                              =
                              500
                              ,
                           
                         labeled as 
                           
                              i
                              1
                              b
                              ,
                              …
                              ,
                              i
                              5
                              b
                              .
                           
                        
                     

The computational results are reported in Table 2. Since all the instances were solved to optimality, in addition to the notation introduced before, column OPT indicates the value of the optimal solution, columns Time indicate the running time in seconds to solve the problem and columns Nodes indicate the number of nodes in the branch-and-bound tree.

The inclusion of cuts was again effective in reducing the integrality gap and the number of branch-and-bound nodes, in average.

Consider the following muti-item production planning problem (MPP). Let 
                           
                              I
                              =
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                         be the set of items and 
                           
                              T
                              =
                              {
                              1
                              ,
                              …
                              ,
                              m
                              }
                           
                         be the set of time periods. For each period t ∈ T consider the variables 
                           
                              
                                 x
                                 i
                                 t
                              
                              ,
                              
                                 y
                                 i
                                 t
                              
                              ,
                           
                        
                        
                           
                              s
                              i
                              t
                           
                         and 
                           
                              
                                 r
                                 i
                                 t
                              
                              ,
                           
                         that represent the production lot sizing of item i in period t; the integer variable indicating the number batches of item i to produce in period t; the inventory of item i at the end of period t; and the backlog of item i at the end of period t, respectively.

The demand of each item for each period is given by 
                           
                              
                                 d
                                 i
                                 t
                              
                              .
                           
                         For each time period t, Mt
                         is the available production capacity. In each time period we consider two batch sizes. One with capacity 
                           
                              c
                              1
                              t
                           
                         for items i ∈ I
                        1 and the other, 
                           
                              
                                 c
                                 2
                                 t
                              
                              ,
                           
                         for items 
                           
                              i
                              ∈
                              
                                 I
                                 2
                              
                              =
                              I
                              ∖
                              
                                 I
                                 1
                              
                              .
                           
                         For each item and each period the costs 
                           
                              
                                 p
                                 i
                                 t
                              
                              ,
                              
                                 f
                                 i
                                 t
                              
                              ,
                              
                                 h
                                 i
                                 t
                              
                              ,
                              
                                 b
                                 i
                                 t
                              
                           
                         represent, respectively, the unit production cost, the fixed production cost, the unit inventory cost and the unit backlog cost.

The multi-item lot-sizing problem is given by,

                           
                              (4.15)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                
                                                   p
                                                   i
                                                   t
                                                
                                                
                                                   x
                                                   i
                                                   t
                                                
                                                +
                                                
                                                   f
                                                   i
                                                   t
                                                
                                                
                                                   y
                                                   i
                                                   t
                                                
                                                +
                                                
                                                   h
                                                   i
                                                   t
                                                
                                                
                                                   s
                                                   i
                                                   t
                                                
                                                +
                                                
                                                   b
                                                   i
                                                   t
                                                
                                                
                                                   r
                                                   i
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                s
                                                i
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                x
                                                i
                                                t
                                             
                                             +
                                             
                                                r
                                                i
                                                t
                                             
                                             =
                                             
                                                d
                                                i
                                                t
                                             
                                             +
                                             
                                                s
                                                i
                                                t
                                             
                                             +
                                             
                                                r
                                                i
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.16)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                s
                                                i
                                                0
                                             
                                             =
                                             
                                                s
                                                i
                                                m
                                             
                                             =
                                             
                                                r
                                                i
                                                0
                                             
                                             =
                                             
                                                r
                                                i
                                                m
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             i
                                             ∈
                                             I
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.17)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             ≤
                                             
                                                c
                                                1
                                                t
                                             
                                             
                                                y
                                                i
                                                t
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             i
                                             ∈
                                             
                                                I
                                                1
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.18)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             ≤
                                             
                                                c
                                                2
                                                t
                                             
                                             
                                                y
                                                i
                                                t
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             i
                                             ∈
                                             
                                                I
                                                2
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.19)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                x
                                                i
                                                t
                                             
                                             ≤
                                             
                                                M
                                                t
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4.20)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             ,
                                             
                                                s
                                                i
                                                t
                                             
                                             ≥
                                             0
                                             ,
                                             
                                                y
                                                i
                                                t
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             T
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Constraints (4.15) are the flow conservation constraints. Constraints (4.16) ensure that the inventory and backlogging at the beginning and at the end of the planning horizon is zero for each item. Constraints (4.17) and (4.18) establish the upper bound capacity on each lot. Constraints (4.19) model a resource constraint (as time-machine constraint).

Consider the relaxation of the MPP obtained by deleting the flow conservation constraints. The relaxed model is separable in several problems, one for each period t. For each period t, the feasible set is the integer single node flow set with two possible values for the upper bounds:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             {
                                             
                                                (
                                                y
                                                ,
                                                x
                                                )
                                             
                                             ∈
                                             
                                                Z
                                                +
                                                n
                                             
                                             ×
                                             
                                                R
                                                n
                                             
                                             :
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                x
                                                i
                                             
                                             ≤
                                             M
                                             ,
                                             0
                                             ≤
                                             
                                                x
                                                i
                                             
                                             ≤
                                             
                                                c
                                                1
                                             
                                             
                                                y
                                                i
                                             
                                             ,
                                             i
                                             ∈
                                             
                                                I
                                                1
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                             
                                                x
                                                i
                                             
                                             ≤
                                             
                                                c
                                                2
                                             
                                             
                                                y
                                                i
                                             
                                             ,
                                             i
                                             ∈
                                             
                                                I
                                                2
                                             
                                             
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We consider instances 
                           
                              n
                              =
                              5
                              ,
                           
                        
                        
                           
                              m
                              =
                              20
                              ,
                           
                        
                        
                           
                              
                                 p
                                 i
                                 t
                              
                              =
                              2
                              ,
                              
                                 f
                                 i
                                 t
                              
                              =
                              101
                              ,
                              
                                 h
                                 i
                                 t
                              
                              =
                              1
                              ,
                              ∀
                              i
                              ,
                              t
                              .
                           
                         Parameters dt
                        , 
                           
                              
                                 b
                                 i
                                 t
                              
                              ,
                           
                         were randomly generated in intervals [1, 25], and [500, 600], respectively. Again we consider 5 instances with 
                           
                              
                                 C
                                 1
                              
                              =
                              10
                              ,
                              
                                 C
                                 2
                              
                              =
                              17
                              ,
                           
                         labeled as 
                           
                              i
                              1
                              a
                              ,
                              …
                              ,
                              i
                              5
                              a
                           
                         and 5 instances with 
                           
                              
                                 C
                                 1
                              
                              =
                              30
                              ,
                              
                                 C
                                 2
                              
                              =
                              50
                              ,
                           
                         labeled as 
                           
                              i
                              1
                              b
                              ,
                              …
                              ,
                              i
                              5
                              b
                              .
                           
                        
                     

The computational results are reported in Table 3. The meaning of the columns is the same as for the VMP.

As for the previous two models, the value of linear programming gaps have improved in the presence of the lifted Euclidean inequalities, while the final gaps were slightly better for most instances.

@&#ACKNOWLEDGMENTS@&#

The work was funded by FCT (Fundação para a Ciência e a Tecnologia) through program COMPETE: FCOMP-01-0124-FEDER-041898 within project EXPL/MAT-NAN/1761/2013, and by CIDMA (Centro de Investigação e Desenvolvimento em Matemática e Aplicações) and FCT within projects PEst-OE/MAT/UI0152 and UID/MAT/04106/2013.


                     
                        Proof
                        (Proposition 3.3) To ease the notation of this proof, for set S we denote by X(S) and Y(S) the sums ∑
                              j ∈ S
                           
                           xj
                            and ∑
                              j ∈ S
                           
                           yj
                           , respectively.

Consider a point 
                              
                                 (
                                 y
                                 ,
                                 x
                                 )
                                 ∈
                                 X
                                 .
                              
                            Case 1. 
                              
                                 Y
                                 (
                                 N
                                 ∖
                                 
                                    (
                                    
                                       S
                                       1
                                    
                                    ∪
                                    
                                       S
                                       2
                                    
                                    )
                                 
                                 )
                                 =
                                 0
                                 .
                              
                            If 
                              
                                 
                                    (
                                    Y
                                    
                                       (
                                       
                                          S
                                          1
                                       
                                       )
                                    
                                    ,
                                    Y
                                    
                                       (
                                       
                                          S
                                          2
                                       
                                       )
                                    
                                    )
                                 
                                 ∈
                                 
                                    Y
                                    ≤
                                 
                              
                            then

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   a
                                                   1
                                                
                                                Y
                                                
                                                   (
                                                   
                                                      S
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   2
                                                
                                                Y
                                                
                                                   (
                                                   
                                                      S
                                                      2
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      γ
                                                      +
                                                      
                                                         ϵ
                                                         1
                                                      
                                                   
                                                   
                                                      ϵ
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      a
                                                      1
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   
                                                      γ
                                                      +
                                                      
                                                         ϵ
                                                         2
                                                      
                                                   
                                                   
                                                      ϵ
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      a
                                                      2
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      ∪
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   −
                                                   γ
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      ∪
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       ≤
                                       
                                          a
                                          1
                                       
                                       Y
                                       
                                          (
                                          
                                             S
                                             1
                                          
                                          )
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       Y
                                       
                                          (
                                          
                                             S
                                             2
                                          
                                          )
                                       
                                       ≤
                                       D
                                       −
                                       γ
                                    
                                 
                              
                           
                        

Now suppose 
                              
                                 
                                    (
                                    Y
                                    
                                       (
                                       
                                          S
                                          1
                                       
                                       )
                                    
                                    ,
                                    Y
                                    
                                       (
                                       
                                          S
                                          2
                                       
                                       )
                                    
                                    )
                                 
                                 ∈
                                 
                                    Y
                                    ≥
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       
                                          y
                                          1
                                       
                                       ,
                                       
                                          y
                                          2
                                       
                                       )
                                    
                                    ∈
                                    
                                       Z
                                       +
                                       2
                                    
                                    :
                                    
                                       a
                                       1
                                    
                                    
                                       y
                                       1
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       y
                                       2
                                    
                                    ≥
                                    D
                                    }
                                 
                                 .
                              
                            W.l.o.g. suppose 
                              
                                 
                                    (
                                    Y
                                    
                                       (
                                       
                                          S
                                          1
                                       
                                       )
                                    
                                    ,
                                    Y
                                    
                                       (
                                       
                                          S
                                          2
                                       
                                       )
                                    
                                    )
                                 
                                 ∈
                                 
                                    Y
                                    1
                                 
                                 .
                              
                            Since it suffices to prove validity for the extreme points of 
                              
                                 P
                                 ,
                              
                            we may assume 
                              
                                 X
                                 
                                    (
                                    
                                       S
                                       1
                                    
                                    )
                                 
                                 =
                                 D
                                 −
                                 
                                    a
                                    2
                                 
                                 Y
                                 
                                    (
                                    
                                       S
                                       2
                                    
                                    )
                                 
                              
                            and 
                              
                                 X
                                 
                                    (
                                    
                                       S
                                       2
                                    
                                    )
                                 
                                 =
                                 
                                    a
                                    2
                                 
                                 Y
                                 
                                    (
                                    
                                       S
                                       2
                                    
                                    )
                                 
                                 .
                              
                            Thus, as 
                              
                                 
                                    ϵ
                                    1
                                 
                                 ≤
                                 min
                                 
                                    {
                                    
                                       a
                                       1
                                    
                                    
                                       y
                                       1
                                    
                                    +
                                    
                                       a
                                       2
                                    
                                    
                                       y
                                       2
                                    
                                    −
                                    D
                                    :
                                    
                                       (
                                       
                                          Y
                                          1
                                       
                                       ,
                                       
                                          Y
                                          2
                                       
                                       )
                                    
                                    ∈
                                    
                                       Y
                                       1
                                    
                                    )
                                 
                                 
                                    }
                                    ,
                                 
                              
                            then,

                              
                                 
                                    
                                       
                                          ϵ
                                          1
                                       
                                       ≤
                                       
                                          (
                                          
                                             a
                                             1
                                          
                                          Y
                                          
                                             (
                                             
                                                S
                                                1
                                             
                                             )
                                          
                                          +
                                          
                                             a
                                             2
                                          
                                          Y
                                          
                                             (
                                             
                                                S
                                                2
                                             
                                             )
                                          
                                          −
                                          D
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                ⇒
                                                γ
                                                
                                                   (
                                                   D
                                                   −
                                                   
                                                      a
                                                      1
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      a
                                                      2
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ϵ
                                                   1
                                                
                                                
                                                   (
                                                   D
                                                   −
                                                   
                                                      a
                                                      1
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      a
                                                      2
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ≤
                                                
                                                
                                                   ϵ
                                                   1
                                                
                                                
                                                   (
                                                   D
                                                   −
                                                   
                                                      a
                                                      1
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      a
                                                      2
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                −
                                                
                                                   ϵ
                                                   1
                                                
                                                γ
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                ⇒
                                                
                                                   (
                                                   γ
                                                   +
                                                   
                                                      ϵ
                                                      1
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   D
                                                   −
                                                   
                                                      a
                                                      1
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      a
                                                      2
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ≤
                                                
                                                   ϵ
                                                   1
                                                
                                                
                                                   (
                                                   D
                                                   −
                                                   γ
                                                   −
                                                   
                                                      a
                                                      1
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      a
                                                      2
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       ⇒
                                       
                                          (
                                          γ
                                          +
                                          
                                             ϵ
                                             1
                                          
                                          )
                                       
                                       
                                          (
                                          X
                                          
                                             (
                                             
                                                S
                                                1
                                             
                                             )
                                          
                                          −
                                          
                                             a
                                             1
                                          
                                          Y
                                          
                                             (
                                             
                                                S
                                                1
                                             
                                             )
                                          
                                          )
                                       
                                       ≤
                                       
                                          ϵ
                                          1
                                       
                                       
                                          (
                                          D
                                          −
                                          γ
                                          −
                                          
                                             a
                                             1
                                          
                                          Y
                                          
                                             (
                                             
                                                S
                                                1
                                             
                                             )
                                          
                                          −
                                          
                                             a
                                             2
                                          
                                          Y
                                          
                                             (
                                             
                                                S
                                                2
                                             
                                             )
                                          
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       ⇒
                                       
                                          a
                                          1
                                       
                                       Y
                                       
                                          (
                                          
                                             S
                                             1
                                          
                                          )
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       Y
                                       
                                          (
                                          
                                             S
                                             2
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             γ
                                             +
                                             
                                                ϵ
                                                1
                                             
                                          
                                          
                                             ϵ
                                             1
                                          
                                       
                                       
                                          (
                                          X
                                          
                                             (
                                             
                                                S
                                                1
                                             
                                             )
                                          
                                          −
                                          
                                             a
                                             1
                                          
                                          Y
                                          
                                             (
                                             
                                                S
                                                1
                                             
                                             )
                                          
                                          )
                                       
                                       ≤
                                       D
                                       −
                                       γ
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       ⇒
                                       
                                          a
                                          1
                                       
                                       Y
                                       
                                          (
                                          
                                             S
                                             1
                                          
                                          )
                                       
                                       +
                                       
                                          a
                                          2
                                       
                                       Y
                                       
                                          (
                                          
                                             S
                                             2
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             γ
                                             +
                                             
                                                ϵ
                                                1
                                             
                                          
                                          
                                             ϵ
                                             1
                                          
                                       
                                       
                                          (
                                          X
                                          
                                             (
                                             
                                                S
                                                1
                                             
                                             )
                                          
                                          −
                                          
                                             a
                                             1
                                          
                                          Y
                                          
                                             (
                                             
                                                S
                                                1
                                             
                                             )
                                          
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                   
                                                      γ
                                                      +
                                                      
                                                         ϵ
                                                         2
                                                      
                                                   
                                                   
                                                      ϵ
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      a
                                                      2
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                X
                                                
                                                   (
                                                   N
                                                   ∖
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      ∪
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                −
                                                
                                                γ
                                                Y
                                                (
                                                N
                                                ∖
                                                
                                                   (
                                                   
                                                      S
                                                      1
                                                   
                                                   ∪
                                                   
                                                      S
                                                      2
                                                   
                                                   )
                                                
                                                )
                                                ≤
                                                D
                                                −
                                                γ
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Case 2. Y(N∖(S
                           1 ∪ S
                           2)) > 0.

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   a
                                                   1
                                                
                                                Y
                                                
                                                   (
                                                   
                                                      S
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                
                                                   a
                                                   2
                                                
                                                Y
                                                
                                                   (
                                                   
                                                      S
                                                      2
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      γ
                                                      +
                                                      
                                                         ϵ
                                                         1
                                                      
                                                   
                                                   
                                                      ϵ
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      a
                                                      1
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   
                                                      γ
                                                      +
                                                      
                                                         ϵ
                                                         2
                                                      
                                                   
                                                   
                                                      ϵ
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      a
                                                      2
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                X
                                                
                                                   (
                                                   N
                                                   ∖
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      ∪
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                −
                                                
                                                γ
                                                Y
                                                
                                                   (
                                                   N
                                                   ∖
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      ∪
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                ≤
                                                
                                                   
                                                      γ
                                                      +
                                                      
                                                         ϵ
                                                         1
                                                      
                                                   
                                                   
                                                      ϵ
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         γ
                                                         +
                                                         
                                                            ϵ
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                      1
                                                   
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   
                                                      γ
                                                      +
                                                      
                                                         ϵ
                                                         2
                                                      
                                                   
                                                   
                                                      ϵ
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         γ
                                                         +
                                                         
                                                            ϵ
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                      2
                                                   
                                                   Y
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                X
                                                
                                                   (
                                                   N
                                                   ∖
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      ∪
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                −
                                                γ
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ≤
                                                
                                                
                                                   
                                                      γ
                                                      +
                                                      
                                                         ϵ
                                                         1
                                                      
                                                   
                                                   
                                                      ϵ
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         γ
                                                         +
                                                         
                                                            ϵ
                                                            1
                                                         
                                                      
                                                   
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                   
                                                      γ
                                                      +
                                                      
                                                         ϵ
                                                         2
                                                      
                                                   
                                                   
                                                      ϵ
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      γ
                                                      
                                                         γ
                                                         +
                                                         
                                                            ϵ
                                                            2
                                                         
                                                      
                                                   
                                                   X
                                                   
                                                      (
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                X
                                                
                                                   (
                                                   N
                                                   ∖
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      ∪
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                −
                                                γ
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ≤
                                                
                                                X
                                                
                                                   (
                                                   
                                                      S
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                X
                                                
                                                   (
                                                   
                                                      S
                                                      2
                                                   
                                                   )
                                                
                                                +
                                                X
                                                
                                                   (
                                                   N
                                                   ∖
                                                   
                                                      (
                                                      
                                                         S
                                                         1
                                                      
                                                      ∪
                                                      
                                                         S
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                −
                                                γ
                                                ≤
                                                D
                                                −
                                                γ
                                                
                                                □
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

(Lemma 3.4)

First observe that (a) μt
                            < 0, and (b) νt
                            > 0, for t ∈ {1, 2} (see Agra & Constantino, 2006a). Next we show that if (3.8) defines a facet of P with (μ
                           1, μ
                           2, ν
                           1, ν
                           2) ∈ Λ, and (μ
                           1, ν
                           1) ≠ (θj, ηj
                           ), j ∈ I
                           1, (μ
                           2, ν
                           2) ≠ (θj, ηj
                           ), j ∈ I
                           2, then following conditions hold:

                              
                                 (c)
                                 
                                    
                                       
                                          
                                             θ
                                             j
                                          
                                          +
                                          
                                             a
                                             t
                                          
                                          
                                             η
                                             j
                                          
                                          <
                                          
                                             μ
                                             t
                                          
                                          +
                                          
                                             a
                                             t
                                          
                                          
                                             ν
                                             t
                                          
                                          ,
                                          
                                          t
                                          ∈
                                          
                                             {
                                             1
                                             ,
                                             2
                                             }
                                          
                                          ,
                                          j
                                          ∈
                                          
                                             I
                                             t
                                          
                                          ;
                                       
                                    
                                 


                                    ηj
                                     < νt
                                    , t ∈ {1, 2}, j ∈ It
                                    ;


                                    θj
                                     > μt
                                    , t ∈ {1, 2}, j ∈ It
                                    .

We give the proof of (c) - (e) for case 
                              
                                 t
                                 =
                                 1
                                 ,
                              
                            since the other one is similar. Suppose 
                              
                                 
                                    θ
                                    j
                                 
                                 +
                                 
                                    a
                                    1
                                 
                                 
                                    η
                                    j
                                 
                                 >
                                 
                                    μ
                                    1
                                 
                                 +
                                 
                                    a
                                    1
                                 
                                 
                                    ν
                                    1
                                 
                                 ,
                                 j
                                 ∈
                                 
                                    I
                                    1
                                 
                                 .
                              
                            As (μ
                           1, μ
                           2, ν
                           1, ν
                           2) ∈ Λ and (3.8) defines a facet 
                              F
                            for the restricted set, then there must exist a tight point in 
                              F
                            with Y(S
                           1) ≥ 1 and X(S
                           1) ≥ a
                           1. Thus, a new point (x′, y′) violating (3.8) can be created by setting 
                              
                                 
                                    y
                                    j
                                    ′
                                 
                                 =
                                 1
                                 ,
                                 
                                    x
                                    j
                                    ′
                                 
                                 =
                                 
                                    a
                                    1
                                 
                                 ,
                                 
                                    Y
                                    ′
                                 
                                 
                                    (
                                    
                                       S
                                       1
                                    
                                    )
                                 
                                 =
                                 Y
                                 
                                    (
                                    
                                       S
                                       1
                                    
                                    )
                                 
                                 −
                                 1
                                 ,
                                 
                                    X
                                    ′
                                 
                                 
                                    (
                                    
                                       S
                                       1
                                    
                                    )
                                 
                                 =
                                 X
                                 
                                    (
                                    
                                       S
                                       1
                                    
                                    )
                                 
                                 −
                                 
                                    a
                                    1
                                 
                              
                            and keeping the remaining variables unchanged. Hence, 
                              
                                 
                                    θ
                                    j
                                 
                                 +
                                 
                                    a
                                    1
                                 
                                 
                                    η
                                    j
                                 
                                 ≤
                                 
                                    μ
                                    1
                                 
                                 +
                                 
                                    a
                                    1
                                 
                                 
                                    ν
                                    1
                                 
                                 .
                              
                            If 
                              
                                 
                                    θ
                                    j
                                 
                                 +
                                 
                                    a
                                    1
                                 
                                 
                                    η
                                    j
                                 
                                 =
                                 
                                    μ
                                    1
                                 
                                 +
                                 
                                    a
                                    1
                                 
                                 
                                    ν
                                    1
                                 
                              
                            and (μ
                           1, ν
                           1) ≠ (θj, ηj
                           ), then either (A) θj
                            < μ
                           1 and ηj
                            > ν
                           1 or (B) θj
                            > μ
                           1 and ηj
                            < ν
                           1. In case (A) we have 
                              
                                 
                                    θ
                                    j
                                 
                                 +
                                 γ
                                 
                                    η
                                    j
                                 
                                 <
                                 
                                    μ
                                    1
                                 
                                 +
                                 γ
                                 
                                    ν
                                    1
                                 
                              
                            for all 0 < γ < a
                           1 (since ν
                           1 ≥ 0) which implies 
                              
                                 
                                    x
                                    j
                                 
                                 =
                                 
                                    a
                                    1
                                 
                                 
                                    y
                                    j
                                 
                              
                            for all points in 
                              F
                           . Similarly, in case (B) we have 
                              
                                 
                                    x
                                    1
                                 
                                 =
                                 
                                    a
                                    1
                                 
                                 
                                    y
                                    1
                                 
                              
                            for all points in 
                              F
                           . Hence (c) holds.

As (c) holds, it must occur, for each t ∈ {1, 2} and j ∈ It
                           , 
                              
                                 
                                    θ
                                    j
                                 
                                 +
                                 γ
                                 
                                    η
                                    j
                                 
                                 ≥
                                 
                                    μ
                                    t
                                 
                                 +
                                 γ
                                 
                                    ν
                                    t
                                 
                                 ,
                              
                            for some 0 < γ < at
                           , otherwise we would have 
                              
                                 
                                    x
                                    j
                                 
                                 =
                                 
                                    y
                                    j
                                 
                                 =
                                 0
                              
                            for all tight points in the facet. Together with (c) this implies (d) and (e).

Now, we resume the proof of Lemma 3.4. Again we consider case 
                              
                                 t
                                 =
                                 1
                                 .
                              
                            Suppose (x, y) is a tight extreme point of 
                              P
                            in the face defined by (3.8) and yk
                            > 1, for some k ∈ I
                           1. If 
                              
                                 
                                    x
                                    k
                                 
                                 ≤
                                 
                                    a
                                    1
                                 
                                 
                                    (
                                    
                                       y
                                       k
                                    
                                    −
                                    1
                                    )
                                 
                              
                            we can decrease the value of yk
                            by one unit and obtain a feasible solution violating (3.8) because, by (a), θk
                            < 0. So consider the case 
                              
                                 
                                    a
                                    1
                                 
                                 
                                    (
                                    
                                       y
                                       k
                                    
                                    −
                                    1
                                    )
                                 
                                 <
                                 
                                    x
                                    k
                                 
                                 .
                              
                            Then decreasing the value of yk
                            by one and decreasing the value of xk
                            by a
                           1 and increasing the value of yi
                            and xi
                            by the same amounts we obtain a feasible solution violating (3.8). This proves (i).

The case (ii) follows from the fact that for network flow sets every extreme point of 
                              P
                            can have at most one continuous variable xj, j ∈ N with value 0 < xj
                            < ajyj
                           . So, as 
                              
                                 
                                    y
                                    k
                                 
                                 =
                                 1
                              
                            then if yj
                            > 0, j ∈ I∖{k} either 
                              
                                 
                                    x
                                    j
                                 
                                 =
                                 0
                              
                            or 
                              
                                 
                                    x
                                    j
                                 
                                 =
                                 
                                    a
                                    t
                                 
                                 
                                    y
                                    j
                                 
                                 .
                              
                            We can construct a violated feasible point using (a) in case 
                              
                                 
                                    x
                                    j
                                 
                                 =
                                 0
                              
                            (decreasing yj
                           ), and using (c) in case 
                              
                                 
                                    x
                                    j
                                 
                                 =
                                 
                                    a
                                    t
                                 
                                 
                                    y
                                    j
                                 
                              
                            (transferring the amounts in xj
                            and yj
                            to some xi
                           , and yi
                            with i ∈ St
                           .

Properties (iii) and (iv) follow again from the same arguments and noticing that in such extreme point with 
                              
                                 
                                    y
                                    k
                                 
                                 =
                                 1
                                 ,
                                 k
                                 ∈
                                 I
                                 ,
                              
                            then 
                              
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       N
                                    
                                 
                                 
                                    x
                                    j
                                 
                                 =
                                 D
                                 .
                              
                           
                           □

@&#REFERENCES@&#

