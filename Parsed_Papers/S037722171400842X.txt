@&#MAIN-TITLE@&#Supply planning for processors of agricultural raw materials

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Challenges arising from material use of renewable resources are explored and illustrated with the example linseed oil.


                        
                        
                           
                           A supply decision for a processor of agricultural goods is derived and a risk mitigation approach is developed.


                        
                        
                           
                           A two-stage stochastic program is presented as decision support.


                        
                        
                           
                           A numerical analysis is conducted with data for linseed oil and its results are interpreted.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Decision support systems

OR in agriculture

Stochastic programming

@&#ABSTRACT@&#


               
               
                  Material use of agricultural raw materials as renewable resources is gaining increasing importance in industrial production. Seasonal availability as well as variations in raw material quantity and quality and of market prices need to be considered in supply planning. This research depicts the planning problem of a processor of agricultural raw materials and illustrates it with data on the industrial use of linseed oil, which is a promising raw material for the production of new polymers. A two-stage stochastic program provides decision support and is applied to the example. The approach can be used for a variety of planning problems concerning the supply of agricultural raw materials.
               
            

@&#INTRODUCTION@&#

The interest of industry in the use of renewable resources as input for production processes is growing, since raw material supply needs to depend less on fossil resources, at least in the long run. Resource efficiency can be achieved by selecting utilization paths that imply options for the use of by-products (Geldermann, 2012). These utilization paths will become more attractive if research improves value chains and reduces costs (Carus, Raschka, & Piotrowski, 2010). Today, knowledge about the limited availability of crude oil motivates the search for alternative raw materials that can be used to produce industrial goods. The European Commission has identified the market for bio-based products as highly innovative, and selected it as a lead market with high development potential. The establishment of this market should be beneficial for economy and society (European Union, 2011).

Renewable resources are defined as “[…] all biomass produced from agriculture and forestry that is not used for food or animal feed" (FNR, 2010). Non-food applications of renewable resources for the production of physical goods are referred to as material use (Oertel, 2007, p. 5). Important agricultural raw materials for material use are, for example, sugar cane, corn, and potatoes, which supply sugar and starch. Fibre plants like flax, hemp and jute can be used for the production of cellulose, while soy, rapeseed, and linseed produce oils (Carus et al., 2010; Oertel, 2007).

In many applications, bio-based products compete with conventional products based on petrochemicals. Therefore, the requirements demanded from industry and customers include competitive prices, constant quality, and availability throughout the year. However, supply markets face variations in prices, qualities and quantities of agricultural products (Lowe & Preckel, 2004). They can occur simultaneously both in short term and in long term periods. The respective varying data need to be handled as uncertain since information on the past values is often incomplete. Not all influencing factors are known and the probabilities of the values of some known influencing factors cannot be predicted for the future.

Dealing with uncertain yield and quality of the harvest is one of the biggest challenges connected with using renewable resources in industry. Moreover, agricultural products can only be harvested at certain times of the year. In this paper, an approach and decision support for a processor of agricultural products are presented, where planning of supply requires taking several uncertainties as well as seasonal availability into account. The problem is illustrated by the example of linseed for which real-world data on quality, quantity, and price variation is available from Canada. Information on the industrial use of linseed and linseed oil is provided in Section 2.1. An exemplary supply planning situation of a processor, which requires a risk mitigation strategy, is introduced in Section 2.2. An overview of the present state of research is provided in Section 3. A risk mitigation strategy for the planning problem of the processor is outlined in Section 4.1 and a suitable optimization approach is selected in Section 4.2. Decision support based on stochastic programming is developed in Section 5. The selection of values for the numerical analysis of the example linseed is described in Section 6.1. In Section 6.2, computational results of the model are provided and discussed. A sensitivity analysis in Section 6.3 further illustrates the decision making behaviour of the model. Concluding suggestions for the decision maker are provided in Section 7.
                  

In 2012, the acreage used worldwide for linseed production was about 2485 Million hectares and about 92,535 tonnes linseed were harvested, with Canada being one of the main growing regions. In terms of resource efficiency, linseed is a very interesting plant because it is possible to utilize all its parts. The seeds contain a high percentage of valuable oil, which can be extracted. The by-product, linseed cake/meal, can be used as a livestock protein supplement with high nutritional value (Prentice & Storey, 1989). The fibres of linseed can be used in the pulp industry to replace wood fibres, which are added in the process of paper recycling and are used for the production of specialty papers. Further potential applications include geotextiles, bio-plastic composites, insulation, and use in the garment industry as new types of cottonized fibres, which can be used for spinning in traditional cotton mills (Flax Council of Canada, 2014; Rowland, 2002; Vromans, 2006). Shives, the non-fibre parts of the stem, compose 70–85 percent of the total weight of linseed straw. They can be used for the production of wood particle boards. Other options are to burn shives and use the energy for heating, use them as mulch or animal bedding, or as fillers in plastics (Rowland, 2002).

Linseed is an interesting raw material due to the properties of its oil. Linseed oil has an extraordinary high content of linolenic acid which enables easy polymerization (Nykter, Kymalainen, Gates, & Sjoberg, 2006; Wool, 2005). Therefore, it is used in well-established applications e.g. as binders in coatings, cross-linked for powder coatings, as a basic resource for the production of linoleum. It does, however, also represent a promising starting point for the development of new plastic materials (Derksen, Kloster, & Cuperus, 1995; Henna, Andjelkovic, Kundu, & Larock, 2007; Meier, Metzger, & Schubert, 2007; Overeem et al., 1999; Rowland, 2002). Petrović (2008) and Zlatanic, Lava, Zhang, and Petrovic (2004) showed that polyurethanes produced from linseed oil had significantly different material properties than polyurethanes produced from other plant oils. In the example of polymer production, high and stable oil quality enables a stable process and reliable product quality. Quality requirements of the industrial customer need to be considered in the planning of all suppliers upstream the value chain.

Uncertainties on the supply side start in the production of the primary raw material. Yield and quality of the harvest of an agricultural crop are influenced by many factors, e.g. seeding time, seeding rate, presence of nutrients within the soil, weather conditions, use of fertilizers and pesticides and harvest time. It is quite difficult to quantify the influence of these factors on the outcome of the harvest (Rowland, 2002).

The Canadian Grain Research Laboratory publishes data on several quality indicators of harvest survey samples from 1990 to 2010 with mean values for the years 2000–2009. The content of linolenic acid varied between approximately 52.1 percent and 61 percent with a mean value of 56.9 percent. For the Canadian State of Manitoba, data on the content of linolenic acid and the linseed yield for the years 1990–2011 are depicted in Fig. 1. In this figure, the yield of agricultural production is indicated by land productivity, which is the output of crop per hectare. If multiplied with the cultivated area, it can be used as a measure for the harvest quantity.

Presently, linseed is only traded over-the-counter. For the years 1990–2011, the prices of linseed in Manitoba are depicted in Fig. 2
                        . Prices for linseed oil are highly correlated to the price of linseed. Data on prices for linseed oil are available from the information provider Oil World, but due to copyright restrictions, they cannot be published here (Oil World, 2011).

Agricultural supply markets can be standardized to different extents. Basically, the processor can order raw materials from a commodity market, where standardized contracts are used, and the quality of goods is labelled in grades. In Canada, three different grades are established for linseed and traded over-the-counter, but the grading system does not consider the fatty acid distribution or the content of linolenic acid in the oil (Canadian Grain Commission, 2014) which is important for the quality of polymers as polyurethane (Zlatanic et al., 2004). Therefore, a processor that delivers oil for quality-sensitive applications like new biomaterials would not use this market and rather specify the iodine value or the content of linolenic acid in the supply contract.

For a rough estimation, the United Nations Conference on Trade and Development publishes Free Market Commodity Prices for selected commodities exported by developing economies on a monthly basis, as for wheat, cotton, tea, vegetable oilseeds and oils and cattle hides. However, prices for quality-sensitive renewable resources for the non-food industry might differ significantly. Because of the brisk development of new products and markets for renewable resources for industrial use, market mechanisms are not yet as elaborated as for the food industry, which has similar, albeit differing conditions. Therefore, in the following, the basic decision problem of processors of agricultural raw materials is being analysed.

Irrespective of the selected plant species, variations of quality and quantity of raw materials and commodity market prices can have a big impact on the optimal supply quantity. For many agricultural plants, harvests are only possible at specific times of the year. Therefore, due to the seasonal availability of supply, deciding the acreage for contract farming is a tactical decision. Seasonal availability of agricultural raw materials requires tactical plans that provide flexibility.

A processor can reduce the quality risk by engaging in contract farming, which is a well-known tool in agricultural production to diminish supply risk by sharing it (Eaton & Shepherd, 2001; Endres, Enderes, & Stoller, 2012). Minot (1986, p. 2) defines contract farming as “agricultural production carried out according to an agreement between farmers and a buyer, which places conditions on the production and marketing of the commodity”. The genetic disposition of the used linseed cultivar influences the composition of the oil (Nykter et al., 2006). Contract farming is advantageous for the production of agricultural raw materials of special quality, e.g. linseed with a high content of linolenic acid.

For the investigation of a suitable optimization approach, an initial decision situation is analysed as depicted in Fig. 3
                        . For the processor, a main source of supply is contract farming, i.e. an agreement with a farmer to use a fixed acreage x for the cultivation of the required crop. It is assumed that the price Pc
                         per unit of harvested good from contract farming is agreed at the time t
                        0 of signing the contract and the processor promises to buy the farmer's complete production quantity Qc
                         = xα, where α indicates the uncertain land productivity. As agricultural production is subject to natural variability, there is a risk of insufficient supply quality and quantity Qc
                        , which might cause shortages and reduce the profit. Relevant quality parameters are depicted in the vector 
                           
                              q
                              ¯
                           
                        . Their measurement units generally should not be important for the model but the fact of whether the quality of the raw material fulfils the given specification, i.e. if 
                           
                              
                                 
                                    q
                                    1
                                 
                                 ¯
                              
                              ≤
                              
                                 q
                                 ¯
                              
                              ≤
                              
                                 
                                    q
                                    2
                                 
                                 ¯
                              
                           
                         for all quality parameters in 
                           
                              q
                              ¯
                           
                         and upper and lower limits 
                           
                              
                                 q
                                 1
                              
                              ¯
                           
                         and 
                           
                              
                                 q
                                 2
                              
                              ¯
                           
                        . Products of lower quality or surplus production can be sold on the commodity market for an uncertain price Pcp
                        . The processor needs to give special attention to the supply planning process, especially to the tactical decision on the acreage x for contract farming. The industrial customer's demand Qd
                        , the sales price Pop
                         and the quality specification 
                           
                              
                                 
                                    q
                                    1
                                 
                                 ¯
                              
                              ,
                              
                                 
                                    q
                                    2
                                 
                                 ¯
                              
                           
                         are assumed deterministic elements of the planning situation. Penalty costs Cpen
                         occur if P cannot satisfy the demand of C.

@&#LITERATURE REVIEW@&#

In this section, supply planning literature is reviewed in order to identify suitable approaches to deal with seasonality, and simultaneously uncertain sales price, supply quality, and quantity. Tang (2006) reviews literature on supply chain risk management and provides a framework for classification. Approaches focusing on mitigation of supply chain risk are classified in supply management, product management, information management, and demand management. Strategic plans of supply management focus on supply network design, while tactical approaches investigate issues of supplier selection, supplier order allocation, and supply contracts.

In literature on supply planning, four different approaches are relevant to mitigate supply risk: keeping safety stock; diversifying sources of supply; hedging with tradeable contracts (especially derivatives); and hedging with real options, especially non-tradeable flexible contracts.

Safety stock is defined as “the planned or actual amount of ‘extra’ inventory used to protect against fluctuations in demand or supply” (Hill, 2012, p. 307). The placement of safety stocks to protect a supply network from effects of random disturbances is the main task of inventory management (Tempelmeier, 2011, p. 1). Inventory control as a sub-discipline of inventory management answers the question of how much to order and how many times to order. Single-product and multi-product, single-period and multi-period models can be distinguished, as well as deterministic and stochastic models. Low inventory levels might increase the probability of stock-outs (Waters, 2003). There are several approaches for dimensioning safety stocks under consideration of uncertainties. Inventory policies are applied to less important goods (Tempelmeier, 2011), while approaches for determination of lot sizes under random yields can be applied for goods with high value (see review of Yano & Lee, 1995). Nevertheless, approaches in this stream of research focus on dealing with uncertain demand.

In traditional inventory systems with uncertain demand, the safety stock is a hedge against uncertainty. In systems with uncertain supply, the second supplier can be the hedge against uncertainty (Anupindi & Akella, 1993). A diversification strategy is most interesting if the characteristics of the supplier differ from each other (Wang, 2007, p. 81). In agricultural production, regional diversification is a common risk mitigation strategy. In the literature on supplier diversification, the focus is on finding optimal inventory control strategies if purchasing is possible from two or more suppliers. Analogous to the literature on safety stock, uncertain parameters are usually modelled as random variables and analytical closed-form expressions are derived in this stream of research. The control strategy solves operational planning problems, but the aspect of supplier diversification is tactical. Weber, Current, and Benton (1991) review literature on supplier selection and identify the objectives net price, delivery, production capacity, and geographical location as of main importance. Tajbakhsh, Zolfaghari, and Lee (2007) review inventory models that use multiple sourcing to deal with supply uncertainty and sort them in the categories uncertain supply timing, uncertain supply quantity (or quality) and uncertain purchase price. Minner (2003) gives an overview on single stage inventory models that explicitly model multiple supply modes. Often they are extensions of basic inventory policies. Diversification of the supplier base can be used as a tactical measure to react on uncertain supply. Respective models often use safety stock as another measure to hedge against uncertainty, which can be expensive for the processor.

Hedging with tradeable contracts, especially derivatives, is another stream of research that provides tactical risk mitigation strategies. Most of the applications are in the financial sector. For a processor of agricultural raw materials – who needs to plan his supply and is exposed to supply risks – hedging with derivatives is an attractive countermeasure. A combination of forwards or futures and option contracts appears to be a promising approach for risk minimization. For innovative applications of material use of agricultural goods, however the industrial quality requirements towards raw materials might not match the specifications of commodity grades as in the example of linseed. Hence, the focus of further investigation is rather on non-exchange traded options and forward contracts than on exchange traded future contracts. For the processor, the focus is on finding a profit maximizing concept to ensure supply continuity. Fleten, Wallace, and Ziemba (2002) describe a supply planning problem of a producer of hydro-energy that uses derivatives to hedge against quantity and sales price risks. A five-stage stochastic program is used to find an optimal production and contracting strategy under consideration of seasonality.

As most markets for agricultural products are less standardized than electricity markets, approaches with non-standardized, non-traded risk management instruments are of special interest. In the electricity sector, risk hedging with real options is another strategy used on the operational level to manage uncertainties. It can be implemented in stochastic programming models as well (see, for example, Denton, Palmer, Masiello, & Skantze, 2003).

Real options can involve a contractual agreement but do not necessarily have to. Any options for physical delivery of raw materials are a form of real options. Applications of real options theory in the context of supply chain management are still rare (Hult, Craighead, & Ketchen, 2010). Yang, Burn, and Backhouse (2004) provide a framework for postponement of decisions in the areas of logistics, manufacturing and purchasing. The motivation behind postponement is to delay decisions until more information is available (Hult et al., 2010). Quantity flexible supply contracts are scale options and instruments to handle demand uncertainty and share the risk among buyer and supplier (Spinler, Huchzermeier, & Kleindorfer, 2003; Tsay, 1999). Sting and Huchzermeier (2013) provide a thorough review of literature on flexible supply planning with real options, supply planning under uncertain yield, supply disruptions, supplier diversification, and operational hedging. There is a comprehensive theory of real options analysis with the objective of finding appropriate prices for additional flexibility based on analysis of stochastic data (Schulmerich, 2010). Real options literature is rich in examples of how to combine different contract modes or how to counterbalance risk (Huchzermeier, 2005; Peng, Erthun, Hertzler, & Kempf, 2012; Serel, Dada, & Moskowitz, 2001). It provides interesting approaches of risk management for tactical supply planning problems, offering flexibility in the face of uncertain parameters and even seasonality. In real options literature, the focus is often on selecting profit maximizing portfolios for the decision maker. In contracting literature, the question whether a contract coordinates the supply chain is an important topic as well (Tsay, 1999).

In the reviewed approaches, different risk mitigation strategies are commonly applied. Safety stock is often used to balance short-term quantity variations and becomes expensive when kept for long time. Supplier diversification is a tactical risk mitigation strategy and can be combined with strategies of safety stock or hedging with derivatives or with real options. Option contracts for physical delivery can be traded on commodity markets or agreed directly with a supplier. They provide a good instrument to hedge against uncertain supply in a tactical planning horizon. For mitigation of non-standardized risks, many interesting approaches can be found in the literature on real options. In this stream of research, the objective is to select portfolios of strategies or investments that provide flexibility and maximize the profit of the decision maker. None of the reviewed quantitative supply planning approaches simultaneously considers seasonal availability, uncertain supply quantity and quality as well as uncertain sales price.
                  

Only a few works deal with supply planning decisions in the agricultural sector. Kazas and Webster (2011) describe the decision situation of a price setting fruit company, that has to decide on the optimal sales price and farming area under consideration of uncertain demand and supply yield. The situation is modelled as a two-stage stochastic program. The first stage presents the growing season and the second stage the selling season, which provides the decision maker with options on selling, buying or processing of goods. In spite of some similarities, the decision situation in this work provides different challenges, as here the demand is deterministic and uncertainty is encountered in supply quality and quantity as well as in sales prices. It resembles the decision problem of a production planner who has to meet the demand forecast from the sales department, but cannot influence the prices of his products.

To minimize the risk of the processor, a suitable risk minimization strategy needs to be selected. Based on that, suitable decision support can be developed. As the focus in this work is on supply planning for goods with little standardized supply markets, the use of an optional supply from a second supplier B is selected as a risk mitigation strategy against uncertainties arising from contract farming. This contract assures the availability of a specific supply quantity y of quality 
                           
                              q
                              ¯
                           
                         within the specified limits 
                           
                              [
                              
                                 
                                    
                                       q
                                       1
                                    
                                    ¯
                                 
                                 ,
                                 
                                    
                                       q
                                       2
                                    
                                    ¯
                                 
                              
                              ]
                           
                         at the time t
                        1 for a deterministic price Pc. Exchange traded options, over-the-counter traded options and flexible supply contracts can be used for this risk mitigation strategy. The respective implementation in a decision support model depicts the optional supply as a postponement option. The risk premium or option premium Pr
                         is the price paid by the processor for the flexibility of not having to exercise the contract. For non-exchange traded options, it needs to be negotiated. If the optional supply is a flexible supply contract, the respective actor B could be a farmer, a trader or another processor, who conducts additional processing steps and is capable to deliver a refined product. Then, the risk charge paid per unit of optional supply must sufficiently compensate supplier B for the extra costs. A main advantage of optional supply is that the contract can be designed to consider seasonality. The decision whether the optional supply should be accepted or not can be made when the availability of supply from contract farming becomes known. The determination of the right amount of optional supply y becomes part of the supply planning decision of the processor. The approach is depicted in Fig. 4. The decision on y is taken at the time t
                        0
                        , together with the decision x on the acreage for contract farming. By the time t
                        1
                        , the decision maker gains knowledge about the harvest from contract farming and takes the binary decision z whether to accept all optional supply or none.

As shown in Section 3, quantitative supply planning approaches that simultaneously consider seasonal availability, uncertain supply quantity and quality, as well as uncertain sales price are still lacking. These uncertainties require explicit handling, due to their importance for the processor. A key question is which method should be used to depict the uncertain elements of the planning problem.

The tactical planning problem of the processor involves high costs. Therefore, inaccurate solutions have large effects in terms of absolute cost. For this reason, a good approximation of the uncertain planning parameters might be given higher preference over the simplicity of the solution.

A key question when selecting the optimization method for modelling uncertainty is the availability and quality of data. An overview of the possibly available data in the decision situation is provided in Table 1
                        .

This work is intended to support supply planning when at least the following data are available:

                           
                              •
                              Information on past harvest quality and quantity of the same cultivar or of other cultivars of the same species. This data might be available at the individual or aggregated level.

Past data (daily, weekly or monthly) on commodity market prices. Surplus production can be graded and sold on the commodity market.

Information might be scarce and the exact underlying probability distributions are unknown. In addition to past data, there is some information available on the present planning situation, for instance, if fertilizers or pesticides are available and used. Expert knowledge on the effect of influencing factors on the harvest might be available. Similarly, some information on present situation on the commodity market and its influencing factors is also available. For all uncertain parameters, the decision maker is able to set up probability distributions that sufficiently describe his beliefs about possible future realizations.

If probability distributions for uncertain parameters are given, the application of stochastic programming approaches allows the processor to fully utilize the available information. For economic decisions and in the presence of uncertainty caused by natural variability, this is advisable (see Laux, Gillenkirch, & Schenk-Mathes 2012, p. 88). The advantages of stochastic programming include consideration of the temporal structure of information availability, the valuation of flexibility, and the ability to obtain optimal decisions under simultaneous consideration of all scenarios (Kall & Wallace, 2003).

Two-stage stochastic programs with recourse are used to model situations in which initial decisions have to be made under stochastic uncertainty and corrective actions can be taken after the values of uncertain parameters are known. This method allows the decision maker to find optimal first-stage decisions under simultaneous consideration of all possible scenarios that occur after the uncertain information is revealed. To measure the quality of the stochastic solution, it can be compared with the wait-and-see solution (WS), which would have been used if all information was available. The WS is constructed by calculating optimal decisions for each scenario (and thereby assuming deterministic information). Then, WS is calculated as the expected value for all these scenarios. Single objective values are multiplied with the probability of their occurrence. The WS is used to calculate the expected value of perfect information (EVPI), which is one of the most important measures for the quality of the stochastic solution. It measures the value of knowing the future with certainty and is calculated as the difference between the stochastic solution and the WS (Birge & Louveaux, 2011).

Probability distributions can be obtained by using past data, information about the actual decision situation, and incorporating beliefs of the decision maker, e.g. through Bayesian updating. A mathematically simpler approach is the direct use of subjective probability distributions based on expert knowledge. The applicability of this procedure for practitioners is beneficial. Uncertainty in important parameters can be considered directly by assigning a probability distribution to possible scenarios. How the decision maker specifies the subjective probabilities that a scenario will occur is important, as it has a high impact on the optimal decisions (Rae, 1971). In case of dealing with a “real” decision maker, this would be subject to discussion.

The uncertain input parameters for the model (cf. Fig. 4) are land productivity α and harvest quality 
                        
                           q
                           ¯
                        
                      of the supply ordered from supplier A as well as the commodity market price Pcp
                      on the demand side. The uncertainty on the supply side is the reason that decision support is developed. The price uncertainty on the commodity market CM must also be considered, even though the sale to CM is not the main objective of the processor P. The consequences of price uncertainty for the profit of P are too significant to be ignored in the design of the model (see Section 2). These three uncertain parameters introduce uncertainty to the values for several production and sales quantities, which are calculated as dependent variables. The affected values are the production quantity Qc
                      from contract farming, the sales quantity Qo
                      of the optional supply from B, the quantity of product Qcp
                      sold as commodity to CM, the quantity of ordered product Qop
                      sold to C and the production quantity Qs
                     , which fulfils the quality specification of C. The sales price Pop
                      and demand quantity Qd
                      of C are considered deterministic. In the tactical planning horizon, these values are forecasted or planned values and may be adjusted in a later stage of the planning process.

In the selected contract farming approach, P guarantees A at the time t
                     0 of signing the contracts that all harvest Qc
                      = xα from the acreage x is bought for a deterministic weight-based price Pc
                     , irrespective of its quality. Therefore, quality and price risks are absorbed by P. The quality 
                        
                           q
                           ¯
                        
                      of Qc
                      only becomes known at the time of harvest t
                     1. Supply of insufficient quality is accepted by the processor P and the resulting product, which does not fulfil the quality specification, is sold for an uncertain price Pcp
                      to CM. The risk to the supplier A is low harvest yield, which could occur in case of extreme weather events such as droughts, floods or storms, but also in case of pest infestation. This yield risk to the supplier A is an incentive to use optimal farming practices (see Section 2 and Endres et al., 2012).
                  

Penalty costs Cpen
                      occur if P cannot satisfy the demand of customer C. To reduce the risk of shortage or insufficient quality from A, P decides at the time t
                     0 to hedge with optional supply from supplier B, who promises to provide the quantity y of raw materials at the time of harvest t
                     1, when information about the supply from A becomes available. The optional supply y must be of a certain quality so that the resulting product is accepted by C. Basically, the price of y is Pc, paid to A for each unit of Qc
                     , plus an additional risk charge Pr
                      per unit of optional supply. The risk charge Pr
                      must be paid independent of usage of y and should enable B to profit from the contract and compensate him for inventory holding cost and his efforts to gain and provide the product. The decision of P, whether to accept the complete optional supply or not, is referred to with the binary decision variable z. The contracts with A and B are signed at time t
                     0 and should take into account the growing period until t
                     1 and the required supply volume until the harvest in the following period. Quantities will be estimated for a period of one year for most applications in the agricultural sector. Exceptions are possible in case of several harvests per year.

In this model, lead times are not considered, as the order frequency is low. If supply is delivered by air or land, replenishment lead times are probably not relevant due to the tactical planning horizon. Consideration of replenishment lead times would be relevant if the optional supply is transported by ship and required immediately after ordering, e.g. due to a total loss of supply from contract farming. This appears to be a rare case of emergency planning and is not the focal problem in this work. Transport costs are assumed to be deterministic, and can be integrated in unit prices paid to the suppliers. Inventory is assumed to be kept at the suppliers premises. Supplier B is compensated with the risk premium Pr
                      and A does not receive an extra compensation for keeping the inventory, as all supply is definitely accepted by the processor in the same planning period. In practice, compensation for inventory holding costs are only provided to contract farmers if the storage time exceeds a certain limit (see Wiedenmann, 2013). In the developed model, P is assumed to immediately sell the total amount of processed good to C with respect to CM. Models on inventory planning often consider fixed order costs. In this work, they are neglected, since the orders are only placed once per planning period. Machine costs would be relevant for operative planning approaches, but for the decision of P, they are not a limiting factor. Some models of operational supply planning consider a specific service level. This makes sense if the aim is to satisfy a specified percentage of orders at minimum cost. The situation considered in this work is different, as the aim is to satisfy a single order of an industrial customer and to deal with supply uncertainties in an adequate way. Hence, penalty costs occur in case of a shortage. In the developed model, this is a lump sum payment. Volume dependent penalty costs, as well as further modifications of the model, such as utilization of by-products, a price escalation clause, the possibilities to split optional supply, the presence of different quality grades on the commodity market or diversification on the demand side, are introduced in Wiedenmann (2013).

In order to solve the program with standard procedures, uncertain parameters must be measured, e.g. via using the expected value (Kall & Wallace, 2003). Based on discrete probability distributions of the uncertain parameters, scenarios ξi
                      are constructed, with i = 1, …, q. These scenarios are vectors of the realizations of the random variables α, Pcp
                      and 
                        
                           q
                           ¯
                        
                     . The probability for each scenario is the product of the probabilities for each realization of a random variable, which is an element of the vector ξi
                     . This procedure for the determination of scenario probabilities can be conducted for dependent and independent random variables.

The decisions required by the processor can be split in two decision stages: At time t
                     0 the processor choses the area x for contract farming and specifies the volume of optional supply y. At t
                     0, the realizations of three random variables are unknown: productivity of land α, quality measures 
                        
                           q
                           ¯
                        
                     , and commodity market price Pcp
                      are unknown. The uncertainty is revealed at the time of harvest t
                     1 and then the processor has to take the second-stage decision z, whether he wants to buy the optional supply y or not.

A two-stage stochastic program with recourse is constructed step-by-step, beginning with the deterministic case as described in Wiedenmann (2013). The random variables are depicted through scenarios ξi
                     , which combine their values and their joint probability. Several second-stage variables are introduced in order to ensure steadiness of the constraints and the objective function. Their value is calculated for each scenario. The resulting model is depicted in (1)–(16). An overview of parameters and variables is given in Table 2. The model is used to determine the optimal first-stage decisions x and y considering all i scenarios ξi
                      of the realizations of the random variables. The second-stage decision z(ξi
                     ) is taken, after the uncertainty is revealed and the values of the random variables are known in the specific scenario ξi
                     . The objective is maximization of the expected profit, as the aim of the processor. The objective function consists of a term that calculates the expected value for the scenarios ξi
                      of the random variables and the probabilities pi
                      assigned to them and a term independent of the scenarios. This term depending on the scenarios is the sum of the revenue from selling the product to the industrial customer, the revenue from selling the product on the commodity market, the penalty costs in case the demand of the industrial customer is not satisfied, the costs for contract farming, and the costs for the optional supply (in case it is used). The risk premium yPr
                      for keeping the optional supply is paid to supplier B independently of the scenarios on the second stage.

Constraint (1) considers crop rotation, as f years need to elapse till the crop can be planted on the same soil again. Therefore, only a fraction of the total available land of supplier A can be used for contract farming of the considered crop. Constraint (2) is used to calculate the supply quantity from contract farming Qc
                      in units of raw material, e.g. tons of seeds. Constraint (3) relates the amount of optional supply y to the demand of the industrial customer Qd
                      and therefore avoids keeping stock for the purpose of speculation. Constraint (4) models that penalty costs have to be paid if the demand of the industrial customer cannot be satisfied by setting the binary second-stage variable xpen
                     . Constraint (5) sets the binary quality indicator xq
                      = 1 if the product quality 
                        
                           q
                           ¯
                        
                      from contract farming does not satisfy the quality specification 
                        
                           [
                           
                              
                                 q
                                 1
                              
                              ¯
                           
                           ,
                           
                              
                                 q
                                 2
                              
                              ¯
                           
                           ]
                        
                      of the industrial customer. Constraint (6) sets the binary decision variable for penalty costs xpen
                      = 1 if the quality of the supply from contract farming is insufficient (xq
                      = 1) and no optional supply is accepted (z = 0). Constraints (7) and (8) determine the quantity Qs
                      of the high quality product, which can be sold to the industrial customer.

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          max
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             p
                                             i
                                          
                                          (
                                          
                                             Q
                                             
                                                o
                                                p
                                             
                                          
                                          
                                             (
                                             
                                                ξ
                                                i
                                             
                                             )
                                          
                                          
                                             P
                                             
                                                o
                                                p
                                             
                                          
                                          +
                                          
                                             Q
                                             
                                                c
                                                p
                                             
                                          
                                          
                                             (
                                             
                                                ξ
                                                i
                                             
                                             )
                                          
                                          
                                             P
                                             
                                                c
                                                p
                                             
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          −
                                          
                                          
                                             x
                                             
                                                p
                                                e
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                ξ
                                                i
                                             
                                             )
                                          
                                          
                                          
                                             C
                                             
                                                p
                                                e
                                                n
                                             
                                          
                                          −
                                          
                                             Q
                                             c
                                          
                                          
                                             (
                                             
                                                ξ
                                                i
                                             
                                             )
                                          
                                          
                                             P
                                             c
                                          
                                          −
                                          
                                             C
                                             o
                                          
                                          
                                             (
                                             
                                                ξ
                                                i
                                             
                                             )
                                          
                                          )
                                          −
                                          y
                                          
                                             P
                                             r
                                          
                                       
                                    
                                 
                              
                           
                        
                     s.t.

                        
                           (1)
                           
                              
                                 0
                                 ≤
                                 x
                                 ≤
                                 
                                    
                                       A
                                       c
                                    
                                    f
                                 
                                 
                                 
                                    (
                                    crop
                                    
                                    rotation
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    Q
                                    c
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 =
                                 x
                                 α
                                 
                                    (
                                    i
                                    )
                                 
                                 
                                 
                                    (
                                    quantity
                                    
                                    from
                                    
                                    contract
                                    
                                    farming
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 0
                                 ≤
                                 y
                                 ≤
                                 
                                    
                                       Q
                                       d
                                    
                                    β
                                 
                                 
                                 
                                    (
                                    limitation
                                    
                                    of
                                    
                                    optional
                                    
                                    supply
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    Q
                                    d
                                 
                                 −
                                 
                                    Q
                                    
                                       o
                                       p
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ≤
                                 M
                                 
                                    x
                                    
                                       p
                                       e
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 
                                 
                                    (
                                    penalty
                                    
                                    for
                                    
                                    insufficient
                                    
                                    supply
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    q
                                    ¯
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 ∉
                                 
                                    [
                                    
                                       
                                          
                                             q
                                             ¯
                                          
                                          1
                                       
                                       ;
                                       
                                          
                                             q
                                             ¯
                                          
                                          2
                                       
                                    
                                    ]
                                 
                                 ⇒
                                 
                                    x
                                    q
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 =
                                 1
                                 
                                 
                                    (
                                    quality
                                    
                                    specification
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    x
                                    q
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 ≤
                                 z
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 M
                                 +
                                 
                                    x
                                    
                                       p
                                       e
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 
                                 
                                    (
                                    penalty
                                    
                                    for
                                    
                                    insufficient
                                    
                                    quality
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    x
                                    q
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 
                                    Q
                                    s
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ≤
                                 β
                                 
                                    Q
                                    o
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 
                                 
                                    (
                                    quantity
                                    
                                    of
                                    
                                    high
                                    
                                    quality
                                    
                                    product
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             (
                                             
                                                1
                                                −
                                                
                                                   x
                                                   q
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             )
                                          
                                          ·
                                          
                                             Q
                                             s
                                          
                                          
                                             (
                                             
                                                ξ
                                                i
                                             
                                             )
                                          
                                          ≤
                                          β
                                          
                                             (
                                             
                                                
                                                   Q
                                                   c
                                                
                                                
                                                   (
                                                   
                                                      ξ
                                                      i
                                                   
                                                   )
                                                
                                                +
                                                
                                                   Q
                                                   o
                                                
                                                
                                                   (
                                                   
                                                      ξ
                                                      i
                                                   
                                                   )
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          (
                                          quantity
                                          
                                          of
                                          
                                          high
                                          
                                          quality
                                          
                                          product
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    Q
                                    o
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ≤
                                 
                                    
                                       z
                                       
                                          (
                                          
                                             ξ
                                             i
                                          
                                          )
                                       
                                       
                                          Q
                                          d
                                       
                                    
                                    β
                                 
                                 
                                 
                                    (
                                    quantity
                                    
                                    optional
                                    
                                    supply
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    Q
                                    o
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ≤
                                 y
                                 
                                 
                                    (
                                    quantity
                                    
                                    optional
                                    
                                    supply
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 y
                                 
                                    P
                                    c
                                 
                                 ≤
                                 
                                    (
                                    
                                       1
                                       −
                                       z
                                       
                                          (
                                          
                                             ξ
                                             i
                                          
                                          )
                                       
                                    
                                    )
                                 
                                 M
                                 +
                                 
                                    C
                                    o
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 
                                 
                                    (
                                    cost
                                    
                                    optional
                                    
                                    supply
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    Q
                                    
                                       o
                                       p
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ≤
                                 
                                    Q
                                    d
                                 
                                 
                                 
                                    (
                                    product
                                    
                                    quantity
                                    
                                    sold
                                    
                                    to
                                    
                                    C
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    Q
                                    
                                       o
                                       p
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ≤
                                 
                                    Q
                                    s
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 
                                 
                                    (
                                    
                                       product
                                       
                                       quantity
                                       
                                       sold
                                       
                                       to
                                       
                                       C
                                    
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Q
                                             
                                                c
                                                p
                                             
                                          
                                          
                                             (
                                             
                                                ξ
                                                i
                                             
                                             )
                                          
                                          ≤
                                          
                                             Q
                                             s
                                          
                                          
                                             (
                                             
                                                ξ
                                                i
                                             
                                             )
                                          
                                          −
                                          
                                             Q
                                             
                                                o
                                                p
                                             
                                          
                                          
                                             (
                                             
                                                ξ
                                                i
                                             
                                             )
                                          
                                          +
                                          
                                             x
                                             q
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          
                                             Q
                                             c
                                          
                                          
                                             (
                                             
                                                ξ
                                                i
                                             
                                             )
                                          
                                          β
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          (
                                          product
                                          
                                          quantity
                                          
                                          sold
                                          
                                          to
                                          
                                          CM
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 0
                                 ≤
                                 x
                                 ,
                                 y
                                 ,
                                 
                                    Q
                                    s
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ,
                                 
                                    Q
                                    c
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ,
                                 
                                    Q
                                    o
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ,
                                 
                                    Q
                                    
                                       o
                                       p
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ,
                                 
                                    Q
                                    
                                       c
                                       p
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ,
                                 
                                    C
                                    o
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 
                                    x
                                    
                                       p
                                       e
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ,
                                 
                                    x
                                    q
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 ,
                                 z
                                 
                                    (
                                    
                                       ξ
                                       i
                                    
                                    )
                                 
                                 ∈
                                 
                                    {
                                    
                                       0
                                       ,
                                       1
                                    
                                    }
                                 
                              
                           
                        
                     
                  

Constraint (9) effectively limits the second stage variable for the quantity of optional supply Qo
                      = 0, if the decision is to accept optional supply z = 0, and constraint (10) limits Qo
                      to the first-stage decision y. Constraint (11) sets the raw material costs for the optional supply C0
                      = yPc
                     , if z = 1. Constraints (12) and (13) limit the quantity Qop
                      of the processed good sold to the industrial customer rather to the demand of the industrial customer Qd
                     , or to the available produced quantity of sufficient quality Qs
                     . Constraint (14) is used to estimate the quantity Qcp
                     , which is sold on the commodity market. The model is verified with several test cases, as described in Wiedenmann (2013).

A major concern regarding such stochastic models, is whether they meet non-arbitrage conditions that would presumably be present in any commodity market (Klaassen, 1997). Arbitrage describes the practice of taking advantage of a price difference between two or more markets, but in the analysed decision problem, the focus is on the termination of a suitable acreage for contract farming with one business partner.

As the model does not include any conditions on the structure of the prices for buying or selling, there is no non-arbitrage condition explicitly built into the model. On the other hand, Klaassen (1997) states, that arbitrage opportunities get included in models through improper sampling techniques. The way this model should be used, however does not require sampling to depict probability distributions of prices. The purchase price Pc
                      and the sales price Pop
                      are deterministic. The commodity market price for the processed good Pcp
                      is uncertain. In real world applications, its distribution should not be sampled from past data, but forecasted by experts. Another reason for the arbitrage-freeness of the model is, that the sold good is processed and therefore differs from the purchased good, which is a raw material.

The model is implemented in OPL (Optimization Programming Language) and run in CPLEX. A set of scenarios with simple parameter values is used for verification (see Wiedenmann, 2013, p. 81). The model is validated by a numerical analysis including a sensitivity analysis with varying realistic input parameters as shown in Section 6.

Given the rapid development in industrial use of renewable resources, it can be expected that many new forms of contract farming for very specific quality requirements emerge, while no past data is available for the new specimen. In this section, the model is validated by applying it on data for linseed (see Section 2). This is not a real-world case study but a numerical example. It illustrates the situation that a linseed processor P would face if he only has access to past data, and plans his supply for the production of high quality oil for an industrial customer C.

For the validation, data for the parameters need to be suitably selected to represent a realistic decision situation. Nevertheless, all values in this numerical example are given for one period. Selecting probability distributions for the random variables can be a difficult task. All three uncertain parameters are continuous, as values can take real umbers. Therefore, they have a continuous distribution, but its type is not known. For the investigated problem, past data on linseed yield and content of linolenic acid are available and can be used to explore the behaviour of the model (see Section 6.2). In a real-world application, these values should be combined with expert knowledge in order to incorporate additional knowledge about the underlying probability distributions and predict possible future outcomes. For this numerical analysis, no expert opinion could be obtained. Different sets of past data for the price Pcp
                      on the commodity market CM are tested with the model to illustrate the effect of different probability distributions on the profit and the optimal decisions. EVPI is calculated for all cases, and results are provided in Section 6.2.

Relatively stable values can be modelled as deterministic para-meters. Nevertheless, in real-world applications, values of these parameters might change due to unforeseen events. There is also a range of values which are plausible for the parameters. The effect of variations of the deterministic parameters on the profit is tested in a sensitivity analysis in Section 6.3 and the behaviour of the model is explored thoroughly.

In this section, values for deterministic parameters and random variables are explored and selected for the numerical analysis. Respective information on parameter selection is provided in this section and based on data provided in Section 2. Decisions are relative to the selected input data, which is important for the interpretation of the results. Obviously, test instances can be created that are very insensitive to different sets of input data, e.g. if production is very profitable or not profitable at all.


                        Productivity of the processing plant β: The oil content of linseed varies between approximately 43 and 46 percent (Rowland, 2002). As a mill is usually not able to extract the complete oil content and a minimum oil content of around 3 percent remains in the meal, β is set as 40 percent and the value 0.4 is used in the calculation.


                        Price of supply from contract farming Pc
                        : The price per tonne of linseed in Manitoba was below 400 [dollars per tonne] in 18 out of the 21 observed years (1990–2011). The average price for these years was 308 [dollars per tonne]. The price Pc
                        , paid to A for supply from contract farming should be competitive, and therefore, is selected as 400 [dollars per tonne], which leads to a low estimation of P's profit. If Pc
                         = 
400 [dollars per tonne] and β = 
0.4, marginal profit can be gained for sales prices above 1000 [dollars per tonne] for the product based on A's supply.


                        Risk charge for optional supply Pr
                        : The risk charge Pr
                         is a compensation to supplier B for providing flexibility to the decision maker. Its value is similar to an option premium for a derivative. Real option theory could be used to calculate the fair value of Pr
                         (see Section 3). In the numerical analysis, Pr
                         is selected as 100 [dollars per tonne] in order to provide a reasonable compensation and incentive for B.


                        Land productivity α(i): Annual average land productivity values from Manitoba for the years 1990–2011 are selected as given in Fig. 1. Without any loss of information they can be aggregated in classes from 1.1 to 1.6 [tonnes per hectare] with class widths of 0.1 [tonnes per hectare]. Stochastic independence of land productivity and harvest quality is assumed (see Section 5).


                        Quality
                        
                           
                              
                                 q
                                 ¯
                              
                              
                                 (
                                 i
                                 )
                              
                           
                         
                        and quality indicator xq
                        (i): The linolenic acid content is selected as the only quality measure. Annual average values from Manitoba for the years 1990–2010 are used as provided in Fig. 1. The linolenic acid content varies between 52.2 percent and 61 percent. This range is relatively small compared to the ranges of values of the two other uncertain parameters. The median of the past values is 58 percent. Quality specification is assumed to allow only for qualities above 57 percent. The product resulting from supply of insufficient quality (
                           
                              
                                 q
                                 ¯
                              
                              
                                 (
                                 i
                                 )
                              
                              ≤
                              57
                              
                              percent
                           
                        ) is not accepted by the industrial customer (xq(i) = 
1). This happens in 19 percent of the scenarios.


                        Linseed oil commodity market price Pcp
                        (i): Data for all monthly linseed oil CM prices from 1996 to 2010 are purchased from Oil World, ISTA Milke GmbH, a company that provides information on the oilseed market. Due to legal restrictions, the authors are only allowed to use the original data in the numerical analysis but are not allowed to publish it. Fig. 2 provides an orientation depicting price data for linseed, which are strongly correlated to the prices for linseed oil. The annual prices for linseed tend to increase, but there is also high price volatility among the annual average prices. In some years, monthly average prices show extreme variations, while in other years, only small variations. If only past data were available, the decision maker might opt to test the effect of using different data sets on the optimal decisions and the resulting profit. Hence, the four different sets of price data (a)–(d) are used in the numerical analysis. They provide insight on the effect of using data sets with monthly average prices for different years and to using a set with annual average prices as values for Pcp
                        (i). The standard deviation of the data sets is a measure for the dispersion among the past values. The model is applied to the following data sets:

                           
                              (a)
                              Monthly average CM prices for the year 2010, which show a medium standard deviation of 165.01. The expected value is the average of the annual prices and is used in the deterministic case. Its value is 1163 [dollars per tonne]. For data sets (b)–(d), the deterministic prices are constructed analogously. Together with the values for the deterministic parameters, data set a) is selected for the construction of the reference case because it contains the most actual data and shows a medium range and variance of dispersion.

Monthly average CM prices for the year 2008, which show the highest annual standard deviation of 280.95. The annual average price is 1551 [dollars per tonne].

Monthly average CM prices for the year 2003, which show the lowest annual standard deviation of 26.1. The annual average price is 678 [dollars per tonne].

The annual average CM prices for 1996–2010, which have a standard deviation of 317.17. An annual average value is calculated as the average of monthly average values from January to December. The average of all annual average values in this set is 778 [dollars per tonne].


                        Linseed oil price paid by industrial customer Pop
                        : The price Pop
                        , which is paid by C per unit of ordered product is selected as 1500 [dollars per tonne]. It is higher than the price on the commodity market Pcp
                         in most scenarios. This high and stable price should provide an incentive to actors upstream the supply chain to engage them to use linseed. One might ask why C should pay such a high price if Pcp
                         is very low. The industrial products of C might be sold to a target group that is price insensitive as it values so called environmentally-friendly products. As sample products, one could think e.g. of foams based on linseed polyurethanes, which are used for the production of chairs. The covering of the chair could be produced from linseed or flax fibre and the product can be advertised as an eco-friendly chair. Customers might be willing to pay a higher price for a product completely based on renewable resources. The demand and the price can be interpreted as deterministic values for a single production run and adjusted after the sales volume is known.
                        
                     


                        Other parameters: The parameter values for the demand Qd
                         and the available acreage Ac
                         are selected in order to provide comprehensible results. A crop rotation cycle of five years ( f = 
5) is assumed. The total available acreage Ac
                         = 
5000 [hectare] is divided by the parameter for crop rotation f = 
5. Thus, x can take a maximum value of 1000 [hectare]. The required acreage x, with respect to the required optional supply y to satisfy the demand Qd
                        , depends on the land productivity α in each scenario. The demand Qd
                         is selected as 500 [tonnes].

Penalty costs of Cpen
                         = 100,000 [dollars] are an incentive for P to be a reliable supplier for C. This amount must be fixed in the contract. A lump sum penalty seems to be realistic, as due to financial criteria P chooses to either sell his product to C or CM. If a long-term relationship is targeted by P, he might even use a higher penalty cost for his internal calculation. In mathematical modelling, penalty costs have the effect of soft constraints, which direct the solution process of the model but do not impose an unrealistic restriction.

@&#RESULTS AND DISCUSSION@&#

The stochastic model is applied to the values provided in Section 6.1. The aim is to show the applicability of the model for realistic cases and to analyse the results. As the data is not provided by a real decision maker, this study is only a numerical analysis. Three topics are of interest:

                           
                              1.
                              computational complexity,

testing effects of different probability distributions on values of decision variables and expected profits; and

comparison of the objective values to results of other optimization approaches.

Sets of past data for the uncertain parameters are combined to create i = 
1, …, q scenarios. For quality 
                           
                              
                                 q
                                 ¯
                              
                              
                                 (
                                 i
                                 )
                              
                           
                         and land productivity α(i), only the past data from Manitoba (see Section 6.1) are available. The probability distributions for the binary quality indicator xq
                        (i) are generated based on the quality data. The different data sets (a)–(d) for the CM price Pcp
                        (i) of Section 6.1 are available and together, with past data for α(i) and xq
                        (i), used to establish the four cases (a)–(d) for the numerical analysis.

For each case from (a) to (d), the stochastic problem instance with the three random variables Pcp
                        (i), α(i) and xq
                        (i) is labelled as the “stoch(all)” instance. Values of the deterministic parameters are provided in Table 3.

The calculation time of the stochastic program depends on the selected values, the number of scenarios and the number of random variables in the instance. For applications of the model, especially the selection of values and the number of scenarios have a crucial influence on the calculation time. Calculations are conducted with a 2.3 gigahertz processor. An instance with 180 scenarios was solved in 4 
seconds, but after variation of two parameters, the calculation time strongly increased and the optimality gap was still 1.14 percent after 150 minutes. This behaviour is probably caused by the model structure and the solution procedure selected by CPLEX. The model is a mixed integer piece-wise linear program. The decision variable z(ξi
                           ), which indicates the acceptance of the optional supply, needs to take integer values of either 1 or 0. Therefore, the calculation is more complex than for a linear problem, as the number of feasible solutions is reduced and the search time is enhanced. Due to the complexity of the problem, the optimal solutions cannot be depicted by an analytical function.

Price data is classed in the cases (a), (c) and (d) in order to reduce calculation time by reducing the number of scenarios. In case (b), the run-time was not problematic. Classing leads to a loss of accuracy, which can be measured through the standard deviation for single set of price data. An overview is provided in Table 4. The initial number of scenarios is indicated under N1 and the number of scenarios after classing under N2. The calculation time of the stoch(all) instances of the four cases, eventually after classing, is provided in Table 4 as well.

The selected set of price data has a large effect on the resulting profit. The profit varies between 432,083 dollars in case (b) and 132,722 dollars in case (c) among the stoch(all) instances. These variations result from different ranges and averages of scenario values for Pcp
                            in the data sets a)–(d).

The question arises, as to how the selection of price data influences the optimal first-stage decisions. The acreage for contract farming x is selected between 962 and 1000 [hectares] in the stoch(all) instances of all cases. The optimal decision for y in the stoch(all) instances is 192 [tonnes] in case (c) and (d), and in case (a) and (b) it is 1250 [tonnes]. Thus, the decision on optimal values for x is relatively stable, but the optimal decision on y varies considerably depending on the selected input data set for Pcp
                           (i). This indicates how much the reliability of the processor's plans will benefit from careful selection of price data.

Different sets of past data can have a large influence on the results. In a practical application, the results of the optimization should be tested on their stability for different probability distributions of the land productivity α and the quality indicator xq
                            as well. Due to lack of alternative data sets for these parameters, this stability analysis is not carried out in this work. Probability distributions of the price and the other random variables should be constructed under consideration of expert knowledge. As the probability distribution for future events is unknown, an expert has to select suitable past data and can adjust them to his beliefs.
                        

The objective function of the two-stage stochastic program with recourse (1)–(16) is piece-wise linear due to the binary quality indicator xq(i), the binary second-stage decision z’(ξi
                           ) and the binary second-stage variable xpen
                           (ξi
                           ). The EVPI is a measure to evaluate the solution of the stochastic program. It is defined for linear two-stage stochastic programs with recourse (Birge and Louveaux 2011, 163 ff.). In contrast to the value of the stochastic solution (VSS), which is another important measure for the quality of the stochastic solution, the EVPI can be obtained. The optimal solutions for single scenarios and the resulting expected value for all scenarios of an instance can be calculated as in WS (see Section 4.2), with 
                              
                                 WS
                                 =
                                 
                                    E
                                    ξ
                                 
                                 
                                    [
                                    
                                       
                                          min
                                          x
                                       
                                       
                                          z
                                          ′
                                       
                                       
                                          (
                                          
                                             x
                                             
                                                (
                                                ξ
                                                )
                                             
                                             ,
                                             ξ
                                          
                                          )
                                       
                                    
                                    ]
                                 
                              
                           , whereby x indicates decision variables. The random variables are indicated by ξ. Its realizations, the scenarios, become inputs of the model. To calculate the WS, the objective value z'(x(ξ), ξ) is determined for each scenario. The EVPI is the difference between WS and the stoch(all) objective value.

EVPI = stoch(all) – WS, with 
                              
                                 s
                                 t
                                 o
                                 c
                                 h
                                 
                                    (
                                    
                                       a
                                       l
                                       l
                                    
                                    )
                                 
                                 =
                                 
                                    min
                                    x
                                 
                                 
                                    E
                                    ξ
                                 
                                 
                                    z
                                    ′
                                 
                                 
                                    (
                                    
                                       x
                                       ,
                                       ξ
                                    
                                    )
                                 
                              
                           . It indicates the additional expected profit that could be obtained if the decision maker had perfect foresight. It is larger than zero in all four cases, which is another reason to invest in more knowledge of price data. The results are provided in Table 5
                           .

As the results show, it is very difficult for the decision maker to find a flexible solution that considers all scenarios properly due to the complexity of the calculation. Therefore, a decision support tool is required. The results of the implemented tool appear to be valid information for the decision maker, but the selection of suitable input data requires special attention.

The effects of variations of single parameters on the objective value for one problem instance are tested in one-at-a-time sensitivity analysis (see French, 2003). Knowing the sensitivity of the model to its input data is important because some of the parameters strongly affect the results.


                        Fig. 5 illustrates the effect of varying single deterministic parameters of the deterministic instance of the reference case with sufficient quality (see Section 6.2). The parameter values are set 100 percent and single parameters are varied between 0 and 200 percent in steps of 10 percent, while the other values are kept constant. This helps to visualize how the profit is sensitive to variations of input data and to understand the general behaviour of the model. Some functions show kinks due to the piece-wise linearity of the objective function. The exact range of values, in which variations of parameters does not have an effect on decisions, is provided in the text and can slightly differ from their location in the graph. Therefore, the lines in Fig. 5 are dotted.

Lines with a steep slope indicate that a small change of the para-meter value has a large effect on the objective value. The productivity of the mill β, the price for supply from contract farming Pc
                         and the price Pop
                         paid by C for the ordered product have the highest impact on profit and need to be selected carefully. The graphs of the deterministic parameters are described as follows.


                        Penalty costs Cpen
                        : As no penalty costs have to be paid in this instance, a variation of penalty costs has no influence on the profit and the respective graph is a horizontal line.


                        Demand quantity of the industrial customer Qd: Profit and demand are correlated, and a penalty has to be paid if the demand is not satisfied. In the case of Qd
                         = 0 [tonnes], no product needs to be sold to C, and no penalty costs occur if all product is sold to CM. If the demand exceeds the required supply from contract farming, additional optional supply is ordered.


                        Productivity of the processing plant β: The productivity of the processing facilities has a major influence on the profit. Oil contents are subject to natural variability as well, and they vary from cultivar to cultivar. An assessment is required in the design and application of the model to determine whether this parameter should be modelled as an additional random variable. This could be a more realistic model for some crops or situations but complicates the model and the interpretation of the results.

In the reference case β = 0.4. For β below 0.38, supply from A is not sufficient to produce enough oil to satisfy the demand of C. Optional supply from B is reserved and accepted to ensure supply continuity. This increases the costs per unit of product and leads to a steeper slope of the curve for β in the sensitivity analysis. For values of 0.38 ≤ β ≤ 0.43, only supply from A is ordered and the demand of C is satisfied. Surplus production is sold to CM. For 0.43 ≥ β, using optional supply and selling the respective surplus production to CM is the profit maximizing strategy.


                        Total available land for contract farming Ac: The profit is correlated to the total available land for contract farming. Using supply from A has marginal costs of 1000 [dollars per tonne] and using supply from B has marginal costs of 1250 [dollars per tonne]. The price Pop
                         paid by C is 1500 [dollars per tonne], and for selling on the commodity market Pcp
                        , is 1163 [dollars per tonne]. Thus, it is profitable to use supply from both sources. Products based on supply from A can be sold to CM profitably. The profit increases if the available land for contract farming increases. First, the demand of C is satisfied in order to be exempted from paying penalty costs.


                        Price of supply from contract farming Pc: Varying the price paid for supply from A shows the profit maximizing decision behaviour of the model. For Pcp
                        (i) = 1163 [dollars per tonne] and β = 0.4 [percent], a purchase price of 465 [dollars per tonne] is the break-even point. For Pop
                         = 1500 [dollars per tonne], the break-even purchase price is Pc
                         = 600 [dollars per tonne]. For optional supply, an additional 100 [dollars per tonne] risk charge is added to the purchase costs. The following quantities are purchased depending on Pc
                        :

                           
                              •
                              For Pc
                                  ≤ 365 [dollars per tonne], maximum optional supply as well as maximum supply from contract farming are purchased.

For 365 [dollars per tonne] ≤ Pc
                                  ≤ 465 [dollars per tonne], maximum supply from contract farming and no optional supply are purchased.

For 465 [dollars per tonne] ≤ Pc
                                  ≤ 680 [dollars per tonne], only enough supply from contract farming is purchased to satisfy the demand of the industrial customer and no penalty needs to be paid. For Pc
                                  = 680 [dollars per tonne] and a sales price Pop
                                  = 1500 [dollars per tonne] the total loss is equal to the penalty costs of Cpen
                                  = 100,000 [tonnes].

For 680 [dollars per tonne] ≤ Pc
                                 , no supply is purchased and the penalty is paid.


                        Risk charge optional supply Pr: For Pr
                         ≤ 65 [dollars per tonne], the maximum optional supply is reserved and accepted as this is profitable. For higher risk charges, no optional supply is reserved.

@&#CONCLUSIONS@&#

Rising demand for industrial products from renewable resources calls inter alia for decision support for industrial processors of agricultural raw material. While many decision models for supply planning or price settings in the food industry are available, the supply planning for emerging industrial bio-based products shows some peculiarities. Especially the tight quality requirements impede sourcing from commodity markets, but require contract farming with exclusive business partners. In this work, for the first time an approach is developed for supply planning considering requirements caused by material use of agricultural raw materials: seasonal availability, uncertain supply quality and quantity, and uncertain sales price. Using optional supply can be applied if an actor is willing to provide such for a risk premium. The developed decision support for processors of agricultural raw materials determines the optimal acreage for contract farming and the volume of optional supply for various situations.

This work extends the body of knowledge as it demonstrates the suitability and flexibility of stochastic programming for modelling such problems. The stochastic program can easily be adapted to other decision situation as to model utilization of by-products, penalty costs proportional to the volume of shortage, a price escalation clause, the possibilities to split optional supply, the presence of different quality grades on the commodity market or diversification on the demand side (see Wiedenmann, 2013). A modification of the model has been implemented for a seed company (see Wiedenmann, 2013). This flexibility of the method is significant, especially compared to analytically derived closed-form expressions, which are commonly applied in inventory control.

The data for linseed are based on values taken from the literature. The scarcity of past data and the difficulty of how to select the right data set is a problem that a processor or farmer might face if he engages in cultivation of linseed for the first time. He might receive information about past yields and harvest quality from experienced actors in the market, but their relevance for the actual planning is unknown. Therefore, the stability of results needs to be investigated by testing several probability distributions and by conducting a sensitivity analysis. Hence, selecting four sets of past price data to test the model results reflects a step in the decision process a new actor in the market would conduct. As the values of the stochastic solution for the four different cases show, in a real-world application, the decision maker should invest in gaining additional information about the market conditions that support the appropriate selection of probability distributions. Past data sets for quality and quantity of the farm level would provide more information about possible ranges of values for a single farmer, but are not available in the literature. Statements about the optimal decisions should only be given if company data of sufficient quality are available. For the four problem instances, the expected value of perfect information is calculated which emphasizes the possibility to gain additional profit by improving the information on uncertain parameters.

As the material use of agricultural resources will gain increasing importance, the need for specific decision support for involved decision makers will increase as well. Due to seasonal availability of supply, the respective planning problems are tactical. Stochastic programming provides suitable modelling approaches for such problems if uncertain parameters can be described with probabilistic information. The effort for the development of decision support or its modification should be in a justifiable relation with the additional profit gained by using the approach. In principle, such models can be applied in many situations of stochastic uncertainty in which decisions, e.g. in purchasing, production, or sales, need to be made early in advance before the uncertainty is revealed. This type of situations is quite common in the context of using renewable resources, e.g. for the decision which crops to grow in the coming years on a short rotation coppice (see Ide, 2013). Decision support based on stochastic programming might also be suitable for other actors in a bio-based supply chain, who have to conduct tactical planning decisions, e.g. for farmers as well as for processors, producers and distributors downstream the supply chain. The approach of including options to mitigate risk might be applied in such cases as well.

This research has been partially supported by the European Union Seventh Framework Programme (FP7-PEOPLE-2009-IRSES) under grant agreement no. 246647. Further support was received by the German Research Foundation (DFG), grant GRK 1703/1 for the Research Training Group ‘Resource Efficiency in Interorganizational Networks – Planning Methods to Utilize Renewable Resources’.

@&#ACKNOWLEDGEMENTS@&#

The mathematical formulation of the two-stage stochastic program was collaborative research with Sven Krumke, Optimization Group, University of Kaiserslautern, Germany, whom we thank for his very helpful remarks during our cooperation within the OptALI project, which was coordinated by Anita Schöbel, Institute for Numerical and Applied Mathematics, University of Göttingen. We also thank the three anonymous reviewers for their very constructive comments and suggestions.


                     
                        
                           
                        
                     
                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

