@&#MAIN-TITLE@&#A novel ensemble approach using individual features for multi-focus image fusion

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We developed Ensemble-Individual-Features (Ens-IF) approach for multi-focus image fusion by combining the decision information of individual features.


                        
                        
                           
                           The proposed Ens-IF approach is superior in comparison to the individual pixel-level and the feature-level fusion approaches.


                        
                        
                           
                           The proposed approach can be employed as a post-processor in medical imaging and confocal microscopy systems to reduce the blurring artifacts.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multi-focus

Image fusion

Ensemble

Confocal microscopy and CT images

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           Image, graphical abstract
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

The process of image fusion integrates complementary information in multiple images to generate an image that contains more information [1]. However, in multi-focus image fusion, images with multiple focuses are combined to get an image that contains all-in-focus objects. Defocussed images, generally, result from limited field depth of optical lenses. While image is being captured, only objects at a particular distance are in-focus, and other objects are defocused. Thus, the captured image does not contain clear information that is essential for pattern recognition and computer vision applications. Image fusion approaches are also being used in medicine, surgery, flight aviation, robotics, sensor vision, and military applications.

In medical diagnostics, medical images are acquired through different modalities. These images are also degraded with blur during their acquisition [2]. Positioning-aids are used in computed tomography (CT) and magnetic resonance (MR) imagery to prevent voluntary motion. In many cases, it is difficult to control patient movement. For example, pediatric patients, involuntary organ motion, respiration, and heart beating introduces blurring artifacts in images. As a result, the quality of CT and MR images is deteriorated. The effects of such blurring artifacts can be minimized through efficient image fusion techniques. By employing fusion technique, we can enhance the image quality of the imaging system. In this scenario, the proposed fusion approach might save the critical time of a radiologist and/or therapist consumed in manual adjustment of the imaging system.

Blurring artifacts commonly occur in confocal microscopic images. The operator carefully adjusts the parameters of the microscope to capture high quality images of living tissues. These images are used for extraction of data at cellular resolution in the studies of biological systems. However, the use of such data acquisition technique becomes limited due to the introduction of diffractive blurring in images. As a result, image pixels corresponding to each object point is overlapped with neighboring pixels. To minimize this diffractive blurring problem, the frames of the confocal microscopy can be fused using an efficient fusion approach. This frames fusion step may lead to sharper image resulting in reduction of data errors. In this study, we have used various confocal microscopy and medical images.

Previously, researchers have proposed both pixel-level and feature-level image fusion approaches in spatial and transform domains. In pixel-level image fusion approaches, image pixels are moved from the source image to the fused image under the fusion rule. For pixel-level fusion in transform domain, different multi-resolution transforms have been employed such as Laplacian pyramid [3], ratio of low pass pyramid [4], gradient pyramid [5], and morphological pyramid [6]. Another interesting work for pixel-level image fusion was done by Nadu et al. in principal component analysis (PCA) and discrete wavelet transform (DWT) domains [7]. Pixel-level image fusion is also carried out using Baye's entropy and spatial frequency [8]. The problem with pixel-level transform based approaches is that they are not translation invariant. A slight movement in object position may cause degradation in fusion performance.

In feature-level image fusion, the source images are fused using features extracted from spatial or frequency domain. Feature-level image fusion in, wavelet transform domain, was proposed with simple max rule 
                     [9]. On the other hand, the decision-criteria based on fuzzy logic is proposed in [10]. Shutao et al. performed image fusion by fusing the source images using simple averaging to perform segmentation on the intermediate fused images. Corresponding segmented regions are then fused according to spatial frequency [11]. Long et al. performed image fusion based on clarity enhanced segmentation and regional sparse representation [12]. Further, Fuping et al. performed fusion using fractional differential and non-subsampled contourlet transform [13].

Recently, feature-level image fusion approaches are also proposed using machine learning (ML) algorithms for the classification of focused/defocused image regions [14–17]. Artificial neural network (ANN) and support vector machine (SVM) based fusion approaches are proposed using visibility, spatial frequency, and edge features [14,15]. Another efficient variant of ANN, probabilistic neural network (PNN), is developed for feature-level image fusion in [16]. The main problem with ML based fusion approaches is that we have to train ML algorithms for the accurate construction of a decision map. We have to prepare training data with known target labels related to the focused/defocused image blocks. For this purpose the target labels are, mostly, assigned manually. This is tedious and sometimes intractable. If this labeling process is not done precisely, then the fusion performance of ML approaches is degraded for the diverse types of blurred images [18]. Under this scenario, we have proposed a novel Ensemble-Individual-Features (Ens-IF) approach to exploit information of individual features. Ensemble features has achieved considerable importance due to its effective exploitation of individual feature spaces. In ensemble approach, generally, the shortcomings/limitations of one feature are replaced with the advantages of others [18–20].

In the proposed Ens-IF approach, diverse types of individual features are extracted from frequency and spatial domains. These informative features decide the more focused blocks of the source images. Next, the predicted labels of individual features are aggregated through majority voting to get the fused image. The quantitative and qualitative analysis reveals that our approach has produced more useful images than pixel-level approaches in PCA and wavelet domains. Further, our approach is more efficient than ML based feature-level image fusion approaches. The proposed Ens-IF approach does not need training time that is commonly required in ML based approaches. The main novelty of the proposed ensemble features approach is that it effectively utilizes the useful information of individual features to construct accurate decision maps for the fused images. The improved performance is evaluated for various confocal microscopy and CT blurred images.

The remaining paper is organized as follows: In Section 2, we describe the proposed approach in detail. In Section 3, we explain the performance measures. Experimental details are given in Section 4. Results are discussed in Section 5. Finally, concluding remarks are given in Section 6.


                     Fig. 1
                      shows the block diagram of the proposed Ens-IF approach for multi-focus image fusion. In the proposed approach, first, we extract useful features such as visibility, spatial frequency, energy of gradient, variance, edges, entropy, correlation, discrete cosine transform (DCT), and DWT coefficients. These individual features determine correctly the focused blocks for the multi-focus image fusion. In the second stage, the predicted labels of individual features are combined using majority voting.

For the fusion of multi-focus images, the input images I1 and I2 are decomposed into blocks of size M × N. Currently, for each block 
                        
                           
                              B
                              
                                 
                                    I
                                    1
                                 
                              
                              i
                           
                           
                           and
                           
                           
                           
                              B
                              
                                 
                                    I
                                    2
                                 
                              
                              i
                           
                        
                      of input I1 and I2 images, 11-dimension feature vectors are formed, i.e. 
                        
                           
                              V
                              
                                 
                                    I
                                    1
                                 
                              
                              i
                           
                           =
                           
                              {
                              
                                 
                                    v
                                    11
                                 
                                 ,
                                 
                                    v
                                    12
                                 
                                 ,
                                 
                                    v
                                    13
                                 
                                 ,
                                 …
                                 ,
                                 
                                    v
                                    111
                                 
                              
                              }
                           
                        
                      and 
                        
                           
                              V
                              
                                 
                                    I
                                    2
                                 
                              
                              i
                           
                           =
                           
                              {
                              
                                 
                                    v
                                    21
                                 
                                 ,
                                 
                                    v
                                    22
                                 
                                 ,
                                 
                                    v
                                    23
                                 
                                 ,
                                 …
                                 ,
                                 
                                    v
                                    211
                                 
                              
                              }
                           
                        
                     . The detail of features computation is given in Section 2.1. For each ith block, the decision of focused/defocused image block is made using the values of eleven individual features as following:

                        
                           (1)
                           
                              
                                 
                                    d
                                    j
                                    i
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                if
                                                
                                                
                                                   v
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                
                                                ≥
                                                
                                                
                                                
                                                
                                                   v
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                
                                                for
                                                
                                                j
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                
                                                …
                                                
                                                ,
                                                
                                                11
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The 11-dimension vector, 
                        
                           d
                           j
                           i
                        
                     , of binary values represent the focused/defocused categories of the image blocks. Then majority voting is used to obtain the combined decision. The block of the fused image is assigned to the class that receives the maximum votes. The ensemble decision value 
                        
                           
                              u
                              ^
                           
                           i
                        
                      is computed as:

                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          u
                                          ^
                                       
                                    
                                    i
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                for
                                                
                                                
                                                   f
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                   i
                                                
                                                
                                                at
                                                
                                                l
                                                =
                                                1
                                             
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                for
                                                
                                                
                                                   f
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                   i
                                                
                                                
                                                at
                                                
                                                
                                                
                                                l
                                                =
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The value of maximum votes (
                        
                           f
                           
                              m
                              a
                              x
                           
                           i
                        
                     ) is computed as:

                        
                           (3)
                           
                              
                                 
                                    f
                                    
                                       m
                                       a
                                       x
                                    
                                    i
                                 
                                 =
                                 max
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    11
                                 
                                 
                                    δ
                                    (
                                    
                                       d
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    ,
                                    
                                    l
                                    )
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 for
                                 
                                 
                                 
                                 l
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                              
                           
                        
                     where, 
                        
                           δ
                           
                              (
                              
                                 d
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ,
                              l
                              )
                           
                           =
                           
                              {
                              
                                 
                                    
                                       1
                                    
                                    
                                       
                                          if
                                          
                                          
                                             d
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          =
                                          l
                                       
                                    
                                 
                                 
                                    
                                       0
                                    
                                    
                                       otherwise
                                    
                                 
                              
                           
                        
                     .

The ith block of the fused image 
                        
                           f
                           i
                        
                      is selected from the images I1/I2 corresponding to ensemble decision value 
                        
                           
                              u
                              ^
                           
                           i
                        
                     , i.e. 
                        
                           
                              f
                              i
                           
                           =
                           
                              {
                              
                                 
                                    
                                       
                                          B
                                          
                                             
                                                I
                                                1
                                             
                                          
                                          i
                                       
                                    
                                    
                                       
                                          if
                                          
                                          
                                             
                                                
                                                   u
                                                   ^
                                                
                                             
                                             i
                                          
                                          
                                          
                                          =
                                          1
                                       
                                    
                                 
                                 
                                    
                                 
                                 
                                    
                                       
                                          B
                                          
                                             
                                                I
                                                2
                                             
                                          
                                          i
                                       
                                    
                                    
                                       
                                          if
                                          
                                          
                                             
                                                
                                                   u
                                                   ^
                                                
                                             
                                             i
                                          
                                          
                                          
                                          =
                                          
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                  

This process is repeated for all blocks of the image I1/I2 to construct the decision map, which is then used to develop the fused image F.

In the Ens-IF approach, diverse type of features information is used to determine the blurring effect in the source images. We have used frequency, gradient, and contrast based functions to measure the image focus. In the literature, the features based on these functions are commonly used to compute the blurring effects [7,21,22]. The higher values of these focuses measures represent the more focused image. On the other hand, for a defocused image, the lower values of high-frequency, gradient, and contrast functions would occur [23]. As a result of lower values, the sharp edges become faint and the blurring occur in small bright objects in the image [23]. Both the frequency and spatial domain features are extracted to discriminate the focused/defocused image blocks.


                        Fig. 2
                         shows a set of eleven features including four spatial domain features of visibility, edge, spatial-frequency (SF), and energy-of-gradient (EOG). Four frequency domain features include three DWT features and one DCT feature. The feature vector is made more discriminative by extracting texture features of entropy, standard deviation (STD), and variance (Var).

Spatial features of visibility [22], spatial frequency (SF) [24], edge [25], and energy-of-gradient (EOG) [26] are employed to measure the focus in the image. Visibility (Vis) measure is derived from the human visual system. It calculates the intensity variation in the block pixels using the average block intensity value. On the other hand, SF measure computes the activity-level in the image by calculating the variation in frequency among the rows and columns of image blocks. As a result, the higher SF value indicates the more focused image block. Similarly, the higher value of EOG shows the more focused image. The image focus is also measured by computing the edge information. The focus image contains more edges information as compared to the defocus-image. We have used Canny Edge Detection algorithm for the detection of edges in the image blocks [25]. This algorithm works in five main steps of (a) image smoothing; (b) finding the image gradient; (c) calculating local maxima as edges; (d) finding double thresholding; and (e) detecting the weak connected edges. These four spatial features are computed as:

                              
                                 (4)
                                 
                                    
                                       V
                                       i
                                       s
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          M
                                       
                                       
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                             |
                                             
                                                
                                                   B
                                                   
                                                      (
                                                      m
                                                      ,
                                                      n
                                                      )
                                                   
                                                   −
                                                   
                                                      μ
                                                      B
                                                   
                                                
                                                
                                                   μ
                                                   B
                                                   
                                                      α
                                                      +
                                                      1
                                                   
                                                
                                             
                                             |
                                          
                                       
                                    
                                 
                              
                           where μβ
                            is average intensity value of image block and αis a constant.

                              
                                 (5)
                                 
                                    
                                       S
                                       F
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         R
                                                         F
                                                      
                                                      )
                                                   
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   C
                                                   F
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           where, RF and CF are the row and column frequencies. The RF and CF are computed as:

                              
                                 (6)
                                 
                                    
                                       R
                                       F
                                       =
                                       
                                          
                                             
                                                1
                                                
                                                   M
                                                   N
                                                
                                             
                                             
                                                ∑
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                M
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      n
                                                      =
                                                      2
                                                   
                                                   N
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            B
                                                            (
                                                            m
                                                            ,
                                                            n
                                                            )
                                                            −
                                                            B
                                                            (
                                                            m
                                                            ,
                                                            n
                                                            −
                                                            1
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7)
                                 
                                    
                                       C
                                       F
                                       =
                                       
                                          
                                             
                                                1
                                                
                                                   M
                                                   N
                                                
                                             
                                             
                                                ∑
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                M
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      n
                                                      =
                                                      2
                                                   
                                                   N
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            B
                                                            (
                                                            m
                                                            ,
                                                            n
                                                            )
                                                            −
                                                            B
                                                            (
                                                            m
                                                            −
                                                            1
                                                            ,
                                                            n
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    
                                       E
                                       O
                                       G
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          M
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         B
                                                         i
                                                      
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      
                                                         B
                                                         j
                                                      
                                                   
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           where, 
                              
                                 
                                    B
                                    i
                                 
                                 =
                                 B
                                 
                                    (
                                    
                                       i
                                       +
                                       1
                                       ,
                                       j
                                    
                                    )
                                 
                                 −
                                 B
                                 
                                    (
                                    
                                       i
                                       ,
                                       j
                                    
                                    )
                                 
                              
                            and 
                              
                                 
                                    B
                                    j
                                 
                                 =
                                 B
                                 
                                    (
                                    
                                       i
                                       ,
                                       j
                                       +
                                       1
                                    
                                    )
                                 
                                 −
                                 B
                                 
                                    (
                                    
                                       i
                                       ,
                                       j
                                    
                                    )
                                 
                              
                           
                        

Three texture domain features of entropy, STD, and variance (Var) are also employed to measure the blurring effect. The entropy feature shows the average information in the image and its higher value indicates the more focused image. However, Var and STD measure highlight the contrast in the image. An image with high contrast would represent the more focused image. The values of these texture features are computed as:

                              
                                 (9)
                                 
                                    
                                       E
                                       n
                                       t
                                       r
                                       o
                                       p
                                       y
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          L
                                       
                                       
                                          P
                                          
                                             (
                                             i
                                             )
                                          
                                          
                                             log
                                             2
                                          
                                          
                                             (
                                             P
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           where, L and P(i) represent the maximum possible gray levels and the probability of ith gray level.

                              
                                 (10)
                                 
                                    
                                       S
                                       T
                                       D
                                       =
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                L
                                             
                                             
                                                
                                                   
                                                      (
                                                      i
                                                      −
                                                      
                                                         i
                                                         ′
                                                      
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                h
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                          
                                       
                                       
                                    
                                 
                              
                           where, L represents the number of gray levels, 
                              
                                 
                                    i
                                    ′
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    L
                                 
                                 
                                    i
                                    
                                    
                                       h
                                       F
                                    
                                 
                              
                            and hF
                            is the normalized histogram image block.

                              
                                 (11)
                                 
                                    
                                       V
                                       a
                                       r
                                       =
                                       
                                          1
                                          
                                             M
                                             N
                                          
                                       
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          M
                                       
                                       
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      B
                                                      
                                                         (
                                                         m
                                                         ,
                                                         n
                                                         )
                                                      
                                                      −
                                                      
                                                         μ
                                                         B
                                                      
                                                   
                                                   )
                                                
                                             
                                             2
                                          
                                       
                                       
                                    
                                 
                              
                           where, μβ
                            denotes the mean value of the image block.

Frequency features in DWT and DCT domain are used to measure the blur in the image blocks. DWT based focus measure is computed at coefficient level or window level. The coefficient based activity-level is measured by considering each coefficient separately [7]. However, window based activity-level is measured by averaging DWT coefficients of the image block [21]. By decomposition of image blocks to first level, we obtained three detail subbands and one approximation subband. The approximation subband does not provide useful edge information. Hence, the approximation subband is not included in the feature set. Only three detail subbands HH, HL, and LH are used for features measure. The wavelet activity-level (feature) is measured using “biorthogonal” function and then averaging the coefficients over the image block. On the other hand, DCT coefficients show the variation in image frequency and its high-frequency energy indicates the focus in the image block. The value of DCT energy (E) is computed by removing the value of the direct-components as follows:

                              
                                 (12)
                                 
                                    
                                       E
                                       =
                                       
                                          [
                                          
                                             
                                                ∑
                                                
                                                   u
                                                   =
                                                   0
                                                
                                                
                                                   M
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      v
                                                      =
                                                      0
                                                   
                                                   
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   B
                                                   2
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                             
                                          
                                          ]
                                       
                                       −
                                       
                                          B
                                          2
                                       
                                       
                                          (
                                          0
                                          ,
                                          0
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    
                                       where
                                       ,
                                       
                                       
                                       B
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       =
                                       
                                          2
                                          M
                                       
                                       c
                                       
                                          (
                                          u
                                          )
                                       
                                       c
                                       
                                          (
                                          v
                                          )
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             M
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                0
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          
                                             B
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             cos
                                             
                                                
                                                   (
                                                   2
                                                   i
                                                   +
                                                   1
                                                   )
                                                   π
                                                   u
                                                
                                                
                                                   2
                                                   M
                                                
                                             
                                          
                                       
                                       cos
                                       
                                          
                                             (
                                             2
                                             j
                                             +
                                             1
                                             )
                                             π
                                             v
                                          
                                          
                                             2
                                             N
                                          
                                       
                                    
                                 
                              
                           c(0) = 
                              
                                 1
                                 /
                                 
                                    2
                                 
                              
                           , c(u) = 1, and u, v = 0,1, …,M-1.

The performance of the proposed approach is evaluated in terms of SF, STD, Quality of edge (QE), and mutual information (MI). The higher value of SF and STD indicates the detail image with better focus. The computation of SF and STD measures are given in Sections 2.1.1 and 2.1.2, respectively. QE measure is computed using human perception information extracted from the source and fused images. The value of QE measure is computed as:

                        
                           (14)
                           
                              
                                 Q
                                 E
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             M
                                          
                                          
                                             
                                                α
                                                x
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             
                                                γ
                                                x
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             +
                                             
                                                α
                                                y
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             
                                                γ
                                                y
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             M
                                          
                                          
                                             
                                                γ
                                                x
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             +
                                             
                                                γ
                                                y
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The edge preservation values, αx
                     (i, j)  and  αy
                     (i, j), from the input images to the fused image are formed by multiplying the sigmoid mapping function of relative strength and orientation factors. In general γx
                     (i, j)  and  γy
                     (i, j) are functions of edge strength.

MI measure indicates similarity between the fused image and the original image. Its numerical value is computed as:

                        
                           (15)
                           
                              
                                 M
                                 I
                                 =
                                 
                                    ∑
                                    
                                       
                                          l
                                          1
                                       
                                       =
                                       1
                                    
                                    L
                                 
                                 
                                    
                                       ∑
                                       
                                          
                                             l
                                             2
                                          
                                          =
                                          1
                                       
                                       L
                                    
                                    
                                       h
                                       
                                          O
                                          ,
                                          F
                                       
                                    
                                 
                                 
                                    (
                                    
                                       l
                                       1
                                    
                                    ,
                                    
                                       l
                                       2
                                    
                                    )
                                 
                                 
                                    log
                                    2
                                 
                                 
                                    
                                       
                                          h
                                          
                                             O
                                             ,
                                             F
                                          
                                       
                                       
                                          (
                                          
                                             l
                                             1
                                          
                                          ,
                                          
                                             l
                                             2
                                          
                                          )
                                       
                                    
                                    
                                       
                                          h
                                          O
                                       
                                       
                                          (
                                          
                                             l
                                             1
                                          
                                          )
                                       
                                       
                                          h
                                          F
                                       
                                       
                                          (
                                          
                                             l
                                             2
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     where, hO,hF
                     , and h
                     
                        O, F
                     represent the original, fused, and joint image histograms, respectively. L indicates the number of intensity-levels in the original and the fused images.

Extensive experiments are performed to evaluate and compare the performance of the proposed approach. For this purpose, several real blurred images of Flowers, Calendar, Tree, and Lab are retrieved from www.imagefusion.org. The blurred confocal microscopic images and medical CT images of Abdomen, Brain, and Chest are acquired from the National institute of Laser and Optics Labs (NILOP), Islamabad, Pakistan. These blurred images are selected carefully to provide complementary information useful for the fusion.

Since the multi-focus images contain non-uniform magnitude of focused pixels, thus in block based fusion approaches, the quality of fused images may be affected if large block size is used. Large block may contain both the focused and defocused pixels. Therefore, in order to compute the discriminant feature information, small block size is preferably used in multi-focus image fusion. Further, large block size may retain the blurring artifacts in the final fused image. Hence, in order to minimize the blurring artifacts within the block and at the adjacent-boundary of the focus and defocussed blocks, we have selected minimum block size of 3×3. This is the most suitable block size for better quality fused images. During experimentation, we observed with the increase of block size, the blurring artifacts appear at the boundary of the blocks, resulting in the degradation of fused image quality. The computational work of the proposed approach is carried out in Matlab-R11 environment. For 3×3 block size, to compute DWT and DCT coefficients, this software has employed “pad” function to make block size of the power of two.

For the comparison, the implementation of pixel-level and feature-level fusion approaches are carried out. The detailed implementation of these approaches is available in [7,11,12,14,21]. We have obtained results using the same procedure and parameters setting as described in these approaches. The pixel-level Image fusion, in wavelet domain, is carried out using discrete stationary wavelet transform with “symlet” function of second order [7]. The source images are decomposed to first-level. The pixel-level image fusion, in PCA domain [7], is developed by arranging the blurred-images X and Y in two column vectors. Then eigenvector and eigenvalues of the covariance matrix are calculated. The values of normalized components 
                        
                           (
                           
                              P
                              1
                           
                           =
                           0.55
                           ,
                           
                           
                              P
                              2
                           
                           =
                           0.45
                           )
                        
                      are calculated. The fused image F(i,j) is obtained using the blurred-images X(i,j) and Y(i,j) as:

                        
                           (16)
                           
                              
                                 F
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 =
                                 
                                    P
                                    1
                                 
                                 X
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 +
                                 
                                    P
                                    2
                                 
                                 Y
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                              
                           
                        
                     
                  

ML based feature-level fusion approaches are implemented using PNN [14] and SVM [21] algorithms. SVM fusion approach has obtained the optimal values of model parameter at 
                        
                           c
                           =
                           70
                        
                     . The width of Gaussian function with radial-basis-kernel is found to be 
                        
                           σ
                           =
                           0.50
                        
                     . However, PNN approach is developed using optimal spread parameter at 
                        
                           σ
                           =
                           0.9
                           .
                        
                     
                  

@&#RESULTS AND DISCUSSION@&#


                     Table 1
                      shows the performance comparison of proposed ensemble Ens-IF approach with previous pixel-level and feature-level fusion approaches developed using PCA, wavelet, ANN, and SVM. It is observed from the table that our approach gives STD values of 62.60, 62.49, 36.49, and 40.03 for Flowers, Calendar, Plant, and Tree images, respectively. These values are higher than PCA and wavelet based fusion approaches. These values are also better than feature-level image fusion approaches developed using PNN and SVM algorithms. Similarly, it is observed that our approach provides higher MI values of 6.73, 7.49, and 5.35 for Flowers, Calendar, and Plant images, respectively. This is because the proposed approach has effectively combined complementary information contained in the blurred images to provide more informative images. The higher SF values indicates that the images fused using the proposed approach has selected more focused image blocks. Similarly, in terms of QE measure, our approach provides higher values of 0.5936, 0.5936, 0.6499, and 0.5974 for Flower, Calendar, Plant, and Tree images, respectively.


                     Table 1 also shows performance comparison of our approach with regional segmentation and sparse representational based fusion approaches [11,12]. For Lab image, it is observed that approaches in [11,12] have given QE values of 0.7466, and 0.7680, respectively. However, our approach has provided higher value of 0.8144. The higher value of QE highlights that our approach select the image blocks of sharper edges. The overall results in this table highlight that our approach has provided an improved values among pixel-level and feature-level approaches in terms of STD, MI, SF, and QE measures.


                     Table 2
                      shows the performance of proposed Ens-IF for the confocal microscopy blurred-images of Red-blood-cell and Pollen-grain in terms of various quality measures. We observed that the proposed approach has performed better than PCA and wavelet based approaches. In this case, the captured confocal microscopy frames are blurred due to diffraction. The resultant frames fused though our approach is more focused and visible for the human visual perception.


                     Table 3
                      shows the performance of our approach, for various CT images, in terms of correlation, root mean square error (RMSE), and peak signal to noise ratio (PSNR). It is observed that proposed approach has lower RMSE values of 0.02, 0.01, and 0.05 for the Abdomen-CT, Brain-CT, and Chest-CT images, respectively. Similarly, our approach performs better over wavelet, PCA, PNN and SVM based approaches in terms of correlation and PSNR.


                     Fig. 3
                      indicates the temporal comparsion of our approach with SVM and PNN approaches. This figure reveals that our approach is more efficient than SVM and PNN approaches in terms of execution time. This is because our Ens-IF approach does not need training as ML fusion approaches.

In this section, we demonstrated the visual comparison of our approach for the real-blurred, confocal microscopy, and CT-blurred images.


                        Figs. 4–7
                         demonstrate the visual performance for real blurred images of Flowers, Calendar, Tree, and Lab. Fig. 4 shows that our approach has fused the better quality image than wavelet approach. Figs. 5
                         and 6
                         highlight visual comparison for Calander and Tree blurred images, respectively. These figures indicate that Calendar and Tree images fused using our approach are more focused than PNN and PCA based approaches. Similarly, Fig. 7
                         shows the improved Lab image generated by the proposed approach. We inferred that useful information in the real-world blurred images can be fused more effectively through the proposed Ens-IF approach.

Further, visual quality of the proposed approach is assessed for the blurred images of confocal microscopy. Figs. 8
                         and 9
                         show the blurred edges and texture information missing in some areas of original microscopic images of red-blood-cell and pollen-grain. From these figures, we observe that our approach has produced the improved fused images. This reveals that the useful complementary information in the blurred microscopic images can be combined effectively through the proposed Ens-IF. These informative images can be used for different purposes in the field of microbiology.

Further, the efficacy of the proposed Ens-IF approach is assessed for blurred CT images. Figs. 10–12
                         demonstrate the visual quality of the blurred CT images of Abdomen, Brain, and Chest, respectively. Due to blurring artifacts, the detail information is missing in CT images shown in Figs. 10 and 11
                        . In these figures, for Abdomen and Brain images, the blurring effect can be visualized easily. Further, in Fig. 12
                        , the blurring effect is present in the upper-left and lower-right of the Brain CT images. However, our approach has fused successfully to restore the information missing in blurred CT images. Therefore, our approach has improved the visual quality by minimizing the induced blur in CT images of Abdomen, Brain, and Chest.

We summarized that our approach has restored the sharp lines and edges information in the real-blurred, confocal microscopic and blurred CT images. This approach can be employed to minimize the blurring artifacts in the confocal microscopic and medical imaging systems.

@&#CONCLUSION@&#

In this work, we have observed the improved fusion performance of the proposed Ens-IF approach for the real blurred, confocal microscopy, and CT-blurred images. The proposed approach has effectively used the individual features to construct the decision map. In this approach, diverse types of features selected from frequency and spatial domains play vital role in the fusion process. The individual features have provided discriminative information to select more focused image blocks. The quantitative and qualitative results highlight the improved performance of our fusion approach in comparison to pixel-level and feature-level approaches. Our novel Ens-IF approach has minimized blurring artifacts from the blurred CT-images of Abdomen, Brain, and Chest. This approach is more efficient than SVM and PNN based feature-level approaches.

The proposed approach can be employed as a post-processor in the medical imaging systems to reduce the blurring artifacts. It can also be used in confocal microscopy system to minimize the diffraction artifacts.

@&#ACKNOWLEDGMENTS@&#

This research work is financially supported by the Higher Education Commission of Pakistan under the indigenous PhD scholarship no. 17-5-4(Ps4-101) HEC/Ind-Sch-2007/. We are thankful to National institute of Laser and Optics Labs (NILOP), Islamabad, providing microscopic blurred images.

@&#REFERENCES@&#

