@&#MAIN-TITLE@&#Extending CSG with projections: Towards formally certified geometric modeling

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Extension of classical CSG with the projection operator.


                        
                        
                           
                           Support for gradient computations.


                        
                        
                           
                           Topological property computation.


                        
                        
                           
                           Application of formal methods like interval analysis and proof assistants to CSG models.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Constructive solid geometry

Projection

Homotopy equivalence

Formal methods

Constraint solving

Disjunctive normal form

@&#ABSTRACT@&#


               
               
                  We extend traditional Constructive Solid Geometry (CSG) trees to support the projection operator. Existing algorithms in the literature prove various topological properties of CSG sets. Our extension readily allows these algorithms to work on a greater variety of sets, in particular parametric sets, which are extensively used in CAD/CAM systems. Constructive Solid Geometry allows for algebraic representation which makes it easy for certification tools to apply. A geometric primitive may be defined in terms of a characteristic function, which can be seen as the zero-set of a corresponding system along with inequality constraints. To handle projections, we exploit the Disjunctive Normal Form, since projection distributes over union. To handle intersections, we transform them into disjoint unions. Each point in the projected space is mapped to a contributing primitive in the original space. This way we are able to perform gradient computations on the boundary of the projected set through equivalent gradient computations in the original space. By traversing the final expression tree, we are able to automatically generate a set of equations and inequalities that express either the geometric solid or the conditions to be tested for computing various topological properties, such as homotopy equivalence. We conclude by presenting our prototype implementation and several examples.
               
            

@&#INTRODUCTION@&#

Constructive Solid Geometry was one of the first representation schemes in Computer Aided Design and Manufacturing (CAD/CAM)  [1–3]. However, dealing with complex scenes efficiently can be costly, since a rigorous mathematical description is obtained. As a result, other representations have been preferred such as Boundary Representations (Brep) or Selective Geometric Complex (SGC)  [4,5]. Modelers using the latter representations are hybrid and procedural, solids are no longer represented by systems of equations and inequalities. This lack of algebraic representation makes geometric models (and modeling software) hard to certify.

On the other hand, CSG modeling is quite prevalent in the video game industry and computer graphics, with traditional game engines like Quake or Unreal  [6] making extensive use of it through binary space partitioning (BSP)  [7]. The latter engine has been used by hundreds of commercial titles  [8]. Moreover, it is the preferred method of some open-source and web-based modelers and there is recent work for speeding up CSG rendering through late polygonization  [9].

In CSG, solids are represented as Boolean constructions via regularized
                        1
                     
                     
                        1
                        A regularized set is equal to the closure of its interior.
                      set operators (union, intersection, difference). CSG representations are essentially binary expression trees where non-terminal nodes represent operators and terminal nodes typically represent primitive solids (like spheres, cones, cuboids). By traversing the expression tree, one may derive an algebraic representation of the solid, in the form of a system of equations and inequalities. The set of Boolean operations is quite restrictive for practical use.

In this paper we extend the descriptive power of classical CSG by introducing the projection operator. This immediately allows us to deal with a greater variety of objects, i.e., objects defined as projections of other objects or parametric objects, including those defined by extrusions and sweeps. We do so by describing the projected objects as classical CSG expressions in the projected (lower-dimension) space. We show that our method can be used to extend existing algorithms in the literature that compute various properties of CSG sets like connectivity and topology  [10,11]. Moreover, since (extended) CSG derives an algebraic representation of the geometric models, it provides an elegant way for certification tools to apply.

In hardware design, formal verification is a significant part of the design process [12]. The infamous Pentium bug and more recently, the TSX Haswell bug are only a few cases of misdesigns. We naturally raise the question: What about misdesigns in CAD?

Current certification methods which are relevant to our applications include computer algebra methods, model checkers or proof assistants like PVS  [13] or Coq  [14] (Coq was recently used to check the proof of the four color theorem and the proof of the Feit–Thompson theorem for the classification of simple groups) and last but not least, interval analysis. The latter has been used to prove the Kepler conjecture by Hales  [15]. Under a more algebraic–geometric context, in CSG modeling, it suffices to prove the correctness of an underlying interval solver, instead of proving all the procedures currently used in today’s procedural modeling. See  [16] for an example where interval analysis is being used, relying on the properties of the tensorial Bernstein basis, to certify critical software that prevents collisions in air traffic.

Other methods for certified computing are exact algebraic algorithms which can typically be combined with interval arithmetic for efficiency. See  [17] for an application regarding exact boundary computation on low degree sculptured solids and  [18] for accurate Brep generation from a CSG expression. Exact algebraic algorithms have also become popular in the Computational Geometry area  [19]. All these efforts aim to redefine modern computing, through efficient algebraic algorithms allowing us to step further from the inexact floating-point arithmetic of the 1980s. We believe our work is a small step in this direction, in particular towards formally certified geometric modeling.

Almost no literature exists regarding projections in CSG. There is some previous work  [20] where it is mentioned that projections are non-trivial to handle and the author deals only with the projection of unions, since projections propagate over unions. In this paper we show how to deal with intersections, by transforming intersections into disjoint unions.

A geometric primitive in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                      is represented as a manifold 
                        f
                      in 
                        
                           (
                           d
                           +
                           1
                           )
                        
                     -space 
                        
                           (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 d
                              
                           
                           ,
                           s
                           )
                        
                      where 
                        s
                      is the characteristic variable of the manifold. This way, the geometric primitive consists of interior points where the 
                        s
                     -coordinate is negative and of exterior points where the 
                        s
                     -coordinate is positive. The case 
                        s
                        =
                        0
                      corresponds (in general) to the boundary of the object. Thus the geometric primitive is essentially a solid in 
                        d
                      dimensions. Through relation 
                        f
                        
                           (
                           
                              x
                           
                           ;
                           s
                           )
                        
                        =
                        0
                        ,
                        
                           x
                        
                        ∈
                        
                           
                              R
                           
                           
                              d
                           
                        
                        ,
                        s
                      is implicitly defined by a characteristic function. For example, manifold 
                        
                           
                              f
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 s
                                 )
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              −
                              1
                              −
                              s
                              =
                              0
                           
                        
                      describes the unit disk as a paraboloid in 3-space. For every point 
                        
                           (
                           
                              
                                 x
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 ˆ
                              
                           
                           )
                        
                      inside the unit disk, there exists 
                        
                           
                              s
                           
                           
                              ˆ
                           
                        
                        ≤
                        0
                      such that 
                        f
                        
                           (
                           
                              
                                 x
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 ˆ
                              
                           
                           )
                        
                        =
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              2
                           
                        
                        +
                        
                           
                              
                                 
                                    y
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              2
                           
                        
                        −
                        1
                        −
                        
                           
                              s
                           
                           
                              ˆ
                           
                        
                        =
                        0
                     . See Fig. 1
                     , for a contour graph with respect to 
                        s
                     . Due to the regularized set condition, we consider inequalities 
                        s
                        ≤
                        0
                      or 
                        s
                        ≥
                        0
                      instead of their strict counterparts. This modeling via the characteristic variable is in accordance with the classical representation as a finite Boolean combination of semi-algebraic or semi-analytic sets of the form 
                        
                        F
                        
                           (
                           
                              x
                           
                           )
                        
                        ≤
                        0
                     , where 
                        F
                        :
                        
                           
                              R
                           
                           
                              d
                           
                        
                        →
                        R
                     . However in our approach, the use of characteristic variables proves more convenient.

We consider each node of the expression tree separately in order to compute a contributing primitive for each point in the set. That is in the case of projections, every point is associated with a point in the higher dimension space. The tree is traversed and a set of simple subsystems with inequality constraints is generated. We denote this set as 
                        F
                        
                           (
                           
                              x
                           
                           ;
                           s
                           )
                        
                     , where 
                        s
                      is the characteristic variable. Individual equations are still denoted as 
                        f
                        
                           (
                           
                              x
                           
                           ;
                           s
                           )
                        
                     .

A geometric set is described in Disjunctive Normal Form (DNF) as a union of intersections of primitives (Section  2). Having the union operator at the top level has the advantage that projections distribute over unions (Section  3). Such canonical forms are also considered in other algorithms dealing with CSG representations [21].

The paper is organized as follows. Section  2 presents the computation of the DNF for CSG operators. Section  3 deals with projections and parametric objects showing how to obtain a classical CSG expression in the lower-dimension space. Section  4 deals with gradient computations in the projected space, that allow us to compute topological properties. Section  5 presents several applications of our approach. Our reference implementation is presented in Section  6 and finally, in Section  7 we conclude with discussion and future extensions.

A CSG formula can be converted to DNF by applying De Morgan’s laws and by distributing 
                           ∩
                         over 
                           ∪
                         as follows. Let 
                           A
                           ,
                           B
                         be geometric primitives. Let 
                           P
                           ,
                           
                              
                                 Q
                              
                              
                                 i
                              
                           
                         be geometric sets defined by an expression tree. 
                           
                              1.
                              
                                 
                                    A
                                  and 
                                    ¬
                                    A
                                  are in DNF.


                                 
                                    A
                                    ∪
                                    B
                                  and 
                                    A
                                    ∩
                                    B
                                  are in DNF.


                                 
                                    ¬
                                    
                                       (
                                       
                                          
                                             Q
                                          
                                          
                                             1
                                          
                                       
                                       ∪
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    ¬
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    ∩
                                    ¬
                                    
                                       
                                          Q
                                       
                                       
                                          2
                                       
                                    
                                 
                              


                                 
                                    ¬
                                    
                                       (
                                       
                                          
                                             Q
                                          
                                          
                                             1
                                          
                                       
                                       ∩
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    ¬
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    ∪
                                    ¬
                                    
                                       
                                          Q
                                       
                                       
                                          2
                                       
                                    
                                 
                              


                                 
                                    P
                                    ∩
                                    
                                       (
                                       
                                          
                                             Q
                                          
                                          
                                             1
                                          
                                       
                                       ∪
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                          
                                       
                                       ∪
                                       ⋯
                                       ∪
                                       
                                          
                                             Q
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       P
                                       ∩
                                       
                                          
                                             Q
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    ∪
                                    
                                       (
                                       P
                                       ∩
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ∪
                                    ⋯
                                    ∪
                                    
                                       (
                                       P
                                       ∩
                                       
                                          
                                             Q
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                 .


                                 
                                    
                                       (
                                       
                                          
                                             Q
                                          
                                          
                                             1
                                          
                                       
                                       ∩
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ∩
                                    
                                       
                                          Q
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    ∩
                                    
                                       
                                          Q
                                       
                                       
                                          2
                                       
                                    
                                    ∩
                                    
                                       
                                          Q
                                       
                                       
                                          3
                                       
                                    
                                 
                              


                                 
                                    
                                       (
                                       
                                          
                                             Q
                                          
                                          
                                             1
                                          
                                       
                                       ∪
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ∪
                                    
                                       
                                          Q
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          Q
                                       
                                       
                                          2
                                       
                                    
                                    ∪
                                    
                                       
                                          Q
                                       
                                       
                                          3
                                       
                                    
                                 .

The simplest operation is the complement. If for primitive 
                           A
                        : 
                           f
                           
                              (
                              
                                 x
                              
                              ;
                              s
                              )
                           
                           =
                           0
                         then 
                           ¬
                           A
                           :
                           f
                           
                              (
                              
                                 x
                              
                              ;
                              −
                              s
                              )
                           
                           =
                           0
                        .


                        
                           Remark 1
                           It is important that the complement is still represented by points from the manifold.

Recall that we require the characteristic variable to be defined for all points in 
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        . As a counter-example, consider 
                           f
                           
                              (
                              x
                              ,
                              y
                              ,
                              s
                              )
                           
                           =
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           −
                           1
                           +
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                           =
                           0
                        . Points outside the unit disk, like 
                           
                              (
                              2
                              ,
                              2
                              )
                           
                         are not represented at all, since 
                           f
                           
                              (
                              2
                              ,
                              2
                              ,
                              s
                              )
                           
                           =
                           0
                         cannot be satisfied for 
                           s
                           ∈
                           R
                        .

Let 
                           P
                           =
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           ∩
                           ⋯
                           ∩
                           
                              
                                 A
                              
                              
                                 n
                              
                           
                         be an intersection of primitives. We have to impose the constraint that point 
                           
                              x
                           
                         belongs to all 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ,
                           i
                           =
                           1
                           …
                           n
                         
                        at the same time. This is achieved by setting the characteristic variable 
                           s
                         of the set to be 
                           s
                           =
                           max
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    s
                                 
                                 
                                    n
                                 
                              
                              )
                           
                         (cf.  Fig. 2
                        ). In order to represent 
                           max
                        , we consider the union of all possible cases for 
                           max
                        , i.e., 
                           s
                           =
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                         and 
                           ∀
                           j
                           :
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           ≥
                           
                              
                                 s
                              
                              
                                 j
                              
                           
                         or 
                           s
                           =
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                         and 
                           ∀
                           j
                           :
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                           ≥
                           
                              
                                 s
                              
                              
                                 j
                              
                           
                        , and so on. 
                           Definition 1
                           Let 
                                 A
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                               be geometric sets and 
                                 
                                    
                                       s
                                    
                                    
                                       A
                                    
                                 
                               and 
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               their characteristic variables at point 
                                 
                                    x
                                 
                              . We say that 
                                 A
                               
                              dominates 
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       n
                                    
                                 
                               and denote 
                                 A
                                 |
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       n
                                    
                                 
                               for all 
                                 
                                    x
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                               where 
                                 0
                                 ≥
                                 
                                    
                                       s
                                    
                                    
                                       A
                                    
                                 
                                 ≥
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              . In this case 
                                 A
                               is a dominant set over each 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              .

The notion of dominant set allows us to express intersections as unions. Note that operator 
                           |
                         has lower precedence than the comma in the above notation. Consequences of the above definition are the following properties: 
                           
                              (i)
                              
                                 
                                    A
                                    ∩
                                    B
                                    =
                                    A
                                    |
                                    B
                                    ∪
                                    B
                                    |
                                    A
                                  (see Figs. 2 and 3
                                 )


                                 
                                    
                                       (
                                       A
                                       |
                                       B
                                       )
                                    
                                    |
                                    C
                                    =
                                    A
                                    |
                                    B
                                    ,
                                    C
                                    =
                                    A
                                    |
                                    C
                                    ,
                                    B
                                 
                              


                                 
                                    A
                                    |
                                    
                                       (
                                       B
                                       |
                                       C
                                       )
                                    
                                    ∪
                                    A
                                    |
                                    
                                       (
                                       C
                                       |
                                       B
                                       )
                                    
                                    =
                                    A
                                    |
                                    B
                                    ,
                                    C
                                 
                              


                                 
                                    A
                                    ∩
                                    B
                                    ∩
                                    C
                                    =
                                    
                                       (
                                       A
                                       |
                                       B
                                       ,
                                       C
                                       )
                                    
                                    ∪
                                    
                                       (
                                       B
                                       |
                                       C
                                       ,
                                       A
                                       )
                                    
                                    ∪
                                    
                                       (
                                       C
                                       |
                                       A
                                       ,
                                       B
                                       )
                                    
                                 
                              


                                 
                                    ¬
                                    
                                       (
                                       A
                                       |
                                       B
                                       )
                                    
                                    =
                                    ¬
                                    A
                                    ∪
                                    ¬
                                    B
                                    ∪
                                    B
                                    |
                                    A
                                 .

Let 
                           P
                           =
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           ∪
                           ⋯
                           ∪
                           
                              
                                 A
                              
                              
                                 n
                              
                           
                         be a union of primitives. Since the formula is in DNF form, it suffices to consider each primitive separately, that is 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           :
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 x
                              
                              ;
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ,
                           i
                           =
                           1
                           …
                           n
                        . Note that a point 
                           
                              x
                           
                         may not be uniquely associated with a primitive, since it may belong to the intersection of many primitives, i.e., the unions may not be disjoint. In our context (for topological property computation) this does not cause any problems. In the case where one requires disjoint unions, we can impose the uniqueness constraint by satisfying 
                           ∀
                           j
                           :
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                           ≤
                           
                              
                                 s
                              
                              
                                 j
                              
                           
                        , where 
                           
                              
                                 s
                              
                              
                                 j
                              
                           
                         refers to the characteristic variable of each object in the considered union. We choose the characteristic variable of the set to be 
                           min
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    s
                                 
                                 
                                    n
                                 
                              
                              )
                           
                         and this way we obtain similar properties as those in the case of intersections.

The first non-trivial operation which concerns sets that cannot be described with CSG primitives is projection. Let 
                        A
                        :
                        F
                        
                           (
                           
                              x
                           
                           ;
                           s
                           )
                        
                      where 
                        
                           x
                        
                        =
                        
                           (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 d
                              
                           
                           )
                        
                     , then the projection of 
                        A
                      with respect to 
                        
                           
                              x
                           
                           
                              i
                           
                        
                      is denoted as 
                        
                           
                              π
                           
                           
                              i
                           
                        
                        
                           (
                           A
                           )
                        
                     . Let 
                        
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                              
                              .
                           
                        
                      Then 
                        
                           
                              π
                           
                           
                              i
                           
                        
                        
                           (
                           A
                           )
                        
                        =
                        
                           
                              F
                           
                           
                              π
                           
                        
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                           ;
                           s
                           )
                        
                     . Projections with respect to more than one dimension are denoted with commas, e.g. 
                        
                           
                              
                                 
                                    π
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              
                                 (
                                 A
                                 )
                              
                              =
                              
                                 
                                    F
                                 
                                 
                                    π
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       
                                          i
                                       
                                       ,
                                       
                                          j
                                       
                                    
                                 
                                 ;
                                 s
                                 )
                              
                              =
                              
                                 
                                    π
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    A
                                    )
                                 
                                 )
                              
                              .
                           
                        
                      When the particular dimension is not of importance we may simply write 
                        
                           
                              π
                           
                           
                              2
                           
                        
                        
                           (
                           A
                           )
                        
                        =
                        π
                        
                           (
                           π
                           
                              (
                              A
                              )
                           
                           )
                        
                     . An interesting property of the projection is that it distributes over 
                        ∪
                     : 
                        
                           
                              π
                              
                                 (
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 ∪
                                 
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 ∪
                                 ⋯
                                 ∪
                                 
                                    
                                       Q
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              =
                              π
                              
                                 (
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ∪
                              π
                              
                                 (
                                 
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ∪
                              ⋯
                              ∪
                              π
                              
                                 (
                                 
                                    
                                       Q
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

A naive way to deal with projections is to just “forget” coordinate 
                        
                           
                              x
                           
                           
                              i
                           
                        
                     . Doing so however, may result in a k-dimensional 
                        
                           (
                           k
                           ≥
                           1
                           )
                        
                      set of values for 
                        
                           
                              x
                           
                           
                              i
                           
                        
                      and 
                        s
                     , such that 
                        F
                        
                           (
                           
                              x
                           
                           ;
                           s
                           )
                        
                      is satisfied. This may slow down an interval solver (used to find a cover of the set for example) since an infinite set of solutions will have to be covered. We remedy this problem by introducing extra constraints so as to limit the range of the characteristic variable to a 0-dimensional set of values for every projected point.

One way to consistently generate additional constraints is to choose the smallest value of the characteristic variable, among all possible values of coordinates 
                        
                           
                              x
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              k
                           
                        
                      (the coordinates being eliminated). That is 
                        
                           
                              π
                           
                           
                              1
                              ,
                              …
                              ,
                              k
                           
                        
                        
                           (
                           A
                           )
                        
                      is the set of points 
                        
                           
                              
                                 x
                              
                           
                           
                              
                                 1
                              
                              …
                              
                                 k
                              
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              d
                              −
                              k
                           
                        
                      such that 
                        ∃
                        
                        
                           
                              x
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              k
                           
                        
                      where 
                        
                           x
                        
                        ∈
                        
                           
                              R
                           
                           
                              d
                           
                        
                        ∩
                        A
                      and 
                        s
                      is minimal. This way we pick the point that lies “deepest” in the set to map to the projected set. Note that the use of the term “minimal” in the above is abusive. We are actually looking for a critical point (without loss of generality), i.e., the derivative of the characteristic function with respect to 
                        s
                      vanishes. Thus, we do not have to perform extra computations to ensure that a critical point is actually a minimum. This is because we are interested in reducing the solution set to a hopefully 0-dimensional variety. It is perfectly acceptable for a point in the interior of the (projected) set to have not necessarily the smallest value of the characteristic variable, but some other (critical) value.

Note that coordinates 
                        
                           
                              x
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              k
                           
                        
                      are no longer free variables, but take a value and become parameters. The minimization constraint can be written in terms of an optimization problem with constraints those exactly in 
                        F
                      and the objective function 
                        s
                     . Typical approach involves considering a Lagrangian (i.e., the Fritz John conditions). This is quite powerful a technique, but it has the disadvantage that it introduces extra equations and unknowns and our experiments have shown that after 6 or 7 unknowns solution times become impractical. Here we make use of differential calculus and wedge products. See  [24] for an introduction to wedge products and their applications in optimization problems. The wedge product vanishes if its operands are linearly dependent. Lagrange multipliers encapsulate linear dependence, therefore optimization problems may be efficiently transformed to calculus with wedge products.

The leaves of the DNF expression tree contain primitives (or complements of primitives) or dominant sets. Consequently, to distribute projections, we need to handle projections of primitives and projections of dominant sets. For the latter, we will define an auxiliary construction, called join set which we will show that it contributes to the projection.


                     
                        Theorem 1
                        Projection of Geometric Primitive


                        
                           Let 
                           
                              A
                              :
                              f
                              
                                 (
                                 
                                    x
                                 
                                 ;
                                 s
                                 )
                              
                            
                           be a geometric primitive. When projecting down 
                           
                              k
                            
                           dimensions (eliminating 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              …
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                            
                           ), the projection can be specified by the following additional constraints:
                           
                              
                                 
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    ⋯
                                    =
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    =
                                    0
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        
                           
                              0
                              =
                              d
                              s
                              ∧
                              d
                              f
                              =
                              d
                              s
                              ∧
                              
                                 (
                                 
                                    
                                       ∂
                                       f
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       ∂
                                       f
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       ∂
                                       f
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       x
                                    
                                    
                                       s
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    ∂
                                    f
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              d
                              s
                              ∧
                              d
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              +
                              ⋯
                              +
                              
                                 
                                    ∂
                                    f
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              d
                              s
                              ∧
                              d
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              ⟺
                              
                                 
                                    ∂
                                    f
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              =
                              ⋯
                              =
                              
                                 
                                    ∂
                                    f
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              =
                              0
                           . An alternative proof is also possible using Lagrange multipliers.□

Note that we assume that there exists some critical value in the interior of the set (we can guarantee that by construction), otherwise we would have to consider the boundary of the set.


                     
                        Definition 2
                        Let 
                              A
                              ,
                              B
                            be geometric sets and 
                              
                                 
                                    s
                                 
                                 
                                    A
                                 
                              
                            and 
                              
                                 
                                    s
                                 
                                 
                                    B
                                 
                              
                            their characteristic variables at point 
                              
                                 x
                              
                           . We define the join set 
                              A
                              ⋈
                              B
                            as: 
                              
                                 
                                    A
                                    ⋈
                                    B
                                    ≔
                                    
                                       x
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          d
                                       
                                    
                                    :
                                    
                                    
                                       
                                          s
                                       
                                       
                                          A
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          B
                                       
                                    
                                    ∧
                                    
                                       
                                          s
                                       
                                       
                                          A
                                       
                                    
                                    ≤
                                    0
                                    .
                                 
                              
                           
                        

We define the precedence of the new operators to be: 
                        ¬
                        ≻
                        ,
                        ≻
                        |
                        ≻
                        ⋈
                        ≻
                        ∩
                        ≻
                        ∪
                     . Observe the similarity with the join operator from relational algebra. Indeed, we join the two relations 
                        A
                        
                           (
                           
                              x
                           
                           ;
                           
                              
                                 s
                              
                              
                                 A
                              
                           
                           )
                        
                      and 
                        B
                        
                           (
                           
                              x
                           
                           ;
                           
                              
                                 s
                              
                              
                                 B
                              
                           
                           )
                        
                      on their characteristic variable. Since the join operator introduces an equation, the dimension of the join set drops. See for example Fig. 2. The dotted line is the join of the two disks. Obviously, this line is no longer a solid in 2 dimensions.


                     
                        Definition 3
                        We denote with 
                              
                                 
                                    J
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    …
                                    
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                            the following 
                              n
                              ×
                              n
                            Jacobian determinant: 
                              
                                 
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                             
                                                ⋱
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                 
                              
                           
                        


                     
                        Lemma 1
                        Projection of Join Sets


                        
                           Let 
                           
                              A
                              :
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 ;
                                 s
                                 )
                              
                            
                           and 
                           
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              :
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 ;
                                 s
                                 )
                              
                              ,
                              i
                              =
                              1
                              …
                              n
                            
                           be geometric primitives. Then to describe 
                           
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 A
                                 ⋈
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ⋈
                                 ⋯
                                 ⋈
                                 
                                    
                                       B
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                            
                           we additionally consider  (i)  no constraints when 
                           
                              k
                              ≤
                              n
                            
                           ;  (ii)  
                              
                                 
                                    J
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    …
                                    
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              =
                              0
                              ,
                              1
                              ≤
                              
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                              <
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              <
                              ⋯
                              <
                              
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              ≤
                              k
                           
                           , when 
                           
                              k
                              >
                              n
                           
                           .
                        


                     
                        Proof
                        Basic idea: We shall exploit wedge products to capture the linear dependence in order to minimize 
                              s
                           . Not surprisingly, these operations yield equivalently the Jacobian determinant.

Assume without loss of generality that we are projecting with respect to 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                           . Considering the wedge product (to find the critical value of 
                              s
                           ) we have 
                              d
                              s
                              ∧
                              d
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                              ∧
                              d
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              ∧
                              d
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                              ∧
                              ⋯
                              ∧
                              d
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                              
                              =
                              d
                              s
                              ∧
                              
                                 (
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       ∂
                                       s
                                    
                                 
                                 d
                                 s
                                 )
                              
                              ∧
                              
                                 (
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∂
                                       s
                                    
                                 
                                 d
                                 s
                                 )
                              
                              ∧
                              ⋯
                              ∧
                              
                                 (
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       ∂
                                       s
                                    
                                 
                                 d
                                 s
                                 )
                              
                              =
                              
                                 
                                    ϵ
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    …
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 )
                              
                              d
                              s
                              ∧
                              d
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ∧
                              ⋯
                              ∧
                              d
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           . Symbol 
                              ϵ
                            is the permutation sign determined by the number of inversions in the considered permutation, which appears in the combinatorial definition of the determinant [25]. Now, if 
                              k
                              ≤
                              n
                            the wedge product is identically zero, because of some 
                              d
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            being equal, due to the pigeonhole principle (we have a wedge product of 
                              n
                              +
                              1
                            factors with 
                              k
                            choices for each factor, and we have that 
                              d
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ∧
                              d
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           ). Otherwise, if 
                              k
                              >
                              n
                           , the wedge product expands to 
                              
                                 (
                                 
                                    
                                       k
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 )
                              
                            coefficients which should all vanish. These coefficients are precisely 
                              
                                 
                                    J
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    …
                                    
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                              ,
                              1
                              ≤
                              
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                              <
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              <
                              ⋯
                              <
                              
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              ≤
                              k
                           .□

Since no extra condition is required to describe a projection of a join with respect to a single variable, we have that 
                        Corollary 1
                        
                           
                              π
                              
                                 (
                                 A
                                 ⋈
                                 B
                                 )
                              
                              =
                              A
                              ⋈
                              B
                           .


                     
                        Theorem 2
                        Projection of Dominant Set


                        
                           
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       A
                                       |
                                       B
                                       )
                                    
                                    =
                                    
                                       
                                          π
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       A
                                       )
                                    
                                    |
                                    B
                                    ∪
                                    
                                       
                                          π
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       A
                                       ⋈
                                       B
                                       )
                                    
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        Without loss of generality we assume that we project with respect to 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                           . Since we have a constrained optimization problem, the critical value can be attained either when a constraint is active or not.


                           
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 A
                                 |
                                 B
                                 )
                              
                              =
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    
                                       1
                                    
                                    …
                                    
                                       k
                                    
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                    −
                                    k
                                 
                              
                              :
                              ∃
                              
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              :
                              
                                 (
                                 
                                    x
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 ∩
                                 A
                                 )
                              
                              ∧
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       A
                                    
                                 
                                 
                                 is critical
                                 )
                              
                              ∧
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       A
                                    
                                 
                                 ≥
                                 
                                    
                                       s
                                    
                                    
                                       B
                                    
                                 
                                 )
                              
                           . This means that 
                              
                                 
                                    s
                                 
                                 
                                    A
                                 
                              
                            takes its critical value on the critical points of 
                              π
                              
                                 (
                                 A
                                 )
                              
                            that happen to satisfy 
                              
                                 
                                    s
                                 
                                 
                                    A
                                 
                              
                              ≥
                              
                                 
                                    s
                                 
                                 
                                    B
                                 
                              
                           , which is precisely 
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 A
                                 )
                              
                              |
                              B
                            or somewhere where 
                              
                                 
                                    s
                                 
                                 
                                    A
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    B
                                 
                              
                           , which is 
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 A
                                 ⋈
                                 B
                                 )
                              
                           . Alternative proofs are possible using wedge products or Lagrange multipliers [26].□

Care has to be taken here that the set 
                        B
                      in the expression 
                        
                           
                              π
                           
                           
                              k
                           
                        
                        
                           (
                           A
                           )
                        
                        |
                        B
                      lies in a lower dimension. That is we consider points in 
                        
                           
                              π
                           
                           
                              k
                           
                        
                        
                           (
                           A
                           )
                        
                      that happen to lie in 
                        B
                     . We could denote 
                        B
                      in this case as 
                        
                           
                              B
                           
                           
                              /
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 A
                                 )
                              
                           
                        
                      but we avoid so due to abuse of notation. Let 
                        
                           
                              
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       m
                                    
                                 
                                 ]
                              
                           
                           
                              1
                              :
                              n
                           
                        
                      denote sequence 
                        
                           
                              B
                           
                           
                              m
                           
                        
                        ,
                        m
                        =
                        1
                        …
                        n
                     . The following theorem comes as a generalization of Theorem 2.


                     
                        Theorem 3
                        Projection of Dominant Sets, Generalized


                        
                           
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 A
                                 |
                                 
                                    
                                       
                                          [
                                          
                                             
                                                B
                                             
                                             
                                                m
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       1
                                       :
                                       n
                                    
                                 
                                 )
                              
                              =
                           
                           
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          A
                                          )
                                       
                                       |
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ]
                                             
                                          
                                          
                                             1
                                             :
                                             n
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ⋃
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          A
                                          ⋈
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       |
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ]
                                             
                                          
                                          
                                             m
                                             ≠
                                             i
                                          
                                          
                                             1
                                             :
                                             n
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ⋃
                                          
                                          
                                             
                                                
                                                   i
                                                   ,
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   i
                                                   <
                                                   j
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                       
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          A
                                          ⋈
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          ⋈
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       |
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ]
                                             
                                          
                                          
                                             m
                                             ≠
                                             i
                                             ,
                                             m
                                             ≠
                                             j
                                          
                                          
                                             1
                                             :
                                             n
                                          
                                       
                                    
                                 
                                 
                                    
                                       ⋃
                                       
                                       ⋯
                                    
                                 
                                 
                                    
                                       ⋃
                                       =
                                       
                                          
                                             π
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          A
                                          ⋈
                                          
                                             
                                                B
                                             
                                             
                                                1
                                             
                                          
                                          ⋈
                                          ⋯
                                          ⋈
                                          
                                             
                                                B
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        

The way join sets were defined allows us to express the intersection of manifolds: a join is performed on the common variables, hence the common variable is implicitly eliminated. The idea is therefore to use joins to eliminate the parameters, as illustrated in Section  5. For example 
                           X
                           :
                           x
                           −
                           cos
                           
                              (
                              t
                              )
                           
                           =
                           0
                           ,
                           Y
                           :
                           y
                           −
                           sin
                           
                              (
                              t
                              )
                           
                           =
                           0
                        . Now 
                           X
                           ⋈
                           Y
                         expresses points 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         that lie on the unit circle. This way, the join variable 
                           t
                         is implicitly eliminated, because we project with respect to 
                           t
                        , due to the join operator being applied. Lemma 1 shows that projection of joins may be trivial if the number of variables projected is less than the number of terms in the join expression. Here 
                           X
                           ⋈
                           Y
                         has 2 terms therefore, the resulting subspace consists of 
                           x
                         and 
                           y
                         only.

More generically, given a parametric solid 
                           G
                         in 
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         defined by 
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 x
                              
                              ;
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    d
                                 
                              
                              )
                           
                           ,
                           i
                           =
                           1
                           …
                           d
                        , we can represent this set as the join of the defining manifolds. That is 
                           G
                           =
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                           ⋈
                           
                              
                                 X
                              
                              
                                 2
                              
                           
                           ⋈
                           ⋯
                           ⋈
                           
                              
                                 X
                              
                              
                                 d
                              
                           
                        . Assume that 
                           
                              
                                 t
                              
                              
                                 d
                              
                           
                         is the characteristic variable. Now projection in the first 
                           d
                           −
                           1
                         dimensions eliminates the corresponding variables, and we have from Lemma 1 that 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       d
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                    ⋈
                                    ⋯
                                    ⋈
                                    
                                       
                                          X
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ⋈
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 ⋈
                                 ⋯
                                 ⋈
                                 
                                    
                                       X
                                    
                                    
                                       d
                                    
                                 
                                 ,
                              
                           
                         since 
                           k
                           =
                           d
                           −
                           1
                           <
                           d
                        . See Section  5 for examples.

We shall adapt the HIA algorithm (Homotopy via Interval type Analysis)  [10] to work with CSG sets extended with projection. The algorithm works computing a contractible cover of an initial set 
                        S
                      and generating an abstract simplicial complex homotopy equivalent to 
                        S
                      (Fig. 4
                      left). The basic predicate of the algorithm is the star test, which provides a sufficient condition of contractability. For completeness, we recall the corresponding definitions.

A point 
                        
                           v
                        
                      is a star for a subset 
                        X
                      of a Euclidean set if 
                        X
                      contains all the line segments connecting any of its points and 
                        
                           v
                        
                      (cf.  Fig. 4 right). We call 
                        X
                      star-shaped or 
                        
                           v
                        
                     -star-shaped. If 
                        X
                      and 
                        Y
                      are two 
                        
                           v
                        
                     -star-shaped sets, then 
                        X
                        ∩
                        Y
                      and 
                        X
                        ∪
                        Y
                      are also 
                        
                           v
                        
                     -star-shaped. A topological space 
                        X
                      which is homotopy-equivalent to a point is contractible, therefore a star-shaped set is contractible. The following sufficient condition for contractability can be checked with interval analysis.


                     
                        Proposition 1
                        
                           Let 
                           
                              f
                              :
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              →
                              R
                            
                           be a 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            
                           function, 
                           
                              D
                            
                           be a convex set and 
                           
                              S
                              =
                              
                                 {
                                 
                                    x
                                 
                                 ∈
                                 D
                                 ⊂
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 f
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ≤
                                 0
                                 }
                              
                            
                           . If there exists 
                           
                              
                                 v
                              
                            
                           in 
                           
                              S
                            
                           such that
                           
                              
                                 
                                    
                                       {
                                       
                                          x
                                       
                                       ∈
                                       D
                                       |
                                       f
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       =
                                       0
                                       ∧
                                       ∇
                                       f
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       ⋅
                                       
                                          (
                                          
                                             x
                                          
                                          −
                                          
                                             v
                                          
                                          )
                                       
                                       ≤
                                       0
                                       }
                                    
                                    =
                                    0̸
                                 
                              
                           
                           then 
                           
                              S
                            
                           is star-shaped.
                        

Observe that the equation 
                        ∇
                        f
                        
                           (
                           
                              x
                           
                           )
                        
                        ⋅
                        
                           (
                           
                              x
                           
                           −
                           
                              v
                           
                           )
                        
                        =
                        0
                      expresses the tangent plane at the boundary point 
                        
                           x
                        
                     , since it is satisfied for all points perpendicular to the normal vector. Taking into account the characteristic function, the boundary of a primitive is 
                        f
                        
                           (
                           
                              x
                           
                           ;
                           0
                           )
                        
                        =
                        0
                     , therefore the star condition is written as 
                        ∇
                        f
                        
                           (
                           
                              x
                           
                           ;
                           0
                           )
                        
                        ⋅
                        
                           (
                           
                              x
                           
                           −
                           
                              v
                           
                           )
                        
                        ≤
                        0
                     . We set 
                        F
                        
                           (
                           
                              x
                           
                           )
                        
                        ≔
                        f
                        
                           (
                           
                              x
                           
                           ;
                           0
                           )
                        
                     . Now we may rewrite 
                        ∇
                        F
                        
                           (
                           
                              x
                           
                           )
                        
                        ⋅
                        
                           (
                           
                              x
                           
                           −
                           
                              v
                           
                           )
                        
                        ≤
                        0
                     .

For primitive 
                        f
                        
                           (
                           
                              x
                           
                           ;
                           s
                           )
                        
                     , the boundary of the projection is given from 
                        f
                        
                           (
                           
                              x
                           
                           ;
                           0
                           )
                        
                      and 
                        
                           
                              ∂
                              f
                           
                           
                              ∂
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                        
                        
                           (
                           
                              x
                           
                           ;
                           0
                           )
                        
                        =
                        0
                     . We define 
                        F
                        
                           (
                           
                              x
                           
                           )
                        
                        =
                        f
                        
                           (
                           
                              x
                           
                           ;
                           0
                           )
                        
                     . Now we have 
                        F
                        
                           (
                           
                              x
                           
                           )
                        
                        =
                        
                           
                              ∂
                              F
                           
                           
                              ∂
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                        
                        
                           (
                           
                              x
                           
                           )
                        
                        =
                        0
                     . The latter equation implies a relation 
                        
                           
                              x
                           
                           
                              i
                           
                        
                        =
                        G
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                           )
                        
                      and by substitution in the first one we obtain 
                        R
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                           )
                        
                        =
                        0
                      (recall that 
                        
                           
                              
                                 x
                              
                           
                           
                              
                                 i
                              
                           
                        
                      denotes vector 
                        
                           (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                           )
                        
                     ). The process is similar when more variables are eliminated. When the functions are multivariate polynomials, 
                        R
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                           )
                        
                      is precisely the resultant of the polynomial and its derivative with respect to variable 
                        
                           
                              x
                           
                           
                              i
                           
                        
                      (this particular resultant is a multiple of the discriminant).


                     
                        Lemma 2
                        
                           Given 
                           
                              F
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              0
                            
                           and 
                           
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              0
                              ,
                              i
                              =
                              1
                              …
                              k
                            
                           . Then there exist functions 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                            
                           so that 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              ,
                              i
                              =
                              1
                              …
                              k
                            
                           where 
                           
                              
                                 x
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    ̃
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                              
                            
                           . Therefore we may write 
                           
                              F
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              F
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                              
                           
                           .
                        


                     
                        Proof
                        Basic idea: We take a pair of the given equations that has not been considered so far, and eliminate a variable using the implicit function theorem.

We have 
                              F
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              0
                            and 
                              
                                 
                                    F
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              0
                           . Subtracting the two equations yields an implicit equation in 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    d
                                 
                              
                           . For readability purposes we denote the comma separated list 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                            with 
                              
                                 
                                    x
                                 
                                 
                                    i
                                    …
                                    j
                                 
                              
                           . From the implicit function theorem we have 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                       …
                                       d
                                    
                                 
                                 )
                              
                           . Replacing 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                            in 
                              F
                            yields 
                              F
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          2
                                          …
                                          d
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                       …
                                       d
                                    
                                 
                                 )
                              
                              =
                              0
                           . We also obtain 
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          2
                                          …
                                          d
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                       …
                                       d
                                    
                                 
                                 )
                              
                              =
                              0
                              ,
                              i
                              =
                              2
                              …
                              k
                           . Now we apply the same process to 
                              F
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          2
                                          …
                                          d
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                       …
                                       d
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          2
                                          …
                                          d
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                       …
                                       d
                                    
                                 
                                 )
                              
                            which will yield 
                              
                                 
                                    
                                       F
                                       
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      3
                                                      …
                                                      d
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                   …
                                                   d
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                   …
                                                   d
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                3
                                                …
                                                d
                                             
                                          
                                          )
                                       
                                       =
                                       0
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∂
                                             F
                                          
                                          
                                             ∂
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      3
                                                      …
                                                      d
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                   …
                                                   d
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                   …
                                                   d
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                3
                                                …
                                                d
                                             
                                          
                                          )
                                       
                                       =
                                       0
                                    
                                 
                              
                            and so on until we arrive at 
                              R
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              =
                              F
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       ⋯
                                       
                                          
                                             g
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                       
                                       ⋯
                                       )
                                    
                                    ,
                                    …
                                    )
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    ⋯
                                    )
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       
                                          (
                                          k
                                          +
                                          1
                                          )
                                       
                                       …
                                       d
                                    
                                 
                                 )
                              
                              =
                              0
                           . Therefore 
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          g
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          ⋯
                                          
                                             
                                                g
                                             
                                             
                                                k
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                             )
                                          
                                          ⋯
                                          )
                                       
                                       ,
                                       …
                                       )
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    …
                                    k
                                    .
                                 
                              
                           
                           □


                     
                        Theorem 4
                        
                           Let 
                           
                              R
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              =
                              0
                            
                           be the boundary of the projection of primitive 
                           
                              f
                              
                                 (
                                 
                                    x
                                 
                                 ;
                                 s
                                 )
                              
                              =
                              0
                            
                           with respect to 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                           
                           , where 
                           
                              
                                 x
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    ̃
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                              
                            
                           . Then
                           
                              
                                 
                                    ∇
                                    R
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                    ⋅
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       −
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                    =
                                    ∇
                                    F
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    ⋅
                                    
                                       (
                                       
                                          u
                                       
                                       −
                                       
                                          x
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                           where 
                           
                              F
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              f
                              
                                 (
                                 
                                    x
                                 
                                 ;
                                 0
                                 )
                              
                           
                           .
                        


                     
                        Proof
                        Since we project with respect to 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                            we have 
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              0
                              ,
                              i
                              =
                              1
                              …
                              k
                           . It follows from Lemma 2 that there exist functions 
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                            so that 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              ,
                              i
                              =
                              1
                              …
                              k
                           . We have that 
                              R
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              =
                              F
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                              
                           . We trivially set 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              ,
                              i
                              =
                              
                                 (
                                 k
                                 +
                                 1
                                 )
                              
                              …
                              d
                            so that we may now write 
                              R
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              =
                              F
                              
                                 (
                                 
                                    y
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                    )
                                 
                                 )
                              
                           . Now from the chain rule we have 
                              
                                 
                                    ∂
                                    R
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ,
                              i
                              =
                              
                                 (
                                 k
                                 +
                                 1
                                 )
                              
                              …
                              d
                           . We also have that 
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              =
                              0
                              ,
                              j
                              =
                              1
                              …
                              k
                            (by hypothesis due to projection, seeing 
                              F
                            as a function in 
                              
                                 y
                              
                            instead of 
                              
                                 x
                              
                           ) and that 
                              
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            equals 
                              
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           , when 
                              j
                              ≤
                              k
                           , or 0, when 
                              j
                              >
                              k
                              ∧
                              j
                              ≠
                              i
                            or 1, when 
                              j
                              =
                              i
                           . This yields in the end 
                              
                                 
                                    ∂
                                    R
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           . Finally, 
                              ∇
                              R
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              ⋅
                              
                                 (
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 −
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    k
                                    +
                                    1
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    ∂
                                    R
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              +
                              0
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    k
                                    +
                                    1
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    y
                                 
                                 )
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    ∂
                                    F
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    y
                                 
                                 )
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              =
                           
                           
                              
                                 
                                    ∇
                                    F
                                    
                                       (
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                    ⋅
                                    
                                       (
                                       
                                          u
                                       
                                       −
                                       
                                          y
                                       
                                       )
                                    
                                    ≡
                                    ∇
                                    F
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                    ⋅
                                    
                                       (
                                       
                                          u
                                       
                                       −
                                       
                                          x
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                           □

The geometric interpretation of Theorem 4 is that the tangent plane at a point of the boundary in the projected space, is equal to the projection of the tangent plane in the original space (Fig. 5
                     ). As such, in order to compute the star test on the projection of a primitive, it suffices to compute the star test in the original space (before projection). Therefore, no computation of the implicit relation 
                        R
                      is required, and the test can be evaluated using only the known relation 
                        f
                     . The following lemma comes as a generalization of Lemma 2.


                     
                        Lemma 3
                        
                           Given 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              0
                              ,
                              i
                              =
                              0
                              …
                              n
                            
                           . Then there exist functions 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                            
                           so that 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              ,
                              i
                              =
                              1
                              …
                              k
                              ≤
                              n
                            
                           where 
                           
                              
                                 x
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    ̃
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                              
                            
                           . Therefore we may write 
                           
                              R
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              =
                              F
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                              
                           .


                     
                        Proof
                        This is a generalization of Lemma 2. We have 
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              0
                           . Subtracting the two equations yields an implicit equation 
                              
                                 
                                    R
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              0
                           . From the implicit function theorem we have 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                       …
                                       d
                                    
                                 
                                 )
                              
                           . Now we replace 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                            in 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              =
                              0
                              …
                              n
                            and get 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          2
                                          …
                                          d
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                       …
                                       d
                                    
                                 
                                 )
                              
                              =
                              0
                              ,
                              i
                              =
                              0
                              …
                              n
                           . Now we apply the same process to 
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                            and 
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                            and get 
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                       …
                                       d
                                    
                                 
                                 )
                              
                              =
                              0
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       3
                                       …
                                       d
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                   …
                                                   d
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                3
                                                …
                                                d
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                3
                                                …
                                                d
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             3
                                             …
                                             d
                                          
                                       
                                       )
                                    
                                    =
                                    0
                                    ,
                                    
                                    i
                                    =
                                    0
                                    …
                                    n
                                    .
                                 
                              
                           
                        

Finally we obtain 
                              R
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       ⋯
                                       
                                          
                                             g
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                       
                                       ⋯
                                       )
                                    
                                    ,
                                    …
                                    )
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    ⋯
                                    )
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                              
                              =
                              0
                              ,
                              i
                              =
                              0
                              …
                              n
                           . Therefore 
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          g
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          ⋯
                                          
                                             
                                                g
                                             
                                             
                                                k
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                             )
                                          
                                          ⋯
                                          )
                                       
                                       ,
                                       …
                                       )
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    …
                                    k
                                    .
                                 
                              
                            Note that in the end 
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              ≡
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              ≡
                              ⋯
                              ≡
                              
                                 
                                    F
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                           . Instead of 
                              0
                              …
                              k
                            we can apply the same elimination process to any 
                              
                                 (
                                 k
                                 +
                                 1
                                 )
                              
                           -subset of the 
                              
                                 (
                                 n
                                 +
                                 1
                                 )
                              
                            equations. We have also assumed generic enough functions, i.e., no two functions are identically the same.□


                     
                        Theorem 5
                        
                           Let 
                           
                              R
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              =
                              0
                            
                           be the boundary of the projection of primitive 
                           
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 A
                                 ⋈
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ⋈
                                 ⋯
                                 ⋈
                                 
                                    
                                       B
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                            
                           with respect to 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                           
                           , where 
                           
                              
                                 x
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              ,
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    ̃
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                              
                            
                           and 
                           
                              k
                              ≤
                              n
                              ,
                              d
                              −
                              k
                              ≥
                              2
                            
                           . Let 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 ;
                                 s
                                 )
                              
                            
                           be the characteristic functions and 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 ;
                                 0
                                 )
                              
                            
                           . Then the value 
                           
                              S
                            
                           of the star test 
                           
                              S
                              =
                              ∇
                              R
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              ⋅
                              
                                 (
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 −
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                            
                           is the 
                           
                              
                                 (
                                 k
                                 +
                                 1
                                 )
                              
                           
                           -th coordinate of the solution vector 
                           
                              
                                 w
                              
                            
                           of system 
                           
                              
                                 (
                                 
                                    J
                                 
                                 |
                                 
                                    [
                                    −
                                    1
                                    ]
                                 
                                 )
                              
                              
                                 w
                              
                              =
                              
                                 a
                              
                           
                           , where 
                           
                              
                                 J
                              
                           
                           the 
                           
                              
                                 (
                                 k
                                 +
                                 1
                                 )
                              
                              ×
                              k
                            
                           Jacobian matrix of 
                           
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    F
                                 
                                 
                                    k
                                 
                              
                            
                           with respect to 
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    J
                                 
                                 |
                                 
                                    [
                                    −
                                    1
                                    ]
                                 
                                 )
                              
                            
                           is 
                           
                              
                                 J
                              
                            
                           augmented with column 
                           
                              
                                 
                                    
                                       (
                                       −
                                       1
                                       ,
                                       −
                                       1
                                       ,
                                       …
                                       ,
                                       −
                                       1
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                                 w
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       S
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                            
                           and 
                           
                              
                                 a
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                            
                           with
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          k
                                          +
                                          1
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                F
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    j
                                    =
                                    0
                                    …
                                    k
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        From Lemma 3 we have that 
                              
                                 
                                    R
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             k
                                             +
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             d
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                           
                              m
                              =
                              0
                              …
                              n
                           . We trivially define 
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                    ≔
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    
                                       (
                                       k
                                       +
                                       1
                                       )
                                    
                                    …
                                    d
                                    ,
                                 
                              
                            so that we may write 
                              R
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    F
                                 
                                 
                                    m
                                 
                              
                              
                                 (
                                 
                                    y
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                    )
                                 
                                 )
                              
                           . Applying the chain rule we obtain 
                              
                                 
                                    ∂
                                    R
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           . Now, as in the proof of Theorem 4, 
                              
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            equals 0 when 
                              j
                              >
                              k
                              ,
                              j
                              ≠
                              i
                            and 1 when 
                              j
                              =
                              i
                           . Therefore 
                              
                                 
                                    ∂
                                    R
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    ∂
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           . We have that 
                              S
                              =
                              ∇
                              R
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              ⋅
                              
                                 (
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 −
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                              ⇔
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    k
                                    +
                                    1
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    k
                                    +
                                    1
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              −
                              S
                              =
                              0
                              ,
                              
                              m
                              =
                              0
                              …
                              k
                           . We set 
                              
                                 
                                    a
                                 
                                 
                                    m
                                 
                              
                              ≔
                              −
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    k
                                    +
                                    1
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            (recall that 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                            when 
                              i
                              >
                              k
                           ) and rewrite (swapping sums): 
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                F
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          k
                                          +
                                          1
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    −
                                    S
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          m
                                       
                                    
                                    .
                                 
                              
                            Now we set 
                              
                                 
                                    w
                                 
                                 
                                    j
                                 
                              
                              ≔
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    k
                                    +
                                    1
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              ,
                              j
                              =
                              1
                              …
                              k
                            and 
                              
                                 
                                    w
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ≔
                              S
                            which allows us to rewrite 
                              
                                 (
                                 
                                    J
                                 
                                 |
                                 
                                    [
                                    −
                                    1
                                    ]
                                 
                                 )
                              
                              
                                 w
                              
                              =
                              
                                 a
                              
                           , where 
                              
                                 J
                              
                           , the 
                              
                                 (
                                 k
                                 +
                                 1
                                 )
                              
                              ×
                              k
                            Jacobian matrix of 
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    F
                                 
                                 
                                    k
                                 
                              
                            with respect to 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                            is augmented with column 
                              
                                 
                                    
                                       (
                                       −
                                       1
                                       ,
                                       −
                                       1
                                       ,
                                       …
                                       ,
                                       −
                                       1
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                           .

Note that the Jacobian can be defined using any 
                              
                                 (
                                 k
                                 +
                                 1
                                 )
                              
                           -subset of the 
                              
                                 (
                                 n
                                 +
                                 1
                                 )
                              
                            functions. We have also assumed that 
                              d
                              ≥
                              k
                              +
                              2
                           , so that the dimension of the space after projection is at least 2 and the notion of a tangent hyperplane makes sense.□


                     
                        Lemma 4
                        
                           The geometric interpretation of   
                              Theorem  5   is that the tangent plane at the projected space, is equal to the projection of the intersection of the tangent planes in the original space, for 
                           
                              k
                              +
                              1
                            
                           primitives participating in the join (cf.   
                              Fig.  6
                           
                           ).
                        


                     
                        Proof
                        A tangent plane in the original space is given as 
                              ∇
                              
                                 
                                    F
                                 
                                 
                                    m
                                 
                              
                              
                                 (
                                 
                                    u
                                 
                                 −
                                 
                                    x
                                 
                                 )
                              
                              =
                              0
                            (with 
                              m
                              =
                              0
                              …
                              k
                           ). The intersection of all 
                              k
                              +
                              1
                            tangent planes is an over-constrained system in the first 
                              k
                            dimensions. Equation in line 
                              m
                            is 
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             ∂
                                             
                                                
                                                   F
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       =
                                       0
                                       ⇔
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             ∂
                                             
                                                
                                                   F
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             k
                                             +
                                             1
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             ∂
                                             
                                                
                                                   F
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       =
                                       0
                                       ⇔
                                    
                                 
                                 
                                    (1)
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             ∂
                                             
                                                
                                                   F
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                    
                                 
                              
                            with 
                              
                                 
                                    a
                                 
                                 
                                    m
                                 
                              
                            defined as in Theorem 5.

The tangent plane at the projected space is obtained when the star test (Theorem 5) evaluates to zero. Replacing 
                              S
                              =
                              0
                            in Theorem 5 we obtain the following system: 
                              
                                 (2)
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                F
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                 
                              
                            with 
                              m
                              =
                              0
                              …
                              k
                           . It is obvious now that systems (1) and (2) are equivalent.□

Now we are able to perform the star test on 
                        π
                        
                           (
                           A
                           )
                        
                        |
                        B
                     . First, observe that 
                        A
                        ⋈
                        B
                        ⊆
                        π
                        
                           (
                           A
                           )
                        
                     , by definition. Moreover 
                        π
                        
                           (
                           A
                           )
                        
                        |
                        B
                      appears in an expression paired with 
                        A
                        ⋈
                        B
                     , from Theorem 2. Let 
                        a
                        =
                        π
                        
                           (
                           A
                           )
                        
                        |
                        B
                        ,
                        b
                        =
                        π
                        
                           (
                           B
                           )
                        
                        |
                        A
                      and 
                        c
                        =
                        π
                        
                           (
                           A
                           ⋈
                           B
                           )
                        
                        =
                        A
                        ⋈
                        B
                     . Now we have 
                        π
                        
                           (
                           A
                           ∩
                           B
                           )
                        
                        =
                        a
                        ∪
                        b
                        ∪
                        c
                        =
                        
                           (
                           a
                           ∖
                           c
                           )
                        
                        ∪
                        
                           (
                           b
                           ∖
                           c
                           )
                        
                        ∪
                        c
                     . The boundary of each set in the union consists either of the boundary of the projection of a primitive 
                        
                           (
                           π
                           
                              (
                              A
                              )
                           
                           ,
                           π
                           
                              (
                              B
                              )
                           
                           )
                        
                      or of the boundary of 
                        A
                        ⋈
                        B
                     . Moreover, we have that if two sets are star-shaped, then their intersection and union is star-shaped as well. Therefore Theorems 4 and 5 allow us to compute the gradient and as a result, the outcome of the star test.

In this section we present some examples of our proposed approach dealing with projections. Note that union operators pose no problems, since they generate independent systems and we can typically handle hundreds of unions independently. Therefore we focus on projections of intersections which provide the biggest challenge. Currently our algorithm is not optimized for handling many levels of projection (note the combinatorial explosion in Section  5.2). However, as mentioned in Section  2.1, techniques like propagation of bounding boxes allow us to detect terms that do not contribute to the final result and quickly skip over them. Finally, our examples can be easily converted to any dimension, however, we restrict to 2D and 3D because they are easier to visualize and understand.

Consider the ellipsoid from Fig. 5: 
                           
                              
                                 f
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    ,
                                    s
                                    )
                                 
                                 =
                                 2
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 3
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 
                                    
                                       3
                                    
                                 
                                 x
                                 z
                                 −
                                 1
                                 −
                                 s
                                 =
                                 0
                                 .
                              
                           
                         Then from Theorem 1 we have for its projection on 
                           x
                           ,
                           y
                        : 
                           
                              
                                 
                                    f
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       ,
                                       s
                                       )
                                    
                                    =
                                    0
                                    ∧
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          z
                                       
                                    
                                    =
                                    6
                                    z
                                    +
                                    2
                                    
                                       
                                          3
                                       
                                    
                                    x
                                    =
                                    0
                                    ⇔
                                 
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    1
                                    −
                                    s
                                    =
                                    0
                                    ∧
                                    z
                                    =
                                    −
                                    
                                       
                                          
                                             
                                                3
                                             
                                          
                                       
                                       
                                          3
                                       
                                    
                                    x
                                 
                              
                           
                         which is effectively the unit disk.

Let 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 E
                              
                              
                                 3
                              
                           
                         be three primitives in 
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        , we want to express the object 
                           G
                         defined as 
                           G
                           =
                           π
                           
                              (
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ∩
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           
                           ∩
                           
                           π
                           
                              (
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ∩
                              
                                 
                                    E
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        . The above expression will be transformed in DNF. We have that: 
                           G
                           =
                           
                              [
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ∪
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ]
                           
                           ∩
                           
                              [
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              ∪
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       3
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ]
                           
                           =
                           
                              [
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ∩
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              ]
                           
                           ∪
                           
                              [
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ∩
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       3
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ]
                           
                           ∪
                           
                              [
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ∩
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              ]
                           
                           ∪
                           
                              [
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ∩
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       3
                                    
                                 
                                 |
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ]
                           
                           =
                           
                              [
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              |
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                              ∪
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ⋈
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                           ∩
                           
                              [
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              |
                              
                                 
                                    E
                                 
                                 
                                    3
                                 
                              
                              ∪
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ⋈
                              
                                 
                                    E
                                 
                                 
                                    3
                                 
                              
                              ]
                           
                           ∪
                           ⋯
                           =
                           
                              [
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              |
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                              ∩
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              |
                              
                                 
                                    E
                                 
                                 
                                    3
                                 
                              
                              ]
                           
                           ∪
                           ⋯
                           =
                           
                              [
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              |
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                              ,
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              |
                              
                                 
                                    E
                                 
                                 
                                    3
                                 
                              
                              
                                 )
                              
                              ]
                           
                           ∪
                           
                              [
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              |
                              
                                 
                                    E
                                 
                                 
                                    3
                                 
                              
                              ,
                              π
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              |
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                           ∪
                           ⋯
                           =
                           
                              
                                 ⋃
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 18
                              
                           
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        . That is 
                           G
                         is equal to the union of 18 sets which in fact can be grouped into five sets depending on the contributing set being 
                           π
                           
                              (
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           ,
                           π
                           
                              (
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           ,
                           π
                           
                              (
                              
                                 
                                    E
                                 
                                 
                                    3
                                 
                              
                              )
                           
                           ,
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           ⋈
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           ⋈
                           
                              
                                 E
                              
                              
                                 3
                              
                           
                        , as shown in Table 1
                        . Note how this expansion of the formula is independent of the dimension. To visualize the above, let 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              ,
                              r
                              )
                           
                         denote a sphere centered at 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         with radius 
                           r
                        . If 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           =
                           
                              (
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              )
                           
                           ,
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           =
                           
                              (
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              ,
                              0
                              ,
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          3
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              )
                           
                         and 
                           
                              
                                 E
                              
                              
                                 3
                              
                           
                           =
                           
                              (
                              −
                              
                                 
                                    3
                                 
                                 
                                    2
                                 
                              
                              ,
                              0
                              ,
                              
                                 
                                    3
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    3
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         then 
                           π
                           
                              (
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ∩
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           ,
                           π
                           
                              (
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ∩
                              
                                 
                                    E
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         and 
                           π
                           
                              (
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ∩
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           ∩
                           π
                           
                              (
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ∩
                              
                                 
                                    E
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         are shown in Figs. 7 and 8
                        
                        . 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           ⋈
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           ,
                           π
                           
                              (
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           |
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           ⋈
                           
                              
                                 E
                              
                              
                                 3
                              
                           
                         are also visible.

Let 
                           X
                           
                              (
                              t
                              ,
                              r
                              )
                           
                           =
                           x
                           −
                           
                              (
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              +
                              r
                              )
                           
                           
                           cos
                           t
                           ,
                           Y
                           
                              (
                              t
                              ,
                              r
                              )
                           
                           =
                           y
                           −
                           
                              (
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              +
                              r
                              )
                           
                           
                           sin
                           t
                           ,
                           R
                           
                              (
                              r
                              ,
                              s
                              )
                           
                           =
                           r
                           
                              (
                              r
                              −
                              1
                              )
                           
                           −
                           s
                        . Equation 
                           R
                           
                              (
                              r
                              ,
                              s
                              )
                           
                           =
                           0
                         restricts the characteristic variable 
                           s
                        , so that 
                           s
                           ≤
                           0
                         when 
                           r
                           ∈
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        . Then 
                           
                              
                                 π
                              
                              
                                 r
                                 ,
                                 t
                              
                           
                           
                              (
                              R
                              ⋈
                              X
                              ⋈
                              Y
                              )
                           
                         is a 2D annulus in the 
                           x
                           y
                        -space, as shown in Fig. 9
                         left. The parametric construction 
                           
                              
                                 π
                              
                              
                                 r
                              
                           
                           
                              (
                              R
                              ⋈
                              X
                              ⋈
                              Y
                              )
                           
                         in 3D (
                           x
                           y
                           t
                        -space), before being projected down with respect to 
                           t
                        -axis, is an infinite spiral ribbon along the 
                           t
                        -axis (Fig. 9 right). This example demonstrates an artificial example for the join operator, which however is not very practical, as we do not obtain a solid in every dimension (the ribbon is not a 3D solid — it unavoidably loses one dimension due to the fact that we have 2 joins).
                           2
                        
                        
                           2
                           The join operator is mainly used to describe the projection of dominant sets, in order to describe the projection of intersections.
                         There is an alternative formulation that gives us a solid, both in 3 and 2 dimensions, which also allows us to compute the gradient applying Theorem 4. We set 
                           f
                           
                              (
                              x
                              ,
                              y
                              ,
                              t
                              ;
                              s
                              )
                           
                           =
                           
                              
                                 
                                    (
                                    x
                                    cos
                                    
                                       (
                                       −
                                       t
                                       )
                                    
                                    )
                                 
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 
                                    (
                                    y
                                    −
                                    sin
                                    
                                       (
                                       −
                                       t
                                       )
                                    
                                    )
                                 
                              
                              
                                 2
                              
                           
                           −
                           1
                           /
                           4
                           −
                           s
                        . Now we have a cylindrical spiral in the 3D space 
                           
                              (
                              x
                              ,
                              y
                              ,
                              t
                              )
                           
                         which projects down to an annulus in 2D (cf.  Fig. 10
                        ). Note that the minus sign in 
                           t
                         has been used merely for illustration purposes (to force a clockwise drawing order).

@&#IMPLEMENTATION@&#

We have implemented the approach presented in this paper in Python/SAGE  [27]. The necessary algebraic systems to describe the geometric set are automatically generated and are then passed to Quimper  [28] for solving. The expression tree is described by object constructors. For example, given spheres 
                        A
                      and 
                        B
                        ,
                        π
                        
                           (
                           A
                           ∩
                           B
                           )
                        
                      is expressed as: 
                        
                           
                        
                     
                  

The code consists of definitions and is pretty straightforward to read. RIF stands for Real Interval Field, i.e., it provides a way to denote intervals in SAGE. The output is the DNF expression: 
                        
                           
                              π
                              
                                 (
                                 A
                                 )
                              
                              |
                              B
                              ∪
                              π
                              
                                 (
                                 A
                                 ⋈
                                 B
                                 )
                              
                              ∪
                              π
                              
                                 (
                                 B
                                 )
                              
                              |
                              A
                              ∪
                              π
                              
                                 (
                                 B
                                 ⋈
                                 A
                                 )
                              
                              .
                           
                        
                      Note that although 
                        π
                        
                           (
                           B
                           ⋈
                           A
                           )
                        
                      is identical to 
                        π
                        
                           (
                           A
                           ⋈
                           B
                           )
                        
                      it still appears in the expression. We hope to allow for such optimizations in future versions. The four systems generated are: 
                        
                           (i)
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 2
                                 z
                                 −
                                 
                                    
                                       3
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                               and 
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 −
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 0
                              
                           


                              
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 −
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                              
                           


                              
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 2
                                 z
                                 −
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                               and 
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 ≥
                                 0
                              
                           

identical to (ii)

As a second example, we present the code for the projection of the parametric annulus of Section  5.3 with respect to 
                        t
                        ,
                        r
                        ,
                        y
                     . 
                        
                           
                        
                     
                  

The generated constraints are solved with Quimper and plotted in Fig. 11 right. The plot is shown as a 2D shape, however it represents a 1-dimensional object (the projection along the 
                        x
                     -axis). It is evident that the projection is equal to the 
                        x
                      range 
                        
                           [
                           −
                           
                              
                                 3
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 3
                              
                              
                                 2
                              
                           
                           ]
                        
                     . The 
                        y
                     -values shown are contributing points from the higher dimension, i.e., the 
                        y
                     -values that correspond to critical values of the characteristic variable 
                        s
                     . According to Lemma 1, an additional Jacobian constraint has been taken into account, since the number of variables projected is greater than or equal to the number of terms in the join expression:
                        
                           
                              J
                              =
                              
                                 |
                                 
                                    
                                       
                                          0
                                       
                                       
                                          1
                                          −
                                          2
                                          r
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             (
                                             1
                                             /
                                             2
                                             +
                                             r
                                             )
                                          
                                          sin
                                          t
                                       
                                       
                                          −
                                          cos
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          −
                                          
                                             (
                                             1
                                             /
                                             2
                                             +
                                             r
                                             )
                                          
                                          cos
                                          t
                                       
                                       
                                          −
                                          sin
                                          t
                                       
                                       
                                          1
                                       
                                    
                                 
                                 |
                              
                              =
                              0
                              .
                           
                        
                      The generated system is: 
                        
                           
                              
                                 {
                                 
                                    
                                       
                                          x
                                          −
                                          
                                             (
                                             1
                                             /
                                             2
                                             +
                                             r
                                             )
                                          
                                          cos
                                          t
                                          =
                                          0
                                       
                                    
                                    
                                       
                                          y
                                          −
                                          
                                             (
                                             1
                                             /
                                             2
                                             +
                                             r
                                             )
                                          
                                          sin
                                          t
                                          =
                                          0
                                       
                                    
                                    
                                       
                                          s
                                          −
                                          r
                                          
                                             (
                                             r
                                             −
                                             1
                                             )
                                          
                                          =
                                          0
                                       
                                    
                                    
                                       
                                          J
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                        
                      With the second formulation, the description of the annulus is much simpler: 
                        
                           
                        
                     
                  

The generated system is 
                        
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   sin
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   cos
                                                   t
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          s
                                          −
                                          1
                                          /
                                          4
                                          =
                                          0
                                       
                                    
                                    
                                       
                                          2
                                          y
                                          −
                                          2
                                          sin
                                          t
                                          =
                                          0
                                       
                                    
                                    
                                       
                                          2
                                          
                                             (
                                             x
                                             −
                                             cos
                                             t
                                             )
                                          
                                          sin
                                          t
                                          −
                                          2
                                          
                                             (
                                             y
                                             −
                                             sin
                                             t
                                             )
                                          
                                          cos
                                          t
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                        
                      The solution set is the same, but we obtain a smaller system. We observed that our solver managed to provide better convergence in the first case with the bigger system, in slightly more time. This may be explained by the fact that more constraints (equations) are taken into account. Solution strategies of the generated systems are not our focus in this paper and we plan to study them in a future work.

@&#CONCLUSION@&#

We have extended classical CSG constructs with the projection operator. Projections effectively allow us to model parametric solids and their Boolean operations, and therefore deal with a greater variety of sets than classical CSG, such as extrusions or sweeps. Each point in the projection is associated with a point in the original space, a property that allows us to perform gradient computations in the projected space by equivalent gradient computations in the original space. Extending the CSG representation is essential to extend geometric and topological algorithms. Since it provides an algebraic representation of the geometric model, formal methods such as interval analysis and proof assistants can be applied in order to provide certification. Moreover, in the domain of computer graphics, our method could be used to directly deal with projections in a 3D world. Note that our framework can handle any analytic function, the only requirement for system generation is differentiability. Therefore it is not limited to only closed-form functions or more restricted families such as polynomial and rational functions. As future work we would like to benchmark the scalability of our approach in analyzing real-world models (properly adapted with projections) involving hundreds or thousands of operands.

Although we have made several assumptions regarding the manifolds with respect to the characteristic variable (it should span both interior and exterior parts and it should have critical points in the studied parts) we have seen that it is still possible to capture and describe many sets that arise in practice, especially when they are constructed ground-up from simple primitives. In a preliminary work we studied the simple idea of directly describing the set with a set of equations and inequalities, possibly introducing (nested) optimization problems with the aid of Lagrange multipliers in the case of projections. We discovered that merely considering a set of semi-algebraic equations (to be used with some black-box solver) is not efficient. Consider, for example, 
                        n
                      unit disks centered at 
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                        
                        ,
                        i
                        =
                        1
                        …
                        n
                     . Construct the 
                        
                           (
                           n
                           +
                           1
                           )
                        
                        ×
                        
                           (
                           n
                           +
                           3
                           )
                        
                      system consisting of the 
                        n
                      equations 
                        
                           
                              
                                 (
                                 x
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                           
                              2
                           
                        
                        +
                        
                           (
                           y
                           −
                           
                              
                                 y
                              
                              
                                 i
                              
                              
                                 2
                              
                           
                           )
                        
                        −
                        1
                        −
                        
                           
                              s
                           
                           
                              i
                           
                        
                        =
                        0
                        ,
                        i
                        =
                        1
                        …
                        n
                      as well as the equation 
                        
                           
                              ∏
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                        
                           (
                           s
                           −
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                           )
                        
                        =
                        0
                     . Now the zero-set of the system with respect to 
                        x
                        ,
                        y
                        ,
                        s
                        ,
                        
                           
                              s
                           
                           
                              i
                           
                        
                      where 
                        s
                        ≤
                        0
                      describes the union of the 
                        n
                      disks. This naive approach yields an 
                        
                           (
                           n
                           +
                           1
                           )
                        
                        ×
                        
                           (
                           n
                           +
                           3
                           )
                        
                      system, while the same set can be expressed by concatenating the solutions of 
                        n
                      independent equations in 3 variables. Extensive benchmarks have shown that such an approach is non-practical even when state-of-the-art solvers like Quimper are considered. This led us to this paper’s approach which manipulates the expression tree and avoids introducing Lagrange multipliers.

As mentioned, our framework allows modeling extrusions and sweeps, since they can be defined as parametric objects. However, for Minkowski sums things are more difficult, as we currently know of no way to model a continuous characteristic function (simply considering the sum of the characteristic variables is not enough). This will be a topic of future research.

Another interesting problem is to study the complement of projections, which boils down to dealing with complements of join sets, as a consequence of De Morgan’s rules. The definition of 
                        ¬
                        
                           (
                           A
                           ⋈
                           B
                           )
                        
                      raises interesting questions. For example, let 
                        A
                        ,
                        B
                      be two spheres. Then 
                        ¬
                        
                           (
                           A
                           ⋈
                           B
                           )
                        
                        =
                        ¬
                        A
                        ⋈
                        ¬
                        B
                     , but there are cases (e.g., when considering 
                        ¬
                        
                           (
                           A
                           ⋈
                           ¬
                           B
                           )
                        
                     ) where the characteristic variable does not span both interior and exterior parts. An idea is to use some other equation 
                        
                           
                              F
                           
                           
                              1
                           
                        
                        −
                        λ
                        
                           
                              F
                           
                           
                              2
                           
                        
                      from the pencil of two primitives, instead of 
                        
                           
                              F
                           
                           
                              1
                           
                        
                        −
                        
                           
                              F
                           
                           
                              2
                           
                        
                     . Regarding projections, we would like to investigate if it is possible to simplify notation, by expressing the extra equations 
                        
                           
                              ∂
                              f
                           
                           
                              ∂
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                        
                        =
                        0
                      as join sets. For example if 
                        A
                        :
                        f
                        
                           (
                           
                              x
                           
                           ;
                           0
                           )
                        
                        =
                        0
                      then we may write something like 
                        A
                        ⋈
                        
                           
                              A
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                           
                              ′
                           
                        
                     . Finally, we can extend Theorem 5 for the case where 
                        k
                        >
                        n
                     , although we do not know if it has any practical meaning.

@&#ACKNOWLEDGMENT@&#

This work has been funded by NPRP grant number NPRP 09-906-1-137 from the Qatar National Research Fund (a member of The Qatar Foundation). The statements made herein are solely the responsibility of the authors.

@&#REFERENCES@&#

