@&#MAIN-TITLE@&#Enhancing vehicle cornering limit through sideslip and yaw rate control

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Phase-plane analysis of direct yaw moment control based on yaw rate and sideslip.


                        
                        
                           
                           Two novel formulations of integrated yaw rate and sideslip angle control.


                        
                        
                           
                           Singular value decomposition and controllability analysis.


                        
                        
                           
                           Virtual and experimental validation of the controllers on a fully electric vehicle.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Direct yaw moment control

Fully electric vehicle

Yaw rate and sideslip control

Phase-plane analysis

Singular value decomposition

Enhanced Sport Mode

@&#ABSTRACT@&#


               
               
                  Fully electric vehicles with individually controlled drivetrains can provide a high degree of drivability and vehicle safety, all while increasing the cornering limit and the ‘fun-to-drive’ aspect. This paper investigates a new approach on how sideslip control can be integrated into a continuously active yaw rate controller to extend the limit of stable vehicle cornering and to allow sustained high values of sideslip angle. The controllability-related limitations of integrated yaw rate and sideslip control, together with its potential benefits, are discussed through the tools of multi-variable feedback control theory and non-linear phase-plane analysis. Two examples of integrated yaw rate and sideslip control systems are presented and their effectiveness is experimentally evaluated and demonstrated on a four-wheel-drive fully electric vehicle prototype. Results show that the integrated control system allows safe operation at the vehicle cornering limit at a specified sideslip angle independent of the tire-road friction conditions.
               
            

left front wheel

right front wheel

left rear wheel

right rear wheel

front axle

rear axle

a generic discrete parameter

front and rear semi-wheelbases

longitudinal acceleration

lateral acceleration

maximum reference value of lateral acceleration

process equation matrices in the extended Kalman filter

stiffness parameter of the brush-type model of the tires

damping ratio of the actuators

error vector

yaw rate error

sideslip angle error

first output singular vector, second output singular vector, singular vector matrix within the singular value decomposition of the sensitivity function

longitudinal tire force

lateral tire force

vertical tire force

static vertical load

plant transfer function

transfer function (with components 
                           
                              
                                 G
                              
                              
                                 
                                    
                                       M
                                    
                                    
                                       z
                                    
                                 
                                 
                                    ,
                                    r
                                 
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 
                                    
                                       M
                                    
                                    
                                       z
                                    
                                 
                                 
                                    ,
                                    β
                                 
                              
                           
                        ) from the actual yaw moment to vehicle states

transfer function (with components 
                           
                              
                                 G
                              
                              
                                 p
                                 ,
                                 r
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 p
                                 ,
                                 β
                              
                           
                        ) from the reference yaw moment to vehicle states

transfer function of the shaped plant

transfer function (with components 
                           
                              
                                 G
                              
                              
                                 δ
                                 ,
                                 r
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 δ
                                 ,
                                 β
                              
                           
                        ) from steering angle to vehicle states

measurement equation matrices of the extended Kalman filter

roll center height

vertical distance between center of gravity and roll center

identity matrix

imaginary unit

yaw mass moment of inertia

half-length of tire contact patch

slope for the increase of the reference yaw rate after the de-activation of the sideslip controller

suspension roll stiffness

control system matrix

parameter of the yaw rate correction algorithm

proportional gain

yaw rate controller


                        H
                        
                           ∞
                         optimal controller

sideslip angle controller

final controller formulation

vehicle wheelbase

vehicle mass

reference control yaw moment

actual yaw moment applied to the vehicle

yaw moment contribution related to yaw rate control

feedback part of M
                        
                           z,r
                        
                     

feedforward part of M
                        
                           z,r
                        
                     

yaw moment contribution related to sideslip control

threshold of 
                           
                              
                                 M
                              
                              
                                 z
                                 ,
                                 β
                              
                           
                         for activating the reference yaw rate ramp

stability derivatives in the yaw moment balance equation

yaw rate, yaw acceleration

yaw rate output from the look-up table

reference yaw rate

reference vector

worst reference direction, best reference direction, matrix with the worst and best reference directions according to the singular value decomposition

Laplace operator or abbreviation for second

closed-loop sensitivity function

slip ratio

time

track width

integral parameter

input and output complementary sensitivity functions

plant input

first output singular vector, second output singular vector, singular vector matrix within the plant singular value decomposition

vehicle speed

input singular vector of the plant

pre- and post- compensators

extended Kalman filter process and measurement noises

weighting factor for sideslip estimation

state vector

stability derivatives in the lateral force balance equation

output vector

slip angle and sliding limit slip angle

sideslip angle, sideslip rate

estimated sideslip angle

sideslip angle estimated by the extended Kalman filter

values of sideslip angle and sideslip rate at the equilibrium for the passive vehicle

values of sideslip angle and sideslip rate at the equilibrium for the controlled vehicle in Sport Mode

sideslip angle estimated through the integration method

activation parameters of the sideslip controller

peak value of sideslip angle

reference value of sideslip angle

sideslip control activation threshold

sideslip threshold

camber angle

steering angle

steering wheel angle

load transfer induced by the aerodynamic forces

load transfer caused by lateral acceleration

reference yaw rate correction and corresponding threshold

time step

offsets between the nominal activation thresholds and the actual activation and deactivation thresholds in the relay activation scheme of the sideslip controller

maximum robust stability margin

parameter of the brush-type model of the tyres

actual and estimated tire-road friction coefficient

minimum and maximum singular values

matrix resulting from the singular value decomposition of the plant

frequency

natural frequency of the actuators

cut-off frequency of the reference yaw rate

angular wheel speed

@&#INTRODUCTION@&#

Fully electric vehicles with individually controlled electric motor drives provide significant benefits in terms of vehicle cornering response. In particular, the control of the left-to-right and front-to-rear wheel torque distributions, also called torque-vectoring or direct yaw moment control, has been shown to be beneficial in: i) shaping the understeer characteristic (i.e., the graph of steering wheel angle against lateral acceleration) [1,2] in quasi-static conditions (i.e., when driver inputs are slowly changing), including non-zero longitudinal accelerations; and ii) enhancing the transient cornering response through the reduction of the delays between steering wheel angle and yaw rate, the decrease of the yaw rate and sideslip overshoots, and the increase of the yaw rate damping [1]. With respect to ii), the precise controllability of the individual wheel torques, together with the higher bandwidth typical of electric motor drives and their capability of generating both positive and negative torques, allows better dynamic performance in comparison with conventional stability control systems based on the actuation of the friction brakes [3,4].

Several controllers have been proposed for the direct yaw moment control of fully electric vehicles with multiple motors, such as proportional integral derivative (PID) controllers running in parallel with non-linear feedforward contributions [1], linear quadratic regulators [5,6], and various configurations of sliding mode control [7,8], each of them with specific advantages and disadvantages. From the viewpoint of the low-level controllers for allocating the wheel torques, some authors propose energy-efficient wheel torque distribution criteria for the generation of the reference yaw moment and total wheel torque demand [2,9]. Despite the substantial amount of research, a consensus among the experts regarding the ideal control structure for implementing continuous torque-vectoring control in fully electric vehicles does not currently exist.

With respect to sideslip control, various control structures [5,6,10] have been presented for the concurrent control of yaw rate and sideslip angle, in which sideslip control is used for vehicle stabilization purposes, either continuously or only in emergency conditions, especially if the tire-road friction coefficient estimation [11–14] (required for yaw rate control) is not accurate. In some of these applications a reference sideslip angle of 0 deg is used, whilst in other cases the sideslip controller intervenes only when a sideslip angle threshold (sometimes variable with sideslip rate) is reached. Ref. [15] uses model predictive control for actuating an active steering system (and not a torque-vectoring controller as in this paper) in order to limit vehicle sideslip in emergency conditions. On the other hand, in a recent study on a torque-vectoring controller for a fully electric vehicle [16], the author states that the “lateral velocity or sideslip angle are not considered as controlled outputs because it is not possible to control the yaw rate and the sideslip angle independently, using only the yaw moment. Trying to control both properties leads to a functionally uncontrollable system with uncontrollable directions. Controlling the lateral velocity (or the sideslip angle) and the yaw rate is possible only by including an additional device like an active steering system.” Hence, the potential benefits of concurrent yaw rate and sideslip control for electric vehicles with multiple motors are to be further investigated. In this respect, one of the main contributions of this paper is to explore the possibilities of a driving mode created through the torque-vectoring capability of a high-performance four-wheel-drive vehicle that purposely induces sustained significant values of sideslip angle to provide an enhanced/controlled driving experience at the vehicle’s cornering limit.
                        1
                     
                     
                        1
                        The development and experimental demonstration of novel, easy-to-tune, industrially-oriented and computationally efficient torque-vectoring controllers for generating and maintaining high values of sideslip angle, was a requirement of the car makers of the European Union FP7 consortium E-VECTOORC [17].
                     
                  

From a theoretical viewpoint, phase-plane methodologies (e.g., [18,19]) allow comprehensive characterization of the dynamic response of a non-linear system and as such are well suited for this study. These analysis techniques use simplified linear and non-linear models to derive either the phase-plane of sideslip rate as a function of sideslip angle, or the phase-plane of yaw rate as a function of sideslip angle. To date, phase-plane analysis has been used for passive vehicles (i.e., without any controller) or vehicles with active steering systems; the investigation of the response of a vehicle with combined yaw rate and sideslip torque-vectoring control through the phase-plane technique represents a further contribution of this paper. The phase-plane analysis will be used to demonstrate the significant benefits associated with the integrated control of yaw rate and sideslip angle with respect to yaw rate control only, in terms of extension of the vehicle stability region in cornering conditions on the phase-plane of sideslip rate as a function of sideslip angle.

In summary, the objectives of the paper are:
                        
                           i)
                           The development of a specific driving mode, called ‘Enhanced Sport Mode’, purposely inducing large and controlled values of sideslip angle;

The development and analysis of two controllers, respectively based on the combination of proportional integral derivative and feedforward control (denoted as PID+FF), and on H
                              
                                 ∞
                               loop-shaping, for the implementation of the novel driving mode in i);

The analysis of the extension of the cornering limit achievable through the proposed approach;

The simulation-based assessment and experimental demonstration of the performance of the controllers on a fully electric vehicle prototype with four individually controlled electric drivetrains.

The electric vehicle demonstrator used in this study has a four-wheel-drive layout. To capture the particular characteristics the vehicle model combines a non-linear model of the sprung and unsprung masses, implemented with IPG CarMaker, with a detailed model of the four on-board electric drivetrains, implemented in Matlab-Simulink, mainly focused on the torsional dynamics of the half-shafts. The CarMaker model includes a non-linear tire model based on the Pacejka Magic Formula with relaxation dynamics. The two models run together in a co-simulation scheme. Examples of experimental validation in quasi-static and transient conditions are shown in [1].

A simplified non-linear vehicle model is used for the phase-plane analysis of the yaw rate and sideslip angle controllers. The model formulation is based on the yaw moment and lateral force balance equations:
                           
                              (1)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      z
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   ̇
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   =
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ,
                                                            
                                                            
                                                               LF
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         )
                                                         +
                                                      
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ,
                                                            
                                                            
                                                               RF
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                
                                                   a
                                                
                                                
                                                   −
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ,
                                                            
                                                            
                                                               LR
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         )
                                                         +
                                                      
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ,
                                                            
                                                            
                                                               RR
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                
                                                   b
                                                
                                                
                                                   +
                                                
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      z
                                                   
                                                
                                                
                                                   (
                                                
                                                
                                                   t
                                                
                                                
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   mv
                                                
                                                
                                                   (
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         (
                                                         
                                                            t
                                                         
                                                         )
                                                      
                                                      
                                                         +
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         ̇
                                                      
                                                      
                                                         (
                                                         
                                                            t
                                                         
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         LF
                                                      
                                                   
                                                
                                                
                                                   (
                                                
                                                
                                                   t
                                                
                                                
                                                   )
                                                   +
                                                
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         RF
                                                      
                                                   
                                                
                                                
                                                   (
                                                
                                                
                                                   t
                                                
                                                
                                                   )
                                                
                                                
                                                   
                                                      
                                                         +
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         LR
                                                      
                                                   
                                                
                                                
                                                   (
                                                
                                                
                                                   t
                                                
                                                
                                                   )
                                                   +
                                                
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         RR
                                                      
                                                   
                                                
                                                
                                                   (
                                                
                                                
                                                   t
                                                
                                                
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

According to the common hypotheses for this kind of phase-plane implementations, vehicle velocity is considered to be constant. The lateral forces for each wheel, 
                           
                              
                                 F
                              
                              
                                 y
                              
                           
                        , are modeled through the Pacejka Magic Formula:
                           
                              (2)
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                    
                                    
                                       t
                                    
                                    
                                       )
                                       =
                                    
                                    
                                       
                                          F
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             ,
                                          
                                          
                                             SR
                                          
                                          
                                             ,
                                          
                                          
                                             γ
                                          
                                          
                                             ,
                                          
                                          
                                             
                                                F
                                             
                                             
                                                z
                                             
                                          
                                          
                                             ,
                                          
                                          
                                             μ
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

The non-linear model considers the load transfers among the four wheels arising from aerodynamic effects (usually negligible in practical terms) and lateral acceleration in cornering conditions:
                           
                              (3)
                              
                                 
                                    F
                                    
                                       z
                                       ,
                                       L
                                       F
                                    
                                 
                                 =
                                 
                                    F
                                    
                                       z
                                       ,
                                       S
                                       T
                                       A
                                       T
                                       I
                                       C
                                       ,
                                       L
                                       F
                                    
                                 
                                 −
                                 
                                    
                                       ∆
                                       
                                          F
                                          
                                             z
                                             ,
                                             A
                                             E
                                             R
                                             O
                                             ,
                                             F
                                          
                                       
                                    
                                    2
                                 
                                 +
                                 ∆
                                 
                                    F
                                    
                                       z
                                       ,
                                       
                                          a
                                          y
                                       
                                       ,
                                       F
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    F
                                    
                                       z
                                       ,
                                       R
                                       F
                                    
                                 
                                 =
                                 
                                    F
                                    
                                       z
                                       ,
                                       S
                                       T
                                       A
                                       T
                                       I
                                       C
                                       ,
                                       R
                                       F
                                    
                                 
                                 −
                                 
                                    
                                       ∆
                                       
                                          F
                                          
                                             z
                                             ,
                                             A
                                             E
                                             R
                                             O
                                             ,
                                             F
                                          
                                       
                                    
                                    2
                                 
                                 −
                                 ∆
                                 
                                    F
                                    
                                       z
                                       ,
                                       
                                          a
                                          y
                                       
                                       ,
                                       F
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    F
                                    
                                       z
                                       ,
                                       L
                                       R
                                    
                                 
                                 =
                                 
                                    F
                                    
                                       z
                                       ,
                                       S
                                       T
                                       A
                                       T
                                       I
                                       C
                                       ,
                                       L
                                       R
                                    
                                 
                                 +
                                 
                                    
                                       ∆
                                       
                                          F
                                          
                                             z
                                             ,
                                             A
                                             E
                                             R
                                             O
                                             ,
                                             R
                                          
                                       
                                    
                                    2
                                 
                                 +
                                 ∆
                                 
                                    F
                                    
                                       z
                                       ,
                                       
                                          a
                                          y
                                       
                                       ,
                                       R
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    F
                                    
                                       z
                                       ,
                                       R
                                       R
                                    
                                 
                                 =
                                 
                                    F
                                    
                                       z
                                       ,
                                       S
                                       T
                                       A
                                       T
                                       I
                                       C
                                       ,
                                       R
                                       R
                                    
                                 
                                 +
                                 
                                    
                                       ∆
                                       
                                          F
                                          
                                             z
                                             ,
                                             A
                                             E
                                             R
                                             O
                                             ,
                                             R
                                          
                                       
                                    
                                    2
                                 
                                 −
                                 ∆
                                 
                                    F
                                    
                                       z
                                       ,
                                       
                                          a
                                          y
                                       
                                       ,
                                       R
                                    
                                 
                              
                           
                        where the load transfer caused by 
                           
                              
                                 a
                              
                              
                                 y
                              
                           
                         is estimated through the following steady-state formulas:
                           
                              (7)
                              
                                 
                                    ∆
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          z
                                       
                                       
                                          ,
                                       
                                       
                                          
                                             a
                                          
                                          
                                             y
                                          
                                       
                                       
                                          ,
                                       
                                       
                                          F
                                       
                                    
                                 
                                 
                                    =
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          
                                             a
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             F
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   RC
                                                
                                             
                                          
                                          
                                             
                                                L
                                             
                                          
                                       
                                       
                                          +
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   
                                                      ROLL
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      F
                                                   
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   ROLL
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   
                                                      ROLL
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      F
                                                   
                                                
                                             
                                             
                                                +
                                             
                                             
                                                
                                                   k
                                                
                                                
                                                   
                                                      ROLL
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    ∆
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          z
                                       
                                       
                                          ,
                                       
                                       
                                          
                                             a
                                          
                                          
                                             y
                                          
                                       
                                       
                                          ,
                                       
                                       
                                          R
                                       
                                    
                                 
                                 
                                    =
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          
                                             a
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             R
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   RC
                                                
                                             
                                          
                                          
                                             
                                                L
                                             
                                          
                                       
                                       
                                          +
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   
                                                      ROLL
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   ROLL
                                                
                                             
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   
                                                      ROLL
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      F
                                                   
                                                
                                             
                                             
                                                +
                                             
                                             
                                                
                                                   k
                                                
                                                
                                                   
                                                      ROLL
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     

The simplified non-linear model is run for assigned constant values of steering wheel angle, 
                           
                              
                                 δ
                              
                              
                                 SW
                              
                           
                        , and vehicle speed, 
                           
                              v
                           
                        , with a set of initial conditions in terms of sideslip angle, 
                           
                              β
                           
                        , and yaw rate, 
                           
                              r
                           
                        . The outputs of the simulation runs are the trajectories of 
                           
                              
                                 β
                              
                              ̇
                           
                         as a function of 
                           
                              β
                           
                        . For example, 
                        Fig. 1 is the phase-plane plot at 
                           
                              v
                              =
                              90
                           
                         km/h and 
                           
                              
                                 
                                    δ
                                 
                                 
                                    SW
                                 
                              
                              
                                 =
                                 50
                              
                           
                         deg. For the whole set of initial conditions (indicated by the open circles in the Figure) the system shows convergence to the equilibrium point 
                           
                              
                                 
                                    β
                                    
                                       e
                                       q
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                       ̇
                                    
                                    
                                       e
                                       q
                                    
                                 
                              
                           
                           =
                           
                              
                                 −
                                 5.2
                                 
                                 deg
                                 ,
                                 0
                              
                           
                        . However, many of the initial conditions are associated with trajectories characterized by an initial significant increment of 
                           
                              |
                              
                                 β
                              
                              |
                           
                         (>40deg), and can be considered unstable from the practical viewpoint of the vehicle user.

A linearized single-track model is used for designing the controllers (PID + FF and H
                        
                           ∞
                        ), with two variables, 
                           
                              r
                           
                         and 
                           
                              β
                           
                        , being the controlled outputs. By re-arranging Eq. (1), the single-track model equations are:
                           
                              (9)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      z
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   ̇
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      β
                                                   
                                                
                                                
                                                   β
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   +
                                                
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   r
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   +
                                                
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      δ
                                                   
                                                
                                                
                                                   δ
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   +
                                                
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      z
                                                   
                                                
                                                
                                                   (
                                                
                                                
                                                   t
                                                
                                                
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   mv
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         (
                                                         
                                                            t
                                                         
                                                         )
                                                      
                                                      
                                                         +
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         ̇
                                                      
                                                      
                                                         (
                                                         
                                                            t
                                                         
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      β
                                                   
                                                
                                                
                                                   β
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   +
                                                
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   r
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   +
                                                
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      δ
                                                   
                                                
                                                
                                                   δ
                                                
                                                
                                                   (
                                                
                                                
                                                   t
                                                
                                                
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Eq. (9) is converted into a transfer function form:
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                β
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    G
                                    
                                       M
                                       z
                                    
                                 
                                 
                                    s
                                 
                                 
                                    M
                                    z
                                 
                                 
                                    s
                                 
                                 +
                                 
                                    G
                                    δ
                                 
                                 (
                                 s
                                 )
                                 δ
                                 (
                                 s
                                 )
                              
                           
                        with
                           
                              (11)
                              
                                 
                                    G
                                    
                                       M
                                       z
                                    
                                 
                                 
                                    s
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                   
                                                      
                                                         M
                                                         z
                                                      
                                                      ,
                                                      r
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   G
                                                   
                                                      
                                                         M
                                                         z
                                                      
                                                      ,
                                                      β
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    G
                                    δ
                                 
                                 
                                    s
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                   
                                                      δ
                                                      ,
                                                      r
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   G
                                                   
                                                      δ
                                                      ,
                                                      β
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where:
                           
                              (12)
                              
                                 
                                    G
                                    
                                       
                                          M
                                          z
                                       
                                       ,
                                       r
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       m
                                       v
                                       s
                                       −
                                       
                                          Y
                                          β
                                       
                                    
                                    
                                       
                                          J
                                          z
                                       
                                       m
                                       v
                                       
                                          s
                                          2
                                       
                                       −
                                       
                                          
                                             
                                                J
                                                z
                                             
                                             
                                                Y
                                                β
                                             
                                             +
                                             
                                                N
                                                r
                                             
                                             m
                                             v
                                          
                                       
                                       s
                                       −
                                       
                                          N
                                          β
                                       
                                       
                                          Y
                                          r
                                       
                                       +
                                       
                                          N
                                          β
                                       
                                       m
                                       v
                                       +
                                       
                                          N
                                          r
                                       
                                       
                                          Y
                                          β
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    G
                                    
                                       δ
                                       ,
                                       r
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          J
                                          z
                                       
                                       
                                          Y
                                          δ
                                       
                                       s
                                       +
                                       
                                          Y
                                          r
                                       
                                       
                                          N
                                          δ
                                       
                                       −
                                       
                                          Y
                                          δ
                                       
                                       
                                          N
                                          r
                                       
                                       −
                                       m
                                       v
                                       
                                          N
                                          δ
                                       
                                    
                                    
                                       
                                          J
                                          z
                                       
                                       m
                                       v
                                       
                                          s
                                          2
                                       
                                       −
                                       
                                          
                                             
                                                J
                                                z
                                             
                                             
                                                Y
                                                β
                                             
                                             +
                                             
                                                N
                                                r
                                             
                                             m
                                             v
                                          
                                       
                                       s
                                       −
                                       
                                          N
                                          β
                                       
                                       
                                          Y
                                          r
                                       
                                       +
                                       
                                          N
                                          β
                                       
                                       m
                                       v
                                       +
                                       
                                          N
                                          r
                                       
                                       
                                          Y
                                          β
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    G
                                    
                                       
                                          M
                                          z
                                       
                                       ,
                                       β
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          Y
                                          r
                                       
                                       −
                                       m
                                       v
                                    
                                    
                                       
                                          J
                                          z
                                       
                                       m
                                       v
                                       
                                          s
                                          2
                                       
                                       −
                                       
                                          
                                             
                                                J
                                                z
                                             
                                             
                                                Y
                                                β
                                             
                                             +
                                             
                                                N
                                                r
                                             
                                             m
                                             v
                                          
                                       
                                       s
                                       −
                                       
                                          N
                                          β
                                       
                                       
                                          Y
                                          r
                                       
                                       +
                                       
                                          N
                                          β
                                       
                                       m
                                       v
                                       +
                                       
                                          N
                                          r
                                       
                                       
                                          Y
                                          β
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    G
                                    
                                       δ
                                       ,
                                       β
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          N
                                          δ
                                       
                                       m
                                       v
                                       s
                                       +
                                       
                                          N
                                          β
                                       
                                       
                                          Y
                                          δ
                                       
                                       −
                                       
                                          N
                                          δ
                                       
                                       
                                          Y
                                          β
                                       
                                    
                                    
                                       
                                          J
                                          z
                                       
                                       m
                                       v
                                       
                                          s
                                          2
                                       
                                       −
                                       
                                          
                                             
                                                J
                                                z
                                             
                                             
                                                Y
                                                β
                                             
                                             +
                                             
                                                N
                                                r
                                             
                                             m
                                             v
                                          
                                       
                                       s
                                       −
                                       
                                          N
                                          β
                                       
                                       
                                          Y
                                          r
                                       
                                       +
                                       
                                          N
                                          β
                                       
                                       m
                                       v
                                       +
                                       
                                          N
                                          r
                                       
                                       
                                          Y
                                          β
                                       
                                    
                                 
                              
                           
                        
                     

The stability derivatives are functions of the front and rear axle cornering stiffnesses.

As an electric drivetrain is typically poorly damped, the actuator dynamics should also be considered in the loop when designing the controller. Based on experimental torque sweep tests and tip-in tests (presented in more detail in [1]), a second order model is employed to represent the dynamics between the demanded yaw moment, 
                           
                              
                                 M
                              
                              
                                 z
                              
                           
                        , and the actual yaw moment applied to the vehicle, 
                           
                              
                                 M
                              
                              
                                 z
                                 ,
                                 actual
                              
                           
                        :
                           
                              (16)
                              
                                 
                                    G
                                    a
                                 
                                 
                                    s
                                 
                                 =
                                 
                                    
                                       M
                                       
                                          z
                                          ,
                                          actual
                                       
                                    
                                    
                                       M
                                       z
                                    
                                 
                                 
                                    s
                                 
                                 =
                                 
                                    
                                       ω
                                       na
                                       2
                                    
                                    
                                       
                                          s
                                          2
                                       
                                       +
                                       2
                                       
                                          D
                                          a
                                       
                                       
                                          ω
                                          na
                                       
                                       s
                                       +
                                       
                                          ω
                                          na
                                          2
                                       
                                    
                                 
                              
                           
                        where 
                           
                              ω
                              
                                 n
                                 a
                              
                           
                         and 
                           
                              D
                              a
                           
                         are approximated at 8Hz and 0.2, respectively. By integrating the actuator model with the single-track vehicle model, the overall model for designing the controller is:
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                β
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    G
                                    p
                                 
                                 
                                    s
                                 
                                 
                                    M
                                    z
                                 
                                 
                                    s
                                 
                                 +
                                 
                                    G
                                    δ
                                 
                                 (
                                 s
                                 )
                                 δ
                                 (
                                 s
                                 )
                              
                           
                        where:
                           
                              (18)
                              
                                 
                                    G
                                    p
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                   
                                                      p
                                                      ,
                                                      r
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   G
                                                   
                                                      p
                                                      ,
                                                      β
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                   
                                                      
                                                         M
                                                         z
                                                      
                                                      ,
                                                      r
                                                   
                                                
                                                (
                                                s
                                                )
                                                
                                                   G
                                                   a
                                                
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   G
                                                   
                                                      
                                                         M
                                                         z
                                                      
                                                      ,
                                                      β
                                                   
                                                
                                                (
                                                s
                                                )
                                                
                                                   G
                                                   a
                                                
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           
                              
                                 
                                    G
                                 
                                 
                                    p
                                 
                              
                              
                                 (
                                 s
                                 )
                              
                           
                         is the main transfer function for designing the feedback controller, as it relates the control input (i.e., 
                           
                              
                                 M
                              
                              
                                 z
                              
                           
                        ) and outputs (i.e., 
                           
                              r
                           
                         and 
                           
                              β
                           
                        ). 
                           
                              
                                 
                                    G
                                 
                                 
                                    δ
                                 
                              
                              
                                 (
                                 s
                                 )
                              
                           
                         contains the information of how the disturbance affects the system (the driver׳s steering wheel input is a disturbance during the control system design), however it has no direct influence on the closed-loop performance.

The values of cornering stiffness in the single-track vehicle model are selected for the vehicle operating in critical conditions, i.e., with a large steady-state 
                           
                              
                                 a
                              
                              
                                 y
                              
                           
                         (8.7m/s2). Owing to the criticality of large lateral acceleration conditions, a design for the cornering limit will allow the controller to cope with less demanding cornering conditions as well. This is especially relevant for the H
                        
                           ∞
                         design approach, characterized by favorable robustness properties. In the following section the vehicle is considered to operate at 90km/h and the model for control system design is parameterized for this velocity. For other speeds, the controller needs to be redesigned, as the overall system dynamics are functions of 
                           
                              v
                           
                        . In the vehicle implementation phase, the corresponding controller can be chosen based on the estimated vehicle speed by using a gain scheduling approach, as described in [20]. The gain scheduling scheme should adopt a bumpless transfer design, to ensure that the switching between the controllers does not create undesirable transients.

This section presents the design of the feedback controllers for continuous reference yaw rate tracking, and sideslip tracking when the sideslip angle is beyond assigned thresholds. The control problem is formulated into a multivariable control framework with one input (i.e., 
                        
                           
                              M
                           
                           
                              z
                           
                        
                     ) and two outputs (i.e., 
                        
                           r
                        
                      and 
                        
                           β
                        
                     ) of the controlled plant (
                     Fig. 2). The yaw moment consists of two contributions; the first one is from the yaw rate controller and the second one is from the sideslip controller.

The aim of the yaw rate controller is to continuously shape the understeer characteristic, i.e., the diagram of 
                        
                           
                              δ
                           
                           
                              SW
                           
                        
                      as a function of 
                        
                           
                              a
                           
                           
                              y
                           
                        
                     . The procedure for the definition of the look-up tables of the steady-state reference yaw rate, 
                        
                           
                              
                                 r
                              
                              
                                 LUT
                              
                           
                           
                              =
                           
                           
                              
                                 r
                              
                              
                                 LUT
                              
                           
                           
                              (
                              
                                 
                                    
                                       δ
                                    
                                    
                                       SW
                                    
                                 
                                 
                                    ,
                                    v
                                    ,
                                 
                                 
                                    
                                       a
                                    
                                    
                                       x
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       μ
                                    
                                    ^
                                 
                              
                              )
                           
                        
                     , is explained in [1]. With this approach, the vehicle can be set up with different driving modes on-the-fly. For example, in [1] a Sport Mode is implemented, which, compared to the passive vehicle, has a reduced understeer gradient, a wider region of linear vehicle response and a greater maximum lateral acceleration, 
                        
                           
                              a
                           
                           
                              y
                              ,
                              max
                           
                        
                     . The Sport Mode is designed so that 
                        
                           
                              a
                           
                           
                              y
                              ,
                              max
                           
                        
                      stays within the available friction limits and is associated with a stable constant value of 
                        
                           β
                        
                     .

As an extension, the Enhanced Sport Mode is proposed in this paper, which is purposely designed to provoke a progressive increase of 
                        
                           β
                        
                      by raising the maximum values of 
                        
                           
                              r
                           
                           
                              LUT
                           
                        
                      (and implicitly 
                        
                           
                              a
                           
                           
                              y
                              ,
                              max
                           
                        
                     ) for each 
                        
                           v
                        
                      and 
                        
                           
                              μ
                           
                           ^
                        
                     . To control and limit the increasing sideslip angle at a desired threshold 
                        
                           
                              β
                           
                           
                              th
                           
                        
                     , the sideslip contribution of the controller is activated. In most cases when 
                        
                           |
                           
                              β
                              (
                              t
                              )
                           
                           |
                        
                        
                           <
                        
                        
                           
                              β
                           
                           
                              th
                           
                        
                     , only the yaw rate controller is active. In such case the tracking error of sideslip angle, 
                        
                           
                              e
                           
                           
                              β
                           
                        
                     , is set to zero and does not contribute to the yaw moment demand. When 
                        
                           |
                           
                              β
                              (
                              t
                              )
                           
                           |
                        
                        
                           ≥
                        
                        
                           
                              β
                           
                           
                              th
                           
                        
                     , 
                        
                           
                              e
                           
                           
                              β
                           
                        
                      becomes non-zero and the sideslip angle-related portion of the yaw moment starts forcing 
                        
                           β
                        
                      towards its reference value. In the meantime 
                        
                           r
                        
                      deviates from 
                        
                           
                              r
                           
                           
                              ref
                           
                        
                     .

The next sub-sections will focus on:
                        
                           i)
                           The definition of the variable thresholds for activating and de-activating the sideslip contribution of the controller;

The design of the H
                              
                                 ∞
                               loop-shaping controller and the PID + FF controller;

The controllability analysis of the system.

Two activation schemes of the sideslip control contribution are proposed: firstly, a variable threshold activation scheme, and secondly, a constant threshold activation scheme.

According to the activation scheme with variable threshold, the activation condition of the sideslip controller is based on the boundaries in the 
                           
                              
                                 
                                    β
                                 
                                 ̇
                              
                              
                                 (
                                 
                                    β
                                 
                                 )
                              
                           
                         phase-plane shown in 
                        Fig. 3. The continuous lines in Fig. 3 are the nominal stability boundaries according to phase-plane analyzes (e.g., Fig. 1). When the vehicle is within the boundaries, it is considered to be stable; when it operates outside the limits, the vehicle is considered unstable. The intersections between the continuous lines and the axes identify the nominal threshold values for sideslip angle and sideslip rate, which are referred to as 
                           
                              
                                 β
                              
                              
                                 max
                              
                           
                        , 
                           
                              
                                 β
                              
                              
                                 min
                              
                           
                        , 
                           
                              
                                 
                                    
                                       β
                                    
                                    ̇
                                 
                              
                              
                                 max
                              
                           
                        , and 
                           
                              
                                 
                                    
                                       β
                                    
                                    ̇
                                 
                              
                              
                                 min
                              
                           
                        . To guard against chattering a relay-based algorithm is included for the activation and deactivation of the controller, where the actual thresholds are defined with an offset (according to the dashed lines in Fig. 3) with respect to the nominal stability boundaries. For instance, in the right part of Fig. 3, the activation conditions are:
                           
                              (19)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   >
                                                
                                                
                                                   
                                                      
                                                         ∆
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                   
                                                      vert
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   ̇
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   >
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               ̇
                                                            
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                      
                                                         +
                                                         ∆
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         ̇
                                                      
                                                   
                                                   )
                                                
                                                
                                                   −
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               ̇
                                                            
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                      
                                                         +
                                                         ∆
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         ̇
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                      
                                                         +
                                                         ∆
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                
                                                
                                                   β
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with 
                           
                              ∆
                              β
                              =
                              
                                 
                                    
                                       (
                                       ∆
                                       
                                          β
                                          ̇
                                       
                                       +
                                       
                                          
                                             β
                                             ̇
                                          
                                          
                                             m
                                             a
                                             x
                                          
                                       
                                       )
                                    
                                    
                                       β
                                       
                                          m
                                          a
                                          x
                                       
                                    
                                 
                                 
                                    
                                       β
                                       ̇
                                    
                                    
                                       m
                                       a
                                       x
                                    
                                 
                              
                              −
                              
                                 β
                                 
                                    m
                                    a
                                    x
                                 
                              
                           
                        . The deactivation conditions are:
                           
                              (20)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   <
                                                   −
                                                
                                                
                                                   
                                                      
                                                         ∆
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                   
                                                      vert
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   ̇
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   <
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               ̇
                                                            
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                      
                                                         −
                                                         ∆
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         ̇
                                                      
                                                   
                                                   )
                                                
                                                
                                                   −
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               ̇
                                                            
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                      
                                                         −
                                                         ∆
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         ̇
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                      
                                                         −
                                                         ∆
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                
                                                
                                                   β
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Once the sideslip controller is active, the sideslip angle error for 
                           
                              β
                              >
                              0
                           
                         is calculated as:
                           
                              (21)
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          β
                                       
                                    
                                    
                                       =
                                    
                                    
                                       MAX
                                    
                                    
                                       (
                                       
                                          
                                             −
                                             ∆
                                          
                                          
                                             
                                                β
                                             
                                             
                                                vert
                                             
                                          
                                          
                                             ;
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         −
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            ̇
                                                         
                                                      
                                                   
                                                   
                                                      max
                                                   
                                                
                                                
                                                   +
                                                   ∆
                                                
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                                
                                                   +
                                                
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                                
                                                   (
                                                   
                                                      t
                                                   
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      max
                                                   
                                                
                                                
                                                   −
                                                   ∆
                                                
                                                
                                                   β
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            ̇
                                                         
                                                      
                                                   
                                                   
                                                      max
                                                   
                                                
                                                
                                                   −
                                                   ∆
                                                
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       −
                                    
                                    
                                       β
                                    
                                    
                                       (
                                       
                                          t
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

In the case of sideslip control with a constant threshold 
                           
                              
                                 
                                    β
                                 
                                 
                                    th
                                 
                              
                           
                        , the error is: 
                           
                              
                                 
                                    e
                                 
                                 
                                    β
                                 
                              
                              
                                 =
                              
                              
                                 
                                    β
                                 
                                 
                                    ref
                                 
                              
                              
                                 (
                                 
                                    t
                                 
                                 )
                              
                              
                                 −
                              
                              
                                 β
                              
                              
                                 (
                                 
                                    t
                                 
                                 )
                              
                           
                        , with 
                           
                              
                                 
                                    β
                                 
                                 
                                    ref
                                 
                              
                              
                                 (
                                 
                                    t
                                 
                                 )
                              
                           
                         defined as:
                           
                              (22)
                              
                                 {
                                 
                                    
                                       
                                          
                                             β
                                             
                                                r
                                                e
                                                f
                                             
                                          
                                          
                                             t
                                          
                                          =
                                          β
                                          
                                             t
                                          
                                          ,
                                          i
                                          f
                                          |
                                          β
                                          
                                             t
                                          
                                          |
                                          <
                                          
                                             β
                                             
                                                t
                                                h
                                             
                                          
                                          ,
                                          sideslip
                                          
                                          controller
                                          
                                          inactive
                                       
                                    
                                    
                                       
                                          
                                          
                                             β
                                             
                                                r
                                                e
                                                f
                                             
                                          
                                          
                                             t
                                          
                                          =
                                          
                                             β
                                             
                                                t
                                                h
                                             
                                          
                                          ,
                                          i
                                          f
                                          |
                                          β
                                          
                                             t
                                          
                                          |
                                          ≥
                                          
                                             β
                                             
                                                t
                                                h
                                             
                                          
                                          ,
                                          sideslip
                                          
                                          controller
                                          
                                          active
                                       
                                    
                                 
                              
                           
                        
                     

The selection of the numerical values of the activation thresholds and sideslip reference parameters is based on the outputs of phase-plane stability analyzes, and can be parameterized as a function of the vehicle operating conditions (e.g., steering wheel angle, torque demand, tire-road friction coefficient), so that the sideslip contribution of the controller intervenes only when it is strictly required. This aspect will be the subject of further research and is one of the main benefits of the proposed approach, with respect to the existing integrated feedback controllers for yaw rate and sideslip control.

Two PI regulators are applied for synthesizing the PID+FF scheme; one for yaw rate control and a second one for sideslip control. The parameters of the yaw rate controller are based on the Bode diagram analysis approach. The design procedure shows that it is possible to achieve phase margin exceeding 90 deg and gain margin of ≅3, which are sufficient for robust design. The sideslip controller is tuned to achieve satisfactory performance through simulations with the non-linear CarMaker model. Bode diagram-based methods cannot be used for sideslip control design, as these are only suitable for single-input single-output control systems. When the sideslip controller is activated, the yaw moment is regulated to control both yaw rate and sideslip angle, which is a single-input multiple-output problem.

As more advanced alternative, the multivariable robust design approach H
                        
                           ∞
                         loop-shaping is employed to design the two-input single-output controller. It includes three steps [20]:
                           
                              
                                 Step i) Selection of the elements of the diagonal pre- and post-compensators, 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             1
                                          
                                       
                                       
                                          ∈
                                       
                                       
                                          
                                             R
                                          
                                          
                                             1
                                             ×
                                             1
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             2
                                          
                                       
                                       
                                          ∈
                                       
                                       
                                          
                                             R
                                          
                                          
                                             2
                                             ×
                                             2
                                          
                                       
                                    
                                 . The pre-compensator, 
                                    
                                       
                                          W
                                       
                                       
                                          1
                                       
                                    
                                 , is selected in the form of a PI filter. This typical choice of pre-compensator provides high gain at low frequencies (for good reference tracking) and low gain at high frequencies (for sensor noise rejection). The pre-compensator 
                                    
                                       
                                          W
                                       
                                       
                                          1
                                       
                                    
                                  of this study is:
                                    
                                       (23)
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   K
                                                
                                                
                                                   p
                                                
                                             
                                             
                                                (
                                                1
                                                +
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      s
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                             
                                                
                                                   K
                                                
                                                
                                                   p
                                                
                                             
                                             =
                                             436
                                             
                                             Nm/deg
                                             ,
                                             
                                             
                                                
                                                   T
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             1
                                             s
                                          
                                       
                                    
                                 
                              

The post-compensator, 
                                    
                                       
                                          W
                                       
                                       
                                          2
                                       
                                    
                                 , is used for defining the relative importance of the outputs to be controlled. In this design, more weight on 
                                    
                                       β
                                    
                                  is required in order to prioritize sideslip control for safety reasons when 
                                    
                                       β
                                    
                                  exceeds the limit. At this stage, the design of the feedback control system of the PID+FF controller is complete;


                                 Step ii) Robust stabilization of the shaped plant 
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                =
                                                W
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             1
                                          
                                       
                                    
                                 . In this step, the design is ‘robustified’ so that 
                                    
                                       
                                          G
                                       
                                       
                                          s
                                       
                                    
                                  tolerates as much coprime uncertainty as possible. The controller can be synthesized by directly solving the Riccati equations indicated in [20] without any design iteration. The resulting controller 
                                    
                                       
                                          K
                                       
                                       
                                          s
                                       
                                    
                                  has the same order as 
                                    
                                       
                                          G
                                       
                                       
                                          s
                                       
                                    
                                 , which is five for this study. The final controller to be implemented in the feedback loop is 
                                    
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   ∞
                                                
                                             
                                             
                                                =
                                                W
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             K
                                          
                                          
                                             s
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             2
                                          
                                       
                                    
                                 , which is of sixth order;


                                 Step iii) Implementation of the controller in the Haunts form [20] for allowing effective anti-windup of the integral terms.

As an indication of the level of robust stability of the designed controller, 
                        Table 1 reports the values of 
                           
                              ϵ
                              max
                           
                         (i.e., the maximum coprime uncertainty that can be tolerated before instability) for different values of the weight among the contributions 
                           
                              
                                 K
                              
                              
                                 r
                              
                           
                         and 
                           
                              
                                 K
                              
                              
                                 β
                              
                           
                        . The sub-controller 
                           
                              
                                 K
                              
                              
                                 r
                              
                           
                         in the synthesized controller 
                           
                              K
                           
                         can be solely used for yaw rate control. Its performance and robustness are degraded when using a large weight on β; the maximum stability margin degrades as the weight increases. However, with the selected weights, the values of 
                           
                              
                                 ϵ
                              
                              
                                 max
                              
                           
                         achieved by the H
                        
                           ∞
                         controller are larger than those achieved by using two PI controllers (i.e., one for yaw rate control and a second one for sideslip control, according to the PID+FF scheme), with gains selected according to the pre- and post-compensators adopted for H
                        
                           ∞
                         design. The weight selected for the control system implementation is 4, which gives a robust stability margin of 0.41 when using 
                           
                              
                                 K
                              
                              
                                 β
                              
                           
                         and 
                           
                              
                                 K
                              
                              
                                 r
                              
                           
                         together, and 0.58 when using 
                           
                              
                                 K
                              
                              
                                 r
                              
                           
                         alone. The simulation results also indicate that this weight allows satisfactory β-tracking performance. Hence, the post-compensator 
                           
                              
                                 W
                              
                              
                                 2
                              
                           
                         is:
                           
                              (24)
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          2
                                       
                                    
                                    
                                       =
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        
                     

The overall reference yaw moment is given by:
                           
                              (25)
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          z
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          M
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ,
                                          
                                          
                                             r
                                          
                                       
                                    
                                    
                                       +
                                    
                                    
                                       
                                          M
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ,
                                          
                                          
                                             β
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          M
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ,
                                          
                                          
                                             r
                                          
                                          
                                             ,
                                          
                                          
                                             FF
                                          
                                       
                                    
                                    
                                       +
                                    
                                    
                                       
                                          M
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ,
                                          
                                          
                                             r
                                          
                                          
                                             ,
                                          
                                          
                                             FB
                                          
                                       
                                    
                                    
                                       +
                                    
                                    
                                       
                                          M
                                       
                                       
                                          
                                             z
                                          
                                          
                                             ,
                                          
                                          
                                             β
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           
                              
                                 M
                              
                              
                                 
                                    z
                                 
                                 
                                    ,
                                 
                                 
                                    r
                                 
                                 
                                    ,
                                 
                                 
                                    FF
                                 
                              
                           
                         is the non-linear feedforward contribution of the reference yaw moment determined from a multi-dimensional look-up table, which is computed through an off-line optimization procedure based on a quasi-static vehicle model (see [1,2]). This contribution is not strictly required for controllers with a significant integral yaw rate component, and in the presented results was used only within the PID+FF controller.

With respect to the problem of yaw rate and sideslip control through torque-vectoring only, the system is controllable according to the Kalman’s controllability definition, i.e., the determinant of the controllability matrix is different from zero [20]. However, the system is functionally uncontrollable as the number of inputs is smaller than the number of outputs, which means that the two outputs (
                           
                              β
                           
                         and 
                           
                              r
                           
                        ) cannot be independently controlled. Therefore, a detailed analysis is required to understand the actual performance of the designed controller. To this purpose, the steady-state gain of 
                           
                              
                                 
                                    G
                                 
                                 
                                    p
                                 
                              
                              
                                 (
                                 s
                                 )
                              
                           
                         is calculated for the specific linearization point of the system and the resulting matrix 
                           
                              
                                 
                                    G
                                 
                                 
                                    p
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                           
                         is subject to singular value decomposition:
                           
                              (26)
                              
                                 
                                    
                                       G
                                    
                                    
                                       p
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   0.1550
                                                
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   0.1193
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ×
                                 
                                    
                                       10
                                    
                                    
                                       −
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            0.7925
                                                         
                                                      
                                                      
                                                         
                                                            0.6098
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            −
                                                            0.6098
                                                         
                                                      
                                                      
                                                         
                                                            0.7925
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       U
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            0.1955
                                                            ×
                                                            
                                                               
                                                                  10
                                                               
                                                               
                                                                  −
                                                                  4
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       Σ
                                    
                                 
                                 
                                    
                                       
                                          
                                             [
                                             1
                                             ]
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       
                                          
                                             V
                                          
                                          H
                                       
                                    
                                 
                              
                           
                        
                     

The first output singular vector 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           
                              =
                           
                           
                              [
                              
                                 
                                    
                                       
                                          
                                             0.7925
                                          
                                       
                                    
                                    
                                       
                                          
                                             −
                                             0.6098
                                          
                                       
                                    
                                 
                              
                              ]
                           
                         indicates in which output direction the plant can be most effectively controlled, while in the other direction 
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           
                              =
                           
                           
                              [
                              
                                 
                                    
                                       
                                          
                                             0.6098
                                          
                                       
                                    
                                    
                                       
                                          
                                             0.7925
                                          
                                       
                                    
                                 
                              
                              ]
                           
                         the plant cannot be controlled, as the corresponding element of 
                           
                              Σ
                           
                         is zero. This means that when a control input (i.e., 
                           
                              
                                 M
                              
                              
                                 z
                              
                           
                        ) is applied, the effect is to move the outputs in opposite directions.

The same conclusions can be drawn for the closed-loop performance, defined by the closed-loop sensitivity function 
                           
                              S
                              (
                              s
                              )
                           
                        :


                        
                           
                              (27)
                              
                                 
                                    S
                                 
                                 
                                    (
                                 
                                 
                                    s
                                 
                                 
                                    )
                                    =
                                 
                                 
                                    
                                       I
                                    
                                    
                                       
                                          I
                                       
                                       
                                          +
                                       
                                       
                                          
                                             G
                                          
                                          
                                             p
                                          
                                       
                                       
                                          (
                                       
                                       
                                          s
                                       
                                       
                                          )
                                       
                                       
                                          
                                             K
                                          
                                          
                                             ∞
                                          
                                       
                                       
                                          (
                                       
                                       
                                          s
                                       
                                       
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

For a reference tracking problem, 
                           
                              S
                              (
                              s
                              )
                           
                         represents the gain from the reference input to the tracking error 
                           
                              S
                           
                           
                              (
                              
                                 s
                              
                              )
                           
                           
                              =
                              e
                           
                           
                              (
                              
                                 s
                              
                              )
                           
                           
                              /
                              ref
                           
                           
                              (
                              
                                 s
                              
                              )
                           
                        . This gain depends on the direction of 
                           
                              ref
                           
                           
                              (
                              
                                 s
                              
                              )
                           
                         and is bounded by the maximum and minimum singular values of 
                           
                              S
                              
                                 (
                                 
                                    j
                                    ω
                                 
                                 )
                              
                           
                        , 
                           
                              
                                 σ
                                 ¯
                              
                              
                                 (
                                 
                                    S
                                    
                                       (
                                       
                                          j
                                          ω
                                       
                                       )
                                    
                                 
                                 )
                              
                           
                        , and 
                           
                              
                                 σ
                                 ̲
                              
                              (
                              S
                              (
                              j
                              ω
                              )
                              )
                           
                        , respectively. The worst-case direction of 
                           
                              ref
                           
                           
                              (
                              
                                 s
                              
                              )
                           
                         corresponds to 
                           
                              
                                 σ
                                 ¯
                              
                              
                                 (
                                 
                                    S
                                    
                                       (
                                       
                                          j
                                          ω
                                       
                                       )
                                    
                                 
                                 )
                              
                           
                         and the best-case direction corresponds to 
                           
                              
                                 σ
                                 ̲
                              
                              (
                              S
                              (
                              j
                              ω
                              )
                              )
                           
                        . In formulas:
                           
                              (28)
                              
                                 
                                    σ
                                    ̲
                                 
                                 (
                                 S
                                 (
                                 j
                                 ω
                                 )
                                 )
                                 ≤
                                 
                                    
                                       ‖
                                       e
                                       (
                                       ω
                                       )
                                       
                                          ‖
                                          2
                                       
                                    
                                    
                                       ‖
                                       r
                                       e
                                       f
                                       (
                                       ω
                                       )
                                       
                                          ‖
                                          2
                                       
                                    
                                 
                                 ≤
                                 
                                    σ
                                    ¯
                                 
                                 (
                                 S
                                 (
                                 j
                                 ω
                                 )
                                 )
                              
                           
                        
                     

In case of a controller with multiple outputs, the singular values of 
                           
                              S
                              
                                 (
                                 
                                    j
                                    ω
                                 
                                 )
                              
                           
                         are small at low frequency in order to obtain a small tracking error and they approach 1 at high frequencies. However, as shown in 
                        Fig. 4, 
                           
                              
                                 σ
                                 ¯
                              
                              
                                 (
                                 
                                    S
                                    
                                       (
                                       
                                          j
                                          ω
                                       
                                       )
                                    
                                 
                                 )
                              
                           
                         is not small (above 0dB) at low frequencies. Therefore, in the worst-case direction the system is uncontrollable. The singular value decomposition of the steady-state value of 
                           
                              S
                              
                                 (
                                 
                                    j
                                    ω
                                 
                                 )
                              
                           
                         is:
                           
                              (29)
                              
                                 
                                    S
                                 
                                 
                                    (
                                    
                                       0
                                    
                                    )
                                 
                                 
                                    =
                                 
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      0
                                                      .
                                                      9562
                                                   
                                                
                                                
                                                   
                                                      0
                                                      .
                                                      2927
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      .
                                                      2927
                                                   
                                                
                                                
                                                   
                                                      −
                                                      0
                                                      .
                                                      9562
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          E
                                       
                                       
                                          =
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   .
                                                   2268
                                                
                                             
                                             
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      0
                                                      .
                                                      6098
                                                   
                                                
                                                
                                                   
                                                      0
                                                      .
                                                      7925
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      .
                                                      7925
                                                   
                                                
                                                
                                                   
                                                      −
                                                      0
                                                      .
                                                      6098
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          R
                                       
                                       
                                          =
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        which confirms the best and worst directions already discussed for the singular values of the plant.

The robustness properties of the closed-loop system can be analyzed via the maximum singular values of the input and output complementary sensitivity functions, 
                           
                              
                                 T
                              
                              
                                 I
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 O
                              
                           
                        , indicating the robustness against the multiplicative input and output plant uncertainties, respectively:
                           
                              (30)
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          I
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          K
                                       
                                       
                                          ∞
                                       
                                    
                                    
                                       (
                                    
                                    
                                       s
                                    
                                    
                                       )
                                    
                                    
                                       
                                          G
                                       
                                       
                                          p
                                       
                                    
                                    
                                       (
                                    
                                    
                                       s
                                    
                                    
                                       )
                                       /
                                       (
                                    
                                    
                                       I
                                    
                                    
                                       +
                                    
                                    
                                       
                                          K
                                       
                                       
                                          ∞
                                       
                                    
                                    
                                       (
                                    
                                    
                                       s
                                    
                                    
                                       )
                                    
                                    
                                       
                                          G
                                       
                                       
                                          p
                                       
                                    
                                    
                                       (
                                    
                                    
                                       s
                                    
                                    
                                       )
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    T
                                    O
                                 
                                 =
                                 
                                    G
                                    p
                                 
                                 
                                    s
                                 
                                 
                                    K
                                    ∞
                                 
                                 (
                                 s
                                 )
                                 /
                                 (
                                 I
                                 +
                                 
                                    G
                                    p
                                 
                                 
                                    s
                                 
                                 
                                    K
                                    ∞
                                 
                                 (
                                 s
                                 )
                                 )
                              
                           
                        
                     

As shown in 
                        Fig. 5, 
                           
                              
                                 T
                              
                              
                                 I
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 O
                              
                           
                         stay below 0dB and reduce quickly at high frequencies, which indicates good robustness.

Based on the presented analysis, the co-existence of yaw rate and sideslip angle control in vehicles with torque-vectoring capability could be a matter of controversy. However, continuous yaw rate control needs the generation of a smooth reference yaw rate, which is a function of 
                           
                              
                                 μ
                              
                              ^
                           
                        . As 
                           
                              μ
                           
                         estimation is more difficult and slower than sideslip estimation and can be subject to significant oscillations even in constant friction conditions [11–14], the yaw rate controller on its own is not sufficient in practice. In particular, the sideslip controller must be designed to be dominant over the yaw rate controller once it is active. At the same time, a control structure with the two yaw moment contributions applied individually with a switching algorithm (i.e., with 
                           
                              
                                 M
                              
                              
                                 z
                                 ,
                                 β
                              
                           
                         off when 
                           
                              
                                 M
                              
                              
                                 z
                                 ,
                                 r
                              
                           
                         is on and vice versa) is not practical, as this could imply significant discontinuities of 
                           
                              
                                 M
                              
                              
                                 z
                              
                           
                        .

The experience of the authors is that the two controllers can easily co-exist if the integral contribution of 
                           
                              
                                 M
                              
                              
                                 z
                                 ,
                                 r
                                 ,
                                 FB
                              
                           
                         is relatively low and a reasonably high weight is assigned to the sideslip contribution. If the integral contribution of 
                           
                              
                                 M
                              
                              
                                 z
                                 ,
                                 r
                                 ,
                                 FB
                              
                           
                         is significant, the functional uncontrollability of the system provokes a progressive increase of 
                           
                              
                                 M
                              
                              
                                 z
                                 ,
                                 r
                              
                           
                         in opposite direction to the sideslip-related contribution. The divergence among the two contributions can be solved by a reduction of the reference yaw rate for the yaw rate controller by similar amount to the actual yaw rate reduction provoked by the sideslip contribution. The sideslip-related yaw rate reduction, 
                           
                              
                                 ∆
                                 r
                              
                              
                                 ref
                              
                           
                        , is expressed as the integral of the sideslip-related yaw moment contribution divided by the yaw mass moment of inertia. In fact, 
                           
                              
                                 
                                    M
                                 
                                 
                                    z
                                    ,
                                    β
                                 
                              
                              
                                 /
                              
                              
                                 
                                    J
                                 
                                 
                                    z
                                 
                              
                           
                         is the variation of yaw acceleration caused by 
                           
                              
                                 M
                              
                              
                                 z
                                 ,
                                 β
                              
                           
                        . If 
                           
                              |
                              
                                 
                                    
                                       M
                                    
                                    
                                       z
                                       ,
                                       β
                                    
                                 
                              
                              |
                           
                         is smaller than the threshold 
                           
                              
                                 M
                              
                              
                                 z
                                 ,
                                 β
                                 ,
                                 lim
                              
                           
                        , then through the second condition in Eq. (32) 
                        
                           
                              
                                 r
                              
                              
                                 ref
                              
                           
                         is progressively ramped back to the value 
                           
                              
                                 
                                    r
                                 
                                 
                                    LUT
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          SW
                                       
                                    
                                    
                                       ,
                                       v
                                       ,
                                    
                                    
                                       
                                          a
                                       
                                       
                                          x
                                       
                                    
                                    
                                       ,
                                    
                                    
                                       
                                          μ
                                       
                                       ^
                                    
                                 
                                 )
                              
                           
                        . In formulas:
                           
                              (32)
                              
                                 
                                    ∆
                                    
                                       r
                                       
                                          r
                                          e
                                          f
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   K
                                                   
                                                      c
                                                      o
                                                      r
                                                      r
                                                   
                                                
                                                ∫
                                                
                                                   
                                                      M
                                                      
                                                         z
                                                         ,
                                                         β
                                                      
                                                   
                                                   
                                                      J
                                                      z
                                                   
                                                
                                                d
                                                t
                                                
                                                i
                                                f
                                                
                                                   |
                                                   
                                                      M
                                                      
                                                         z
                                                         ,
                                                         β
                                                      
                                                   
                                                   |
                                                
                                                ≥
                                                
                                                   M
                                                   
                                                      z
                                                      ,
                                                      β
                                                      ,
                                                      l
                                                      i
                                                      m
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∫
                                                −
                                                
                                                   k
                                                   
                                                      r
                                                      a
                                                      m
                                                      p
                                                   
                                                
                                                s
                                                i
                                                g
                                                n
                                                
                                                   (
                                                   ∆
                                                   
                                                      r
                                                      
                                                         r
                                                         e
                                                         f
                                                      
                                                   
                                                   )
                                                
                                                d
                                                t
                                                
                                                i
                                                f
                                                
                                                   (
                                                   
                                                      |
                                                      
                                                         M
                                                         
                                                            z
                                                            ,
                                                            β
                                                         
                                                      
                                                      |
                                                   
                                                   <
                                                   
                                                      M
                                                      
                                                         z
                                                         ,
                                                         β
                                                         ,
                                                         l
                                                         i
                                                         m
                                                      
                                                   
                                                   )
                                                
                                                
                                                a
                                                n
                                                d
                                                
                                                
                                                   (
                                                   
                                                      |
                                                      Δ
                                                      
                                                         r
                                                         
                                                            r
                                                            e
                                                            f
                                                         
                                                      
                                                      |
                                                   
                                                   ≥
                                                   Δ
                                                   
                                                      r
                                                      
                                                         r
                                                         e
                                                         f
                                                         ,
                                                         l
                                                         i
                                                         m
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                0
                                                
                                                i
                                                f
                                                
                                                   (
                                                   
                                                      |
                                                      
                                                         M
                                                         
                                                            z
                                                            ,
                                                            β
                                                         
                                                      
                                                      |
                                                   
                                                   <
                                                   
                                                      M
                                                      
                                                         z
                                                         ,
                                                         β
                                                         ,
                                                         l
                                                         i
                                                         m
                                                      
                                                   
                                                   )
                                                
                                                
                                                a
                                                n
                                                d
                                                
                                                
                                                   (
                                                   
                                                      |
                                                      Δ
                                                      
                                                         r
                                                         
                                                            r
                                                            e
                                                            f
                                                         
                                                      
                                                      |
                                                   
                                                   <
                                                   Δ
                                                   
                                                      r
                                                      
                                                         r
                                                         e
                                                         f
                                                         ,
                                                         l
                                                         i
                                                         m
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Therefore, the reference yaw rate has the form:
                           
                              (33)
                              
                                 
                                    
                                       r
                                       ref
                                    
                                    =
                                    
                                       (
                                       
                                          r
                                          LUT
                                       
                                       
                                          (
                                          δ
                                          ,
                                          v
                                          ,
                                          
                                             a
                                             x
                                          
                                          ,
                                          
                                             μ
                                             ^
                                          
                                          )
                                       
                                       +
                                       ∆
                                       
                                          r
                                          ref
                                       
                                       )
                                    
                                    
                                       
                                          ω
                                          r
                                       
                                       
                                          s
                                          +
                                          
                                             ω
                                             r
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The actual implementation of the controller implies specific algorithms for the selection of the initial conditions and the reset of the integrators in Eq. (32).


                     
                        
                           
                              M
                           
                           
                              z
                              ,
                              β
                           
                        
                      is based on a sideslip estimator combining two algorithms:
                        
                           i)
                           An algorithm calculating the following integral solution:
                                 
                                    (34)
                                    
                                       
                                          
                                             
                                                β
                                                ^
                                             
                                             int
                                          
                                          =
                                          ∫
                                          
                                             (
                                             
                                                
                                                   a
                                                   y
                                                
                                                v
                                             
                                             −
                                             r
                                             )
                                          
                                          dt
                                          +
                                          
                                             β
                                             
                                                th
                                                ,
                                                int
                                             
                                          
                                       
                                    
                                 
                              
                           

An extended Kalman filter (EKF) based on the non-linear vehicle model formulation discussed in Section 2 (Eq. (1) of the model for the phase-plane analysis of vehicle behavior) and a tire brush model [21] with the lateral force characteristic given by (the subscripts referring to the individuals wheels are omitted for simplicity):

The brush model formulation, here presented for the condition of pure cornering (sufficient for the specific maneuvers), can be easily extended to the case of combined slip, with the approach discussed in detail in [21]. Also, the EKF equations can be enhanced to include the states related to tire relaxation. However, given the frequency range typical of vehicle yaw dynamics, the modeling of this second approximation effect is not required for the specific application.

The non-linear equations are linearized at each time step and implemented in a discretized state-space representation, where 
                        
                           
                              
                                 x
                              
                              ̇
                           
                           
                              ≈
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    (
                                    
                                       k
                                       +
                                       1
                                    
                                    )
                                 
                                 
                                    −
                                    x
                                 
                                 
                                    (
                                    
                                       k
                                    
                                    )
                                 
                              
                              
                                 
                                    ∆
                                    t
                                 
                              
                           
                        
                     :
                        
                           (37)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                +
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                +
                                             
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                +
                                             
                                             
                                                W
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                +
                                             
                                             
                                                
                                                   D
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                +
                                             
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                +
                                             
                                             
                                                Z
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The EKF formulation follows the standard set-up discussed in [22].

The estimated sideslip angle is given by:
                        
                           (38)
                           
                              
                                 
                                    
                                       β
                                    
                                    ^
                                 
                                 
                                    =
                                 
                                 
                                    
                                       w
                                    
                                    
                                       β
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             β
                                          
                                          ^
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             β
                                          
                                          ^
                                       
                                    
                                    
                                       EKF
                                    
                                 
                                 
                                    +
                                 
                                 
                                    (
                                    
                                       
                                          1
                                          −
                                       
                                       
                                          
                                             w
                                          
                                          
                                             β
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   β
                                                
                                                ^
                                             
                                          
                                          )
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             β
                                          
                                          ^
                                       
                                    
                                    
                                       int
                                    
                                 
                              
                           
                        
                     where the weighting factor 
                        
                           
                              w
                           
                           
                              β
                           
                        
                     , function of 
                        
                           
                              β
                           
                           ^
                        
                     , provides a smooth transition between the region at medium-low sideslip angle, in which the EKF contribution is the dominant one, and the region at significant sideslip angle, in which the contribution deriving from the integral solution is the dominant one. The combination of the two algorithms provides good performance as confirmed by experimental tests, see 
                     Fig. 6. As mentioned in Section 3, the Enhanced Sport Mode exhibits a progressive increase of sideslip after the steering wheel input application is completed in absence of the contribution 
                        
                           
                              M
                           
                           
                              z
                              ,
                              β
                           
                        
                     .

In addition to experimental testing (Section 6), a simulation-based study was conducted to allow assessment of the control system performance over a wide set of conditions.

The controllers developed in Section 4 are implemented in the non-linear vehicle model for the phase-plane analysis of vehicle response, thus providing a first phase-plane-based assessment (so far missing in the literature) of integrated yaw rate and sideslip control.


                        
                        Fig. 7 reports the results for the vehicle with the H
                        
                           ∞
                         yaw rate controller only, and the vehicle with the H
                        
                           ∞
                         yaw rate and sideslip controller (in this case with a constant activation threshold). In both cases the reference yaw rate is the one of the Sport Mode, and 
                           
                              v
                           
                         and 
                           
                              
                                 δ
                              
                              
                                 SW
                              
                           
                         are the same (90km/h and 50 deg, respectively) as for the phase-plane plot of Fig. 1. In Fig. 7(a) the circles represent the initial conditions yielding a stable motion towards the equilibrium of the system in Sport Mode corresponding to 
                           
                              
                                 
                                    β
                                    
                                       e
                                       q
                                       ,
                                       S
                                       p
                                       o
                                       r
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                       ̇
                                    
                                    
                                       e
                                       q
                                       ,
                                       S
                                       p
                                       o
                                       r
                                       t
                                    
                                 
                              
                           
                           =
                           
                              
                                 −
                                 5.5
                                 
                                 deg
                                 ,
                                 0
                              
                           
                        . The asterisks show the initial conditions for which the vehicle with the yaw rate controller results in an unstable motion. This observation allows the first conclusion of this analysis: even if the steady-state reference yaw rate is within the cornering limits of the vehicle, for significant initial negative values of 
                           
                              β
                           
                         (lower than −10 deg) the yaw rate controller alone cannot direct the vehicle to a stable operating condition.

In case of concurrent yaw rate and sideslip control (Fig. 7(b)), the stable points identified with the yaw rate controller only (Fig. 7(a)) remain stable and converge to the same final point, as shown by the circles located at their initial conditions and the rhomboidal shape located at the equilibrium 
                           
                              (
                              
                                 
                                    
                                       β
                                    
                                    
                                       eq
                                       ,
                                       Sport
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       
                                          
                                             β
                                          
                                          ̇
                                       
                                    
                                    
                                       eq
                                       ,
                                       Sport
                                    
                                 
                              
                              )
                           
                        . However, many of the initial points corresponding to the stable conditions with the yaw rate controller are located in the activation region of the sideslip controller (Fig. 3). As a consequence, they imply interventions of the sideslip contribution, which tends to provoke larger 
                           
                              |
                              
                                 
                                    
                                       β
                                    
                                    ̇
                                 
                              
                              |
                           
                         (with positive 
                           
                              
                                 β
                              
                              ̇
                           
                         in case of negative 
                           
                              β
                           
                         and negative 
                           
                              
                                 β
                              
                              ̇
                           
                         in case of positive 
                           
                              β
                           
                        ) than with the yaw rate controller only, in order to swiftly bring the vehicle within the stable region in the 
                           
                              
                                 
                                    β
                                 
                                 ̇
                              
                              
                                 (
                                 
                                    β
                                 
                                 )
                              
                           
                         phase-plane. For instance, for 
                           
                              β
                              >
                              0
                           
                         the trajectories with the yaw rate and sideslip controller starting in the activation region of the sideslip contribution are characterized by a path with peak values of 
                           
                              
                                 β
                              
                              ̇
                           
                         of about −80deg/s compared to −40deg/s for the corresponding trajectories with the yaw rate controller only. The unstable points with the yaw rate controller become stable with the combined controller; the corresponding initial conditions are shown with squares in Fig. 7(b). The corresponding (second) equilibrium with the integrated yaw rate and sideslip controller is indicated by a triangle, for the (very significant) value 
                           
                              
                                 β
                              
                              
                                 min
                              
                           
                         of −16.5deg adopted in the control system tuning for the specific simulations. The fact that the integrated controller allows an extension of the region of stable vehicle operation also when 
                           
                              
                                 r
                              
                              
                                 ref
                              
                           
                         is within the boundaries allowed by the tire-road friction limits is an important conclusion of this phase-plane analysis, demonstrating the major safety-related benefit of sideslip control.


                        
                        Fig. 8 is the equivalent of Fig. 7 with the Enhanced Sport Mode, characterized by a larger 
                           
                              |
                              
                                 
                                    
                                       r
                                    
                                    
                                       ref
                                    
                                 
                              
                              |
                           
                        . In particular, Fig. 8(a) shows the destabilizing effect of the yaw rate controller caused by a reference yaw rate higher than the limit corresponding to the tire-road friction conditions. All the initial conditions, indicated by the asterisks in Fig. 8(a), lead to unstable vehicle operation. In contrast, the concurrent yaw rate and sideslip controller allows the vehicle to reach the set equilibrium, corresponding to the coordinates 
                           
                              
                                 
                                    β
                                    
                                       m
                                       i
                                       n
                                    
                                 
                                 ,
                                 0
                              
                           
                           =
                           (
                           −
                           16
                           .
                           5
                           
                           deg
                           ,
                           0
                           )
                        , with any initial condition (Fig. 8(b)). The values of 
                           
                              
                                 β
                              
                              
                                 min
                              
                           
                         and 
                           
                              
                                 β
                              
                              
                                 max
                              
                           
                         are important tuning parameters of the Enhanced Sport Mode as they define the final steady-state values of sustained vehicle sideslip.

This part of the analysis work is aimed at the time domain investigation of the potential benefits of sideslip control compared to yaw rate control only, when the friction conditions are not correctly estimated, and therefore 
                           
                              |
                              
                                 
                                    
                                       r
                                    
                                    
                                       ref
                                    
                                 
                              
                              |
                           
                         is in excess of the value corresponding to the actual friction conditions. The adopted model is the CarMaker – Simulink model presented in Section 2.1. Using the Sport Mode, a sequence of three step steers (each with an amplitude of 100deg) is simulated starting from an initial 
                           
                              v
                           
                         of 90km/h and a constant wheel torque demand. 
                        Table 2 reports the results for the maneuver executed at 
                           
                              μ
                              =
                              1
                           
                         with the corresponding 
                           
                              
                                 r
                              
                              
                                 ref
                              
                           
                         (first raw of results), and executed at 
                           
                              μ
                              =
                              0.5
                           
                         while 
                           
                              
                                 r
                              
                              
                                 ref
                              
                           
                         is deliberately maintained to be the one for 
                           
                              μ
                              =
                              1
                           
                         (second row of results). The considered controller configurations are analyzed with the yaw rate contribution only, and with the combined yaw rate and sideslip contributions. Also, the combined controller is tested with constant (
                           
                              |
                              
                                 
                                    
                                       β
                                    
                                    
                                       th
                                    
                                 
                              
                              |
                           
                           
                              =
                              5
                           
                         deg) and variable (
                           
                              |
                              
                                 
                                    
                                       β
                                    
                                    
                                       min
                                    
                                 
                              
                              |
                           
                           
                              =
                           
                           
                              |
                              
                                 
                                    
                                       β
                                    
                                    
                                       max
                                    
                                 
                              
                              |
                           
                           
                              =
                              5
                           
                        
                        deg) activation thresholds for the sideslip contribution (see Fig. 3). The PID+FF controller is implemented in the form of a P+FF in order to assess the performance benefit of an advanced control structure such as the H
                        
                           ∞
                         controller over a simple controller set-up. 
                        
                        Figs. 9 and 10 report 
                           
                              r
                           
                           
                              (
                              
                                 t
                              
                              )
                           
                         and 
                           
                              β
                           
                           
                              (
                              
                                 t
                              
                              )
                           
                         for the passive vehicle and the vehicle with the P+FF controller for 
                           
                              μ
                              =
                              0.5
                           
                        . The analysis of the results allows the following conclusions:
                           
                              •
                              In the case of correct friction coefficient estimation, the introduction of 
                                    
                                       
                                          M
                                       
                                       
                                          z
                                          ,
                                          β
                                       
                                    
                                  does not provide a benefit;

Yaw rate controllers can provide safe vehicle operation on their own only with correct friction estimation. For example, in the case of overestimation of the friction conditions, yaw rate controllers can provoke 
                                    
                                       |
                                       
                                          
                                             
                                                β
                                             
                                             
                                                peak
                                             
                                          
                                       
                                       |
                                    
                                  in excess of 15deg;

In the case of erroneous friction coefficient estimation, even a basic P+FF controller including both the yaw rate and sideslip contributions is sufficient to provide safe vehicle operation;

The H
                                 
                                    ∞
                                  control scheme provides some performance benefit with respect to the P+FF controller, for example, by reducing 
                                    
                                       |
                                       
                                          
                                             
                                                β
                                             
                                             
                                                peak
                                             
                                          
                                       
                                       |
                                    
                                  by more than 1deg. However, during the analysis it was observed that the performance of a PI+FF controller (instead of a P+FF controller) could become relatively close to the performance of the H
                                 
                                    ∞
                                  controller;

The variation of the sideslip controller activation threshold as a function of the estimated sideslip rate (Eqs. (19)–(21)) introduces a further improvement in the control system performance with a reduction of 
                                    
                                       |
                                       
                                          
                                             
                                                β
                                             
                                             
                                                peak
                                             
                                          
                                       
                                       |
                                    
                                  between 0.8 and 0.9deg. Therefore, this formulation is recommended for an industrial implementation of the control scheme;

Relatively simple control structures such as the ones presented here allow safe vehicle operation even without a friction coefficient estimator. Hence, considering the difficulty involved in friction estimation, integrated yaw rate and sideslip control seems to promise a greater industrial development potential than very sophisticated model-based yaw rate controllers that rely on accurate real-time friction estimation.

@&#EXPERIMENTAL RESULTS@&#

This section shows examples of the performance of the integrated yaw rate and sideslip controllers during step steer tests carried out at the Lommel proving ground (Belgium) with the four-wheel-drive vehicle demonstrator of the European FP7 project E-VECTOORC, set up with the Enhanced Sport Mode. The schematic of the vehicle demonstrator is shown in 
                     Fig. 11. The vehicle has on-board electric drivetrains, with transmissions, half-shafts, and constant velocity joints connecting the electric motors (M1–M4, with the respective inverters I1–I4) to the wheels. An electro-hydraulic braking system unit is installed in order to individually control the friction brake pressures independently from the brake pedal force applied by the driver. The vehicle control unit (VCU) is implemented on a dSPACE AutoBox system.

For the tests (see 
                     Fig. 12), the vehicle is accelerated to 
                        
                           v
                        
                     =90km/h and, then, an overall reference wheel torque demand is electronically assigned through the dSPACE system, corresponding to the level required to keep the vehicle at constant 
                        
                           v
                        
                      when traveling in straightline. At this point the driver applies a steering wheel input from 0deg to 100deg at a rate of ≅400deg/s, and keeps 
                        
                           
                              δ
                           
                           
                              SW
                           
                        
                      at its final value. The imposed value of 
                        
                           
                              δ
                           
                           
                              SW
                           
                        
                      is considerably greater than the steering wheel angle required for maximum lateral acceleration with the prevailing tire-road friction condition.


                     
                     
                     
                     Figs. 13–15 show examples of the performance of the PID+FF controller, in terms of 
                        
                           r
                        
                        
                           (
                           
                              t
                           
                           )
                        
                     , 
                        
                           β
                        
                        
                           (
                           
                              t
                           
                           )
                        
                     , and 
                        
                           
                              
                                 M
                              
                              
                                 z
                              
                           
                           
                              (
                              
                                 t
                              
                              )
                           
                        
                     . The feedback contributions of this controller were tuned to be based on the proportional terms in order to assess the performance with a simple and industrially easy-to-implement control structure. The control output 
                        
                           
                              
                                 M
                              
                              
                                 z
                              
                           
                           
                              (
                              
                                 t
                              
                              )
                           
                        
                      in Fig. 15 (and also in the following Fig. 18) is actuated through a control allocation algorithm that defines the constant front-to-rear wheel torque and yaw moment distributions such that:
                        
                           (39)
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       z
                                    
                                 
                                 
                                    ≈
                                 
                                 
                                    (
                                    
                                       
                                          
                                             F
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ,
                                             
                                             
                                                RF
                                             
                                          
                                       
                                       
                                          cos
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             RF
                                          
                                       
                                       
                                          −
                                       
                                       
                                          
                                             F
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ,
                                             
                                             
                                                LF
                                             
                                          
                                       
                                       
                                          cos
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             LF
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             F
                                          
                                       
                                    
                                    
                                       
                                          2
                                       
                                    
                                 
                                 
                                    +
                                 
                                 
                                    (
                                    
                                       
                                          
                                             F
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ,
                                             
                                             
                                                RF
                                             
                                          
                                       
                                       
                                          sin
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             RF
                                          
                                       
                                       
                                          +
                                       
                                       
                                          
                                             F
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ,
                                             
                                             
                                                LF
                                             
                                          
                                       
                                       
                                          sin
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             LF
                                          
                                       
                                    
                                    )
                                 
                                 
                                    a
                                 
                                 
                                    +
                                 
                                 
                                    (
                                    
                                       
                                          
                                             F
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ,
                                             
                                             
                                                RR
                                             
                                          
                                       
                                       
                                          −
                                       
                                       
                                          
                                             F
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ,
                                             
                                             
                                                LR
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             R
                                          
                                       
                                    
                                    
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                  

The main observations from the test results are:
                        
                           •
                           In the initial part of the tests, 
                                 
                                    
                                       M
                                    
                                    
                                       z
                                    
                                 
                               is positive (i.e., destabilizing) to enhance vehicle responsiveness in comparison with the passive vehicle. In the specific set-up of the controller, in order to create a very ‘aggressive’ dynamic vehicle response and assess the controller in the worst case scenario, 
                                 
                                    
                                       r
                                    
                                    
                                       ref
                                    
                                 
                               was generated without the transfer function in Eq. (33).

When the yaw rate increases above the reference value, thus provoking the overshoot visible in Fig. 14, the controller determines a decrease of 
                                 
                                    
                                       M
                                    
                                    
                                       z
                                    
                                 
                              , which becomes negative (i.e., stabilizing).

As the vehicle yaw dynamics are strongly underdamped, the yaw rate overshoot is followed by a low peak, which is compensated by the second positive peak of 
                                 
                                    
                                       M
                                    
                                    
                                       z
                                    
                                 
                              .

When the vehicle reaches the sideslip threshold (variable sideslip threshold algorithm), the sideslip part of the controller is activated and the system tracks the specified value of sideslip angle. In particular, in Figs. 13–15 the values of 
                                 
                                    
                                       β
                                    
                                    
                                       min
                                    
                                 
                               were set to −5, −10 and −15deg. As expected, once the sideslip controller is activated, the value of vehicle yaw rate is lower for the cases with lower 
                                 
                                    |
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ref
                                          
                                       
                                    
                                    |
                                 
                              . Interestingly, the difference in the respective yaw moments after the intervention of the sideslip controller is very low, despite the significant difference in the sideslip angle values. This behavior is a consequence of the low values of cornering stiffness of the front and rear axles when the vehicle is at its limit during cornering. A relatively small variation of vehicle yaw moment can provoke a significant variation of vehicle sideslip.


                     
                     
                     
                     Figs. 16–18 report the results for the same test carried out with the H
                     
                        ∞
                      yaw rate controller (with the gains discussed in Section 3.2), and the H
                     
                        ∞
                      yaw rate and sideslip controller with a fixed sideslip threshold of 5deg. The H
                     
                        ∞
                      formulation brings a benefit in terms of sideslip tracking performance, i.e., a reduced oscillation range of 
                        
                           β
                        
                      in comparison with the PID+FF controller.

The reference tracking performance of the two controllers (PID+FF and 
                        
                           
                              H
                           
                           
                              ∞
                           
                        
                     ) is compared in 
                     
                     Tables 3 and 4, which calculate the root mean square errors (RMSE) for yaw rate (calculated by using as a reference 
                        
                           r
                           
                              L
                              U
                              T
                           
                        
                        
                           
                              δ
                              ,
                              v
                              ,
                              
                                 a
                                 x
                              
                              ,
                              
                                 μ
                                 ^
                              
                           
                        
                     ) and sideslip angle during the relevant parts of the tests, following the steering wheel input. The sideslip-related RMSE is computed only when the sideslip contribution of the controller is present and active (i.e., the RMSE value for sideslip angle is not calculated in the case of yaw rate control only or when the sideslip-related reference yaw moment is zero). As expected from the controllability analysis, the intervention of the sideslip controller degrades the tracking performance of the yaw rate controller, i.e., larger yaw rate-related RMSE values are shown in Table 4 during the activations of the sideslip controller. For the same reason an increase of 
                        
                           |
                           
                              
                                 
                                    β
                                 
                                 
                                    min
                                 
                              
                           
                           |
                        
                     , which brings a later intervention of the sideslip controller, implies a smaller RMSE value on yaw rate. The specific tuning of the 
                        
                           
                              H
                           
                           
                              ∞
                           
                        
                      control scheme achieves better tracking performance than the PID + FF controller. This can be observed from the smaller RMSE values for both yaw rate and sideslip angle.

These experiments prove that it is possible to achieve effective forms of integrated yaw rate and sideslip control, despite the functional uncontrollability of the system, and these can be used to safely improve the ‘fun-to-drive’ aspect of the vehicle. In fact, the Enhanced Sport Mode gives the driver unusual sensations of controlled vehicle drifting, in accordance with the specifications of the car makers involved in the research.

@&#CONCLUSIONS@&#

The paper discussed the integration of sideslip control within a continuously active yaw rate controller for a four-wheel-drive fully electric vehicle with individually controlled drivetrains, through vehicle dynamics simulations in the time domain, novel phase-plane analyzes and experimental tests. The main conclusions are:
                        
                           •
                           The implementation of the H
                              
                                 ∞
                               and PID+FF control structures on the vehicle demonstrator of the European FP7 project E-VECTOORC allowed the successful experimental demonstration of an Enhanced Sport Mode, which keeps the car at a set sideslip angle during cornering in limit conditions;

The combination of yaw rate and sideslip control actuated only through torque-vectoring has been demonstrated to be beneficial to the vehicle cornering response, even if the system is functionally uncontrollable. Novel design solutions for limiting the effect of the functional uncontrollability were proposed, based on the variation of the reference yaw rate as a function of the sideslip-related yaw moment contribution integrated along time;

Feedback sideslip control, even in the form of a simple proportional controller, significantly increases the stable region of vehicle operation on the 
                                 
                                    
                                       
                                          β
                                       
                                       ̇
                                    
                                    
                                       (
                                       
                                          β
                                       
                                       )
                                    
                                 
                               phase-plane, also in case of driving modes characterized by a not particularly ‘aggressive’ set of reference understeer characteristics. This is a major contribution of the paper. Moreover, sideslip control allows simple control structures with conventional friction estimation algorithms (or even without friction estimation algorithms, see Section 5) to provide safe vehicle operation during extreme transient maneuvers;

A combined yaw rate and sideslip controller can be tuned so that the vehicle trajectories tend to converge to the sideslip angle threshold of the sideslip controller for any initial condition;

In practical terms, during realistic maneuvers a very simple control structure (e.g., based on proportional controllers for both the yaw rate and sideslip contributions) can be effective with tracking performance comparable to more complex control structures such as H
                              
                                 ∞
                              -based controllers.

@&#ACKNOWLEDGMENTS@&#

The research leading to these results has received funding from the European Union Seventh Framework Programme FP7/2007-2013 under Grant agreement no. 284708.

@&#REFERENCES@&#

