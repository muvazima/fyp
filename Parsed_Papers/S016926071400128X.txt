@&#MAIN-TITLE@&#A new approach based on Machine Learning for predicting corneal curvature (K1) and astigmatism in patients with keratoconus after intracorneal ring implantation

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Optimization of corneal ring implantation using Machine Learning techniques.


                        
                        
                           
                           Prediction of astigmatism and corneal curvature improvement in patients with keratoconus after ring implantation by means Machine Learning techniques.


                        
                        
                           
                           Finding out the most relevant features for a successful ring implantation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Machine Learning

Keratoconus

Intracorneal rings

Astigmatism

@&#ABSTRACT@&#


               
               
                  Keratoconus (KC) is the most common type of corneal ectasia. A corneal transplantation was the treatment of choice until the last decade. However, intra-corneal ring implantation has become more and more common, and it is commonly used to treat KC thus avoiding a corneal transplantation. This work proposes a new approach based on Machine Learning to predict the vision gain of KC patients after ring implantation. That vision gain is assessed by means of the corneal curvature and the astigmatism. Different models were proposed; the best results were achieved by an artificial neural network based on the Multilayer Perceptron. The error provided by the best model was 0.97D of corneal curvature and 0.93D of astigmatism.
               
            

@&#INTRODUCTION@&#

Keratoconus (KC) is a non-inflammatory, progressive thinning disorder of the cornea, resulting in a protrusion, myopia and irregular astigmatism [1]. It classically manifests in the teenage years to young adulthood and leads to a variable decrease in the quality of vision and ocular discomfort [2]. The general interest in this entity has been increasing in the past years due to the development of new technologies to detect this corneal abnormality and its association to refractive surgery [3]. Laser in situ keratomileusis (LASIK) is the most common refractive surgical procedure for the treatment of myopia. Corneal ectasia associated to LASIK is among the most serious complications [4,5].

The treatment approach to KC follows an orderly progression from glasses to corneal transplantation. Glasses and contact lenses are an effective means of correcting mild KC. As the cornea steepens and becomes more irregular, glasses are no longer capable of providing adequate visual improvement. Surgery is recommended when a stable contact lens fit fails to provide adequate vision. Keratoplasty was long the only surgical treatment [6]. However, recent years have seen the introduction of new surgical options: collagen cross-linking, which stiffens the cornea and can halt disease progression [7], or corneal rings, which can reduce astigmatism and improve visual acuity [8,9]. There are many clinical studies on the effectiveness of intrastromal rings on KC in their early stages [10,11]. With the implantation of intracorneal ring segments, the cones remains stabilized and the time point for necessary keratoplasty is delayed or totally avoided [8] (Fig. 1
                     ).

There are several studies of patients with KC treated with intracorneal rings that discuss about the results and complications after implantation [12]. However, these results vary widely from one author to another. Moreover, the methodology and implantation technique is different [13,14]. For several years trying to reach a consensus about which technique and which nomogram is ideal for implanting rings, the conclusion is that there is no universal nomogram, sufficiently robust to enable surgeons to predict the refractive, topographical and biomechanical outcome of patients with ectasia after implantation of rings. Hence, there is a real need to go further than traditional linear statistical models in order to help surgeons in planning the optimal number and location of intracorneal rings.

The objective of this study is to devise a mathematical corneal model for patients with KC and intracorneal rings implantation for treatment. From a database formed by a cohort of 288 patients treated in Fundación Oftalmológica del Mediterráneo (FOM) 
                     
                        4
                     
                     
                        4
                        Ophtalmology clinic based in Valencia, Spain.
                     , mathematical models are developed aimed at predicting the improvement of KC patients after the implantation of intracorneal rings. The improvement is measured in terms of the corneal curvature and astigmatism, thus being an indirect marker of the most appropriate therapeutic strategy to plan the surgery for new patients.

The mathematical models proposed in this paper are based on Machine Learning (ML) approaches [15]. The basic idea underlying ML is the production of predictive models based on knowledge acquired from actual cases stored in databases, and their capability of generalization to new cases, not previously seen by the developed models. Machine Learning algorithms have already been used to keratoconus detection based on data from keratoconus diagnosis [16–21]. However, to the authors’ knowledge this is the first time that Machine Learning is used to predict the improvement of KC patients after treatment with intracorneal ring implantation which implied a great novelty to plan this type of surgery.

From a database formed by a cohort of 288 KC patients treated in Fundación Oftalmológica del Mediterráneo, a data pre-processing was carried out. The cohort included KC patients (men and women) from 20 to 75 year-old (presenting similar number of samples in the same age range) with a Corneal curvature varying from approximately 33D to 58D. Data removal included firstly an exclusion criteria based on eliminating those data records that did not include the information of all the variables considered in the construction of the model, as well as those patients that presented any other disease in the KC eye. Secondly, for features in a continuous range, outliers were removed based on the classical criterion of excluding those records located beyond three times the standard deviation with respect to the mean value.

A model of ML classifier based on an artificial neural network was implemented in Matlab®. The use of artificial neural networks is appropriate in this framework since they are universal function approximators, i.e., they can find a relationship between a given input space and its corresponding output space provided that the model is trained with a sufficient number of data records. These models also present different drawbacks, being likely the three most relevant ones, the need of preventing the model from overfitting (too many parameters), overtraining (too many iterations leading to learn the training data instead of the problem) [15] and falling into local minima. Proposed models had the necessary characteristics to avoid all the three problems, since the number of parameters was reasonably low, and early stopping and cross-validation methods were performed. In addition, a sensitivity analysis was carried out aiming at studying the relevance of the input variables in this model.

Artificial neural networks (ANN) are mathematical algorithms inspired in certain aspects of biological neurons, in particular, the knowledge is acquired through a learning process and stored in the so-called synaptic weights [22,15]. The multilayer perceptron (MLP), which is the most widely used ANN, was used in this work. It is a fully-connected feed forward network whose architecture is shown in Fig. 2
                        .

The MLP is formed by non-linear elements, (neurons), that are arranged in layers. The first layer is known as input layer, the last one as output layer while the rest of layers are called hidden layers [15]. The number of neurons in the input and output layers is given by the problem while the number of hidden layers and the number of neurons in each layer must be chosen by the network designer [15]. Due to the characteristics of the problem, the activation functions chosen for the MLP were the hyperbolic tangent for the hidden layer and a linear function for the output layer.

In the experimental setup, the back propagation algorithm modified by a term of momentum to speed up the learning process was used to train the networks. The chosen value of the learning rate was 0.001 whereas the momentum coefficient was adapted during the learning process depending on the values of the synaptic weights.

In addition to the regression produced by the MLP, a ranking of the relevance of the variables was also obtained. This is based on perturbing an input, and then monitoring model outputs [23]. The bigger the difference in the output, the more relevant the input feature.

The first step when designing the model is the election of the input variables that characterizes our study. In our case, this choice relied on the variables that are normally provided by the ophthalmologists to the companies that manufacture the rings. Based on these data, the companies provide the rings, propose a possible position for the ring in the cornea as well as its characteristics: thickness and arc length. Thus, the variables incorporated to our model were:
                           
                              •
                              
                                 Topographical variables: K1 and K2 corresponding to the corneal curvatures. Astigmatism is obtained as the difference between K1 and K2. In this study, corneal curvatures were measured with Pentacam [24].


                                 Variables of the surgery: Incision (Axis corresponding to the cut through which the ring is implanted) and Depth (depth to which the ring is implanted). These variables were obtained from K1 axis and Pachymetry, respectively. In this study, Pachymetry was measured with Visante [25].


                                 Characteristics of the rings: nA (number of rings), thickness, arc length and ring type (5mm or 6mm). These variables were provided by the company that manufactured the rings.

Due to recent appearance of the ORA device [26], which provides some biomechanical properties of the cornea, some researchers are studying the influence of those properties on the cornea with keratoconus. The biomechanical properties that ORA provides are the Goldmann-correlated intraocular pressure (IOPg), the Corneal-compensated intraocular pressure (IOPcc), the Corneal Hysteresis (CH) and the Corneal Resistance Factor (CRF). Before incorporating those variables to the model, a study was performed by a decision tree. The study clearly showed that CH was the most relevant variable among all the biomechanical properties provided by ORA. CH reflects viscoelastic properties of the cornea and indicates its biomechanical integrity [26]. Therefore, this variable was included in the model as input variable in order to analyze the impact of the biomechanical behavior of the cornea in the developed model.

After removing those records that showed missing values, were outliers or showed some inconsistencies, the analyzed data corresponded to 194 measurements of 194 eyes from 154 different patients. Measurements were taken in FOM following the normal protocol for patient with keratokonus.

The final data set was split into two groups. The first one, called “training group” and made up of 2/3 of our data, was the group that designed and portrayed our model. The second one, known as “validation” was used to validate the model obtained from the training group. A fine result on “validation group” guarantees a good model design and, therefore, a good problem description since the model shows a good capability to work well with data different from those used to obtain the model and hence, it suggests an adequate behavior on new patients.

In order to obtain the model of neural network, 300 networks were generated by changing the number of neurons of the hidden layer from 2 to 20, by tuning the learning speed parameters and by testing different initializations for the synoptic weights. The continuous variables were standardized to normal distributions with mean value equal to zero and standard deviation unity to ensure that all of them contribute in a similar way to the neural models.

@&#RESULTS@&#

As previously mentioned, after obtaining data-based neural models, a sensitivity analysis for each one of the models was carried out in order to obtain the most representative variables. All the input variables, were measured three months prior to surgery. The output variables correspond with the astigmatism (K2-K1) and corneal curvature or keratometry K1 six months after the surgery.

The performance of the models was evaluated by means of the following indices: Mean Error (ME) as a measure of bias, Mean Absolute Error (MAE) and Root Mean Square Error (RMSE) as a measure of accuracy and the correlation coefficient (r) as a measure of fit.

The input variables used in the analysis and their characteristics in training and validation groups are shown in Tables 1 and 2
                           
                           , respectively. Table 3
                            displays basic statistical descriptions of the output variable in training and validation groups.

The best selected network was formed by two neurons in the hidden layer and its performance is shown in Table 4
                           . The MAE yielded for the training data set was 27% of the standard deviation (0.95D), being the MAE obtained in the validation data set equal to 29% (0.98D). Table 4 also shows the coefficient of correlation of the output. It is importance to notice the good performance of the model since its value is about 0.92 in training and 0.93 in validation. Fig. 3
                            shows the predicted values of K1 versus the actual ones.

It is very important that the best network was formed by only two neurons in the hidden layer since simple models favor knowledge extraction and tend to show better validation capabilities. As shown in Fig. 4
                           , the lowest MAE was obtained by the model finally selected, and formed by only two hidden neurons. Fig. 4 also shows up that a similar performance between training and validation was achieved by the selected architecture whereas for a high number of hidden neurons (e.g., 18 and 20 neurons), there was a considerable difference in the performance achieved in training and validation, thus suggesting an overfitting of the model due to a too high number of parameters.

The input variables used in this analysis and their characteristics in training and validation groups are shown in Tables 5 and 6
                           
                           , respectively. Table 7
                            shows the basic statistical description of the output variable in training and validation groups.

The best network was also formed by 2 neurons in the hidden layer and its performance is shown in Table 8
                           . The MAE yielded for the training data set was 47% of the standard deviation (1.00D), being the MAE obtained in the validation data set equal to 46% (0.86D). Fig. 5
                            shows the predicted values of Astigmatism versus the actual ones.


                           Fig. 6
                            shows that the best model was formed by only two hidden neurons. As mentioned when analyzing Fig. 4, this is important for validation and knowledge extraction purposes. In this case, most of the neural architectures did show a similar performance between training and validation, with no signs of overfitting even for a high number of neurons. However, since the best validation performance corresponded again with two neurons, and moreover, simple models are preferred, that was the architecture finally selected.

A sensitivity analysis was carried out over the neural models. The target of this analysis was to obtain the most relevant variables in the prediction of either main curvature and astigmatism. Table 9
                         shows a ranking of the features for the two ANNs that were taken into account.

@&#DISCUSSION@&#

Linear methods and models have been widely used for statistical analysis in the framework analyzed in this work. Despite their simplicity, linear methods often work well and may provide an adequate approximation for the task at hand. However, real-life processes tend to be non-linear. In the last two decades, artificial neural networks have received an increasing amount of attention among many applications in Medicine, because their ability to “learn” and “predict” relationships from a set of variables [27]. In this sense, to make a model which can predict the improvement of a patient with corneal ectasia after implantation of corneal rings can rely on machine learning techniques.

In our case, after applying different technical models, it became clear that the problem did not follow a linear behavior. Therefore, the traditional statistical tools applied to the processes that follow a linear pattern, was not entirely applicable to our problem. The problem analyzed in this work was better solved using nonlinear methods than their linear counterparts. Among the nonlinear models, the neural network obtained the best results. The error that occurred in the prediction of K1 after surgery was approximately 0.98D corresponding to 28% of the standard deviation. Nevertheless, this is a little value if we consider that these patients have about up to 57.5D of K1. In case of Astigmatism the error in its prediction after surgery was 0.86D corresponding to 46% of the standard deviation. The model to predict K1 provided very good results results since the coefficient of correlation of the output had a value very close to 1 and the mean absolute error (MAE) obtained relative to standard deviation was small. The results for the model whose output is astigmatism were slightly worse, but even acceptable; the reason is that the data used to construct this model were more sparse, thus providing a low correlation coefficient. However, the model could be improved if more data were included in their construction. In addition, it should be highlighted that data consisted of 194 eyes from 154 patients; this means that for 40 patients, information from both eyes was used. Therefore, achieved results might be slightly better than those obtained in the case of using only the data from one eye per patient.

In our study, according to the sensitivity analysis (Table 9), Keratometry prior surgery (K1) is the most important factor in predicting the outcome after implantation of intracorneal rings. The ANN constructed for the K1 prediction provided the best performance, with the lowest error in both training and validation data sets (being especially remarkable that the error committed in the training data set was very similar to that committed in the validation set). Therefore, the sensitivity analysis carried out over this model is reliable, and hence Keratometry (K1) may become a key factor modeling the vision gain; this factor is indeed taken into account in most current nomograms (Ferrara, Albertazzi nomograms). In addition, it is important to highlight that the biomechanical variables, in this case CH, do not play an important role when predicting the curvature and/or astigmatism for our model.

In the most common nomograms for planning implants of intracorneal ring (Ferrara [28] and Albertazzi [29], are the most common ones) the following variables are usually taken into account: astigmatism, spherical equivalent, keratometry, and ectasia distribution [30] and by consensus all rings are introduced at a particular depth (70%, 80%) for all patients equally. This is probably because this parameter was not controllable with the implantation technique with manual and automated software. The achieved results show that the most relevant variables for the implantation of the rings are rather related to the position of the rings and their characteristics. In particular, the depth or ring arc length appear among the most relevant features in both training and validation data sets. Those results may suggest that the exact position of implantation is patient-specific and hence different patients may need different implantation depths. Currently, the femtosecond laser is capable of specifying the depth of the implant to the micron more independently than the surgeon's hand. Therefore, the developed tool may aid surgeons in the decision of which implantation depth would be adequate.

Given those considerations, it seems that the mechanism of action by which a particular ring produces an effect when it is introduced into a specific cornea is too complex to be fully understood by using the classical “Barraquer thickness law” and “Blavatskaya law” [31]. In this framework, ANNs can help surgeons to complete the model predictability in patients with KC, especially in those situations in which classical Statistics does not provide a sufficiently satisfactory result. To this aim, a user-friendly interface has been created that is shown in Fig. 7
                     . This figure shows a user interface that can be used to aid ophthalmologists in the prediction of K1 and astigmatism for KC corneas. The surgical variables, incision and depth, can be modified as well as the ring characteristics in order to find the optimal position at which the rings should be placed to get the greatest possible vision gain.

The approach presented in this paper for the prediction of the effect of using intracorneal rings may present intrinsic limitations related to the limited number of considered variables. There are more variables that may influence KC, but it would become necessary to increment the number of data records if more variables than those normally required by the ring manufacturers were to be considered in the construction of the model. The predictor presented in this paper is a first approach; the goal is both to broaden the database and to consider more variables that can improve the KC prediction (morphological parameters characterizing keratoconus or even parameters related to optical aberrations like coma, etc.). In addition, the simulation of the Wavefront after surgery could also be provided as an output by the predictor in order to complete the analysis of the improvement of KC patients after surgery. Therefore, these models can be improved with new data from new patients, making this application optimal for its clinical use.

@&#CONCLUSIONS AND FUTURE WORK@&#

This paper has proposed a methodology to build neural networks that accurately predict the corneal curvature K1 and the astigmatism after implantation of intracorneal rings. A good model of astigmatism and K1 prediction has been developed in terms of a high correlation coefficient between actual and predicted signals, and low ME, MAE and RMSE values. Sensitivity analysis has shown that the most relevant features for the astigmatism and K1 prediction are the keratometry, K1, and the position of the ring in the depth of the cornea. After the study and looking at the obtained results, it can be concluded that the suggested results are promising and open a door for the use of this methodology in clinical practice after a thorough validation.

Currently, we are working on the acquisition and accommodation of new data in order to improve the models already produced as well as validate them with new data, thus showing up their robustness capabilities.

All authors disclose that there are not any financial and personal relationships with other people or organizations that could inappropriately influence their work.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the Spanish Ministry of Science and Innovation, MICINN (reference TIN2010-20999-C04-01).

@&#REFERENCES@&#

