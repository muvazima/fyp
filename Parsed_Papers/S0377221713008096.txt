@&#MAIN-TITLE@&#An arc-exchange decomposition method for multistage dynamic networks with random arc capacities

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Deal with the multistage dynamic stochastic networks with random arc capacities.


                        
                        
                           
                           Provide a new approximating method.


                        
                        
                           
                           Can handle the large-scale problem instances with fairly good solution quality.


                        
                        
                           
                           Provide a tight upper bound of the multistage stochastic dynamic networks.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Stochastic programming

Dynamic programming

Transportation

Approximate dynamic programming

Decomposition method

Multistage networks with random arc capacities

@&#ABSTRACT@&#


               
               
                  Multistage dynamic networks with random arc capacities (MDNRAC) have been successfully used for modeling various resource allocation problems in the transportation area. However, solving these problems is generally computationally intensive, and there is still a need to develop more efficient solution approaches. In this paper, we propose a new heuristic approach that solves the MDNRAC problem by decomposing the network at each stage into a series of subproblems with tree structures. Each subproblem can be solved efficiently. The main advantage is that this approach provides an efficient computational device to handle the large-scale problem instances with fairly good solution quality. We show that the objective value obtained from this decomposition approach is an upper bound for that of the MDNRAC problem. Numerical results demonstrate that our proposed approach works very well.
               
            

@&#INTRODUCTION@&#

Multistage dynamic networks with random arc capacities (MDNRAC) have been successfully used for modeling various problems such as dynamic vehicle allocation (Cheung & Powell, 1996; Godfrey & Powell, 2002; Simão et al., 2010), empty container relocation (Cheung & Chen, 1998), resource planning problems (Song & Huang, 2008), drayage problem (Cheung, Shi, Powell, & Simão, 2008), and energy resource allocation (Powell et al., 2012). In these problems, a node represents a location at a particular period, an arc represents a transportation request from a location to another location starting at a particular period, and the arc capacity represents the random amount of the transportation request. The MDNRAC model belongs to the general class of multistage stochastic programming problems with recourse (Birge & Louveaux, 1997). Numerous techniques have been developed for general stochastic programming since it was first introduced by Dantzig (1955), such as Monte Carlo sampling (Kenyon & Morton, 2003; Verweij, Ahmed, Kleywegt, Nemhauser, & Shapiro, 2003), scenario aggregation (Kouwenberg, 2001), L-shaped decomposition (Van Slyke & Wets, 1969; Birge & Louveaux, 1988; Laporte, Louveaux, & Hamme, 2002), stochastic decomposition (Berkelaar, Gromichom, Kouwenberg, & Zhang, 2005; Higle & Sen, 1991; Higle, Lowe, & Odio, 1994), and sublinear approximation (Birge & Wets, 1986, 1989). However, MDNRAC involves a large number of random variables, which makes these general methods computationally very expensive or even intractable. The most promising solution approaches, therefore, are to use decompositions, some form of Lagrangian relaxation and separability (Birge & Louveaux, 1997, p. 233). For MDNRAC, two solution approaches have been proposed. The first is proposed by Glockner and Nemhauser (2000), who using the scenario aggregation idea (Kouwenberg, 2001) as a solution framework, consider a scenario formulation of the problem and provide a decomposition scheme, called compath decomposition. The idea is derived from the path decomposition for network flows. Another approach is to approximate the expected cost function in each stage of the MDNRAC, from the last stage to the second stage of the MDNRAC. Under this approach, Frantzeskakis and Powell (1990) develop a successive linear approximation procedure while Cheung and Powell (1996) develop a successive convex approximation method (SCAM). In SCAM, a network is decomposed into a number of overlapping trees with random arc capacities, known as the tree recourse problems (TREEREC). For each TREEREC, the expected cost can be obtained efficiently as a parametric function of the supply of the root node of the TREEREC by using Powell and Cheung (1994a)’s method. The SCAM relaxes the capacity constraints by way of penalty cost.

As stochastic programs are very difficult to solve to optimality, active research has also been conducted to develop bounds for the objective function value. One approach is to approximate the probability distributions of the random variables by simpler distributions. The Jensen’s lower bound is obtained when for each random variable, the whole probability mass was put to its expected value, and then solve the resulting (deterministic) problem. The Edmundson–Madansky (EM) upper bound (Madansky, 1959) is obtained by allocating the probability mass to the two extreme values of each random variable. The approach can be generalized to the class of moment problems that can be used to obtain various lower and upper bounds that satisfy certain conditions on the moment information of the original random variable (see, for example, Ediringhe & Ziemba, 1994; Prekopa, 1999). In general, the Jensen bound is quite loose (Ediringhe & Ziemba, 1992) while the EM bound requires exponentially large effort (in terms of the number of random variables) to compute. By exploiting the structure of the network, Donohue and Birge (1996) develop a method to substantially reduce the computational efforts required by the EM bound. Another approach to obtain bounds is by approximating the recourse function by separable, piece-wise linear functions (Birge & Wallace, 1988; Birge & Wets, 1989). For networks with random arc capacities, Wallace (1987) develops a piecewise linear upper bound by first identifying cycles in the network and then perturbating the flows on the cycles. Powell and Frantzeskakis (1994) describe various restricted recourse strategies to obtain bounds. Cheung and Powell (1996) obtain a lower bound by using a set of separable, convex functions that bound the recourse function from below.

The key feature of a MDNRAC model is that when decisions are made at the beginning of a stage, the arc capacities in this particular stage are assumed to be known or observed while the arc capacities in all later stages are unknown. This scenario then repeats when decisions are made at the next stage and so on. The objective is to minimize the total expected cost, which is the summation of the deterministic stage-one cost and the expected future cost (cost-to-go) over the whole planning horizon. As mentioned in the literature review, solving the MDNRAC model is generally computationally intensive, and there is a need to develop more efficient solution approaches. In this paper, we propose a new heuristic method to tackle the model. The essence of our approach is to approximate the expected cost-to-go at each stage using a series of separable piecewise-linear convex functions. This allows us to decompose the network at each stage into a set of subproblems with tree structures, wherein each subproblem can be solved efficiently by applying the TREEREC algorithm (Powell & Cheung, 1994a).

The remainder of this paper is organized as follows. Section 2 provides the formulations of the problem and describes the successive approximation solution strategy. In Section 3, we derive several properties that are used to estimate the impact on expected flow and cost due to the changes in the tree structure. In Section 4, we illustrate our new decomposition method and derive the new upper bound. Section 5 presents the results of the numerical experiments. Finally, we offer our concluding remarks and potential extension of future research in Section 6.

Consider a T-stage stochastic network with random arc capacities, which can be used to model dynamic resource allocation problem (Cheung & Powell, 1996). In this problem, the objective of the decision at each stage is to minimize the total of the cost in the current stage and the expected costs in later stages. Before giving the mathematical decision model, we first define some notations. Since a stage is defined as a point in time where decisions are made, hereafter, we may use “time t” or “stage t” alternatively. Define
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       set of nodes at time t, t
                                          =1,2,…,
                                          T
                                          +1;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       set of arcs originating at time t, t
                                          =1,2,…,
                                          T;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       (deterministic) capacity of arc (i, j) starting at time 1;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       (random) capacity of arc (i, j) starting at time t, t
                                          =2,3,…,
                                          T;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       per unit cost of arc (i, j) starting at time t, t
                                          =1,2,…,
                                          T;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       flow on arc (i, j) starting at time t, t
                                          =1,2,…,
                                          T;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       initial supply to the node i, 
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          ;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       internal supply to node i, 
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          , resulting from the decision made at time t
                                          −1, t
                                          =2,3,…,
                                          T
                                          +1.
                                    
                                 
                              
                           
                        
                     

At stage 1, the decision is made to minimize the summation of the cost at the first stage and the expected cost in the later stages, which can be formulated as follows:
                           
                              (1)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                    
                                       1
                                    
                                 
                                 ·
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                       
                                          
                                             subject
                                             
                                             to
                                             :
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      {
                                                      j
                                                      :
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ∈
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          i
                                          :
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 j
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 0
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       u
                                    
                                    
                                       ij
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        where for a given supply 
                           s
                        
                        
                           t
                         and a particular realization 
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    Q
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         is the value of a minimization problem which is defined recursively as follows:
                           
                              (5)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                       
                                          
                                             subject
                                             
                                             to
                                             :
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      {
                                                      j
                                                      :
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ∈
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          i
                                          :
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                t
                                             
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       j
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 j
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 0
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       ij
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        for t
                        =2,3,…,
                        T and Q
                        
                           T+1(·, ·)=0.

Here Q
                        
                           T+1(·, ·) represents the tail effect of the resource (vehicles) at the time beyond the planning horizon. As mentioned in King and Wallace (2012, p. 55), it is necessary to approximate this tail effect in order to model a problem covering infinitely long time by a model with finite stages. However, it is not our scope to further discuss the issue of how to evaluate the tail effect Q
                        
                           T+1(·, ·). For simplicity, we assume that Q
                        
                           T+1(·, ·)=0, which means that the value of the resource at a time beyond the planning horizon is not considered. It is worthwhile to point out that our method can still work even if this value is not equal to zero but some deterministic estimated value or a convex function of the supply 
                           s
                        
                        
                           T+1.

As mentioned earlier, the MDNRAC model defined in Eqs. (1)–(8) involves a large number of random variables, which makes the problem very difficult to solve exactly. A promising approach is to use decomposition and some kind of separability. In this paper, we follow the successive approximation approach developed in Frantzeskakis and Powell (1990) and in Cheung and Powell (1996), which approximates the recourse values with a set of separate functions. Fig. 1
                         illustrates the framework of this approach. In particular, the last stage problem (stage T) is solved exactly and the separable expected recourse function for resource at each location are obtained. These functions are piecewise linear and convex, and hence can be expressed as a sets of arcs with deterministic capacities. A modified stage T
                        −1 problem is obtained by replacing the last stage with these arcs. After that, the modified stage T
                        −1 problem is approximated by a set of convex, piecewise linear functions, which in terms are represented by deterministic arcs and are added to the stage T
                        −2 problem. The process is repeated until the stage 1 problem is reached, which is a deterministic network flow problem that can be solved efficiently. The key steps are summarized in Fig. 2
                        .

In Step 1, the expected recourse function 
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    T
                                 
                              
                              )
                              
                              ≜
                              
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    T
                                 
                              
                              )
                           
                         of stage T problem Q
                        
                           T
                        (
                           s
                        
                        
                           T
                        , 
                           ξ
                        
                        
                           T
                        ) is separable in 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                           
                         and thus can be written as
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       T
                                    
                                 
                                 )
                                 
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       T
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (10)
                              
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                 ≜
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                           
                        
                     

Each component of Problem (11), known as the nodal recourse (see Powell & Frantzeskakis, 1994), has the form of a single level tree with random arc capacities. It can be computed exactly as a function of 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                           
                         by utilizing the fact that for any given realization of the random arc capacities, the greedy algorithm can produce the optimal solution (Wallace, 1986). The function, 
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              )
                           
                        , is shown to be convex, piecewise linear with integer breakpoints and after certain value of 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                           
                        , say s
                        max the slope of the function becomes constant. This function can be represented by a set of s
                        max
                        +1 parallel deterministic arcs as follows. Let 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    T
                                 
                              
                           
                         be the slope of 
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              )
                           
                         in the segment between 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              =
                              k
                              -
                              1
                           
                         and at 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              =
                              k
                           
                        . Then, the cost coefficient of the k
                        
                           th
                         parallel arc is 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    T
                                 
                              
                           
                         for k
                        =1,…,
                        s
                        max. The capacities of the first s
                        max arcs are 1 and the capacities of the last arcs are infinity.

Let 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    T
                                 
                              
                           
                         be the flow on these parallel arcs. The stage T
                        −1 problem can be written as
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       T
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       T
                                       -
                                       1
                                    
                                 
                                 )
                                 
                                 ≜
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             T
                                             -
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         T
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                ij
                                             
                                             
                                                T
                                                -
                                                1
                                             
                                          
                                          ·
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                             
                                                T
                                                -
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                q
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                             
                                                T
                                             
                                          
                                          ·
                                          
                                             
                                                y
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                              
                           
                        subject to constraints (6)–(8) for t
                        =
                        T
                        −1 and 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          max
                                       
                                    
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                                 
                                    T
                                 
                              
                              ,
                              j
                              ∈
                              
                                 
                                    N
                                 
                                 
                                    T
                                 
                              
                           
                        .

Unlike the stage T problem, this modified stage T
                        −1 problem is not separable. The scheme of this solution strategy is to approximate it by a separable, piecewise linear, convex function 
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    T
                                    -
                                    1
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    T
                                    -
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    T
                                    -
                                    1
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                                 
                                    T
                                    -
                                    1
                                 
                              
                              )
                           
                         so that the process could be repeated until the first stage, which becomes a pure deterministic network flow problem.

The key challenge in this solution strategy is how to obtain the approximation 
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    t
                                 
                              
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         for t
                        =
                        T
                        −1, T
                        −2,…,2. One way is to replace the set of 
                           
                              
                                 
                                    q
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                                 
                                    t
                                 
                              
                           
                         by a single value 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    j
                                 
                                 
                                    t
                                 
                              
                           
                         for each node j (see the successive linear approximation method of Frantzeskakis & Powell (1990)). This is equivalent to approximating the convex function 
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         by a linear function. As shown in Fig. 3a
                        , the modified stage t problem becomes a one-level deterministic capacitated transportation with the cost coefficients of the arcs modified as 
                           
                              
                                 
                                    c
                                 
                                 
                                    ij
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    j
                                 
                                 
                                    t
                                 
                              
                           
                        . This problem, again, is separable by locations. Thus, we can apply the same steps of solving last stage problem here. Another way is to use the network recourse decomposition (NRD) of Powell and Cheung (1994b). The deterministic arcs in the second level of the modified stage t problem are duplicated such that the problem can be decomposed into a set of overlapped tree. Each tree is a special tree recourse problem that can be solved by the TREEREC algorithm of Powell and Cheung (1994a). Penalties are added to the arcs for which total expected flow exceeds its mean capacity. Then, the TREEREC algorithm is applied on the trees with modified arc costs. This process is repeated for a pre-specified number of iterations. The idea of NRD is shown in Fig. 3b. This paper develops another decomposition approach such that the modified stage t network is decomposed into tree subproblems by restricting the arcs in the second level to certain trees. With this restriction, there is no duplicated arc among the trees (see Fig. 3c). Each tree recourse problem is solved by the TREEREC algorithm. Then, a set of arcs are identified and exchanged between the trees. The research issue is how to evaluate the cost impact of reallocating an arc from a tree to another tree. We call this method an arc-exchange decomposition method. Section 3 describes a method to estimate this cost impact quickly by utilizing some properties of the tree subproblems. Section 4 provides the steps of the method.

We begin this section with the notation of the tree recourse problem and with a review of the key results of the TREEREC algorithm of Powell and Cheung (1994a). In Section 3.2, we derive a number of properties of the tree recourse problem about the changes of the expected flow when an arc is added to or removed from a tree. These properties are used to develop a method that estimate the changes quickly as described in Section 4.1. The results of the section are used in a key step of the arc-exchange decomposition described later.

Consider a directed tree that has a root node, denoted by r, and two levels of nodes: the branch nodes that are adjacent to the root node, and the leaf nodes that are two arcs away from the root node. The arc capacities of the arcs from the root node to the branch nodes are random variables while the arc capacities from the branch nodes to the leaf nodes, except the last leaf, are 1. The last leaf node of a branch is assumed to have infinite capacity, representing the action of holding a vehicle to the next stage. Let
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      B
                                                   
                                                
                                             
                                          
                                       
                                       the set of branch nodes,
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      L
                                                   
                                                
                                             
                                          
                                       
                                       the set of leaf nodes of the branch node i, 
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      B
                                                   
                                                
                                             
                                          , and
                                    
                                    
                                       
                                          m
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      L
                                                   
                                                
                                                |
                                             
                                          , the number of leaf nodes of the branch node i.
                                    
                                 
                              
                           
                        
                     

For a given branch node, assume that the outbound arcs are indexed according to the increasing arc costs. Let
                           
                              
                                 
                                 
                                 
                                    
                                       (i, i
                                          [j])
                                       the jth ranked arc out of node i according to increasing cost,
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      L
                                                   
                                                
                                             
                                          
                                       
                                       the set of arcs between i and its leaf nodes = 
                                             
                                                {
                                                (
                                                i
                                                ,
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      [
                                                      j
                                                      ]
                                                   
                                                
                                                )
                                                :
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      [
                                                      j
                                                      ]
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      L
                                                   
                                                
                                                }
                                             
                                          , and
                                    
                                    
                                       
                                          ξ
                                          
                                             ri
                                          
                                       
                                       the random arc capacity on arc (r, i).
                                    
                                 
                              
                           
                        
                     

We call the subgraph defined by 
                           
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                          
                                             L
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                          
                                             L
                                          
                                       
                                    
                                 
                              
                           
                         the branch of node i. The notation is illustrated in Fig. 4
                        . Assume that the paths in the tree are sorted in an ascending order according to their costs and call the nth ranked path as path n. To compute the expected total tree cost, the TREEREC algorithm considers the probability of assigning each unit of flow to the paths in the tree, thus we need the following path parameters and variables. Define
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          N
                                          
                                             p
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          , the number of paths in the tree;
                                    
                                    
                                       
                                          c
                                          
                                             n
                                          
                                       
                                       the cost of path n;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  if
                                                                  
                                                                  arc
                                                                  (
                                                                  i
                                                                  ,
                                                                  j
                                                                  )
                                                                  
                                                                  is
                                                                  
                                                                  on
                                                                  
                                                                  path
                                                                  
                                                                  n
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  otherwise
                                                                  ;
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          ϕ(k, n)
                                       the probability that the kth unit of flow entering node r takes the path n;
                                    
                                    
                                       
                                          f
                                          
                                             n
                                          (s)
                                       the expected flow on path n when the supply to the root node is s;
                                    
                                    
                                       
                                          F(s)
                                       the expected tree cost when the supply to the root node is s.
                                    
                                 
                              
                           
                        
                     

From the definitions, it is easy to see that
                           
                              (13)
                              
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          s
                                       
                                    
                                 
                                 ϕ
                                 (
                                 k
                                 ,
                                 n
                                 )
                              
                           
                        while the total expected cost for a given s is
                           
                              (14)
                              
                                 F
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          s
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                                 ϕ
                                 (
                                 k
                                 ,
                                 n
                                 )
                              
                           
                        
                     

The quantity ϕ(k,
                        n) is known as the dispatch probabilities. The TREEREC algorithm uses two sets of auxiliary variables to compute these values. Define
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          Z
                                          
                                             n
                                          
                                       
                                       the total capacity of the first n paths;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      r
                                                      ,
                                                      i
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       the maximum possible flow on arc (r, i) when the first n paths are used.
                                    
                                 
                              
                           
                        
                     

The key steps of the TREEREC algorithm are summarized in Fig. 5
                        .

In Eq. (17), Z
                        
                           n
                         is the sum of independent random variables and thus its distribution can be computed through the convolution of discrete independent random variables. The rationale of Eq. (18) is that the kth unit of flow will use path n only if the total capacity of the first n
                        −1 path is less than k while the total capacity of the first n path is at least k.

In our arc-exchange decomposition method, one critical step is to find the expected cost change due to moving an arc from one tree to another tree. One way to do this is to re-apply the TREEREC algorithm to the modified tree. However, it is very computationally expensive. Thus, we would like to estimate the expected cost change based on the optimal solution of the tree recourse problem. This mimics the ease with which we can estimate the cost change due to the change of resource in linear programs via dual prices. Let
                           
                              
                                 
                                 
                                 
                                    
                                       ΔF(s)
                                       the change of the expected total cost for a given supply s;
                                    
                                    
                                       Δf
                                          
                                             n
                                          (s)
                                       the change of the expected flow on path n for a given supply s.
                                    
                                 
                              
                           
                        
                     

We know from Eq. (14) that
                           
                              
                                 Δ
                                 F
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                                 Δ
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 s
                                 )
                              
                           
                        To compute Δf
                        
                           n
                        (s), without loss of generality, we fix a leaf arc that is to be added to or removed from the tree by denoting
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       the arc to be added to or removed from the tree;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                          
                                       
                                       the rank of path 
                                             
                                                (
                                                r
                                                ,
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                )
                                             
                                          ;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       the capacity of 
                                             
                                                (
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                )
                                             
                                          .
                                    
                                 
                              
                           
                        
                     

Let n be any path in the tree and define
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      +
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       the expected flow on path n when the supply is s and 
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                   
                                                
                                                =
                                                1
                                             
                                          ;
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      -
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                       the expected flow on path n when the supply is s and 
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            [
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                   
                                                
                                                =
                                                0
                                             
                                          .
                                    
                                 
                              
                           
                        
                     

Changing 
                           
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                         from 1 to 0 is equivalent to removing arc 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                    ]
                                 
                              
                              )
                           
                         from the tree and the expected flow on path n will change from 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                           
                         to 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                        . That is, 
                           
                              Δ
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                              
                              (
                              s
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                              -
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                           
                        . On the other hand, changing 
                           
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                         from 0 to 1 is equivalent to adding arc 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                    ]
                                 
                              
                              )
                           
                         to the tree and the expected flow on path n will change from 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                         to 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                           
                        . In this case, 
                           
                              Δ
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                              
                              (
                              s
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                              -
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                        . The section following develops the properties on the relationship between 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                        . These properties are used to estimate 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                         based on 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                           
                         for the case of removing an arc, and to estimate 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                           
                         based on 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                         for the case of adding an arc. In particular, Property 1 considers the flow on path n with 
                           
                              n
                              <
                              
                                 
                                    n
                                 
                                 
                                    ˆ
                                 
                              
                           
                        . Property 2 describes the flow changes on paths where the leaf arcs are in the same branch of arc 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                    ]
                                 
                              
                              )
                           
                         while Property 3 describes those not in the branch of arc 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                    ]
                                 
                              
                              )
                           
                        .
                           Property 1
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          n
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    s
                                    )
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          n
                                       
                                       
                                          -
                                       
                                    
                                    (
                                    s
                                    )
                                 
                               
                              for 
                              
                                 
                                    n
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          ˆ
                                       
                                    
                                    -
                                    1
                                 
                              
                              .
                           

Since ϕ(k, n) only depends on the capacities of the first n paths according to Eq. (18), for 
                           
                              n
                              <
                              
                                 
                                    n
                                 
                                 
                                    ˆ
                                 
                              
                           
                        , the expected flow on path n will not be affected by changing the capacity of arc 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                    ]
                                 
                              
                              )
                           
                        . That is, Δf
                        
                           n
                        (s)=0. Therefore, in the following properties, we only need to consider the path where the rank is larger than 
                           
                              
                                 
                                    n
                                 
                                 
                                    ˆ
                                 
                              
                           
                        .

Consider an arc 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                              
                              )
                              ,
                              
                                 
                                    j
                                 
                                 
                                    ′
                                 
                              
                              >
                              
                                 
                                    j
                                 
                                 
                                    ˆ
                                 
                              
                           
                        , in the branch of node 
                           
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                           
                        . Let n′ denote the rank of path 
                           
                              (
                              r
                              ,
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                              
                              )
                           
                        . Fig. 6
                        (a) shows the tree formed by the first n′−1 paths and Fig. 6(b) shows the tree formed by the first n′ paths. By comparing with these two trees, we can find that their structures are close except that the tree of the first n′ paths has one more arc in the branch 
                           
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                           
                        . However, these two trees are equivalent if the capacity of arc 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                              
                              )
                           
                         in the second tree is 0 but the capacities of other leaf arcs are all 1. Therefore, the total expected flow on the first n′−1 paths when 
                           
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                              =
                              1
                           
                         is equal to the total expected flow on the first n′ paths when 
                           
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                              =
                              0
                           
                        . Consequently, we have the following property.
                           Property 2
                           
                              Consider an arc 
                              
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    >
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              
                              , in the branch of node 
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              
                              . Let n′ denote the rank of path 
                              
                                 
                                    (
                                    r
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                              
                              . Then, we have
                              
                                 
                                    (a)
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             )
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       ,


                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             )
                                             -
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             )
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   +
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             Δ
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       ,


                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             s
                                             )
                                             =
                                             -
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                             Δ
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       ,


                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             s
                                             )
                                             ⩾
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             +
                                             1
                                             )
                                          
                                       , where 
                                          
                                             Δ
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                             
                                             (
                                             s
                                             )
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             s
                                             )
                                             -
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       .

See Appendix.□

In Property 2, we only need to consider the case 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    >
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                               since we know from Property 1 that the flow on path n′ remains the same if 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    <
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              . For 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    >
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              , we have 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    >
                                    
                                       
                                          n
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              . Thus, if 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               is removed, the flow on path 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                               will be diverted to paths with higher cost. Property 2(a) indicates that the total flow on the first n′−1 paths before 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               is removed is equal to the total flow on the first n′ paths after 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               is removed. In Property 2(b), the left side is the difference between the flow on arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               and 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                              . This difference is non-negative because having more flow in the leaf arc with a higher cost than the flow in the leaf arc with a lower cost when both arcs in the same branch is not optimal. Property 2(b) says that if arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               is removed, this flow difference will be redistributed into paths with ranks between 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ˆ
                                       
                                    
                                    +
                                    1
                                 
                               and n′, including the path that does not involve arcs in branch 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              . Property 2(c) describes the flow changes when arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               is added to the tree. When a better path (path 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              ) is present, the flow on the paths with higher costs will be redistributed to path 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              . Property 2(c) says that the total changes of the expected flow on paths with ranks between 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                               and n′−1 will be equal to expected flow on path n′. Finally, Property 2(d) relates the flow change on path n′ to the change of supply. It says that, for the case that arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               is removed, the expected flow on path n′ will be increased to at least 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    s
                                    +
                                    1
                                    )
                                 
                              . For the case that arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               is added, the expected flow on path n′ will decrease, and the value will be at most 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          -
                                       
                                    
                                    (
                                    s
                                    -
                                    1
                                    )
                                 
                              . This is not strange since arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               has lower cost than arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    >
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              . Whenever there is flow on arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                              , there must be one unit of flow on arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                              .

The following property estimates the maximum changes of the expected flow on the paths that involve arc in branch 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    ≠
                                    
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              . In particular, Property 3(a) provides a bound of the change and (b) specifies a condition under which the expected flow will not change.


                              Let arc 
                              
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          ]
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               
                              be in the branch of node i′, 
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    ≠
                                    
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                               
                              and n′ denote the rank of path 
                              
                                 
                                    (
                                    r
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          ]
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              
                              . Because of 
                              
                                 Property 2
                              , assume that 
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    >
                                    
                                       
                                          n
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              
                              . We have
                              
                                 
                                    (a)
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             s
                                             )
                                             ⩽
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             +
                                             1
                                             )
                                          
                                       ;

if 
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   ˆ
                                                
                                             
                                             +
                                             
                                                
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                             >
                                             s
                                          
                                       , then 
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             )
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       .

See Appendix.□


                              Property 3 can be used in two ways to estimate the flow changes. When arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               is removed from the tree, the expected flow on the paths with higher cost will increase or keep no change. Property 3(b) indicates the conditions under which the expected flow on a path will not change. If the expected flow on a path increases after arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               has been removed, Property 3(a) shows that this expected flow will increase, at most, to the level of the expected flow with one more unit of supply at the root node. When arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               is added to the tree, the expected flow on the paths with higher cost will decrease or keep no change. Property 3(b) indicates the conditions under which the expected flow on a path will not change. The expected flow on a path will decrease after arc 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                    )
                                 
                               has been added. Furthermore, Property 3(a) indicates that this expected flow will decrease, at most, to the level of the expected flow with one unit of supply less at the root node.

As discussed earlier, our method involve exchanging arcs between trees based on the cost changes due to the arc exchanges. We describe two heuristics that can estimate the cost changes quickly in Section 4.1, the steps of the decomposition method in Section 4.2, and the upper bound produced by this method in Section 4.3.

By using the properties outlined in Section 3.2, we can estimate the cost change when 
                           
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                         is changed from 1 to 0 by the procedure Cost_Change_For_Arc_Removal and 
                           
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          [
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                         is changed from 0 to 1 by the procedure Cost_Change_For_Arc_Addition (see Figs. 7 and 8
                        
                        ).

For arc removal, we assume that a tree recourse problem is solved and the expected flow of the tree is given by the set of 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                           
                         for n
                        =1,2,…,
                        N
                        
                           p
                        . Let 
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                         be the estimation of the expected flow on path n after removing arc 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                    ]
                                 
                              
                              )
                           
                        . By leveraging the properties in Section 3.2, we develop a procedure to obtain 
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                         based on the values of 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                           
                        .

For arc addition, we assume that a tree recourse problem is solved and the expected flow of the tree is given by the set of 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                         for n
                        =1,2,…,
                        N
                        
                           p
                        . Let 
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                           
                         be the estimation of the expected flow on path n after adding arc 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          j
                                       
                                       
                                          ˆ
                                       
                                    
                                    ]
                                 
                              
                              )
                           
                        . By leveraging the properties in Section 3.2, we develop a procedure to obtain 
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                           
                         based on the values of 
                           
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                        .

We have conducted experiment to assess the accuracy and efficiency of these cost-change estimation procedure. The results are discussed in Section 5.

In the framework of the algorithm described in Section 2, we first solve the stage T problem and get expected recourse functions. Then we deal with the modified stage T
                        −1 problem, which is a two-level network problem with random arc capacities in the first level. We separate the network into a set of tree recourse problems by restricting each second-level arc to a specific tree. The approximation procedures described in Section 4.1 provide a fast estimation of cost change for adding or removing a leaf arc. With these procedures, we estimate the cost reduction of exchanging arcs within trees and select those that most reduce the cost to exchange. After exchanging some arcs, we again solve these separated tree recourse problems. Ideally, for any given supply 
                           s
                        
                        
                           T−1, the total expected costs will decrease. The process is repeated until some stop criterion is met, such as when the number of iterations reaches a limit, or when the total change over some number of iterations is small. We summarize the algorithm in Fig. 9
                        .
                           Remarks
                           If in Step 3.3 of Fig. 9 we were to use exact cost change instead of estimated cost change, the workload would increase significantly, because each iteration requires solving the tree recourse problems many times.

In this subsection, we show that the arc-exchange decomposition method provides an upper bound for multistage network recourse problem. For any given initial supply 
                           s
                        
                        1, let 
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         be the objective value obtained through the arc-exchange decomposition method at stage 1. We show that this value is an upper bound of the optimal value of problem defined in (1)–(8), denoted as Q
                        1(
                           s
                        
                        1).
                           Property 4
                           
                              For any initial supply 
                              
                                 s
                              
                              
                                 1
                              
                              , 
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              .
                           

Define
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      {
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      :
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            {
                                                            j
                                                            :
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      i
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ;
                                                      0
                                                      ⩽
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ⩽
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ∈
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      }
                                                   
                                                , feasible set at stage 1;
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  ξ
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      {
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      :
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            {
                                                            j
                                                            :
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      i
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ;
                                                      0
                                                      ⩽
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ⩽
                                                      
                                                         
                                                            
                                                               
                                                                  ξ
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ∈
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      }
                                                   
                                                , feasible set at stage t, t
                                                =2,3,…,
                                                T;
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   t+1(
                                                   x
                                                
                                                
                                                   t
                                                )
                                             
                                                
                                                   
                                                      {
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      :
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            {
                                                            i
                                                            :
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      j
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      }
                                                   
                                                , resulting supply at time t
                                                +1 from the decision at time t;
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Q
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             the minimum recourse value at time t
                                                +1 by representing 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Q
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      (
                                                      ·
                                                      )
                                                   
                                                 as a set of arcs and assigning these arcs to the notes at time t without duplication.
                                          
                                       
                                    
                                 
                              
                           

From the definition of 
                                 
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                              , we can see that 
                                 
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    ⩾
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    )
                                 
                               for any feasible 
                                 x
                              
                              
                                 t
                              . We show the property by backward induction. For the last stage, we can see that the approximation is exactly equal to the original problem, that is, 
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                               for any 
                                 s
                              
                              
                                 T
                              
                              ⩾
                              
                                 0
                               and any realization 
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                 
                              . Therefore, 
                                 
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    
                                    ≜
                                    
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                       
                                          ξ
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                       
                                          ξ
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    
                                    ≜
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                              .

Suppose that 
                                 
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                              . Then for the stage t
                              −1 problem, we have
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   )
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               t
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               t
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            min
                                                         
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ∈
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  ξ
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ·
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        Q
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            )
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ⩽
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               t
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            min
                                                         
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ∈
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  ξ
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ·
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        Q
                                                                     
                                                                     
                                                                        ^
                                                                     
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            )
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ⩽
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               t
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            min
                                                         
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ∈
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  ξ
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ·
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        Q
                                                                     
                                                                     
                                                                        ∼
                                                                     
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               t
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              Therefore, the claim is also true for t
                              −1. □

There are several goals in the numerical experiment. The first is to evaluate the effectiveness of the approximation procedures by measuring the accuracy for exchanging a pair of arcs. The second is to investigate the convergence behavior of the AED method, and the third is to evaluate the upper bound produced by the AED method. The fourth goal is to compare the solution quality of the AED with the NRD method, and with a deterministic method for the three-stage problem that models the drayage problem. Furthermore, we compare the AED method when it is applied for multistage network with the SCAM and with a deterministic method. All programs of this experiment are coded in Java language and executed on personal computer with 1GHz CPU and 128M RAM.

@&#EXPERIMENTAL DESIGN@&#

We simulate the drayage problem in real life and randomly generate the test problems. The parameters for the random generator include the number of regions, the distances between regions, the net profit of each loaded movement, the cost of each empty movement, the cost for holding a tractor at its current location, the initial tractor allocation and the forecast demands.

In our testing problems, the locations are uniformly located in a 100-by-100-mile rectangle. We use the Euclidean distance between each pair of locations as the corresponding travel distance. The net profit for each loaded tractor movement is 70 cents per mile, while the cost of empty movement is 40 cents per mile. There is no cost for holding a tractor at its current location over time. The initial number of vehicles is made proportional to the average outbound flow of the location. The market demand 
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                           
                         between location i and location j is assumed to follow a Poisson distribution with mean m
                        
                           ij
                         which given by m
                        
                           ij
                        
                        =
                        β
                        
                           i
                        
                        ·
                        α
                        
                           j
                         
                        ·
                        ν, where
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          β
                                          
                                             i
                                          
                                       
                                       outbound potential for location i,
                                    
                                    
                                       
                                          α
                                          
                                             j
                                          
                                       
                                       inbound potential for location j,
                                    
                                    
                                       
                                          ν
                                       
                                       an exponential random variable.
                                    
                                 
                              
                           
                        
                     

These three factors are determined as follows. The inbound potential and outbound potential for each location capture the location’s ability to attract the inbound flows or to generate the outbound flows. According to the real world application, the inbound and outbound are always negatively correlated, so we set β
                        
                           i
                        
                        =2−
                        α
                        
                           i
                         and draw α
                        
                           i
                         uniformly from 0.2 to 1.8 (Cheung & Powell, 1996). Roughly, there are approximately 250 links in each stage for a problem with 40 locations. In the case there are 300 tractors, for instance, the average flow on each link is 1.2. We set the mean of ν as 1.5, which is close to the average flow on each link.

We evaluate the accuracy of our estimation by comparing the estimated with the exact cost change of exchanging an arc between a pair of trees, where the exact change is calculated by solving the tree recourse problem twice. Fig. 10
                         shows the results of exchanging arcs between a pair of trees with 10 leaf arcs. From this figure, we can see that the estimated cost change is the same as the exact cost change for exchanging some arcs. We create additional comparisons on the small, middle and large size problems. The statistic information with sample size 100 shown in Table 1
                         reveals that our estimation procedure of the cost change is significantly faster than the exact calculation while the average bias gap is not crucial.

While solving two-level network problems, the AED method exchange arcs in each iteration such that the total cost will be reduced. The convergency of the AED method is shown in Fig. 11
                         along with the Monte Carlo sampling mean.

The AED method provides an upper bound for the three-stage problem. We compare the AED bound with the existing upper bounds: Donohue-Birge bound and Edmundson-Madansky bound. We compare these bounds using the example shown in Donohue and Birge (1996) and some randomly generated problems. Since Donohue-Birge bound cannot deal with three-stage stochastic network flow problem, we replace the third stage by their expected marginal cost, which is deterministic. We compare the gaps between the bounds and the Monte Carlo sampling mean of 1000 samples. The results in shown in Table 2
                        . The Problem P1 is the example in Donohue and Birge (1996) where the distributions of the arc capacities are given. Problem P2 has the same structure with P1 but the distributions of the arc capacities are replaced by uniform distribution. From this table, we can see that the AED method performs better than both Donohue-Birge bound and Edmundson-Madansky bound.

The AED method is applied to solve three-stage and multistage problems. We compare the quality of the solution with the existing method. One is the SCAM presented in Cheung and Powell (1996). The procedure of SCAM method is similar with the one of AED method, except that the expected recourse functions of two-level networks are obtained by network recourse decomposition method. In the mean method, the capacity of each arc is replaced by its expected value and the deterministic network flow problem is solved. The fourth method is called myopic method, in which the decisions are made to maximize the benefit of the current stage. The costs obtained by these three methods are compared with the posterior bound of the problem, which is obtained by solving a network flow problem only after the random arc capacities in all stages are known. Note that for each realization of the arc capacities, the posterior bound is a lower bound of any optimal solution method. The results of this comparison is shown in Table 3
                        , where we make 10 runs for each instance.

From this table, we can see that the AED method is significantly better than mean method and the myopic method, and is slightly better than the SCAM method. This result is not strange since the procedure structures of these two methods are similar. Note that the computational work required by the AED method is less than the SCAM method. The AED method is faster than the SCAM, which is more clear for multistage networks. The results for multistage networks are shown in Table 4 and 5
                        
                        , in which each network has 14 stages.

@&#CONCLUSION@&#

It is generally computationally intensive to analyze multistage dynamic networks with random arc capacities (MDNRAC). We exploit the problem structures and propose a new decomposition method to solve the problem efficiently. Specifically, we decompose the network problem at each stage into tree subproblems, and by doing so, we are able to approximate the expected cost-to-go by piecewise linear convex functions. We develop an arc-exchange decomposition (AED) method to solve the tree subproblems efficiently. Based on this decomposition method, we provide an upper bound as well as a solution method to the MDNRAC problem. We compare the new upper bound and solution quality with the existing methods. The experimental results show that the new solution is significantly better than the existing methods in terms of either quality or computational time.

One future direction of research is to improve both the quality and the speed of the estimation of the AED procedure. Seeking the application of AED scheme to other types of stochastic networks (e.g.,network with random cost) is another direction of our future research.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to thank the editor, Professor Immanuel Bomze and the anonymous reviewer for their constructive comments and suggestions. We are also grateful to Professor Vernon N. Hsu of Chinese University of Hong Kong and Professor Ke Fu of Sun Yat-sen University for their valuable comments on the revision of this paper.

In order to prove Properties 2 and 3. Define
                        
                           
                              
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Z
                                                
                                                
                                                   n
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                    
                                    Total capacity of the first n paths while the external supply is s and the arc capacity of arc 
                                          
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   ˆ
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ]
                                                
                                             
                                             )
                                          
                                        is 1;
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Z
                                                
                                                
                                                   n
                                                
                                                
                                                   -
                                                
                                             
                                          
                                       
                                    
                                    Total capacity of the first n paths while the external supply is s and the arc capacity of arc 
                                          
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   ˆ
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ]
                                                
                                             
                                             )
                                          
                                        is 0;
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   r
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   n
                                                   ,
                                                   +
                                                
                                             
                                          
                                       
                                    
                                    Maximum possible flow on arc (r, i) when the first n paths are used and the arc capacity of arc 
                                          
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   ˆ
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ]
                                                
                                             
                                             )
                                          
                                        is 1;
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   r
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   n
                                                   ,
                                                   -
                                                
                                             
                                          
                                       
                                    
                                    Maximum possible flow on arc (r, i) when the first n paths are used and the arc capacity of arc 
                                          
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   ˆ
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ]
                                                
                                             
                                             )
                                          
                                        is 0.
                                 
                              
                           
                        
                     
                  

(a) According to Eqs. (13) and (18), we have:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             )
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             ϕ
                                             (
                                             k
                                             ,
                                             n
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             (
                                             P
                                             {
                                             
                                                
                                                   Z
                                                
                                                
                                                   n
                                                
                                                
                                                   +
                                                
                                             
                                             ⩾
                                             k
                                             }
                                             -
                                             P
                                             {
                                             
                                                
                                                   Z
                                                
                                                
                                                   n
                                                   -
                                                   1
                                                
                                                
                                                   +
                                                
                                             
                                             ⩾
                                             k
                                             }
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                             P
                                             (
                                             
                                                
                                                   Z
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   -
                                                   1
                                                
                                                
                                                   +
                                                
                                             
                                             ⩾
                                             k
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        Similarly,
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                    
                                       -
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          s
                                       
                                    
                                 
                                 P
                                 
                                    
                                       
                                          
                                             
                                                Z
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                -
                                             
                                          
                                          ⩾
                                          k
                                       
                                    
                                 
                              
                           
                        By Eq. (17),
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Z
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   -
                                                   1
                                                
                                                
                                                   +
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ,
                                                      i
                                                      ≠
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   ri
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   r
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   -
                                                   1
                                                   ,
                                                   +
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Z
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ,
                                                      i
                                                      ≠
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   ri
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   r
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   -
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        By definition, 
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    -
                                 
                              
                              =
                              min
                              {
                              
                                 
                                    ξ
                                 
                                 
                                    r
                                    ,
                                    i
                                 
                              
                              ,
                              j
                              -
                              1
                              }
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    1
                                    ,
                                    +
                                 
                              
                              =
                              min
                              {
                              
                                 
                                    ξ
                                 
                                 
                                    r
                                    ,
                                    i
                                 
                              
                              ,
                              j
                              -
                              1
                              }
                           
                        . So, 
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    -
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    1
                                    ,
                                    +
                                 
                              
                           
                         have the same distribution function. And for 
                           
                              i
                              
                              ≠
                              
                              
                                 
                                    i
                                 
                                 
                                    ˆ
                                 
                              
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ri
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ri
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        . Thus, 
                           
                              
                                 
                                    Z
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    1
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Z
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                           
                         have the same distribution and 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    n
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    n
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    n
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                        .

(b) It is easy to verify that (a) is also true for 
                           
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    n
                                 
                                 
                                    ˆ
                                 
                              
                           
                        . Applying (a) for ℓand n′, we have:
                           
                              (19)
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                    
                                       +
                                    
                                 
                                 (
                                 s
                                 )
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                    
                                       +
                                    
                                 
                                 (
                                 s
                                 )
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       ℓ
                                       -
                                       1
                                    
                                    
                                       +
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                    
                                       -
                                    
                                 
                                 (
                                 s
                                 )
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                    
                                       -
                                    
                                 
                                 (
                                 s
                                 )
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       ℓ
                                       -
                                       1
                                    
                                    
                                       -
                                    
                                 
                                 (
                                 s
                                 )
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       ℓ
                                    
                                    
                                       -
                                    
                                 
                                 (
                                 s
                                 )
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                    
                                       +
                                    
                                 
                                 (
                                 s
                                 )
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                    
                                       +
                                    
                                 
                                 (
                                 s
                                 )
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       1
                                    
                                    
                                       +
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                    
                                       -
                                    
                                 
                                 (
                                 s
                                 )
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                    
                                       -
                                    
                                 
                                 (
                                 s
                                 )
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       1
                                    
                                    
                                       -
                                    
                                 
                                 (
                                 s
                                 )
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       -
                                    
                                 
                                 (
                                 s
                                 )
                              
                           
                        Subtract (19) from (20), then we obtain:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             )
                                             +
                                             ⋯
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   -
                                                   1
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             )
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   ℓ
                                                   +
                                                   1
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             s
                                             )
                                             +
                                             ⋯
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ℓ
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             )
                                             -
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             )
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ℓ
                                                            +
                                                            1
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      s
                                                      )
                                                      -
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ℓ
                                                            +
                                                            1
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      s
                                                      )
                                                   
                                                
                                             
                                             +
                                             ⋯
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      s
                                                      )
                                                      -
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      s
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      ℓ
                                                      +
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                             Δ
                                             
                                                
                                                   f
                                                
                                                
                                                   n
                                                
                                             
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        Similarly, by subtracting (20) from (19) we can prove (c).

(d) By definition,
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             s
                                             )
                                             =
                                             Pr
                                             (
                                             
                                                
                                                   ξ
                                                
                                                
                                                   r
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                             
                                             ⩾
                                             j
                                             -
                                             1
                                             )
                                             ·
                                             Pr
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     B
                                                                  
                                                               
                                                               ,
                                                               i
                                                               ≠
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            ri
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      ⩽
                                                      s
                                                      -
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             s
                                             +
                                             1
                                             )
                                             =
                                             Pr
                                             (
                                             
                                                
                                                   ξ
                                                
                                                
                                                   r
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                             
                                             ⩾
                                             j
                                             )
                                             ·
                                             Pr
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     B
                                                                  
                                                               
                                                               ,
                                                               i
                                                               ≠
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            ri
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      ⩽
                                                      s
                                                      -
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        It is obvious that 
                           
                              Pr
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              
                              ⩾
                              j
                              -
                              1
                              )
                              ⩾
                              Pr
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              
                              ⩾
                              j
                              )
                           
                        . Therefore, 
                           
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                              ⩾
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              +
                              1
                              )
                           
                        .

(a) By definition,
                           
                              (21)
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       -
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 Pr
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             ri
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ·
                                 Pr
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       r
                                       
                                          
                                             i
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       -
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                B
                                             
                                          
                                          ,
                                          i
                                          ≠
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                          ,
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       ri
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 s
                                 -
                                 
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 (
                                 s
                                 +
                                 1
                                 )
                                 =
                                 Pr
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             ri
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ·
                                 Pr
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       r
                                       
                                          
                                             i
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       +
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                B
                                             
                                          
                                          ,
                                          i
                                          ≠
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                          ,
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       ri
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 s
                                 +
                                 1
                                 -
                                 
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 .
                              
                           
                        For any ω, 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    +
                                 
                              
                              (
                              ω
                              )
                              ⩽
                              
                                 
                                    ξ
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    -
                                 
                              
                              (
                              ω
                              )
                              +
                              1
                           
                        . Therefore, 
                           
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                              ⩽
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              +
                              1
                              )
                           
                        .

(b) By conditioning on the value of 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    -
                                 
                              
                           
                        , we can rewrite Eq. (21) as
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       -
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 Pr
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             ri
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ·
                                 Pr
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                r
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                -
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   ,
                                                   i
                                                   ≠
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                ri
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ⩽
                                          s
                                          -
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          |
                                          
                                             
                                                ξ
                                             
                                             
                                                r
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                -
                                             
                                          
                                          <
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 Pr
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       r
                                       
                                          
                                             i
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       -
                                    
                                 
                                 <
                                 
                                    
                                       j
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                                 +
                                 Pr
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             ri
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ·
                                 Pr
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                r
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                -
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   ,
                                                   i
                                                   ≠
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                ri
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ⩽
                                          s
                                          -
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          |
                                          
                                             
                                                ξ
                                             
                                             
                                                r
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                -
                                             
                                          
                                          ⩾
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 Pr
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       r
                                       
                                          
                                             i
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       -
                                    
                                 
                                 ⩾
                                 
                                    
                                       j
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                           
                        Since 
                           
                              
                                 
                                    j
                                 
                                 
                                    ˆ
                                 
                              
                              +
                              
                                 
                                    j
                                 
                                 
                                    ′
                                 
                              
                              >
                              s
                           
                        , the second part of 
                           
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                         in the above equation must be 0. Similarly, we have
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 Pr
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             ri
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ·
                                 Pr
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                r
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                +
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   ,
                                                   i
                                                   ≠
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                ri
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ⩽
                                          s
                                          -
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          |
                                          
                                             
                                                ξ
                                             
                                             
                                                r
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                +
                                             
                                          
                                          <
                                          
                                             
                                                j
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 Pr
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       r
                                       
                                          
                                             i
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       +
                                    
                                 
                                 <
                                 
                                    
                                       j
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                           
                        From definition, 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    -
                                 
                              
                              =
                              
                                 
                                    ξ
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    -
                                 
                              
                              =
                              
                                 
                                    ξ
                                 
                                 
                                    r
                                    
                                       
                                          i
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              
                           
                         when they are less than 
                           
                              
                                 
                                    j
                                 
                                 
                                    ˆ
                                 
                              
                           
                        . Therefore, 
                           
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              s
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              s
                              )
                           
                        .

@&#REFERENCES@&#

