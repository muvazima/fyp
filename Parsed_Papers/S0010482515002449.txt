@&#MAIN-TITLE@&#Detection of the optic disc in fundus images by combining probability models

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose an ensemble framework of detectors for OD localization.


                        
                        
                           
                           We use probability maps for the detection.


                        
                        
                           
                           We investigate some combination approach.


                        
                        
                           
                           Our method outperforms several state-of-the-art approaches.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Optic disc

Object detection

Ensemble-based system

Naïve Bayes

Information fusion

@&#ABSTRACT@&#


               
               
                  In this paper, we propose a combination method for the automatic detection of the optic disc (OD) in fundus images based on ensembles of individual algorithms. We have studied and adapted some of the state-of-the-art OD detectors and finally organized them into a complex framework in order to maximize the accuracy of the localization of the OD. The detection of the OD can be considered as a single-object detection problem. This object can be localized with high accuracy by several algorithms extracting single candidates for the center of the OD and the final location can be defined using a single majority voting rule. To include more information to support the final decision, we can use member algorithms providing more candidates which can be ranked based on the confidence ordered by the algorithms. In this case, a spatial weighted graph is defined where the candidates are considered as its nodes, and the final OD position is determined in terms of finding a maximum-weighted clique. Now, we examine how to apply in our ensemble-based framework all the accessible information supplied by the member algorithms by making them return confidence values for each image pixel. These confidence values inform us about the probability that a given pixel is the center point of the object. We apply axiomatic and Bayesian approaches, as in the case of aggregation of judgments of experts in decision and risk analysis, to combine these confidence values. According to our experimental study, the accuracy of the localization of OD increases further. Besides single localization, this approach can be adapted for the precise detection of the boundary of the OD. Comparative experimental results are also given for several publicly available datasets.
               
            

@&#INTRODUCTION@&#

More than 360 million people were suffering from diabetes in 2012 worldwide. The number of the diagnosed cases has been growing rapidly in the last few years and this tendency is estimated to continue [1]. Long-term diabetes also affects the eye, resulting in a disease called diabetic retinopathy (DR). If DR remains undiagnosed or is treated inappropriately, it can lead to the loss of vision. In addition, DR is the most common cause of blindness in the world. However, there are suitable ways of treatment to slow down the deterioration of the eye-sight. An automatic screening system for DR would be of great importance mainly in the developing countries, where nearly 40% of the cases remain undiagnosed. Such a system is useful if it is capable of detecting the first signs of the disease. The blood vessels that provide nourishment to the retina, in case of a person with diabetes, may weaken and leak, forming small, dot-like hemorrhages known as microaneurysms and hemorrhages. Exudates come into when fluid exudes from tissue because of its injured capillaries. The masking out the OD region in the image is highly recommended by [2–4] before the detection of exudates and cotton-wool spots, as these lesions appear in the retinal images as bright patches which are similar to the OD concerning their color and shape characteristics. Moreover, if the position and the radius of the OD are detected correctly, they can be used as references for approximating other anatomical parts e.g. the macula and the fovea, as it is proposed in [5] or to analyze pathologies e.g. glaucoma or neovascularization on the disc.

In the corresponding literature, several OD detection algorithms are published [6–15]. Most of these try to perform the extraction of the OD based on color, size, shape, direction of vessels, etc. For example, Mendels et al. [10] used morphological filtering and active contours to find the boundary of the OD, while Sekhar et al. [7] applied morphological operations and Hough-transformation to localize it. Here, the proposed method consists of two steps: in the first step, a circular region of interest is found by isolating the brightest area in the image by means of morphological processing, and in the second step, the Hough-transformation is used to detect the main circular feature (corresponding to the OD) in the positive horizontal gradient image within this region of interest. Abramoff et al. [8] proposed a kNN regression approach to find relationship between the dependent variable d which represents the distance from the OD center, and a feature vector extracted around a circular template. Shijian [9] used circular transformation which is capable of detecting both the OD center and its boundary from images of pathological retinas, as well. Lalonde et al. [10] proposed an algorithm (OD
                     
                        decomp
                     ) which generates a pyramid with a simple Haar-based discrete wavelet transformation. The input image has low resolution after its decomposition is repeated four or five times and the pixel of this low-resolution image with highest intensity value is considered as the center of the OD. Another approach (OD
                     
                        edge
                     ) in [10] uses edge detection applying the Rayleigh-based CFAR threshold. This solution guarantees the strong edges which are associated with the border of anatomical structures. In the next step, the Hausdorff distance is calculated between the set of edge points and a circular template like the average OD. The lowest distance value corresponds to the center of the OD. Sopharak et al. [11] proposed a method (OD
                     
                        entropy
                     ) which applies a median and a CLAHE filter on the green intensity channel. The entropy of the intensity values in the local region around each pixel is calculated and the location of the highest entropy values is considered to belong to the OD. Niemeijer et al. [12] proposed feature extraction and classification steps (OD
                     
                        classify
                     ) to determine the area of the OD. They suggest the following features: number, width, orientation and density of vessel segments. In the next step, a kNN classifier made a decision about each pixel whether they belong to the OD, or not. Hoover et al. [13] thinned the vessel system and each line-shape segment is modeled by a fuzzy segment. This model (OD
                     
                        fuzzy
                     ) creates a voting map and the pixel obtaining the most votes is considered to be the center of the OD. Ravishankar et al. [14] proposed an algorithm (OD
                     
                        hough
                     ) which uses Hough-transformation on the thinned vessel system. Lines which have slope less than 45° are eliminated. The intersection points of the rest of the lines give a voting map. Number of votes is weighted with the original intensity values of the intersection points in the image, and the highest corresponding value indicates the center of the OD. Finally, Zhu et al. [15] locate the border of the OD in terms of a circle with a given diameter using the circular Hough-transformation (OD
                     
                        cHough
                     ). For this aim, edge detection is applied and the circle containing the most edge points is selected.

There is, in fact, no reason to assume that any single algorithm would be optimal for the detection of various anatomical parts of the retina. It is difficult to determine which the best approach is, because good results were reported for healthy retinas but weaker ones for more challenging datasets containing diseased retinas with variable appearance of ODs in term of intensity, color, contour definition and so on. To overcome the imperfectness of the individual algorithms, we study and adapt some of the state-of-the-art OD detectors and finally organize them into an ensemble framework in order to combine their strengths and maximize the accuracy of the localization of the OD. First in [16], we suggested an ensemble of them and tested a majority voting scheme with a circular template to detect the correct position of the OD center, where the individual algorithms had just a single candidate. As a further improvement of this model, in [17], we extracted more than one candidate for each algorithm to increase the chance of getting the OD location among them. We assigned weight to each candidate to replace simple majority voting by a weighted one and treated them as weighted nodes of a complete graph. For the location of the OD center, we selected that subgraph of the candidates which met the OD geometry constraint and had a maximal total weight. For this selection, we borrowed a graph theoretical approach supplying the optimal solution in terms of a maximal weighted clique.

Besides increasing the accuracy of the detection of the OD center, our aim is also the segmentation of the OD region so that it can be entirely eliminated before the detection of bright lesions. In this paper, we propose a method to maximize the accuracy of the localization of the OD and to determine its region. As we have mentioned earlier, in our former ensemble-based approaches we considered only one, then up to five possible OD center points as the output of each individual algorithm. Now, to utilize all available information corresponding to the possible location of the OD provided by the algorithms, we let them assign probability (confidence) values to each pixel of the input image. In this way, probability maps are composed of the member algorithms and a suitable combination of these maps can be considered to locate the correct OD region. Taking advantage of more information is supposed to lead to improvement, which is a natural expectation validated by our experiment studies. Namely, in our tests, the proposed method outperformed both the simpler ensemble-based systems and the state-of-the-art individual member algorithms on publicly available datasets.

The rest of the paper is organized as follows. In Section 2, we give a brief overview about our former ensemble-based systems used for OD detection. In Section 3, we introduce our methodology for the detection of the center and region of the OD based on the combination of probability maps provided by the individual algorithms. In Section 4, we describe the considered datasets for experimental evaluation. Section 5 is dedicated to our experimental results also in comparison with some other state-of-the-art OD detection methods. Finally, further technical details are discussed in Section 6, and some conclusions are drawn in Section 7.

In this section, we introduce our fusion strategies which are based on the majority voting scheme, finding maximal-weighted clique and combining probability maps, respectively. Besides giving detailed description of these frameworks, we show the positive effect of exploiting more and more information for the localization of a single object.

In [16], we have proposed an ensemble-based single object detection system based on simple majority voting which outperforms the member detectors [10–15]. Here, the single outputs for the object center of the member algorithms are merged and the majority voting scheme is applied using a template of the shape of the object to detect its correct position. More precisely, to overcome the imperfectness of the member algorithms, a template 
                           D
                         is fit on each pixel 
                           
                              
                                 p
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                         of the input image 
                           I
                         and the outputs of the algorithms that fall within 
                           D
                         are summed. The center of the 
                           D
                         covering the maximum number of detector outputs is considered to be a hot spot for the object. There can be more hot spots, hence they together define a hot spot region. To find the final center of the single object 
                           (
                           
                              
                                 
                                    x
                                 
                                 
                                    r
                                    e
                                    s
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    r
                                    e
                                    s
                                 
                              
                           
                           )
                        , the centroids of the outputs within the hot spot region are computed.

For an impression, see 
                        Fig. 1 for the output of the OD detectors OD
                        
                           decomp
                        
                        , OD
                        
                           edge
                        
                        , OD
                        
                           entropy
                        
                        , OD
                        
                           classify
                        
                        , OD
                        
                           fuzzy
                        
                        , OD
                        
                           hough
                        
                        , OD
                        
                           cHough
                         together with the manually selected center (ground-truth) OD
                        
                           manual
                         of the OD. As for the specific example in Fig. 1, with ignoring the candidates of OD
                        
                           edge
                         and OD
                        
                           fuzzy
                        , the true OD location has been found based on the ensemble of the result of OD
                        
                           decomp
                        , OD
                        
                           entropy
                        , OD
                        
                           classify
                        , OD
                        
                           hough
                         and OD
                        
                           cHough
                        .

To use the simple majority voting scheme for OD detection, a circular template 
                           
                              
                                 D
                              
                              
                                 R
                              
                           
                         of radius 
                           R
                           >
                           0
                         is fit on each pixel and the outputs of the detectors within 
                           
                              
                                 D
                              
                              
                                 R
                              
                           
                         are counted. Based on some preliminary experiments on the manually segmented OD regions (ODR), the value of R is set to 6.5% of the width of the region of interest (ROI) of the fundus image. In 
                        Fig. 2(a) and (b), we can observe the hot spot region composed of the hot spots containing the maximum number of outputs. If there are more hot spot regions, we apply a complementary post processing step. Namely, a Gaussian filter is applied on the green channel of the image with a large variance parameter (σ=300). The smoothed image is subtracted from the original one to make the OD appear as a brighter patch compared with the background. The average intensities around the output of the detectors are computed in the hot spot regions and the region with the highest average intensity is selected as the final OD hot spot region. However, as it can be seen in Fig. 2(b), majority voting may fail to detect the correct OD center, especially, in case of a diseased retina. Therefore, we proposed a more sophisticated method to avoid these shortcomings, explained in the following section.

In [17], we examined how to improve the performance of the ensemble-based system, when the candidates of the member algorithms do not fall within the true single object region. We found that if we let the members suggest more candidates, one of them falls inside the true region of the object with higher probability. However, if we consider the outputs of only a single algorithm as candidates we should select one of them as a final output. For this selection, we have to choose an appropriate post processing step which means something like new algorithms. In this case, the single object detection is performed by only one algorithm which may have any imperfectness. Instead of considering the candidates of one member, we took all candidates of each involved member algorithm into account and we assigned weights to each candidate based on their priority suggested by the members. Then, these weighted candidates were considered as vertices of a graph, where we were looking for a subgraph with a maximal sum of weights constrained also by the geometry of the single object.

In this ensemble-based approach it is a key issue to determine, how many candidates for a member we should consider. Let 
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           ∈
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         denote the jth candidate of the ith member algorithm 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         (i=1,2,…,N), (j=1,2,…,
                           |
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                           |
                        ), where 
                           
                           N
                         denotes the number of member algorithms, 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         the set of candidates of 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         and 
                           |
                           .
                           |
                         the cardinality of a set. Let 
                           
                              
                                 c
                              
                              
                                 i
                              
                              
                                 ⁎
                              
                           
                         mean that the candidate of 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         which falls inside the true object region. Then, on the one hand we have to increase 
                           |
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                           |
                         till 
                           
                              
                                 c
                              
                              
                                 i
                              
                              
                                 ⁎
                              
                           
                           ∈
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        . On the other hand we have to keep 
                           |
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                           |
                         relatively small to avoid too many false positive which would confuse the final combination. To solve this problem, for each algorithm, we used a training dataset and checked the ratio of the images with 
                           
                              
                                 c
                              
                              
                                 i
                              
                              
                                 ⁎
                              
                           
                           ∈
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         and selected the smallest 
                           |
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                           |
                         as the number of candidates above which the increase of 
                           P
                           
                              (
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                    
                                       ⁎
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                              
                              )
                           
                         slows down. Namely, we try to determine the maximum curvature of the line which connects the accuracies of 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         considering its jth candidate (j=1,2,…,
                           |
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                           |
                        ). A similar approach for selecting the number of classes is known as the elbow-criterion in statistics.

After determining 
                           |
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                           |
                         for 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         (i=1,2,…,N), we compose a weighted graph from the candidates with letting 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         (i=1,2,…,N) assign a confidence level 
                           C
                           o
                           n
                           f
                           (
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           )
                           ϵ
                           
                              
                                 ℛ
                              
                              +
                           
                         (j=1,2,…,
                           
                           
                              |
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                              
                              |
                           
                        ) to each of its candidates. Using these confidence levels, we can sort the candidates of 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         in a priority order so that 
                           C
                           o
                           n
                           f
                           (
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 k
                              
                           
                           )
                           ≥
                           C
                           o
                           n
                           f
                           (
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 l
                              
                           
                           )
                         for any 1≤k<l≤
                        
                           |
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                           |
                        . Then, we assign weights to the candidates, as:
                           
                              (1)
                              
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       C
                                       o
                                       n
                                       f
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       C
                                       o
                                       n
                                       f
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        for i=1,2,…,N, j=1,2,…,
                           
                           
                              |
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                              
                              |
                           
                        . Note that, this normalization will give 
                           
                              
                                 ω
                              
                              
                                 i
                                 ,
                                 1
                              
                           
                           =
                           1
                         (weight 1 for every first candidate) for i=1,2,…,N.

Finally, we connect those vertices of the graph with edges which fall inside a possible region of the object, that is, their distance is smaller than the average diameter of the region of the single object. In this graph, we look for the clique with maximal sum of weights of nodes. We note that, the number of candidates of the member algorithms should be kept relatively low to avoid very large graphs, where the weighted clique search algorithm would become inefficient. Moreover, if we let the 
                           |
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                           |
                         (i=1,2,…,N) increase beyond a meaningful limit, too many false positive vertices can meet within a false region even accidently which has a negative effect for the detection of the final location of the OD. Furthermore, the moderate slopes of the lines after the maximal curvature in Fig. 4 means that the jth candidate 
                           (
                           
                              j
                              >
                              
                                 |
                                 
                                    
                                       
                                          C
                                       
                                       
                                          i
                                       
                                    
                                 
                                 |
                              
                           
                           )
                         of 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         falls inside the true region of the object only in few times. To validate our selection approach also in an objective way, we have tested the performance of the maximal weighted clique-based ensemble when each member algorithm provides one more and one less candidate than the values corresponding to the elbow. Since the description of the test databases are given in the forthcoming sections, the corresponding quantitative results will be enclosed in Section 6.

The corresponding (NP-hard) graph theoretical problem in this representation is known as the maximum-weighted clique finding problem. For the solution of this task, we borrow an algorithm from [18] which is based on heuristic vertex-coloring and backtrack search. This algorithm provides the maximum-weighted cliques and works quickly also on dense graphs. The final object center 
                           (
                           
                              
                                 
                                    x
                                 
                                 
                                    r
                                    e
                                    s
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    r
                                    e
                                    s
                                 
                              
                           
                           )
                         is determined as the centroid of the maximum-weighted clique.

To see the performance of the framework considering more candidates of the members regarding the problem of OD detection, we have included the same member algorithms 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           =
                        
                        OD
                        
                           decomp
                        
                        , 
                        
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           =
                        
                        OD
                        
                           edge
                        
                        , 
                        
                           
                              
                                 A
                              
                              
                                 3
                              
                           
                           =
                        
                        OD
                        
                           entropy
                        
                        , 
                        
                           
                              
                                 A
                              
                              
                                 4
                              
                           
                           =
                        
                        OD
                        
                           classify
                        
                        , 
                        
                           
                              
                                 A
                              
                              
                                 5
                              
                           
                           =
                        
                        OD
                        
                           fuzzy
                        
                        , 
                        
                           
                              
                                 A
                              
                              
                                 6
                              
                           
                           =
                        
                        OD
                        
                           hough
                        
                        , 
                        
                           
                              
                                 A
                              
                              
                                 7
                              
                           
                           =
                        
                        OD
                        
                           cHough
                         to make the results comparable with the simple majority voting scheme. Though we should preserve the basic principles of the member algorithms, in this case we have to extract more than one candidate for each of them. For this purpose, for each 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         (i=1,2,…,7) we mask out its first candidate by the disc template 
                           
                              
                                 D
                              
                              
                                 2
                                 R
                              
                           
                        , after which the algorithm should locate the next candidate within the remaining image region and so an (see 
                        Fig. 3). In this way, we can assure that a possible OD region is suggested by at most one candidate of each member.

The number of candidates 
                           |
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                           
                           |
                         for 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         (i=1,2,…,7) were selected as the values after which 
                           P
                           
                              (
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                    
                                       ⁎
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                              
                              )
                           
                         slows down and where the curvature of these lines is the maximum as shown also in 
                        Fig. 4.


                        
                           C
                           o
                           n
                           f
                           (
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           )
                         are calculated using the original principles of 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         for all of its candidates. The weights for each candidate were defined using (1), and the nodes falling inside a same 
                           
                              
                                 D
                              
                              
                                 R
                              
                           
                         are connected by edges. For such a graph and the final results of the maximal weighted clique-based combination of the members see 
                        Fig. 5(a) and (b). Note that, the input fundus images are the same in Figs. 2(b) and 5(a) for the better comparability of the ensemble-based systems.

As it can be seen in Fig. 5(b), in some cases the maximum-weighted clique-based ensemble of the member algorithms still could not find the correct location. Moreover, these extracted candidates cannot be used for the detection of the precise region of the object. These are the reasons for which we examine further possibilities to take advantage of all the information provided by the member algorithms about the location of the single object. Namely, we let them assign confidence values to each pixel of the input image. In this way, probability maps are composed by the member algorithms and a suitable combination of these maps can be considered to locate the correct OD region.

The basic idea of the proposed method is to utilize as much information as possible about the location of a single object. Namely, we expect the member algorithms to assign a value 
                        C
                        o
                        n
                        f
                        
                           (
                           
                              
                                 
                                    p
                                 
                                 
                                    x
                                    ,
                                    y
                                 
                              
                           
                           )
                        
                      to each 
                        
                           
                              p
                           
                           
                              x
                              ,
                              y
                           
                        
                        ∈
                        I
                      indicating their confidence that 
                        
                           
                              p
                           
                           
                              x
                              ,
                              y
                           
                        
                      is the center of the object. The most of the algorithms basically assign such a value to each pixel but they apply a threshold to select only one location corresponding to the highest value. Thus, we can easily modify them with omitting their final thresholding step and can consider each pixel as a candidate equipped with confidence values by each member algorithm. These confidence values define probability maps (PM) for the input image. Now, we introduce some possible approaches to fuse these maps in order to increase the accuracy of single object detection.

The fields of decision making and risk analysis, where information derived from several experts and aggregated by a decision maker, have a well-established literature [19–21]. In general, the aggregation of information increases the precision of the forecast. In our scenario, we can consider the assigned confidence values to each 
                        
                           
                              p
                           
                           
                              x
                              ,
                              y
                           
                        
                        ∈
                        I
                      as the opinion of the member algorithms on how probable the given pixel is the center point of the object. Based on the fact of the positive effect of the ensemble, if we consider the algorithms as experts with voting their confidence value and apply aggregation accordingly, the accuracy of the single object detection should improve.

As a short summary concerning the combination of information derived from experts, basically two approaches are known in the corresponding literature. One of them is based on clearly established mathematical rules, whereas the other one is entrusted to the interaction of experts, also known as a behavior-based method. In a behavior-based model, the experts contact the decision maker directly or indirectly to make him/her take their arguments and statements into consideration to reach consensus. In this approach, the quality of the individual experts and the dependencies among them are considered implicitly rather than explicitly. So, we examine only the applicability of strict theoretical approaches which are widely available in the literature from the simple axiomatic methods to the processes requiring different information aggregation models. In the case of single object detection, axiomatic approaches can be applied easily to each 
                        
                           
                              p
                           
                           
                              x
                              ,
                              y
                           
                        
                        ∈
                        I
                      to aggregate the probability values assigned by 
                        
                           
                              A
                           
                           
                              i
                           
                        
                      (i=1,2,…,N) to 
                        
                           
                              p
                           
                           
                              x
                              ,
                              y
                           
                        
                     . Considering the more complex approaches, we should apply a training set to determine all the necessary parameters to set up the model for the ensemble.

To start the proper formalization of the proposed ensemble-based framework, let the true (ground-truth) center of the single object be denoted by 
                        (
                        
                           
                              x
                           
                           
                              m
                              a
                              n
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              m
                              a
                              n
                           
                        
                        )
                     . Let 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      denote the event when 
                        
                           
                              p
                           
                           
                              x
                              ,
                              y
                           
                        
                        =
                        (
                        
                           
                              x
                           
                           
                              m
                              a
                              n
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              m
                              a
                              n
                           
                        
                        )
                     , while 
                        
                           
                              L
                           
                           
                              0
                           
                        
                      the one, when 
                        
                           
                              p
                           
                           
                              x
                              ,
                              y
                           
                        
                        ≠
                        (
                        
                           
                              x
                           
                           
                              m
                              a
                              n
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              m
                              a
                              n
                           
                        
                        )
                     . Since most of the object detection algorithms use various features of 
                        
                           
                              p
                           
                           
                              x
                              ,
                              y
                           
                        
                      and its neighborhood for localization, let 
                        
                           
                              H
                           
                           
                              i
                           
                        
                        
                           (
                           
                              x
                              ,
                              y
                           
                           )
                        
                      (i=1,2,…,N) be the set of these features based on which 
                        
                           
                              A
                           
                           
                              i
                           
                        
                      assign a probability value to 
                        
                           
                              p
                           
                           
                              x
                              ,
                              y
                           
                        
                     . To show the confidence of 
                        
                           
                              A
                           
                           
                              i
                           
                        
                      that 
                        
                           
                              p
                           
                           
                              x
                              ,
                              y
                           
                        
                      is the center of the object, a probability map 
                        P
                        
                           
                              M
                           
                           
                              i
                           
                        
                      (i=1,2,…,N) can be defined as:
                        
                           (2)
                           
                              P
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    x
                                    ,
                                    y
                                 
                                 )
                              
                              =
                              P
                              
                                 (
                                 
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          H
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                 
                                 )
                              
                              .
                           
                        
                     Here, we omit any details on the feature sets 
                        
                           
                              H
                           
                           
                              i
                           
                        
                     , as they are completely algorithm dependent, and focus on the aggregation of the 
                        P
                        M
                     s.

The maps 
                        P
                        
                           
                              M
                           
                           
                              i
                           
                        
                      (i=1,2,…,N) can also be considered as probability density function, if the following conditions hold:
                        
                           (3)
                           
                              P
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    x
                                    ,
                                    y
                                 
                                 )
                              
                              >
                              0
                              ,
                              for
                              
                              all
                              
                              
                                 
                                    p
                                 
                                 
                                    x
                                    ,
                                    y
                                 
                              
                              ∈
                              I
                              ,
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 ∑
                                 x
                              
                              
                                 ∑
                                 y
                              
                              P
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              =
                              1
                              .
                           
                        
                     
                  

Condition (3) can be fulfilled with assigning a very small probability value 
                        ε
                        >
                        0
                      to each position, which originally has zero confidence:
                        
                           (5)
                           
                              P
                              M
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    x
                                    ,
                                    y
                                 
                                 )
                              
                              =
                              m
                              a
                              x
                              
                                 (
                                 
                                    P
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                    ,
                                    ε
                                 
                                 )
                              
                              .
                           
                        
                     
                  

Finally, to meet condition (4), we perform the following normalization step:
                        
                           (6)
                           
                              P
                              D
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    x
                                    ,
                                    y
                                 
                                 )
                              
                              =
                              
                                 
                                    P
                                    M
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                 
                                 
                                    
                                       ∑
                                       x
                                    
                                    
                                       ∑
                                       y
                                    
                                    P
                                    M
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                 
                              
                              
                              .
                           
                        
                     
                  

In this way, the probability maps 
                        P
                        
                           
                              M
                           
                           
                              i
                           
                        
                        
                     (i=1,2,…,N) are transformed to the probability density function PDF
                     
                        i
                     . After we have these PDFs, we can fuse them by applying standard axiomatic approaches or more complex aggregation models.

The product, sum, minimum, maximum of the probability density functions are the simplest approaches of the aggregation in the corresponding literature [19], [20]. These techniques are realized by simple arithmetic operations performed between two or more PDFs given by the experts. One of the most commonly used axiomatic approaches is the linear opinion pool published by Stone in [22]. This method calculates the weighted sum of the probability density functions 
                           P
                           D
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         rendered by the experts:
                           
                              (7)
                              
                                 P
                                 D
                                 
                                    
                                       F
                                    
                                    
                                       L
                                       I
                                       N
                                       O
                                       P
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                 P
                                 D
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 
                              
                           
                        where 
                           P
                           D
                           
                              
                                 F
                              
                              
                                 L
                                 I
                                 N
                                 O
                                 P
                              
                           
                         represents the combined probability density and w
                        
                           i
                         the weights assigned to the experts provided that we have information on their reliability. As a natural condition, 
                           
                              ∑
                              i
                           
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           =
                           1
                           
                         must hold. If 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           =
                           1
                           /
                           N
                        , we have a simple linear combination, otherwise a weighted linear one.

Multiplicative averaging (also known as logarithmic opinion pool) is another commonly used fusion approach [19]. In this case, probability density functions are combined as:
                           
                              (8)
                              
                                 P
                                 D
                                 
                                    
                                       F
                                    
                                    
                                       L
                                       O
                                       G
                                       O
                                       P
                                    
                                 
                                 =
                                 k
                                 
                                    ∏
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 P
                                 D
                                 
                                    
                                       
                                          F
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                              
                           
                        where k is a normalizing constant and 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                         represents the same weights as above. If 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           =
                           1
                           /
                           N
                        , (8) returns the geometric mean of the individual distributions. These axiomatic approaches combine the PDFs in a simple way with ignoring the quality of the members and the dependencies among them. Now, we start discussing the Bayesian models of the information aggregation process, which require input regarding bias and dependencies of the experts.

In [23,24], Morris formally laid the foundation of the Bayesian paradigm to aggregate the information collected from different experts. The Bayesian models operate on the individual probability density functions to aggregate them. In the case of single object detection, according to these models the pixels can be considered as the center point 
                           (
                           
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                           
                           )
                         or not 
                           (
                           
                              
                                 
                                    L
                                 
                                 
                                    0
                                 
                              
                           
                           )
                        . Thus, using the Bayes’ theorem we assign the ensemble-based probability to each pixel 
                           
                              
                                 p
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                           ∈
                           I
                         on whether it is the object center through the following way based on the probability maps 
                           P
                           D
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         (i=1,2,…,N):
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                x
                                                ,
                                                y
                                             
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      m
                                                      a
                                                      n
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      m
                                                      a
                                                      n
                                                   
                                                
                                             
                                             )
                                          
                                          ,
                                          if
                                       
                                    
                                    
                                       
                                          P
                                          
                                             (
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      1
                                                   
                                                
                                                |
                                                P
                                                D
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                ,
                                                …
                                                ,
                                                P
                                                D
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      N
                                                   
                                                
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             )
                                          
                                          >
                                          P
                                          
                                             (
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      0
                                                   
                                                
                                                |
                                                P
                                                D
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                ,
                                                …
                                                ,
                                                P
                                                D
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      N
                                                   
                                                
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

As only two cases are possible, we have 
                           P
                           
                              (
                              
                                 
                                    
                                       L
                                    
                                    
                                       0
                                    
                                 
                              
                              )
                           
                           =
                           1
                           −
                           P
                           (
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                           )
                         for each pixel. Thus, in our case it is sufficient to determine the probability of 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         for the pixels with the help of the Bayes’ theorem. To each 
                           
                              
                                 p
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                           ∈
                           I
                         we calculate the posterior probability in (9) by the help of the Bayes’ rule in the following way:
                           
                              (10)
                              
                                 P
                                 
                                    (
                                    
                                       ℒ
                                       |
                                       P
                                       D
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       P
                                       D
                                       
                                          
                                             F
                                          
                                          
                                             N
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       P
                                       
                                          (
                                          
                                             P
                                             D
                                             
                                                
                                                   F
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             P
                                             D
                                             
                                                
                                                   F
                                                
                                                
                                                   N
                                                
                                             
                                             |
                                             ℒ
                                          
                                          )
                                       
                                       P
                                       
                                          (
                                          ℒ
                                          )
                                       
                                    
                                    
                                       P
                                       
                                          (
                                          
                                             P
                                             D
                                             
                                                
                                                   F
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             P
                                             D
                                             
                                                
                                                   F
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 ℒ
                                 ∈
                                 
                                    {
                                    
                                       
                                          
                                             L
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

Note that, 
                           ℒ
                         does not appear in the denominator 
                           P
                           
                              (
                              
                                 P
                                 D
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 P
                                 D
                                 
                                    
                                       F
                                    
                                    
                                       N
                                    
                                 
                              
                              )
                           
                        , so this term is applied only for normalization. Thus, it can be omitted by following the general recommendations [21].

The a priori probability 
                           P
                           
                              (
                              ℒ
                              )
                           
                         in the numerator of (10) can be easily estimated from the training database (see Section 4). The calculation of the joint probability density function 
                           P
                           
                              (
                              
                                 P
                                 D
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 P
                                 D
                                 
                                    
                                       F
                                    
                                    
                                       N
                                    
                                 
                                 |
                                 ℒ
                              
                              )
                           
                         depends on whether the model takes the dependencies of the member algorithms into account or not. In this respect, there are two basic approaches in the relevant literature as discussed next.

In the first Bayesian approach, let us suppose that the experts do not influence each other, there is no connection between them so they give their opinion or forecast completely independently. That is, according to this naive hypothesis, the decision maker manages the information collected from the experts independently. This type of aggregation is known as the Naïve Bayes model and the joint density function in 
                              (10)
                            can be separated according to the conditionally independent assumption based on the following formula:
                              
                                 (11)
                                 
                                    P
                                    
                                       (
                                       
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                N
                                             
                                          
                                          |
                                          ℒ
                                       
                                       )
                                    
                                    =
                                    
                                    
                                       ∏
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    P
                                    
                                       (
                                       
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          ℒ
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

Consequently, the aggregation of the probability density functions 
                              P
                              D
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            (i=1,2,…,N) can be derived based on as:
                              
                                 (12)
                                 
                                    P
                                    D
                                    
                                       
                                          F
                                       
                                       
                                          N
                                          B
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                    =
                                    
                                    P
                                    
                                       (
                                       
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    
                                       ∏
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    P
                                    
                                       (
                                       
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                ,
                                                y
                                             
                                             )
                                          
                                          |
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           where 
                              P
                              
                                 (
                                 
                                    P
                                    D
                                    
                                       
                                          F
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                    |
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                                 )
                              
                            (i=1,2,…,N) are estimated on the basis of the probability values assigned by the algorithms to the pixels within the manually segmented object in the images of the training set. Since all the terms of (12) can be estimated from the training examples, the Naïve Bayes model can be easily constructed and adopted, as well. However, this model ignores the dependencies among the members although, the assumption on the conditional independence of the experts is fulfilled very rarely in practice.

To measure up the dependencies of the member algorithms 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                              
                            (i, j=1,2,…,N), we can calculate the Pearson’s correlation coefficient 
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                            
                           [25]. 
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                            is calculated pairwise for the member algorithms through comparing all the pairs 
                              
                                 (
                                 
                                    P
                                    D
                                    
                                       
                                          F
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                    ,
                                    P
                                    D
                                    
                                       
                                          F
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                 
                                 )
                              
                              ,
                              
                              (
                              i
                              ,
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              N
                              )
                            as:
                              
                                 (13)
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          E
                                          
                                             [
                                             
                                                
                                                   (
                                                   
                                                      P
                                                      D
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      μ
                                                      (
                                                      P
                                                      D
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      P
                                                      D
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      −
                                                      μ
                                                      (
                                                      P
                                                      D
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          σ
                                          (
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          σ
                                          (
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                    
                                    
                                    ,
                                 
                              
                           where 
                              μ
                              (
                              P
                              D
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              )
                            stands for the mean, while 
                              σ
                              (
                              P
                              D
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              )
                            for the standard deviation of the probability map 
                              P
                              D
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                           , respectively. The coefficients 
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                            describe the dependencies between 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                              
                           . Non-zero coefficients show dependencies suggesting that the model can be improved further as presented in the next section.

In the corresponding literature [26] the problem is well-known that experts do not provide their opinions or forecasts entirely independently from each other. So, combining their input in a way that the decision maker considers the experts independent have a negative effect on the result. In this case, a Bayesian model is required, which is able to take all the dependencies between the experts into account. To address this issue, the optimal Augmented Naïve Bayes (ANB) model has been suggested [27], where during the learning phase the dependencies of the members are also incorporated. However, creating such an ANB model is an NP-hard problem [28], so it is recommended to choose an alternative approach which takes the dependencies into consideration, however, does not try to disclose them entirely. One of these models is the Tree Augmented Naïve Bayes (TAN) [27] one, which has the disadvantage that only the most dependent pairs are kept and the effect of the less dependent experts are omitted. As a trade-off, the complexity of the creation of the TAN model is significantly reduced. Contrarily, the Hidden Naïve Bayes (HNB) model developed by Zhang et al. [29] is capable of taking all the dependent experts into account collectively. Thus, the HNB model approximates the precision of the optimal ANB model better, while its time complexity for training is only polynomial.

The basic idea of the HNB model is that a hidden expert (HE) is created for each expert which can affect it. Thus, the ith expert depends only on the ith HE (HE
                           
                              i
                           ), where HE
                           
                              i
                            contains all the dependency relations between the ith and the other experts. That is, the joint probability in the numerator of 
                              (10)
                            can be calculated by the HNB model considering the dependencies among the experts as:
                              
                                 (14)
                                 
                                    P
                                    
                                       (
                                       
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                N
                                             
                                          
                                          |
                                          ℒ
                                       
                                       )
                                    
                                    =
                                    
                                       ∏
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    P
                                    
                                       (
                                       
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          H
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          ℒ
                                       
                                       )
                                    
                                    ,
                                 
                              
                           where
                              
                                 (15)
                                 
                                    P
                                    
                                       (
                                       
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          H
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          ℒ
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                          ,
                                          j
                                          ≠
                                          i
                                       
                                       N
                                    
                                    
                                       
                                          W
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    P
                                    
                                       (
                                       
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          ℒ
                                       
                                       )
                                    
                                 
                              
                           with 
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                    ,
                                    j
                                    ≠
                                    i
                                 
                                 N
                              
                              
                                 
                                    W
                                 
                                 
                                    i
                                    j
                                 
                              
                           =1. As it can be seen, 
                              H
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            is the hidden expert of 
                              P
                              D
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            (i=1,2,…,N) and is basically a mixture of the weighted dependencies with other experts. The weights 
                              
                                 
                                    W
                                 
                                 
                                    i
                                    j
                                 
                              
                            (i, j=1,2,…,N, i≠j) are determined using the training set based on the conditional mutual information (CMI) of 
                              P
                              D
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            and 
                              P
                              D
                              
                                 
                                    F
                                 
                                 
                                    j
                                 
                              
                           :
                              
                                 (16)
                                 
                                    
                                       
                                          W
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          C
                                          M
                                          I
                                          
                                             (
                                             
                                                P
                                                D
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ;
                                                P
                                                D
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      j
                                                   
                                                
                                                |
                                                ℒ
                                             
                                             )
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                                ,
                                                j
                                                ≠
                                                i
                                             
                                             N
                                          
                                          C
                                          M
                                          I
                                          
                                             (
                                             
                                                P
                                                D
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ;
                                                P
                                                D
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      j
                                                   
                                                
                                                |
                                                ℒ
                                             
                                             )
                                          
                                       
                                    
                                    
                                    ,
                                 
                              
                           where CMI is generally calculated as:
                              
                                 (17)
                                 
                                    C
                                    M
                                    I
                                    
                                       (
                                       
                                          Α
                                          ;
                                          Β
                                          |
                                          Γ
                                       
                                       )
                                    
                                    =
                                    
                                    
                                       ∑
                                       
                                          α
                                          ,
                                          β
                                          ,
                                          γ
                                       
                                    
                                    P
                                    
                                       (
                                       
                                          α
                                          ,
                                          β
                                          ,
                                          γ
                                       
                                       )
                                    
                                    l
                                    o
                                    g
                                    
                                       
                                          P
                                          
                                             (
                                             
                                                α
                                                ,
                                                β
                                                |
                                                γ
                                             
                                             )
                                          
                                       
                                       
                                          P
                                          
                                             (
                                             
                                                α
                                                |
                                                γ
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                β
                                                |
                                                γ
                                             
                                             )
                                          
                                       
                                    
                                    
                                    .
                                 
                              
                           
                        

Using the weights 
                              
                                 
                                    W
                                 
                                 
                                    i
                                    j
                                 
                              
                            (i, j=1,2,…,N, i≠j), the hidden experts 
                              H
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            (i=1,2,…,N) can be determined. Thus, the HNB model incorporates all the dependencies among experts similarly to the optimal ANB one. However, the time complexity of the training phase of HNB is 
                              O
                              
                                 (
                                 
                                    t
                                    
                                       
                                          N
                                       
                                       2
                                    
                                    +
                                    k
                                    
                                       
                                          N
                                       
                                       2
                                    
                                    
                                       
                                          v
                                       
                                       2
                                    
                                 
                                 )
                              
                           , where t is the number of training pixels of the training images, N is the number of algorithms, k is the number of classes and v is the average number of values for an attribute.

After defining the weights 
                              
                                 
                                    W
                                 
                                 
                                    i
                                    j
                                 
                              
                            (i, j=1,2,…,N, i≠j), the aggregation of the probability maps 
                              P
                              D
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            (i=1,2,…,N) can be executed via the HNB model on the basis of the following formula:
                              
                                 (18)
                                 
                                    P
                                    D
                                    
                                       
                                          F
                                       
                                       
                                          H
                                          N
                                          B
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                    =
                                    
                                    P
                                    
                                       (
                                       
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    
                                       ∏
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    P
                                    
                                       (
                                       
                                          P
                                          D
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                ,
                                                y
                                             
                                             )
                                          
                                          |
                                          H
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                ,
                                                y
                                             
                                             )
                                          
                                          ,
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

Till this point of this section, we have proposed a general ensemble-based framework for single object detection, when we have more than one member algorithms which can generate probability maps to locate the object. Now we show how to apply these approaches for OD detection and observe their performance considering the accuracy of detection. For visual and precise comparison of the proposed ensemble-based approaches, we use the same input image as in Fig. 5(b) with considering the same detectors (OD
                        
                           decomp
                        
                        , OD
                        
                           edge
                        
                        , OD
                        
                           entropy
                        
                        , OD
                        
                           classify
                        
                        , OD
                        
                           fuzzy
                        
                        , OD
                        
                           hough
                        
                        , OD
                        
                           cHough
                        ), as well.

The OD detector algorithms are slightly modified since they are not allowed to threshold the confidence values 
                           C
                           o
                           n
                           f
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                       ,
                                       y
                                    
                                 
                              
                              )
                           
                         to extract a single pixel having the highest value as the final center candidate. Instead, all the image pixels 
                           
                              
                                 p
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                           ∈
                           I
                         are equipped by a confidence value for each member. These confidence values together compose probability maps for I corresponding to each OD detector (see 
                        Fig. 6 for these PMs).

As we have discussed in Section 3, the proposed ensemble approaches can be applied if the PMs fulfill conditions . For this aim, the PMs are transformed to probability density functions (PDFs) by formulas . In 
                        Fig. 7, we can see a visual representation of the PDFs derived from the PMs of Fig. 6.

After constructing the PDFs, they can be fused by applying the standard axiomatic or Bayesian model-based approaches. For axiomatic ensemble of PDFs the weights 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                         (see (7) and (8)) are calculated from the individual accuracies as follows:
                           
                              (19)
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       A
                                       c
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       A
                                       c
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                 ,
                                 
                                 
                              
                           
                        where 
                           A
                           c
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                         denotes the accuracy of 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         on the training set. The proper details of the databases used for training and testing is given in Section 4. After making tests on a training set, we adjust the following weights: w
                        
                           decomp
                        =0.16, w
                        
                           edge
                        =0.18, w
                        
                           entropy
                        =0.17, w
                        
                           classify
                        =0.16, w
                        
                           fuzzy
                        =0.04, w
                        
                           hough
                        =0.16, w
                        
                           cHough
                        =0.13. The result of the combination of 
                           P
                           D
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         (i=1,2,…,N) by weighted linear opinion pool and weighted logarithmic opinion pool can be seen in 
                        Fig. 8(a) and (b), respectively.

Now we turn to the Naïve Bayes model for OD detection. During the training stage, we determine the probability of OD center pixels among all the pixels of the training images. However, there is only one OD center point in the image, and considering the number of all the image pixels, 
                           P
                           
                              (
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                              )
                           
                         is a very small value. Since 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         would be very under-represented in this way in a training dataset, we interpret 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         in a wider sense. Namely, we let 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         represent not only the case when 
                           
                              
                                 p
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                           =
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                    
                                       m
                                       a
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       m
                                       a
                                       n
                                    
                                 
                              
                              )
                           
                        , but also when 
                           
                              
                                 p
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                         falls inside the OD region 
                           (
                           
                              
                                 
                                    p
                                 
                                 
                                    x
                                    ,
                                    y
                                 
                              
                              ∈
                              O
                              D
                              R
                           
                           )
                        . In other words, we do not restrict our attention to the center, but we accept any OD pixels. Note that, in this way 
                           P
                           
                              (
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                              )
                           
                         becomes sufficiently large, and from now we work in this extended context. Besides the a priori probability 
                           P
                           
                              (
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                              )
                           
                        , the conditional probabilities 
                           P
                           
                              (
                              
                                 P
                                 D
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                    
                                    )
                                 
                                 |
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                              
                              )
                           
                         (i=1,2,…,N) are also calculated inside and outside the region of the OD. A sample result for the combination based on the Naïve Bayes model can be seen in Fig. 8(c).

As we have mentioned in Section 3.2.1, the assumption on the conditional independence of the experts is fulfilled very rarely in practice. This assumption does not keep for the involved OD detectors either. To confirm this hypothesis, we calculate the Pearson’s correlation coefficients 
                           
                              
                                 ρ
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         for all the possible pairs of member algorithms with enclosing them in 
                        Table 1.

A smaller (close to 0) correlation value corresponds to smaller dependency of the given algorithms. For instance, OD
                        
                           decomp
                         and the OD
                        
                           classify
                         seem to be the most diverse algorithms compared to each other regarding this measure. There are no zeros in Table 1 showing the trivial fact that the members cannot be completely independent. Thus, we can apply the HNB model which takes the dependencies among the detectors also into consideration. The sample result of the HNB combination can be seen in Fig. 8(d).

In all the images of Fig. 8, very high probability values can be observed for the region of the OD, so its location can be found with a simple extra step. Namely, the center of the average OD size disc template 
                           
                              
                                 D
                              
                              
                                 R
                              
                           
                         is matched on each pixel of the resulted ensemble PDF image and that pixel is selected as the final OD center 
                           (
                           
                              
                                 
                                    x
                                 
                                 
                                    r
                                    e
                                    s
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    r
                                    e
                                    s
                                 
                              
                           
                           )
                        , where we find the maximum sum of PDF values for the pixels within the matched 
                           
                              
                                 D
                              
                              
                                 R
                              
                           
                        .

If we compare the results of the axiomatic models (Fig. 8(a) and (b)) with the Bayesian ones (Fig. 8(c) and (d)), we can see significant difference between the areas, where the OD is detected with lower probability. There are high peaks at the possible OD locations, but the rest of Fig. 8(c) and (d) are flat because of the more complex aggregation methods which take the dependencies among the members also into account. Furthermore, as we consider 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         in a wider sense with letting it represent the event 
                           
                              
                                 p
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                           ∈
                           O
                           D
                           R
                        , the resulted PDFs of the Bayesian models show high probability also at the pixels falling inside the OD region not just at the center of it. Thus, we can determine the final OD region if we consider the area corresponding to the peak found by the template 
                           
                              
                                 D
                              
                              
                                 R
                              
                           
                         matching process. If 
                           
                              
                                 D
                              
                              
                                 R
                              
                           
                         expands this region, their union is considered as the segmentation of the OD region, as it can be seen also in 
                        Fig. 9.

We have evaluated our proposed combination approaches to localize the OD on publically available image sets. Namely, the sets DIARETDB0 [30], DIARETDB1 [31], DRIVE [32] and MESSIDOR [33] have been considered for performance analysis. DIARETDB0 includes 130 color fundus images. 20 of these are healthy and 110 of these contain signs of DR (exudates, microaneurysms, hemorrhages and neovascularization). The dataset DIARETDB1 includes 89 fundus images. 84 of these contain microaneurysms or more serious signs of DR, while 5 are considered as healthy with containing no signs of DR according to clinical experts. In both sets, the images were taken with a 50° field-of-view, at a resolution of 1500×1152pixel and the average diameter of the regions-of-interest (ROI) is 1410pixel. DRIVE images were acquired using a Canon CR5 non-mydriatic 3CCD camera with a 45° field-of-view. Each image is 24-bit RGB of resolution 768×584pixel. The ROI of the images is circular with an average diameter 540pixel. The image set MESSIDOR includes 1200 fundus images which were acquired by 3 ophthalmologic departments using a color video 3CCD camera on a Topcon TRC NW6 non-mydriatic retinograph with a 45° field-of-view. The images were captured using 24-bit RGB at the resolution of 1440×960, 2240×1488 or 2304×1536pixel.

The proposed Bayesian approaches for combining the member algorithms require training images to construct the Bayesian models. So the NB and HNB models should be trained on the training set without the influence of the test set. Therefore, a set of images from our private dataset is used during the training phase. The images from our dataset were captured with a 50° field-of-view at a resolution of 3072×2048 and 1360×1024pixel with the average diameter of the ROI is 2287 and 1340pixel, respectively. This set includes 327 images, for which manually drawn regions of the OD are also available. 
                     Table 2 contains the summary of datasets used for training and the evaluation of the proposed combinations of individual algorithms for OD localization.

To collect the training dataset for Bayesian models, we have calculated 
                        P
                        D
                        
                           
                              F
                           
                           
                              i
                           
                        
                      (i=1,2,…,7) for all the 327 images. Then, we have 400,000pixel randomly selected from these images together with their corresponding 
                        P
                        D
                        
                           
                              F
                           
                           
                              i
                           
                        
                      (i=1,2,…,7) values. In this way, 4% of the pixels belonged to OD regions in the training set. 
                     Fig. 10 shows the distribution of the probability values outside and inside the region of the OD for these selected pixels.

@&#EXPERIMENTAL RESULTS@&#

For the measurability of the accuracies of the algorithm, manually selected ODs are also supplied for the images of DIARETDB0, DIARETDB1, DRIVE and MESSIDOR datasets. We consider three ways for measuring the accuracy. First, as a primary error, we expect that a properly detected OD center falls inside the manually drawn OD region. As a secondary measurement, we check the distance of a candidate from the centroid of the manually selected OD. Finally, we measure the similarity between the detected region and the manually labeled OD region.

As for the primary error function, the final OD center candidate is considered as true positive if it falls in the manually selected OD, otherwise it is false positive. Moreover, let TP (respectively FP) denote the number of total number of true positive (respectively false positive) candidates within the given test dataset. Then, we can calculate the precision or positive predicted value (PPV) to measure the primary error as:
                        
                           (20)
                           
                              P
                              P
                              V
                              =
                              
                              
                                 
                                    T
                                    P
                                 
                                 
                                    T
                                    P
                                    +
                                    F
                                    P
                                 
                              
                              
                              .
                           
                        
                     
                  

As for the secondary error function, for a fair comparison we exclude those images, where the detected OD center falls outside the OD region:
                        
                           (21)
                           
                              E
                              r
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 1
                                 
                                    T
                                    P
                                 
                              
                              
                                 ∑
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          r
                                          e
                                          s
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          r
                                          e
                                          s
                                       
                                    
                                    )
                                    ∈
                                    O
                                    D
                                    R
                                 
                              
                              d
                              
                                 (
                                 
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                             
                                                r
                                                e
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                r
                                                e
                                                s
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                             
                                                m
                                                a
                                                n
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                m
                                                a
                                                n
                                             
                                          
                                       
                                       )
                                    
                                 
                                 )
                              
                              ,
                           
                        
                     where 
                        d
                        
                           (
                           
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                       
                                          r
                                          e
                                          s
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          r
                                          e
                                          s
                                       
                                    
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                       
                                          m
                                          a
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          m
                                          a
                                          n
                                       
                                    
                                 
                                 )
                              
                           
                           )
                        
                      is the Euclidean distance of the detected OD center 
                        (
                        
                           
                              
                                 x
                              
                              
                                 r
                                 e
                                 s
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 r
                                 e
                                 s
                              
                           
                        
                        )
                      and the manually given OD one 
                        (
                        
                           
                              
                                 x
                              
                              
                                 m
                                 a
                                 n
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 m
                                 a
                                 n
                              
                           
                        
                        )
                     .

The third error function aims to measure the overlapping area between the manually labeled OD region and the one determined by the aggregation of the outputs of the individual algorithms by applying the Bayesian approach:
                        
                           (22)
                           
                              E
                              r
                              
                                 
                                    r
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          r
                                          e
                                          s
                                       
                                    
                                    
                                       ∩
                                       
                                    
                                    O
                                    D
                                    R
                                 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          r
                                          e
                                          s
                                       
                                    
                                    
                                       ∪
                                       
                                    
                                    O
                                    D
                                    R
                                 
                              
                              
                              ,
                           
                        
                     where 
                        
                           
                              R
                           
                           
                              r
                              e
                              s
                           
                        
                      denotes the automatically segmented OD region.

The main motivation of our current contribution is to see how including more and more information from the members can improve the performance of the ensemble. 
                     
                     
                     
                     Tables 3–6 compare the respective performances of the member algorithms, simple majority voting, OD detection by finding maximal weighted clique, detection on the aggregated probability map by the axiomatic approaches and by the Bayesian models on the DIARETDB0, DIARETDB1, DRIVE and MESSIDOR datasets. We note that, the second error function depends on the resolution of the input image, which explains why the average 
                        E
                        r
                        
                           
                              r
                           
                           
                              2
                           
                        
                      is lower on the DRIVE dataset than on the others. For simplicity, we have normalized 
                        E
                        r
                        
                           
                              r
                           
                           
                              2
                           
                        
                      for the highest resolution (2304×1536pixel) regarding the images of the MESSIDOR dataset. As we can see, the highest accuracy can be achieved, when the aggregation model uses the largest amount of information about the OD location provided by the algorithms and the dependencies between them.

For the sake of completeness, we have included the PPV results of OD detection for our private database (TRAININGSet) based on probability map combination by NB model and HNB model which are 93.49% and 96.24% using 10 folds cross-validation test, respectively. The performance results found for the TRAININGSet are slightly worse than for the others. However, note that we have relatively more diseased cases in this set making the OD not to be the brightest region which naturally makes it detection more challenging.

Moreover, to confirm the usefulness and positive contribution of each involved individual algorithm, we made an exhaustive evaluation and tested all the possible 27-1=127 combinations of them as an ensemble system. The TRAININGSet was used for this evaluation with dividing it into a test (216 images) and training (111 images) part and the HNB model-based ensembles was tested on the test part. The average and the range of PPV values of these ensembles regarding their cardinality (i.e. the number of algorithms composing them) can be seen in 
                     Fig. 11.

As it can be seen, as the cardinality of the ensemble grows, the average PPV increases, as well. A small-scale fallback can be observed between the performance of the individual algorithms and the two-components ensembles which can be explained by the small and even number of the experts. Regarding two-components ensembles, a high confidence value at a false OD position could not be corrected by another lower confidence value at the right position. Also note that the highest PPV is achieved by the ensemble consisting of all the individual members.

None of the member algorithms involved in the study is suitable for segmenting the region of the OD. Therefore, we did not evaluate the individual OD detectors for the error function 
                        E
                        r
                        
                           
                              r
                           
                           
                              3
                           
                        
                     . We merely notice that the segmented OD region based on the combined probability maps by the NB model against the manually drawn OD region achieved the following corresponding precisions: 
                        E
                        r
                        
                           
                              r
                           
                           
                              3
                           
                        
                        =
                        0.66
                      on DIARETDB0, 
                        E
                        r
                        
                           
                              r
                           
                           
                              3
                           
                        
                        =
                        0.71
                      on DIARETDB1 and 
                        E
                        r
                        
                           
                              r
                           
                           
                              3
                           
                        
                        =
                        0.66
                      on DRIVE. When the combination was made by the HNB model, then we got 
                        E
                        r
                        
                           
                              r
                           
                           
                              3
                           
                        
                        =
                        0.84
                        /
                        0.87
                        /
                        0.73
                      for DIARETDB0, DIARETDB1, and DRIVE, respectively.

Although, many state-of-the-art algorithms (e.g. [9,34,35]) available for the segmentation of the OD boundary which can outperform the proposed ensemble of the algorithms regarding 
                        E
                        r
                        
                           
                              r
                           
                           
                              3
                           
                        
                     , we have to take into consideration the fact that none of the member algorithms can detect the region of the OD. However, their combination is suitable for this task as it can be seen in 
                     Fig. 12.

The ensemble of the member algorithms can localize the center of the OD also in images with signs of parapapillary atrophy and myopia which signs cause problem for many detectors. Although the detected region is extended as it can be seen in 
                     Fig. 13. Although the detected region is extended, it causes smaller problem in our case, where our main motivation is to remove the OD before the subsequent exudate detection step.

Unfortunately, neither of the proposed ensembles of the involved member algorithms can localize correctly the OD position in all images of test sets. As it can be seen in 
                     Fig. 14, there are some cases when the most precise HNB model-based ensemble could not detect the true OD location. These cases are in connection with several serious lesions of the eye e.g. glaucoma, late stage of DR which result that the OD is not the brightest part of the fundus images. We note that, in a case of a CAD system, such images can be filtered out by special preprocessing algorithm like [36].

For the sake of completeness, we insert 
                     Table 7 to show that the proposed ensembles of the member algorithms can improve OD detection performance in both healthy and unhealthy images. Especially, the unhealthy cases are more challenging for individual algorithms because of the large variability of the appearance of different diseases. The table shows the numbers of correctly detected cases against the total number of the images in the included test databases.

@&#DISCUSSION@&#

As our results suggest, the precision achieved by the member algorithms can be increased, if an ensemble of them is computed as it has been introduced in [16,17]. Furthermore, as it can be observed also in Tables 3–6, if all the information about the location of the single object are considered, the accuracy of the detection also increases with using the appropriate aggregation model. The accuracy can be further increased by disclosing the dependent behavior of the member algorithms. Namely, if we incorporate information about the dependencies of the members into the model, they are less able to influence negatively the final result when they miss.

We note that, the proposed ensemble framework can be further improved by the selection of the optimal subset of the involved member algorithms. This selection is a further issue and goes beyond this discussion, because it can be considered as an optimization problem which takes the dependencies among the members, the individual accuracies, the possibility of redundant information, the computational time, the parameters of the individual algorithms and the values of the error functions into consideration. As a demonstrative example, if we exclude the two algorithms (OD
                     
                        fuzzy
                     
                     , OD
                     
                        cHough
                     ) having lowest performance regarding the PPV measure, the ensemble of the remaining algorithms results additional 4 and 1 false images in DIARETDB0 and DIARETDB1, respectively, comparing with the ensemble of all the algorithms.

In Section 2, we have described how an elbow criterion is applied for the selection of the number of candidates per individual algorithms regarding the weighted clique-based approach. As a quantitative validation, we measured the performance of the maximal weighted clique-based ensemble when each member algorithm provides one more and one less candidate than the values corresponding to the elbows. We have found that additional 3 and 2 false detections appeared in the merged DIARET datasets, respectively, which result supports our proposed selection strategy.

The proposed aggregation method allows the application of any member algorithms, so it can be considered as a general framework for composing ensembles. The only requirement is that any possible single object detector algorithm should be able to assign probability values to all the pixels of the input image for suggesting the center of the object. If the system is extended by new algorithms that are based on different principles, the performance of the ensemble can be expected to improve further.

Each of the OD detector algorithms involved in the demonstration of the single object detection task was re-implemented in Matlab by following the respective instructions given in [10–14] and we used a single core 2.4GHz CPU with 2GB memory for testing. The computational times of the original algorithms are the same with a negligible difference as their variants which are capable to assign probability values to each pixel with producing the maps 
                        P
                        D
                        
                           
                              F
                           
                           
                              i
                           
                        
                      (i=1,2,…,7) for an input image. The reason for the same demands of computations is that the original algorithms also calculate confidence values for each pixel and select the maximum to return the center of the OD. The computational times of the member algorithms are OD
                     
                        decomp
                      
                     [10]—190s, OD
                     
                        edge
                      
                     [10]—237s, OD
                     
                        entropy
                      
                     [11]—93s, OD
                     
                        classify
                      
                     [12]—214s, OD
                     
                        fuzzy
                      
                     [13]—5.57s, OD
                     
                        hough
                      
                     [14]—1.36s, OD
                     
                        cHough
                     —4.76s, respectively. The aggregation of the maps 
                        P
                        D
                        
                           
                              F
                           
                           
                              i
                           
                        
                      (i=1,2,…,7) is done in 40 milliseconds for axiomatic approaches as Matlab is efficient in matrix operations. The computational times for the Naïve Bayes model-based aggregation approaches also depend on the size of the input image. Excluding the training phase, we have measured the following times: simple NB—220ms, TAN—200ms and HNB—250ms. For the applied training dataset (discussed in Section 4), the number of operation to train the HNB model is 25 972 450.

@&#CONCLUSION@&#

In this paper, we have proposed some approaches to improve the accuracy of single object detection using an ensemble of individual algorithms. The first approach is based on simple majority voting, where each member algorithm has a single candidate. Even if some of the algorithms cannot detect the exact location of the object, a majority voting-based combination will be capable to detect the center point of the object in most cases appropriately. In a second approach, we have modified the algorithms so that they produce more than one candidates. These candidates are ranked according to confidence values assigned by the algorithms. Then, a weighted graph is defined from these candidates with taking the geometric properties of the target object also into consideration. The location of the center of the object can be detected by finding the maximal weighted clique. Finally, the combination of the probability maps by the Bayesian models makes also possible the approximate detection of the single object region.

The novelty of our contribution can be summarized as follows: If we manage to transform object detection algorithms to make them capable of assigning a probability value to each pixel of the image with the aim to determine the probability that the given pixel is the center point of the object, then by combining these probability maps the accuracy of the detection of the object location can be further improved. In Section 3, we have discussed the applicability of the generally used methods for the aggregation of information given by the experts to combine the generated probability maps. We have overviewed the approaches from the simple axiomatic ones to those using different Bayesian models and examined the relation of the algorithms considering their dependencies, as well. The experimental results of Section 5 show that the accuracy of OD detection is improved by using additional information (probability values assigned to each pixel) provided by the algorithms. Moreover, the results could be further improved with taking the dependencies of the members also into consideration. As a global aim, the proposed approach can be applied to remove the OD region before the detection of signs of diabetic retinopathy to become a part of a computer aided diagnostic system.

None declared.

@&#ACKNOWLEDGEMENT@&#

This work was partly supported by the TECH08-2 project DRSCREEN - Developing a computer based image processing system for diabetic retinopathy screening of the National Office for Research and Technology of Hungary (contract no.: OM-00194/2008, OM-00195/2008, OM-00196/2008), the TÁMOP-4.2.2.C-11/1/KONV-2012-0001 project and the European Union and the State of Hungary, co-financed by the European Social Fund in the framework of TÁMOP-4.2.4.A/2-11/1-2012-0001 
                  ‘National Excellence Program’. Moreover, the MESSIDOR dataset is kindly provided by the Messidor program partners (see http://messidor.crihan.fr).

@&#REFERENCES@&#

