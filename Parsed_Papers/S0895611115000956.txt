@&#MAIN-TITLE@&#Automatic brain tumour detection and neovasculature assessment with multiseries MRI analysis

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Automated RCBV perfusion map assessment is important in brain tumour diagnosis.


                        
                        
                           
                           Use of T1W, CE-T1W and FLAIR images enable RCBV analysis in suspected areas.


                        
                        
                           
                           Simultaneous analysis of various images yields tumour, edema and white matter.


                        
                        
                           
                           The results of automatic segmentations correspond well to manual delineations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Brain tumour

Image segmentation

Perfusion maps

Magnetic resonance imaging

Computer aided diagnosis

@&#ABSTRACT@&#


               
               
                  In this paper a novel multi-stage automatic method for brain tumour detection and neovasculature assessment is presented. First, the brain symmetry is exploited to register the magnetic resonance (MR) series analysed. Then, the intracranial structures are found and the region of interest (ROI) is constrained within them to tumour and peritumoural areas using the Fluid Light Attenuation Inversion Recovery (FLAIR) series. Next, the contrast-enhanced lesions are detected on the basis of T1-weighted (T1W) differential images before and after contrast medium administration. Finally, their vascularisation is assessed based on the Regional Cerebral Blood Volume (RCBV) perfusion maps. The relative RCBV (rRCBV) map is calculated in relation to a healthy white matter, also found automatically, and visualised on the analysed series. Three main types of brain tumours, i.e. HG gliomas, metastases and meningiomas have been subjected to the analysis. The results of contrast enhanced lesions detection have been compared with manual delineations performed independently by two experts, yielding 64.84% sensitivity, 99.89% specificity and 71.83% Dice Similarity Coefficient (DSC) for twenty analysed studies of subjects with brain tumours diagnosed.
               
            

@&#INTRODUCTION@&#

Brain tumours belong to the group of tumours the most difficult to be treated as they often affect areas where the treatment of choice, namely the total tumour resection, is virtually impossible. Correct decisions concerning surgery, radiotherapy and chemotherapy planning strictly depend on the accuracy of tumour segmentation performed by a radiologist [1–3]. The task consists of outlining the suspected areas on each image, comparing and assessing the regions on multiple magnetic resonance (MR) series, marking the reference regions for calculations, etc. While some tasks can be partially automated (transferring the outline to an another slice) or even whole tumour detection, yet manual work is still required. This is especially difficult in the case of irregular shapes to be outlined (i.e. white matter). This work done manually is a tedious and time-consuming task. Therefore, the assistance to radiologists in the process of brain tumour segmentation and assessment in MR images proves to be extremely vital.

@&#BACKGROUND@&#

There are many approaches to the problem of brain tumour segmentation in the literature [4]. In most cases the images taken into consideration during the analyses are conventional MR series: T1 weighted (T1W), contrast enhanced T1W (CE-T1W) and Fluid Light Attenuation Inversion Recovery (FLAIR). Selected studies on brain tumour segmentation are shortly characterised in Table 1
                        . It can be noted that most studies have been focused on one or two tumour types only. A method dealing with several tumour types [5] has been reported, but is based only on CE-T1W series. From a medical point of view, the analysis of other available MR series is also required, especially in order to assess the malignancy of a tumour.

Non-conventional MR techniques are also being explored. Diffusion Weighted Images (DWI) can be used to assist treatment [6], Magnetic Resonance Spectroscopy (MRS) – to obtain nosologic maps of brain tumour images [7] and support tumour grading [8]. The Perfusion Weighted Images (PWI) itself has been investigated for patients with stroke [9]. PWI plays an important role in treating primary brain tumours, making it possible to differentiate between broken Blood Brain Barrier (BBB) regions and find the most malignant part of the tumour.

On the basis of PWI data three types of perfusion maps can be obtained: Regional Cerebral Blood Volume (RCBV), Regional Cerebral Blood Flow (RCBF) and Mean Transit Time (MTT) [10–12]. In brain tumour diagnostics the first one is mostly used. It seems that the enhancement of the RCBV, whose amount is represented by the image intensity level of the RCBV perfusion maps in the lesion area, is caused by tumour angiogenesis, which may indicate the grade of malignancy of the tumour [13].

As far as brain tumour differential diagnostics is concerned the RCBV perfusion maps allow the differentiation of:
                           
                              1.
                              HG (high grade) and LG (low grade) gliomas [14–22];

LG, HG astrocytomas and metastases [23–26] as well as lymphomas [27];

LG astrocytomas and radionecrosis [28–30];

HG astrocytomas and radionecrosis [31–33]
                              

A parameter called relative RCBV (rRCBV) calculated as the mean or maximum RCBV of a lesion as referred to the mean RCBV of contralateral healthy white matter (WM) can be introduced. The importance of measuring the rRCBV in peritumoural (infiltration and oedema) areas, enabling neoangiogenesis as well as treatment response assessment, is mentioned in [38,33,24,25].

The literature survey shows that so far none of the works dealing with brain tumour segmentation has incorporated the PWI/RCBV MR series itself being a successfully used differential diagnostic tool. Also the studies focus on one or two types of brain tumours only.

The goal of this study is to detect brain tumours using multiseries brain MR (T1W, CE-T1W, FLAIR) analysis and to assess their neovascularisation using the RCBV perfusion maps. The entire multiseries analysis is performed automatically for fixed relative RCBV threshold. If any correction should be required or relative RCBV threshold should be updated, the designed CAD allows such procedure.

Previously developed processing methods [54–57] have been tuned and combined into a single, multi-step methodology aiming at the detection of three main types of brain tumours, i.e. HG gliomas, metastases and meningiomas, constituting together over 80% of all brain tumours. This, and the utilisation of RCBV perfusion maps during the processing, are advantageous over the previous studies concerning brain tumour detection and analysis.

The paper is organised as follows: Section 2 introduces the processing method that contains MR series registration, lesion segmentation in conventional MR series and the perfusion maps analysis. Results are presented in Section 3 and discussed in Section 4 concluding the paper.

@&#METHODS@&#

The methodology presented in this study consists of six main stages (Fig. 1
                     ):
                        
                           1.
                           registration of MR series to be analysed,

intracranial region of interest (ROI) extraction,

segmentation of the peritumoural region using FLAIR series,

segmentation of T1W differential images acquired before and after contrast administration to obtain the tumour region,

WM detection in the presence of expansive lesions,

analysis of neovasculature in suspected areas on the basis of RCBV perfusion maps.

Automatic detection of healthy WM areas is required to compute a reference level for the relative RCBV (rRCBV) calculation in tumour and peritumoural areas. The rRCBV map obtained in the process can be used to assess the malignancy of lesions, differentiate between tumour and non-tumour lesions, etc.

The image registration is required due to incoherent angle positioning in perpendicular planes of the employed transverse series (T1W, CE-T1W, FLAIR, and RCBV perfusion maps) and the patient motion during the acquisition process. In order to solve the problem the series are first transformed using the DICOM positioning data [58,59] and employing nearest neighbour approach to match the voxel grid of the T1W series. All the resulting series (including RCBV maps) feature the same spatial resolution and are initially registered. This allows the image based registration to be performed in order to minimise the effect of patient motion during the examination.

The image based registration method employs the brain symmetry plane established independently for the T1W, FLAIR, RCBV and CE-T1W series as a landmark. First, the slices with the brain midsagittal line well visible are chosen basing on the anatomical knowledge and the location of brain ventricles [54]. Then, for each of the analysed slice in the given series the following symmetry line finding procedure is repeated:
                           
                              1.
                              the skull interior is found using the Otsu thresholding [60],

the region of analysis is determined covering a limited, central part of the brain interior,
                                    2
                                 
                                 
                                    2
                                    The subarachnoid plexus, lateral ventricles and CSF (cerebrospinal fluid) cavities are excluded from the analysis, which increases the robustness of the procedure.
                                 
                              

the region is divided into a number of horizontal segments in which intensity values are column-wise accumulated – the column corresponding to the minimal accumulated intensity level determines the symmetry line of the horizontal segment (green segments in Fig. 2
                                 ),

the brain symmetry line (red line in Fig. 2) is approximated using the previously found symmetry segments.

The resulting symmetry lines are then used to approximate a brain symmetry plane covering all slices. The plane is fitted as to minimise the mean square error between calculated plane and already obtained symmetry lines.

Using the established symmetry plane, all slices are rotated and shifted to align the brain symmetry with the image symmetry. As a result of this procedure all the images coming from the analysed series are registered and the main processing can be initiated to detect tumours and analyse their neovasculature basing on the RCBV perfusion maps.

During the main processing, three main regions of interest are extracted:
                           
                              1.
                              intracranial region, covering the skull interior (Intracranial ROI in Fig. 1),

peritumoural region, masking parts of the brain directly affected by the lesion (Peritumoural ROI in Fig. 1),

the tumour region, corresponding to the tumour lesion (Tumour ROI in Fig. 1).

T1W series is employed to obtain the intracranial region. The FLAIR series with by extensive hyperintensive areas within and around the tumour [61], permits the peritumoural ROI to be extracted. Segmentation of the differential series extracts the tumour ROI: since the lesion is hyperintensive in CE-T1W and hypointensive in T1W images, a differential series is subjected to the segmentation procedure.

The intracranial structures mask is found independently for each slice of the T1W series. First, all the pixels are subjected to the FCM (Fuzzy C-Means) clustering [62] based solely on the intensity level (c
                           =3, m
                           =2). Then, the groups are defuzzified according to the maximum fuzzy affinity rule. Next, a binary mask is created based on the cluster with the second lowest group centroid value.

The mask is subjected to a morphological opening. The region featuring the maximum area constitutes a temporal intracranial mask. For the inferiormost slices, the temporal mask is additionally extended by pixels belonging to the second largest region of the binary mask. This temporary intracranial mask covers most of the regular brain matter, but may include holes and irregularities.

The final intracranial mask is therefore obtained by separating the temporary intracranial mask according to the previously computed symmetry line and computing convex hulls [63] separately for each of the hemispheres. These masks determine the Intracranial ROI, i.e. cover the areas that may be affected by neoplasm (Fig. 3
                           ).

A mask of the peritumoural region corresponds to the area of the brain directly affected by the existence of the tumour. It contains the tumour and its neighbourhood and corresponds to the hyperintensive area in FLAIR images.

To compute the peritumoural mask, first the intracranial mask is applied to the FLAIR series. All the voxels of the intracranial region are subjected to the KFCM (Kernelised Fuzzy C-Means) [64] clustering in polynomial kernel space, based solely on the intensity level. Obtained cluster membership functions are defuzzified by applying the maximum fuzzy affinity rule.

The clustering process is iteratively repeated changing the number of clusters from 3 to 15 and analysing the resulting Chou and Su (CS) cluster validity index [65] where the cluster prototypes are computed based on the defuzzified membership functions.

Three clustering results of the smallest CS value are searched for the best group, basing on the inclusion criteria (majority of pixels with typical tumour intensity belong to the cluster). These groups are defuzzified using the maximum fuzzy affinity rule and aggregated yielding the initial peritumoural mask.

The initial mask is then extended in order to compensate for the phenomenon that the hyperintensive FLAIR area does not fully cover the tumour area in some cases (e.g. cysts and cystic tumour parts or tumours with low water content). Therefore, each slice is subjected to a dilation constrained to the intracranial region and a hole filling procedure yielding the final Peritumoural ROI (Fig. 4
                           ).

The tumour segmentation is based on a differential image approach. A combination of T1W series acquired before (T1W) and after (CE-T1W) contrast administration (Fig. 5
                           ) enhances the BBB breakdown. Its extraction is performed by applying the KFCM approach [66] with varying number of clusters (as employed for Peritumoural ROI extraction, with analogous inclusion criteria). Very small areas (likely false positive detections) are removed, yielding the final contrast-enhanced lesions mask, the Tumour ROI (Figs. 6 and 7
                           
                           ).

The white matter detection precedes the RCBV perfusion maps analysis. Normal WM area serves as a reference region required to evaluate the rRCBV measure (as discussed in Section 2.4).

The WM extraction is based on a two-dimensional histogram approach. First, the T1W and FLAIR series are smoothed by anisotropic diffusion filtering [67]. Then, the 2D histogram is created and normalised by employing a logarithmic function.

Since thresholding of the histogram employed in the literature [68] does not yield reasonable results, a more complex approach has been developed. The histogram values are included in a feature vector for clustering to receive a set of seed points, which are subsequently used in a region growing procedure.

In the first step, the feature vector is constructed for the clustering:
                           
                              (1)
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    l
                                 
                                 =
                                 
                                    
                                       
                                          
                                             H
                                             
                                                
                                                   I
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   f
                                                
                                                ,
                                                
                                                   I
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   t
                                                
                                             
                                             w
                                          
                                          ,
                                          
                                             I
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             f
                                          
                                          ,
                                          
                                             I
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             t
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 l
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 i
                                 ·
                                 
                                 j
                                 ·
                                 
                                 k
                              
                           
                        where 
                           
                              H
                              w
                           
                         denotes the normalised 2D histogram, 
                           
                              I
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                              f
                           
                        , 
                           
                              I
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                              t
                           
                         denote normalised pixel intensity at the location of (i, j, k) of the FLAIR and T1W series, respectively. Next, a clustering is iteratively performed for 10–15 groups using KFCM clustering [66] in Radial Basis Function (RBF) kernel space. Results are then defuzzified according to the maximum fuzzy affinity rule. Groups containing the most voxels of white matter signal intensities and high 2D histogram values are converted into binary masks, aggregated and morphologically eroded to increase specificity.

This procedure provides a non-empty set of seed points that can be used to estimate two parameters m
                        0 (mean of seed point intensities) and σ
                        0 (std. deviation of seed point intensities) and start a region growing procedure.

The region growing is initiated on each slice of the FLAIR series starting from all of the seed points. In a single step 8-neighbourhood is analysed. The following inclusion criteria for each analysed pixel have been adopted
                           
                              (2)
                              
                                 
                                    I
                                    
                                       i
                                       ,
                                       j
                                    
                                    f
                                 
                                 ∈
                                 〈
                                 m
                                 −
                                 
                                    f
                                    1
                                 
                                 σ
                                 ;
                                    
                                 m
                                 +
                                 
                                    f
                                    2
                                 
                                 σ
                                 〉
                              
                           
                        and
                           
                              (3)
                              
                                 
                                    I
                                    
                                       i
                                       ,
                                       j
                                    
                                    f
                                 
                                 ∈
                                 〈
                                 
                                    m
                                    0
                                 
                                 −
                                 
                                    f
                                    3
                                 
                                 
                                    σ
                                    0
                                 
                                 ;
                                    
                                 
                                    m
                                    0
                                 
                                 +
                                 
                                    f
                                    4
                                 
                                 
                                    σ
                                    0
                                 
                                 〉
                                 ,
                              
                           
                        where m
                        0 and σ
                        0 are computed as above, m is the mean intensity value of the already segmented region, σ stands for its standard deviation (both these values being recomputed on-the-fly after each inclusion) and weights f
                        1, f
                        2, f
                        3, as well as f
                        4 have been defined experimentally: f
                        1
                        ⋯
                        f
                        4
                        =2). The aim of the second criterion (Eq. (3)) is to avoid any possible leak outside the WM area.

A sample slice demonstrating the WM area found with the region growing procedure is shown in Fig. 8
                        .

The aim of the RCBV perfusion maps analysis is to measure the rRCBV coefficient for all suspected tumour areas. The analysis is performed slice-wise for each lesion belonging to the final suspected tumour areas mask (Tumour ROI). First, the mean perfusion is obtained by computing the mean pixel intensity value. Then, an area located symmetrically to each lesion in the opposite hemisphere is found (Fig. 9
                        ) with the symmetry plane determined as discussed in Section 2.1. It becomes the reference area unless it is located outside the WM mask or the lesion is bihemispherical. In the first case the WM region of the opposite hemisphere serves as a reference area (Fig. 10
                        ) and in the other the entire WM region is subjected to the analysis. The mean WM pixels intensity is found within the reference area.

The rRCBV measure (indicative of tumour angiogenesis) is then obtained by computing the mean pixel intensities ratio
                           
                              (4)
                              
                                 
                                    rRCBV
                                    l
                                 
                                 =
                                 
                                    
                                       
                                          p
                                          l
                                       
                                    
                                    
                                       
                                          s
                                          l
                                       
                                    
                                 
                                 ,
                              
                           
                        where p
                        
                           l
                         denotes the mean perfusion within the Tumour ROI and s
                        
                           l
                         denotes mean intensity of WM region.

Measure values above a user-provided threshold
                           3
                        
                        
                           3
                           The references cited in the literature survey disagree as to any fixed threshold value. Putting the Perfusion maps analysis at the last stage of the processing facilitates recomputation for various rRCBV thresholds in CAD station.
                         indicate tumour lesions. Otherwise, these regions are considered as non-tumour (Fig. 11
                        ).

The analysis of RCBV maps is the final stage of the automatic tumour segmentation.

@&#RESULTS@&#

The performance evaluation has been split into three phases of the system. The first phase, namely the symmetry line extraction, has already been evaluated [54] yielding the shifting error of 1.36mm±1.03mm and the angle error of 2.2°±1.8°. In the overall system performance this results in a shift of the Intracranial ROI (Fig. 5).

Two other phases (i.e. contrast-enhanced lesion detection and WM detection) have been evaluated on the basis of two cancerous datasets of 10 series delineated by one and two experts, respectively (Table 2
                     ). Three similarity measures have been calculated voxel-wise: sensitivity – SEN, specificity – SPE and the Dice Similarity Coefficient – DSC. T1W, CE-T1W, FLAIR series have been available in all cases.

The contrast-enhanced lesion detection has been evaluated by comparing the system results with the expert delineation (Table 3
                     ) as well as with the inter-observers similarity (Table 4
                     ). The mean DSC ratios have achieved 71.83%±11.18% and 78.69%±11.78%, respectively.

Since in our study the WM region serves only as a reference area for the RCBV maps analysis, high specificity is required. Thus, the workflow has been set up accordingly. The evaluation of this phase of processing has already been included in our paper [57]. Finally, the specificity reached 97.55%±1.17%.

@&#DISCUSSION@&#

Using the presented method for brain tumour analysis we have developed a multi-stage computer-aided detection (CAD) system for the perfusion maps analysis. The CAD handles three problems that can be corrected semi-automatically, if performed automatically at a low accuracy level.

First, the brain symmetry line detection and series registration may require manual correction, especially in the case of tumours influencing the brain fissure. Shifted Intracranial ROI (e.g. Fig. 5) in some slices is an indicator of this issue. In further work, a non-rigid transformation shall be used for more exact, non-rigid image registration. Alternatively, symmetry surface should be used in processing of images with extended lesions.

Second, the extensive oedema results in a decrease of the normal WM tissue, that serves as a reference region. If miss-selected, a user may correct it by pointing manually another region and recalculate the rRCBV value.

Thirdly, rRCBV threshold may not be found automatically. Its value is carefully examined by experienced radiologists during the diagnosis. Most valuable differential diagnosis tools prove to be not only the mean rRCBV value for a given lesion itself, but also its distribution in the lesion area showing the most vascularised and necrotic tumour parts (a sample slice visualising the rRCBV distribution for the detected contrast-enhanced lesions is presented in Fig. 12
                     ). What is more, it is also extremely important to monitor the whole hyperintensive area in the FLAIR series as far as its rRCBV distribution is concerned. It allows the radiologist to discover possible tumour infiltration paths outside the contrast-enhanced area, where the BBB has not yet been broken. The rRCBV distribution in a sample pathologically hyperintensive FLAIR area is shown in Fig. 13
                     . This distribution superimposed on the CE-T1W slice clearly demonstrates tumour infiltration outwards the contrast-enhanced area. CAD workstation permits the threshold to be updated for each examination. The analysis may then be repeated.

Further development of the method should focus on improving the performance in bihemispherical lesion and extensive oedema regions. Furthermore, the detection system can be used in combination with regular brain nodule CAD systems whose only goal is to measure its parameters and distinguish malignancy for benign lesions.

Automating the process of tumour detection and assessment facilitates the work performed by radiologists. We hope, that by using the results directly in CAD workstation, or by importing them into general-purpose image workstation, the radiologists will be able to focus less on outlining the suspected areas, and analyse data, especially the relative RCBV levels, more thoroughly.

@&#ACKNOWLEDGEMENTS@&#

The authors are deeply grateful for making available the MRI data and medical consultation to: Radiodiagnostics Department of the Maria Skłodowska-Curie Memorial Cancer Centre and Institute of Oncology, Gliwice Branch, Poland (head prof. Barbara Bobek-Billewicz, PhD, MD); Helimed Diagnostic Imaging Centre, Katowice, Poland; General Surgical and Neuroradiology Department of the Piastów Śl¸askich Memorial Medical Academy, Wrocław, Poland; Medical Radiology and Radiodiagnostics Department of Prof. Stanisław Szyszko Memorial Public Clinical Hospital No. 1 of the Silesian Medical University, Zabrze, Poland and Edward Hanke Memorial Paediatrics and Oncology Centre, Chorzów, Poland. The authors would also like to express their gratitude for performing the ground truth expert manual delineations to Marian Szwabowicz, MD, and Małgorzata Derejczyk, MD. 
                  Conflict of interest
               

None declared.

@&#REFERENCES@&#

