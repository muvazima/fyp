@&#MAIN-TITLE@&#Complex multi-state systems modelled through marked Markovian arrival processes

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Redundant complex systems with an indeterminate number of units and repairpersons are modelled.


                        
                        
                           
                           The online unit is a multi-state one with minor and major performance states.


                        
                        
                           
                           Four types of failures: internal and external (both repairable and non-repairable).


                        
                        
                           
                           Preventive maintenance as response to random inspection is introduced.


                        
                        
                           
                           The effectiveness of preventive maintenance is analysed through several measures.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Reliability

Phase type distribution

Marked Markovian Arrival Process (MMAP)

Multi-state systems

Markov modelling

@&#ABSTRACT@&#


               
               
                  Complex multi-state warm standby systems subject to different types of failures and preventive maintenance are modelled by considering discrete marked Markovian arrival processes. The system is composed of K units, one online and the rest in warm standby and by an indefinite number of repairpersons, R. The online unit passes through several performance states, which are partitioned into two types: minor and major. This unit can fail due to wear or to external shock. In both cases of failures, the failure can be repairable or non-repairable. Warm standby units can only undergo repairable failures due to wear. Derived systems are modelled from the basic one according to the type of the failure; repairable or non-repairable, and preventive maintenance. When a unit undergoes a repairable failure, it goes to the repair facility for corrective repair, and if it is non-repairable, it is replaced by a new, identical one. Preventive maintenance is carried out in response to random inspections. When an inspection takes place, the online unit is observed and if the performance state is major, the unit is sent to the repair facility for preventive maintenance. Preventive maintenance and corrective repair times follow different distributions according to the type of failure. The systems are modelled in transient regime, relevant performance measures are obtained, and rewards and costs are calculated. All results are expressed in algorithmic form and implemented computationally with Matlab. A numerical example shows the versatility of the model presented.
               
            

@&#INTRODUCTION@&#

Redundant systems and preventive maintenance, which are two ways to improve system reliability and availability, are of considerable research interest. Serious damage, financial losses and, possibly, total system failure can be provoked by poor reliability. Two approaches can be adopted to improve the reliability of a complex system: standby systems and preventive maintenance. Various classes of redundant systems have been proposed, depending on the problem to be addressed. Levitin, Xing, and Dai (2014) developed an optimisation problem, in which a fixed set of elements was distributed between cold and warm standby groups; an appropriate element initiation sequence was then selected to minimise the expected mission operation cost of the system while providing the desired level of system reliability. In this respect, too, Vanderperre and Makhanov (2014) analysed a repairable duplex system characterised by cold standby and by pre-emptive priority rules. In this paper, general probability distributions for failure and repair were allowed. There exists an extensive body of literature related to warm standby systems, from significant initial research such as that by Gnedenko (1965), who analysed a warm standby system with a general number of components, to recent papers such as Wells (2014) where known analytic results are extended to a case with repairable and non-repairable failures.

Preventive maintenance is intended to improve system reliability and to increase profits. Nakagawa (2005) studied standard and advanced problems of maintenance policies for system reliability. Zhong and Jin (2014) included preventive maintenance in a cold standby two-component system, using semi-Markovian processes. In order to keep components running properly, the working component receives periodic preventive maintenance. An optimal replacement policy was developed by Zhang and Wang (2011) to cope with a deteriorating system with multiple types of failures. Under this approach, the application of an optimal replacement policy ensures that the long-run expected reward per unit of time is maximised. Preventive maintenance has also been described for use in complex systems, with either a multi-state unit or with a general set of cold standby multi-state units (Ruiz-Castro, 2013, 2014).

Nowadays, multi-state systems are of particular importance in ensuring reliability. Most texts on reliability theory analyse systems in which the units perform in terms of traditional binary models: up state (performing) and down state (failure). Many real-life systems, termed multi-state systems, are composed of multiple components with different performance levels and incorporating several failure modes. In this respect, Natvig and Morch (2003) analysed the Norwegian offshore gas pipeline network in the North Sea, transporting gas to Emden in Germany, and Lisnianski, Frenkel, and Ding (2010) have studied multi-state systems, presenting a variety of significant cases of interest to engineers and industrial managers. Lisnianski and Frenkel (2012) included Markov processes in the analysis of multi-state systems, highlighting the benefits of their application.

When complex systems are modelled, intractable expressions are often encountered. Several methodologies have been proposed to analyse the behaviour of a multi-state system, and one such method is that of Markov process theory. Markov processes enable us to model the behaviour of a complex multi-state system and to obtain measures in an algorithmic and computational form. One class of distributions that makes it possible to model complex systems with well structured results, thanks to its matrix-algebraic form, is the phase-type distribution (PH), which was introduced and analysed in detail by Neuts (1975, 1981), who pointed out its useful algorithmic properties. Phase type distributions and Markov processes have been applied in fields such as queuing theory, survival and reliability, where real-life problems have been modelled in an algorithmic form (Ruiz-Castro & Fernández-Villodre, 2012).

Many stochastic systems have inputs to the system over time that can be counted to control events, e.g. electrical systems at which electric shock waves arrive at random intervals. Multi-state systems that evolve over time may be subject to different types of failures, whether repairable or non-repairable, and benefit from measures such as preventive maintenance to enhance performance and economic results. The analysis of these systems requires a mathematical tool that can describe the input analytically and give rise to a numerically tractable model. The Markovian arrival process (MAP) class that was introduced by
Neuts (1979) counts the number of events in an underlying Markov chain. Two special cases of this process are Batch MAP and Marked MAP. In the first case, arrivals in batch are allowed, and in the second, several types of arrivals are counted. In all cases, the arrival rates of events can be customised for different situations, which highlight the inherent versatility of this class of processes. In a recent study, He (2014) presented the main results associated with MAPs.

Reliability systems are usually studied in the continuous case. However, not all systems can be continuously monitored, and some must be observed at certain times, for reasons such as the internal structure of the system, the need for periodic inspections, etc. Reliability systems that evolve in discrete time have been proposed to analyse the behaviour of devices in fields such as civil and aeronautical engineering. Ruiz-Castro and Quan-Lin (2011) considered a Markovian structure to model a k-out-of-n: G system with multi-state components by means of well-structured blocks. Recently, Ruiz-Castro (2014) included preventive maintenance in a discrete system to analyse its effectiveness with respect to performance measures and related costs in a complex device.

The aim of the present paper is to model certain warm standby complex systems that evolve in discrete time, are subject to different types of failure (repairable and non-repairable) and are protected by means of preventive maintenance with an indeterminate number of repairpersons. External shocks are included and from a basic system various complex ones are derived. This evolution is analysed using a Markov model and the main measures are determined in an algorithmic and computational form. Events occur at different times and are modelled by a marked, batch-arrival MAP. Costs are introduced and a numerical example shows the versatility of the modelling, comparing two similar complex systems with and without preventive maintenance. Various measures are applied to determine whether preventive maintenance is profitable from performance and financial standpoints. The results presented in this paper were obtained in an algorithmic and computational form, through the use of this methodology.


                     Section 2 presents the basic system, the assumptions and the state space, and Section 3 describes Marked MAPs in detail and obtains the matrix blocks and the transition probability matrix that describes the evolution of the system. Section 4 then addresses the modelling of the four systems derived. Section 5 is focused on the performance measures; thus, availability, reliability, conditional probability of failure, mean times and mean number of events are determined in transient regime. Section 6 introduces the concept of rewards, together with measures such as mean costs and profit up to a certain time. Finally, the versatility of the modelling is shown in Section 7, with a comparison of two similar systems, with and without preventive maintenance.

We assume a K-system with the online unit and the rest in warm standby that evolves in discrete time. The online unit is subject to repairable or non-repairable internal failures due to wear out. Also, the online unit is subject to random external events which can produce external shocks by producing failure. This one can be repairable and non-repairable depending on time up to failure. Any warm standby unit can undergo only repairable failures due to wear. When one failure occurs, the unit goes to the repair facility for corrective repair. The repair facility is composed of an indefinite number of repairpersons R where R
                     ≤
                     K. The online unit is a multi-state one where it passes through several performance stages which are partitioned in minor (the first n
                     1 states) and major (the rest). Inspections occur randomly and in response to these ones preventive maintenance can be carried out. The online unit goes to preventive maintenance only when one major state is observed under inspection. Corrective repair times are different according to the type of failure, from either the online place or standby. The order of the type of failure in queue keeps in memory.

The system described above is subject to the following assumptions.


                        
                           Assumption 1
                           The internal operational time of the online unit is PH-distributed with representation (α, T). The number of operational states is equal to n, and these are partitioned in minor (the first n
                              1 states) and major states (states n
                              1
                              +1, …, n).


                        
                           Assumption 2
                           Internal failures can be repairable and non-repairable. When an internal repairable failure occurs, a transition occurs to a subset of states, and the same happens for the non-repairable failures with another subset of states. The internal time up to failure can be written by blocks as 
                                 
                                    (
                                    
                                       
                                          T
                                          |
                                       
                                       
                                          T
                                          r
                                          0
                                       
                                       
                                          |
                                       
                                       
                                          T
                                          
                                             n
                                             r
                                          
                                          0
                                       
                                    
                                    )
                                 
                               where the blocks 
                                 
                                    T
                                    r
                                    0
                                 
                               and 
                                 
                                    T
                                    
                                       n
                                       r
                                    
                                    0
                                 
                               are column vectors including the absorbing probabilities from the transient states for an internal repairable and non-repairable failure, respectively. The absorbing probabilities for an internal failure from the transient states are given by the column vector 
                                 
                                    
                                       
                                          T
                                       
                                       0
                                    
                                    =
                                    
                                       T
                                       r
                                       0
                                    
                                    +
                                    
                                       T
                                       
                                          n
                                          r
                                       
                                       0
                                    
                                 
                              .


                        
                           Assumption 3
                           Events that produce failures of the online unit due to external shocks occur according to a phase type renewal process. If the online place is occupied, this event produces the failure of the unit. The time between two consecutive events is PH distributed with representation (γ, L). The order of the matrix L is equal to t.


                        
                           Assumption 4
                           External failures can be repairable and non-repairable. When an external repairable failure occurs, a transition occurs to a subset of states, and the same happens for the non-repairable failures with another subset of states. The external time up to failure can be written by blocks as 
                                 
                                    (
                                    
                                       
                                          L
                                          |
                                       
                                       
                                          L
                                          r
                                          0
                                       
                                       
                                          |
                                       
                                       
                                          L
                                          
                                             n
                                             r
                                          
                                          0
                                       
                                    
                                    )
                                 
                               where the blocks 
                                 
                                    L
                                    r
                                    0
                                 
                               and 
                                 
                                    L
                                    
                                       n
                                       r
                                    
                                    0
                                 
                               are column vectors including the absorbing probabilities from the transient states for an external repairable and non-repairable failure, respectively. The absorbing probabilities for an external failure from the transient states are given by the column vector 
                                 
                                    
                                       
                                          L
                                       
                                       0
                                    
                                    =
                                    
                                       L
                                       r
                                       0
                                    
                                    +
                                    
                                       L
                                       
                                          n
                                          r
                                       
                                       0
                                    
                                 
                              .


                        
                           Assumption 5
                           When the online unit undergoes a non-repairable failure then it is replaced by a new and identical one in a negligible time.


                        
                           Assumption 6
                           Any warm standby can fail at any time with probability p.


                        
                           Assumption 7
                           While the online place is occupied by a unit, random inspections can occur. The time between two consecutive inspections is PH distributed with representation (η, M). The order of the matrix M is equal to ε.


                        
                           Assumption 8
                           The corrective repair time for any warm standby that fails is PH distributed with representation (β0, S0
                              ). The order of this matrix is equal to z
                              0.


                        
                           Assumption 9
                           The corrective repair time when the online unit undergoes a repairable failure is PH distributed with representation (β1, S1
                              ). The order of this matrix is equal to z
                              1.


                        
                           Assumption 10
                           The preventive maintenance time is PH distributed with representation (β2, S2
                              ). The order of this matrix is equal to z
                              2.


                        
                           Assumption 11
                           When all standby units, the online unit does not undergo a failure, none unit is repaired and one inspection occurs then the online unit keeps on working independent of the observed state.


                        
                           Assumption 12
                           The random times defined above are independent.

One interesting aspect that must be taken into account in this model is that events can occurs simultaneously. Thus, for instance, failures on several warms standby units and one inspection on the online unit can occur at same time.

The system described above can be modelled by a discrete Markov process with a finite number of states. We define as Xk
                         the number of non-operational units in the repair facility at time k. This is a vector Markov process and the state space is composed of macro-states. This one is defined as E
                        ={E
                        0, E
                        1,…,Ek
                        }, where Ek
                         contains the phases when there are k units in the repair facility. On the order hand, the order of the units in the repair facility is important to be considered, given that the type of failure determines the type of repairing.

For this reason the macro-state Ek
                         is partitioned in several macro-states depending on the order of the units in the repair facility. Then, 
                           
                              
                                 E
                                 k
                              
                              =
                              
                                 {
                                 
                                    
                                       E
                                       
                                          
                                             i
                                             1
                                          
                                          ,
                                          
                                             i
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             i
                                             k
                                          
                                       
                                    
                                    ;
                                    
                                       i
                                       l
                                    
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                    ,
                                    l
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    k
                                 
                                 }
                              
                           
                        , k
                        =1,…,K−1, and 
                           
                              
                                 E
                                 K
                              
                              =
                              
                                 {
                                 
                                    
                                       E
                                       
                                          
                                             i
                                             1
                                          
                                          ,
                                          
                                             i
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             i
                                             K
                                          
                                       
                                    
                                    ;
                                    
                                       i
                                       K
                                    
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    
                                       i
                                       l
                                    
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                    ,
                                    l
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    K
                                    −
                                    1
                                 
                                 }
                              
                           
                        , contains the phases when there are k units in the repair facility and the order of these units to repair is given by 
                           
                              
                                 i
                                 1
                              
                              ,
                              …
                              ,
                              
                                 i
                                 k
                              
                           
                        in lexicographical order; where 0 indicates that the unit comes from warm standby, 1 indicates that the online unit undergoes a repairable failure and 2 indicates that the online unit is in the repair facility for preventive maintenance. The first min{R, k} units are being repaired and the rest are in repairing queue given that there are R repairpersons.

Finally, the phases of the macro-states are given by

                           
                              (1)
                              
                                 
                                    
                                       E
                                       0
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             (
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                m
                                             
                                             )
                                          
                                          ;
                                          1
                                          ≤
                                          i
                                          ≤
                                          n
                                          ,
                                          1
                                          ≤
                                          j
                                          ≤
                                          t
                                          ,
                                          1
                                          ≤
                                          m
                                          ≤
                                          
                                             ɛ
                                          
                                       
                                       }
                                    
                                    ,
                                 
                              
                           
                        for k
                        <
                        K
                        
                           
                              
                                 
                                    
                                       
                                          
                                             E
                                             
                                                
                                                   i
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   i
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                (
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   m
                                                   ,
                                                   
                                                      r
                                                      1
                                                   
                                                   ,
                                                   
                                                      r
                                                      2
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      r
                                                      
                                                         min
                                                         
                                                            {
                                                            
                                                               k
                                                               ,
                                                               R
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ;
                                             1
                                             ≤
                                             i
                                             ≤
                                             n
                                             ,
                                             1
                                             ≤
                                             j
                                             ≤
                                             t
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             m
                                             ≤
                                             
                                                
                                                   ɛ
                                                
                                                ,
                                                1
                                                ≤
                                                
                                                   r
                                                   h
                                                
                                                ≤
                                                
                                                   z
                                                   
                                                      i
                                                      h
                                                   
                                                
                                                ,
                                                h
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                min
                                                
                                                   {
                                                   
                                                      k
                                                      ,
                                                      R
                                                   
                                                   }
                                                
                                                }
                                             
                                             
                                             
                                             
                                                and
                                                
                                                for
                                             
                                             
                                             
                                             k
                                             =
                                             K
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       E
                                       
                                          
                                             i
                                             1
                                          
                                          ,
                                          …
                                          ,
                                          
                                             i
                                             K
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             (
                                             
                                                j
                                                ,
                                                
                                                   r
                                                   1
                                                
                                                ,
                                                
                                                   r
                                                   2
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   r
                                                   R
                                                
                                             
                                             )
                                          
                                          ;
                                          1
                                          ≤
                                          j
                                          ≤
                                          t
                                          ,
                                          1
                                          ≤
                                          
                                             r
                                             h
                                          
                                          ≤
                                          
                                             z
                                             
                                                i
                                                h
                                             
                                          
                                          ,
                                          h
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          R
                                       
                                       }
                                    
                                    ,
                                 
                              
                           
                        where i denotes the phase of the operational time of the online unit, j is the phase of the external shock time, m the phase of the inspection time and finally, rh
                         is the phase of the repair time of the hth units that is being repaired.

The system that is being analysed can be modelled through a Discrete Marked Markov Arrival Process (MMAP). As it has been described, several types of events can occur while the system is working on. We have focused on the analysis of the different types of failures and preventive maintenance. Besides the modelling of the system, this methodology enables us to count the number of events by time.

The transition probability matrix is built by taking into account the state space defined in (1). To clarify certain expressions, we denote by e
                        
                           h
                         a column vector containing all 1 of order h (if the subscript is not noted, then the order of e is the appropriate for a correct product). The Kronecker product of two matrices is used in this paper. Given two matrices, A and B, with order a
                        ×
                        b and c
                        ×
                        d respectively, the Kronecker product is a matrix with order ac
                        ×
                        bd defined as

                           
                              
                                 
                                    A
                                    ⊗
                                    B
                                    =
                                    
                                       (
                                       
                                          
                                             a
                                             
                                                i
                                                j
                                             
                                          
                                          B
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        for any element aij
                         of the matrix A.

The following auxiliary matrices have been built to facility the complex modelling.

The following auxiliary matrices, U1
                            and U2
                           , are defined which are used when one inspection occurs. The element (i, j) of these matrices is given by

                              
                                 
                                    
                                       
                                          U
                                          1
                                       
                                       
                                          (
                                          
                                             i
                                             ,
                                             j
                                          
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      1
                                                      ;
                                                      
                                                         i
                                                         =
                                                         j
                                                         ≤
                                                         
                                                            n
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ;
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                       
                                          U
                                          2
                                       
                                       
                                          (
                                          
                                             i
                                             ,
                                             j
                                          
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      1
                                                      ;
                                                      
                                                         i
                                                         =
                                                         j
                                                         ≥
                                                         
                                                            n
                                                            1
                                                         
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ;
                                                      
                                                         otherwise
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

These matrices consider only the minor and major phases respectively.

If there are g units being repaired and a of them finishes its repairing then the transition probability by considering only the phases for these g units is given by

For

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                a
                                                <
                                                g
                                                ,
                                                g
                                                ≥
                                                2
                                                ,
                                                a
                                                ≥
                                                1
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                C
                                                
                                                   (
                                                   
                                                      g
                                                      ,
                                                      a
                                                      ;
                                                      
                                                         i
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         i
                                                         
                                                            g
                                                            −
                                                            a
                                                         
                                                      
                                                      ;
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         g
                                                      
                                                      ;
                                                      
                                                         k
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         k
                                                         a
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                                  
                                                                     (
                                                                     1
                                                                     )
                                                                  
                                                                  ⊗
                                                                  ⋯
                                                                  ⊗
                                                                  S
                                                                  
                                                                     (
                                                                     g
                                                                     )
                                                                  
                                                               
                                                               ;
                                                               
                                                                  j
                                                                  s
                                                               
                                                               =
                                                               
                                                                  i
                                                                  
                                                                     s
                                                                     −
                                                                     
                                                                        I
                                                                        
                                                                           {
                                                                           
                                                                              a
                                                                              ≥
                                                                              1
                                                                           
                                                                           }
                                                                        
                                                                     
                                                                     ·
                                                                     
                                                                        ∑
                                                                        
                                                                           z
                                                                           =
                                                                           1
                                                                        
                                                                        a
                                                                     
                                                                     
                                                                        I
                                                                        
                                                                           {
                                                                           
                                                                              
                                                                                 k
                                                                                 z
                                                                              
                                                                              <
                                                                              s
                                                                           
                                                                           }
                                                                        
                                                                     
                                                                  
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                               s
                                                               =
                                                               1
                                                               ,
                                                               …
                                                               ,
                                                               g
                                                               ;
                                                               s
                                                               ≠
                                                               
                                                                  k
                                                                  z
                                                               
                                                               ,
                                                               z
                                                               =
                                                               1
                                                               ,
                                                               …
                                                               ,
                                                               a
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                               ;
                                                               
                                                                  otherwise
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where

                              
                                 
                                    
                                       S
                                       
                                          (
                                          h
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                         
                                                            i
                                                            h
                                                         
                                                      
                                                      ;
                                                      
                                                         h
                                                         ≠
                                                         
                                                            k
                                                            z
                                                         
                                                         ,
                                                         z
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         a
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         S
                                                         
                                                            
                                                               i
                                                               h
                                                            
                                                         
                                                         0
                                                      
                                                      ;
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           and ih, jh, kh
                            indicates the type of failure of the hth unit that is being repaired after the transition, before the transition and the ordinal of the repairpersons that concluded the repair, respectively.

For instance, if there are g
                           =4 units being repaired (types j
                           1
                           =0, j
                           2
                           =1, j
                           3
                           =1, j
                           4
                           =2) and 2 of them are repaired (the second and the fourth, k
                           1
                           =2, k
                           2
                           =4) then the transition probability by considering the repair phases is given by

                              
                                 
                                    
                                       C
                                       
                                          (
                                          
                                             4
                                             ,
                                             2
                                             ;
                                             0
                                             ,
                                             1
                                             ;
                                             0
                                             ,
                                             1
                                             ,
                                             1
                                             ,
                                             2
                                             ;
                                             2
                                             ,
                                             4
                                          
                                          )
                                       
                                       =
                                       
                                          S
                                          0
                                       
                                       ⊗
                                       
                                          S
                                          1
                                          0
                                       
                                       ⊗
                                       
                                          S
                                          1
                                       
                                       ⊗
                                       
                                          S
                                          2
                                          0
                                       
                                       .
                                    
                                 
                              
                           
                        

From this matrix function the transition probability for any order of repairing is given by

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                B
                                                
                                                   (
                                                   
                                                      g
                                                      ,
                                                      a
                                                      ;
                                                      
                                                         i
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         i
                                                         
                                                            g
                                                            −
                                                            a
                                                         
                                                      
                                                      ;
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         g
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     S
                                                                     
                                                                        i
                                                                        1
                                                                     
                                                                  
                                                                  ⊗
                                                                  ⋯
                                                                  ⊗
                                                                  
                                                                     S
                                                                     
                                                                        i
                                                                        g
                                                                     
                                                                  
                                                               
                                                               ;
                                                               
                                                                  a
                                                                  =
                                                                  0
                                                                  ;
                                                                  
                                                                     i
                                                                     s
                                                                  
                                                                  =
                                                                  
                                                                     j
                                                                     s
                                                                  
                                                                  ,
                                                                  s
                                                                  =
                                                                  1
                                                                  ,
                                                                  …
                                                                  ,
                                                                  g
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     
                                                                        k
                                                                        1
                                                                     
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     g
                                                                     −
                                                                     a
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  ∑
                                                                  
                                                                     
                                                                        k
                                                                        2
                                                                     
                                                                     =
                                                                     
                                                                        k
                                                                        1
                                                                     
                                                                     +
                                                                     1
                                                                  
                                                                  
                                                                     g
                                                                     −
                                                                     a
                                                                     +
                                                                     2
                                                                  
                                                               
                                                               ⋯
                                                               
                                                                  ∑
                                                                  
                                                                     
                                                                        k
                                                                        a
                                                                     
                                                                     =
                                                                     
                                                                        k
                                                                        
                                                                           a
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                     +
                                                                     1
                                                                  
                                                                  g
                                                               
                                                               C
                                                               
                                                                  (
                                                                  g
                                                                  ,
                                                                  a
                                                                  ;
                                                                  
                                                                     i
                                                                     1
                                                                  
                                                                  ,
                                                                  …
                                                                  ,
                                                                  
                                                                     i
                                                                     
                                                                        g
                                                                        −
                                                                        a
                                                                     
                                                                  
                                                                  ;
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                               
                                                                  
                                                                     j
                                                                     1
                                                                  
                                                                  ,
                                                                  …
                                                                  ,
                                                                  
                                                                     j
                                                                     g
                                                                  
                                                                  ;
                                                                  
                                                                     k
                                                                     1
                                                                  
                                                                  ,
                                                                  …
                                                                  ,
                                                                  
                                                                     k
                                                                     a
                                                                  
                                                                  )
                                                               
                                                               ;
                                                               
                                                                  0
                                                                  <
                                                                  a
                                                                  <
                                                                  g
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  B
                                                                  
                                                                     (
                                                                     
                                                                        l
                                                                        ,
                                                                        a
                                                                        ;
                                                                        
                                                                           j
                                                                           1
                                                                        
                                                                        ,
                                                                        …
                                                                        ,
                                                                        
                                                                           j
                                                                           g
                                                                        
                                                                     
                                                                     )
                                                                  
                                                                  =
                                                                  
                                                                     S
                                                                     
                                                                        
                                                                           j
                                                                           1
                                                                        
                                                                     
                                                                     0
                                                                  
                                                                  ⊗
                                                                  ⋯
                                                                  ⊗
                                                                  
                                                                     S
                                                                     
                                                                        
                                                                           j
                                                                           g
                                                                        
                                                                     
                                                                     0
                                                                  
                                                               
                                                               ;
                                                               
                                                                  a
                                                                  =
                                                                  g
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

If the same example above is considered then the general transition probability when 2 units are repaired from j
                           1
                           =0, j
                           2
                           =1, j
                           3
                           =1, j
                           4
                           =2 to i
                           1
                           =0, i
                           2
                           =1 is given by

                              
                                 
                                    
                                       
                                          
                                             
                                                B
                                                
                                                   (
                                                   
                                                      4
                                                      ,
                                                      2
                                                      ;
                                                      0
                                                      ,
                                                      1
                                                      ;
                                                      0
                                                      ,
                                                      1
                                                      ,
                                                      1
                                                      ,
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                C
                                                
                                                   (
                                                   
                                                      4
                                                      ,
                                                      2
                                                      ;
                                                      0
                                                      ,
                                                      1
                                                      ;
                                                      0
                                                      ,
                                                      1
                                                      ,
                                                      1
                                                      ,
                                                      2
                                                      ;
                                                      2
                                                      ,
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                C
                                                
                                                   (
                                                   
                                                      4
                                                      ,
                                                      2
                                                      ;
                                                      0
                                                      ,
                                                      1
                                                      ;
                                                      0
                                                      ,
                                                      1
                                                      ,
                                                      1
                                                      ,
                                                      2
                                                      ;
                                                      3
                                                      ,
                                                      4
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   S
                                                   0
                                                
                                                ⊗
                                                
                                                   S
                                                   1
                                                
                                                ⊗
                                                
                                                   S
                                                   1
                                                
                                                ⊗
                                                
                                                   S
                                                   2
                                                   0
                                                
                                                +
                                                
                                                   S
                                                   0
                                                
                                                ⊗
                                                
                                                   S
                                                   1
                                                
                                                ⊗
                                                
                                                   S
                                                   1
                                                   0
                                                
                                                ⊗
                                                
                                                   S
                                                   2
                                                   0
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The situation of any unit can be modified at any time and changes on the online unit and on any warm standby unit can occur at any time and simultaneously.

Throughout the paper, given a matrix A we denote A
                           0 to the matrix A
                           0
                           =
                           e−Ae. A matrix of zeros with appropriate order is denoted by 0 and the function I
                           {} is the indicatory function.

Firstly, we are going to focus on the online unit. While this one is operational, then it can undergo internal failure, external shock and/or one inspection. These possibilities are considered in the definition of the following matrices that describe different transition probabilities for the online unit.

The transition probability when the online unit changes of phase without failure and preventive maintenance by considering the corresponding phases is given by

                              
                                 
                                    
                                       
                                          H
                                          0
                                       
                                       =
                                       T
                                       ⊗
                                       L
                                       ⊗
                                       M
                                       +
                                       
                                          U
                                          1
                                       
                                       T
                                       ⊗
                                       L
                                       ⊗
                                       
                                          
                                             M
                                          
                                          0
                                       
                                       η
                                       .
                                    
                                 
                              
                           
                        

The first term indicates the changes in the internal performance states, phases of the external shock time and phases of the inspection time (T⊗L⊗M). The changes when one inspection occurs and a minor state is observed are given in the second term (U
                           1
                           T⊗L⊗M
                           
                              0
                           
                           
                              η
                           ). The matrix U
                           1
                           T contains the transition probabilities between any two internal operational phases of the online unit when a minor state is observed by inspection, an external failure does not occur (L) and one inspection takes place and the time up to the following inspection is reinitialised (M
                           0
                           
                              η
                           ).

A repairable failure on the online unit takes place when an internal failure, an external shock by producing repairable failure or both things occur. If there are units in warm standby or one unit is repaired at same time, then the matrix transition probability is given by

                              
                                 
                                    
                                       
                                          
                                             
                                                H
                                                1
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   T
                                                   r
                                                   0
                                                
                                                α
                                                ⊗
                                                
                                                   (
                                                   
                                                      L
                                                      +
                                                      
                                                         L
                                                         r
                                                         0
                                                      
                                                      γ
                                                   
                                                   )
                                                
                                                ⊗
                                                
                                                   (
                                                   
                                                      
                                                         M
                                                      
                                                      0
                                                   
                                                   η
                                                   +
                                                   M
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   (
                                                   
                                                      
                                                         e
                                                         n
                                                      
                                                      −
                                                      
                                                         
                                                            T
                                                         
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                α
                                                ⊗
                                                
                                                   L
                                                   r
                                                   0
                                                
                                                γ
                                                ⊗
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         0
                                                      
                                                      
                                                         η
                                                         +
                                                         M
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The above case when the only operational unit is the online, and at same transition time a repaired is not produced is given by

                              
                                 
                                    
                                       
                                          H
                                          1
                                          ′
                                       
                                       =
                                       
                                          T
                                          r
                                          0
                                       
                                       ⊗
                                       
                                          (
                                          
                                             L
                                             +
                                             
                                                L
                                                r
                                                0
                                             
                                             γ
                                          
                                          )
                                       
                                       ⊗
                                       
                                          e
                                          
                                             ɛ
                                          
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                e
                                                n
                                             
                                             −
                                             
                                                
                                                   T
                                                
                                                0
                                             
                                          
                                          )
                                       
                                       ⊗
                                       
                                          L
                                          r
                                          0
                                       
                                       γ
                                       ⊗
                                       
                                          e
                                          
                                             ɛ
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

When one inspection occurs and a major state is observed then the unit goes to the repair facility to preventive maintenance (at same time a failure does not occur). If there are units in warm standby or one unit is repaired at same time then the transition probability block is given by

                              
                                 
                                    
                                       
                                          H
                                          2
                                       
                                       =
                                       
                                          U
                                          2
                                       
                                       
                                          (
                                          
                                             
                                                e
                                                n
                                             
                                             −
                                             
                                                
                                                   T
                                                
                                                0
                                             
                                          
                                          )
                                       
                                       α
                                       ⊗
                                       L
                                       ⊗
                                       
                                          
                                             M
                                          
                                          0
                                       
                                       η
                                       .
                                    
                                 
                              
                           
                        

In the previous case, we assume that when there is only one operational unit and a repaired is not produced at a certain time, then the online unit keeping on working although a major state is observed by inspection. It is considered to optimise the operational time of the system. This transition probability block is given by

                              
                                 
                                    
                                       
                                          H
                                          2
                                          ′
                                       
                                       =
                                       
                                          U
                                          2
                                       
                                       T
                                       ⊗
                                       L
                                       ⊗
                                       
                                          
                                             M
                                          
                                          0
                                       
                                       η
                                       .
                                    
                                 
                              
                           
                        

A non-repairable failure on the online unit takes place when a non-repairable external shock is produced. The non-repairable failure is ‘stronger’ than a repairable one and preventive maintenance. Then, the matrix transition probability is given by

                              
                                 
                                    
                                       
                                          
                                             
                                                H
                                                3
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   T
                                                   
                                                      n
                                                      r
                                                   
                                                   0
                                                
                                                α
                                                ⊗
                                                
                                                   (
                                                   
                                                      L
                                                      +
                                                      
                                                         
                                                            L
                                                         
                                                         0
                                                      
                                                      γ
                                                   
                                                   )
                                                
                                                ⊗
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         0
                                                      
                                                      
                                                         η
                                                         +
                                                         M
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   (
                                                   
                                                      
                                                         e
                                                         n
                                                      
                                                      −
                                                      
                                                         T
                                                         
                                                            n
                                                            r
                                                         
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                α
                                                ⊗
                                                
                                                   L
                                                   
                                                      n
                                                      r
                                                   
                                                   0
                                                
                                                γ
                                                ⊗
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         0
                                                      
                                                      
                                                         η
                                                         +
                                                         M
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           Table 1
                            shows the matrices associated to the events over the online unit.

The matrices described above are the basis of the modelling of this multi-state complex system. The transition probability matrix is composed of matrix blocks according to the macro-states defined in (1). We have already analysed the behaviour of the online unit, next warm standby units are introduced in the analysis.

If r indicates the number of standby units which are broken at a certain time and l the number of units in the repair facility before that time, then we define the matrix

                              
                                 
                                    
                                       
                                          H
                                          
                                             c
                                             ,
                                             l
                                             ,
                                             r
                                          
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      K
                                                      −
                                                      l
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   r
                                                
                                             
                                          
                                          )
                                       
                                       
                                          p
                                          r
                                       
                                       
                                          
                                             (
                                             
                                                1
                                                −
                                                p
                                             
                                             )
                                          
                                          
                                             K
                                             −
                                             l
                                             −
                                             1
                                             −
                                             r
                                          
                                       
                                       
                                          H
                                          c
                                       
                                       ,
                                    
                                 
                              
                           where

                              
                                 
                                    
                                       c
                                       =
                                       
                                       0
                                       ,
                                       
                                       1
                                       ,
                                       
                                       2
                                       ,
                                       
                                       3
                                       ;
                                       l
                                       =
                                       
                                       0
                                       ,
                                       …
                                       ,
                                       K
                                       −
                                       1
                                       ;
                                       r
                                       ≤
                                       K
                                       −
                                       l
                                       −
                                       1
                                       .
                                    
                                 
                              
                           
                        

This matrix H
                           
                              c
                           
                           
                              ,
                           
                           
                              l
                           
                           
                              ,
                           
                           
                              r
                            contains the transition probabilities when there are l non-operational units, and at next time r warm standby units breaks down and the online unit passes to the situation c in that time; where c is equal to 0 when the online unit keeps on working the next time, 1 when this one undergoes a repairable failure, 2 when it undergoes a major inspection and 3 when the online unit undergoes a non-repairable failure.

If the online unit goes to repair facility, all warm standby units fail and a repair does not occur then

                              
                                 
                                    
                                       
                                          
                                             
                                                H
                                                ′
                                             
                                          
                                          
                                             c
                                             ,
                                             l
                                             ,
                                             K
                                             −
                                             l
                                             −
                                             1
                                          
                                       
                                       =
                                       
                                          p
                                          
                                             K
                                             −
                                             l
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                H
                                                ′
                                             
                                          
                                          
                                             c
                                             ,
                                          
                                       
                                       
                                       
                                       for
                                       
                                       
                                       c
                                       =
                                       
                                       1
                                       ,
                                       
                                       2
                                       .
                                    
                                 
                              
                           
                        


                           Fig. 1
                            shows the possible transitions for only the online and standby units.

The behaviour of the system; when the online unit, the standby units, and the repair facility are considered, is modelled through a MMAP with arrivals in batch. We distinguish among four types of events:

                           
                              
                                 O: the only units that fail at a certain time are warm standby units.


                                 A: the online unit undergoes a repairable failure and any unit in warm standby can fail.


                                 B: the online unit undergoes a major inspection and any unit in warm standby can fail.


                                 C: the online unit undergoes a non-repairable failure and any unit in warm standby can fail.

When the events A, B and C have place at a certain time, the number of warm standby units that fail can vary from 0 to the total units in standby at the previous moment. We defined D
                        
                           Or
                        , D
                        
                           Ar
                        ,D
                        
                           Br
                         and D
                        
                           Cr
                        , for r
                        =0,…, K
                        −1, as the matrices that contain the transition probabilities between any two phases described in the state space when the event O, A, B or C occurs, respectively, and r standby units fail.

The system is modelled by the following MMAP,

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      O
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      O
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      O
                                                      ,
                                                      K
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      A
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      A
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      A
                                                      ,
                                                      K
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      B
                                                      0
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      B
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      B
                                                      ,
                                                      K
                                                      −
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      C
                                                      0
                                                   
                                                
                                                ,
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      C
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      C
                                                      ,
                                                      K
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Fig. 2
                         shows the transitions when there are l units in the repair facility, a of them are repaired and r standby units fail.

In this section the matrices associated to the MMAP are worked out. Some of them are developed in this section and the rest are given in the Appendix.

                              
                                 
                                    
                                       M
                                       a
                                       t
                                       r
                                       i
                                       x
                                       
                                       
                                       
                                          
                                             D
                                          
                                          
                                             O
                                             r
                                          
                                       
                                    
                                 
                              
                           
                        

The matrix D
                           
                              Or
                           contains the transition probabilities when the online unit does not go to repair facility and r warm standby units fail at a certain time. This fact depends on the number of units in the repair facility before and after the transition time. The block (l, k) of the following matrix corresponds to this transition between the macro-states El
                            and Ek
                           . This matrix is given by

                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             O
                                             r
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                D
                                                
                                                   l
                                                   k
                                                
                                                
                                                   O
                                                   r
                                                
                                             
                                             )
                                          
                                          
                                             l
                                             ,
                                             k
                                             =
                                             0
                                             ,
                                             …
                                             ,
                                             K
                                          
                                       
                                       ,
                                    
                                 
                              
                           where

                              
                                 
                                    
                                       
                                          D
                                          
                                             l
                                             k
                                          
                                          
                                             O
                                             r
                                          
                                       
                                       =
                                       0
                                       
                                       
                                       if
                                       
                                       k
                                       
                                       >
                                       
                                       l
                                       
                                       +
                                       
                                       r
                                       
                                       
                                       or
                                       
                                       
                                       k
                                       <
                                       l
                                       +
                                       r
                                       −
                                       min
                                       
                                          {
                                          
                                             l
                                             ,
                                             R
                                          
                                          }
                                       
                                       
                                       
                                       or
                                       
                                       
                                       l
                                       ≥
                                       
                                          
                                             
                                                I
                                                
                                                   {
                                                   r
                                                
                                             
                                          
                                          
                                             ≥
                                             1
                                             }
                                          
                                       
                                       
                                          (
                                          K
                                          −
                                          r
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        

Once again, the matrices

                              
                                 D
                                 
                                    l
                                    k
                                 
                                 
                                    O
                                    r
                                 
                              
                            are composed by matrix blocks corresponding to the transition between macro-states
                              
                                 E
                                 
                                    
                                       j
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       j
                                       l
                                    
                                 
                              
                           and 
                              
                                 E
                                 
                                    
                                       i
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       i
                                       k
                                    
                                 
                              
                           . The matrix block 
                              
                                 
                                    D
                                    
                                       l
                                       k
                                    
                                    
                                       O
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       
                                          i
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          i
                                          k
                                       
                                       ;
                                       
                                          j
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          j
                                          l
                                       
                                    
                                    )
                                 
                              
                            contains the transition probabilities described by considering the order under repairing and in queue of failure types before and after transition. These blocks are built by considering the H blocks and the auxiliary matrix functions defined in Section 3.1. Then,

                              
                                 
                                    
                                       
                                          D
                                          
                                             00
                                          
                                          
                                             O
                                             0
                                          
                                       
                                       =
                                       
                                          H
                                          
                                             0
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   
                                                      0
                                                      r
                                                   
                                                   
                                                      O
                                                      r
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         i
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         i
                                                         r
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            r
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               H
                                                               ′
                                                            
                                                         
                                                         
                                                            2
                                                            ,
                                                            0
                                                            ,
                                                            r
                                                         
                                                      
                                                      
                                                         I
                                                         
                                                            {
                                                            
                                                               r
                                                               =
                                                               K
                                                               −
                                                               1
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ⊗
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      i
                                                      1
                                                   
                                                
                                                ⊗
                                                ⋯
                                                ⊗
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      i
                                                      
                                                         min
                                                         
                                                            {
                                                            
                                                               r
                                                               ,
                                                               R
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                
                                                
                                                ;
                                             
                                          
                                       
                                       
                                          
                                             
                                                i
                                                s
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ,
                                                s
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                r
                                                
                                                ;
                                                r
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                K
                                                −
                                                1
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   
                                                      l
                                                      ,
                                                      0
                                                   
                                                   
                                                      O
                                                      0
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                         
                                                            0
                                                            ,
                                                            l
                                                            ,
                                                            0
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               H
                                                               ′
                                                            
                                                         
                                                         
                                                            2
                                                            ,
                                                            l
                                                            ,
                                                            0
                                                         
                                                      
                                                      
                                                         I
                                                         
                                                            {
                                                            
                                                               r
                                                               =
                                                               K
                                                               −
                                                               l
                                                               −
                                                               1
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ⊗
                                                B
                                                
                                                   (
                                                   
                                                      l
                                                      ,
                                                      l
                                                      ;
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                ;
                                             
                                          
                                       
                                       
                                          
                                             l
                                          
                                          
                                             =
                                          
                                          
                                             
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                R
                                                ≠
                                                K
                                             
                                          
                                       
                                       
                                          
                                             
                                                j
                                                s
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ,
                                                1
                                                ,
                                                2
                                                ;
                                                s
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                l
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   
                                                      K
                                                      ,
                                                      0
                                                   
                                                   
                                                      O
                                                      0
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         K
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                α
                                                ⊗
                                                
                                                   (
                                                   
                                                      L
                                                      +
                                                      
                                                         
                                                            L
                                                         
                                                         0
                                                      
                                                      γ
                                                   
                                                   )
                                                
                                                ⊗
                                                η
                                                ⊗
                                                B
                                                
                                                   (
                                                   
                                                      K
                                                      ,
                                                      K
                                                      ;
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         K
                                                      
                                                   
                                                   )
                                                
                                                ;
                                             
                                          
                                       
                                       
                                          
                                             K
                                          
                                          
                                             =
                                          
                                          
                                             R
                                          
                                       
                                       
                                          
                                             
                                                j
                                                K
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ,
                                                1
                                                ;
                                             
                                          
                                       
                                       
                                          
                                             
                                                j
                                                s
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ,
                                                1
                                                ,
                                                2
                                                ,
                                                s
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                K
                                                −
                                                1
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                For
                                                a
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                R
                                                ≠
                                                K
                                                
                                                ,
                                                
                                                   i
                                                   
                                                      R
                                                      −
                                                      a
                                                      +
                                                      s
                                                   
                                                
                                                =
                                                
                                                   j
                                                   
                                                      R
                                                      +
                                                      s
                                                   
                                                
                                                ;
                                             
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             =
                                          
                                          
                                             
                                                1
                                                ,
                                                …
                                                ,
                                                min
                                                
                                                   {
                                                   
                                                      K
                                                      −
                                                      R
                                                      ,
                                                      a
                                                   
                                                   }
                                                
                                                
                                                and
                                                
                                                
                                                   j
                                                   K
                                                
                                                =
                                                0
                                                ,
                                                1
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   D
                                                   
                                                      K
                                                      ,
                                                      K
                                                      −
                                                      a
                                                   
                                                   
                                                      O
                                                      0
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         i
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         i
                                                         
                                                            K
                                                            −
                                                            a
                                                         
                                                      
                                                      ;
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         K
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                α
                                                ⊗
                                                
                                                   (
                                                   
                                                      L
                                                      +
                                                      
                                                         
                                                            L
                                                         
                                                         0
                                                      
                                                      γ
                                                   
                                                   )
                                                
                                                ⊗
                                                η
                                                ⊗
                                                B
                                                
                                                   (
                                                   
                                                      K
                                                      ,
                                                      a
                                                      ;
                                                      
                                                         i
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         i
                                                         
                                                            K
                                                            −
                                                            a
                                                         
                                                      
                                                      ;
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         K
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ⊗
                                                
                                                
                                                   β
                                                   
                                                      i
                                                      
                                                         R
                                                         −
                                                         a
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                ⊗
                                                
                                                   β
                                                   
                                                      i
                                                      
                                                         R
                                                         −
                                                         a
                                                         +
                                                         2
                                                      
                                                   
                                                
                                                ⊗
                                                ⋯
                                                ⊗
                                                
                                                   β
                                                   
                                                      i
                                                      
                                                         min
                                                         
                                                            {
                                                            
                                                               K
                                                               −
                                                               a
                                                               ,
                                                               R
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   D
                                                   
                                                      K
                                                      ,
                                                      K
                                                   
                                                   
                                                      O
                                                      0
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         i
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         i
                                                         K
                                                      
                                                      ;
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         K
                                                      
                                                   
                                                   )
                                                
                                                =
                                                
                                                   (
                                                   
                                                      L
                                                      +
                                                      
                                                         
                                                            L
                                                         
                                                         0
                                                      
                                                      γ
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ⊗
                                                
                                                B
                                                
                                                   (
                                                   
                                                      K
                                                      ;
                                                      0
                                                      ;
                                                      
                                                         i
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         i
                                                         K
                                                      
                                                      ;
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         K
                                                      
                                                   
                                                   )
                                                
                                                ;
                                                
                                                   i
                                                   s
                                                
                                                =
                                                
                                                   j
                                                   s
                                                
                                                ,
                                                s
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                K
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           and

                              
                                 
                                    
                                       
                                          
                                             
                                                for
                                                
                                                
                                                r
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ,
                                                …
                                                ,
                                                
                                                K
                                                −
                                                2
                                                ;
                                                
                                                l
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                K
                                                −
                                                r
                                                −
                                                1
                                                ;
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                                …
                                                ,
                                                min
                                                
                                                   {
                                                   l
                                                   ,
                                                   
                                                   R
                                                   ,
                                                   
                                                   l
                                                   +
                                                   r
                                                   −
                                                   1
                                                   }
                                                
                                                ,
                                                
                                                
                                                
                                                   i
                                                   
                                                      l
                                                      −
                                                      a
                                                      +
                                                      s
                                                   
                                                
                                                =
                                                0
                                                ;
                                                s
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                r
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                j
                                                K
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ,
                                                1
                                                
                                                and
                                                
                                                
                                                   i
                                                   
                                                      R
                                                      −
                                                      a
                                                      +
                                                      s
                                                   
                                                
                                                =
                                                
                                                   j
                                                   
                                                      R
                                                      +
                                                      s
                                                   
                                                
                                                ;
                                                
                                                s
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                l
                                                −
                                                R
                                                
                                                if
                                                
                                                l
                                                >
                                                R
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   D
                                                   
                                                      l
                                                      ,
                                                      l
                                                      +
                                                      r
                                                      −
                                                      a
                                                   
                                                   
                                                      O
                                                      r
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         i
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         i
                                                         
                                                            l
                                                            +
                                                            r
                                                            −
                                                            a
                                                         
                                                      
                                                      ;
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           (
                                                                           
                                                                              
                                                                                 H
                                                                                 
                                                                                    0
                                                                                    ,
                                                                                    l
                                                                                    ,
                                                                                    r
                                                                                 
                                                                              
                                                                              +
                                                                              
                                                                                 H
                                                                                 
                                                                                    2
                                                                                    ,
                                                                                    l
                                                                                    ,
                                                                                    r
                                                                                 
                                                                                 ′
                                                                              
                                                                              
                                                                                 I
                                                                                 
                                                                                    {
                                                                                    
                                                                                       r
                                                                                       =
                                                                                       K
                                                                                       −
                                                                                       l
                                                                                       −
                                                                                       1
                                                                                       ,
                                                                                       a
                                                                                       =
                                                                                       0
                                                                                    
                                                                                    }
                                                                                 
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        ⊗
                                                                        B
                                                                        
                                                                           (
                                                                           
                                                                              l
                                                                              ,
                                                                              a
                                                                              ;
                                                                              
                                                                                 i
                                                                                 1
                                                                              
                                                                              ,
                                                                              …
                                                                              ,
                                                                              
                                                                                 i
                                                                                 
                                                                                    l
                                                                                    −
                                                                                    a
                                                                                 
                                                                              
                                                                              ;
                                                                              
                                                                                 j
                                                                                 1
                                                                              
                                                                              ,
                                                                              …
                                                                              ,
                                                                              
                                                                                 j
                                                                                 l
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                        ⊗
                                                                        
                                                                           β
                                                                           
                                                                              i
                                                                              
                                                                                 l
                                                                                 −
                                                                                 a
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                        
                                                                        ⊗
                                                                        
                                                                           β
                                                                           
                                                                              i
                                                                              
                                                                                 l
                                                                                 −
                                                                                 a
                                                                                 +
                                                                                 2
                                                                              
                                                                           
                                                                        
                                                                        ⊗
                                                                        ⋯
                                                                        ⊗
                                                                        
                                                                           β
                                                                           
                                                                              i
                                                                              
                                                                                 min
                                                                                 
                                                                                    {
                                                                                    
                                                                                       l
                                                                                       −
                                                                                       a
                                                                                       +
                                                                                       r
                                                                                       ,
                                                                                       R
                                                                                    
                                                                                    }
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        ;
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                               min
                                                               
                                                                  {
                                                                  
                                                                     l
                                                                     −
                                                                     a
                                                                     +
                                                                     r
                                                                     ,
                                                                     R
                                                                  
                                                                  }
                                                               
                                                               ≥
                                                               l
                                                               −
                                                               a
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           H
                                                                           
                                                                              0
                                                                              ,
                                                                              l
                                                                              ,
                                                                              r
                                                                           
                                                                        
                                                                        
                                                                        +
                                                                        
                                                                        
                                                                           H
                                                                           
                                                                              2
                                                                              ,
                                                                              l
                                                                              ,
                                                                              r
                                                                           
                                                                           ′
                                                                        
                                                                        
                                                                           I
                                                                           
                                                                              {
                                                                              
                                                                                 r
                                                                                 =
                                                                                 K
                                                                                 −
                                                                                 l
                                                                                 −
                                                                                 1
                                                                                 ,
                                                                                 a
                                                                                 =
                                                                                 0
                                                                              
                                                                              }
                                                                           
                                                                        
                                                                     
                                                                     )
                                                                  
                                                                  ⊗
                                                                  B
                                                                  
                                                                     (
                                                                     
                                                                        l
                                                                        ,
                                                                        a
                                                                        ;
                                                                        
                                                                           i
                                                                           1
                                                                        
                                                                        ,
                                                                        …
                                                                        ,
                                                                        
                                                                           i
                                                                           
                                                                              l
                                                                              −
                                                                              a
                                                                           
                                                                        
                                                                        ;
                                                                        
                                                                           j
                                                                           1
                                                                        
                                                                        ,
                                                                        …
                                                                        ,
                                                                        
                                                                           j
                                                                           l
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               ;
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                               min
                                                               
                                                                  {
                                                                  
                                                                     l
                                                                     −
                                                                     a
                                                                     +
                                                                     r
                                                                     ,
                                                                     R
                                                                  
                                                                  }
                                                               
                                                               <
                                                               l
                                                               −
                                                               a
                                                               +
                                                               1
                                                               ,
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where I
                           {} is the indicatory function.

For instance, if there are l units in the repair facility with order 
                              
                                 
                                    j
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    j
                                    l
                                 
                              
                           , then the probability that the online unit does not go to repair facility, r warm standby units fail (H
                           0, l, r
                           ), a units that are being repaired are finished (
                              
                                 B
                                 (
                                 
                                    l
                                    ,
                                    a
                                    ;
                                    
                                       i
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       i
                                       
                                          l
                                          −
                                          a
                                       
                                    
                                    ;
                                    
                                       j
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       j
                                       l
                                    
                                 
                                 )
                              
                           ) and the possible units in queue entry to be repaired (
                              
                                 
                                    β
                                    
                                       i
                                       
                                          l
                                          −
                                          a
                                          +
                                          1
                                       
                                    
                                 
                                 ⊗
                                 
                                    β
                                    
                                       i
                                       
                                          l
                                          −
                                          a
                                          +
                                          2
                                       
                                    
                                 
                                 ⊗
                                 ⋯
                                 ⊗
                                 
                                    β
                                    
                                       i
                                       
                                          min
                                          {
                                          
                                             l
                                             −
                                             a
                                             +
                                             r
                                             ,
                                             R
                                          
                                          }
                                       
                                    
                                 
                              
                           ) is given by 
                              
                                 
                                    D
                                    
                                       l
                                       ,
                                       l
                                       +
                                       r
                                       −
                                       a
                                    
                                    
                                       O
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       
                                          i
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          i
                                          
                                             l
                                             +
                                             r
                                             −
                                             a
                                          
                                       
                                       ;
                                       
                                          j
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          j
                                          l
                                       
                                    
                                    )
                                 
                              
                           .

                              
                                 
                                    
                                       M
                                       a
                                       t
                                       r
                                       i
                                       c
                                       e
                                       s
                                       
                                       
                                       
                                          
                                             D
                                          
                                          
                                             A
                                             r
                                          
                                       
                                    
                                 
                              
                           
                        

The matrix D
                           
                              Ar
                           contains the transition probabilities when the online unit undergoes a repairable failure and r warm standby units fail at a certain time. This fact depends on the number of units in the repair facility before and after the transition time. The block (l, k) of this matrix corresponds to this transition between the macro-states El
                           and Ek
                           . This matrix is given by

                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             A
                                             r
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                D
                                                
                                                   l
                                                   k
                                                
                                                
                                                   A
                                                   r
                                                
                                             
                                             )
                                          
                                          
                                             l
                                             ,
                                             k
                                             =
                                             0
                                             ,
                                             …
                                             ,
                                             K
                                          
                                       
                                    
                                 
                              
                           where

                              
                                 
                                    
                                       
                                          D
                                          
                                             l
                                             k
                                          
                                          
                                             A
                                             r
                                          
                                       
                                       =
                                       0
                                       
                                       
                                       if
                                       
                                       
                                       k
                                       
                                       >
                                       
                                       l
                                       +
                                       r
                                       +
                                       1
                                       or
                                       
                                       
                                       k
                                       <
                                       l
                                       +
                                       1
                                       +
                                       r
                                       −
                                       min
                                       
                                          {
                                          
                                             l
                                             ,
                                             R
                                          
                                          }
                                       
                                       or
                                       
                                       
                                       l
                                       ≥
                                       K
                                       −
                                       r
                                       .
                                    
                                 
                              
                           
                        

As above, the matrices 
                              
                                 D
                                 
                                    l
                                    k
                                 
                                 
                                    A
                                    r
                                 
                              
                            are composed by the matrix blocks 
                              
                                 
                                    D
                                    
                                       l
                                       k
                                    
                                    
                                       A
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       
                                          i
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          i
                                          k
                                       
                                       ;
                                       
                                          j
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          j
                                          l
                                       
                                    
                                    )
                                 
                              
                            that contains the transition probabilities described by considering the order in queue of failure types before and after transition. These blocks are built by considering the H blocks defined above. Then,

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   
                                                      0
                                                      ,
                                                      r
                                                      +
                                                      1
                                                   
                                                   
                                                      A
                                                      r
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         i
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         i
                                                         
                                                            r
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      H
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         r
                                                      
                                                   
                                                   
                                                      I
                                                      
                                                         {
                                                         
                                                            r
                                                            <
                                                            K
                                                            −
                                                            1
                                                         
                                                         }
                                                      
                                                   
                                                   +
                                                   
                                                      H
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         r
                                                      
                                                      ′
                                                   
                                                   
                                                      I
                                                      
                                                         {
                                                         
                                                            r
                                                            =
                                                            K
                                                            −
                                                            1
                                                         
                                                         }
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                ⊗
                                                
                                                
                                                   β
                                                   
                                                      i
                                                      1
                                                   
                                                
                                                ⊗
                                                
                                                   β
                                                   
                                                      i
                                                      2
                                                   
                                                
                                                ⊗
                                                ⋯
                                                ⊗
                                                
                                                   β
                                                   
                                                      i
                                                      
                                                         min
                                                         
                                                            {
                                                            
                                                               r
                                                               +
                                                               1
                                                               ,
                                                               R
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                r
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ,
                                                …
                                                ,
                                                K
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                i
                                                1
                                             
                                          
                                          
                                             =
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                i
                                                s
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ;
                                                s
                                                =
                                                2
                                                ,
                                                …
                                                ,
                                                r
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                For
                                                
                                                
                                                r
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ,
                                                …
                                                ,
                                                
                                                
                                                K
                                                −
                                                2
                                                ;
                                                
                                                
                                                
                                                l
                                                
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                
                                                K
                                                −
                                                r
                                                −
                                                1
                                                ;
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ,
                                                …
                                                ,
                                                
                                                
                                                min
                                                
                                                   {
                                                   
                                                      l
                                                      ,
                                                      
                                                      R
                                                   
                                                   }
                                                
                                                ,
                                                
                                                
                                                
                                                   i
                                                   
                                                      l
                                                      −
                                                      a
                                                      +
                                                      1
                                                   
                                                
                                                =
                                                1
                                                ,
                                                
                                                   i
                                                   
                                                      l
                                                      −
                                                      a
                                                      +
                                                      s
                                                   
                                                
                                                =
                                                0
                                                ;
                                                s
                                                =
                                                2
                                                ,
                                                …
                                                ,
                                                r
                                             
                                          
                                       
                                       
                                          
                                             
                                                j
                                                K
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ,
                                                1
                                                
                                                and
                                                
                                                
                                                   i
                                                   
                                                      R
                                                      −
                                                      a
                                                      +
                                                      s
                                                   
                                                
                                                =
                                                
                                                   j
                                                   
                                                      R
                                                      +
                                                      s
                                                   
                                                
                                                ;
                                                
                                                s
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                l
                                                −
                                                R
                                                
                                                if
                                                
                                                l
                                                >
                                                R
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   D
                                                   
                                                      l
                                                      ,
                                                      l
                                                      +
                                                      r
                                                      +
                                                      1
                                                      −
                                                      a
                                                   
                                                   
                                                      A
                                                      r
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         i
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         i
                                                         
                                                            l
                                                            +
                                                            r
                                                            +
                                                            1
                                                            −
                                                            a
                                                         
                                                      
                                                      ;
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              H
                                                                              
                                                                                 1
                                                                                 ,
                                                                                 l
                                                                                 ,
                                                                                 r
                                                                              
                                                                           
                                                                           
                                                                              I
                                                                              
                                                                                 {
                                                                                 
                                                                                    r
                                                                                    <
                                                                                    K
                                                                                    −
                                                                                    l
                                                                                    −
                                                                                    1
                                                                                    or
                                                                                    a
                                                                                    >
                                                                                    0
                                                                                 
                                                                                 }
                                                                              
                                                                           
                                                                           +
                                                                           
                                                                              H
                                                                              
                                                                                 1
                                                                                 ,
                                                                                 l
                                                                                 ,
                                                                                 r
                                                                              
                                                                              ′
                                                                           
                                                                           
                                                                              I
                                                                              
                                                                                 {
                                                                                 
                                                                                    r
                                                                                    =
                                                                                    K
                                                                                    −
                                                                                    l
                                                                                    −
                                                                                    1
                                                                                    
                                                                                    and
                                                                                    
                                                                                    a
                                                                                    =
                                                                                    0
                                                                                 
                                                                                 }
                                                                              
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                        ⊗
                                                                        B
                                                                        
                                                                           (
                                                                           
                                                                              l
                                                                              ,
                                                                              a
                                                                              ;
                                                                              
                                                                                 i
                                                                                 1
                                                                              
                                                                              ,
                                                                              …
                                                                              ,
                                                                              
                                                                                 i
                                                                                 
                                                                                    l
                                                                                    −
                                                                                    a
                                                                                 
                                                                              
                                                                              ;
                                                                              
                                                                                 j
                                                                                 1
                                                                              
                                                                              ,
                                                                              …
                                                                              ,
                                                                              
                                                                                 j
                                                                                 l
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                        ⊗
                                                                        
                                                                           β
                                                                           
                                                                              i
                                                                              
                                                                                 l
                                                                                 −
                                                                                 a
                                                                                 +
                                                                                 1
                                                                              
                                                                           
                                                                        
                                                                        ⊗
                                                                        
                                                                           β
                                                                           
                                                                              i
                                                                              
                                                                                 l
                                                                                 −
                                                                                 a
                                                                                 +
                                                                                 2
                                                                              
                                                                           
                                                                        
                                                                        ⊗
                                                                        ⋯
                                                                        ⊗
                                                                        
                                                                           β
                                                                           
                                                                              i
                                                                              
                                                                                 min
                                                                                 
                                                                                    {
                                                                                    
                                                                                       l
                                                                                       +
                                                                                       r
                                                                                       +
                                                                                       1
                                                                                       −
                                                                                       a
                                                                                       ,
                                                                                       R
                                                                                    
                                                                                    }
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        ;
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                               min
                                                               
                                                                  {
                                                                  
                                                                     l
                                                                     +
                                                                     r
                                                                     +
                                                                     1
                                                                     −
                                                                     a
                                                                     +
                                                                     r
                                                                     ,
                                                                     R
                                                                  
                                                                  }
                                                               
                                                               ≥
                                                               l
                                                               −
                                                               a
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     H
                                                                     
                                                                        1
                                                                        ,
                                                                        l
                                                                        ,
                                                                        r
                                                                     
                                                                  
                                                                  
                                                                     I
                                                                     
                                                                        {
                                                                        
                                                                           r
                                                                           <
                                                                           K
                                                                           −
                                                                           l
                                                                           −
                                                                           1
                                                                           
                                                                           or
                                                                           
                                                                           a
                                                                           >
                                                                           0
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  +
                                                                  
                                                                     H
                                                                     
                                                                        1
                                                                        ,
                                                                        l
                                                                        ,
                                                                        r
                                                                     
                                                                     ′
                                                                  
                                                                  
                                                                     I
                                                                     
                                                                        {
                                                                        
                                                                           r
                                                                           =
                                                                           K
                                                                           −
                                                                           l
                                                                           −
                                                                           1
                                                                           
                                                                           and
                                                                           
                                                                           a
                                                                           =
                                                                           0
                                                                        
                                                                        }
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                               ⊗
                                                               
                                                               B
                                                               
                                                                  (
                                                                  
                                                                     l
                                                                     ,
                                                                     a
                                                                     ;
                                                                     
                                                                        i
                                                                        1
                                                                     
                                                                     ,
                                                                     …
                                                                     ,
                                                                     
                                                                        i
                                                                        
                                                                           l
                                                                           −
                                                                           a
                                                                        
                                                                     
                                                                     ;
                                                                     
                                                                        j
                                                                        1
                                                                     
                                                                     ,
                                                                     …
                                                                     ,
                                                                     
                                                                        j
                                                                        l
                                                                     
                                                                  
                                                                  )
                                                               
                                                               ;
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                               min
                                                               
                                                                  {
                                                                  
                                                                     l
                                                                     +
                                                                     r
                                                                     +
                                                                     1
                                                                     −
                                                                     a
                                                                     +
                                                                     r
                                                                     ,
                                                                     R
                                                                  
                                                                  }
                                                               
                                                               <
                                                               l
                                                               −
                                                               a
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Thus, in the last case, if there are l units in the repair facility with order 
                              
                                 
                                    j
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    j
                                    l
                                 
                              
                           , then the probability that the online unit undergoes a repairable failure, r warm standby units fail (H
                           1, l, r
                           ), a units that are being repaired are finished (
                              
                                 B
                                 (
                                 
                                    l
                                    ,
                                    a
                                    ;
                                    
                                       i
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       i
                                       
                                          l
                                          −
                                          a
                                       
                                    
                                    ;
                                    
                                       j
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       j
                                       l
                                    
                                 
                                 )
                              
                           ) and the possible units in queue entry to be repaired (
                              
                                 
                                    β
                                    
                                       i
                                       
                                          l
                                          −
                                          a
                                          +
                                          1
                                       
                                    
                                 
                                 ⊗
                                 
                                    β
                                    
                                       i
                                       
                                          l
                                          −
                                          a
                                          +
                                          2
                                       
                                    
                                 
                                 ⊗
                                 ⋯
                                 ⊗
                                 
                                    β
                                    
                                       i
                                       
                                          min
                                          {
                                          
                                             l
                                             +
                                             r
                                             +
                                             1
                                             −
                                             a
                                             ,
                                             R
                                          
                                          }
                                       
                                    
                                 
                              
                           ) is given by 
                              
                                 
                                    D
                                    
                                       l
                                       ,
                                       l
                                       +
                                       r
                                       −
                                       a
                                    
                                    
                                       A
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       
                                          i
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          i
                                          
                                             l
                                             +
                                             r
                                             −
                                             a
                                          
                                       
                                       ;
                                       
                                          j
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          j
                                          l
                                       
                                    
                                    )
                                 
                              
                           .

The rest blocks are given in the Appendix.

The system is modelled through a vector Markov process as it has been described above. Given the MMAP that governs the behaviour of the system, the transition probability matrix associated to the Markov process is given as the addition of the matrices built above. Thus,

                              
                                 (2)
                                 
                                    
                                       P
                                       =
                                       
                                          ∑
                                          
                                             r
                                             =
                                             0
                                          
                                          
                                             K
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   O
                                                   r
                                                
                                             
                                             +
                                             
                                                
                                                   D
                                                
                                                
                                                   A
                                                   r
                                                
                                             
                                             +
                                             
                                                
                                                   D
                                                
                                                
                                                   B
                                                   r
                                                
                                             
                                             +
                                             
                                                
                                                   D
                                                
                                                
                                                   C
                                                   r
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                D
                                                
                                                   l
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   l
                                                   =
                                                   0
                                                   ,
                                                   …
                                                   ,
                                                   K
                                                
                                             
                                             
                                                
                                                   k
                                                   =
                                                   max
                                                   
                                                      {
                                                      
                                                         0
                                                         ,
                                                         l
                                                         −
                                                         R
                                                      
                                                      }
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   K
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           where these blocks can be expressed through the blocks different of zero in the following way.

                              
                                 
                                    
                                       For
                                       
                                       
                                       l
                                       =
                                       
                                       0
                                       ,
                                       …
                                       ,
                                       K
                                       ;
                                       
                                       k
                                       =
                                       max
                                       {
                                       0
                                       ,
                                       l
                                       −
                                       R
                                       }
                                       ,
                                       …
                                       ,
                                       K
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                D
                                                
                                                   l
                                                   k
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   I
                                                   
                                                      {
                                                      
                                                         l
                                                         =
                                                         K
                                                      
                                                      }
                                                   
                                                
                                                
                                                   D
                                                   
                                                      l
                                                      k
                                                   
                                                   
                                                      O
                                                      ,
                                                      0
                                                   
                                                
                                                +
                                                
                                                   I
                                                   
                                                      {
                                                      
                                                         l
                                                         <
                                                         K
                                                         ,
                                                         k
                                                         ≥
                                                         max
                                                         
                                                            {
                                                            
                                                               l
                                                               −
                                                               R
                                                               ,
                                                               0
                                                            
                                                            }
                                                         
                                                      
                                                      }
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      a
                                                      =
                                                      max
                                                      
                                                         {
                                                         
                                                            l
                                                            −
                                                            k
                                                            ,
                                                            0
                                                         
                                                         }
                                                      
                                                   
                                                   
                                                      min
                                                      
                                                         {
                                                         
                                                            l
                                                            ,
                                                            R
                                                            ,
                                                            max
                                                            
                                                               {
                                                               
                                                                  K
                                                                  −
                                                                  k
                                                                  −
                                                                  1
                                                                  ,
                                                                  0
                                                               
                                                               }
                                                            
                                                         
                                                         }
                                                      
                                                   
                                                
                                                
                                                   D
                                                   
                                                      l
                                                      k
                                                   
                                                   
                                                      O
                                                      ,
                                                      k
                                                      −
                                                      l
                                                      +
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   I
                                                   
                                                      {
                                                      
                                                         l
                                                         <
                                                         K
                                                         ,
                                                         k
                                                         ≥
                                                         max
                                                         
                                                            {
                                                            
                                                               l
                                                               −
                                                               R
                                                               +
                                                               1
                                                               ,
                                                               1
                                                            
                                                            }
                                                         
                                                      
                                                      }
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      a
                                                      =
                                                      max
                                                      
                                                         {
                                                         
                                                            l
                                                            −
                                                            k
                                                            +
                                                            1
                                                            ,
                                                            0
                                                         
                                                         }
                                                      
                                                   
                                                   
                                                      min
                                                      
                                                         {
                                                         
                                                            l
                                                            ,
                                                            R
                                                            ,
                                                            max
                                                            
                                                               {
                                                               
                                                                  K
                                                                  −
                                                                  k
                                                                  ,
                                                                  0
                                                               
                                                               }
                                                            
                                                         
                                                         }
                                                      
                                                   
                                                
                                                
                                                   D
                                                   
                                                      l
                                                      k
                                                   
                                                   
                                                      A
                                                      ,
                                                      k
                                                      −
                                                      l
                                                      +
                                                      a
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   I
                                                   
                                                      {
                                                      
                                                         l
                                                         <
                                                         K
                                                         ,
                                                         max
                                                         
                                                            {
                                                            
                                                               l
                                                               −
                                                               R
                                                               +
                                                               1
                                                               ,
                                                               1
                                                            
                                                            }
                                                         
                                                         ≤
                                                         k
                                                         <
                                                         K
                                                      
                                                      }
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      a
                                                      =
                                                      max
                                                      
                                                         {
                                                         
                                                            l
                                                            −
                                                            k
                                                            +
                                                            1
                                                            ,
                                                            0
                                                         
                                                         }
                                                      
                                                   
                                                   
                                                      min
                                                      
                                                         {
                                                         
                                                            l
                                                            ,
                                                            R
                                                            ,
                                                            max
                                                            
                                                               {
                                                               
                                                                  K
                                                                  −
                                                                  k
                                                                  ,
                                                                  0
                                                               
                                                               }
                                                            
                                                         
                                                         }
                                                      
                                                   
                                                
                                                
                                                   D
                                                   
                                                      l
                                                      k
                                                   
                                                   
                                                      B
                                                      ,
                                                      k
                                                      −
                                                      l
                                                      +
                                                      a
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   I
                                                   
                                                      {
                                                      
                                                         l
                                                         <
                                                         K
                                                         ,
                                                         max
                                                         
                                                            {
                                                            
                                                               l
                                                               −
                                                               R
                                                               ,
                                                               0
                                                            
                                                            }
                                                         
                                                         ≤
                                                         k
                                                         <
                                                         K
                                                      
                                                      }
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      a
                                                      =
                                                      max
                                                      
                                                         {
                                                         
                                                            l
                                                            −
                                                            k
                                                            ,
                                                            0
                                                         
                                                         }
                                                      
                                                   
                                                   
                                                      min
                                                      
                                                         {
                                                         
                                                            l
                                                            ,
                                                            R
                                                            ,
                                                            max
                                                            
                                                               {
                                                               
                                                                  K
                                                                  −
                                                                  k
                                                                  −
                                                                  1
                                                                  ,
                                                                  0
                                                               
                                                               }
                                                            
                                                         
                                                         }
                                                      
                                                   
                                                
                                                
                                                   D
                                                   
                                                      l
                                                      k
                                                   
                                                   
                                                      C
                                                      ,
                                                      k
                                                      −
                                                      l
                                                      +
                                                      a
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The transient distribution of the model can be worked out from the transition probability matrix by considering the different matrix blocks. Given the initial distribution 
                              
                                 ω
                                 =
                                 (
                                 
                                    
                                       ω
                                       0
                                    
                                    ,
                                    
                                       ω
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       ω
                                       K
                                    
                                 
                                 )
                              
                            the probability that at time ν the system is in the different states of the macro-state Ek
                            is noted by 
                              
                                 p
                                 
                                    
                                       E
                                       k
                                    
                                 
                                 ν
                              
                            and it is given by considering the matrix block structure as

                              
                                 
                                    
                                       
                                          p
                                          
                                             
                                                E
                                                k
                                             
                                          
                                          ν
                                       
                                       =
                                       
                                          ∑
                                          
                                             l
                                             =
                                             0
                                          
                                          K
                                       
                                       
                                          
                                             ω
                                             l
                                          
                                          
                                             D
                                             
                                                l
                                                k
                                             
                                             
                                                (
                                                ν
                                                )
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           where

                              
                                 
                                    
                                       
                                          
                                             
                                                D
                                                
                                                   l
                                                   k
                                                
                                                
                                                   (
                                                   ν
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         l
                                                         1
                                                      
                                                      =
                                                      l
                                                      −
                                                      min
                                                      
                                                         {
                                                         
                                                            l
                                                            ,
                                                            R
                                                         
                                                         }
                                                      
                                                   
                                                   
                                                      min
                                                      
                                                         {
                                                         
                                                            k
                                                            +
                                                            min
                                                            
                                                               {
                                                               
                                                                  l
                                                                  ,
                                                                  R
                                                               
                                                               }
                                                            
                                                            ,
                                                            K
                                                         
                                                         }
                                                      
                                                   
                                                
                                                
                                                   D
                                                   
                                                      l
                                                      ,
                                                      
                                                         l
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         l
                                                         2
                                                      
                                                      =
                                                      
                                                         l
                                                         1
                                                      
                                                      −
                                                      min
                                                      
                                                         {
                                                         
                                                            
                                                               l
                                                               1
                                                            
                                                            ,
                                                            R
                                                         
                                                         }
                                                      
                                                   
                                                   
                                                      min
                                                      
                                                         {
                                                         
                                                            k
                                                            +
                                                            min
                                                            
                                                               {
                                                               
                                                                  
                                                                     l
                                                                     1
                                                                  
                                                                  ,
                                                                  R
                                                               
                                                               }
                                                            
                                                            ,
                                                            K
                                                         
                                                         }
                                                      
                                                   
                                                
                                                
                                                   D
                                                   
                                                      
                                                         l
                                                         1
                                                      
                                                      ,
                                                      
                                                         l
                                                         2
                                                      
                                                   
                                                
                                                ⋯
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ×
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         l
                                                         
                                                            ν
                                                            −
                                                            2
                                                         
                                                      
                                                      =
                                                      
                                                         l
                                                         
                                                            ν
                                                            −
                                                            3
                                                         
                                                      
                                                      −
                                                      min
                                                      
                                                         {
                                                         
                                                            
                                                               l
                                                               
                                                                  ν
                                                                  −
                                                                  3
                                                               
                                                            
                                                            ,
                                                            R
                                                         
                                                         }
                                                      
                                                   
                                                   
                                                      min
                                                      
                                                         {
                                                         
                                                            k
                                                            +
                                                            min
                                                            
                                                               {
                                                               
                                                                  
                                                                     l
                                                                     
                                                                        ν
                                                                        −
                                                                        3
                                                                     
                                                                  
                                                                  ,
                                                                  R
                                                               
                                                               }
                                                            
                                                            ,
                                                            K
                                                         
                                                         }
                                                      
                                                   
                                                
                                                
                                                   
                                                      D
                                                      
                                                         
                                                            l
                                                            
                                                               ν
                                                               −
                                                               3
                                                            
                                                         
                                                         ,
                                                         
                                                            l
                                                            
                                                               ν
                                                               −
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            l
                                                            
                                                               ν
                                                               −
                                                               1
                                                            
                                                         
                                                         =
                                                         
                                                            l
                                                            
                                                               ν
                                                               −
                                                               2
                                                            
                                                         
                                                         −
                                                         min
                                                         
                                                            {
                                                            
                                                               
                                                                  l
                                                                  
                                                                     ν
                                                                     −
                                                                     2
                                                                  
                                                               
                                                               ,
                                                               R
                                                            
                                                            }
                                                         
                                                      
                                                      
                                                         min
                                                         
                                                            {
                                                            
                                                               k
                                                               +
                                                               min
                                                               
                                                                  {
                                                                  
                                                                     
                                                                        l
                                                                        
                                                                           ν
                                                                           −
                                                                           2
                                                                        
                                                                     
                                                                     ,
                                                                     R
                                                                  
                                                                  }
                                                               
                                                               ,
                                                               K
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                         
                                                            
                                                               l
                                                               
                                                                  ν
                                                                  −
                                                                  2
                                                               
                                                            
                                                            ,
                                                            
                                                               l
                                                               
                                                                  ν
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         D
                                                         
                                                            
                                                               l
                                                               
                                                                  ν
                                                                  −
                                                                  1
                                                               
                                                            
                                                            ,
                                                            k
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Some different systems can be derived from the basic system. Repairable and non-repairable failures on the online unit where these failures may, or may not depend on the time up to internal failure of the online unit are considered. These new systems are modelled by considering similar structure as given above but with different matrices H.


                     SYSTEM II: A System with only repairable or non-repairable internal failures depending on the time up to failure of the online unit
                  

We assume the system I where external failures cannot occur. This one is a particular case of the system above but the state space changes in the following way

                        
                           
                              
                                 
                                    E
                                    0
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          (
                                          
                                             i
                                             ,
                                             m
                                          
                                          )
                                       
                                       ;
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                       ,
                                       1
                                       ≤
                                       m
                                       ≤
                                       
                                          ɛ
                                       
                                    
                                    }
                                 
                                 ,
                              
                           
                        
                     for k
                     <
                     K
                     
                        
                           
                              
                                 
                                    
                                       
                                          E
                                          
                                             
                                                i
                                                1
                                             
                                             ,
                                             …
                                             ,
                                             
                                                i
                                                k
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             (
                                             
                                                i
                                                ,
                                                m
                                                ,
                                                
                                                   r
                                                   1
                                                
                                                ,
                                                
                                                   r
                                                   2
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   r
                                                   
                                                      min
                                                      
                                                         {
                                                         
                                                            k
                                                            ,
                                                            R
                                                         
                                                         }
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          ;
                                          1
                                          ≤
                                          i
                                          ≤
                                          n
                                          ,
                                          1
                                          ≤
                                          m
                                          ≤
                                          
                                             ɛ
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             
                                                r
                                                h
                                             
                                             ≤
                                             
                                                z
                                                
                                                   i
                                                   h
                                                
                                             
                                             ,
                                             h
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             min
                                             
                                                {
                                                
                                                   k
                                                   ,
                                                   R
                                                
                                                }
                                             
                                             }
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     and for k
                     =K

                        
                           
                              
                                 
                                    E
                                    
                                       
                                          i
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          i
                                          K
                                       
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          (
                                          
                                             
                                                r
                                                1
                                             
                                             ,
                                             
                                                r
                                                2
                                             
                                             ,
                                             …
                                             ,
                                             
                                                r
                                                R
                                             
                                          
                                          )
                                       
                                       ;
                                       1
                                       ≤
                                       
                                          r
                                          h
                                       
                                       ≤
                                       
                                          z
                                          
                                             i
                                             h
                                          
                                       
                                       ,
                                       h
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       R
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     
                  

The matrix blocks are given by

                        
                           
                              
                                 
                                    H
                                    0
                                 
                                 =
                                 T
                                 ⊗
                                 M
                                 +
                                 
                                    U
                                    1
                                 
                                 T
                                 ⊗
                                 
                                    
                                       M
                                    
                                    0
                                 
                                 η
                                 ,
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    H
                                    1
                                 
                                 =
                                 
                                    T
                                    r
                                    0
                                 
                                 α
                                 ⊗
                                 
                                    (
                                    
                                       
                                          
                                             M
                                          
                                          0
                                       
                                       η
                                       +
                                       M
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    H
                                    1
                                    ′
                                 
                                 =
                                 
                                    T
                                    r
                                    0
                                 
                                 ⊗
                                 
                                    e
                                    
                                       ɛ
                                    
                                 
                                 .
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    H
                                    2
                                 
                                 =
                                 
                                    U
                                    2
                                 
                                 
                                    (
                                    
                                       
                                          e
                                          n
                                       
                                       −
                                       
                                          
                                             T
                                          
                                          0
                                       
                                    
                                    )
                                 
                                 α
                                 ⊗
                                 
                                    
                                       M
                                    
                                    0
                                 
                                 η
                                 .
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    H
                                    2
                                    ′
                                 
                                 =
                                 
                                    U
                                    2
                                 
                                 T
                                 ⊗
                                 
                                    
                                       M
                                    
                                    0
                                 
                                 η
                                 .
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    H
                                    3
                                 
                                 =
                                 
                                    T
                                    
                                       n
                                       r
                                    
                                    0
                                 
                                 α
                                 ⊗
                                 
                                    (
                                    
                                       
                                          
                                             M
                                          
                                          0
                                       
                                       
                                          η
                                          +
                                          M
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  


                     SYSTEM III: A System with repairable or non-repairable external and internal failures depending on the time up to failure of the online unit without preventive maintenance
                  

We assume system I without random inspections. Preventive maintenance is removed. This one is a particular case of system I with the following state space

                        
                           
                              
                                 
                                    E
                                    0
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          (
                                          
                                             i
                                             ,
                                             j
                                          
                                          )
                                       
                                       ;
                                       1
                                       ≤
                                       i
                                       ≤
                                       n
                                       ,
                                       1
                                       ≤
                                       j
                                       ≤
                                       t
                                    
                                    }
                                 
                                 ,
                              
                           
                        
                     for k
                     <
                     K
                     
                        
                           
                              
                                 
                                    
                                       
                                          E
                                          
                                             
                                                i
                                                1
                                             
                                             ,
                                             …
                                             ,
                                             
                                                i
                                                k
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             (
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                
                                                   r
                                                   1
                                                
                                                ,
                                                
                                                   r
                                                   2
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   r
                                                   
                                                      min
                                                      
                                                         {
                                                         
                                                            k
                                                            ,
                                                            R
                                                         
                                                         }
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          ;
                                          1
                                          ≤
                                          i
                                          ≤
                                          n
                                          ,
                                          1
                                          ≤
                                          j
                                          ≤
                                          t
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             
                                                r
                                                h
                                             
                                             ≤
                                             
                                                z
                                                
                                                   i
                                                   h
                                                
                                             
                                             ,
                                             h
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             min
                                             
                                                {
                                                
                                                   k
                                                   ,
                                                   R
                                                
                                                }
                                             
                                             }
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     and for k
                     =
                     K
                     
                        
                           
                              
                                 
                                    E
                                    
                                       
                                          i
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          i
                                          K
                                       
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          (
                                          
                                             j
                                             ,
                                             
                                                r
                                                1
                                             
                                             ,
                                             
                                                r
                                                2
                                             
                                             ,
                                             …
                                             ,
                                             
                                                r
                                                R
                                             
                                          
                                          )
                                       
                                       ;
                                       1
                                       ≤
                                       j
                                       ≤
                                       t
                                       ,
                                       1
                                       ≤
                                       
                                          r
                                          h
                                       
                                       ≤
                                       
                                          z
                                          
                                             i
                                             h
                                          
                                       
                                       ,
                                       h
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       R
                                    
                                    }
                                 
                                 ,
                              
                           
                        
                     
                  

The matrix blocks are given in this case as

                        
                           
                              
                                 
                                    H
                                    0
                                 
                                 =
                                 T
                                 ⊗
                                 L
                                 ,
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    H
                                    1
                                 
                                 =
                                 
                                    T
                                    r
                                    0
                                 
                                 α
                                 ⊗
                                 
                                    (
                                    
                                       L
                                       +
                                       
                                          L
                                          r
                                          0
                                       
                                       γ
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          e
                                          n
                                       
                                       −
                                       
                                          
                                             T
                                          
                                          0
                                       
                                    
                                    )
                                 
                                 α
                                 ⊗
                                 
                                    L
                                    r
                                    0
                                 
                                 γ
                                 ,
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    H
                                    1
                                    ′
                                 
                                 =
                                 
                                    T
                                    r
                                    0
                                 
                                 ⊗
                                 
                                    (
                                    
                                       L
                                       +
                                       
                                          L
                                          r
                                          0
                                       
                                       γ
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          e
                                          n
                                       
                                       −
                                       
                                          
                                             T
                                          
                                          0
                                       
                                    
                                    )
                                 
                                 ⊗
                                 
                                    L
                                    r
                                    0
                                 
                                 γ
                                 ,
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    H
                                    3
                                 
                                 =
                                 
                                    T
                                    
                                       n
                                       r
                                    
                                    0
                                 
                                 α
                                 ⊗
                                 
                                    (
                                    
                                       L
                                       +
                                       
                                          
                                             L
                                          
                                          0
                                       
                                       γ
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          e
                                          n
                                       
                                       −
                                       
                                          
                                             T
                                          
                                          0
                                       
                                    
                                    )
                                 
                                 α
                                 ⊗
                                 
                                    L
                                    
                                       n
                                       r
                                    
                                    0
                                 
                                 γ
                                 .
                              
                           
                        
                     
                  

Finally, in this case the MMAP is given by

                        
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             D
                                          
                                          
                                             O
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             O
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             O
                                             ,
                                             K
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             A
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             A
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             A
                                             ,
                                             K
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             C
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             C
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             C
                                             ,
                                             K
                                             −
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  


                     SYSTEM IV: A System with repairable or non-repairable internal and external failure of the online unit independent of the time up to failure
                  

We assume the basic system I where the internal (external) operational failure can be repairable with probability pin_re
                      (pex_re
                     ) and non-repairable with probability pin_nre
                     = 1− pin_nre
                      (pex_nre
                     = 1− pex_nre
                     ). The type of failure is independent of the failure time. The model of this system is achieved from system I by considering 
                        
                           
                              T
                              r
                              0
                           
                           =
                           
                              p
                              
                                 i
                                 n
                                 _
                                 r
                                 e
                              
                           
                           
                              
                                 T
                              
                              0
                           
                           
                        
                     , 
                        
                           
                              T
                              
                                 n
                                 r
                              
                              0
                           
                           =
                           
                              p
                              
                                 i
                                 n
                                 _
                                 n
                                 r
                                 e
                              
                           
                           
                              
                                 T
                              
                              0
                           
                        
                     , 
                        
                           
                              L
                              r
                              0
                           
                           =
                           
                              p
                              
                                 e
                                 x
                                 _
                                 r
                                 e
                              
                           
                           
                              
                                 L
                              
                              0
                           
                           
                           
                           and
                           
                           
                           
                              L
                              
                                 n
                                 r
                              
                              0
                           
                           =
                           
                              p
                              
                                 e
                                 x
                                 _
                                 n
                                 r
                                 e
                              
                           
                           
                              
                                 L
                              
                              0
                           
                        
                     
                     SYSTEM V: A System with repairable internal failure and external repairable or non-repairable failure independent of the time up to failure
                  

We assume the basic system I where the internal operational failure is always repairable (pin_re
                     
                     =1) and the external operational failure can be repairable with probability pex_re
                      and non-repairable with probability pex_nre
                     
                     =1−
                     pex_nre
                     . The type of failure is independent of the failure time. The model of this system is achieved from system I by considering 
                        
                           
                              T
                              r
                              0
                           
                           =
                           
                              
                                 T
                              
                              0
                           
                           ,
                           
                           
                           
                              T
                              
                                 n
                                 r
                              
                              0
                           
                           =
                           0
                           ,
                           
                           
                           
                              L
                              r
                              0
                           
                           =
                           
                              p
                              
                                 e
                                 x
                                 _
                                 r
                                 e
                              
                           
                           
                              
                                 L
                              
                              0
                           
                           
                           and
                           
                           
                              L
                              
                                 n
                                 r
                              
                              0
                           
                           =
                           
                              p
                              
                                 e
                                 x
                                 _
                                 n
                                 r
                                 e
                              
                           
                           
                              
                                 L
                              
                              0
                           
                           .
                        
                     
                  


                     
                        Remark
                        New systems can be obtained by considering independence on the type of failure. In this case, new models can be achieved by considering system I, II and III with 
                              
                                 
                                    T
                                    r
                                    0
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    0
                                 
                                 
                                    p
                                    
                                       i
                                       n
                                       _
                                       r
                                       e
                                    
                                 
                                 ,
                                 
                                 
                                 
                                    T
                                    
                                       n
                                       r
                                    
                                    0
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    0
                                 
                                 
                                    p
                                    
                                       i
                                       n
                                       _
                                       n
                                       r
                                       e
                                    
                                 
                                 ,
                                 
                                 
                                 
                                    L
                                    r
                                    0
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    0
                                 
                                 
                                    p
                                    
                                       e
                                       x
                                       _
                                       r
                                       e
                                    
                                 
                                 
                                 
                                 and
                                 
                                 
                                 
                                    L
                                    
                                       n
                                       r
                                    
                                    0
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    0
                                 
                                 
                                    p
                                    
                                       e
                                       x
                                       _
                                       n
                                       r
                                       e
                                    
                                 
                                 .
                              
                           
                        

Some interesting measures associated to system I (the more general system) are calculated. Particular cases can be worked out for the other systems in a similar way.

The availability is the probability that the system is working on at a certain time ν. It is given by


                        
                           
                              
                                 
                                    A
                                    
                                       (
                                       ν
                                       )
                                    
                                    =
                                    1
                                    −
                                    
                                       p
                                       
                                          
                                             E
                                             K
                                          
                                       
                                       ν
                                    
                                    
                                       e
                                       
                                          
                                             I
                                             
                                                {
                                                
                                                   R
                                                   <
                                                   K
                                                
                                                }
                                             
                                          
                                          2
                                          ·
                                          
                                             3
                                             
                                                K
                                                −
                                                R
                                                −
                                                1
                                             
                                          
                                          t
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             R
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   R
                                                   −
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      R
                                                      !
                                                   
                                                   
                                                      i
                                                      !
                                                      j
                                                      !
                                                      (
                                                      R
                                                      −
                                                      i
                                                      −
                                                      j
                                                      )
                                                      !
                                                   
                                                
                                                
                                                   z
                                                   0
                                                   i
                                                
                                                
                                                   z
                                                   1
                                                   j
                                                
                                                
                                                   z
                                                   2
                                                   
                                                      R
                                                      −
                                                      i
                                                      −
                                                      j
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             I
                                             
                                                {
                                                
                                                   R
                                                   =
                                                   K
                                                
                                                }
                                             
                                          
                                          t
                                          
                                             (
                                             
                                                
                                                   z
                                                   0
                                                
                                                +
                                                
                                                   z
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                R
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   R
                                                   −
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            R
                                                            −
                                                            1
                                                         
                                                         )
                                                      
                                                      !
                                                   
                                                   
                                                      i
                                                      !
                                                      j
                                                      !
                                                      (
                                                      R
                                                      −
                                                      i
                                                      −
                                                      j
                                                      −
                                                      1
                                                      )
                                                      !
                                                   
                                                
                                                
                                                   z
                                                   0
                                                   i
                                                
                                                
                                                   z
                                                   1
                                                   j
                                                
                                                
                                                   z
                                                   2
                                                   
                                                      R
                                                      −
                                                      i
                                                      −
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where the subscript of the vector e is the number of columns of 
                           
                              p
                              
                                 
                                    E
                                    K
                                 
                              
                              ν
                           
                         (defined in Section 3.2.2).

If the system is new initially then


                        
                           
                              
                                 
                                    A
                                    
                                       (
                                       ν
                                       )
                                    
                                    =
                                    1
                                    −
                                    
                                       ω
                                       0
                                    
                                    
                                       D
                                       
                                          0
                                          K
                                       
                                       
                                          (
                                          ν
                                          )
                                       
                                    
                                    
                                       e
                                       
                                          
                                             I
                                             
                                                {
                                                
                                                   R
                                                   <
                                                   K
                                                
                                                }
                                             
                                          
                                          2
                                          ·
                                          
                                             3
                                             
                                                K
                                                −
                                                R
                                                −
                                                1
                                             
                                          
                                          t
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             R
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   R
                                                   −
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      R
                                                      !
                                                   
                                                   
                                                      i
                                                      !
                                                      j
                                                      !
                                                      (
                                                      R
                                                      −
                                                      i
                                                      −
                                                      j
                                                      )
                                                      !
                                                   
                                                
                                                
                                                   z
                                                   0
                                                   i
                                                
                                                
                                                   z
                                                   1
                                                   j
                                                
                                                
                                                   z
                                                   2
                                                   
                                                      R
                                                      −
                                                      i
                                                      −
                                                      j
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             I
                                             
                                                {
                                                
                                                   R
                                                   =
                                                   K
                                                
                                                }
                                             
                                          
                                          t
                                          
                                             (
                                             
                                                
                                                   z
                                                   0
                                                
                                                +
                                                
                                                   z
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                R
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   R
                                                   −
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            R
                                                            −
                                                            1
                                                         
                                                         )
                                                      
                                                      !
                                                   
                                                   
                                                      i
                                                      !
                                                      j
                                                      !
                                                      (
                                                      R
                                                      −
                                                      i
                                                      −
                                                      j
                                                      −
                                                      1
                                                      )
                                                      !
                                                   
                                                
                                                
                                                   z
                                                   0
                                                   i
                                                
                                                
                                                   z
                                                   1
                                                   j
                                                
                                                
                                                   z
                                                   2
                                                   
                                                      R
                                                      −
                                                      i
                                                      −
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The reliability function is defined as the probability that the system fails by first time after a certain time. This function can be defined by considering different stop times while the system is evolving by time. The distribution function of this stop time is PH-distributed where the absorbing state is the fact that produces the stop event. For instance, if the system is new initially, then the distribution of the time up to first time that the system has not operational units is PH distributed with representation (
                           ω
                        
                        *, P
                        *) where 
                           ω
                        
                        *and P
                        * are the initial distribution and the matrix P restricted to the macro-states {E
                        0,…, EK
                        
                        −1}.

Thus, the mean time up to first time that the system is not operational is given by

                           
                              
                                 
                                    μ
                                    =
                                    
                                       ω
                                       *
                                    
                                    
                                       
                                          (
                                          
                                             I
                                             −
                                             
                                                P
                                                *
                                             
                                          
                                          )
                                       
                                       
                                          −
                                          2
                                       
                                    
                                    
                                       P
                                       *
                                       0
                                    
                                    =
                                    
                                       ω
                                       *
                                    
                                    
                                       
                                          (
                                          
                                             I
                                             −
                                             
                                                P
                                                *
                                             
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    e
                                    .
                                 
                              
                           
                        
                     

Some different conditional probability of failure can be defined if the different types of failures and preventive maintenance are considered. We focused on system I, a similar reasoning can be developed for the rest of systems.

The conditional probability of internal repairable failure is the probability that the system is working on at the beginning of a certain time ν, and an internal repairable failure on the online unit and r warm standby units fail at that moment (an accidental non-repairable failure on the online unit does not occur). This probability is given by

                              
                                 
                                    
                                       
                                          ϕ
                                          
                                             i
                                             n
                                             _
                                             r
                                             e
                                          
                                          
                                             r
                                             ,
                                             ν
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             K
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             I
                                             
                                                {
                                                
                                                   r
                                                   ≤
                                                   K
                                                   −
                                                   k
                                                   −
                                                   1
                                                
                                                }
                                             
                                          
                                          
                                             p
                                             
                                                
                                                   E
                                                   k
                                                
                                             
                                             
                                                ν
                                                −
                                                1
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   T
                                                   r
                                                   0
                                                
                                                ⊗
                                                
                                                   (
                                                   
                                                      
                                                         e
                                                         t
                                                      
                                                      −
                                                      
                                                         L
                                                         
                                                            n
                                                            r
                                                         
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                ⊗
                                                e
                                             
                                             ]
                                          
                                       
                                       
                                          p
                                          r
                                       
                                       
                                          
                                             (
                                             
                                                1
                                                −
                                                p
                                             
                                             )
                                          
                                          
                                             K
                                             −
                                             k
                                             −
                                             r
                                             −
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

The conditional probability of internal non-repairable failure is the probability that the system is working on at the beginning of a certain time ν, and an internal non-repairable failure on the online unit and r warm standby units fail at that moment (any accidental failure can occur). This probability is given by

                              
                                 
                                    
                                       
                                          ϕ
                                          
                                             i
                                             n
                                             _
                                             n
                                             r
                                             e
                                          
                                          
                                             r
                                             ,
                                             ν
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             K
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             I
                                             
                                                {
                                                
                                                   r
                                                   ≤
                                                   K
                                                   −
                                                   k
                                                   −
                                                   1
                                                
                                                }
                                             
                                          
                                          
                                             p
                                             
                                                
                                                   E
                                                   k
                                                
                                             
                                             
                                                ν
                                                −
                                                1
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   T
                                                   
                                                      n
                                                      r
                                                   
                                                   0
                                                
                                                ⊗
                                                e
                                             
                                             ]
                                          
                                       
                                       
                                          p
                                          r
                                       
                                       
                                          
                                             (
                                             
                                                1
                                                −
                                                p
                                             
                                             )
                                          
                                          
                                             K
                                             −
                                             k
                                             −
                                             r
                                             −
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

The conditional probability of internal failure is achieved by adding both measures above.

A similar reasoning as above can be made for the external failures. Thus, the conditional probability of repairable external failure is the probability that the system is working on at the beginning of a certain time ν, and a repairable external failure on the online unit and r warm standby units fail at that moment (an internal non-repairable failure does not occur). This probability is given by

                              
                                 
                                    
                                       
                                          ϕ
                                          
                                             e
                                             x
                                             _
                                             r
                                             e
                                          
                                          
                                             r
                                             ,
                                             ν
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             K
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             I
                                             
                                                {
                                                
                                                   r
                                                   ≤
                                                   K
                                                   −
                                                   k
                                                   −
                                                   1
                                                
                                                }
                                             
                                          
                                          
                                             p
                                             
                                                
                                                   E
                                                   k
                                                
                                             
                                             
                                                ν
                                                −
                                                1
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   (
                                                   
                                                      
                                                         e
                                                         n
                                                      
                                                      −
                                                      
                                                         T
                                                         
                                                            n
                                                            r
                                                         
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                ⊗
                                                
                                                   L
                                                   r
                                                   0
                                                
                                                ⊗
                                                e
                                             
                                             ]
                                          
                                       
                                       
                                          p
                                          r
                                       
                                       
                                          
                                             (
                                             
                                                1
                                                −
                                                p
                                             
                                             )
                                          
                                          
                                             K
                                             −
                                             k
                                             −
                                             r
                                             −
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

The conditional probability of non-repairable external failure is the probability that the system is working on at the beginning of a certain time ν, and a non-repairable external failure on the online unit and r warm standby units fail at that moment (any internal failure can occur). This probability is given by

                              
                                 
                                    
                                       
                                          ϕ
                                          
                                             e
                                             x
                                             _
                                             n
                                             r
                                             e
                                          
                                          
                                             r
                                             ,
                                             ν
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             K
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             I
                                             
                                                {
                                                
                                                   r
                                                   ≤
                                                   K
                                                   −
                                                   k
                                                   −
                                                   1
                                                
                                                }
                                             
                                          
                                          
                                             p
                                             
                                                
                                                   E
                                                   k
                                                
                                             
                                             
                                                ν
                                                −
                                                1
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   e
                                                   n
                                                
                                                ⊗
                                                
                                                   L
                                                   
                                                      n
                                                      r
                                                   
                                                   0
                                                
                                                ⊗
                                                e
                                             
                                             ]
                                          
                                       
                                       
                                          p
                                          r
                                       
                                       
                                          
                                             (
                                             
                                                1
                                                −
                                                p
                                             
                                             )
                                          
                                          
                                             K
                                             −
                                             k
                                             −
                                             r
                                             −
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

The conditional probability of external failure is achieved by adding both measures above.

The conditional probability of major inspection is the probability that the system is working on at the beginning of a certain time ν, and a major inspection occurs by producing preventive maintenance and r warm standby units fail (the online unit does not undergo failures at that time.). This probability is given by

                              
                                 
                                    
                                       
                                          ϕ
                                          
                                             p
                                             m
                                          
                                          ν
                                       
                                       
                                       =
                                       
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             K
                                             −
                                             2
                                          
                                       
                                       
                                          
                                             I
                                             
                                                {
                                                
                                                   r
                                                   ≤
                                                   K
                                                   −
                                                   k
                                                   −
                                                   1
                                                
                                                }
                                             
                                          
                                          
                                             p
                                             
                                                
                                                   E
                                                   k
                                                
                                             
                                             
                                                ν
                                                −
                                                1
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   (
                                                   
                                                      
                                                         e
                                                         n
                                                      
                                                      
                                                      −
                                                      
                                                      
                                                         
                                                            T
                                                         
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                ⊗
                                                
                                                   (
                                                   
                                                      
                                                         e
                                                         t
                                                      
                                                      
                                                      −
                                                      
                                                      
                                                         
                                                            L
                                                         
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                ⊗
                                                e
                                             
                                             ]
                                          
                                       
                                       
                                          p
                                          r
                                       
                                       
                                          
                                             (
                                             
                                                1
                                                
                                                −
                                                
                                                p
                                             
                                             )
                                          
                                          
                                             K
                                             −
                                             k
                                             −
                                             r
                                             −
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

One interesting measure from economic and performance point of view is the mean sojourn time. While the system is working on, this one passes through several states, how long does it spend in each macro-state up to a certain time?

From the Markovian theory, it is well-known that the mean sojourn mean time at any macro-state k up to time ν can be worked out as

                              
                                 (3)
                                 
                                    
                                       
                                          ψ
                                          k
                                          ν
                                       
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             0
                                          
                                          ν
                                       
                                       
                                          
                                             p
                                             
                                                
                                                   E
                                                   k
                                                
                                             
                                             m
                                          
                                          e
                                       
                                       
                                       
                                       ,
                                       for
                                       
                                       
                                       k
                                       =
                                       
                                       0
                                       ,
                                       
                                       
                                       1
                                       ,
                                       
                                       …
                                       ,
                                       K
                                       .
                                    
                                 
                              
                           
                        

The units of the system are partitioned between online and warm standby, and the repair time of any one, when a repairable failure occurs, depends on it. In this section we are interested about the mean time that the repairpersons are working on units that failed from the online place and from the standby up to a certain time.

The mean time that the repairpersons are working on standby repairable failures from the beginning up to time ν is given by

                              
                                 (4)
                                 
                                    
                                       
                                          ψ
                                          
                                             s
                                             t
                                             b
                                             y
                                          
                                          ν
                                       
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             0
                                          
                                          ν
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          
                                             
                                                p
                                                
                                                   
                                                      E
                                                      k
                                                   
                                                
                                                m
                                             
                                             
                                                q
                                                k
                                                0
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 q
                                 k
                                 w
                              
                            is a column vector defined for k
                           =1,…, K−1 as

                              
                                 
                                    
                                       
                                          
                                             
                                                q
                                                k
                                                w
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               w
                                                            
                                                            
                                                               (
                                                               
                                                                  0
                                                                  ,
                                                                  0
                                                                  ,
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              min
                                                                              
                                                                                 {
                                                                                 
                                                                                    k
                                                                                    ,
                                                                                    R
                                                                                 
                                                                                 }
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           …
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                                  0
                                                                  ,
                                                                  0
                                                               
                                                               )
                                                            
                                                            
                                                               e
                                                               
                                                                  n
                                                                  t
                                                                  
                                                                     ɛ
                                                                  
                                                                  
                                                                     3
                                                                     
                                                                        
                                                                           I
                                                                           
                                                                              {
                                                                              
                                                                                 k
                                                                                 >
                                                                                 R
                                                                              
                                                                              }
                                                                           
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              k
                                                                              −
                                                                              R
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ∏
                                                                     
                                                                        i
                                                                        =
                                                                        0
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     z
                                                                     i
                                                                     
                                                                        
                                                                           q
                                                                           i
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              0
                                                                              ,
                                                                              0
                                                                              ,
                                                                              …
                                                                              ,
                                                                              0
                                                                              ,
                                                                              0
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               w
                                                            
                                                            
                                                               (
                                                               
                                                                  0
                                                                  ,
                                                                  0
                                                                  ,
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              min
                                                                              
                                                                                 {
                                                                                 
                                                                                    k
                                                                                    ,
                                                                                    R
                                                                                 
                                                                                 }
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           …
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                                  0
                                                                  ,
                                                                  1
                                                               
                                                               )
                                                            
                                                            
                                                               e
                                                               
                                                                  n
                                                                  t
                                                                  
                                                                     ɛ
                                                                  
                                                                  
                                                                     3
                                                                     
                                                                        
                                                                           I
                                                                           
                                                                              {
                                                                              
                                                                                 k
                                                                                 >
                                                                                 R
                                                                              
                                                                              }
                                                                           
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              k
                                                                              −
                                                                              R
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ∏
                                                                     
                                                                        i
                                                                        =
                                                                        0
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     z
                                                                     i
                                                                     
                                                                        
                                                                           q
                                                                           i
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              0
                                                                              ,
                                                                              0
                                                                              ,
                                                                              …
                                                                              ,
                                                                              0
                                                                              ,
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               w
                                                            
                                                            
                                                               (
                                                               
                                                                  0
                                                                  ,
                                                                  0
                                                                  ,
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              min
                                                                              
                                                                                 {
                                                                                 
                                                                                    k
                                                                                    ,
                                                                                    R
                                                                                 
                                                                                 }
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           …
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                                  0
                                                                  ,
                                                                  2
                                                               
                                                               )
                                                            
                                                            
                                                               e
                                                               
                                                                  n
                                                                  t
                                                                  
                                                                     ɛ
                                                                  
                                                                  
                                                                     3
                                                                     
                                                                        
                                                                           I
                                                                           
                                                                              {
                                                                              
                                                                                 k
                                                                                 >
                                                                                 R
                                                                              
                                                                              }
                                                                           
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              k
                                                                              −
                                                                              R
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ∏
                                                                     
                                                                        i
                                                                        =
                                                                        0
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     z
                                                                     i
                                                                     
                                                                        
                                                                           q
                                                                           i
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              0
                                                                              ,
                                                                              0
                                                                              ,
                                                                              …
                                                                              ,
                                                                              0
                                                                              ,
                                                                              2
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               w
                                                            
                                                            
                                                               (
                                                               
                                                                  0
                                                                  ,
                                                                  0
                                                                  ,
                                                                  …
                                                                  ,
                                                                  1
                                                                  ,
                                                                  0
                                                               
                                                               )
                                                            
                                                            
                                                               e
                                                               
                                                                  n
                                                                  t
                                                                  
                                                                     ɛ
                                                                  
                                                                  
                                                                     3
                                                                     
                                                                        
                                                                           I
                                                                           
                                                                              {
                                                                              
                                                                                 k
                                                                                 >
                                                                                 R
                                                                              
                                                                              }
                                                                           
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              k
                                                                              −
                                                                              R
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ∏
                                                                     
                                                                        i
                                                                        =
                                                                        0
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     z
                                                                     i
                                                                     
                                                                        
                                                                           q
                                                                           i
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              0
                                                                              ,
                                                                              0
                                                                              ,
                                                                              …
                                                                              ,
                                                                              1
                                                                              ,
                                                                              0
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               w
                                                            
                                                            
                                                               (
                                                               
                                                                  0
                                                                  ,
                                                                  0
                                                                  ,
                                                                  …
                                                                  ,
                                                                  1
                                                                  ,
                                                                  1
                                                               
                                                               )
                                                            
                                                            
                                                               e
                                                               
                                                                  n
                                                                  t
                                                                  
                                                                     ɛ
                                                                  
                                                                  
                                                                     3
                                                                     
                                                                        
                                                                           I
                                                                           
                                                                              {
                                                                              
                                                                                 k
                                                                                 >
                                                                                 R
                                                                              
                                                                              }
                                                                           
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              k
                                                                              −
                                                                              R
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ∏
                                                                     
                                                                        i
                                                                        =
                                                                        0
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     z
                                                                     i
                                                                     
                                                                        
                                                                           q
                                                                           i
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              0
                                                                              ,
                                                                              0
                                                                              ,
                                                                              …
                                                                              ,
                                                                              1
                                                                              ,
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               w
                                                            
                                                            
                                                               (
                                                               
                                                                  0
                                                                  ,
                                                                  0
                                                                  ,
                                                                  …
                                                                  ,
                                                                  1
                                                                  ,
                                                                  2
                                                               
                                                               )
                                                            
                                                            
                                                               e
                                                               
                                                                  
                                                                     I
                                                                     
                                                                        {
                                                                        
                                                                           k
                                                                           >
                                                                           R
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  n
                                                                  t
                                                                  
                                                                     ɛ
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        k
                                                                        −
                                                                        R
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     ∏
                                                                     
                                                                        i
                                                                        =
                                                                        0
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     z
                                                                     i
                                                                     
                                                                        
                                                                           q
                                                                           i
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              0
                                                                              ,
                                                                              0
                                                                              ,
                                                                              …
                                                                              ,
                                                                              1
                                                                              ,
                                                                              2
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               w
                                                            
                                                            
                                                               (
                                                               
                                                                  2
                                                                  ,
                                                                  2
                                                                  ,
                                                                  …
                                                                  ,
                                                                  2
                                                                  ,
                                                                  2
                                                               
                                                               )
                                                            
                                                            
                                                               e
                                                               
                                                                  n
                                                                  t
                                                                  
                                                                     ɛ
                                                                  
                                                                  
                                                                     3
                                                                     
                                                                        
                                                                           I
                                                                           
                                                                              {
                                                                              
                                                                                 k
                                                                                 >
                                                                                 R
                                                                              
                                                                              }
                                                                           
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              k
                                                                              −
                                                                              R
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ∏
                                                                     
                                                                        i
                                                                        =
                                                                        0
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     z
                                                                     i
                                                                     
                                                                        
                                                                           q
                                                                           i
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              2
                                                                              ,
                                                                              2
                                                                              ,
                                                                              …
                                                                              ,
                                                                              2
                                                                              ,
                                                                              2
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                q
                                                K
                                                w
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                                  w
                                                               
                                                               
                                                                  (
                                                                  
                                                                     0
                                                                     ,
                                                                     0
                                                                     ,
                                                                     
                                                                        
                                                                           
                                                                              R
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              …
                                                                           
                                                                        
                                                                     
                                                                     ,
                                                                     0
                                                                     ,
                                                                     0
                                                                  
                                                                  )
                                                               
                                                               
                                                                  e
                                                                  
                                                                     2
                                                                     t
                                                                     
                                                                        3
                                                                        
                                                                           (
                                                                           
                                                                              K
                                                                              −
                                                                              R
                                                                              −
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                     
                                                                        ∏
                                                                        
                                                                           i
                                                                           =
                                                                           0
                                                                        
                                                                        2
                                                                     
                                                                     
                                                                        z
                                                                        i
                                                                        
                                                                           
                                                                              q
                                                                              i
                                                                           
                                                                           
                                                                              (
                                                                              
                                                                                 0
                                                                                 ,
                                                                                 0
                                                                                 ,
                                                                                 …
                                                                                 ,
                                                                                 0
                                                                                 ,
                                                                                 0
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                                  w
                                                               
                                                               
                                                                  (
                                                                  
                                                                     0
                                                                     ,
                                                                     0
                                                                     ,
                                                                     
                                                                        
                                                                           
                                                                              R
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              …
                                                                           
                                                                        
                                                                     
                                                                     ,
                                                                     0
                                                                     ,
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               
                                                                  e
                                                                  
                                                                     2
                                                                     t
                                                                     
                                                                        3
                                                                        
                                                                           (
                                                                           
                                                                              K
                                                                              −
                                                                              R
                                                                              −
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                     
                                                                        ∏
                                                                        
                                                                           i
                                                                           =
                                                                           0
                                                                        
                                                                        2
                                                                     
                                                                     
                                                                        z
                                                                        i
                                                                        
                                                                           
                                                                              q
                                                                              i
                                                                           
                                                                           
                                                                              (
                                                                              
                                                                                 0
                                                                                 ,
                                                                                 0
                                                                                 ,
                                                                                 …
                                                                                 ,
                                                                                 0
                                                                                 ,
                                                                                 1
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                                  w
                                                               
                                                               
                                                                  (
                                                                  
                                                                     0
                                                                     ,
                                                                     0
                                                                     ,
                                                                     
                                                                        
                                                                           
                                                                              R
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              …
                                                                           
                                                                        
                                                                     
                                                                     ,
                                                                     0
                                                                     ,
                                                                     2
                                                                  
                                                                  )
                                                               
                                                               
                                                                  e
                                                                  
                                                                     2
                                                                     t
                                                                     
                                                                        3
                                                                        
                                                                           (
                                                                           
                                                                              K
                                                                              −
                                                                              R
                                                                              −
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                     
                                                                        ∏
                                                                        
                                                                           i
                                                                           =
                                                                           0
                                                                        
                                                                        2
                                                                     
                                                                     
                                                                        z
                                                                        i
                                                                        
                                                                           
                                                                              q
                                                                              i
                                                                           
                                                                           
                                                                              (
                                                                              
                                                                                 0
                                                                                 ,
                                                                                 0
                                                                                 ,
                                                                                 …
                                                                                 ,
                                                                                 0
                                                                                 ,
                                                                                 2
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                                  w
                                                               
                                                               
                                                                  (
                                                                  
                                                                     0
                                                                     ,
                                                                     0
                                                                     ,
                                                                     …
                                                                     ,
                                                                     1
                                                                     ,
                                                                     0
                                                                  
                                                                  )
                                                               
                                                               
                                                                  e
                                                                  
                                                                     2
                                                                     t
                                                                     
                                                                        3
                                                                        
                                                                           (
                                                                           
                                                                              K
                                                                              −
                                                                              R
                                                                              −
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                     
                                                                        ∏
                                                                        
                                                                           i
                                                                           =
                                                                           0
                                                                        
                                                                        2
                                                                     
                                                                     
                                                                        z
                                                                        i
                                                                        
                                                                           
                                                                              q
                                                                              i
                                                                           
                                                                           
                                                                              (
                                                                              
                                                                                 0
                                                                                 ,
                                                                                 0
                                                                                 ,
                                                                                 …
                                                                                 ,
                                                                                 1
                                                                                 ,
                                                                                 0
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                                  w
                                                               
                                                               
                                                                  (
                                                                  
                                                                     0
                                                                     ,
                                                                     0
                                                                     ,
                                                                     …
                                                                     ,
                                                                     1
                                                                     ,
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               
                                                                  e
                                                                  
                                                                     2
                                                                     t
                                                                     
                                                                        3
                                                                        
                                                                           (
                                                                           
                                                                              K
                                                                              −
                                                                              R
                                                                              −
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                     
                                                                        ∏
                                                                        
                                                                           i
                                                                           =
                                                                           0
                                                                        
                                                                        2
                                                                     
                                                                     
                                                                        z
                                                                        i
                                                                        
                                                                           
                                                                              q
                                                                              i
                                                                           
                                                                           
                                                                              (
                                                                              
                                                                                 0
                                                                                 ,
                                                                                 0
                                                                                 ,
                                                                                 …
                                                                                 ,
                                                                                 1
                                                                                 ,
                                                                                 1
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                                  w
                                                               
                                                               
                                                                  (
                                                                  
                                                                     0
                                                                     ,
                                                                     0
                                                                     ,
                                                                     …
                                                                     ,
                                                                     1
                                                                     ,
                                                                     2
                                                                  
                                                                  )
                                                               
                                                               ⊗
                                                               
                                                                  e
                                                                  
                                                                     2
                                                                     t
                                                                     
                                                                        3
                                                                        
                                                                           (
                                                                           
                                                                              K
                                                                              −
                                                                              R
                                                                              −
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                     
                                                                        ∏
                                                                        
                                                                           i
                                                                           =
                                                                           0
                                                                        
                                                                        2
                                                                     
                                                                     
                                                                        z
                                                                        i
                                                                        
                                                                           
                                                                              q
                                                                              i
                                                                           
                                                                           
                                                                              (
                                                                              
                                                                                 0
                                                                                 ,
                                                                                 0
                                                                                 ,
                                                                                 …
                                                                                 ,
                                                                                 1
                                                                                 ,
                                                                                 2
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ⋮
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                                  w
                                                               
                                                               
                                                                  (
                                                                  
                                                                     2
                                                                     ,
                                                                     2
                                                                     ,
                                                                     …
                                                                     ,
                                                                     2
                                                                     ,
                                                                     2
                                                                  
                                                                  )
                                                               
                                                               
                                                                  e
                                                                  
                                                                     2
                                                                     t
                                                                     
                                                                        3
                                                                        
                                                                           (
                                                                           
                                                                              K
                                                                              −
                                                                              R
                                                                              −
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                     
                                                                        ∏
                                                                        
                                                                           i
                                                                           =
                                                                           0
                                                                        
                                                                        2
                                                                     
                                                                     
                                                                        z
                                                                        i
                                                                        
                                                                           
                                                                              q
                                                                              i
                                                                           
                                                                           
                                                                              (
                                                                              
                                                                                 2
                                                                                 ,
                                                                                 2
                                                                                 ,
                                                                                 …
                                                                                 ,
                                                                                 2
                                                                                 ,
                                                                                 2
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           with K
                           ≠
                           R and for K
                           =
                           R,

                              
                                 
                                    
                                       
                                          q
                                          K
                                          w
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                         w
                                                      
                                                      
                                                         (
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            
                                                               
                                                                  
                                                                     R
                                                                  
                                                               
                                                               
                                                                  
                                                                     …
                                                                  
                                                               
                                                            
                                                            ,
                                                            0
                                                            ,
                                                            0
                                                         
                                                         )
                                                      
                                                      
                                                         e
                                                         
                                                            t
                                                            
                                                               ∏
                                                               
                                                                  i
                                                                  =
                                                                  0
                                                               
                                                               2
                                                            
                                                            
                                                               z
                                                               i
                                                               
                                                                  
                                                                     q
                                                                     i
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        0
                                                                        ,
                                                                        0
                                                                        ,
                                                                        …
                                                                        ,
                                                                        0
                                                                        ,
                                                                        0
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         q
                                                         w
                                                      
                                                      
                                                         (
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            
                                                               
                                                                  
                                                                     R
                                                                  
                                                               
                                                               
                                                                  
                                                                     …
                                                                  
                                                               
                                                            
                                                            ,
                                                            0
                                                            ,
                                                            1
                                                         
                                                         )
                                                      
                                                      
                                                         e
                                                         
                                                            t
                                                            
                                                               ∏
                                                               
                                                                  i
                                                                  =
                                                                  0
                                                               
                                                               2
                                                            
                                                            
                                                               z
                                                               i
                                                               
                                                                  
                                                                     q
                                                                     i
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        0
                                                                        ,
                                                                        0
                                                                        ,
                                                                        …
                                                                        ,
                                                                        0
                                                                        ,
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         q
                                                         w
                                                      
                                                      
                                                         (
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            1
                                                            ,
                                                            0
                                                         
                                                         )
                                                      
                                                      
                                                         e
                                                         
                                                            t
                                                            
                                                               ∏
                                                               
                                                                  i
                                                                  =
                                                                  0
                                                               
                                                               2
                                                            
                                                            
                                                               z
                                                               i
                                                               
                                                                  
                                                                     q
                                                                     i
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        0
                                                                        ,
                                                                        0
                                                                        ,
                                                                        …
                                                                        ,
                                                                        1
                                                                        ,
                                                                        0
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         q
                                                         w
                                                      
                                                      
                                                         (
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            1
                                                            ,
                                                            1
                                                         
                                                         )
                                                      
                                                      
                                                         e
                                                         
                                                            t
                                                            
                                                               ∏
                                                               
                                                                  i
                                                                  =
                                                                  0
                                                               
                                                               2
                                                            
                                                            
                                                               z
                                                               i
                                                               
                                                                  
                                                                     q
                                                                     i
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        0
                                                                        ,
                                                                        0
                                                                        ,
                                                                        …
                                                                        ,
                                                                        1
                                                                        ,
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         q
                                                         w
                                                      
                                                      
                                                         (
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            2
                                                            ,
                                                            0
                                                         
                                                         )
                                                      
                                                      
                                                         e
                                                         
                                                            t
                                                            
                                                               ∏
                                                               
                                                                  i
                                                                  =
                                                                  0
                                                               
                                                               2
                                                            
                                                            
                                                               z
                                                               i
                                                               
                                                                  
                                                                     q
                                                                     i
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        0
                                                                        ,
                                                                        0
                                                                        ,
                                                                        …
                                                                        ,
                                                                        2
                                                                        ,
                                                                        0
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         q
                                                         K
                                                      
                                                      
                                                         (
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            2
                                                            ,
                                                            1
                                                         
                                                         )
                                                      
                                                      
                                                         e
                                                         
                                                            t
                                                            
                                                               ∏
                                                               
                                                                  i
                                                                  =
                                                                  0
                                                               
                                                               2
                                                            
                                                            
                                                               z
                                                               i
                                                               
                                                                  
                                                                     q
                                                                     i
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        0
                                                                        ,
                                                                        0
                                                                        ,
                                                                        …
                                                                        ,
                                                                        2
                                                                        ,
                                                                        1
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         q
                                                         w
                                                      
                                                      
                                                         (
                                                         
                                                            2
                                                            ,
                                                            2
                                                            ,
                                                            …
                                                            ,
                                                            2
                                                            ,
                                                            2
                                                         
                                                         )
                                                      
                                                      
                                                         e
                                                         
                                                            t
                                                            
                                                               ∏
                                                               
                                                                  i
                                                                  =
                                                                  0
                                                               
                                                               2
                                                            
                                                            
                                                               z
                                                               i
                                                               
                                                                  
                                                                     q
                                                                     i
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        2
                                                                        ,
                                                                        2
                                                                        ,
                                                                        …
                                                                        ,
                                                                        2
                                                                        ,
                                                                        2
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           being the function qw
                           ( · )the number of types of failure w
                           =0, w
                           =1 or w
                           =2, that are being repaired given in the corresponding sequence.

The mean time that the repairpersons are working on repairable failures of online units from the beginning up to time ν is given by

                              
                                 (5)
                                 
                                    
                                       
                                          ψ
                                          
                                             o
                                             n
                                             l
                                             i
                                             n
                                             e
                                          
                                          ν
                                       
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             0
                                          
                                          ν
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             K
                                          
                                          
                                             
                                                p
                                                
                                                   
                                                      E
                                                      k
                                                   
                                                
                                                m
                                             
                                             
                                                q
                                                k
                                                1
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

The mean time that the repairpersons are working on preventive maintenance from the beginning up to time ν is given by

                              
                                 (6)
                                 
                                    
                                       
                                          ψ
                                          
                                             p
                                             m
                                          
                                          ν
                                       
                                       =
                                       
                                          ∑
                                          
                                             m
                                             =
                                             0
                                          
                                          ν
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                p
                                                
                                                   
                                                      E
                                                      k
                                                   
                                                
                                                m
                                             
                                             
                                                q
                                                k
                                                2
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

The most general system that has been modelled, System I, is subject to several types of events; repairable and non-repairable failures and preventive maintenance. These events are happening by time and it is interesting to analyse the mean number of these ones up to a certain time.

Given a type of event, the mean number of occurrences up to time ν is worked out as

                           
                              
                                 
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       ν
                                    
                                    
                                       P
                                       
                                          {
                                          
                                             event
                                             
                                             occurs
                                             
                                             at
                                             
                                             time
                                             
                                             m
                                          
                                          }
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

These measures are calculated by considering the MMAP structure in the modelling.

Thus, the mean number of repairable failures of the online unit up to a certain time ν is

                           
                              (7)
                              
                                 
                                    
                                       Γ
                                       
                                          r
                                          e
                                       
                                       ν
                                    
                                    =
                                    ω
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       ν
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             D
                                          
                                          A
                                       
                                    
                                    e
                                    ,
                                 
                              
                           
                        where

                           
                              
                                 
                                    
                                       
                                          D
                                       
                                       A
                                    
                                    =
                                    
                                       ∑
                                       
                                          r
                                          =
                                          0
                                       
                                       
                                          K
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          A
                                          ,
                                          r
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Analogously, the mean number of non-repairable failures and major revisions of the online unit up to a certain time ν is equal to these expressions respectively,

                           
                              (8)
                              
                                 
                                    
                                       Γ
                                       
                                          n
                                          r
                                          e
                                       
                                       ν
                                    
                                    =
                                    ω
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       ν
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             D
                                          
                                          C
                                       
                                    
                                    e
                                    
                                    
                                    
                                    and
                                    
                                    
                                    
                                       Γ
                                       
                                          p
                                          m
                                       
                                       ν
                                    
                                    =
                                    ω
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       ν
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             D
                                          
                                          B
                                       
                                    
                                    e
                                    ,
                                 
                              
                           
                        where

                           
                              
                                 
                                    
                                       
                                          D
                                       
                                       B
                                    
                                    =
                                    
                                       ∑
                                       
                                          r
                                          =
                                          0
                                       
                                       
                                          K
                                          −
                                          2
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          B
                                          ,
                                          r
                                       
                                    
                                    
                                    
                                    and
                                    
                                    
                                    
                                       
                                          D
                                       
                                       C
                                    
                                    =
                                    
                                       ∑
                                       
                                          r
                                          =
                                          0
                                       
                                       
                                          K
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          C
                                          ,
                                          r
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Finally, the mean number of warm standby units that fail up to a certain time ν is equal to

                           
                              (9)
                              
                                 
                                    
                                       Γ
                                       
                                          s
                                          t
                                          b
                                          y
                                       
                                       ν
                                    
                                    =
                                    ω
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       ν
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             r
                                             =
                                             1
                                          
                                          
                                             K
                                             −
                                             1
                                          
                                       
                                       
                                          r
                                          
                                             [
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      O
                                                      r
                                                   
                                                
                                                +
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      A
                                                      r
                                                   
                                                
                                                +
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      B
                                                      r
                                                   
                                                
                                                +
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      C
                                                      r
                                                   
                                                
                                             
                                             ]
                                          
                                          e
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

When a complex system is going to be analysed, at least two points must be taken into account: performing times and rewards. In this section we analyse the behaviour of the costs and benefits associated to the system over time.

We assume two logical classes of rewards and costs: per unit of time and due to events.

While the system is operational, a gross profit is obtained per unit of time. The mean gross profit per unit of time is denoted by B. Also, each unit produces an operational cost per unit of time according to the type of unit. Each operational standby unit produces a mean cost per unit of time equal to cs
                            and the online unit produces a cost depending to the operational phase. The mean cost per unit of time produced by the online unit and for each operational phase is given by the column vector 
                              c
                           
                           0.

On the other hand, while a repairperson is working, a cost is produced per unit of time, depending on the type of repair (online unit, standby unit and preventive maintenance) and depending on the repair phase in each case. Then, the mean cost per unit of time when a unit is being repaired; type standby, online unit or preventive maintenance is given by the column vectors 
                              cr
                           
                           0, 
                              cr
                           
                           1 and 
                              cr
                           
                           2 respectively. Finally, while the system is not working, a mean loss equal to C is produced by unit of time.

Different column vectors containing the mean net reward per unit of time, depending on performing phase and on the types of failures and on the number of units in the repair facility is calculated. Next, the case system I is developed in this section; it can be performed for the other systems analogously.

The profit vector containing the mean net profit per unit of time associated to the macro-state Ek
                            is given by


                           
                              
                                 
                                    
                                       n
                                       
                                          
                                             r
                                          
                                          k
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               B
                                                               −
                                                               
                                                                  (
                                                                  
                                                                     K
                                                                     −
                                                                     1
                                                                  
                                                                  )
                                                               
                                                               
                                                                  c
                                                                  s
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            e
                                                            
                                                               n
                                                               t
                                                               
                                                                  ɛ
                                                               
                                                            
                                                         
                                                         −
                                                         
                                                            c
                                                            0
                                                         
                                                         ⊗
                                                         
                                                            e
                                                            
                                                               t
                                                               
                                                                  ɛ
                                                               
                                                            
                                                         
                                                      
                                                      
                                                      ;
                                                      
                                                         k
                                                         =
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        B
                                                                        −
                                                                        
                                                                           (
                                                                           
                                                                              K
                                                                              −
                                                                              k
                                                                              −
                                                                              1
                                                                           
                                                                           )
                                                                        
                                                                        
                                                                           c
                                                                           s
                                                                        
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     e
                                                                     
                                                                        n
                                                                        t
                                                                        
                                                                           ɛ
                                                                        
                                                                        ·
                                                                        
                                                                           3
                                                                           
                                                                              k
                                                                              −
                                                                              min
                                                                              
                                                                                 {
                                                                                 
                                                                                    k
                                                                                    ,
                                                                                    R
                                                                                 
                                                                                 }
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           ∑
                                                                           
                                                                              i
                                                                              =
                                                                              0
                                                                           
                                                                           
                                                                              min
                                                                              
                                                                                 {
                                                                                 
                                                                                    k
                                                                                    ,
                                                                                    R
                                                                                 
                                                                                 }
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              ∑
                                                                              
                                                                                 j
                                                                                 =
                                                                                 0
                                                                              
                                                                              
                                                                                 min
                                                                                 
                                                                                    {
                                                                                    
                                                                                       k
                                                                                       ,
                                                                                       R
                                                                                    
                                                                                    }
                                                                                 
                                                                                 −
                                                                                 i
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    min
                                                                                    
                                                                                       {
                                                                                       
                                                                                          k
                                                                                          ,
                                                                                          R
                                                                                       
                                                                                       }
                                                                                    
                                                                                    !
                                                                                 
                                                                                 
                                                                                    i
                                                                                    !
                                                                                    j
                                                                                    !
                                                                                    
                                                                                       (
                                                                                       
                                                                                          min
                                                                                          
                                                                                             {
                                                                                             
                                                                                                k
                                                                                                ,
                                                                                                R
                                                                                             
                                                                                             }
                                                                                          
                                                                                          −
                                                                                          i
                                                                                          −
                                                                                          j
                                                                                       
                                                                                       )
                                                                                    
                                                                                    !
                                                                                 
                                                                              
                                                                              
                                                                                 z
                                                                                 0
                                                                                 i
                                                                              
                                                                              
                                                                                 z
                                                                                 1
                                                                                 j
                                                                              
                                                                              
                                                                                 z
                                                                                 2
                                                                                 
                                                                                    min
                                                                                    
                                                                                       {
                                                                                       
                                                                                          k
                                                                                          ,
                                                                                          R
                                                                                       
                                                                                       }
                                                                                    
                                                                                    −
                                                                                    i
                                                                                    −
                                                                                    j
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  −
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    c
                                                                                    0
                                                                                 
                                                                                 ⊗
                                                                                 
                                                                                    e
                                                                                    
                                                                                       t
                                                                                       
                                                                                          ɛ
                                                                                       
                                                                                       ·
                                                                                       
                                                                                          3
                                                                                          
                                                                                             k
                                                                                             −
                                                                                             min
                                                                                             
                                                                                                {
                                                                                                
                                                                                                   k
                                                                                                   ,
                                                                                                   R
                                                                                                
                                                                                                }
                                                                                             
                                                                                          
                                                                                       
                                                                                       
                                                                                          ∏
                                                                                          
                                                                                             i
                                                                                             =
                                                                                             0
                                                                                          
                                                                                          2
                                                                                       
                                                                                       
                                                                                          
                                                                                             z
                                                                                             i
                                                                                          
                                                                                          
                                                                                             
                                                                                                
                                                                                                
                                                                                                   q
                                                                                                   i
                                                                                                
                                                                                             
                                                                                             
                                                                                                (
                                                                                                0
                                                                                                ,
                                                                                                .
                                                                                                
                                                                                                   
                                                                                                      
                                                                                                         
                                                                                                            min
                                                                                                            
                                                                                                               {
                                                                                                               
                                                                                                                  k
                                                                                                                  ,
                                                                                                                  R
                                                                                                               
                                                                                                               }
                                                                                                            
                                                                                                         
                                                                                                      
                                                                                                   
                                                                                                   
                                                                                                      
                                                                                                         …
                                                                                                      
                                                                                                   
                                                                                                
                                                                                                ,
                                                                                                0
                                                                                                ,
                                                                                                0
                                                                                                )
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    c
                                                                                    0
                                                                                 
                                                                                 ⊗
                                                                                 
                                                                                    e
                                                                                    
                                                                                       t
                                                                                       
                                                                                          ɛ
                                                                                       
                                                                                       ·
                                                                                       
                                                                                          3
                                                                                          
                                                                                             k
                                                                                             −
                                                                                             min
                                                                                             
                                                                                                {
                                                                                                
                                                                                                   k
                                                                                                   ,
                                                                                                   R
                                                                                                
                                                                                                }
                                                                                             
                                                                                          
                                                                                       
                                                                                       
                                                                                          ∏
                                                                                          
                                                                                             i
                                                                                             =
                                                                                             0
                                                                                          
                                                                                          2
                                                                                       
                                                                                       
                                                                                          
                                                                                             z
                                                                                             i
                                                                                          
                                                                                          
                                                                                             
                                                                                                
                                                                                                
                                                                                                   q
                                                                                                   i
                                                                                                
                                                                                             
                                                                                             
                                                                                                (
                                                                                                0
                                                                                                ,
                                                                                                .
                                                                                                
                                                                                                   
                                                                                                      
                                                                                                         
                                                                                                            min
                                                                                                            
                                                                                                               {
                                                                                                               
                                                                                                                  k
                                                                                                                  ,
                                                                                                                  R
                                                                                                               
                                                                                                               }
                                                                                                            
                                                                                                         
                                                                                                      
                                                                                                   
                                                                                                   
                                                                                                      
                                                                                                         …
                                                                                                      
                                                                                                   
                                                                                                
                                                                                                ,
                                                                                                0
                                                                                                ,
                                                                                                1
                                                                                                )
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    c
                                                                                    0
                                                                                 
                                                                                 ⊗
                                                                                 
                                                                                    e
                                                                                    
                                                                                       t
                                                                                       
                                                                                          ɛ
                                                                                       
                                                                                       ·
                                                                                       
                                                                                          3
                                                                                          
                                                                                             k
                                                                                             −
                                                                                             min
                                                                                             
                                                                                                {
                                                                                                
                                                                                                   k
                                                                                                   ,
                                                                                                   R
                                                                                                
                                                                                                }
                                                                                             
                                                                                          
                                                                                       
                                                                                       
                                                                                          ∏
                                                                                          
                                                                                             i
                                                                                             =
                                                                                             0
                                                                                          
                                                                                          2
                                                                                       
                                                                                       
                                                                                          
                                                                                             z
                                                                                             i
                                                                                          
                                                                                          
                                                                                             
                                                                                                
                                                                                                
                                                                                                   q
                                                                                                   i
                                                                                                
                                                                                             
                                                                                             
                                                                                                (
                                                                                                0
                                                                                                ,
                                                                                                .
                                                                                                
                                                                                                   
                                                                                                      
                                                                                                         
                                                                                                            min
                                                                                                            
                                                                                                               {
                                                                                                               
                                                                                                                  k
                                                                                                                  ,
                                                                                                                  R
                                                                                                               
                                                                                                               }
                                                                                                            
                                                                                                         
                                                                                                      
                                                                                                   
                                                                                                   
                                                                                                      
                                                                                                         …
                                                                                                      
                                                                                                   
                                                                                                
                                                                                                ,
                                                                                                0
                                                                                                ,
                                                                                                2
                                                                                                )
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              ⋮
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    c
                                                                                    0
                                                                                 
                                                                                 ⊗
                                                                                 
                                                                                    e
                                                                                    
                                                                                       t
                                                                                       
                                                                                          ɛ
                                                                                       
                                                                                       ·
                                                                                       
                                                                                          3
                                                                                          
                                                                                             k
                                                                                             −
                                                                                             min
                                                                                             
                                                                                                {
                                                                                                
                                                                                                   k
                                                                                                   ,
                                                                                                   R
                                                                                                
                                                                                                }
                                                                                             
                                                                                          
                                                                                       
                                                                                       
                                                                                          ∏
                                                                                          
                                                                                             i
                                                                                             =
                                                                                             0
                                                                                          
                                                                                          2
                                                                                       
                                                                                       
                                                                                          
                                                                                             z
                                                                                             i
                                                                                          
                                                                                          
                                                                                             
                                                                                                
                                                                                                
                                                                                                   q
                                                                                                   i
                                                                                                
                                                                                             
                                                                                             
                                                                                                (
                                                                                                2
                                                                                                ,
                                                                                                .
                                                                                                
                                                                                                   
                                                                                                      
                                                                                                         
                                                                                                            min
                                                                                                            
                                                                                                               {
                                                                                                               
                                                                                                                  k
                                                                                                                  ,
                                                                                                                  R
                                                                                                               
                                                                                                               }
                                                                                                            
                                                                                                         
                                                                                                      
                                                                                                   
                                                                                                   
                                                                                                      
                                                                                                         …
                                                                                                      
                                                                                                   
                                                                                                
                                                                                                ,
                                                                                                2
                                                                                                ,
                                                                                                0
                                                                                                )
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    c
                                                                                    0
                                                                                 
                                                                                 ⊗
                                                                                 
                                                                                    e
                                                                                    
                                                                                       t
                                                                                       
                                                                                          ɛ
                                                                                       
                                                                                       ·
                                                                                       
                                                                                          3
                                                                                          
                                                                                             k
                                                                                             −
                                                                                             min
                                                                                             
                                                                                                {
                                                                                                
                                                                                                   k
                                                                                                   ,
                                                                                                   R
                                                                                                
                                                                                                }
                                                                                             
                                                                                          
                                                                                       
                                                                                       
                                                                                          ∏
                                                                                          
                                                                                             i
                                                                                             =
                                                                                             0
                                                                                          
                                                                                          2
                                                                                       
                                                                                       
                                                                                          
                                                                                             z
                                                                                             i
                                                                                          
                                                                                          
                                                                                             
                                                                                                
                                                                                                
                                                                                                   q
                                                                                                   i
                                                                                                
                                                                                             
                                                                                             
                                                                                                (
                                                                                                2
                                                                                                ,
                                                                                                .
                                                                                                
                                                                                                   
                                                                                                      
                                                                                                         
                                                                                                            min
                                                                                                            
                                                                                                               {
                                                                                                               
                                                                                                                  k
                                                                                                                  ,
                                                                                                                  R
                                                                                                               
                                                                                                               }
                                                                                                            
                                                                                                         
                                                                                                      
                                                                                                   
                                                                                                   
                                                                                                      
                                                                                                         …
                                                                                                      
                                                                                                   
                                                                                                
                                                                                                ,
                                                                                                2
                                                                                                ,
                                                                                                0
                                                                                                )
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    c
                                                                                    0
                                                                                 
                                                                                 ⊗
                                                                                 
                                                                                    e
                                                                                    
                                                                                       t
                                                                                       
                                                                                          ɛ
                                                                                       
                                                                                       ·
                                                                                       
                                                                                          3
                                                                                          
                                                                                             k
                                                                                             −
                                                                                             min
                                                                                             
                                                                                                {
                                                                                                
                                                                                                   k
                                                                                                   ,
                                                                                                   R
                                                                                                
                                                                                                }
                                                                                             
                                                                                          
                                                                                       
                                                                                       
                                                                                          ∏
                                                                                          
                                                                                             i
                                                                                             =
                                                                                             0
                                                                                          
                                                                                          2
                                                                                       
                                                                                       
                                                                                          
                                                                                             z
                                                                                             i
                                                                                          
                                                                                          
                                                                                             
                                                                                                
                                                                                                
                                                                                                   q
                                                                                                   i
                                                                                                
                                                                                             
                                                                                             
                                                                                                (
                                                                                                2
                                                                                                ,
                                                                                                .
                                                                                                
                                                                                                   
                                                                                                      
                                                                                                         
                                                                                                            min
                                                                                                            
                                                                                                               {
                                                                                                               
                                                                                                                  k
                                                                                                                  ,
                                                                                                                  R
                                                                                                               
                                                                                                               }
                                                                                                            
                                                                                                         
                                                                                                      
                                                                                                   
                                                                                                   
                                                                                                      
                                                                                                         …
                                                                                                      
                                                                                                   
                                                                                                
                                                                                                ,
                                                                                                2
                                                                                                ,
                                                                                                0
                                                                                                )
                                                                                             
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ;
                                                      
                                                         k
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         K
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         −
                                                         C
                                                         ·
                                                         
                                                            e
                                                            
                                                               t
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           2
                                                                           ·
                                                                           
                                                                              3
                                                                              
                                                                                 K
                                                                                 −
                                                                                 R
                                                                                 −
                                                                                 1
                                                                              
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                     −
                                                                     
                                                                        I
                                                                        
                                                                           {
                                                                           
                                                                              R
                                                                              =
                                                                              K
                                                                           
                                                                           }
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     0
                                                                  
                                                                  
                                                                     R
                                                                     −
                                                                     
                                                                        I
                                                                        
                                                                           {
                                                                           
                                                                              R
                                                                              =
                                                                              K
                                                                           
                                                                           }
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     ∑
                                                                     
                                                                        j
                                                                        =
                                                                        0
                                                                     
                                                                     
                                                                        R
                                                                        −
                                                                        
                                                                           I
                                                                           
                                                                              {
                                                                              
                                                                                 R
                                                                                 =
                                                                                 K
                                                                              
                                                                              }
                                                                           
                                                                        
                                                                        −
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              (
                                                                              
                                                                                 R
                                                                                 −
                                                                                 
                                                                                    I
                                                                                    
                                                                                       {
                                                                                       
                                                                                          R
                                                                                          =
                                                                                          K
                                                                                       
                                                                                       }
                                                                                    
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                           !
                                                                        
                                                                        
                                                                           i
                                                                           !
                                                                           j
                                                                           !
                                                                           
                                                                              (
                                                                              
                                                                                 R
                                                                                 −
                                                                                 i
                                                                                 −
                                                                                 j
                                                                                 −
                                                                                 
                                                                                    I
                                                                                    
                                                                                       {
                                                                                       
                                                                                          R
                                                                                          =
                                                                                          K
                                                                                       
                                                                                       }
                                                                                    
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                           !
                                                                        
                                                                     
                                                                     
                                                                        z
                                                                        0
                                                                        i
                                                                     
                                                                     
                                                                        z
                                                                        1
                                                                        j
                                                                     
                                                                     
                                                                        z
                                                                        2
                                                                        
                                                                           R
                                                                           −
                                                                           i
                                                                           −
                                                                           j
                                                                           −
                                                                           
                                                                              I
                                                                              
                                                                                 {
                                                                                 
                                                                                    R
                                                                                    =
                                                                                    K
                                                                                 
                                                                                 }
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              (
                                                                              
                                                                                 
                                                                                    z
                                                                                    0
                                                                                 
                                                                                 +
                                                                                 
                                                                                    z
                                                                                    1
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                        
                                                                           I
                                                                           
                                                                              {
                                                                              
                                                                                 R
                                                                                 =
                                                                                 K
                                                                              
                                                                              }
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ;
                                                      
                                                         k
                                                         =
                                                         K
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           and the cost vector containing the mean cost per unit of time depending on the type of repair associated to the macro-state 
                              
                                 E
                                 
                                    
                                       i
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       i
                                       k
                                    
                                 
                              
                            is given by

                              
                                 
                                    
                                       
                                          nc
                                          
                                             
                                                i
                                                1
                                             
                                             ,
                                             …
                                             ,
                                             
                                                i
                                                k
                                             
                                          
                                          k
                                       
                                       =
                                       
                                          e
                                          
                                             t
                                             
                                                
                                                   
                                                      (
                                                      
                                                         n
                                                         
                                                            ɛ
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   I
                                                   
                                                      {
                                                      
                                                         k
                                                         ≠
                                                         K
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                       ⊗
                                       c
                                       
                                          r
                                          
                                             i
                                             1
                                          
                                       
                                       ⊙
                                       ⋯
                                       ⊙
                                       c
                                       
                                          r
                                          
                                             i
                                             
                                                min
                                                
                                                   {
                                                   
                                                      k
                                                      ,
                                                      R
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           where given two column vectors v and w, with order a and b respectively, then v⊙wis defined as 
                              
                                 v
                                 ⊙
                                 w
                                 =
                                 v
                                 ⊗
                                 
                                    e
                                    b
                                 
                                 +
                                 
                                    e
                                    a
                                 
                                 ⊗
                                 w
                              
                           .

The mean cost per unit of time depending on the type of repair associated to the macro-state Ek
                            is given by

                              
                                 
                                    
                                       
                                          
                                             nc
                                          
                                          k
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         nc
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            0
                                                            ,
                                                            0
                                                         
                                                         k
                                                      
                                                      ,
                                                      
                                                         nc
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            0
                                                            ,
                                                            1
                                                         
                                                         k
                                                      
                                                      ,
                                                      
                                                         nc
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            0
                                                            ,
                                                            2
                                                         
                                                         k
                                                      
                                                      ,
                                                      …
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                            
                                                               nc
                                                               
                                                                  2
                                                                  ,
                                                                  2
                                                                  ,
                                                                  …
                                                                  ,
                                                                  2
                                                                  ,
                                                                  0
                                                               
                                                               k
                                                            
                                                            ,
                                                            
                                                               nc
                                                               
                                                                  2
                                                                  ,
                                                                  2
                                                                  ,
                                                                  …
                                                                  ,
                                                                  2
                                                                  ,
                                                                  1
                                                               
                                                               k
                                                            
                                                            ,
                                                            
                                                               nc
                                                               
                                                                  2
                                                                  ,
                                                                  2
                                                                  ,
                                                                  …
                                                                  ,
                                                                  2
                                                                  ,
                                                                  2
                                                               
                                                               k
                                                            
                                                            )
                                                         
                                                         ′
                                                      
                                                      ;
                                                      
                                                         0
                                                         <
                                                         k
                                                         <
                                                         K
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         nc
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            0
                                                            ,
                                                            0
                                                         
                                                         k
                                                      
                                                      ,
                                                      
                                                         nc
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            0
                                                            ,
                                                            1
                                                         
                                                         k
                                                      
                                                      ,
                                                      
                                                         nc
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            1
                                                            ,
                                                            0
                                                         
                                                         k
                                                      
                                                      ,
                                                      
                                                         nc
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            1
                                                            ,
                                                            1
                                                         
                                                         k
                                                      
                                                      ,
                                                      
                                                         nc
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            2
                                                            ,
                                                            0
                                                         
                                                         k
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                            
                                                               nc
                                                               
                                                                  0
                                                                  ,
                                                                  0
                                                                  ,
                                                                  …
                                                                  ,
                                                                  2
                                                                  ,
                                                                  1
                                                               
                                                               k
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               nc
                                                               
                                                                  2
                                                                  ,
                                                                  2
                                                                  ,
                                                                  …
                                                                  ,
                                                                  2
                                                                  ,
                                                                  0
                                                               
                                                               k
                                                            
                                                            ,
                                                            
                                                               nc
                                                               
                                                                  2
                                                                  ,
                                                                  2
                                                                  ,
                                                                  …
                                                                  ,
                                                                  2
                                                                  ,
                                                                  1
                                                               
                                                               k
                                                            
                                                            )
                                                         
                                                         ′
                                                      
                                                      ;
                                                      
                                                         k
                                                         =
                                                         K
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

For the case k units in the repair facility the global net column cost vector is built as 
                              
                                 
                                    
                                       c
                                    
                                    0
                                 
                                 =
                                 n
                                 
                                    
                                       r
                                    
                                    0
                                 
                                 
                                 
                                 and
                                 
                                 
                                 
                                    
                                       c
                                    
                                    k
                                 
                                 =
                                 n
                                 
                                    
                                       r
                                    
                                    k
                                 
                                 −
                                 n
                                 
                                    
                                       c
                                    
                                    k
                                 
                                 
                                 
                                 for
                                 
                                 
                                 k
                                 =
                                 
                                 1
                                 ,
                                 …
                                 ,
                                 K
                                 .
                              
                           
                        

Finally, the global net column profit vector by considering the state space given in Section 1 is built as 
                              
                                 c
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                c
                                             
                                             0
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                c
                                             
                                             K
                                          
                                       
                                       )
                                    
                                    ′
                                 
                              
                           .

The complex system, described in this work, is subject to several events; repairable failures of the online, repairable failures of the standby units, preventive maintenance and non repairable failure of the online unit. Each time that an event occurs, a mean fixed cost is produced due to several reasons such as materials, new units, etc. We introduce in the model these costs as

                              
                                 
                                    fc
                                    s: mean fixed cost due to one repairable failure of one standby unit


                                    fc
                                    0: mean fixed cost due to one repairable failure of the online unit


                                    fc
                                    pm: mean fixed cost due to one preventive maintenance


                                    fc
                                    nr: mean cost of a new unit

Different reward measures can be defined from the vectors described above. The costs and profit per unit of time are given by the following expressions.


                        Mean net profit up to time ν
                        
                           
                              (10)
                              
                                 
                                    
                                       Φ
                                       w
                                       ν
                                    
                                    =
                                    
                                       ∑
                                       
                                          m
                                          =
                                          0
                                       
                                       ν
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             K
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             p
                                             
                                                
                                                   E
                                                   k
                                                
                                             
                                             m
                                          
                                          n
                                          
                                             
                                                r
                                             
                                             k
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        
                     


                        Mean cost due to corrective repair of standby units up to time ν
                        
                           
                              (11)
                              
                                 
                                    
                                       Φ
                                       s
                                       ν
                                    
                                    =
                                    
                                       ∑
                                       
                                          m
                                          =
                                          0
                                       
                                       ν
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             p
                                             
                                                
                                                   E
                                                   k
                                                
                                             
                                             m
                                          
                                          ·
                                          
                                             
                                                mc
                                             
                                             
                                                k
                                                ,
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where

                           
                              
                                 
                                    
                                       
                                          mc
                                       
                                       
                                          k
                                          ,
                                          w
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      mc
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                      
                                                         k
                                                         ,
                                                         w
                                                      
                                                   
                                                   ,
                                                   
                                                      mc
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         0
                                                         ,
                                                         1
                                                      
                                                      
                                                         k
                                                         ,
                                                         w
                                                      
                                                   
                                                   ,
                                                   
                                                      mc
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         0
                                                         ,
                                                         2
                                                      
                                                      
                                                         k
                                                         ,
                                                         w
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                         
                                                            mc
                                                            
                                                               2
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                               ,
                                                               2
                                                               ,
                                                               0
                                                            
                                                            
                                                               k
                                                               ,
                                                               w
                                                            
                                                         
                                                         ,
                                                         
                                                            mc
                                                            
                                                               2
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                               ,
                                                               2
                                                               ,
                                                               1
                                                            
                                                            
                                                               k
                                                               ,
                                                               w
                                                            
                                                         
                                                         ,
                                                         
                                                            mc
                                                            
                                                               2
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                               ,
                                                               2
                                                               ,
                                                               2
                                                            
                                                            
                                                               k
                                                               ,
                                                               w
                                                            
                                                         
                                                         )
                                                      
                                                      ′
                                                   
                                                   ;
                                                   
                                                      0
                                                      <
                                                      k
                                                      <
                                                      K
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      mc
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                      
                                                         k
                                                         ,
                                                         w
                                                      
                                                   
                                                   ,
                                                   
                                                      mc
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         0
                                                         ,
                                                         1
                                                      
                                                      
                                                         k
                                                         ,
                                                         w
                                                      
                                                   
                                                   ,
                                                   
                                                      mc
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         1
                                                         ,
                                                         0
                                                      
                                                      
                                                         k
                                                         ,
                                                         w
                                                      
                                                   
                                                   ,
                                                   
                                                      mc
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         1
                                                         ,
                                                         1
                                                      
                                                      
                                                         k
                                                         ,
                                                         w
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                         
                                                            mc
                                                            
                                                               0
                                                               ,
                                                               0
                                                               ,
                                                               …
                                                               ,
                                                               2
                                                               ,
                                                               0
                                                            
                                                            
                                                               k
                                                               ,
                                                               w
                                                            
                                                         
                                                         ,
                                                         
                                                            mc
                                                            
                                                               0
                                                               ,
                                                               0
                                                               ,
                                                               …
                                                               ,
                                                               2
                                                               ,
                                                               1
                                                            
                                                            
                                                               k
                                                               ,
                                                               w
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            mc
                                                            
                                                               2
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                               ,
                                                               2
                                                               ,
                                                               0
                                                            
                                                            
                                                               k
                                                               ,
                                                               w
                                                            
                                                         
                                                         ,
                                                         
                                                            mc
                                                            
                                                               2
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                               ,
                                                               2
                                                               ,
                                                               1
                                                            
                                                            
                                                               k
                                                               ,
                                                               w
                                                            
                                                         
                                                         )
                                                      
                                                      ′
                                                   
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                   
                                                      k
                                                      =
                                                      K
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

being 
                           
                              
                                 mc
                                 
                                    
                                       i
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       i
                                       k
                                    
                                 
                                 
                                    k
                                    ,
                                    w
                                 
                              
                              =
                              
                                 e
                                 
                                    n
                                    t
                                    
                                       ɛ
                                    
                                 
                              
                              ⊗
                              
                                 cr
                                 
                                    
                                       i
                                       1
                                    
                                 
                                 w
                              
                              ⊙
                              ⋯
                              ⊙
                              
                                 cr
                                 
                                    
                                       i
                                       
                                          min
                                          {
                                          
                                             k
                                             ,
                                             R
                                          
                                          }
                                       
                                    
                                 
                                 w
                              
                           
                        where 
                           
                              
                                 cr
                                 
                                    t
                                    y
                                    p
                                    e
                                 
                                 w
                              
                              =
                              
                                 cr
                                 
                                    t
                                    y
                                    p
                                    e
                                 
                              
                           
                        if type=w and 
                           
                              
                                 cr
                                 
                                    t
                                    y
                                    p
                                    e
                                 
                                 w
                              
                              =
                              
                                 0
                                 
                                    z
                                    
                                       t
                                       y
                                       p
                                       e
                                    
                                 
                              
                              
                           
                        otherwise for w=0, 1, 2.


                        Mean cost due to corrective repair of online units up to time ν
                        
                           
                              (12)
                              
                                 
                                    
                                       Φ
                                       0
                                       ν
                                    
                                    =
                                    
                                       ∑
                                       
                                          m
                                          =
                                          0
                                       
                                       ν
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             p
                                             
                                                
                                                   E
                                                   k
                                                
                                             
                                             m
                                          
                                          ·
                                          
                                             
                                                mc
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Mean cost due to preventive maintenance up to time ν
                        
                           
                              (13)
                              
                                 
                                    
                                       Φ
                                       
                                          p
                                          m
                                       
                                       ν
                                    
                                    =
                                    
                                       ∑
                                       
                                          m
                                          =
                                          0
                                       
                                       ν
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             p
                                             
                                                
                                                   E
                                                   k
                                                
                                             
                                             m
                                          
                                          ·
                                          
                                             
                                                mc
                                             
                                             
                                                k
                                                ,
                                                2
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The total net profit up to time ν is worked out by adding costs produced by the events. It is worked out from (7)–(9) and it is equal to

                           
                              
                                 
                                    
                                       
                                          
                                             Φ
                                             ν
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                Φ
                                                w
                                                ν
                                             
                                             −
                                             
                                                Φ
                                                s
                                                ν
                                             
                                             −
                                             
                                                Φ
                                                0
                                                ν
                                             
                                             −
                                             
                                                Φ
                                                
                                                   p
                                                   m
                                                
                                                ν
                                             
                                             −
                                             
                                                (
                                                
                                                   1
                                                   +
                                                   
                                                      Γ
                                                      
                                                         n
                                                         r
                                                      
                                                      ν
                                                   
                                                
                                                )
                                             
                                             f
                                             
                                                c
                                                
                                                   n
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             
                                                Γ
                                                
                                                   r
                                                   e
                                                
                                                ν
                                             
                                             ·
                                             f
                                             
                                                c
                                                0
                                             
                                             −
                                             
                                                Γ
                                                
                                                   s
                                                   t
                                                   b
                                                   y
                                                
                                                ν
                                             
                                             ·
                                             f
                                             
                                                c
                                                s
                                             
                                             −
                                             
                                                Γ
                                                
                                                   p
                                                   m
                                                
                                                ν
                                             
                                             ·
                                             f
                                             
                                                c
                                                
                                                   p
                                                   m
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The mean net profit measure 
                           
                              Φ
                              w
                              ν
                           
                         takes into account only the profit generated by the online unit while the system is working on, whereas the mean total net profit, 
                           
                              Φ
                              ν
                           
                        , includes profit and costs due to repair and preventive maintenance.

We assume a system with 4 units, the online one and the rest in warm standby, and 2 repairpersons. The objective of this study is to analyse the effectiveness of preventive maintenance in the behaviour of the reliability system. It is going to be studied by comparing some reliability measures by considering the system I (with preventive maintenance) and III (without preventive maintenance) described in Section 4. The lifetime distribution for the online unit, the time distributions between two external shocks and two inspections, the preventive maintenance time distribution and the repair time distributions according to the types of failures are given in Tables 2 and 3
                     . Any standby unit can undergo a repairable failure at any moment with probability p
                     =0.001.

The internal behaviour of the online unit is composed of three phases (good, fair, poor). These phases are disposed consecutively. The mean time in each phase is equal to 200, 20 and 20 respectively; therefore the mean time up to internal failure is 240 units of time. The inspections over this unit occur randomly with a mean time between two consecutive inspections equal to 10 units of time. In this case, the online unit is inspected and if phase one or two is observed then the unit continues working. Therefore, if phase three (poor) is observed then the unit goes to repair facility for preventive maintenance. The online unit is subject to external shocks. The mean time between two consecutive shocks is equal to 143.16 units of time.

On the other hand, the mean corrective and preventive maintenance time depends on the type of corrective repair. We assume that the mean corrective repair time for the online unit is higher than preventive maintenance. The mean time for corrective repair of the online unit is equal to 50 units of time whereas that the mean preventive maintenance time is 10 unit of time. Preventive maintenance is important to improve the reliability of the system. Finally, the mean corrective repair time for any standby unit is equal to 20 units of time. This failure type is more important than preventive maintenance but not such as the failure of the online unit.

When the online unit fails, this one is repairable with probability 0.8 and non repairable with probability 0.2. The column vectors that determine the type of failures for the external shocks are given by

                        
                           
                              
                                 
                                    L
                                    r
                                    0
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                0.005
                                             
                                          
                                       
                                       
                                          
                                             
                                                0.0035
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                 
                                 and
                                 
                                 
                                 
                                    L
                                    
                                       n
                                       r
                                    
                                    0
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                0.002
                                             
                                          
                                       
                                       
                                          
                                             
                                                0.001
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

Thus, when one external shock occurs then it is repairable with probability 0.7145 and non-repairable with probability 0.2855.

This system has been compared with and without preventive maintenance. We assume that the initial vector of the system is built by considering new units, new operational times and, given that the events that produces external shocks occurs consecutively, independently of the rest of the system, the stationary distribution of the time between external shocks is considered. The reliability functions have been built and plotted from Section 5.2. Fig. 3
                      shows the reliability functions in both cases.

We can see that the reliability function for the system with preventive maintenance is higher than the case without preventive maintenance. The mean time up to no operational unit by first time is equal to 28,166.16 and 22,619.54 for the system with and without preventive maintenance respectively.

Some measures associated to both systems have been compared to analyse the effectiveness of preventive maintenance. Firstly, the mean sojourn time in each macro-state has been calculated in several times from (3). It is shown in Table 4
                     
                      where we can observe that if preventive maintenance is considered, the mean time with all units being operational is higher, whereas the mean time with units in the repair facility is lower.

It is also very interesting to analyse the mean time that the repairman is working by considering the different types of failures and preventive maintenance up to a certain time. These measures have been worked out from (4)–(6) and they are given in Table 5 for both systems.

In Table 5 we can observe that the repairpersons work more time in units that had an online repairable failure when preventive maintenance was not introduced. Thus, if the case up to 20,000 units of time is considered, the mean time working in online failed units increases a 27.07 percent when preventive maintenance is not taken into account. In this same case, the mean time that the repairpersons are occupied increases a 14.24 percent when preventive maintenance is not applied. This fact is very important from an economic standpoint.

Finally, preventive maintenance avoids the failure of the online unit. Therefore, it is interesting to compare the mean number of events occurred up to a certain time between both systems, with and without preventive maintenance. These events are repairable and non-repairable failures of the online unit, repairable failures of the warms standby units and major revisions for preventive maintenance. These measures are worked out by considering the results given in (7)–(9). They are compared in Table 6.
                     
                  

From Table 6 we can observe that the mean number of events up to any time on the online unit is lower when preventive maintenance is considered. This fact is essential when high costs are presented when a failure happens.

The behaviour of the system has been analysed from the performance point of view, but is preventive maintenance profitable from an economic standpoint? This question is answered by introducing costs and rewards associated to the evolution of the system according Section 6. The following assumptions are considered.

While the system is working a profit equal to B
                        =5 and different costs per unit of time are produced. If the online unit is at degradation level 1, 2, or 3, then a cost of 0.5, 1 and 2, respectively, per unit of time is produced while it is working. Each warm standby unit produces a mean cost per unit of time equal to 0.25. The units can fail, and in this case they go to the repair facility. The repairman can be working in different situations; with a unit that failed from online, standby or preventive maintenance. In each case the cost per unit of time is equal to 1.5, 1 and 0.25, respectively. Of course, while the system is not working (all units in the repair facility), this one is having a loss per unit of time equal to C
                        =4.

When a failure occurs, a mean fixed cost is produced due to several causes such as new pieces. These ones have a mean cost equal to 1 for any type of failure. Finally, a new unit has a cost equal to 500.

The cost vector and the measures given in (10)–(13) have been worked out. The results are compared for system I (with preventive maintenance) and system III (without preventive maintenance). These measures are given in Table 7.
                        
                     

A comparison from Table 7 can be performed. The net profit due to performance of the system and performing costs are given by 
                           
                              Φ
                              w
                              ν
                           
                        , and we can observe that preventive maintenance is profitable if any time is considered. Regarding costs, these ones produced by the repairable online failures are higher when preventive maintenance is not considered. Also, we can achieve that the cost due to preventive maintenance is negligible in this case. In this way, the last column show that the total net profit up to a certain time is greater when preventive maintenance is included. Preventive maintenance avoids repairable and non repairable failures of the online unit, and this fact avoids great costs.

@&#CONCLUSIONS@&#

When we wish to model a complex reliability system in order to analyse its evolution over time, it is essential to express this modelling and its associated measures in a well-structured form. In this paper, a complex model with an indeterminate number of units and repairpersons is developed. Derivative systems from this one have also been modelled, examining Markov models by means of a marked, batch-arrival Markovian process. Redundancy is incorporated into the system, where the online unit is subject to internal failures, which may or may not be repairable, and to external shocks. Preventive maintenance is carried out to improve system reliability. The different types of corrective repair and the preventive maintenance performed all follow different time distributions while the unit is in the repair facility. For this reason, the order of the failures must be taken into account and saved in memory, in modelling the process.

The Markovian arrival processes examined are versatile and provide an excellent tool for stochastic modelling. Any stochastic counting process can be approximated arbitrarily by a sequence of Markovian arrival processes. We highlight the versatility of MAPs, and analyse several complex models with the corresponding measures, in a well structured form using an algorithmic matrix structure.

In summary, in this study we model general reliability systems and associated measures to analyse the behaviour and effectiveness of preventive maintenance, in an algorithmic and computational form. Costs are introduced into the system and a numerical example given to compare the performance and cost behaviour of two similar multi-state reliability systems, with and without preventive maintenance, by means of the features presented in the proposed methodology.

@&#ACKNOWLEDGMENTS@&#

The author is very grateful to the referees, whose comments have improved the paper. This paper is partially supported by the Junta de Andalucía, Spain, under the grant no. FQM-307, by the Ministerio de Economía y Competitividad and by European Regional Development Fund (ERDF), Spain, under grant no. MTM2013-47929-P.

Matrix blocks of the transition probability matrix given in (2).

                        
                           
                              
                                 M
                                 a
                                 t
                                 r
                                 i
                                 x
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       B
                                       r
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       B
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          D
                                          
                                             l
                                             k
                                          
                                          
                                             B
                                             r
                                          
                                       
                                       )
                                    
                                    
                                       l
                                       ,
                                       k
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       K
                                    
                                 
                              
                           
                        
                     
                  

where

                        
                           
                              
                                 
                                    
                                       
                                          D
                                          
                                             l
                                             k
                                          
                                          
                                             B
                                             r
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          0
                                          
                                          
                                          if
                                          
                                          
                                          k
                                          
                                          >
                                          
                                          l
                                          +
                                          r
                                          +
                                          1
                                          
                                          or
                                          
                                          
                                          k
                                          <
                                          l
                                          +
                                          1
                                          +
                                          r
                                          −
                                          min
                                          
                                             {
                                             
                                                l
                                                ,
                                                R
                                             
                                             }
                                          
                                          
                                          or
                                          
                                          l
                                       
                                    
                                 
                                 
                                    
                                    
                                       ≥
                                    
                                    
                                       
                                          K
                                          −
                                          r
                                          
                                          
                                          or
                                          
                                          
                                          k
                                          =
                                          K
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             D
                                             
                                                0
                                                ,
                                                r
                                                +
                                                1
                                             
                                             
                                                B
                                                r
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   i
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   i
                                                   
                                                      r
                                                      +
                                                      1
                                                   
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             H
                                             
                                                2
                                                ,
                                                0
                                                ,
                                                r
                                             
                                          
                                          ⊗
                                          
                                             β
                                             
                                                i
                                                1
                                             
                                          
                                          ⊗
                                          
                                             β
                                             
                                                i
                                                2
                                             
                                          
                                          ⊗
                                          ⋯
                                          ⊗
                                          
                                             β
                                             
                                                i
                                                
                                                   min
                                                   
                                                      {
                                                      
                                                         r
                                                         +
                                                         1
                                                         ,
                                                         R
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          r
                                          =
                                          0
                                          ,
                                          …
                                          ,
                                          K
                                          −
                                          2
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             i
                                             1
                                          
                                          =
                                          2
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             i
                                             s
                                          
                                          =
                                          0
                                          ;
                                          s
                                          =
                                          2
                                          ,
                                          …
                                          ,
                                          r
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          For
                                          
                                          
                                          r
                                          =
                                          0
                                          ,
                                          …
                                          ,
                                          
                                          
                                          K
                                          −
                                          2
                                          ;
                                          l
                                          =
                                          
                                          1
                                          ,
                                          …
                                          ,
                                          
                                          K
                                          −
                                          r
                                          −
                                          1
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          a
                                          =
                                          max
                                          
                                             {
                                             0
                                             ,
                                             
                                             l
                                             +
                                             r
                                             +
                                             2
                                             −
                                             K
                                             }
                                          
                                          ,
                                          …
                                          ,
                                          min
                                          
                                             {
                                             
                                                l
                                                ,
                                                R
                                             
                                             }
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             i
                                             
                                                l
                                                −
                                                a
                                                +
                                                1
                                             
                                          
                                          =
                                          2
                                          ,
                                          
                                             i
                                             
                                                l
                                                −
                                                a
                                                +
                                                s
                                             
                                          
                                          =
                                          0
                                          ;
                                          s
                                          =
                                          2
                                          ,
                                          …
                                          ,
                                          r
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          and
                                          
                                          
                                             i
                                             
                                                R
                                                −
                                                a
                                                +
                                                s
                                             
                                          
                                          =
                                          
                                             j
                                             
                                                R
                                                +
                                                s
                                             
                                          
                                          ;
                                          
                                          s
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          l
                                          −
                                          R
                                          if
                                          l
                                          >
                                          R
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             D
                                             
                                                l
                                                ,
                                                l
                                                +
                                                r
                                                +
                                                1
                                                −
                                                a
                                             
                                             
                                                B
                                                r
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   i
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   i
                                                   
                                                      l
                                                      +
                                                      r
                                                      +
                                                      1
                                                      −
                                                      a
                                                   
                                                
                                                ;
                                                
                                                   j
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          =
                                          
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     H
                                                                     
                                                                        2
                                                                        ,
                                                                        l
                                                                        ,
                                                                        r
                                                                     
                                                                  
                                                                  ⊗
                                                                  B
                                                                  
                                                                     (
                                                                     
                                                                        l
                                                                        ,
                                                                        a
                                                                        ;
                                                                        
                                                                           i
                                                                           1
                                                                        
                                                                        ,
                                                                        …
                                                                        ,
                                                                        
                                                                           i
                                                                           
                                                                              l
                                                                              −
                                                                              a
                                                                           
                                                                        
                                                                        ;
                                                                        
                                                                           j
                                                                           1
                                                                        
                                                                        ,
                                                                        …
                                                                        ,
                                                                        
                                                                           j
                                                                           l
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ⊗
                                                                  
                                                                     β
                                                                     
                                                                        i
                                                                        
                                                                           l
                                                                           −
                                                                           a
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  ⊗
                                                                  
                                                                     β
                                                                     
                                                                        i
                                                                        
                                                                           l
                                                                           −
                                                                           a
                                                                           +
                                                                           2
                                                                        
                                                                     
                                                                  
                                                                  ⊗
                                                                  ⋯
                                                                  ⊗
                                                                  
                                                                     β
                                                                     
                                                                        i
                                                                        
                                                                           min
                                                                           
                                                                              {
                                                                              
                                                                                 l
                                                                                 +
                                                                                 r
                                                                                 +
                                                                                 1
                                                                                 −
                                                                                 a
                                                                                 ,
                                                                                 R
                                                                              
                                                                              }
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  ;
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                         min
                                                         
                                                            {
                                                            
                                                               l
                                                               +
                                                               r
                                                               +
                                                               1
                                                               −
                                                               a
                                                               ,
                                                               R
                                                            
                                                            }
                                                         
                                                         ≥
                                                         l
                                                         −
                                                         a
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            H
                                                            
                                                               2
                                                               ,
                                                               l
                                                               ,
                                                               r
                                                            
                                                         
                                                         ⊗
                                                         B
                                                         
                                                            (
                                                            
                                                               l
                                                               ,
                                                               a
                                                               ;
                                                               
                                                                  i
                                                                  1
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  i
                                                                  
                                                                     l
                                                                     −
                                                                     a
                                                                  
                                                               
                                                               ;
                                                               
                                                                  j
                                                                  1
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  j
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                         ;
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                         min
                                                         
                                                            {
                                                            
                                                               l
                                                               +
                                                               r
                                                               +
                                                               1
                                                               −
                                                               a
                                                               ,
                                                               R
                                                            
                                                            }
                                                         
                                                         <
                                                         l
                                                         −
                                                         a
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 M
                                 a
                                 t
                                 r
                                 i
                                 x
                                 
                                 
                                 
                                    
                                       D
                                    
                                    
                                       C
                                       r
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       C
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          D
                                          
                                             l
                                             k
                                          
                                          
                                             C
                                             r
                                          
                                       
                                       )
                                    
                                    
                                       l
                                       ,
                                       k
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       K
                                    
                                 
                              
                           
                        
                     where

                        
                           
                              
                                 
                                    D
                                    
                                       l
                                       k
                                    
                                    
                                       C
                                       r
                                    
                                 
                                 =
                                 0
                                 
                                 
                                 if
                                 
                                 
                                 k
                                 
                                 >
                                 l
                                 
                                 +
                                 
                                 r
                                 
                                 
                                 or
                                 
                                 
                                 k
                                 <
                                 l
                                 +
                                 r
                                 −
                                 min
                                 
                                    {
                                    
                                       l
                                       ,
                                       R
                                    
                                    }
                                 
                                 
                                 
                                 or
                                 
                                 
                                 l
                                 ≥
                                 K
                                 −
                                 r
                                 .
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    D
                                    
                                       00
                                    
                                    
                                       C
                                       0
                                    
                                 
                                 =
                                 
                                    H
                                    
                                       3
                                       ,
                                       0
                                       ,
                                       0
                                    
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             D
                                             
                                                0
                                                r
                                             
                                             
                                                C
                                                r
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   i
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   i
                                                   r
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             H
                                             
                                                3
                                                ,
                                                0
                                                ,
                                                r
                                             
                                          
                                          ⊗
                                          
                                             β
                                             
                                                i
                                                1
                                             
                                          
                                          ⊗
                                          
                                             β
                                             
                                                i
                                                2
                                             
                                          
                                          ⊗
                                          ⋯
                                          ⊗
                                          
                                             β
                                             
                                                i
                                                
                                                   min
                                                   
                                                      {
                                                      
                                                         r
                                                         ,
                                                         R
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             i
                                             s
                                          
                                          =
                                          
                                          0
                                          
                                          ;
                                          s
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          r
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          r
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          K
                                          −
                                          1
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             D
                                             
                                                l
                                                ,
                                                0
                                             
                                             
                                                C
                                                0
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   j
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             H
                                             
                                                3
                                                ,
                                                l
                                                ,
                                                0
                                             
                                          
                                          ⊗
                                          B
                                          
                                             (
                                             
                                                l
                                                ,
                                                l
                                                ;
                                                
                                                   j
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ;
                                          
                                          l
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          R
                                          ≠
                                          K
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          For
                                          
                                          
                                          r
                                          
                                          =
                                          
                                          0
                                          ,
                                          …
                                          ,
                                          
                                          
                                          K
                                          −
                                          2
                                          ;
                                          
                                          
                                          l
                                          
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          K
                                          −
                                          r
                                          −
                                          1
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          a
                                          =
                                          0
                                          ,
                                          …
                                          ,
                                          
                                          min
                                          
                                             {
                                             l
                                             ,
                                             
                                             R
                                             ,
                                             
                                             l
                                             +
                                             r
                                             −
                                             1
                                             }
                                          
                                          ,
                                          
                                          
                                             i
                                             
                                                l
                                                −
                                                a
                                                +
                                                s
                                             
                                          
                                          =
                                          0
                                          ;
                                          s
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          r
                                          ,
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          and
                                          
                                          
                                          
                                          
                                             i
                                             
                                                R
                                                −
                                                a
                                                +
                                                s
                                             
                                          
                                          =
                                          
                                             j
                                             
                                                R
                                                +
                                                s
                                             
                                          
                                          ;
                                          
                                          s
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          l
                                          −
                                          R
                                          if
                                          l
                                          >
                                          R
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             D
                                             
                                                l
                                                ,
                                                l
                                                +
                                                r
                                                −
                                                a
                                             
                                             
                                                C
                                                r
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   i
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   i
                                                   
                                                      l
                                                      +
                                                      r
                                                      −
                                                      a
                                                   
                                                
                                                ;
                                                
                                                   j
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          =
                                          
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        H
                                                                        
                                                                           3
                                                                           ,
                                                                           l
                                                                           ,
                                                                           r
                                                                        
                                                                     
                                                                     ⊗
                                                                     B
                                                                     
                                                                        (
                                                                        
                                                                           l
                                                                           ,
                                                                           a
                                                                           ;
                                                                           
                                                                              i
                                                                              1
                                                                           
                                                                           ,
                                                                           …
                                                                           ,
                                                                           
                                                                              i
                                                                              
                                                                                 l
                                                                                 −
                                                                                 a
                                                                              
                                                                           
                                                                           ;
                                                                           
                                                                              j
                                                                              1
                                                                           
                                                                           ,
                                                                           …
                                                                           ,
                                                                           
                                                                              j
                                                                              l
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                     ⊗
                                                                     
                                                                        β
                                                                        
                                                                           i
                                                                           
                                                                              l
                                                                              −
                                                                              a
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     ⊗
                                                                     
                                                                        β
                                                                        
                                                                           i
                                                                           
                                                                              l
                                                                              −
                                                                              a
                                                                              +
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                     ⊗
                                                                     ⋯
                                                                     ⊗
                                                                     
                                                                        β
                                                                        
                                                                           i
                                                                           
                                                                              min
                                                                              
                                                                                 {
                                                                                 
                                                                                    l
                                                                                    −
                                                                                    a
                                                                                    +
                                                                                    r
                                                                                    ,
                                                                                    R
                                                                                 
                                                                                 }
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         ;
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                         min
                                                         
                                                            {
                                                            
                                                               l
                                                               −
                                                               a
                                                               +
                                                               r
                                                               ,
                                                               R
                                                            
                                                            }
                                                         
                                                         ≥
                                                         l
                                                         −
                                                         a
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            H
                                                            
                                                               3
                                                               ,
                                                               l
                                                               ,
                                                               r
                                                            
                                                         
                                                         ⊗
                                                         B
                                                         
                                                            (
                                                            
                                                               l
                                                               ,
                                                               a
                                                               ;
                                                               
                                                                  i
                                                                  1
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  i
                                                                  
                                                                     l
                                                                     −
                                                                     a
                                                                  
                                                               
                                                               ;
                                                               
                                                                  j
                                                                  1
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  j
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                         ;
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                         min
                                                         
                                                            {
                                                            
                                                               l
                                                               −
                                                               a
                                                               +
                                                               r
                                                               ,
                                                               R
                                                            
                                                            }
                                                         
                                                         <
                                                         l
                                                         −
                                                         a
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

