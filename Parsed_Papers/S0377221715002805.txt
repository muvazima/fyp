@&#MAIN-TITLE@&#Surgical scheduling with simultaneous employment of specialised human resources

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We address surgery scheduling and resources assignment in an operating theatre.


                        
                        
                           
                           We detail the treatment of specialised human resources in a practical case.


                        
                        
                           
                           An individual of a speciality can perform more than one surgery simultaneously.


                        
                        
                           
                           We give a formulation of the problem and develop integer programming heuristics.


                        
                        
                           
                           We report numerical results on a number of scenarios inspired by real data.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Surgical scheduling

Mathematical modelling

Relax-and-fix heuristics

@&#ABSTRACT@&#


               
               
                  Surgical scheduling is a challenging problem faced by hospital managers. It is subject to a wide range of constraints depending upon the particular situation within any given hospital. We deal with the simultaneous employment of specialised human resources, which must be assigned to surgeries according to their skills as well as the time windows of the staff. A particular feature is that they can be assigned to two surgeries simultaneously if the rooms are compatible. The objective is to maximise the use of the operating rooms. We propose an integer model and integer programming based heuristics to address the problem. Computational experiments were conducted on a number of scenarios inspired by real data to cover different practical problem solving situations. Numerical results show that relaxations provide tight upper bounds, and relax-and-fix heuristics are successful in finding optimal or near optimal solutions.
               
            

@&#INTRODUCTION@&#

Operating room management has been recognised as a main source of income for hospitals. It is important to improve performance by using surgical resources as efficiently and effective as possible. It has been reported in the literature that the operating theatre is one of the most critical and costly functional areas in a hospital (Guinet & Chaabane, 2003). It represents a bottleneck in many hospitals and it consumes a significant amount of a hospital’s annual budget because it typically utilises the most expensive resources. See, for instance, the recent surveys by Cardoen, Demeulemeester, and Beliën (2010), Guerriero and Guido (2011), May, Spangler, Strum, and Vargas (2011) and Rais and Viana (2011). As in other service sectors, the decision process comprises different decision levels – from capacity and facility planning to detailed scheduling.

In this paper, we concentrate on the detailed surgical scheduling of elective patients on a daily basis. Elective patients are those for whom the surgery is not completely unexpected and can be planned in advance. Broadly speaking, surgical scheduling consists of the selection of surgical interventions to be performed in each available operating room along with dates, starting times and the allocation of required resources. Surgical scheduling problems are very hard to solve, and different optimisation modelling approaches have been proposed in the literature to face different situations. Meskens, Duvivier, and Hanset (2013) observed from visits to several hospitals that problems are specific to each institution. Indeed, as also noted by other authors, for instance, Cardoen et al. (2010); Riise and Burke (2011), each hospital has its own established practices reflecting specific constraints related to both human and material facets. These specific constraints may vary from medical staff availabilities (e.g., regular working hours or surgeon preferences) and patient priorities (e.g., children or diabetics) to operating room versatilities and the limited capacity of human and material resources (e.g., number of nurses, auxiliary staff, medical instruments, recovery beds or places in intensive care unities).

We deal with surgical scheduling in a hospital in Brazil. The hospital has 14 non-identical operating rooms dedicated to elective interventions – some are multifunctional, some have particular medical devices installed that cannot be moved, and some are restricted in size. Each surgeon has a set of patients, so that each operation has to be carried out by a specific surgeon. However, decisions assigning surgeries to operating rooms is part of the problem, and scheduling starting times are subject to surgeries and surgeon’s time windows, among other constraints. Time windows may capture patient priorities in terms of time of the day that interventions must occur, e.g., children should be operated upon early in the morning (Riise & Burke, 2011) or there should be later starts for out-of-town patients (Vijayakumar, Parikh, Scott, Barnes, & Gallimore, 2013). There are also medical staff preferences, which can be viewed as an attempt to improve working conditions (Roland, di Martinelly, Riane, & Pochet, 2010). The problem is also constrained by limited shared resources. We may have surgery requirements on renewable and/or nonrenewable resources, a characteristic already observed in the case studied by Roland et al. (2010). Renewable resources (human or material) are those allocated to a surgery strictly for its duration, like nurses or auxiliary staff and medical equipment. On the other hand, nonrenewable resources are those allocated to a surgery for the entire day, in our case places in the intensive care utility.

A particular feature of our case study is the simultaneous employment of specialised human resources. Anaesthetists, for instance, are identified due to specialities, training skills and availabilities. An anaesthetist has his/her own time windows. Each surgery is associated with a subset of anaesthetists able to perform that intervention. An anaesthetist can perform more than one intervention simultaneously depending upon the room in which the surgeries are taking place. Thus, the simultaneous employment of specialised human resources is constrained by room compatibilities. This leads to another decision to be made jointly with assigning and scheduling surgeries, as anaesthetists must be assigned and scheduled according to surgery requirements and subject to room compatibilities and to their own time windows. The objective is to maximise the use of the operating rooms. In fact, recent surveys list a number of objectives studied in the literature including minimisation of costs or makespan, and maximisation of throughput or utilisation (Cardoen et al., 2010; Guerriero & Guido, 2011; May et al., 2011). In our case, the manager of the hospital where the study was conducted suggested the maximisation of the utilisation of the operating rooms.

We propose an integer programming formulation to model the particular surgical scheduling problem in hand. Preliminary computational experiments have shown that the linear relaxation of the proposed model could provide good upper bounds to the optimal solution values. Based on these early experiments, we decided to develop integer programming-based heuristics to obtain high quality feasible solutions with a posteriori performance guarantees. The heuristics in the first step draw from relaxation candidate assignments of surgeries to rooms and periods, and then in the second step they address a reduced model to obtain feasibility. We test the proposed approaches on a variety of scenarios inspired from real data. Computational results show that it is possible to find optimal or near optimal solutions for most of the instances.

The paper is structured as follows. In the next section, we present a literature review which is focused on deterministic models for surgical scheduling. In Section 3, we formulate the integer programming model. We describe, in Section 4, the integer programming-based heuristics. In Section 5, we report on computational experiments on real-based instances, and in the last section we draw concluding remarks.

@&#LITERATURE REVIEW@&#

Many modelling studies aimed at using surgical rooms efficiently have been motivated by practical considerations and goals. Ozkarahan (2000) proposed a goal programming model to assign surgeries to operating rooms under a policy of reserving blocks of operating room time for surgical specialties or authorised surgeons. Marcon, Kharraja, and Simonnet (2003) adapted the multiple knapsack model to assign surgeries to operating rooms optimising measures related to the risk of no realisation. Some authors have investigated applications based on bin-packing to select surgeries that make efficient use of available operating room time, see Dexter, Macario, and Traub (1999), Dexter and Traub (2002), Dexter, Traub, and Macario (2003), Hans, Wullink, van Houdenhoven, and Kazemier (2008), van Houdenhoven, van Oostrum, Hans, Wullink, and Kazemier (2007). Guinet and Chaabane (2003) proposed a model to assign surgeries to operating rooms over a horizon of one or two weeks subject to time and capacity constraints. Santibáñez, Begen, and Atkins (2007) also dealt with time and constraints to manage a set of hospitals as a single system.


                     Jebali, Hadj Alouane, and Ladet (2006) addressed the daily scheduling of a surgical centre with an assignment model of surgeries to operating rooms, taking into account capacity constraints such as opening duration and overtime of operating rooms, the working time of surgeons, and the number of beds in the intensive care unit. The objective is to minimise the costs associated to keeping patients waiting, and to minimise undertime and overtime. Then, sequencing is modelled as a two-stage hybrid flow shop where the first stage is represented by surgical rooms and the second stage by recovering beds. Analogies to scheduling problems more often found in industrial applications were also exploited by Pham and Klinkert (2008). The authors introduced an extension of the job shop with blocking to model the patient flow comprising preoperative, perioperative and postoperative stages.

Hierarchical approaches in three stages have been proposed (Ogulata & Erol, 2003; Testi, Tanfani, & Torre, 2007). Ogulata and Erol (2003) developed models to select, in the first stage, patients from a candidate list. In the second stage, they are assigned to surgical groups, and, in the final stage, operating rooms are determined independently for each group. Testi et al. (2007) developed models to distribute operating room time among surgical groups, and then to build a cyclic timetable that determines the surgical unit associated with each block of operating room time. The last stage is performed by simulation. Testi and Tanfani (2009) proposed a model to assign both patient and surgical sub-speciality to operating rooms and days within a planning horizon.


                     Augusto, Xie, and Perdomo (2008) developed a Lagrangian relaxation to a patient flow problem considering the transfer from the ward to the operating room, the surgery, and the transfer to the recovery bed. The model defines starting times for the different tasks in order to minimise completion times subject to capacity constraints. The same authors (Augusto, Xie, & Perdomo, 2010) addressed the impact of allowing patient recovery in the operating room when no recovery bed is available. Marques, Captivo, and Pato (2012) proposed a model to schedule elective surgeries on a weekly time horizon with the objective of maximising the operating rooms occupancy. The authors considered different surgery priority levels, surgery time windows, and operating time limits.

In recent years, some authors have developed branch-and-price approaches (Cardoen, Demeulemeester, & Beliën, 2009b; Fei, Chu, Meskens, & Artiba, 2008). Fei et al. (2008) focused on surgical cases assignment to operating rooms. The model takes into consideration the room’s opening time and surgical deadlines to plan one week minimising undertime and overtime costs. The master problem partitions surgeries into days, whereas the subproblem deals with opening duration constraints to find an improving column. This approach was extended by Fei, Meskens, and Chu (2010) to consider daily scheduling performed by a hybrid genetic algorithm. Cardoen et al. (2009b) developed a branch-and-price approach over a multi-objective model proposed by the same authors (Cardoen, Demeulemeester, & Beliën, 2009a). The model decides which surgeries to start in each slot of each period, restricted to operating rooms and starting ranges that have been previously defined. Other constraints include the availabilities of medical instruments and recovering areas and additional cleaning due to particular infection concerns. A column represents all surgeries sequenced for a specific surgeon, and the pricing problem is addressed by dynamic programming.
                  


                     Roland et al. (2010) proposed a model dealing with different aspects of human and material resource management. Resource requirements are distinguished between renewable (e.g., medical staff) and nonrenewable (e.g., pharmaceutical products). Surgeons express preferences in terms of availabilities, and some medical staff (e.g., anaesthetists) do not participate during the whole surgery to allow a broader coverage of all operating rooms. Riise and Burke (2011) addressed both the intervention assignment (i.e., the assignment of interventions to rooms and days) and the intervention scheduling (i.e., the sequencing of interventions within a day and room). The objective function comprises three objectives: patient waiting time, surgeon overtime, and waiting time for children. The model can incorporate a master surgery scheduling plan where operating room hours are divided into blocks and allocated to specialities, in addition to an existing plan in which surgeries are classified into un-served, planned but not fixed, or fixed. Ghazalbash, Sepehri, Shadpour, and Atighehchian (2012) dealt with the distribution of surgeries in order to ensure that residents and fellows have equal opportunities to acquire experience in a training hospital. Jeang and Chiang (2012) have taken into account surgeon availabilities and unfavourable surgery times to minimise the deviation between the total operation time and the total available time in operating rooms. Vijayakumar et al. (2013) aimed to maximise a weighted sum of the number of surgeries to be performed on a day-of-week and time-of-day basis. The authors modelled their surgical scheduling case as a multi-bin, unequal-sized, multi-dimensional dual bin-packing problem. Constraints are related to resource availabilities, patient priorities, and surgical times and the specialities of surgeons. Meskens et al. (2013) proposed a constraint programming approach to deal with resource availabilities, staff preferences, and affinities among staff members. The model has a multi-objective function by minimising makespan and overtime, and maximising affinities among members of the surgical team.

In Table 1, we summarise the main blocks of constraints typically found in the literature on detailed surgery scheduling. This provides a broad overview but it is important to note that different papers often treat specific constraints differently within each block. The block of constraints that is common to all modelling approaches is the group of capacity constraints. These constraints deal with the operating rooms opening hours, medical staff working hours, or resources availability. Time windows are often found in terms of the periods of the day when a surgeon is available to start a surgery. Most papers model the daily scheduling with time-indexed formulations, and some authors use an extra index for the day to cover a planning horizon. Under and over time have been considered when minimising operational costs. Roland et al. (2010) also considered a fixed cost to open an operating room during a day. Some authors have modelled the flow of patients from wards to operating rooms and then to recovery beds, characterising the problem as a multi-stage scheduling problem. Cardoen et al. (2009a) introduced a constraint to model additional cleaning in order to avoid scheduling a surgery of a non-infected patient after the surgery of an infected patient. In terms of modelling, the main contributions of our research are the treatment of specialised human resources and the simultaneous employment of them. We have a set of types of specialised human resources, and, on one hand, a subset of such specialities that are needed to perform a surgery. On the other hand, we have for each of these specialities a set of individuals. For each speciality, we also specify a subset, along with their time windows, which are suitable to perform the given surgery. We propose a model that assigns, conjointly with the surgery scheduling, suitable individuals of each speciality, satisfying the given time windows constraints. Moreover, an individual of a given speciality can perform more than one surgery simultaneously, as far as the distance between rooms where surgeries are taking place permits. Thus, our model takes into account the simultaneous employment of specialised human resources constrained by room compatibilities. Our modelling treatment of specialised human resources and the feature of simultaneous employment, to the best of our knowledge, has not been studied so far in the literature.

As discussed in the previous section, one can find approaches in the literature modelling particular cases which are found in different countries. This includes, for examples, Belgium (Cardoen et al., 2009a, 2009b; Fei et al., 2010; Roland et al., 2010), Canada (Santibáñez et al., 2007), France (Augusto et al., 2008; 2010; Guinet & Chaabane, 2003; Marcon et al., 2003), Iran (Ghazalbash et al., 2012), Italy (Testi & Tanfani, 2009; Testi et al., 2007), Netherlands (Hans et al., 2008; van Houdenhoven et al., 2007), Norway (Riise & Burke, 2011), Portugal (Marques et al., 2012), Turkey (Ogulata & Erol, 2003; Ozkarahan, 2000), and USA (Dexter et al., 1999; Dexter & Traub, 2002; Dexter et al., 2003; Vijayakumar et al., 2013). In this paper, we model a daily surgical scheduling problem found at a hospital in Brazil. We next describe the details of the modelling approach. Table 2
                      gives an overview of the required data to run the proposed model.

The day is divided in periods, and T is the set of periods. The set of surgeons is denoted by C, and Tc
                      ⊆ T is the subset of periods a surgeon c can start a surgery, i.e., set Tc
                      accounts for the surgeon c time windows. The set of surgeries is denoted by S, and Sc
                      ⊆ S is the subset of surgeries to be performed by surgeon c. Given a surgeon c ∈ C and a surgery s ∈ Sc, Ts
                      ⊆ Tc
                      is the subset of periods a surgery can start, i.e., the surgery s time windows. The set of operating rooms is denoted by R, and Rs
                      ⊆ R is the subset of operating rooms where a surgery s can take place. A room is in use with a surgery s during ds
                      periods, which includes the time for cleaning. However, surgeons and other medical staff as well are free to start another surgery when the intervention itself is finished. The parameter 
                        
                           
                              d
                              ¯
                           
                           s
                        
                      accounts for the duration of intervention only.

The resources are classified into sets K
                     1 and K
                     2 of renewable and nonrenewable resources, respectively. Given k ∈ K
                     1 (resp. k ∈ K
                     2), 
                        
                           g
                           
                              s
                              k
                           
                           1
                        
                      (resp. 
                        
                           g
                           
                              s
                              k
                           
                           2
                        
                     ) is the amount of renewable (resp. nonrenewable) resource k required to perform surgery s. A renewable resource k ∈ K
                     1 may have a certain number 
                        
                           q
                           k
                           1
                        
                      of mobile units, and may also be already installed on a subset Rk
                      ⊆ R of operating rooms. So, a surgery requiring renewable resource k assigned to an operating room r ∈ Rk
                      does not consume any of the 
                        
                           q
                           k
                           1
                        
                      mobile units. On the other hand, when a surgery which does not require renewable resource k is assigned to an operating room r ∈ Rk
                     , the resource installed in that room stays idle as it cannot be moved elsewhere. A nonrenewable resource k ∈ K
                     2 has 
                        
                           q
                           k
                           2
                        
                      units. An amount of 
                        
                           g
                           
                              s
                              k
                           
                           2
                        
                      must be reserved during the whole day for a surgery s requiring resource k if s is to be performed, e.g., a resource in an intensive care unit which is occupied for several hours.

The specialised human resources are treated differently because, in our case, the employment of anaesthetists can be undertaken simultaneously, depending upon the rooms in which surgeries are taking place. Although motivated by a particular case, our description enables the handling of different types of specialised resources. The set of types of specialised resources is denoted by E, and Es
                      ⊆ E is the subset required to perform surgery s ∈ S. Suppose, as an illustrative example, E = {α, β}, i.e., the hospital counts specialised resources of types α and β, 
                        
                           
                              E
                              
                                 s
                                 ˙
                              
                           
                           =
                           
                              {
                              α
                              }
                           
                        
                      and 
                        
                           
                              E
                              
                                 s
                                 ^
                              
                           
                           =
                           
                              {
                              α
                              ,
                              β
                              }
                           
                        
                      for surgeries 
                        
                           s
                           ˙
                        
                      and 
                        
                           
                              s
                              ^
                           
                           ,
                        
                      respectively. Given e ∈ E, Ae
                      is the set of individuals treated as specialised resources of type e. For example, Aα
                      = {α
                     1, α
                     2, α
                     3} and Aβ
                      = {β
                     1, β
                     2}. It may happen, given s ∈ S and e ∈ Es
                     , that not all the individuals that belong to Ae
                      are suitable for performing surgery s. Thus, 
                        
                           
                              A
                              e
                              s
                           
                           ⊆
                           
                              A
                              e
                           
                        
                      is the subset of individuals of specialised resource type e suitable to perform surgery s. Suppose, in our example, 
                        
                           
                              A
                              α
                              
                                 s
                                 ˙
                              
                           
                           =
                           
                              {
                              
                                 α
                                 1
                              
                              ,
                              
                                 α
                                 2
                              
                              }
                           
                           ,
                        
                     
                     
                        
                           
                              A
                              α
                              
                                 s
                                 ^
                              
                           
                           =
                           
                              {
                              
                                 α
                                 2
                              
                              ,
                              
                                 α
                                 3
                              
                              }
                           
                           ,
                        
                     
                     
                        
                           
                              A
                              β
                              
                                 s
                                 ^
                              
                           
                           =
                           
                              {
                              
                                 β
                                 1
                              
                              }
                           
                        
                     . An individual a ∈ Ae
                      can perform qa
                      surgeries simultaneously, as far as the distance between rooms r and 
                        
                           r
                           ¯
                        
                      where surgeries are taking place permits. A parameter 
                        
                           b
                           
                              r
                              
                                 r
                                 ¯
                              
                           
                        
                      is set to 1 if a specialised resource can be employed simultaneously in rooms r and 
                        
                           
                              r
                              ¯
                           
                           ,
                        
                      and to 0 otherwise. Moreover, each individual a ∈ Ae
                      of specialised resource type e ∈ E may have his/her own time windows. So, 
                        
                           
                              T
                              e
                              a
                           
                           ⊆
                           T
                        
                      is the set of periods in which individual a can start a surgery.

We define two binary variables. The first, 
                        
                           
                              y
                              
                                 s
                                 t
                              
                              r
                           
                           ,
                        
                      has value 1 if surgery s ∈ S is assigned to room r ∈ Rs
                      and starts in period t ∈ Ts
                     , and 0 otherwise. The second, 
                        
                           
                              w
                              
                                 s
                                 t
                              
                              a
                           
                           ,
                        
                      has value 1 if surgery s ∈ S is assigned to individual 
                        
                           a
                           ∈
                           
                              A
                              e
                              s
                           
                        
                      of specialised resource type e ∈ Es
                      and starts in period 
                        
                           t
                           ∈
                           
                              T
                              e
                              a
                           
                           ∩
                           
                              T
                              s
                           
                           ,
                        
                      and 0 otherwise. The model can be written as follows:

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          max
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                S
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                r
                                                ∈
                                                
                                                   R
                                                   s
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   s
                                                
                                             
                                          
                                          
                                             d
                                             s
                                          
                                          
                                             y
                                             
                                                s
                                                t
                                             
                                             r
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                r
                                                ∈
                                                
                                                   R
                                                   s
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   s
                                                
                                             
                                          
                                          
                                             y
                                             
                                                s
                                                t
                                             
                                             r
                                          
                                          ≤
                                          1
                                          
                                          ∀
                                          s
                                          ∈
                                          S
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                
                                                   S
                                                   c
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                r
                                                ∈
                                                
                                                   R
                                                   s
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                t
                                                −
                                                
                                                   
                                                      d
                                                      ¯
                                                   
                                                   s
                                                
                                                
                                                   +
                                                   1
                                                   |
                                                   l
                                                   ∈
                                                
                                                
                                                   T
                                                   s
                                                
                                             
                                             t
                                          
                                          
                                             y
                                             
                                                s
                                                l
                                             
                                             r
                                          
                                          ≤
                                          1
                                          
                                          ∀
                                          c
                                          ∈
                                          C
                                          ,
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             c
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   s
                                                   ∈
                                                   S
                                                   |
                                                   r
                                                   ∈
                                                
                                                
                                                   R
                                                   s
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                t
                                                −
                                                
                                                   d
                                                   s
                                                
                                                
                                                   +
                                                   1
                                                   |
                                                   l
                                                   ∈
                                                
                                                
                                                   T
                                                   s
                                                
                                             
                                             t
                                          
                                          
                                             y
                                             
                                                s
                                                l
                                             
                                             r
                                          
                                          ≤
                                          1
                                          
                                          ∀
                                          r
                                          ∈
                                          R
                                          ,
                                          ∀
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                S
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                r
                                                ∈
                                                
                                                   R
                                                   s
                                                
                                                ∖
                                                
                                                   R
                                                   k
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                t
                                                −
                                                
                                                   
                                                      d
                                                      ¯
                                                   
                                                   s
                                                
                                                
                                                   +
                                                   1
                                                   |
                                                   l
                                                   ∈
                                                
                                                
                                                   T
                                                   s
                                                
                                             
                                             t
                                          
                                          
                                             g
                                             
                                                s
                                                k
                                             
                                             1
                                          
                                          
                                             y
                                             
                                                s
                                                l
                                             
                                             r
                                          
                                          ≤
                                          
                                             q
                                             k
                                             1
                                          
                                          
                                          ∀
                                          k
                                          ∈
                                          
                                             K
                                             1
                                          
                                          ,
                                          ∀
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                S
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                r
                                                ∈
                                                
                                                   R
                                                   s
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   s
                                                
                                             
                                          
                                          
                                             g
                                             
                                                s
                                                k
                                             
                                             2
                                          
                                          
                                             y
                                             
                                                s
                                                t
                                             
                                             r
                                          
                                          ≤
                                          
                                             q
                                             k
                                             2
                                          
                                          
                                          ∀
                                          k
                                          ∈
                                          
                                             K
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                r
                                                ∈
                                                
                                                   R
                                                   s
                                                
                                             
                                          
                                          
                                             y
                                             
                                                s
                                                t
                                             
                                             r
                                          
                                          −
                                          
                                             ∑
                                             
                                                a
                                                ∈
                                                
                                                   A
                                                   e
                                                   s
                                                
                                                
                                                   |
                                                   t
                                                   ∈
                                                
                                                
                                                   T
                                                   e
                                                   a
                                                
                                             
                                          
                                          
                                             w
                                             
                                                s
                                                t
                                             
                                             a
                                          
                                          ≤
                                          0
                                          
                                          ∀
                                          s
                                          ∈
                                          S
                                          ,
                                          ∀
                                          e
                                          ∈
                                          
                                             E
                                             s
                                          
                                          ,
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             s
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   s
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                a
                                                ∈
                                                
                                                   A
                                                   e
                                                   s
                                                
                                                
                                                   |
                                                   t
                                                   ∈
                                                
                                                
                                                   T
                                                   e
                                                   a
                                                
                                             
                                          
                                          
                                             w
                                             
                                                s
                                                t
                                             
                                             a
                                          
                                          ≤
                                          1
                                          
                                          ∀
                                          s
                                          ∈
                                          S
                                          ,
                                          ∀
                                          e
                                          ∈
                                          
                                             E
                                             s
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   s
                                                   ∈
                                                   S
                                                   |
                                                   e
                                                   ∈
                                                
                                                
                                                   E
                                                   s
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                t
                                                −
                                                
                                                   
                                                      d
                                                      ¯
                                                   
                                                   s
                                                
                                                
                                                   +
                                                   1
                                                   |
                                                   l
                                                   ∈
                                                
                                                
                                                   T
                                                   s
                                                
                                                ∩
                                                
                                                   T
                                                   a
                                                   e
                                                
                                             
                                             t
                                          
                                          
                                             w
                                             
                                                s
                                                l
                                             
                                             a
                                          
                                          ≤
                                          
                                             q
                                             a
                                          
                                          
                                          ∀
                                          e
                                          ∈
                                          E
                                          ,
                                          ∀
                                          a
                                          ∈
                                          
                                             A
                                             e
                                          
                                          ,
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             e
                                             a
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             y
                                             
                                                s
                                                t
                                             
                                             r
                                          
                                          +
                                          
                                             w
                                             
                                                s
                                                t
                                             
                                             a
                                          
                                          +
                                          
                                             ∑
                                             
                                                l
                                                =
                                                t
                                                −
                                                
                                                   
                                                      d
                                                      ¯
                                                   
                                                   
                                                      s
                                                      ¯
                                                   
                                                
                                                
                                                   +
                                                   1
                                                   |
                                                   l
                                                   ∈
                                                
                                                
                                                   T
                                                   e
                                                   a
                                                
                                                ∩
                                                
                                                   T
                                                   
                                                      s
                                                      ¯
                                                   
                                                
                                             
                                             t
                                          
                                          
                                             (
                                             
                                                y
                                                
                                                   
                                                      s
                                                      ¯
                                                   
                                                   l
                                                
                                                
                                                   r
                                                   ¯
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   
                                                      s
                                                      ¯
                                                   
                                                   l
                                                
                                                a
                                             
                                             )
                                          
                                          ≤
                                          3
                                          
                                          ∀
                                          s
                                          ,
                                          
                                             s
                                             ¯
                                          
                                          ∈
                                          S
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          e
                                          ∈
                                          
                                             E
                                             s
                                          
                                          ∩
                                          
                                             E
                                             
                                                s
                                                ¯
                                             
                                          
                                          ,
                                          ∀
                                          a
                                          ∈
                                          
                                             A
                                             e
                                             s
                                          
                                          ∩
                                          
                                             A
                                             e
                                             
                                                s
                                                ¯
                                             
                                          
                                          ,
                                          ∀
                                          r
                                          ∈
                                          
                                             R
                                             s
                                          
                                          ,
                                          ∀
                                          
                                             r
                                             ¯
                                          
                                          ∈
                                          
                                             R
                                             
                                                s
                                                ¯
                                             
                                          
                                          ,
                                          
                                             b
                                             
                                                r
                                                
                                                   r
                                                   ¯
                                                
                                             
                                          
                                          =
                                          0
                                          ,
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             e
                                             a
                                          
                                          ∩
                                          
                                             T
                                             s
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             y
                                             
                                                s
                                                t
                                             
                                             r
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          s
                                          ∈
                                          S
                                          ,
                                          ∀
                                          r
                                          ∈
                                          
                                             R
                                             s
                                          
                                          ,
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             s
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             w
                                             
                                                s
                                                t
                                             
                                             a
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          ∀
                                          e
                                          ∈
                                          E
                                          ,
                                          ∀
                                          a
                                          ∈
                                          
                                             A
                                             e
                                          
                                          ,
                                          ∀
                                          s
                                          ∈
                                          S
                                          ,
                                          ∀
                                          r
                                          ∈
                                          
                                             R
                                             s
                                          
                                          ,
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             e
                                             a
                                          
                                          ∩
                                          
                                             T
                                             s
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The objective function (1) maximises the occupation of the operating rooms. Constraint (2) ensures that a surgery is not performed more than once. An important issue when maximising the utilisation in a daily basis could be whether an operation would be carried from day to day without ever being scheduled. Thus, when using the model on a daily basis, it might be useful to introduce a slack variable in constraint (2) to impose a surgery that has not been scheduled by setting the slack variable associated to that surgery to zero. Overlapping surgeries are avoided by constraints (3) and (4). The former prevents a surgeon from starting a surgery without having finished an earlier one. The latter prevents a room from being in use with two surgeries at the same time. Note that a surgeon is free to start another surgery as soon as intervention duration 
                        
                           
                              d
                              ¯
                           
                           s
                        
                      ends, while a room is occupied with a surgery for ds
                      time periods. Capacity constraints (5) and (6) are associated with renewable and nonrenewable resources, respectively. Constraints (7) and (8) associate specialised human resources with surgeries. Whenever a surgery s is scheduled to start in a period t ∈ Ts
                     , an individual 
                        
                           a
                           ∈
                           
                              A
                              e
                              s
                           
                        
                      of each type of specialised resource e ∈ Es
                      must be assigned as long as t belongs to his/her time windows 
                        
                           T
                           e
                           a
                        
                     . Constraint (9) bounds the number of surgeries an individual can perform simultaneously. As already mentioned, the distance between two rooms r and 
                        
                           r
                           ¯
                        
                      may refrain an individual from performing two surgeries simultaneously. In this case, i.e., 
                        
                           
                              b
                              
                                 r
                                 
                                    r
                                    ¯
                                 
                              
                           
                           =
                           0
                           ,
                        
                      constraint (10) ensures that although an individual may be suitable to perform two surgeries s and 
                        
                           s
                           ¯
                        
                      occurring simultaneously in rooms r and 
                        
                           
                              r
                              ¯
                           
                           ,
                        
                      respectively, he/she can only be assigned to one of them. Finally, constraints (11) and (12) define the domain of the variables.

In many practical settings, integer programming formulations have been used to generate very good, but not necessarily optimal, solutions, e.g., see Ball (2011) and Wolsey (1998). Preliminary computational experiments have shown that the linear relaxation of (11) and (12) can produce very good upper bounds to the optimal solution values. For this reason, we use relaxations to propose two integer programming-based heuristics, which can be implemented with a mixed integer programming solver and we can assess the quality of solutions found. The heuristics consist of two main steps: first draw from relaxation candidate assignments of surgeries to rooms and periods, then solve a reduced model to obtain feasibility.

We propose a relax-and-fix heuristic in which only the integrality of w is dropped. In the first step we solve formulation (1)–(11) with the LP relaxation of (12) to produce an upper bound and to construct a set of candidate surgery assignments. Let 
                           
                              y
                              ¯
                           
                         be an optimal (integer) y-vector to the relaxation. We denote by ϒ the set of candidate surgery assignments drew from the relaxation, i.e., ϒ contains each surgery s for which there exists a room ηs
                         and a period τs
                         such that 
                           
                              
                                 
                                    y
                                    ¯
                                 
                                 
                                    s
                                    
                                       τ
                                       s
                                    
                                 
                                 
                                    η
                                    s
                                 
                              
                              =
                              1
                           
                        . Although the surgery assignments selected in ϒ are feasible in terms of overlapping and renewable/nonrenewable resources, i.e., feasible to constraints (2)–(6), there may be no assignment of specialised resources which are feasible for constraints (7)–(10).

In the second step, we solve a reduced mixed integer programming model to obtain feasibility. The idea is for every s ∈ ϒ either to successfully assign a specialised resource or to not perform s. Thus, the binary variable 
                           
                              w
                              s
                              a
                           
                         takes value 1 if surgery s ∈ ϒ is assigned to individual 
                           
                              a
                              ∈
                              
                                 A
                                 e
                                 s
                              
                           
                         of specialised resource type e ∈ Es
                        , and 0 otherwise. Note now that variable w has a reduced dimension with respect to the original model, since s starts in τs
                         if it is to be performed. The continuous variable zs
                         naturally takes value 0 or 1, 1 if surgery s ∈ ϒ is not to be performed, and 0 otherwise.

We define a potential conflict set Λs, s ∈ ϒ, which contains every surgery s′ ∈ ϒ − {s} that if started in 
                           
                              τ
                              
                                 s
                                 ′
                              
                           
                         will not be finished in τs
                        , i.e. 
                           
                              
                                 Λ
                                 s
                              
                              =
                              
                                 {
                                 
                                    s
                                    ′
                                 
                                 ∈
                                 Υ
                                 −
                                 
                                    {
                                    s
                                    }
                                 
                                 |
                                 
                                    τ
                                    s
                                 
                                 −
                                 
                                    d
                                    
                                       s
                                       ′
                                    
                                 
                                 +
                                 1
                                 ≤
                                 
                                    τ
                                    
                                       s
                                       ′
                                    
                                 
                                 ≤
                                 
                                    τ
                                    s
                                 
                                 }
                              
                           
                        . The set 
                           
                              
                                 Λ
                                 ¯
                              
                              s
                           
                         is defined analogously, except that only duration 
                           
                              
                                 d
                                 ¯
                              
                              s
                           
                         of the intervention itself is considered. The set Γr, r ∈ R, contains candidate surgeries assigned to room r, i.e., Γr
                         = {s ∈ ϒ|ηs
                         = r}. The reduced model can be written as follows:

                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             min
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   Υ
                                                
                                             
                                             
                                                d
                                                s
                                             
                                             
                                                z
                                                s
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                w
                                                s
                                                a
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      s
                                                      ′
                                                   
                                                   ∈
                                                   
                                                      
                                                         Λ
                                                         ¯
                                                      
                                                      s
                                                   
                                                   
                                                      |
                                                      a
                                                      ∈
                                                   
                                                   
                                                      A
                                                      
                                                         s
                                                         ′
                                                      
                                                      e
                                                   
                                                   ,
                                                   
                                                      τ
                                                      
                                                         s
                                                         ′
                                                      
                                                   
                                                   ∈
                                                   
                                                      T
                                                      e
                                                      a
                                                   
                                                
                                             
                                             
                                                w
                                                
                                                   s
                                                   ′
                                                
                                                a
                                             
                                             ≤
                                             
                                                q
                                                a
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             Υ
                                             ,
                                             ∀
                                             e
                                             ∈
                                             
                                                E
                                                s
                                             
                                             ,
                                             ∀
                                             a
                                             ∈
                                             
                                                A
                                                s
                                                e
                                             
                                             ,
                                             
                                                τ
                                                s
                                             
                                             ∈
                                             
                                                T
                                                e
                                                a
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                w
                                                s
                                                a
                                             
                                             +
                                             
                                                w
                                                
                                                   s
                                                   ′
                                                
                                                a
                                             
                                             ≤
                                             1
                                             
                                             ∀
                                             s
                                             ∈
                                             Υ
                                             ,
                                             ∀
                                             
                                                s
                                                ′
                                             
                                             ∈
                                             
                                                
                                                   Λ
                                                   ¯
                                                
                                                s
                                             
                                             ,
                                             
                                                b
                                                
                                                   
                                                      η
                                                      s
                                                   
                                                   
                                                      η
                                                      
                                                         s
                                                         ′
                                                      
                                                   
                                                
                                             
                                             =
                                             0
                                             ,
                                             ∀
                                             e
                                             ∈
                                             
                                                E
                                                s
                                             
                                             ∩
                                             
                                                E
                                                
                                                   s
                                                   ′
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             a
                                             ∈
                                             
                                                A
                                                s
                                                e
                                             
                                             ∩
                                             
                                                A
                                                
                                                   s
                                                   ′
                                                
                                                e
                                             
                                             ,
                                             
                                                τ
                                                s
                                             
                                             ∧
                                             
                                                τ
                                                
                                                   s
                                                   ′
                                                
                                             
                                             ∈
                                             
                                                T
                                                e
                                                a
                                             
                                             ,
                                             
                                                q
                                                a
                                             
                                             >
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   a
                                                   ∈
                                                   
                                                      A
                                                      s
                                                      e
                                                   
                                                   
                                                      
                                                      |
                                                      
                                                   
                                                   
                                                      τ
                                                      s
                                                   
                                                   ∈
                                                   
                                                      T
                                                      e
                                                      a
                                                   
                                                
                                             
                                             
                                                w
                                                s
                                                a
                                             
                                             +
                                             
                                                z
                                                s
                                             
                                             =
                                             1
                                             
                                             ∀
                                             s
                                             ∈
                                             Υ
                                             ,
                                             ∀
                                             e
                                             ∈
                                             
                                                E
                                                s
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                z
                                                s
                                             
                                             ≤
                                             1
                                             
                                             ∀
                                             s
                                             ∈
                                             Υ
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                w
                                                s
                                                a
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             Υ
                                             ,
                                             ∀
                                             e
                                             ∈
                                             
                                                E
                                                s
                                             
                                             ,
                                             ∀
                                             a
                                             ∈
                                             
                                                A
                                                s
                                                e
                                             
                                             ,
                                             
                                                τ
                                                s
                                             
                                             ∈
                                             
                                                T
                                                e
                                                a
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The objective function (13) minimises occupation losses due to candidate surgery assignments that cannot be performed. Constraint (14) bounds the number of surgeries an individual of a specialised resource type can perform simultaneously. Constraint (15) avoids the situation where an individual of a specialised resource type is assigned to two overlapping surgeries taking place in non compatible rooms. Constraint (16) ensures that either a candidate surgery has a specialised resource assigned to or it cannot be performed. Finally, constraints (17) and (18) define the domain of the variables. Since w is a binary variable, it follows from (16) that z assumes either 0 or 1.

At the end of the second step, the heuristic returns a feasible solution with an occupancy of 
                           
                              
                                 ∑
                                 
                                    s
                                    ∈
                                    Υ
                                 
                              
                              
                                 d
                                 s
                              
                              
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                       ¯
                                    
                                    s
                                 
                                 )
                              
                              ,
                           
                         where 
                           
                              z
                              ¯
                           
                         is an optimal z-vector to formulation (13)–(18).

One may not solve formulation (1)–(11) with the LP relaxation of (12) to optimality in order to obtain good feasible solutions to the original problem. Indeed, we note, for instance, that high quality solutions can be found when the formulation in the first step is solved to an optimality gap of 5 percent.

We try to construct a larger set of candidate surgery assignments by solving the LP relaxation of formulation (1)–(12). Let 
                           
                              y
                              ¯
                           
                         be an optimal (not necessarily integer) y-vector to the LP relaxation. Given a surgery s ∈ S, let ηs
                         be a room and τs
                         be a period yielding the greatest 
                           
                              y
                              ¯
                           
                         value, i.e., 
                           
                              
                                 (
                                 
                                    η
                                    s
                                 
                                 ,
                                 
                                    τ
                                    s
                                 
                                 )
                              
                              =
                              arg
                              
                                 max
                                 
                                    
                                       (
                                       r
                                       ,
                                       t
                                       )
                                    
                                    ∈
                                    
                                       R
                                       s
                                    
                                    ×
                                    
                                       T
                                       s
                                    
                                 
                              
                              
                                 {
                                 
                                    
                                       y
                                       ¯
                                    
                                    
                                       s
                                       t
                                    
                                    r
                                 
                                 }
                              
                           
                        . The set 
                           
                              Υ
                              =
                              {
                              s
                              ∈
                              S
                              
                              |
                              
                              
                                 
                                    y
                                    ¯
                                 
                                 
                                    s
                                    
                                       τ
                                       s
                                    
                                 
                                 
                                    η
                                    s
                                 
                              
                              ≥
                              ρ
                              }
                           
                         now contains each surgery s for which the assignment variable to ηs
                         and τs
                         in the LP optimal solution is greater than or equal to a threshold value ρ. In addition to constraints (7)–(10), this set of candidate surgery assignments may not be feasible with respect to the overlapping constraints (3) and (4), and to the resource constraints (5) and (6) as well.
                     

In the second step, we solve a reduced mixed integer programming model consisting of constraints (13)–(18) and constraints (19)–(22) given below.

                           
                              (19)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                z
                                                s
                                             
                                             +
                                             
                                                z
                                                
                                                   s
                                                   ′
                                                
                                             
                                             ≥
                                             1
                                             
                                             ∀
                                             c
                                             ∈
                                             C
                                             ,
                                             ∀
                                             s
                                             ∈
                                             
                                                S
                                                c
                                             
                                             ∩
                                             Υ
                                             ,
                                             ∀
                                             
                                                s
                                                ′
                                             
                                             ∈
                                             
                                                S
                                                c
                                             
                                             ∩
                                             
                                                
                                                   Λ
                                                   ¯
                                                
                                                s
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                z
                                                s
                                             
                                             +
                                             
                                                z
                                                
                                                   s
                                                   ′
                                                
                                             
                                             ≥
                                             1
                                             
                                             ∀
                                             r
                                             ∈
                                             R
                                             ,
                                             ∀
                                             s
                                             ∈
                                             
                                                Γ
                                                r
                                             
                                             ,
                                             ∀
                                             
                                                s
                                                ′
                                             
                                             ∈
                                             
                                                Γ
                                                r
                                             
                                             ∩
                                             
                                                Λ
                                                s
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                g
                                                
                                                   s
                                                   k
                                                
                                                1
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   s
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      s
                                                      ′
                                                   
                                                   ∈
                                                   
                                                      
                                                         Λ
                                                         ¯
                                                      
                                                      s
                                                   
                                                   
                                                      
                                                      |
                                                      
                                                   
                                                   
                                                      η
                                                      
                                                         s
                                                         ′
                                                      
                                                   
                                                   ∉
                                                   
                                                      R
                                                      k
                                                   
                                                
                                             
                                             
                                                g
                                                
                                                   
                                                      s
                                                      ′
                                                   
                                                   k
                                                
                                                1
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   
                                                      s
                                                      ′
                                                   
                                                
                                                )
                                             
                                             ≤
                                             
                                                q
                                                k
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             k
                                             ∈
                                             
                                                K
                                                1
                                             
                                             ,
                                             ∀
                                             s
                                             ∈
                                             Υ
                                             ,
                                             
                                                η
                                                s
                                             
                                             ∉
                                             
                                                R
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   Υ
                                                
                                             
                                             
                                                g
                                                
                                                   s
                                                   k
                                                
                                                2
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   s
                                                
                                                )
                                             
                                             ≤
                                             
                                                q
                                                k
                                                2
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             
                                                K
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Constraints (19) and (20) force one surgery to not be performed for every pair of two overlapping surgeries having the same surgeon and/or room in common. The former prevents a surgeon from starting a surgery without having finished one that was started earlier. The latter prevents a room from being in use with two surgeries at the same time. Constraints (21) and (22) ensure that candidate surgery assignments which exceed renewable and nonrenewable resource capacities (respectively) are avoided.

We generated instances based on real data from a Brazilian hospital to analyse the performance of the proposed methods on a variety of potential practical situations. However, we first discuss a real practical example to characterise a concrete case study.

The case study consists of 64 surgeries, which in practice means two days of scheduling. In total, 43 surgeons are involved with this set of surgeries. We have 24 periods of 30 minutes each. The sum of the duration of all surgeries is 367 periods, and cleaning takes 1 period after performing a surgery. There are two renewable resources: 3 mobile units of a microscope, and 5 mobile units of an image intensifier, which has also another unit installed on an operating room. The nonrenewable resource is an intensive care unit with 7 beds. The hospital has 14 rooms, divided into two blocks, for elective surgeries. Non-elective surgeries are undertaken in a third block of rooms. One main block has 11 rooms, and an auxiliary block has 3 rooms. Most of the surgeries, in this case 57 out of 64, have to be performed on the main block because they require renewable and/or nonrenewable resources. Cardiac surgeries have to be performed on a specific room. The same constraint applies to neurological surgeries, which have to be performed on another specific room. However, these specific rooms are not exclusive for cardiac and neurological surgeries, as other kinds of surgeries can be performed there as well. The specialised human resources are the 12 anaesthetists, which 6 of them work the whole day, 2 only in the morning, and 4 only in the afternoon. The set of surgeries each anaesthetist can perform is defined based on professional skills and personal preferences. They may perform at most 2 surgeries simultaneously, as long as they occur in the same block.

The integer model solved this case in 416 seconds on a Intel Core i3, 2.6 gigahertz with 4 gigabyte of RAM memory. In the optimal solution found, a total of 49 surgeries were scheduled summing up 292 periods of occupation. It corresponds to an utilisation of 87 percent. In the practice, the surgical scheduling is done manually, and utilisation rates are about 45–50 percent. The hospital’s goal is to have more than 60 percent of utilisation.

We conducted computational experiments using a variety of scenarios built with data presented in the previous section. All experiments were carried out on an Intel Xeon X5690 @ 3.47 gigahertz with 24-CPU and 132 gigabyte of RAM memory running Linux. We conducted experiments with the integer model, the LP-based heuristic, the relax-and-fix heuristic, and the relax-and-fix heuristic with first step solved to an optimality gap of 5 percent (denoted relax-and-fix 5 percent). All the proposed models and methods were coded in AMPL and solved by CPLEX version 12.4 with parameters presolve = 1, parallelmode = 1 to enable deterministic parallel search mode, and timelimit = 21,600 seconds. Constraint (10) was treated with parameter lazy when running the integer model and the first step of the relax-and-fix heuristics. Parameter mipemphasis was set to 1 in the first step of the relax-and-fix 5 percent to emphasise feasibility over optimality, and set to 0 otherwise.

In total 144 instances were generated. All instances are available upon request. Several features, like the number of rooms and resources, are fixed to those found in practice; while others, like the number of surgeries and the number of surgeries anaesthetists can perform simultaneously, were generated from values consistent with the hospital’s practice to cover diverse situations. The following data is fixed for all instances. The hospital has 14 rooms for elective surgeries. There are two renewable resources, i.e., |K
                        1| = 2, and one nonrenewable resource, i.e., |K
                        2| = 1. There are 6 surgeons, i.e., |C| = 6. A day is divided in 24 periods, i.e., |T| = 24. Different scenarios containing 3 instances for each value of |S| = 40, 50, 60, 70, 80, 90 were generated by varying configurations from the basic scenario as described in the next section.
                        
                        
                        
                        
                        
                        
                     

We report computational results got with the proposed models and methods on Tables 3–10. The tables have all the same structure. Objective function values are given in periods of occupation of the operating rooms, and running times are given in CPU seconds with CPLEX parameter clocktype = 1. The first two columns present the identification and the number of surgeries of each instance. Then, the next three columns present results obtained running the integer model (1)–(12). We report LB as the best feasible solution obtained, g(percent) as the optimality gap returned by CPLEX, and the user CPU time as the sum of AMPL _solve_user_time and _ampl_user_time. In the columns related to the LP-based heuristic (cf. Section 4.2) we report UB as the upper bound due to LP-relaxation, the user CPU time returned by AMPL _solve_user_time to solve LP-relaxation (i.e., the first step of the heuristic), LB as the best feasible solution obtained with the reduced model (13)–(22) (i.e., the second step of the heuristic), the user CPU time returned by AMPL _solve_user_time to solve the reduced model, g(percent) as the percentage gap between UB and LB given by 
                           
                              
                                 
                                    UB
                                    −
                                    LB
                                 
                                 LB
                              
                              ,
                           
                         and the user CPU time as the sum of AMPL _total_solve_user_time and _ampl_user_time. The columns related to the Relax-and-Fix heuristic are analogous to those related to the LP-based heuristic, except that we report UB as the upper bound obtained with the relaxation of (12) and LB as the best feasible solution obtained with the reduced model (13)–(18). In the last three columns, which are related to the Relax-and-Fix 5 percent, we report LB as the best feasible solution obtained with the reduced model (13)–(22), g(percent) as the percentage gap computed with respect to the upper bound returned by CPLEX when the procedure stops at the first step (not necessarily with an optimal solution to the relaxation of (12)), and the total user CPU time as the sum of AMPL _total_solve_user_time and _ampl_user_time (including the two steps of the heuristic, given that the time needed to solve the reduced model is negligible).

Note that each column g(percent) is computed solely with information obtained by the respective method, and not with respect to optima or best known upper bounds. As such, each column g(percent) gives the posteriori performance guarantees obtained with each method. Average gaps with respect to optimal or best known solutions are presented in an overview at the end of this section. In the LP-based heuristic, the threshold value ρ can be tuned to size the problem to be solved in the second step of the heuristic. Preliminary computational results have shown that the reduced model (13)–(22) is solved very quickly. For this reason we set ρ to 0.01, and take almost all surgeries with an active y variable in the LP-relaxation of the integer model (1)–(12) to build set ϒ (cf., Section 4.2). Thus, we give more options to the reduced model without significantly increasing total computational times as the second step of the heuristic is solved very quickly.

The parameter values for these basic instances, denoted by HC, were generated from guidelines provided by the staff charged with the surgical scheduling at the hospital. The rooms are divided into two groups, one with 3 rooms and another with 11 rooms. The rooms within each group are compatible with the simultaneous use of specialised resources, but no simultaneous use can be undertaken with rooms belonging to different groups. There is just one type of specialised human resource, i.e., |E| = 1, with 10 individuals, i.e., |A| = 10. For each instance, between 30 percent and 50 percent of the individuals belonging to A are able to perform 2 surgeries simultaneously, i.e., qa
                         = 2, while the others are unable to perform surgeries simultaneously, i.e., qa
                         = 1. The duration of surgeries were generated from a discrete uniform distribution between 1 and 11 periods. The distribution of surgeries among surgeons to form each set Sc
                         was done at random. Each surgery s has a probability of 90 percent to require a specialised human resource. Individuals from A were chosen at random to form As
                        . Also, for each surgery s, rooms from R were chosen at random to form Rs
                        . Each surgery s has a probability between 10 percent and 20 percent to require renewable resources, and between 0 percent and 15 percent to require the nonrenewable ones. Resource capacities were generated from a discrete uniform distribution between 1 and 6 for renewable resources, and between 3 and 6 for the nonrenewable resources. A room has a probability of 2 percent to have a renewable resource installed. Resources are used at the rate of one per surgery when needed, i.e., 
                           
                              g
                              
                                 s
                                 k
                              
                              1
                           
                         and 
                           
                              g
                              s
                              2
                           
                         are either 0 or 1. The medical staff work in morning shifts, in afternoon shifts, or for the whole day. So, time windows intervals were randomly chosen as being the first 12 periods, the last 12 periods, or all the 24 periods.
                     


                        Table 3 presents results obtained for the HC instances. We were able to solve to optimality all these instances, although computational times to run the integer model are considerably high for some instances. The proposed model provides tight LP-relaxation bounds, as can be seen on column UB of the LP-based heuristic. However, LP-relaxation solution values were not useful to derive good feasible solutions, as one might have expected. Indeed, the LP-based heuristic did not have a good performance returning gaps of more than 10% for almost all instances. The relax-and-fix has been shown to be very efficient on these instances which are similar to the real case. Computational times are moderate, even on the instances which the model has taken a long time to run, and it was able to find optimal solutions for all instances except HC5. For this instance, the upper bound obtained in the first step is optimal, but the set of surgeries selected are not feasible with respect to the assignment of specialised resources. The reduced model (13)–(18) runs extremely quickly. The relax-and-fix 5 percent seems to be a fast alternative to obtain good results, because within a minute the heuristic returned solutions with a posteriori performance guarantee of no more than 5.4 percent and it obtained 5 out of 18 optima.

We generated three different scenarios, from the basic one, by parameters associated to specialised resources were varied. Each of the instances denoted HB, HA and HE was generated from its counterpart of HC by changing one parameter at a time: compatibility between rooms, the cardinality of set A, and the cardinality of set E. In HB instances, rooms are no longer divided into groups, and parameter 
                           
                              
                                 b
                                 
                                    r
                                    
                                       r
                                       ¯
                                    
                                 
                              
                              ,
                           
                         cf., constraint (10), assumes 1 only if rooms r and 
                           
                              r
                              ¯
                           
                         are adjacent to each other. HA instances have 40 percent less individuals considered as specialised human resources than HC instances. In HE instances, we consider two types of specialised resources, i.e., E = {1, 2}. Type 1 is the type of specialised resource already present in HC instances. Type 2 was generated with 7 individuals, i.e., |A
                        2| = 7. For each instance, between 30 percent and 50 percent of the individuals belonging to A
                        2 are able to perform 2 surgeries simultaneously, each surgery s has a probability of 90 percent to require a specialised human resource of type 2, and individuals from A
                        2 were chosen at random to form 
                           
                              A
                              2
                              s
                           
                        . Note that a surgery may require both specialised resources, just one of them, or none of them.


                        Tables 4–6 present results for the HB, HA and HE instances, respectively. The parameter of compatibility between rooms and the cardinality of E impacts upon the performance of solving the problem with the integer model, as for 4 instances the model exceeded the time limit without closing the optimality gap. The relax-and-fix performed well to the varying of these parameters. In fact, it obtained all optima for instances HB and HE, except for HE5. It did this in reasonable computational times, except for HE8 which took longer than 10 minutes. The relax-and-fix 5 percent also performed well on instances HB and HE, presenting small gaps and reasonable computational times. It obtained optimal solutions for 11 and 8 instances, respectively. On the other hand, the HA instances were easier for the integer model to solve due to the reduced number of variables. They were also more challenging to the relax-and-fix heuristics which present larger gaps than observed in the previous instances, due to fewer possibilities to make solutions feasible in the second step. In terms of LP-relaxation, although the model still provides tight LP-relaxation upper bounds with the modified parameters, the LP-based heuristic had a poor performance, with some very high gaps. We remark that, for some instances, the LP-based heuristic takes longer to run than the Relax-and-Fix heuristics because in the latter cases constraint (10) was treated with parameter lazy when running their first step. Indeed, it was observed that with a simple experiment of removing constraint (10) to run the linear relaxation of the integer model the computational times of the LP-based heuristic were significantly reduced.

We generated scenarios varying time windows, also taking the HC instances as a starting point. The HL instances have time windows only for the specialised resources, i.e., Tc
                         = Ts
                         = T and 
                           
                              
                                 T
                                 e
                                 a
                              
                              ⊆
                              T
                              ,
                           
                         while the HS instances have no time windows at all. Tables 7 and 8 present results for instances HL and HS, respectively. Because time windows allow us to eliminate variables in time indexed models, these instances were much harder to solve due to the increasing number of variables. We were not able, by running the integer model, to close the optimality gaps for 10 instances of each scenario within the time limit, and even to obtain a feasible solution for instance HL17. On the other hand, with relax-and-fix, we were able to close the optimality gaps for most of the instances. Nevertheless, these results were obtained with high computational times, and five instances remain open: HL13, HL17, HL18, HS5, HS17. The relax-and-fix 5 percent has been shown to be an efficient alternative to tackle these harder instances, as it obtained results with a posteriori performance guarantee of less than 5 percent (including 5 of HL and 6 of HS optima) in reasonable computational times, except for instance HL17 which took longer than the others.

We then generated critical scenarios in terms of specialised resources. Surgeon and surgery time windows have been removed from instances HA and HB to generate instances HLA and HLB, respectively. So, in these instances, in addition to only specialised resources being subject to time windows, HLA has 40 percent less individuals, and HLB has only adjacent rooms which are compatible with each other. Tables 9 and 10 present results for instances HLA and HLB, respectively. These seem to be the hardest instances in our suite of experiments. We were not able, neither with the integer model nor with the relax-and-fix, to close the optimality gaps for half of the instances of each scenario. The relax-and-fix 5 percent again has been shown to be the best alternative to tackle these harder instances, as it obtained results with a posteriori performance guarantee of less than 7 percent, except for instance HLB17. In most of the cases it did so with reasonable computational times.

@&#OVERVIEW@&#


                        Table 11 gives an overview on the performance of each method in terms of solution quality and computational time. The first column identifies the scenario, and then, for each method, we present the maximum and the average percentage gaps with respect to optima or to best known solution values, the number of best solutions obtained, and the average computational time in seconds. The last column reports how many instances out of 18 for each scenario remain open after considering best upper and lower bounds obtained in the experiment. The gap is computed as 
                           
                              
                                 
                                    (
                                    BLB
                                    −
                                    LB
                                    )
                                 
                                 LB
                              
                              ,
                           
                         where BLB is the optimum or the best know lower bound and LB is the lower bound obtained by the method. The maximum gap is indicated with “inf” when the integer model was not able to find a feasible solution for at least one instance within the time limit of 21,600 seconds, and in this case the average gap is not computed. This happened for some instances with less restrictive time windows, which seem to be harder. For such scenarios, namely HL, HS, HLA, and HLB, the integer model needed high computational times, very often reaching the time limit without proving optimality. As has already been observed, the LP-based heuristic fails in obtaining high quality feasible solutions although the linear relaxation provides good upper bounds. The relax-and-fix strategy has been shown to be quite successful as it obtains optimal or near optimal solutions for all scenarios. The Relax-and-Fix heuristic obtained consistently the best solutions, although it needed in average about 3 hours of computational time for the harder instances such as HLA and HLB. The Relax-and-Fix 5 percent has been shown to be an effective alternative, obtaining small average gaps to optima or best known lower bounds in acceptable average computational times (less than 1 hour).


                        Fig. 1
                         shows, in percentage, optimal solution values (or best known solution values when optima are not available) with respect to the trivial upper bound if all surgeries could be performed, i.e., ∑
                           s∈S
                        
                        ds
                        . Part (a) refers to instances with more restrictive time windows. A bar refers to the average over the three instances for each cardinality of S in each scenario HC, HB, HA, and HE. We see that instances are not “loose” since solution values are at most 60 percent of the trivial bound, and for larger instances these values are not even 40 percent. Part (b) refers to scenarios HL, HS, HLA, and HLB with less restrictive time windows. The less restrictive time windows have a great impact on the number of surgeries that can be actually scheduled, and solution values are at least about 50 percent of the trivial bound. This second group of instances have an increasing number of variables and they seem to be harder since 23 out of 72 instances remain open.

We have addressed a surgery scheduling problem from a hospital in Brazil. In particular, we have modelled the simultaneous employment of specialised human resources, which in our case were anaesthetists. This enlarged the decision space since the assignment of anaesthetists to surgeries must be carried out jointly with the scheduling and assignment of surgeries to rooms. We developed integer programming based heuristics decoupling decisions into two steps because the integer model has been shown to provide tight bounds. We generated instances inspired by real data in order to conduct computational experiments on a number of scenarios covering different practical situations. The proposed relax-and-fix heuristic has been successful in finding optimal or near optimal solutions, and a variant that stops with a gap of 5 percent when assigning surgeries to rooms has been shown to be an effective alternative finding good quality solutions in less than 1 hour on average.

It could be observed that sometimes the Relax-and-Fix heuristic has selected (in its first step) surgeries leading to an optimal objective function value, but which were not feasible in terms of specialised resources assignment. Thus, there may have many combinations of surgeries leading to optimal values, some of them feasible in terms of specialised resources assignment and some of them not. Based on this observation, a line of future research is to introduce ideas of local branching (Fischetti & Lodi, 2003) in the second step of the heuristic. The reduced model would not only decide on assignment of specialised resources, but also decide on changing the allocation of some surgeries to rooms and periods within neighbourhoods obtained through the introduction of local branching cuts. The purpose of local branching neighbourhoods would be to rearrange a subset of surgeries among rooms and periods to increase the number of surgeries that can actually be scheduled with a successful assignment of specialised resources. Another line of research is to develop a metaheuristic that first uses heuristic rules to select surgeries, and then applies the reduced model to assign specialised resources. In a VNS (Hansen, Mladenović, & Moreno Pérez, 2010) like manner a shaking phase could make changes rearranging and/or increasing the set of surgeries proposed to be scheduled, whereas the reduced model would impose feasibility.

@&#ACKNOWLEDGEMENTS@&#

The authors wish to thank Heloísa Sampaio for useful discussions. The authors wish to thank the two anonymous referees for helpful suggestions in improving this paper. This research was partially supported by Brazilian funding agencies CAPES, CNPq, and FAPEMIG.

@&#REFERENCES@&#

