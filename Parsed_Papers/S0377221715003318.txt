@&#MAIN-TITLE@&#A noisy principal component analysis for forward rate curves

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           PCA analysis is not suitable for estimating forward rate factors due to noisy data.


                        
                        
                           
                           Robust Principal Component Analysis estimation of term structure models.


                        
                        
                           
                           Consistent estimation of number of factors in forward curves.


                        
                        
                           
                           Implications for pricing interest rate derivatives are also discussed.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Finance

Pricing

Principal component analysis

Term-structure of interest rates

HJM models

@&#ABSTRACT@&#


               
               
                  Principal Component Analysis (PCA) is the most common nonparametric method for estimating the volatility structure of Gaussian interest rate models. One major difficulty in the estimation of these models is the fact that forward rate curves are not directly observable from the market so that non-trivial observational errors arise in any statistical analysis. In this work, we point out that the classical PCA analysis is not suitable for estimating factors of forward rate curves due to the presence of measurement errors induced by market microstructure effects and numerical interpolation. Our analysis indicates that the PCA based on the long-run covariance matrix is capable to extract the true covariance structure of the forward rate curves in the presence of observational errors. Moreover, it provides a significant reduction in the pricing errors due to noisy data typically found in forward rate curves.
               
            

@&#INTRODUCTION@&#

The term-structure of interest rates is a high-dimensional object which has been the subject of much research in the finance literature. It is the natural starting point for pricing fixed-income securities and other financial assets. In particular, the identification of factors capable to explain its movements plays a crucial role in modeling complex interest rate derivative products. Since the seminal works of Steeley (1990), Stambaugh (1988) and Litterman and Scheinkman (1991), it is well-known that most of the covariance yield curve structure can be summarized by just a few unobservable factors. This stylized fact is fundamentally based on the Principal Component Analysis (henceforth abbreviated by PCA) based on sample covariance matrices. In this case, a small number of eigenvectors summarize the whole second moment structure of the yield curves.

The interest rate markets can be summarized by two fundamental high dimensional objects: the yield x ↦ yt
                     (x) and forward rate curves x ↦ rt
                     (x); t ≥ 0 which are connected by the following linear relation:

                        
                           (1.1)
                           
                              
                                 
                                    y
                                    t
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    1
                                    x
                                 
                                 
                                    ∫
                                    0
                                    x
                                 
                                 
                                    r
                                    t
                                 
                                 
                                    (
                                    z
                                    )
                                 
                                 d
                                 z
                                 ;
                                 
                                 0
                                 ≤
                                 t
                                 <
                                 ∞
                                 ,
                                 
                                 x
                                 ≥
                                 0
                                 .
                              
                           
                        
                     See e.g. Filipovic (2009) for more details. In particular, the underlying covariance structure of yield and forward rate curves play a major role in the statistical analysis of the term-structure of interest rates. See e.g Rebonato (2002), Schmidt (2011) and other references therein. For instance, forward rate curves play a central role in pricing and hedging interest rate derivatives by means of the classical methodology proposed by Heath, Jarrow, and Morton (1992). Their contribution can be summarized by the representation of the forward rate curve dynamics in terms of a stochastic partial differential equation

                        
                           (1.2)
                           
                              
                                 
                                    
                                       
                                          d
                                          
                                             r
                                             t
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ∂
                                                   
                                                      r
                                                      t
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                
                                                
                                                   ∂
                                                   x
                                                
                                             
                                             +
                                             
                                                α
                                                
                                                   H
                                                   J
                                                   M
                                                
                                             
                                             
                                                (
                                                t
                                                ,
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                )
                                             
                                             )
                                          
                                          d
                                          t
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             d
                                          
                                          
                                             σ
                                             j
                                          
                                          
                                             (
                                             t
                                             ,
                                             
                                                r
                                                t
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             )
                                          
                                          d
                                          
                                             B
                                             t
                                             j
                                          
                                          ;
                                          
                                          0
                                          ≤
                                          t
                                          <
                                          ∞
                                          ,
                                          
                                          x
                                          ≥
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where r
                     0(x) = ξ(x); x ≥ 0 is a given initial forward rate curve, αHJM
                      is the so-called (HJM) drift condition which is fully determined by the volatility structure σ = (σ
                     1,…, σd
                     ) and (B
                     1,…, Bd
                     ) is a d-dimensional Brownian motion. Indeed, the initial forward rate curve ξ and the volatility structure σ fully determine the no-arbitrage dynamics of the model (1.2). In the remainder of this paper, the family of models of the form (1.2) parameterized by volatilities σ will be called HJM models. See e.g Filipovic (2009) for further details.

For a given initial forward rate curve, the fundamental object which encodes the whole dynamics of (1.2) is volatility. In particular, due to closed form expressions for derivative prices and hedging, it is common (see e.g. (Falini, 2010; Jarrow, 2002; Rutkowski, 1996)) to assume that the volatility structure is deterministic. In this case, the stochastic dynamics of forward rates is given by a Gaussian HJM model:

                        
                           (1.3)
                           
                              
                                 
                                    
                                       
                                          d
                                          
                                             r
                                             t
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          
                                          =
                                          
                                          
                                             (
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      r
                                                      t
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                
                                                
                                                   ∂
                                                   x
                                                
                                             
                                             +
                                             
                                                α
                                                
                                                   H
                                                   J
                                                   M
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             
                                             )
                                          
                                          d
                                          t
                                          +
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             d
                                          
                                          
                                             σ
                                             j
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          d
                                          
                                             B
                                             t
                                             j
                                          
                                          ;
                                          
                                          0
                                          ≤
                                          t
                                          <
                                          ∞
                                          ,
                                          
                                          x
                                          
                                          ≥
                                          
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The most common alternative to estimate the underlying volatility structure is to use PCA methodology (see e.g. Filipovic, 2009; Jarrow, 2002; Schmidt, 2011 and other references therein) based on the static covariance matrix of a given sample (rt
                     (x
                     1),…, rt
                     (xM
                     )). The PCA methodology provides the following estimator for the volatility structure:

                        
                           (1.4)
                           
                              
                                 
                                    
                                       σ
                                       ^
                                    
                                    i
                                 
                                 =
                                 
                                    
                                       φ
                                       ^
                                    
                                    i
                                 
                                 
                                    
                                       
                                          λ
                                          ^
                                       
                                       i
                                    
                                 
                                 ;
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    m
                                    ^
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           m
                           ^
                        
                      is the estimated number of principal components of the forward rate curves and the estimated eigenvalues and eigenvectors of the associated static covariance matrix are given by 
                        
                           
                              λ
                              ^
                           
                           i
                        
                      and 
                        
                           
                              φ
                              ^
                           
                           i
                        
                     , respectively. See also Bermin (2014) for a recent theoretical link between PCA based on conditional covariance matrices and the Brownian dimension d which drives forward rates curve processes (1.2).

There are many drawbacks when estimating parameters and structures related to forward rate curves: (a) The intrinsic infinite-dimensionality of forward rate markets (see e.g Carmona and Tehranchi, 2006), (b) daily calibration may lead to inconsistent conclusions due to a possible non-existence of finite-dimensional realizations produced by (1.2) (see e.g Filipovic, 2001), and (c) the absence of fully observed forward rate curves in interest rate markets (see e.g. McCullogh, 1971). In this article, we discuss three fundamental issues related to (c) and the common use of PCA methodology in forward rate markets: Evidence of observational errors in forward rate markets; the sensitiveness of the PCA methodology facing noisy forward rate curves and their implications to pricing interest rate derivatives.

The next section continues with a brief literature review about the use of PCA methodology in interest rate data. In Section 3, we precisely state the main questions we want to tackle in this article. In Section 4, we report an elementary result about the equivalence of ranks between the covariance operators of the forward rate and yield curves. In Section 5, we describe some alternatives of estimating covariance structures in the presence of observational errors, the so-called LRCM estimators. Section 6 presents a detailed simulation analysis reporting the performance of the PCA based on LRCM estimators. Moreover, we discuss the role played by measurement errors in the PCA methodology applied to the term-structure of interest rate. In order to compare the simulation results reported in Section 6 with a real data set, Section 7 provides an empirical analysis on the number of principal components for US and UK term-structure of interest-rates. In Section 8, we analyze the impact of neglecting observational errors in pricing interest rate derivatives in light of the PCA methodology. Section 9 presents the final remarks.

@&#LITERATURE REVIEW@&#

The literature on the PCA methodology in interest rate markets is vast. This section reviews work from a stream of this literature that has some relevance to our study.

Plenty of spot interest rate data (and hence yield curve data) are available in fixed income markets. However, due to the absence of explicit forward rate markets, implied forward rate curves have to be estimated from interest rates based on other financial instruments (see e.g. McCullogh, 1971). This already presents a major difficulty in implementing derivative pricing models based on the classical Heath-Jarrow-Morton methodology. See e.g. Bermin (2014); Chiu, Fang, Lavery, Lin, and Wang (2008); Filipovic (2009); Richter and Teichmann (2014) and other references therein for further details.

The most common non-parametric procedure for estimating the covariance structure of forward rate curves is the PCA methodology. Basically, three common strategies are very popular among practitioners in the PCA estimation of the forward rate curves: (A) One postulates the existence of a finite-dimensional parameterized family of smooth curves 
                           
                              G
                              =
                              {
                              G
                              
                                 (
                                 z
                                 ;
                                 x
                                 )
                              
                              ;
                              z
                              ∈
                              Z
                              ⊂
                              
                                 R
                                 N
                              
                              ,
                              x
                              ≥
                              0
                              }
                           
                         and a 
                           Z
                        -valued state process Y such that

                           
                              (2.1)
                              
                                 
                                    
                                       y
                                       t
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    G
                                    
                                       (
                                       
                                          Y
                                          t
                                       
                                       ;
                                       x
                                       )
                                    
                                    
                                    for
                                    
                                    x
                                    ≥
                                    0
                                    ,
                                    
                                    0
                                    ≤
                                    t
                                    <
                                    ∞
                                    .
                                 
                              
                           
                        By interpolating the available yield data based on 
                           G
                        , then one extracts the associated forward rate curve by means of any numerical scheme to recover 
                           
                              
                                 r
                                 t
                              
                              
                                 (
                                 x
                                 )
                              
                              =
                              
                                 y
                                 t
                              
                              
                                 (
                                 x
                                 )
                              
                              −
                              x
                              
                                 
                                    ∂
                                    
                                       y
                                       t
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                 
                                 
                                    ∂
                                    x
                                 
                              
                           
                        . The PCA is then applied on this estimated forward rate curves, as discussed in e.g. Jarrow (2002) and Lord and Pelsser (2007). (B) Instead of (2.1), one shall use a non-parametric polynomial splines method to interpolate the yield data and userelation (1.1) to recover x ↦ rt
                        (x) at some time t ≥ 0. See e.g. Vasicek and Fong (1982), Barzanti and Corradi (1998), Chiu et al. (2008) and other references therein for further details. Alternatively, one can use proxies to construct the forward rate curve jointly with a given interpolating family of smooth curves 
                           G
                        . See e.g. Bhar, Chiarella, and Tô (2002), Alexander and Lvov (2003) and Gauthier and Simonato (2012) for further details.

One fundamental assumption behind all the classical aforementioned procedures and, more generally, on the use of PCA methodology in data analysis is the following one:


                        Assumption (I) There is no observational errors in forward rate curves.

One can argue that assumption (I) is not too strong due to the linear relation (1.1). Apparently, mild assumptions on the parametric form 
                           G
                         would alleviate a possible violation of assumption (I) in forward rate markets. However, caution is advised in this regard, because the marginal nature of the forward rate curves encoded by 
                           
                              
                                 ∂
                                 
                                    y
                                    t
                                 
                                 
                                    (
                                    x
                                    )
                                 
                              
                              
                                 ∂
                                 x
                              
                           
                         may introduce a severe bias. One of the main issues in calibration of HJM models is the fact that arbitrary choices of parametric forms 
                           G
                         for x ↦ yt
                        (x) may lead to inconsistency of the estimates over a trading period (see e.g. Filipovic, 2001 and other references therein). Moreover, proxies may cause non-negligible observational errors which might contribute to the so-called microstructure effects (see e.g. Mizrach & Neely, 2011 and Goyenko & Ukhov, 2011). In fact, the presence of measurement errors may cause biased and inconsistent parameter estimates. This may lead to erroneous conclusions to various degrees in the financial analysis.

At this stage, a natural question is the validity of assumption (I) in the term-structure of interest rates. In fact, we shall compare the existing literature of principal components between yield and forward rate curves to see some evidence of violation of assumption (I). In one hand, the linearity of the relation (1.1) strongly suggests that the “dimension” of the forward rate and yield curves must be identical (See Proposition 4.1). On the other hand, distinct results in the literature have been reported on the spectral structure of the forward rate and yield curves. Akahori, Aoki, and Nagata (2006) and Liu (2010) report a remarkable difference in the estimated number of factors between forward rates and yield curves and they suggest that a possible explanation for this would be the violation of the random walk hypothesis. The same type of behavior was reported by Lekkos (2000) who argues that averaging the forward rates over time to maturities would induce a strong dependence on the yield data. He argues that the PCA method artificially estimates a small number of principal components for yield curves. Alexander and Lvov (2003) study statistical properties of the UK Libor rates. They show that the strategy (A) induces equivalent loading factor structures between yield and implied forward rate curves. Lord and Pelsser (2007) report a visible difference in the PCA of forward and yield curves by using estimated Svensson curves for the Euro market. Similar results have been reported by Kletskin, et al. (2004) who identify a remarkable difference on the spectrum between yield and forward rate curves.

In summary, the existing literature restricts the discussion into two lines: (i) More factors are needed to account the correlation in forward rates curves. An averaging effect would be the reason for an artificial dependence on the yield curves. (ii) One way to remedy this pattern is to first smooth the yield data by means of a parametric or non-parametric form and then to calculate the implied forward rates. One should notice that one important assumption behind (i) and (ii) is (I). More importantly, the current literature only suggests the ad hoc methods based on (A–B).

The next section presents the main questions we want to tackle in this paper.

The main goal of this paper is to provide a full explanation for the different spectral structures between yield and forward rate curves found in the empirical literature over the last years as reported in Section 2. More importantly, we aim to point out that more refined estimators of covariance structures based on the so-called long-run covariance matrix (henceforth abbreviated by LRCM) should be used when dealing with forward rate curves. In order to tackle those problems, we perform a detailed analysis at assumption (I). Throughout this article, we assume that the observed forward rate and yield curve time series, which we denote by X
                     1(·),…, Xn
                     (·) and Z
                     1(·),…, Zn
                     (·), respectively, are subject to possible errors in the sense that

                        
                           (3.1)
                           
                              
                                 
                                    X
                                    t
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    r
                                    t
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 +
                                 
                                    
                                       ɛ
                                    
                                    t
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 
                                 
                                    Z
                                    t
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    y
                                    t
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 +
                                 
                                    η
                                    t
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ;
                                 u
                                 ≥
                                 0
                                 ,
                                 t
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 .
                              
                           
                        
                     In (3.1), the covariance structure 
                        
                           
                              {
                              C
                              o
                              v
                              
                                 (
                                 
                                    
                                       ɛ
                                    
                                    t
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                    
                                       ɛ
                                    
                                    t
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 )
                              
                              ,
                              C
                              o
                              v
                              
                                 (
                                 
                                    η
                                    t
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                    η
                                    t
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 )
                              
                              }
                           
                           ;
                           u
                           ,
                           v
                           ∈
                           
                              R
                              +
                           
                        
                      may not be null. We recall the existence of the error components (ε, η) in (3.1) is strongly motivated by daily calibration procedures and microstructure effects as described in Section 2. The possible existence of the noise terms (ε, η) in (3.1) reflects the classical interpolation procedures (A–B) when extracting forward rate curves from yield data. It can also be induced by observational errors due to market microstructure effects. The existence of an underlying bid and ask bond price structure contaminates the yield and forward rate curves (see e.g (Mizrach & Neely, 2011) and (Goyenko & Ukhov, 2011)). Non-additive error structures will also be investigated in view of interpolation procedures and numerical rounding. These noisy discrete data are smoothed to provide “observed” curves x ↦ Xt
                     (x), x ↦ Zt
                     (x) where both (rt
                     (·), yt
                     (·)) and (ε
                        t
                     (·), ηt
                     (·)) are unobservable. We investigate in detail the existence and the impact of observational errors 
                        
                           {
                           
                              (
                              
                                 
                                    ɛ
                                 
                                 t
                              
                              
                                 (
                                 x
                                 )
                              
                              ,
                              
                                 η
                                 t
                              
                              
                                 (
                                 x
                                 )
                              
                              )
                           
                           ;
                           t
                           ∈
                           N
                           ,
                           x
                           ∈
                           
                              R
                              +
                           
                           }
                        
                      in (3.1) in the classical PCA methodology.

The analysis presented in this article yields a sound explanation for the distinct spectral structures found in the literature of forward rate and yield curves. By focusing on the possibility of violation of assumption (I), we show that market microstructure effects and common interpolation procedures (A–B) induce noisy forward rate curves which cause severe bias in the standard PCA methodology. The starting point of our analysis is the fact that the ranks of the covariance operators of the forward rate and yield curves are identical. This is the content of the next section.

In this section, we give a simple remark showing the number of principal components in forward rate curves should be exactly the same of the yield curves under some mild conditions. In spite of its simplicity, it is the starting point to investigate the violation of assumption (I) and it also gives a comparison criterion for our statistical analysis.

Let {P(t, T); (t, T) ∈ Δ
                     2} be the term-structure of bond prices, where Δ
                     2 := {(t, T); 0 ≤ t ≤ T < ∞}. Let

                        
                           (4.1)
                           
                              
                                 s
                                 
                                    (
                                    t
                                    ,
                                    T
                                    )
                                 
                                 :
                                 =
                                 
                                    
                                       −
                                       l
                                       o
                                       g
                                       P
                                       (
                                       t
                                       ,
                                       T
                                       )
                                    
                                    
                                       T
                                       −
                                       t
                                    
                                 
                                 ;
                                 
                                    (
                                    t
                                    ,
                                    T
                                    )
                                 
                                 ∈
                                 
                                    Δ
                                    2
                                 
                                 ,
                              
                           
                        
                     be the spot-interest rate prevailing at time t for maturity T and let yt
                     (x) := s(t, t + x) be the correspondent yield curve at time indexed by the time to maturity x = T − t.

The forward rate prevailing at time t for maturity T is

                        
                           
                              
                                 f
                                 
                                    (
                                    t
                                    ,
                                    T
                                    )
                                 
                                 :
                                 =
                                 −
                                 
                                    
                                       ∂
                                       l
                                       o
                                       g
                                       P
                                       (
                                       t
                                       ,
                                       T
                                       )
                                    
                                    
                                       ∂
                                       T
                                    
                                 
                                 ;
                                 
                                    (
                                    t
                                    ,
                                    T
                                    )
                                 
                                 ∈
                                 
                                    Δ
                                    2
                                 
                                 ,
                              
                           
                        
                     and the forward rate curve is rt
                     (x) := f(t, t + x) for x = T − t. For simplicity of exposition, we analyze the PCA methodology based on a space E of curves so that forward rate and yield data are interpreted as sample curves over time.

In the sequel, we consider a discrete-time setup 
                        
                           t
                           ∈
                           N
                           :
                           =
                           {
                           0
                           ,
                           1
                           ,
                           2
                           ,
                           …
                           }
                        
                      and we assume that yt
                      and rt
                      are discrete-time weakly stationary E-valued process. That is, there exist functions (μy
                     (·), μr
                     (·), Qr
                     (·, ·), Qy
                     (·, ·)) such that the following identities hold for every t:

                        
                           
                              
                                 
                                    μ
                                    r
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 E
                                 
                                    r
                                    t
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                 
                                    μ
                                    y
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 E
                                 
                                    y
                                    t
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (4.2)
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             Q
                                             y
                                          
                                          
                                             (
                                             u
                                             ,
                                             v
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          C
                                          o
                                          v
                                          (
                                          
                                             y
                                             t
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          
                                             y
                                             t
                                          
                                          
                                             (
                                             v
                                             )
                                          
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                          
                                             Q
                                             r
                                          
                                          
                                             (
                                             u
                                             ,
                                             v
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          C
                                          o
                                          v
                                          (
                                          
                                             r
                                             t
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          
                                             r
                                             t
                                          
                                          
                                             (
                                             v
                                             )
                                          
                                          )
                                          ;
                                          u
                                          ,
                                          v
                                          ∈
                                          K
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Otherwise, we assume that the first difference process satisfies such properties. In the sequel, x
                     * is an arbitrary positive number which encodes the possible range of time to maturities. The set E is a separable Hilbert space of functions from a bounded set 
                        
                           K
                           :
                           =
                           
                              [
                              0
                              ,
                              
                                 x
                                 ☆
                              
                              )
                           
                           ⊂
                           
                              R
                              +
                           
                        
                      to 
                        R
                      such that J, T: E → E defined by

                        
                           (4.3)
                           
                              
                                 f
                                 ↦
                                 
                                    J
                                    x
                                 
                                 
                                    (
                                    f
                                    )
                                 
                                 :
                                 =
                                 
                                    1
                                    x
                                 
                                 
                                    ∫
                                    0
                                    x
                                 
                                 f
                                 
                                    (
                                    y
                                    )
                                 
                                 d
                                 y
                                 ;
                                 
                                 f
                                 ↦
                                 
                                    T
                                    x
                                 
                                 
                                    (
                                    f
                                    )
                                 
                                 :
                                 =
                                 x
                                 
                                    d
                                    
                                       d
                                       x
                                    
                                 
                                 f
                                 
                                    (
                                    x
                                    )
                                 
                                 ,
                              
                           
                        
                     are bounded linear operators. In the sequel, we denote E equipped with an inner product 〈·, ·〉1/2 = ‖ · ‖. Assuming that the discrete-time processes r and y are square-integrable, the covariance operators induced by the kernels in (4.2) admit spectral decompositions over E as follows

                        
                           
                              
                                 
                                    Q
                                    y
                                 
                                 
                                    (
                                    ·
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    ∞
                                 
                                 
                                    λ
                                    k
                                 
                                 
                                    (
                                    y
                                    )
                                 
                                 
                                    〈
                                    ·
                                    ,
                                    
                                       φ
                                       k
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    〉
                                 
                                 
                                    φ
                                    k
                                 
                                 
                                    (
                                    y
                                    )
                                 
                                 ,
                                 
                                 
                                    Q
                                    r
                                 
                                 
                                    (
                                    ·
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    ∞
                                 
                                 
                                    λ
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                                 
                                    〈
                                    ·
                                    ,
                                    
                                       φ
                                       k
                                    
                                    
                                       (
                                       r
                                       )
                                    
                                    〉
                                 
                                 
                                    φ
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           
                              (
                              
                                 φ
                                 k
                              
                              
                                 (
                                 r
                                 )
                              
                              )
                           
                           
                              k
                              =
                              1
                           
                           ∞
                        
                      and 
                        
                           
                              (
                              
                                 φ
                                 k
                              
                              
                                 (
                                 y
                                 )
                              
                              )
                           
                           
                              k
                              =
                              1
                           
                           ∞
                        
                      are orthonormal bases for E with eigenvalues 
                        
                           
                              (
                              
                                 λ
                                 k
                              
                              
                                 (
                                 r
                                 )
                              
                              )
                           
                           
                              k
                              =
                              1
                           
                           ∞
                        
                      and 
                        
                           
                              (
                              
                                 λ
                                 k
                              
                              
                                 (
                                 y
                                 )
                              
                              )
                           
                           
                              k
                              =
                              1
                           
                           ∞
                        
                     , respectively. The number of principal components of the forward and yield curves are the number of non-zero eigenvalues of Qr
                      and Qy
                     , respectively. We assume that λ
                     1(r) > … > λp
                     (r) > λ
                     
                        p + i
                      = 0; λ
                     1(y) > … > λq
                     (y) > λ
                     
                        q + i
                      = 0 for every i ≥ 1, max (p, q) < ∞ so that

                        
                           
                              
                                 
                                    E
                                    ∥
                                 
                                 
                                    r
                                    t
                                 
                                 −
                                 
                                    μ
                                    r
                                 
                                 
                                    
                                       ∥
                                    
                                    2
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    p
                                 
                                 
                                    λ
                                    i
                                 
                                 
                                    (
                                    r
                                    )
                                 
                                 ,
                                 
                                 E
                                 
                                    
                                       ∥
                                       
                                          y
                                          t
                                       
                                       −
                                       
                                          μ
                                          y
                                       
                                       ∥
                                    
                                    2
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    q
                                 
                                 
                                    λ
                                    i
                                 
                                 
                                    (
                                    y
                                    )
                                 
                                 ;
                                 t
                                 ∈
                                 N
                                 .
                              
                           
                        
                     The explained variance associated with the k-th principal component for r and y can be expressed, respectively, by

                        
                           
                              
                                 
                                    
                                       
                                          λ
                                          k
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          p
                                       
                                       
                                          λ
                                          i
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          λ
                                          k
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          q
                                       
                                       
                                          λ
                                          i
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     In the sequel, we denote 
                        
                           Λ
                           :
                           =
                           
                              I
                              d
                           
                           −
                           T
                        
                      where Id
                      is the identity operator on E and 
                        T
                      is given by (4.3). For a given bounded linear operator G, the correspondent self-adjoint operator will be denoted by G*. The following simple remark shows how the covariance operators of the forward rate and yield curves are related to each other.

                        Proposition 4.1
                        
                           Let y and r be square-integrable weakly-stationary E-valued discrete-time processes. Assume that Qr and Qy are finite-rank operators and E is a Hilbert space realizing (
                           
                              4.3
                           
                           ). Then Qr
                            = ΛQyΛ* and Qy
                            = JQrJ*. In particular, Rank Qr
                            = Rank Qy.
                        

We recall that Qr
                            and Qy
                            are the unique self-adjoint, non-negative and bounded operators such that

                              
                                 (4.4)
                                 
                                    
                                       
                                          〈
                                          
                                             Q
                                             r
                                          
                                          f
                                          ,
                                          g
                                          〉
                                       
                                       =
                                       E
                                       
                                          〈
                                          
                                             r
                                             t
                                          
                                          −
                                          
                                             μ
                                             r
                                          
                                          ,
                                          f
                                          〉
                                       
                                       
                                          〈
                                          
                                             r
                                             t
                                          
                                          −
                                          
                                             μ
                                             r
                                          
                                          ,
                                          g
                                          〉
                                       
                                    
                                 
                              
                           
                           
                              
                                 (4.5)
                                 
                                    
                                       
                                          〈
                                          
                                             Q
                                             y
                                          
                                          f
                                          ,
                                          g
                                          〉
                                       
                                       =
                                       E
                                       
                                          〈
                                          
                                             y
                                             t
                                          
                                          −
                                          
                                             μ
                                             y
                                          
                                          ,
                                          f
                                          〉
                                       
                                       
                                          〈
                                          
                                             y
                                             t
                                          
                                          −
                                          
                                             μ
                                             y
                                          
                                          ,
                                          g
                                          〉
                                       
                                       ;
                                       f
                                       ,
                                       g
                                       ∈
                                       E
                                       ,
                                       t
                                       ∈
                                       N
                                       .
                                    
                                 
                              
                           Moreover, we shall write yt
                           (x) = Jx
                           (rt
                           ) and rt
                           (x) = Λx
                           (yt
                           ). This fact, together with relations (4.4) and (4.5) and the continuity assumptions on Λ and J allow us to conclude that Qr
                            = ΛQyΛ* and Qy
                            = JQrJ*. Now let us define the following finite-rank, non-negative and self-adjoint operators

                              
                                 
                                    
                                       
                                          
                                             Q
                                             ¯
                                          
                                          r
                                       
                                       :
                                       =
                                       
                                          Q
                                          y
                                       
                                       
                                          Λ
                                          *
                                       
                                       Λ
                                       ,
                                       
                                       
                                          
                                             Q
                                             ¯
                                          
                                          y
                                       
                                       :
                                       =
                                       
                                          Q
                                          r
                                       
                                       
                                          J
                                          *
                                       
                                       J
                                       .
                                    
                                 
                              
                           By the very definition, 
                              
                                 
                                    Q
                                    ¯
                                 
                                 y
                              
                            and Qy
                            share the same non-zero eigenvalues and therefore,

                              
                                 
                                    
                                       R
                                       a
                                       n
                                       k
                                       
                                       
                                          Q
                                          y
                                       
                                       =
                                       R
                                       a
                                       n
                                       k
                                       
                                       
                                          
                                             Q
                                             ¯
                                          
                                          y
                                       
                                       ≤
                                       R
                                       a
                                       n
                                       k
                                       
                                       
                                          Q
                                          r
                                       
                                       
                                          J
                                          *
                                       
                                       ≤
                                       R
                                       a
                                       n
                                       k
                                       
                                       
                                          Q
                                          r
                                       
                                       .
                                    
                                 
                              
                           The same argument applies to 
                              
                                 
                                    Q
                                    ¯
                                 
                                 r
                              
                            and Qr
                            so that Rank Qr
                            ≤ Rank Qy
                           . This concludes the proof.□

Despite the simplicity of Proposition 4.1, it provides important information on dimension reducing techniques for forward rate and yield curves based on PCA: The effective number of principal components should be the same for forward rates and yield curves.


                        Proposition 4.1 contradicts the heuristic argument given by Lekkos (2000) who argues that the identity y = J(r) would smooth the spectral structure of the yield curve covariance operator. It also sheds some light on the results reported by many authors who compare the PCA for forward and yield curves. In one hand, Akahori and Liu (2011), Liu (2010), Lord and Pelsser (2007) and Lekkos (2000) report substantial differences between the correlation structure of forward and yield curves. On the other hand, Alexander and Lvov (2003) report a very stable estimation by using discretely compounded forward rates and the parametric Svensson family to extract the forward rates. Their empirical results together with Proposition 4.1 might suggest that in order to extract the spectral properties of forward rates from the observed bond prices, a reasonable choice of a parametric family of smooth curves is a good starting point. However, one should notice that this procedure may potentially introduce an artificial loading factor structure on forward rates. As pointed out by Lord and Pelsser (2007), nonparametric procedures based on splines and bootstrap techniques might introduce a non-negligible noise on the forward curve.


                        Proposition 4.1 implies that a remarkable difference in the number of principal components between forward and yield curves is a strong evidence for the presence of unobserved noise in the data. If this is the case, then unobserved errors might induce a nontrivial bias in the statistical analysis of the forward rate curves. This remark will be the starting point for our analysis in the remainder of this article.

One way to overcome the presence of observational errors in a PCA methodology is the so-called long-run covariance matrix (LRCM). We recall that the PCA method based on the usual static sample covariance matrix is only valid for independent and weakly stationary processes. In the presence of some sort of temporal dependence caused by serial correlation or a contamination process, the use of the static sample covariance matrix is not the correct one anymore.

One alternative to correct these types of dependence is to use estimators based on the LRCM. In the sequel, we denote the process of interest as a vector wt
                     , and assume weak stationarity and ergodicity of wt
                     . The LRCM of w is defined by

                        
                           
                              
                                 
                                    V
                                    
                                       l
                                       r
                                    
                                 
                                 :
                                 =
                                 
                                    lim
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 v
                                 a
                                 r
                                 
                                    (
                                    
                                       n
                                    
                                    
                                       w
                                       ¯
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       j
                                       =
                                       −
                                       ∞
                                    
                                    ∞
                                 
                                 γ
                                 
                                    (
                                    
                                    j
                                    )
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           γ
                           
                              (
                              
                              j
                              )
                           
                           :
                           =
                           E
                           [
                           
                              (
                              
                                 w
                                 t
                              
                              −
                              E
                              
                                 [
                                 
                                    w
                                    t
                                 
                                 ]
                              
                              )
                           
                           
                              
                                 (
                                 
                                    w
                                    
                                       t
                                       −
                                       j
                                    
                                 
                                 −
                                 E
                                 
                                    [
                                    
                                       w
                                       
                                          t
                                          −
                                          j
                                       
                                    
                                    ]
                                 
                                 )
                              
                              ⊤
                           
                           ]
                        
                      is the cross covariance in lag j, 
                        
                           w
                           ¯
                        
                      is the sample mean and ⊤ denotes the transpose of a matrix. One important and standard case is γ(j) at j = 0. In this case, all the non-contemporaneous cross-variances are equal to zero and we retrieve the usual static covariance matrix Vs
                      := γ(0), whose the usual estimator will be denoted by 
                        
                           
                              V
                              ^
                           
                           s
                        
                     .

Although it is possible to estimate independently each covariance term γ(j) by the correspondent sample quantities 
                        
                           
                              γ
                              ^
                           
                           
                              (
                              
                              j
                              )
                           
                        
                     , the natural estimator of the long run matrix 
                        
                           
                              
                                 V
                                 ^
                              
                              n
                           
                           :
                           =
                           
                              ∑
                              
                                 j
                                 =
                                 −
                                 (
                                 n
                                 −
                                 1
                                 )
                              
                              
                                 n
                                 −
                                 1
                              
                           
                           
                              γ
                              ^
                           
                           
                              (
                              
                              j
                              )
                           
                        
                      is not consistent because the number of parameters grows proportional to the sample size n ≥ 1. In order to overcome this problem, a general non-parametric class of LRCM consistent estimators is introduced by Andrews (1991)
                     
                        
                           (5.1)
                           
                              
                                 
                                    
                                       V
                                       ^
                                    
                                    
                                       l
                                       r
                                    
                                    A
                                 
                                 :
                                 =
                                 
                                    ∑
                                    
                                       j
                                       =
                                       −
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                 
                                 α
                                 
                                    (
                                    
                                    j
                                    )
                                 
                                 
                                    γ
                                    ^
                                 
                                 
                                    (
                                    
                                    j
                                    )
                                 
                                 ,
                              
                           
                        
                     where α(j) is a sequence of weights of the form α(j) = K(j/b), where K(·) is a continuous symmetric kernel function such that K(0) = 1 and b a suitable bandwidth parameter such that b → ∞ as n → ∞.

Some optimal choices for the kernel function and the bandwidth parameter in (5.1) are discussed by Andrews (1991). The most important one is the bandwidth parameter. Precise conditions for consistency of the LRCM estimators of type (5.1) based on kernel methods require that the bandwidth increases slower than the sample size.

However, it is well-known that this class of asymptotic estimators does not go well in finite samples, in particular for processes with strong dependence and temporal heterogeneity (see e.g. Müller (2007)). As discussed by Müller (2007), statistical inference by using consistent LRCM estimators performs badly in small samples and also in the presence of dependence and contamination/measurement errors. To overcome these problems, Kiefer and Vogelsang (2005, 2002) introduce a class of kernel-type estimators with a bandwidth rule given by a fixed portion of the sample size, known as fixed-b estimators. These LRCM estimators are not consistent due to a fixed bandwidth parameter. However, they explicitly incorporate parameter uncertainty and they present very good finite sample properties in hypothesis testing. See Kiefer and Vogelsang (2005, 2002) for details. In particular, Kiefer and Vogelsang (2002) suggest the use of the whole sample as a possible bandwidth rule in the construction of the LRCM estimator (5.1). This strategy allows us to use all lags of X in (3.1) in the estimation procedure. This will be particularly important for noisy data sets with contaminations induced by market microstructure effects and interpolation procedures (A–B) discussed in the Introduction.

Let 
                        
                           
                              u
                              ^
                           
                           t
                        
                      be the mean adjusted deviations of the series wt
                     . The Kiefer and Vogelsang (2002) estimator is defined by

                        
                           (5.2)
                           
                              
                                 
                                    
                                       V
                                       ^
                                    
                                    
                                       l
                                       r
                                    
                                    
                                       V
                                       K
                                    
                                 
                                 :
                                 =
                                 
                                    T
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    
                                       u
                                       ^
                                    
                                    i
                                 
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          |
                                          i
                                          −
                                          j
                                          |
                                       
                                       T
                                    
                                    )
                                 
                                 
                                    
                                       u
                                       ^
                                    
                                    j
                                 
                                 ,
                              
                           
                        
                     which corresponds to the use of a Bartlett kernel and bandwidth equal to the sample size in the LRCM estimation.

In order to handle dependent error structures and outliers, Müller (2007) extends the results in Kiefer and Vogelsang (2005, 2002). He shows that the usual LRCM estimators are extremely fragile in the presence of contamination and outliers. He suggests a class of LRCM estimators with bandwidths based on fixed portions of the sample size. The class of estimators proposed by Müller (2007) can be constructed in the same spirit of Kiefer and Vogelsang (2005, 2002) but with one fundamental difference: They are asymptotically robust to contaminations in the autocorrelation structure, in particular to contamination by moving average process. In particular, he obtains a class of estimators 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              U
                              A
                              (
                              p
                              )
                           
                        
                      (see pp. 1339–1342 in Müller, 2007) which trades optimally robustness and efficiency. The 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              U
                              A
                              (
                              p
                              )
                           
                        
                      estimator is defined by

                        
                           (5.3)
                           
                              
                                 
                                    
                                       V
                                       ^
                                    
                                    
                                       l
                                       r
                                    
                                    
                                       U
                                       A
                                       (
                                       p
                                       )
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          T
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          T
                                       
                                       
                                          
                                             ξ
                                             ^
                                          
                                          i
                                       
                                       
                                          
                                             ξ
                                             ^
                                          
                                          j
                                       
                                    
                                    p
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           
                              ξ
                              ^
                           
                           t
                        
                      is the residual of the linear regression of 
                        
                           
                              u
                              ^
                           
                           t
                        
                      against a p-dimensional series 
                        
                           
                              
                                 υ
                                 ^
                              
                              t
                           
                           
                              (
                              l
                              )
                           
                        
                     , l = 1,…, p where 
                        
                           
                              
                                 υ
                                 ^
                              
                              t
                           
                           
                              (
                              l
                              )
                           
                           :
                           =
                           
                              
                                 2
                                 /
                                 T
                              
                           
                           
                              cos
                              (
                              l
                              π
                              
                                 (
                                 t
                                 −
                                 1
                                 /
                                 2
                                 )
                              
                              /
                              T
                           
                        
                     . The parameter 1 ≤ p < ∞ controls the bias and efficiency in the LRCM estimation procedure. Müller (2007) shows that this estimator has good properties w.r.t robustness and efficiency. In addition, they present well-known asymptotic distributions under the null in hypothesis testing.

In this article, we show that the LRCM estimators (5.2) and (5.3) allow us to filter the dependence structure generated by observational errors and market microstructure effects, typically found in forward rate markets.

In order to investigate the impact of observational errors in the classical PCA methodology applied to forward rate curves, we now provide a detailed simulation study as follows. In order to study different types of data contamination in forward rate curves, we assume that both the forward rate and yield curves are subject to errors

                        
                           (6.1)
                           
                              
                                 
                                    X
                                    t
                                 
                                 =
                                 
                                    r
                                    t
                                 
                                 +
                                 
                                    
                                       ɛ
                                    
                                    t
                                 
                                 ,
                                 
                                 
                                    Z
                                    t
                                 
                                 =
                                 
                                    y
                                    t
                                 
                                 +
                                 
                                    η
                                    t
                                 
                                 ;
                                 t
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                              
                           
                        
                     where ε
                        t
                      and ηt
                      are the error components to be specified.

In addition to the analysis of the curves (6.1), it is also important to consider the first-difference of the time series 
                        
                           
                              
                                 X
                                 ˜
                              
                              t
                           
                           :
                           =
                           
                              X
                              t
                           
                           −
                           
                              X
                              
                                 t
                                 −
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 Z
                                 ˜
                              
                              t
                           
                           :
                           =
                           
                              Z
                              t
                           
                           −
                           
                              Z
                              
                                 t
                                 −
                                 1
                              
                           
                           ;
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                           .
                        
                      We recall that a direct application of the PCA to the processes (6.1) implicitly assumes that X and Z are already weakly stationary. If X and (or) Z are assumed to be non-stationary, it is necessary to apply the PCA decomposition at the first-differences 
                        
                           X
                           ˜
                        
                      and 
                        
                           Z
                           ˜
                        
                     , which are possibly weakly stationary processes. There is also an intrinsic reason to study the first-difference of the time series. Due to the HJM representation of the forward rates (see (1.2)), the PCA methodology must be computed in terms of the increments rather than the first levels. See Jarrow (2002) and Filipovic (2009) for further details.

An obvious consequence of Proposition 4.1 is the following corollary.

                        Corollary 6.1
                        
                           Assume that both r and y are weakly stationary processes. If η = ε = 0, then the number of principal components of X and Z must be identical.
                        

The number of principal components will be the key parameter of study in order to infer the performance of the usual PCA methodology based on 
                        
                           
                              V
                              ^
                           
                           s
                        
                      against the LRCM estimators defined in (5.1) –(5.3). Of course, the same statement of Corollary 6.1 holds for the first-difference processes 
                        
                           X
                           ˜
                        
                      and 
                        
                           Y
                           ˜
                        
                     .

In order to investigate the impact of observational errors in the PCA methodology, we proceed the analysis on two different prominent models: Gaussian HJM and Cox-Ingersoll-Ross models. As far as the Gaussian HJM model rt
                      (see (1.3)) is concerned, the volatility parameter is calibrated based on the classical interest rate curves studied by Diebold and Li (2006). It consists of zero coupon (Treasury bond) bonds with maturities 3, 6, 9, 12, 15, 18, 21, 24, 30, 36, 48, 60, 72, 90, 108 and 120 months covering 1985 January–2000 December. The Gaussian HJM simulation is based on this calibrated volatility parameter where the number of principal components is equal to 3(three).

The specification of the Cox–Ingersoll–Ross model (henceforth abbreviated by CIR model) is based on Chen and Scott (2003). In this case, a three-factor CIR model is simulated by means of a short rate process of the form 
                        
                           s
                           h
                           o
                           r
                           
                              t
                              t
                           
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              3
                           
                           
                              Y
                              
                                 t
                              
                              i
                           
                        
                      where each latent factor follows the stochastic differential equation:

                        
                           (6.2)
                           
                              
                                 d
                                 
                                    Y
                                    
                                       t
                                    
                                    i
                                 
                                 =
                                 
                                    κ
                                    i
                                 
                                 
                                    (
                                    
                                       θ
                                       i
                                    
                                    −
                                    
                                       Y
                                       
                                          t
                                       
                                       i
                                    
                                    )
                                 
                                 d
                                 t
                                 +
                                 
                                    σ
                                    i
                                 
                                 
                                    
                                       Y
                                       
                                          t
                                       
                                       i
                                    
                                 
                                 d
                                 
                                    B
                                    
                                       t
                                    
                                    i
                                 
                                 ;
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 .
                              
                           
                        
                     The parameters κi, θi
                      and σi
                      used in the simulation study are chosen according to Chen and Scott (2003) who estimates them based on weekly data (1980–1988) of the U.S Treasury market
                        1
                     
                     
                        1
                        See Chen and Scott (2003) for the expressions for the affine factors and bond prices in the multifactor CIR model.
                     . We perform 1,000 replications of these HJM and CIR data generating processes with sample size 1,000.

We analyze the PCA methodology based on the standard sample covariance matrix estimator 
                        
                           
                              V
                              ^
                           
                           s
                        
                      against the LRCM estimators 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           A
                        
                     , 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              V
                              K
                           
                        
                      and 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              U
                              A
                              (
                              p
                              )
                           
                        
                     . Those estimators are applied to (X, Z) and 
                        
                           (
                           
                              X
                              ˜
                           
                           ,
                           
                              Z
                              ˜
                           
                           )
                        
                     . The 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           A
                        
                      estimator is specified with the quadratic-spectral kernel function and the optimal bandwidth choice of Andrews (1991). The 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              V
                              K
                           
                        
                      estimator is specified with the Bartlett kernel function and the whole sample as a bandwidth rule. The 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              U
                              A
                              (
                              p
                              )
                           
                        
                      estimator is specified with p = 4 components in the basis 
                        
                           
                              v
                              ^
                           
                           t
                        
                     . See Section 5 for details.


                     Figs. 1
                     –5 report the mean value of the cumulative R-Squared obtained in the Monte Carlo experiments with the PCA decompositions based on the static covariance matrix and the LRCM estimators. Fig. 1 reports the PCA methodology applied to X = r + ε where ε = 0, the forward rate r is a Gaussian HJM model as described above and the associated yield curve is computed via (1.1). Fig. 2
                      reports the PCA methodology applied to Z = y + η where η = 0, the yield y is a CIR model as described in (6.2) and the associated forward rate curve is computed via 
                        
                           
                              y
                              t
                           
                           
                              (
                              x
                              )
                           
                           +
                           x
                           
                              
                                 ∂
                                 
                                    y
                                    t
                                 
                                 
                                    (
                                    x
                                    )
                                 
                              
                              
                                 ∂
                                 x
                              
                           
                        
                     . Without the presence of observational errors, we notice that the number of principal components is correctly estimated for (X, Z) and 
                        
                           (
                           
                              X
                              ˜
                           
                           ,
                           
                              Z
                              ˜
                           
                           )
                        
                      by using any of the estimators. This result is not surprising due to Proposition 4.1 and the fact that both r and y are weakly stationary processes. In the presence of observational errors the picture is rather different.

We formulate the analysis based on two types of observational errors: Market microstructure effects (MME) and interpolation error structure (IES) as described by (A–B) in the Introduction. In order to analyze the impact of MME in the PCA methodology, we introduce an additive error structure typically founded in interest rate markets due to transaction costs and liquidity premiums in bond prices (see e.g. Mizrach & Neely, 2011 and Goyenko & Ukhov, 2011). This phenomenon is directly observed by the existence of bid and ask prices. In the classical model of market microstructure (e.g. Hasbrouck, 1991), the true price of the asset is within the range between the observed bid and ask prices. In other words, the observed prices may be considered as the true price plus an additive measurement error.

We are going to study the impact of the MME as follows. In the sequel, the forward rate process r in (6.3) and the yield process y in (6.4) are given, respectively, by the Gaussian HJM and CIR models as specified above. Fig. 3
                         reports the PCA methodology applied to

                           
                              (6.3)
                              
                                 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                   
                                                      
                                                         
                                                            X
                                                            t
                                                         
                                                         
                                                            (
                                                            x
                                                            )
                                                         
                                                         =
                                                         
                                                            r
                                                            t
                                                         
                                                         
                                                            (
                                                            x
                                                            )
                                                         
                                                         +
                                                         
                                                            
                                                               ɛ
                                                            
                                                            t
                                                         
                                                         
                                                            (
                                                            x
                                                            )
                                                         
                                                         ;
                                                         
                                                         where
                                                         
                                                         
                                                            ɛ
                                                         
                                                         
                                                         is
                                                         
                                                         a
                                                         
                                                         Gaussian
                                                         
                                                         zero
                                                         
                                                         mean
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         
                                                         IID
                                                         
                                                         process
                                                         
                                                         with
                                                         
                                                         variance
                                                         
                                                         .
                                                         0035
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                            t
                                                         
                                                         
                                                            (
                                                            x
                                                            )
                                                         
                                                         =
                                                         
                                                            y
                                                            t
                                                         
                                                         
                                                            (
                                                            x
                                                            )
                                                         
                                                         +
                                                         
                                                            η
                                                            t
                                                         
                                                         
                                                            (
                                                            x
                                                            )
                                                         
                                                         ;
                                                         
                                                         where
                                                         
                                                         y
                                                         
                                                         is
                                                         
                                                         computed
                                                         
                                                         via
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         
                                                         formula
                                                         
                                                         
                                                            (
                                                            4.1
                                                            )
                                                         
                                                         
                                                         and
                                                         
                                                         
                                                            η
                                                            t
                                                         
                                                         
                                                            (
                                                            x
                                                            )
                                                         
                                                         =
                                                         
                                                            1
                                                            x
                                                         
                                                         
                                                            ∫
                                                            0
                                                            x
                                                         
                                                         
                                                            
                                                               ɛ
                                                            
                                                            t
                                                         
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                         d
                                                         r
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        Fig. 4
                        
                         reports the PCA methodology applied to

                           
                              (6.4)
                              
                                 
                                    {
                                    
                                       
                                          
                                          
                                             
                                                
                                                   Z
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   y
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                +
                                                
                                                   η
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                ;
                                                
                                                where
                                                
                                                η
                                                
                                                is
                                                
                                                a
                                                
                                                Gaussian
                                                
                                                zero
                                                
                                                mean
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                IID
                                                
                                                process
                                                
                                                with
                                                
                                                variance
                                                
                                                .
                                                0035
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   X
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                +
                                                
                                                   
                                                      ɛ
                                                   
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                ;
                                                
                                                where
                                                
                                                
                                                   
                                                      ɛ
                                                   
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   η
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                +
                                                x
                                                
                                                   
                                                      ∂
                                                      
                                                         η
                                                         t
                                                      
                                                   
                                                   
                                                      ∂
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   y
                                                   t
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                +
                                                x
                                                
                                                   
                                                      ∂
                                                      
                                                         y
                                                         t
                                                      
                                                   
                                                   
                                                      ∂
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Remarkably, we notice (see Figs. 3 and 4) the same structure reported by the empirical analysis given in Liu (2010) when using the classical static covariance estimator 
                           
                              
                                 V
                                 ^
                              
                              s
                           
                         in the PCA methodology. We observe a substantial difference between the number of factors capable to explain the covariance structure of the yield and forward rate curves, especially when applied to the first-difference of the curves.

In Figs. 3 and 4, the estimates based on the standard sample covariance matrix 
                           
                              
                                 V
                                 ^
                              
                              s
                           
                         are highly biased for the forward rate curves. This can also be observed in the first-difference of the yield curves. We remarkable notice that both 
                           
                              
                                 V
                                 ^
                              
                              
                                 l
                                 r
                              
                              
                                 V
                                 K
                              
                           
                         and 
                           
                              
                                 V
                                 ^
                              
                              
                                 l
                                 r
                              
                              
                                 U
                                 A
                                 (
                                 p
                                 )
                              
                           
                         estimate the correct number of factors, especially when computed on the first-difference of the forward rate curves in which the contamination is more problematic. The 
                           
                              
                                 V
                                 ^
                              
                              
                                 l
                                 r
                              
                              A
                           
                         estimator still indicate an excessive number of factors for the forward rate curves.


                        Fig. 4 reports one typical situation of MME founded in practice. One should notice that the presence of additive IID Gaussian measurement errors in the observed yield curve does not affect the PCA estimation. Neither the usual sample static covariance matrix 
                           
                              
                                 V
                                 ^
                              
                              s
                           
                         nor 
                           
                              
                                 V
                                 ^
                              
                              
                                 l
                                 r
                              
                              A
                           
                        , 
                           
                              
                                 V
                                 ^
                              
                              
                                 l
                                 r
                              
                              
                                 V
                                 K
                              
                           
                         and 
                           
                              
                                 V
                                 ^
                              
                              
                                 l
                                 r
                              
                              
                                 U
                                 A
                                 (
                                 p
                                 )
                              
                           
                         are affected by the presence of this type of error in the yield curve. In contrast, the estimates based on 
                           
                              
                                 V
                                 ^
                              
                              s
                           
                         for the forward rate and first-difference of the yield curves are clearly biased. The situation is even worst when dealing with forward rate first-differences.

The explanation for the results reported in Figs. 3 and 4 lie in the following argument. We readily see the existence of MME in bond markets impacts differently forward rate and yield curves. In (6.4), the MME introduces a moving average structure with negative persistence into the forward rate curve due to the components 
                           
                              
                                 ∂
                                 
                                    y
                                    t
                                 
                              
                              
                                 ∂
                                 x
                              
                           
                         and 
                           
                              
                                 
                                    ∂
                                    
                                       η
                                       t
                                    
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           
                        . One should notice that the existence of a moving average error structure affects severally the usual estimators of the covariance matrix. See Müller (2007) and Vogelsang and Wagner (2013) for a discussion about this issue. In contrast, the MME in (6.3) only introduces an IID component into the observed yield curve process. This IID component does not affect the temporal dependence of the yield curve. The results reported in Figs. 1–4 show that the PCA methodology applied to forward rate curves is a very delicate issue because it might be subject to non-negligible observational errors due to MME. The presence of MME explains the large difference between the number of components indicated by the PCA method for yield and forward curves. This remark is particularly more evident when double differentiation of the underlying moving average process appears due to the first-difference of the observed forward rate curves in (6.4). The main reason to use LRCM estimators instead of the usual 
                           
                              
                                 V
                                 ^
                              
                              s
                           
                         is to handle these types of observational errors. In particular, our results strongly indicate the estimators 
                           
                              
                                 V
                                 ^
                              
                              
                                 l
                                 r
                              
                              K
                           
                         and 
                           
                              
                                 V
                                 ^
                              
                              
                                 l
                                 r
                              
                              
                                 U
                                 A
                                 (
                                 p
                                 )
                              
                           
                         have successfully filtered the MME in the PCA methodology.

Let us now treat the case of a non-additive error structure G(yt, ηt
                        ) due to interpolation of the yield curve yt
                         as described in (A–B). Fig. 5 reports the PCA methodology applied to

                           
                              (6.5)
                              
                                 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                            t
                                                         
                                                         
                                                            (
                                                            x
                                                            )
                                                         
                                                         =
                                                         G
                                                         
                                                            (
                                                            
                                                               y
                                                               t
                                                            
                                                            
                                                               (
                                                               x
                                                               )
                                                            
                                                            ,
                                                            
                                                               η
                                                               t
                                                            
                                                            
                                                               (
                                                               x
                                                               )
                                                            
                                                            )
                                                         
                                                         ;
                                                         
                                                         where
                                                         
                                                         G
                                                         
                                                         and
                                                         
                                                         η
                                                         
                                                         are
                                                         
                                                         generated
                                                         
                                                         by
                                                         
                                                         an
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         
                                                         IES
                                                         
                                                         induced
                                                         
                                                         by
                                                         
                                                         a
                                                         
                                                         cubic
                                                         
                                                         splines
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                               t
                                                            
                                                            
                                                               (
                                                               x
                                                               )
                                                            
                                                            =
                                                            
                                                               Z
                                                               t
                                                            
                                                            
                                                               (
                                                               x
                                                               )
                                                            
                                                            +
                                                            x
                                                            
                                                               
                                                                  ∂
                                                                  
                                                                     Z
                                                                     t
                                                                  
                                                               
                                                               
                                                                  ∂
                                                                  x
                                                               
                                                            
                                                            
                                                               (
                                                               x
                                                               )
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where y is given by the CIR model as specified above. In this analysis, the error is generated by the classical spline method of McCulloch (1975). We simulate bond prices generated by the CIR model and we omit prices for four maturities randomly chosen, generating again 1,000 replications for this experiment. The omitted prices are then interpolated by cubic spline using the price curve, similar to the method of McCulloch (1975). Hence, observational errors for bond prices are then generated by means of interpolation. From these prices, we generate yield and forward rate interpolated curves. The PCA method based on the estimators of Section 5 is then applied to 
                           
                              (
                              Z
                              ,
                              X
                              ,
                              
                                 Z
                                 ˜
                              
                              ,
                              
                                 X
                                 ˜
                              
                              )
                           
                         as specified in (6.5).

In Fig. 5, the observational errors generated by the cubic splines do not significantly affect the number of factors in yield curves neither in level nor first-difference. However, it has again a nontrivial impact on the forward rate first-difference 
                           
                              X
                              ˜
                           
                        . The number of factors of 
                           
                              X
                              ˜
                           
                         computed by the PCA based on 
                           
                              
                                 V
                                 ^
                              
                              s
                           
                         and 
                           
                              
                                 V
                                 ^
                              
                              
                                 l
                                 r
                              
                              A
                           
                         is not correctly estimated. The standard PCA method based on 
                           
                              
                                 V
                                 ^
                              
                              s
                           
                         indicates the incorrect number of six factors which explain 99 percent of total variance. Similar to the analysis of MME given in Figs. 3 and 4, the PCA based on 
                           
                              
                                 V
                                 ^
                              
                              
                                 l
                                 r
                              
                              
                                 V
                                 K
                              
                           
                         and 
                           
                              
                                 V
                                 ^
                              
                              
                                 l
                                 r
                              
                              
                                 U
                                 A
                                 (
                                 p
                                 )
                              
                           
                         again correctly estimates the true number of three factors.

The results obtained from these experiments show that the presence of observational errors generated by MME or IES induces a significant bias in the classical PCA methodology applied to forward rate curves. More importantly, our analysis shows that the LRCM estimators (
                           
                              
                                 
                                    V
                                    ^
                                 
                                 
                                    l
                                    r
                                 
                                 
                                    V
                                    K
                                 
                              
                              ,
                              
                                 
                                    V
                                    ^
                                 
                                 
                                    l
                                    r
                                 
                                 
                                    U
                                    A
                                    (
                                    p
                                    )
                                 
                              
                           
                        ) indicate the correct number of factors in the Monte Carlo experiments. The results of this section are robust w.r.t to the model specification and types of observational errors.

In this section, we compare the results described in Section 6 with a PCA application to two distinct real data sets. The first one is given by Treasury bonds (zero coupon) with maturities 3, 6, 9, 12, 15, 18, 21, 24, 30, 36, 48, 60, 72, 90, 108 and 120 months (17 maturities), with monthly observations ranging from 1985 January to 2000 December. This data set is constructed based on the Fama–Bliss methodology (unsmoothed Fama–Bliss) and it was already used by Diebold and Li (2006). The second data set is the UK term-structure obtained from the Bank of England with maturities .5 to 25 years (50 maturities) and daily data ranging from 4 January 2005 to 29 February 2012 summing 1872 observations.

In Figs. 6
                      and 7
                     , we report the cumulative R
                     2 obtained from the PCA decomposition for the forward rate and yield curves of the U. S. and U. K. markets, respectively. The usual static covariance matrix estimator 
                        
                           
                              V
                              ^
                           
                           s
                        
                      applied to these two data sets shows the same behavior as described by Liu (2010). We observe a large difference in the number of principal components between yield and forward rate curves, both in the first-difference and level. In particular, we observe the same type of behavior as described in Section 6. More importantly, we notice that both estimators 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              V
                              K
                           
                        
                      and 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              U
                              A
                              (
                              p
                              )
                           
                        
                      indicate the same number of factors between yield and forward rate curves. This result holds for both the first-difference and the level of the curves. More importantly, it corroborates with our findings in Fig. 4.

According to Proposition 4.1, these results strongly suggest the presence of contamination errors in the data. In the US data, the error contamination might be explained by the Fama–Bliss method of construction of the forward rate curve (Fama & Bliss, 1987) which uses a piecewise constant function to approximate the discount factor. The Bank of England term structure is constructed by means of a smooth cubic spline interpolation method for the yield and forward rate curves (see e.g (Anderson & Sleath, 2001) for details). Therefore, it is subject to observational errors similar to the Monte Carlo experiment (6.5) in Fig. 5. The presence of MME in the U.S. data might also be a source of observational errors as reported by Goyenko and Ukhov (2011) and Mizrach and Neely (2011). The reader is urged to compare the Monte Carlo experiments (6.4) and (6.5) to Figs. 6 and 7, respectively. The empirical analysis of this section jointly with Section 6 and Proposition 4.1 give strong support for the use of PCA based on the LRCM estimators described in Section 5.

In Section 6, we study the impact of noisy data in the PCA methodology. In Section 7, we report the existence of nontrivial measurement errors in forward rate markets. In this section, the primary goal is to illustrate the importance of a correct spectral analysis in noisy forward rate curves. The example we choose to illustrate this point is the pricing of interest rate derivatives in the presence of noisy data. We study the impact of observational errors in pricing interest rate derivatives by means of the PCA methodology. More precisely, we compare the pricing error of the PCA methodology based on 
                        
                           
                              V
                              ^
                           
                           s
                        
                      against the LRCM estimators.

Similar to Mercurio and Moraleda (2000), we consider a vanilla-type call option based on a zero coupon bond with 10 years maturity, with time to maturities of .25, .5 and 1 years, and distinct strike prices. The underlying data generating process is specified by a 2-factor Hull–White (g2++) model (see e.g. pp. 356–364 in Nawalkha, Believa, & Soto, 2007) which yields an analytic pricing formula for vanilla options written on a zero coupon bond. This model is affine whose correspondent forward rate volatility function is given by

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          V
                                          o
                                          l
                                          [
                                          d
                                          f
                                          (
                                          t
                                          ,
                                          T
                                          )
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          =
                                          
                                             
                                                
                                                   ν
                                                   
                                                      1
                                                   
                                                   2
                                                
                                                
                                                   e
                                                   
                                                      −
                                                      
                                                         κ
                                                         1
                                                      
                                                      
                                                         (
                                                         T
                                                         −
                                                         t
                                                         )
                                                      
                                                   
                                                
                                                +
                                                
                                                   ν
                                                   
                                                      2
                                                   
                                                   2
                                                
                                                
                                                   e
                                                   
                                                      −
                                                      
                                                         κ
                                                         2
                                                      
                                                      
                                                         (
                                                         T
                                                         −
                                                         t
                                                         )
                                                      
                                                   
                                                
                                                +
                                                2
                                                
                                                   ν
                                                   1
                                                
                                                
                                                   ν
                                                   2
                                                
                                                
                                                   ρ
                                                   12
                                                
                                                
                                                   e
                                                   
                                                      −
                                                      
                                                         (
                                                         
                                                            κ
                                                            1
                                                         
                                                         +
                                                         
                                                            κ
                                                            2
                                                         
                                                         )
                                                      
                                                      
                                                         (
                                                         T
                                                         −
                                                         t
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          0
                                          ≤
                                          t
                                          ≤
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where the parameters ν = (ν
                     1, ν
                     2), κ = (κ
                     1, κ
                     2) and ρ
                     12 encode variance, persistence and correlation among Ornstein-Uhlenbeck-type factors, respectively. The payoff of interest is given by

                        
                           
                              
                                 
                                    V
                                    
                                       T
                                       0
                                    
                                 
                                 :
                                 =
                                 max
                                 
                                    {
                                    P
                                    (
                                    
                                       T
                                       0
                                    
                                    ,
                                    T
                                    )
                                    −
                                    K
                                    ,
                                    0
                                    }
                                 
                              
                           
                        
                     for some T
                     0 < T, where T is the time of exercising the payoff 
                        
                           V
                           
                              T
                              0
                           
                        
                     . The Gaussian structure of the 2-factor Hull–White model yields a closed form expression for the price 
                        
                           
                              C
                              0
                           
                           
                              (
                              
                                 T
                                 0
                              
                              ,
                              T
                              )
                           
                        
                      of 
                        
                           V
                           
                              T
                              0
                           
                        
                      as follows:

                        
                           
                              
                                 
                                    C
                                    0
                                 
                                 
                                    (
                                    
                                       T
                                       0
                                    
                                    ,
                                    T
                                    )
                                 
                                 =
                                 P
                                 
                                    (
                                    0
                                    ,
                                    T
                                    )
                                 
                                 Φ
                                 
                                    (
                                    
                                       d
                                       +
                                    
                                    )
                                 
                                 −
                                 P
                                 
                                    (
                                    0
                                    ,
                                    
                                       T
                                       0
                                    
                                    )
                                 
                                 Φ
                                 
                                    (
                                    
                                       d
                                       −
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     where Φ is the Gaussian cumulative distribution function, 
                        
                           
                              d
                              ±
                           
                           :
                           =
                           
                              
                                 l
                                 n
                                 
                                    
                                       P
                                       (
                                       0
                                       ,
                                       T
                                       )
                                    
                                    
                                       K
                                       P
                                       (
                                       0
                                       ,
                                       
                                          T
                                          0
                                       
                                       )
                                    
                                 
                                 ±
                                 
                                    v
                                    2
                                 
                              
                              
                                 v
                              
                           
                        
                      and v is the integrated volatility between [T
                     0, T] which follows equation (4.41) in Andersen and Piterbarg (2010), p. 185.

We construct the interest rate curves with maturities 3, 6, 9, 12, 15, 18, 21, 24, 30, 36, 40, 60, 72, 90, 108 and 120 months with delta of order 1/252 (daily data) between each curve observation. In order to verify the robustness of our results, we perform a Monte Carlo study with three distinct sets of parameters – the first one consists of κ
                     1 = .8, κ
                     2 = .7, ν
                     1 = .1, ν
                     2 = .1 and ρ
                     12 = −.3, the second one κ
                     1 = .9, κ
                     2 = .85, ν
                     1 = .1, ν
                     2 = .2 and ρ
                     12 = −.3, and the third one κ
                     1 = .5, κ
                     2 = .80, ν
                     1 = .25, ν
                     2 = .15 and ρ
                     12 = .3. The parameters are chosen to reproduce the patterns observed in yield curves typically found in interest rate markets. More precisely, we have chosen sets of parameters in such way to reproduce typical components of levels, slopes and curvatures with not too high or low interest rates typically found in fixed-income markets. In particular, the choice of parameters covers a wide range set of possibilities for persistence κi
                     , variances νi
                      and correlation between latent factors ρ
                     12.

The Monte Carlo experiments are based on the observational process Z = y + η, where y is the correspondent yield curve process specified by the above 2-factor Hull–White model and η is zero or an IID zero mean Gaussian noise with variance .0035. The error is understood in terms of Mean Square Error (MSE)

                        
                           
                              
                                 M
                                 S
                                 E
                                 (
                                 P
                                 r
                                 i
                                 c
                                 
                                    e
                                    
                                       p
                                       c
                                       a
                                       (
                                       Z
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       T
                                       0
                                    
                                    ,
                                    T
                                    )
                                 
                                 ,
                                 
                                    C
                                    0
                                 
                                 
                                    (
                                    
                                       T
                                       0
                                    
                                    ,
                                    T
                                    )
                                 
                                 )
                              
                           
                        
                     where Price
                     
                        pca(Z)(T
                     0, T) is the price computed by means of the estimation of the integrated volatility v based on PCA as a function of the sample covariance matrix 
                        
                           
                              V
                              ^
                           
                           s
                        
                      and the LRCM 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           A
                        
                     , 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              V
                              K
                           
                        
                      and 
                        
                           
                              V
                              ^
                           
                           
                              U
                              A
                              
                                 
                                    (
                                    p
                                    )
                                 
                                 
                                    l
                                    r
                                 
                              
                           
                        
                     , given, respectively, by formulas (5.1)–(5.3).


                     Table 1 reports the Mean Square Error pricing with the first set of parameters, based on a sample size of 250 observations and without measurement errors (η = 0). The PCA pricing using the sample covariance matrix 
                        
                           
                              V
                              ^
                           
                           s
                        
                      and the estimators 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           A
                        
                      and 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              U
                              A
                              (
                              p
                              )
                           
                        
                      presents similar results in terms of pricing errors, while the 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              V
                              K
                           
                        
                      estimator achieves the best results
                        2
                     
                     
                        2
                        We also perform the same analysis for the other sets of parameters without measurement errors. The results are similar to the first set of parameters.
                     . This can be explained by the excellent finite sample properties of 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              V
                              K
                           
                        
                      compared to the other estimators. See Kiefer and Vogelsang (2005, 2002) for further details.

The results reported in Tables 2–4 suggest that the pricing of interest rate derivatives based on PCA with sample covariance matrix 
                        
                           
                              V
                              ^
                           
                           s
                        
                      is sensitive to observational errors. The simulation results are robust w.r.t the choice of parameters. Clearly, the pricing based on the LRCM estimators 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           A
                        
                     , 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              V
                              K
                           
                        
                      and 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              U
                              A
                              (
                              p
                              )
                           
                        
                      presents better performance. We clearly observe smaller Mean Squared Errors for all strikes and time to maturities, in all parameters settings analyzed. This restates the validity and relevance of the corrections w.r.t the estimation of the covariance matrix in the PCA methodology.

The estimator 
                        
                           
                              V
                              ^
                           
                           
                              l
                              r
                           
                           
                              V
                              K
                           
                        
                      presents the best performance among the methods discussed in Section 5. This result is particularly important because it is the simplest one to implement where no bandwidth parameter estimation is needed. These results strongly suggest that neglecting the underlying dependence structure generated by observational errors may degenerate significantly the pricing of interest rate derivatives. We also present in Table 5
                     
                     
                     
                     
                      the experiment with the first parameter set and with contaminations errors, but now using a sample of 1,000 observations. The results are similar to Tables 2 and 3. The Monte Carlo experiment of this section is robust w.r.t sample size and parameters.

                        Remark 8.1
                        
                           Sections 6 and 8 indicate that the estimation method for long-run covariance matrices based on Kiefer and Vogelsang (2005, 2002) present the best results. Moreover, we stress the methodology proposed by Kiefer and Vogelsang (2002) based on Bartlett kernels does not depend on the estimation of parameters of truncation and bandwidth rules. So that it is much simpler to implement than the methods developed by Andrews (1991) and Müller (2007). Therefore, from a practical point of view, our results strongly suggest the use of the methodology proposed by Kiefer and Vogelsang (2002, 2005) when applying PCA in forward rate curves. This statement is justified by the performance of the estimator 
                              
                                 
                                    V
                                    ^
                                 
                                 
                                    l
                                    r
                                 
                                 
                                    V
                                    K
                                 
                              
                            together with its robustness w.r.t model and sets of parameters used in the simulations reported in Sections 6 and 8.

In this article, we discuss some important methodological aspects of the principal component analysis applied to the fundamental object of the forward rate curves. The contributions of this paper are threefold. At first, our results strongly suggest the classical PCA method based on the standard sample covariance matrix is not suitable for estimating factors of forward rate curves due to the inherent presence of measurement errors in the market. Second, we give a sound explanation for the different spectral structures between forward rate and yield curves reported in the empirical literature over the last years (see Section 2). Last, we demonstrate that an alternative methodology based on LRCM-type estimators seems to correct the bias induced by microstructure effects and interpolation procedures.

Our conclusion is supported by the following results presented in this paper. Proposition 4.1 proves that the number of principal components of the observed forward rate and yield curves must be identical in the absence of measurement errors. Based on this fact, we perform a detailed simulation analysis in three prominent interest rate models with a number of distinct parameters in the presence of observational errors of various magnitudes and forms. Market microstructure effects and interpolation errors due to extraction of forward rates from yield curves are carefully analyzed. The results clearly indicate a considerable bias in the classical PCA methodology applied to forward rate curves. In contrast, Monte Carlo experiments jointly with empirical analysis strongly suggest that PCA based on LRCM estimators is robust w.r.t. measurement errors in forward rate curves. The presence of observational errors in forward rate markets is validated by Proposition 4.1 together with a detailed empirical analysis on the number of principal components in the UK and US interest rate markets. Monte Carlo experiments reports that classical PCA based on static sample covariance matrices presents nontrivial pricing errors for European call options. In contrast, the use of LRCM estimators seems to correct this bias.

The results of this article have a direct consequence on the literature about calibration of HJM models. In this case, initial forward rate curves and the volatility completely determine the evolution of arbitrage free prices (see e.g Heath et al., 1992). Our results indicate that one has to incorporate corrections in the spectral analysis in order to recover the true forward rate covariance structure. This conclusion has also major importance in more general contexts (see e.g. Bermin, 2014; Ohashi, & Simas, 2015; Richter & Teichmann, 2014) than Gaussian HJM models as illustrated in this article. In general, implied forward rates from yield curves may contain non-trivial measurement errors which may lead to inconsistent estimates.

Hedging based on the PCA methodology is one of the most common techniques used by institutional investors. In particular, an incorrect spectral analysis of the forward rate curves may lead to poor hedging strategies based on the PCA methodology. It has been reported by Carcano (2009) and Carcano and Dall’O (2011) that more refined hedging strategies based on PCA methodology substantially improve yield curve risk management. By linearity, the same holds true for forward rate curves. Our results suggest that PCA hedging strategies based on forward rate curves must incorporate suitable corrections in the spirit of LRCM estimators.

The analysis performed in this article can be improved in several ways. A first extension is the development of statistical tests to determine the optimal number of factors (see e.g. (Bai & Ng, 2002)) in the PCA decomposition based on long-run covariance matrix estimators. One can formulate those tests by using an eigenvalue ratio test (Ahn &, 2013) based on long-run covariance matrix estimators. We stress that hypothesis testing based on fixed bandwidth estimators presents better performance in terms of size and power compared to standard procedures based on e.g. chi-square distributions. See e.g. Sun (2014) for further details. A second extension is the investigation of more general types of dependence structures (e.g. nonlinear dependence). Third, the case when the data generating process follows stochastic volatility (Trolle & Schwartz, 2009) or time-inhomogeneous interest rate models with time-dependent parameters will be important to infer the applicability of long-run covariance matrices in forward rate markets. Time series forecasting (see e.g. Stock & Watson, 2006) is also a topic which deserves a further analysis.

We would like to point out that the covariance matrix is not the most correct statistical object to infer correlation in possibly infinite-dimensional continuous-time stochastic systems. This is the case of the classical HJM framework formulated in full generality. The classical PCA methodology does not explain correlation in generic high-dimensional semimartingale models of type (1.2). Covariance does not describe the fine correlation structure in random fields driven by continuous time semimartingales. Instead, what one really needs to recover is the underlying quadratic variation matrix 
                           
                              {
                              
                                 
                                    [
                                    r
                                    
                                       (
                                       u
                                       )
                                    
                                    ,
                                    r
                                    
                                       (
                                       v
                                       )
                                    
                                    ]
                                 
                                 T
                              
                              ;
                              u
                              ,
                              v
                              ∈
                              
                                 R
                                 +
                              
                              }
                           
                         (see e.g. Bibinger, Hautsch, Malec, & Reiss, 2014) and orthogonal directions to that. Unfortunately, to our best knowledge, there is no satisfactory theory handling such cases. Therefore, future research should set out to address these limitations, extending our study. In order to treat correlation for generic forward rate models, a more general spectral analysis based on the existence of affine invariant manifolds of type (2.1) has been introduced in the accompanying paper by Ohashi and Simas (2015). This would be the first step to retrieve all the relevant spectral components of forward rate curves.

@&#ACKNOWLEDGMENTS@&#

We would like to thank Josef Teichmann for stimulating discussions on the topic of this paper. The first author was supported by CNPq and Fapesp and second author by CNPq grant 308742.

@&#REFERENCES@&#

