@&#MAIN-TITLE@&#Sparse and robust normal and t- portfolios by penalized Lq-likelihood minimization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a methodology based on the minimization of a description length criterion.


                        
                        
                           
                           We propose a re-weighting algorithm to compute sparse and robust portfolios.


                        
                        
                           
                           Validation on simulated and real-world financial data support our method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Investment analysis

Penalized least squares




                     q-entropy

Sparsity

Index tracking

@&#ABSTRACT@&#


               
               
                  Two important problems arising in traditional asset allocation methods are the sensitivity to estimation error of portfolio weights and the high dimensionality of the set of candidate assets. In this paper, we address both issues by proposing a new criterion for portfolio selection. The new criterion is a two-stage description of the available information, where the q-entropy, a generalized measure of information, is used to code the uncertainty of the data given the parametric model and the uncertainty related to the model choice. The information about the model is coded in terms of a prior distribution that promotes asset weights sparsity. Our approach carries out model selection and estimation in a single step, by selecting a few assets and estimating their portfolio weights simultaneously. The resulting portfolios are doubly robust, in the sense that they can tolerate deviations from both assumed data model and prior distribution for model parameters. Empirical results on simulated and real-world data support the validity of our approach.
               
            

@&#INTRODUCTION@&#

Asset allocation aims to determine an optimal portfolio from a large set of assets based on their performance and diversification. Typically, portfolio managers want to set up portfolios with optimal risk-return properties, along the lines of the mean-variance framework (i.e. multi-objective portfolio optimization), or which closely track an index (i.e. index tracking) by investing in a small number of assets, thereby limiting their transaction and monitoring costs. It is known, however, that the performance of optimal portfolios largely affected by the uncertainty about the model parameters and the data distribution, which is traditionally assumed to be Gaussian (Frost & Savarino, 1988; Markowitz, 1952; Merton, 1980; Michaud, 1989). Portfolio weights are very sensitive to errors for the model parameter estimates induced by model misspecification (Best & Grauer, 1991; Jagannathan & Ma, 2003); for example, even a small change in the covariance and mean estimates of the multivariate Gaussian model might cause substantial changes in the optimal portfolio asset allocations (De Miguel & Nogales, 2009). As a result, the out-of-sample performance of the portfolio is often unsatisfactory when compared to the in-sample performance. The effect of estimation bias is frequently enhanced by the large pool of candidate assets and by the strong correlation between asset returns. In addition, financial data are leptokurtic and contaminated by outliers (Cont, 2001). The misspecification of the underlying Gaussian distribution causes then imprecise estimates, if deviations from the assumed model are not appropriately addressed.

To deal with these issues, two distinct classes of statistical methods have become increasingly popular in the financial literature. To achieve robust estimation of model parameters, various robust procedures to estimate the covariance matrix have been proposed (De Miguel & Nogales, 2009; Kolm, Tütüncü, & Fabozzi, 2014; Ledoit & Wolf, 2004; Vaz de Melo & Camara, 2005; Welsch & Zhou, 2007). Previous work (Ferrari & Paterlini, 2010), focusing only on minimizing an empirical version of the q-entropy in a mean-variance framework under normality, showed the advantages of using an estimator that can deal with the discrepancy between the data and the assumed model. To achieve sparse portfolios with a relatively small number of assets corresponding to active (i.e. non-zero) weights from a large pool of assets, several authors have advocated the use of penalized least squares methods. For instance, the least absolute shrinkage and selector operator (Lasso) (Tibshirani, 1996) has proved to be very useful in asset allocation since it not only increases the stability of portfolio weights, but also enforces sparse solutions by imposing a penalty on the asset weights (Carrasco & Noumon, 2012; De Miguel, Garlappi, Nogales, & Uppal, 2009; De Mol, Giannone, & Reichlin, 2008; Fan, Zhang, & Yu, 2012).

Considering the stylized facts of financial data (Cont, 2001) and the high-dimensionality of the index tracking problem, our main target is to obtain well-tracking and sparse solutions: portfolios with few active weights that replicate as closely as possible a given index or benchmark. Then, we introduce a new class of algorithms for portfolio selection, which merges the strengths of both, robust and penalized estimation methods. So far, only the robust properties of a q-entropy estimator under normality in a mean-variance framework had been investigated (Ferrari & Paterlini, 2010). Here, instead our approach involves the minimization of a description length criterion that accounts for the uncertainty about the data as well as that related to the parametric model structure. Both sources of uncertainty are coded in terms of the q-entropy, a generalized information measure introduced by Havrda and Charvát (1967) and studied by Tsallis (1988) in statistical mechanics. The q-entropy coding ensures double robustness by protecting against two sources of model misspecification: (i) it down-weights observations that diverge from the data model assumed for the assets; (ii) it mitigates the effect of parameter estimates that are far from the assumed prior structure for the parameters. The overall behavior of our criterion-function depends on a tuning parameter q, which controls the trade-off between the statistical accuracy and the stability of estimates (Ferrari & La Vecchia, 2012). When q → 1 our procedure is equivalent to maximum a posteriori estimation of the parameters, yielding optimal statistical efficiency but scarce robustness; values of q < 1 yield instead robust estimates with negligible loss of efficiency. Importantly, our approach tackles for the first time the model selection and estimation in a single step by identifying optimal tracking portfolios with few active positions by means of a penalty function on the asset weights, with size depending on a regularization parameter λ. Larger penalty values imply portfolios with a relatively small number of assets. The solution to the new criterion can be efficiently solved by iterative algorithms that we develop in the paper.

The remainder of the paper is structured as follows: in Section 2, we describe the general methodology based on the two-stage description length minimization framework. In Section 3, we propose an efficient re-weighting algorithm to compute optimal portfolios. In the same section, we also focus on two important cases, when the portfolio returns are assumed to follow a normal or a t- distribution, while the prior structure on the parameters is coded by a Laplace distribution. In Section 4, we compare the performance of our method by Monte Carlo simulation with other benchmark approaches. In Section 5, we illustrate our index tracking method by considering real-world data. Section 6 concludes the paper.

Let 
                           
                              X
                              =
                              
                                 
                                    (
                                    
                                       X
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       X
                                       p
                                    
                                    )
                                 
                                 ′
                              
                           
                         be a vector of p assets returns measured over a fixed period (e.g. one day) which are assumed to follow some unknown multivariate distribution. A financial portfolio return, can then be defined by the linear combination 
                           X
                        ′
                           β
                        , where 
                           
                              
                                 β
                              
                              =
                              
                                 
                                    (
                                    
                                       β
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       β
                                       p
                                    
                                    )
                                 
                                 ′
                              
                              ∈
                              
                                 R
                                 p
                              
                           
                         is a vector of constants playing the role of asset allocation weights. Our main aim is to choose the asset weights 
                           β
                         to track as closely as possible a target market index return, Y. Define 
                           
                              Z
                              =
                              (
                              Y
                              −
                              
                                 
                                    X
                                 
                                 ′
                              
                              
                                 β
                              
                              )
                              /
                              σ
                           
                         and assume that it has probability distribution G(z) and probability density function (pdf) g(z), with 
                           
                              
                                 E
                                 G
                              
                              
                                 (
                                 Z
                                 )
                              
                              =
                              0
                           
                        . Instead of the random target market index return, we allow specifying a fixed target, say y
                        *. This is interpreted as a degenerate random variable with single mass point on y
                        *. To emphasize possible model misspecifications we distinguish between the true (unknown) density g(z), and the model density f(z). The latter is an user-specified model chosen to represent the data which does not necessarily coincide with the true density g. For example, f may be the standard normal distribution or the t- distribution with ν degrees of freedom or any other suitable parametric model for financial data. Although σ can be regarded as fixed, we typically estimate both σ and 
                           β
                        .

Given observation pairs 
                           
                              {
                              
                                 (
                                 
                                    y
                                    i
                                 
                                 ,
                                 
                                    x
                                    i
                                 
                                 )
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                         at time i, of the target index Y and p-dimensional vector 
                           X
                         of assets over n time periods, we compute the portfolio weights, 
                           
                              
                                 
                                    
                                       β
                                    
                                    ^
                                 
                                 
                                    q
                                    ,
                                    λ
                                 
                              
                              ,
                           
                         by maximizing the following two-stage description length, or generalized description length (GDL) criterion:

                           
                              (1)
                              
                                 
                                    
                                       
                                          D
                                          ^
                                       
                                       
                                          q
                                          ,
                                          λ
                                       
                                    
                                    
                                       (
                                       
                                          β
                                       
                                       ,
                                       σ
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       L
                                       q
                                    
                                    
                                       {
                                       f
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      y
                                                      i
                                                   
                                                   −
                                                   
                                                      x
                                                      i
                                                      ′
                                                   
                                                   
                                                      β
                                                   
                                                
                                                σ
                                             
                                          
                                          )
                                       
                                       }
                                    
                                    +
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       L
                                       q
                                    
                                    
                                       {
                                       h
                                       (
                                       
                                          β
                                          j
                                       
                                       ;
                                       λ
                                       )
                                       }
                                    
                                    ,
                                 
                              
                           
                        for fixed tuning constants λ ≥ 0 and q ≤ 1. In (1), Lq
                        (·) is the generalized q-logarithm

                           
                              (2)
                              
                                 
                                    
                                       L
                                       q
                                    
                                    
                                       (
                                       a
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      a
                                                      
                                                         1
                                                         −
                                                         q
                                                      
                                                   
                                                   −
                                                   1
                                                   )
                                                   /
                                                   
                                                      (
                                                      1
                                                      −
                                                      q
                                                      )
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   q
                                                   ≠
                                                   1
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   log
                                                   (
                                                   a
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   q
                                                   =
                                                   1
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and h(β; λ) is a univariate symmetric density function with zero mean with scale parameter λ.

Criterion (1) is regarded as a two-stage description of the total information. The first sum in (1) is a goodness-of-fit measure: it describes the information provided by the data given a nominal model f indexed by 
                           β
                         and σ. When q → 1, Lq
                        (·) → log (·), so the first term in (1) coincides with the usual log-likelihood function. The second sum, 
                           
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 p
                              
                              
                                 L
                                 q
                              
                              
                                 {
                                 h
                                 
                                    (
                                    
                                       β
                                       j
                                    
                                    ;
                                    λ
                                    )
                                 
                                 }
                              
                              ,
                           
                         is a penalty term describing the information about the model structure itself and involves user-specified densities h(βj
                        ; λ), 
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              p
                           
                        . Such a penalty term drives the model selection step and leads to sparse optimal solutions by forcing to zero the components in the observed portfolios 
                           
                              
                                 x
                                 i
                                 ′
                              
                              
                                 β
                              
                              ,
                           
                        
                        
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                         that are not much helpful in explaining the target values yi
                        , 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                        . To gain more insight on criterion (1), it is helpful to consider the case where q → 1, which implies Lq
                        (·) → log (·) and

                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   ^
                                                
                                                
                                                   q
                                                   ,
                                                   λ
                                                
                                             
                                             
                                                (
                                                
                                                   β
                                                
                                                ,
                                                σ
                                                )
                                             
                                             →
                                             log
                                             
                                                {
                                                
                                                   ∏
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                f
                                                
                                                   (
                                                   
                                                      σ
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         i
                                                      
                                                      −
                                                      
                                                         x
                                                         i
                                                         ′
                                                      
                                                      
                                                         β
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   ∏
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   p
                                                
                                                h
                                                
                                                   (
                                                   
                                                      β
                                                      j
                                                   
                                                   ;
                                                   λ
                                                   )
                                                
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This shows that when q is near 1, minimization of (1) is equivalent to maximum a posteriori (MAP) estimation of 
                           β
                        , where h(βj
                        ; λ) plays the role of prior density function for βj
                        .

Different probability density functions could be chosen as penalty functions h(βj
                        ; λ). For example, Fig. 1
                         (left) shows Lq
                        (h(β; λ)) for a single coefficient βj
                         when h(· ; ·) is a Normal, a Laplace or a Double Pareto density with 
                           
                              q
                              =
                              1
                              /
                              2
                           
                         and 
                           
                              λ
                              =
                              1
                           
                        . When comparing the Laplace with the Double Pareto distribution, we notice that the former yields weaker penalties when βj
                         is close to zero and much stronger when βj
                         moves further away from zero. In this paper, we focus on considering penalties based on the Laplace as penalty function, but the model can be easily extended to include other penalty functions without requiring any algorithmic modification. Fig. 1 (right) shows the effect of increasing the value of λ in the Laplace penalty of the β coefficients. The parameter λ controls for the size of h(βj
                        ; λ): increasing the λ value leads then to identify optimal solutions with a smaller number of active β coefficients. Note that for many choices of h, our penalty function has the property of being non-convex. This aspect is important to deal with the shortcoming of the convex Lasso penalty, which is known to produce biased estimates for large (absolute) coefficients (Fan & Li, 2001; Zou, 2006). As a solution, various authors proposed using penalties that are singular at the origin (just like the ℓ1-penalty) in order to promote sparsity, but non-convex, in order to countervail bias (see Gasso, Rakotomamonjy, and Canu (2009) for a discussion of benefits of using non-convex penalties).

Differentiating the criterion function (1) with respect to parameters (
                           β
                        , σ)′ gives 
                           
                              (
                              p
                              +
                              1
                              )
                           
                         estimating equations, which can be written as follows using vector notation

                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                             =
                                             
                                             ∇
                                             
                                                
                                                   D
                                                   ^
                                                
                                                
                                                   q
                                                   ,
                                                   λ
                                                
                                             
                                             
                                                (
                                                
                                                   β
                                                
                                                ,
                                                σ
                                                )
                                             
                                             
                                             =
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             f
                                             
                                                
                                                   (
                                                   
                                                      z
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   1
                                                   −
                                                   q
                                                
                                             
                                             
                                                
                                                   
                                                      ∇
                                                      f
                                                      
                                                         (
                                                         
                                                            z
                                                            i
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         (
                                                         
                                                            z
                                                            i
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                             +
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                p
                                             
                                             h
                                             
                                                
                                                   (
                                                   
                                                      β
                                                      j
                                                   
                                                   ;
                                                   λ
                                                   )
                                                
                                                
                                                   1
                                                   −
                                                   q
                                                
                                             
                                             
                                                
                                                   
                                                      ∇
                                                      h
                                                      (
                                                      
                                                         β
                                                         j
                                                      
                                                      ;
                                                      λ
                                                      )
                                                   
                                                   
                                                      h
                                                      (
                                                      
                                                         β
                                                         j
                                                      
                                                      ;
                                                      λ
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 z
                                 i
                              
                              =
                              
                                 (
                                 
                                    y
                                    i
                                 
                                 −
                                 
                                    x
                                    i
                                    ′
                                 
                                 
                                    β
                                 
                                 )
                              
                              /
                              σ
                           
                         and “∇” denotes the gradient operator, so that 
                           
                              ∇
                              
                                 
                                    D
                                    ^
                                 
                                 
                                    q
                                    ,
                                    λ
                                 
                              
                              
                                 (
                                 
                                    β
                                 
                                 ,
                                 σ
                                 )
                              
                           
                         is a 
                           
                              (
                              p
                              +
                              1
                              )
                           
                        -vector of derivatives with respect to the elements of the parameter vector (
                           β
                        , σ)′. Next, we introduce some notations by re-writing the estimating equations as

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                w
                                                
                                                   q
                                                   ,
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   β
                                                
                                                ,
                                                σ
                                                )
                                             
                                             u
                                             
                                                (
                                                
                                                   y
                                                   i
                                                
                                                ,
                                                
                                                   x
                                                   i
                                                
                                                ,
                                                
                                                   β
                                                
                                                ,
                                                σ
                                                )
                                             
                                             +
                                             
                                                h
                                                λ
                                                ′
                                             
                                             
                                                (
                                                
                                                   β
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              u
                              
                                 (
                                 
                                    x
                                    i
                                 
                                 ,
                                 
                                    β
                                 
                                 ,
                                 σ
                                 )
                              
                              =
                              ∇
                              log
                              f
                              
                                 (
                                 
                                    σ
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       y
                                       i
                                    
                                    −
                                    
                                       x
                                       i
                                       ′
                                    
                                    
                                       β
                                    
                                    )
                                 
                                 )
                              
                           
                         is the likelihood score vector with 
                           
                              (
                              p
                              +
                              1
                              )
                           
                         elements and

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                                
                                                   q
                                                   ,
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   β
                                                
                                                ,
                                                σ
                                                )
                                             
                                          
                                       
                                       
                                          
                                             =
                                             f
                                             
                                                
                                                   (
                                                   
                                                      σ
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         i
                                                      
                                                      −
                                                      
                                                         x
                                                         i
                                                         ′
                                                      
                                                      
                                                         β
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   1
                                                   −
                                                   q
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        is a scalar data-dependent weight for the ith score. The term 
                           
                              
                                 h
                                 λ
                                 ′
                              
                              
                                 (
                                 
                                    β
                                 
                                 )
                              
                           
                         in (5) denotes the 
                           
                              (
                              p
                              +
                              1
                              )
                           
                        -vector of first derivatives with elements 
                           
                              
                                 
                                    {
                                    
                                       h
                                       λ
                                       ′
                                    
                                    
                                       (
                                       
                                          β
                                       
                                       )
                                    
                                    }
                                 
                                 j
                              
                              =
                              ∇
                              
                                 L
                                 q
                              
                              
                                 (
                                 h
                                 
                                    (
                                    
                                       β
                                       j
                                    
                                    ;
                                    λ
                                    )
                                 
                                 )
                              
                              =
                              
                                 v
                                 
                                    q
                                    ,
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       β
                                    
                                    j
                                 
                                 ,
                                 λ
                                 )
                              
                              s
                              
                                 (
                                 
                                    
                                       β
                                    
                                    j
                                 
                                 ,
                                 λ
                                 )
                              
                              ,
                           
                        
                        
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              p
                              ,
                           
                         and 
                           
                              
                                 
                                    {
                                    
                                       h
                                       λ
                                       ′
                                    
                                    
                                       (
                                       
                                          β
                                       
                                       )
                                    
                                    }
                                 
                                 
                                    p
                                    +
                                    1
                                 
                              
                              =
                              0
                              ,
                           
                         where

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             s
                                             
                                                (
                                                
                                                   
                                                      β
                                                   
                                                   j
                                                
                                                ,
                                                λ
                                                )
                                             
                                             =
                                             ∇
                                             log
                                             h
                                             
                                                (
                                                
                                                   β
                                                   j
                                                
                                                ;
                                                λ
                                                )
                                             
                                             ,
                                             
                                             
                                             
                                             
                                                v
                                                
                                                   q
                                                   ,
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      β
                                                   
                                                   j
                                                
                                                ,
                                                λ
                                                )
                                             
                                             =
                                             h
                                             
                                                
                                                   (
                                                   
                                                      β
                                                      j
                                                   
                                                   ;
                                                   λ
                                                   )
                                                
                                                
                                                   1
                                                   −
                                                   q
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        are the 
                           
                              (
                              p
                              +
                              1
                              )
                           
                        -dimensional prior score vector and scalar importance weight for βj
                        , respectively.

It is important to note that the above estimating equations imply a double weighting scheme which at once controls for the importance of observations x
                        
                           i
                        , 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                              ,
                           
                         and candidate coefficients βj
                        , 
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              p
                           
                        . For unusual observations incompatible with the model f, the relative importance of the score 
                           u
                        (x
                        
                           i
                        , 
                           β
                        , σ) is automatically reduced since the corresponding weights w
                        
                           q, i
                        (
                           β
                        , σ) are proportional to a power-transformation of the assumed density model f. Particularly when q < 1, w
                        
                           q, i
                         is typically small when the tracking distance 
                           
                              
                                 |
                              
                              
                                 y
                                 i
                              
                              −
                              
                                 x
                                 i
                                 ′
                              
                              
                                 
                                    β
                                 
                                 |
                                 /
                                 σ
                              
                           
                         is large. Therefore, linear combinations 
                           
                              
                                 x
                                 i
                                 ′
                              
                              
                                 β
                              
                           
                         occurring far away from the target yi
                         receive small weights. An analogous behavior is implied for the penalty term by the weights v
                        
                           q, j
                        (βj, λ), which are small if |βj
                        | are large. For instance, if 
                           
                              
                                 β
                                 j
                              
                              ∼
                              N
                              
                                 (
                                 0
                                 ,
                                 
                                    λ
                                    
                                       −
                                       1
                                    
                                 
                                 )
                              
                              ,
                           
                         and h is the normal density function, then v
                        
                           q, j
                         is small when βj
                         is far away from 0, so that the penalization is allowed to be larger when the jth component is close to zero.

A noteworthy special case of our approach is the popular Lasso method (Tibshirani, 1996) which is obtained when: q → 1, f(z) is the normal density function, and the penalty term uses the Laplace density function 
                           
                              h
                              (
                              β
                              ;
                              λ
                              )
                              =
                              λ
                              exp
                              {
                              −
                              λ
                              |
                              β
                              |
                              }
                              /
                              2
                           
                        . In the Lasso case, the data weights w
                        
                           q, i
                        , 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                              ,
                           
                         and parameters weights v
                        
                           q, j
                        , 
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              p
                              ,
                           
                         are all equal to 1 and therefore do not affect the optimization process. The constant weighting scheme implied by the Lasso leads to unstable behavior and inaccurate selections for large coefficients (Fan & Li, 2001). To improve the accuracy of the estimates, Zou (2006) proposed to vary the penalty term introducing a weighting scheme, similar to our weights v
                        
                           q, j
                        , 
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              p
                           
                        . Differently from our approach, however, Zhou’s weights are based on OLS-estimates and the varying tuning parameter is determined by either a prior distribution or a particular expectation on the market.

In this section, we provide a general algorithm for portfolio selection and then derive two important special cases of the algorithm when the working model f for the data is represented by either the normal or t- distributions. Computing the optimal portfolios, 
                           
                              
                                 
                                    
                                       β
                                    
                                    ^
                                 
                                 
                                    q
                                    ,
                                    λ
                                 
                              
                              ,
                           
                         by direct minimization of (1) is challenging because such a criterion is typically non-convex in the parameters. This issue can be addressed by dividing the optimization of (1) into a sequence of simpler (convex) optimization steps. Particularly, when the weights w
                        
                           q, i
                         and v
                        
                           q, j
                         in the estimating Eq. (5) are fixed constants, finding the solution to (5) reduces to a convex penalized likelihood problem as long as the densities f and h are log-convex. This suggests an iteratively re-weighted strategy to find the estimates, where we iterate parameter estimation by solving (5) with given weights and then update the weights based on the latest parameter estimates. Since re-weighting is applied to both data and penalty scores, we call this algorithm a doubly re-weighted (2RE) algorithm for portfolio selection.

Consider observations 
                           
                              {
                              
                                 (
                                 
                                    y
                                    i
                                 
                                 ,
                                 
                                    x
                                    i
                                 
                                 )
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                              }
                              ,
                           
                         on the target index return Y and p-dimensional vector of assets returns 
                           X
                         over n time periods. For given tuning constants q ≤ 1, λ ≥ 0, the algorithm consists of the following steps:

                           
                              0.
                              At Step 
                                    
                                       s
                                       =
                                       0
                                       ,
                                    
                                  compute initial parameter values 
                                    
                                       
                                          
                                             β
                                          
                                          ^
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             σ
                                             ^
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 .

Set 
                                    
                                       s
                                       =
                                       s
                                       +
                                       1
                                       ,
                                    
                                  and update the data weights 
                                    
                                       
                                          
                                             w
                                             ^
                                          
                                          
                                             q
                                             ,
                                             i
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                       =
                                       f
                                       
                                          
                                             (
                                             
                                                (
                                                
                                                   y
                                                   i
                                                
                                                −
                                                
                                                   x
                                                   i
                                                   ′
                                                
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      ^
                                                   
                                                   
                                                      (
                                                      s
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                )
                                             
                                             /
                                             
                                                
                                                   
                                                      σ
                                                      ^
                                                   
                                                
                                                
                                                   (
                                                   s
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             1
                                             −
                                             q
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ,
                                    
                                  and the penalty weights 
                                    
                                       
                                          
                                             v
                                             ^
                                          
                                          
                                             q
                                             ,
                                             j
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                       =
                                       h
                                       
                                          
                                             (
                                             
                                                
                                                   β
                                                   ^
                                                
                                                j
                                                
                                                   (
                                                   s
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             ;
                                             λ
                                             )
                                          
                                          
                                             1
                                             −
                                             q
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       p
                                    
                                 .

Find the parameter values 
                                    
                                       
                                          β
                                       
                                       ˜
                                    
                                  and 
                                    
                                       σ
                                       ˜
                                    
                                  by minimizing

                                    
                                       (8)
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   w
                                                   ^
                                                
                                                
                                                   q
                                                   ,
                                                   i
                                                
                                             
                                             log
                                             f
                                             
                                                (
                                                
                                                   (
                                                   
                                                      y
                                                      i
                                                   
                                                   −
                                                   
                                                      x
                                                      i
                                                      ′
                                                   
                                                   
                                                      β
                                                   
                                                   )
                                                
                                                /
                                                σ
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                
                                                   v
                                                   ^
                                                
                                                
                                                   q
                                                   ,
                                                   j
                                                
                                             
                                             log
                                             h
                                             
                                                (
                                                
                                                   β
                                                   j
                                                
                                                ;
                                                λ
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Let 
                                    
                                       z
                                       =
                                       (
                                       y
                                       −
                                       
                                          x
                                          ′
                                       
                                       
                                          β
                                       
                                       )
                                       /
                                       σ
                                    
                                 and 
                                    
                                       
                                          z
                                          ˜
                                       
                                       =
                                       
                                          (
                                          y
                                          −
                                          
                                             x
                                             ′
                                          
                                          
                                             
                                                β
                                             
                                             ˜
                                          
                                          )
                                       
                                       /
                                       
                                          σ
                                          ˜
                                       
                                    
                                  , where 
                                    
                                       
                                          β
                                       
                                       ˜
                                    
                                  and 
                                    
                                       σ
                                       ˜
                                    
                                  are obtained in Step 2. Then the re-centered parameters 
                                    
                                       
                                          
                                             β
                                          
                                          ^
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             σ
                                             ^
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                  are found by solving the equation 
                                    
                                       
                                          f
                                          q
                                       
                                       
                                          (
                                          z
                                          )
                                       
                                       =
                                       
                                          f
                                          q
                                       
                                       
                                          (
                                          
                                             
                                                z
                                                ^
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                          
                                          )
                                       
                                    
                                  in 
                                    β
                                  and σ, where fq
                                  is the power-transformation of f defined by

                                    
                                       
                                          
                                             
                                                f
                                                q
                                             
                                             
                                                (
                                                z
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      f
                                                      
                                                         
                                                            (
                                                            z
                                                            )
                                                         
                                                         q
                                                      
                                                   
                                                   
                                                      ∫
                                                      f
                                                      
                                                         
                                                            (
                                                            z
                                                            )
                                                         
                                                         q
                                                      
                                                      d
                                                      z
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 Note that solving the above equation is equivalent to a simple parameter transformation (e.g. when f is the N(0, 1) density, we have 
                                    
                                       
                                          
                                             
                                                β
                                             
                                             ^
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             β
                                          
                                          ˜
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             σ
                                             ^
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                       =
                                       
                                          σ
                                          ˜
                                       
                                       /
                                       
                                          q
                                       
                                    
                                 ). To ensure existence of the solution, we require that the power-transformed density fq
                                  is in the same family as f.

Repeat Steps 1 and 2 until a stopping criterion is satisfied.

Next we give some remarks on the 2RE algorithm. First, if the initial estimates are obtained by solving (5) with equal weights 
                           
                              
                                 w
                                 
                                    q
                                    ,
                                    i
                                 
                              
                              
                                 (
                                 
                                    β
                                 
                                 ,
                                 σ
                                 )
                              
                              =
                              1
                              ,
                           
                        
                        
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                              ,
                           
                         and 
                           
                              
                                 v
                                 
                                    q
                                    ,
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       β
                                    
                                    j
                                 
                                 ,
                                 λ
                                 )
                              
                              =
                              1
                              ,
                           
                        
                        
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              p
                              ,
                           
                         this corresponds then to the Lasso approach. However, since the Lasso solution is non-robust and typically sensitive to the presence of outliers, robust approaches for computing stable starting points could also be considered, for example by trimming out the 10% most extreme observations for each asset before computing the Lasso estimates. Second, the aim of the re-scaling described in Step 3, is to mitigate the potential bias implied by the first term of the estimating Eq. (5). Specifically, first we solve the re-centering equation

                           
                              (9)
                              
                                 
                                    E
                                    
                                       [
                                       
                                          w
                                          
                                             q
                                             ,
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             β
                                          
                                          ,
                                          σ
                                          )
                                       
                                       u
                                       
                                          (
                                          Y
                                          ,
                                          X
                                          ,
                                          
                                             β
                                          
                                          ,
                                          σ
                                          )
                                       
                                       ]
                                    
                                    =
                                    0
                                 
                              
                           
                        where expectation is with respect to the 
                           
                              f
                              (
                              
                                 (
                                 Y
                                 −
                                 
                                    
                                       X
                                    
                                    ′
                                 
                                 
                                    
                                       β
                                    
                                    0
                                 
                                 )
                              
                              /
                              
                                 σ
                                 0
                              
                              )
                              ,
                           
                         
                        
                           u
                         is the likelihood score defined in (5), 
                           
                              
                                 w
                                 
                                    q
                                    ,
                                    i
                                 
                              
                              
                                 
                                    (
                                    
                                       β
                                    
                                    ,
                                    σ
                                    )
                                 
                                 =
                                 f
                                 (
                              
                              
                                 (
                                 Y
                                 −
                                 
                                    
                                       X
                                    
                                    ′
                                 
                                 
                                    β
                                 
                                 )
                              
                              /
                              σ
                              ,
                           
                         and 
                           β
                        
                        0 and σ
                        0 are regarded as the true parameter values. A calculation analogous to that in Ferrari and La Vecchia (2012) shows that (9) is satisfied if and only if 
                           
                              f
                              
                                 (
                                 
                                    (
                                    Y
                                    −
                                    
                                       
                                          X
                                       
                                       ′
                                    
                                    
                                       
                                          β
                                       
                                       0
                                    
                                    )
                                 
                                 /
                                 
                                    σ
                                    0
                                 
                                 )
                              
                              =
                              
                                 f
                                 q
                              
                              
                                 (
                                 
                                    (
                                    Y
                                    −
                                    
                                       
                                          X
                                       
                                       ′
                                    
                                    
                                       β
                                    
                                    )
                                 
                                 /
                                 σ
                                 )
                              
                              ,
                           
                         where fq
                         is the power-transformation in Step 3 of the above algorithm. In many common cases this equation has a simple closed-formed solution involving a simple parameter transformation. For example, if f is the normal pdf, then (9) is satisfied by 
                           
                              
                                 
                                    β
                                 
                                 0
                              
                              =
                              
                                 β
                              
                           
                         and 
                           
                              
                                 σ
                                 0
                              
                              =
                              σ
                              /
                              
                                 q
                              
                           
                        . For the normal model, clearly re-centering of the portfolio coefficients is not required, but we still need to adjust the variance estimate from Step 2. Ferrari and La Vecchia (2012) use this re-centering method in the context of estimating estimation equation analogous to (5) but not involving a penalty term. Their estimator is Fisher consistent (i.e. the estimator is asymptotically unbiased when 
                           
                              f
                              =
                              g
                           
                        ), which motivates the same re-centering strategy in this paper. Finally, we note that another potential source of bias implied by the estimating Eq. (5) is given by the penalty function ∑
                           j
                        
                        Lq
                        (h(βj
                        ; λ)) in criterion (1); the heuristic derivation in the Appendix A illustrates how this bias can be controlled by choosing sufficiently large values of λ.

If the nominal model f for 
                           
                              Z
                              =
                              (
                              Y
                              −
                              
                                 
                                    X
                                 
                                 ′
                              
                              
                                 β
                              
                              )
                              /
                              σ
                           
                         (standardized difference between the target index Y and the portfolio 
                           X
                        ′
                           β
                        ) is the univariate normal model and 
                           
                              h
                              
                                 (
                                 
                                    β
                                    j
                                 
                                 ;
                                 λ
                                 )
                              
                              =
                              λ
                              exp
                              
                                 {
                                 
                                    −
                                    λ
                                    |
                                 
                                 
                                    β
                                    j
                                 
                                 
                                    |
                                 
                                 }
                              
                              /
                              2
                              ,
                           
                        
                        
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              p
                              ,
                           
                         Step 2 of the algorithm in Section 3.1 computes the portfolio estimates by solving

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             β
                                          
                                          ^
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                    =
                                    
                                       argmin
                                       
                                          β
                                       
                                    
                                    
                                    
                                       {
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                   ^
                                                
                                                
                                                   q
                                                   ,
                                                   i
                                                
                                             
                                          
                                          
                                             (
                                             s
                                             −
                                             1
                                             )
                                          
                                       
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         y
                                                         i
                                                      
                                                      −
                                                      
                                                         x
                                                         i
                                                         ′
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                         ^
                                                      
                                                      
                                                         (
                                                         s
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                       +
                                       λ
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          p
                                       
                                       
                                          
                                             v
                                             ^
                                          
                                          
                                             q
                                             ,
                                             j
                                          
                                          
                                             (
                                             s
                                             −
                                             1
                                             )
                                          
                                       
                                       
                                          |
                                          
                                             β
                                             j
                                          
                                          |
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        The weights 
                           
                              
                                 w
                                 ^
                              
                              
                                 q
                                 ,
                                 i
                              
                           
                         and 
                           
                              
                                 v
                                 ^
                              
                              
                                 q
                                 ,
                                 j
                              
                           
                         are computed using estimates obtained in Step 
                           
                              s
                              −
                              1
                           
                         as follows:

                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                      ^
                                                   
                                                   
                                                      q
                                                      ,
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                s
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                         1
                                                         
                                                            
                                                               2
                                                               π
                                                               
                                                                  
                                                                     σ
                                                                     ^
                                                                  
                                                                  
                                                                     2
                                                                     (
                                                                     s
                                                                     −
                                                                     1
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   exp
                                                   
                                                      {
                                                      −
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     y
                                                                     i
                                                                  
                                                                  −
                                                                  
                                                                     x
                                                                     i
                                                                     ′
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        ^
                                                                     
                                                                     
                                                                        (
                                                                        s
                                                                        −
                                                                        1
                                                                        )
                                                                     
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                            
                                                               2
                                                               
                                                                  
                                                                     σ
                                                                     ^
                                                                  
                                                                  
                                                                     2
                                                                     (
                                                                     s
                                                                     −
                                                                     1
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      }
                                                   
                                                   ]
                                                
                                                
                                                   1
                                                   −
                                                   q
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                      ^
                                                   
                                                   
                                                      q
                                                      ,
                                                      j
                                                   
                                                
                                             
                                             
                                                (
                                                s
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                         λ
                                                         2
                                                      
                                                   
                                                   exp
                                                   
                                                      {
                                                      
                                                         −
                                                         λ
                                                         |
                                                      
                                                      
                                                         
                                                            β
                                                            ^
                                                         
                                                         j
                                                         
                                                            (
                                                            s
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                      
                                                         |
                                                      
                                                      }
                                                   
                                                   ]
                                                
                                                
                                                   1
                                                   −
                                                   q
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The portfolio variance is also updated using estimates from Step 
                           
                              s
                              −
                              1
                           
                         as

                           
                              (12)
                              
                                 
                                    
                                       
                                          σ
                                          2
                                       
                                       ^
                                    
                                    
                                       (
                                       s
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                      ^
                                                   
                                                   
                                                      q
                                                      ,
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                s
                                                −
                                                1
                                                )
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   y
                                                   i
                                                
                                                −
                                                
                                                   x
                                                   i
                                                   ′
                                                
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      ^
                                                   
                                                   
                                                      (
                                                      s
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                       
                                          q
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                      ^
                                                   
                                                   
                                                      q
                                                      ,
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                s
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

When the portfolio variance is not estimated and instead set equal to a fixed target value, say σ
                        *
                        2, we then have 
                           
                              
                                 
                                    σ
                                    ^
                                 
                                 
                                    2
                                    (
                                    s
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       σ
                                       *
                                    
                                 
                                 2
                              
                              ,
                           
                         for all s ≥ 0.

The updating rule in (10) is a weighted L
                        1-penalized quadratic problem (Lasso) and can be solved efficiently using existing algorithms. Tibshirani (1996) and Turlach, Venables, and Wright (2005) proposed to use quadratic optimization to solve the L
                        1-penalized optimization problem, while Friedman, Hastie, Hfling, and Tibshirani (2007) developed a coordinate-wise approach that works efficiently with convex optimization problems. To compute (10), we use the gradient projection algorithm developed by Figueiredo, Nowak, and Wright (2007), as Gasso et al. (2009) have shown that such algorithm is more efficient to solve problems such as ours compared to quadratic programming and coordinate-wise optimization.

Assume that the variable 
                           
                              Z
                              =
                              (
                              Y
                              −
                              
                                 
                                    X
                                 
                                 ′
                              
                              
                                 β
                              
                              )
                              /
                              σ
                           
                         follows a t- distribution with mean 
                           
                              
                                 
                                    x
                                 
                                 i
                                 ′
                              
                              
                                 β
                              
                           
                         and variance σ with probability density function

                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                ν
                                             
                                             
                                                (
                                                
                                                   y
                                                   i
                                                
                                                ;
                                                
                                                   x
                                                   i
                                                
                                                ,
                                                
                                                   β
                                                
                                                ,
                                                σ
                                                )
                                             
                                             =
                                             
                                                
                                                   Γ
                                                   (
                                                   
                                                      
                                                         ν
                                                         +
                                                         1
                                                      
                                                      2
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         ν
                                                         π
                                                      
                                                   
                                                   
                                                   Γ
                                                   
                                                      (
                                                      
                                                         ν
                                                         2
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  y
                                                                  i
                                                               
                                                               −
                                                               
                                                                  x
                                                                  i
                                                                  ′
                                                               
                                                               
                                                                  β
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                         
                                                            ν
                                                            
                                                               σ
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   −
                                                   
                                                      
                                                         ν
                                                         +
                                                         1
                                                      
                                                      2
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where ν is the number of degrees of freedom and Γ is the Gamma function. The value of ν > 1 are fixed and will not be estimated. Under the t- model, for each Step s ≥ 1 we compute 
                           
                              {
                              
                                 
                                    
                                       β
                                    
                                    ^
                                 
                                 
                                    (
                                    s
                                    )
                                 
                              
                              ,
                              
                                 
                                    σ
                                    ^
                                 
                                 
                                    (
                                    s
                                    )
                                 
                              
                              }
                           
                         by solving

                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                argmin
                                                
                                                   
                                                      β
                                                   
                                                   ,
                                                   σ
                                                
                                             
                                             
                                             
                                                {
                                                −
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ν
                                                            +
                                                            1
                                                         
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   
                                                      
                                                         
                                                            w
                                                            ^
                                                         
                                                         
                                                            q
                                                            ,
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      s
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                log
                                                
                                                   {
                                                   1
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  y
                                                                  i
                                                               
                                                               −
                                                               
                                                                  x
                                                                  i
                                                                  ′
                                                               
                                                               
                                                                  β
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                         
                                                            ν
                                                            
                                                               σ
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                +
                                                λ
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   p
                                                
                                                
                                                   
                                                      v
                                                      ^
                                                   
                                                   
                                                      q
                                                      ,
                                                      j
                                                   
                                                   
                                                      (
                                                      s
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   |
                                                   
                                                      β
                                                      j
                                                   
                                                   |
                                                
                                                }
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where σ > 0 and ν > 1 and the estimation weights 
                           
                              
                                 w
                                 ^
                              
                              
                                 q
                                 ,
                                 i
                              
                           
                         updated from estimates obtained in Step 
                           
                              s
                              −
                              1
                           
                         as follows

                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                      ^
                                                   
                                                   
                                                      q
                                                      ,
                                                      i
                                                   
                                                
                                             
                                             
                                                (
                                                s
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   [
                                                   
                                                      f
                                                      ν
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         i
                                                      
                                                      −
                                                      
                                                         x
                                                         i
                                                         ′
                                                      
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            ^
                                                         
                                                         
                                                            (
                                                            s
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   /
                                                   
                                                      (
                                                      
                                                         
                                                            σ
                                                            ^
                                                         
                                                         
                                                            (
                                                            s
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                                
                                                   1
                                                   −
                                                   q
                                                
                                             
                                             ,
                                             
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where fν
                         is the probability density function in (13) and the penalty weights 
                           
                              
                                 v
                                 ^
                              
                              
                                 q
                                 ,
                                 j
                              
                           
                         have the same expression as in (11).

In this case, the updating rule (14) (Step 2 of the general algorithm in Section 3.1) represents a non-convex problem. Thus, solving (14) can lead to unreliable estimates, especially when the number of assets p is large. Under the t- model, a stable approach for (weighted) likelihood optimization is given by the Expectation-Maximization (EM) algorithm. The EM algorithm exploits the well-known fact that a t- distribution can be equivalently represented as a scale mixture of normals; particularly, one observation from the t- model can be written as 
                           
                              
                                 z
                                 i
                              
                              ∼
                              N
                              
                                 (
                                 μ
                                 ,
                                 
                                    σ
                                    2
                                 
                                 
                                    U
                                    i
                                    
                                       −
                                       1
                                    
                                 
                                 )
                              
                           
                         where Ui
                         follows a Gamma distribution Ui
                         ∼ Γ(ν/2, ν/2) (McLachlan & Krishnan, 2007). These considerations motivate the following EM steps, which specify Step 2 of the algorithm in Section 3.1 for the t- distribution.

For any s > 0, given robust weights 
                           
                              
                                 
                                    
                                       w
                                       ^
                                    
                                    
                                       q
                                       ,
                                       i
                                    
                                 
                              
                              
                                 (
                                 s
                                 −
                                 1
                                 )
                              
                           
                         and 
                           
                              
                                 
                                    
                                       v
                                       ^
                                    
                                    
                                       q
                                       ,
                                       j
                                    
                                 
                              
                              
                                 (
                                 s
                                 −
                                 1
                                 )
                              
                           
                         obtained in Step 
                           
                              s
                              −
                              1
                              ,
                           
                         first set the initial mixture weights 
                           
                              
                                 
                                    u
                                    ^
                                 
                                 i
                              
                              =
                              1
                              /
                              n
                              ,
                           
                        
                        
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                        . Then, obtain the updated estimates 
                           
                              
                                 
                                    β
                                 
                                 ^
                              
                              
                                 (
                                 s
                                 )
                              
                           
                         and 
                           
                              
                                 σ
                                 ^
                              
                              
                                 (
                                 s
                                 )
                              
                           
                         by iterating the following EM steps

                           
                              •
                              
                                 M-Step: this step computes weighted parameter estimates 
                                    β
                                  and σ using the mixing constants 
                                    
                                       
                                          u
                                          ^
                                       
                                       i
                                    
                                 :

                                    
                                       (16)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      *
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         argmin
                                                         
                                                            β
                                                         
                                                      
                                                      
                                                         {
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            n
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     w
                                                                     ^
                                                                  
                                                                  
                                                                     q
                                                                     ,
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               s
                                                               −
                                                               1
                                                               )
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     u
                                                                     ^
                                                                  
                                                                  i
                                                               
                                                            
                                                            
                                                               (
                                                               s
                                                               −
                                                               1
                                                               )
                                                            
                                                         
                                                         
                                                            
                                                               1
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           y
                                                                           i
                                                                        
                                                                        −
                                                                        
                                                                           x
                                                                           i
                                                                           ′
                                                                        
                                                                        
                                                                           β
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           σ
                                                                           ^
                                                                        
                                                                        
                                                                           (
                                                                           s
                                                                           −
                                                                           1
                                                                           )
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         +
                                                         λ
                                                         
                                                            ∑
                                                            
                                                               j
                                                               =
                                                               1
                                                            
                                                            p
                                                         
                                                         
                                                            
                                                               v
                                                               ^
                                                            
                                                            
                                                               q
                                                               ,
                                                               j
                                                            
                                                            
                                                               (
                                                               s
                                                               −
                                                               1
                                                               )
                                                            
                                                         
                                                         
                                                            |
                                                            
                                                               β
                                                               j
                                                            
                                                            |
                                                         
                                                         }
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (17)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                            *
                                                         
                                                      
                                                      2
                                                   
                                                
                                                
                                                   
                                                      =
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               n
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        w
                                                                        ^
                                                                     
                                                                     
                                                                        q
                                                                        ,
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  (
                                                                  s
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        u
                                                                        ^
                                                                     
                                                                     i
                                                                  
                                                               
                                                               
                                                                  (
                                                                  s
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  (
                                                                  
                                                                     y
                                                                     i
                                                                  
                                                                  −
                                                                  
                                                                     x
                                                                     i
                                                                     ′
                                                                  
                                                                  
                                                                     
                                                                        β
                                                                     
                                                                     ^
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               n
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        w
                                                                        ^
                                                                     
                                                                     
                                                                        q
                                                                        ,
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  (
                                                                  s
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        u
                                                                        ^
                                                                     
                                                                     i
                                                                  
                                                               
                                                               
                                                                  (
                                                                  s
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                      ×
                                                      
                                                         
                                                            ν
                                                            
                                                               (
                                                               ν
                                                               +
                                                               1
                                                               )
                                                               q
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where 
                                    
                                       
                                          w
                                          ^
                                       
                                       
                                          q
                                          ,
                                          i
                                       
                                       
                                          (
                                          s
                                          −
                                          1
                                          )
                                       
                                    
                                  is proportional to the t- probability density function as in (15) evaluated in 
                                    
                                       
                                          
                                             
                                                β
                                             
                                             ^
                                          
                                          
                                             (
                                             s
                                             −
                                             1
                                             )
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             σ
                                             ^
                                          
                                          
                                             (
                                             s
                                             −
                                             1
                                             )
                                          
                                       
                                       ,
                                    
                                  the parameter estimates obtained in Step 
                                    
                                       s
                                       −
                                       1
                                    
                                 .


                                 E-Step: update the mixing constants as follows:

                                    
                                       (18)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                            ^
                                                         
                                                         i
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     ν
                                                                     q
                                                                  
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                               
                                                                  
                                                                     
                                                                        σ
                                                                        *
                                                                     
                                                                  
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  ν
                                                                  q
                                                               
                                                               
                                                                  
                                                                     
                                                                        σ
                                                                        *
                                                                     
                                                                  
                                                                  2
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        
                                                                           w
                                                                           ^
                                                                        
                                                                        
                                                                           q
                                                                           ,
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     s
                                                                     −
                                                                     1
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        y
                                                                        i
                                                                     
                                                                     −
                                                                     
                                                                        x
                                                                        i
                                                                        ′
                                                                     
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        *
                                                                     
                                                                     )
                                                                  
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where 
                                    
                                       
                                          
                                             β
                                          
                                          ^
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       σ
                                       ^
                                    
                                  are computed in the M-Step and 
                                    
                                       
                                          ν
                                          q
                                       
                                       =
                                       
                                          (
                                          ν
                                          +
                                          1
                                          )
                                       
                                       q
                                       −
                                       1
                                    
                                 .

We refer to Appendix B for the derivation of the M- and E-Steps.

The parameter λ controls for the size of the penalty. Large λ values imply more parsimonious portfolios with a larger number of assets having zero weight. In the literature of penalized regression, similar tuning constants are chosen by information theoretical criteria, such as the AIC and BIC selection criteria yielding good empirical performances (Zhang, Li, & Tsai, 2010). We will follow the same approach here. Many authors, including Ronchetti (1997), Shi and Tsai (1998) and Machado (1993), have highlighted the non-robust nature of the traditional information theoretical criteria and stressed instead the importance of robust model selection procedures. Following Ronchetti (1997) and Machado (1993), we choose optimal values of λ for a given q by minimizing the following robust Bayesian Information Criterion (BIC):

                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             BIC
                                             q
                                          
                                       
                                       
                                          
                                             =
                                             −
                                             2
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                L
                                                q
                                             
                                             
                                                {
                                                f
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                               i
                                                            
                                                            −
                                                            
                                                               x
                                                               i
                                                               ′
                                                            
                                                            
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  ^
                                                               
                                                               
                                                                  q
                                                                  ,
                                                                  λ
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               σ
                                                               ^
                                                            
                                                            
                                                               q
                                                               ,
                                                               λ
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                }
                                             
                                             +
                                             log
                                             
                                                (
                                                n
                                                )
                                             
                                             k
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where k ≤ p is the number of active portfolio positions (i.e. the number of β different from zero) and the traditional BIC is obtained when q → 1. Note that when the penalty log (n)k is replaced by 2k in (19) we obtain the robust AIC approach by Ronchetti (1997).

We evaluate the performance of the proposed approaches for normal and t- portfolios (denoted by GDLN
                      and GDLt
                     , respectively) and compare our method to other popular penalization schemes. The data are simulated from the following models:

                        
                           1.
                           
                              Model 1: Np
                              (
                                 μ, Σ
                              ), where 
                                 
                                    
                                       μ
                                       j
                                    
                                    =
                                    1
                                    ,
                                 
                               if j ≤ k, and 
                                 
                                    
                                       μ
                                       j
                                    
                                    =
                                    0
                                    ,
                                 
                               if j > k, and the covariance matrix is such that 
                                 
                                    
                                       Σ
                                       
                                          j
                                          j
                                       
                                    
                                    =
                                    1
                                    ,
                                 
                              
                              
                                 
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    p
                                    ,
                                 
                               and off-diagonal elements 
                                 
                                    
                                       Σ
                                       
                                          j
                                          k
                                       
                                    
                                    =
                                    ρ
                                    ,
                                 
                               0 ≤ ρ < 1, j ≠ k
                           


                              Model 2: multivariate t- distribution tp
                              (
                                 μ, Σ
                              , ν), with ν degrees of freedom. The mean-variance structure is as in Model 1

We compare
                      the resulting estimates with analogous estimates obtained by the following methods: Lasso (Tibshirani (1996)), the Zhang-penalty method by Gasso et al. (2009) with 
                        
                           η
                           =
                           0.2
                           ,
                        
                      and the logarithm penalization by Weston, Elisseeff, and Schölkopf (2003) with 
                        
                           ϕ
                           =
                           1.5
                        
                     . For each method we select the solutions with the lowest BIC, as explained in Section 3.4. All the methods except Lasso involve the solution of non-convex problems, which we solve by the DC-programming approach proposed by Gasso et al. (2009). The optimization relies on iterative primal-dual approach for the non-convex penalty functions considered, where in each iteration a convex primal problem is solved by the gradient projection algorithm of Figueiredo et al. (2007). We use the MATLAB toolbox developed in Gasso et al. (2009)
                     
                        3
                     
                     
                        3
                        Available at http://asi.insa-rouen.fr/enseignants/~arakoto/dclasso.zip.
                      to implement the dual-convex optimization algorithm and compute the estimates for our GDL approach and its benchmarks, namely the LASSO, Log and Zhang penalties. The optimization algorithms have been implemented in MATLAB 8. To initialize all the algorithms we used ordinary least squares estimates, except for the EM algorithm of the GDLt
                      approach. In our numerical experiments, we noticed that the convergence of the EM algorithm can be sensitive to the initial estimates of the β coefficients, as also discussed in the statistical literature, so we use the robust estimates obtained by GDLN
                      approach as initial values. Both GDLt
                      and GDLN
                      are initialized using equal weights 
                        
                           
                              w
                              
                                 q
                                 ,
                                 i
                              
                           
                           =
                           1
                           /
                           n
                           ,
                           
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                           ,
                        
                      and 
                        
                           
                              v
                              
                                 q
                                 ,
                                 j
                              
                           
                           =
                           1
                           /
                           p
                           ,
                           
                           j
                           =
                           1
                           ,
                           …
                           ,
                           p
                        
                     . The iterative algorithm for normal portfolios and the EM algorithm converge after a small number of iterations. For Model 1, the average number of iterations was 6.42 (se=0.02) and 4.04 (se=0.02) for GDLN
                      and GDLt
                     , respectively.


                              Figs. 2 and 3 show boxplots for the number of active positions, F-measure and MSE (in logarithmic scale), obtained under mildly and strongly correlated data (
                                 
                                    ρ
                                    =
                                    0.2
                                    ,
                                    0.8
                                 
                               and 
                                 
                                    q
                                    =
                                    0.9
                                 
                              ). In terms of sparsity, the GDL algorithms perform considerably better than all other approaches in the first two models (panels (a) and (d)), regardless of the correlation level. The number of active regressors is close to the optimal value 
                                 
                                    k
                                    =
                                    10
                                 
                              . The GDL always outperforms the Lasso and Zhang penalties, which give over-fitting solutions with too many coefficients different from zero. The Log penalty shows a good performance when 
                                 
                                    ρ
                                    =
                                    0.8
                                 
                              . This is not surprising as previous studies have already shown the considerable model selection accuracy of the Log penalty in the presence of highly correlated data (Gasso et al., 2009). Panels (b) and (e) show that the GDL algorithms not only select the correct number of active regressors, but also tend to select the right assets more frequently compared to the other methods. Particularly, the boxplots of the F-measure are centered on larger values than those of other approaches and very close to F-value equal to 1 for low level of correlation (i.e. 
                                 
                                    ρ
                                    =
                                    0.2
                                 
                              ), which corresponds to perfect matching. In terms of MSE, the Lasso has the worst overall performance, due to selecting too many unnecessary active weights (panels (c) and (f)). The good model selection performance of the GDL approaches comes with a relatively small price in terms of MSE compared to the Zhang and Log penalties. The GDLt
                               slightly outperforms the GDLN
                              , due to the advantage in terms of good initialization and the larger penalization for the observations in the tails.

Comparing Figs. 2 and 3 shows that the GDL approaches work well regardless the amount of correlation, while the other approaches tend to keep too many variables, with the Log penalty being the only exception for 
                                 
                                    ρ
                                    =
                                    0.8
                                 
                              . Clearly, this leads to smaller values of MSE, while the model selection performance, as quantified by the F-measures, is still inferior to the GDL approaches.


                              Fig. 4
                               shows the boxplots for the GDLt
                               for 
                                 
                                    q
                                    =
                                    0.5
                                    ,
                                    0.7
                                    ,
                                    0.9
                                 
                               when 
                                 
                                    ρ
                                    =
                                    0.2
                                 
                               and 0.6. For Model 1, smaller values of q < 1 lead to a more parsimonious selection with fewer active components, while better F-measure values are reached for 
                                 
                                    ρ
                                    =
                                    0.2
                                 
                               and 
                                 
                                    q
                                    =
                                    0.7
                                 
                              . In terms of MSE, in Model 1 we expect the GDLt
                               approach with 
                                 
                                    q
                                    =
                                    0.9
                                 
                               to perform best, as there is no need to robustify the estimates with respect to potential extreme values. For Model 2, using the GDLt
                               accounts automatically for the possible presence of fat tails, leading to satisfactory results for all q levels. However, when the correlation level increases, the degree of robustness provided by 
                                 
                                    q
                                    =
                                    0.9
                                 
                               does not give sufficiently sparse models, despite still resulting in satisfactory estimates when looking at the log(MSE).

Summing up, the optimal choice of q depends on the distribution of the data. A larger value of q should be preferred when data do not exhibit fat tails, since there is no need to introduce robustness to improve the quality of the estimates. On the other hand, smaller values of q help to reduce the number of active beta in presence of high correlation and fat tails, despite paying a small price in terms of accuracy.

One of the most important challenges in asset allocation is the so-called index-tracking problem. The aim of classic index tracking is to replicate the performance of a financial index by using a relatively small subset of its constituents. Indeed, investing in all index components would imply paying a fee proportional to the number of assets every time a transaction is needed (i.e when acquiring the assets and re-balancing their weights). A sparse tracking portfolio allows us to limit these transaction and monitoring costs. Typically, the problem can be set-up as a regression problem subject to a budget constraint (i.e. the sum of the coefficients of the 
                        β
                      vector has to sum to 1) and a constraint on the 0-norm of the 
                        β
                      vector, by imposing a maximum number of active positions. The latter constraint and the typical large dimensionality of the problem makes the optimization NP-hard and different solutions have been proposed in the literature (see Beasley, Meade, and Chang (2003) for a review). Recently, Giamouridis and Paterlini (2010) and Fastrich, Paterlini, and Winker (2014) have shown that using a Lasso or a non-convex approach can be beneficial in hedge fund replication and index tracking, by allowing to select automatically sparse solutions with good out-of-sample properties.

In this section, we apply our new methodology to obtain optimal sparse tracking portfolios for a set of financial indexes with a different number of constituents. We consider daily observations from March 23, 2002 to March 27, 2008 of three financial indexes, Fama & French 100, S&P 200 and S&P 500, with number of constituents p equal to 100, 200 and 500, respectively. In Fig. 5, we show the log-returns for all indexes along with the normal and t- distributions, fitted by the maximum likelihood estimation method. The data are slightly asymmetric and leptokurtic and a satisfactory fit is given by the t- distribution with approximately 4 degrees of freedom. The F&F 100 is a capitalization-weighted index where 8.16% of the assets have weight larger than 5%, 11.23% have weights values between 1% and 5%, and the remaining 80.61% have weights smaller than 1%. The S&P indexes are market-value weighted indexes, characterized by much smaller positions in the constituents: no weight is larger than 5% and the majority of weights are smaller than 1% (89% for S&P 200, 95.80% for S&P 500).

Our aim is to build sparse portfolios that can mimic the target index over time. Given the return times series of the index yi
                      with 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                           ,
                        
                      we use a rolling window scheme. The rationale of our study is to take the viewpoint of an investor who decides on his optimal allocation by exploiting the information in the in-sample window, and then holds the portfolio for one week, before revising it. For each dataset, we compare six tracking techniques: the GDLN
                      and the GDLt
                      approaches with 
                        
                           q
                           =
                           0.9
                        
                      and 
                        
                           q
                           =
                           0.5
                           ,
                        
                      the Lasso, and the equally weighted strategy (1/N). We test the out-of-sample performance of these methods as follows: we adjust the asset weights periodically based on a rolling window of 250 in-sample observations (i.e. one trading year), moving each time window ahead by 5 observations (i.e. one week) and then discarding the oldest five data points for a total of 
                        
                           M
                           =
                           103
                        
                      windows and nos
                     = 513 daily out-of-sample returns. For each window (
                        
                           m
                           =
                           1
                           ,
                           …
                           ,
                           M
                        
                     ), we set 
                        y
                     
                     
                        m
                      to be a vector of 250 in-sample index returns and 
                        
                           
                              y
                              ˜
                           
                           m
                        
                      equal to the first out-of-sample index return not included in window m. Then, we select the optimal portfolio 
                        
                           
                              
                                 β
                              
                              ^
                           
                           m
                        
                      according to the BIC criterion, as described in Section 3.4. We assume to hold the portfolio fixed for five days and compute its out-of-sample returns in the next week as 
                        
                           
                              
                                 y
                                 ^
                              
                              m
                           
                           =
                           
                              
                                 X
                                 ˜
                              
                              m
                              ′
                           
                           
                              
                                 
                                    β
                                 
                                 ^
                              
                              m
                           
                           ,
                        
                      with 
                        
                           m
                           =
                           1
                           ,
                           …
                           ,
                           M
                           ,
                        
                      where 
                        
                           
                              X
                              ˜
                           
                           m
                        
                      is the 5 × p matrix of the first 5 out-of-sample asset returns not included in window m and 
                        
                           
                              
                                 β
                              
                              ^
                           
                           m
                        
                      is the vector of asset weights estimated in window m.

We assess the portfolio selection by looking at different performance measures. The out-of-sample excess return time series 
                        
                           E
                           
                              R
                              m
                           
                           =
                           
                              
                                 y
                                 ˜
                              
                              m
                           
                           −
                           
                              
                                 y
                                 ^
                              
                              m
                           
                           ,
                        
                     
                     
                        
                           m
                           =
                           1
                           ,
                           …
                           ,
                           M
                        
                      is determined by the difference between the index and the tracking portfolio on the entire out-of-sample period, while the tracking error volatility TEV is the standard deviation of the out-of-sample excess return. The smaller the TEV, the better the tracking performance of the optimal portfolio. If the portfolio is nearly tracking the index, we also expect the mean excess return, ER = 
                        
                           
                              1
                              
                                 n
                                 
                                    o
                                    s
                                 
                              
                           
                           
                              ∑
                              
                                 m
                                 =
                                 1
                              
                              M
                           
                           E
                           
                              R
                              m
                           
                           ,
                        
                      to be as close as possible to zero as well as the information ratio, IR = ER/TEV, which is a typical measure of the risk/return performance. Moreover, to assess the tracking ability, we compute the portfolios’ out-of-sample correlation (Cor) between the time series of the out-of-sample log-returns of the index and the tracking portfolio. If the portfolio perfectly tracks the index, we expect Cor to be equal to 1. Finally, to evaluate sparsity and stability of portfolios, which have a direct impact on transaction costs, we compute the average number of active positions, 
                        
                           
                              k
                              ¯
                           
                           =
                           
                              1
                              M
                           
                           
                              ∑
                              
                                 m
                                 =
                                 1
                              
                              M
                           
                           
                              I
                              (
                              |
                           
                           
                              
                                 
                                    β
                                 
                                 ^
                              
                              m
                           
                           
                              |
                              ≠
                              0
                              )
                           
                           ,
                        
                      and the average turnover, TO = 
                        
                           
                              ∑
                              
                                 m
                                 =
                                 2
                              
                              M
                           
                           
                              |
                              
                                 
                                    
                                       β
                                    
                                    ^
                                 
                                 m
                              
                              −
                              
                                 
                                    
                                       β
                                    
                                    ^
                                 
                                 
                                    m
                                    −
                                    1
                                 
                              
                              |
                           
                           /
                           
                              (
                              M
                              −
                              1
                              )
                           
                        
                     .


                     Table 1
                      reports the out-of-sample statistics of the six portfolios for the three indexes. Since the target is to track an index as closely as possible instead of outperforming it, an ideal tracking portfolio should have the smallest out-of-sample tracking volatility TEV (Column 2) and mean excess returns close to zero (Column 3). We observe that the GDL strategies constantly obtain lower TEVs compared to Lasso and ERs closest to zero overall. These results are consistent with our simulation analysis, showing that the GDL approaches usually identify solutions with smaller MSE. At the same time, the GDL methods obtain sparser portfolios than the Lasso, as shown by the average number of active positions 
                        
                           k
                           ¯
                        
                      in Column 5. The smaller levels of TEVs of the GDL approaches are obtained by using approximately 37% of the available positions for F&F 100, less than 15% for S&P 200 and less than 10% for S&P 500. Lasso identifies optimal tracking portfolios with always more than 65 constituents for each index. However, investing in a larger number of constituents gives a turnover rate lower than the GDL, as shown in Column 6. The GDL portfolios have values of correlation with respect to the index very close to 1. As expected, in terms of risk/return performance and correlation, the 1/N portfolio is a tough benchmark to beat, especially for S&P 200 and S&P 500, which are market weighted indexes with about 90% of weights smaller than 1%, while F&F 100 is a value-weighted index. However, investing in the equally weighted portfolio would imply having a position in each constituent, which could be undesirable due to monitoring and transaction costs. As expected, the GDL approaches reach IR values closer to zero than 1/N. This aspect is illustrated in Fig. 6
                     , where we show the out-of-sample returns, rebased to 100, of the 1/N, Lasso and the GDL approaches for F&F 100 and S&P 200. A portfolio close to the index indicates a good out-of-sample tracking performance. The GDL approach provides satisfactory replications of the index by using a relatively small subset of its components. Instead, 1/N and Lasso show returns patterns which, despite outperforming the indexes in the selected period, are often far away from the indexes.

We further test the tracking performance of the GDL approach on the period during and after the financial crisis. In particular, we extend the dataset for S&P 200 and S&P 500 from March 28, 2008 to March 1, 2011. The new data are characterized by the presence of high volatility, high correlation and extreme losses. As expected from our simulation analysis, in the crisis period, when the correlation between the index components ρ dramatically increases, the GDL approach selects less sparse portfolios and exhibits larger TEV and lower correlation with respect to the index, compared to the pre-crisis period. Nevertheless, it is able to outperform the Lasso in terms of sparsity and tracking performance, having in all but two cases smaller TEV and always average ER closer to zero. As GDL performance suffers from increased level of correlation between assets and presence of extreme losses during highly volatile markets, we believe that explicitly considering even fatter tail distributions than the t-Student could improve the tracking performance during crises. This is high on our research agenda.

@&#CONCLUSION@&#

This work proposes a new objective function and develops the related algorithm for financial portfolio selection with particular focus on index tracking. The main rationale of our approach is to select asset weights that minimize two sources of uncertainty: one is related to the choice of the model for portfolio returns (e.g., normal or t- models); while the other pertains to the choice of the model structure itself. Differently from other criteria for portfolio selection, the information is coded by the q-entropy, a generalized information measure, which has been previously shown to be useful for inference due to its robustness properties in the presence of model misspecification (Ferrari & La Vecchia, 2012). The resulting optimization task may be regarded as the optimization of a robust penalized likelihood function, subject to a constraint depending on the prior density model for the portfolio coefficients or asset weights. To compute the estimates, we developed an iteratively re-weighted algorithm when the underlying models for the asset returns are the normal or t- distributions, which are typical choices in the asset allocation literature. In this work, we explored the use of a Laplace density as a prior density model for the coefficient weights; such a choice is shown to be useful when the goal is to obtain sparse portfolios (i.e. portfolios with a relatively small number of active weights).

The empirical findings in Section 4 show a good performance of the proposed method in most of our simulation settings, when compared to other state-of-the-art approaches, pointing out that the GDL criterion can be a useful tool for portfolio selection. The robustness of the GDL approach to model misspecification of the normal or t- models for the data is achieved through the well-established properties of the first term in our objective function in Eq. (1), which are already well-studied in the literature of M-estimation.

In Section 5, we apply the index-tracking problem to real data. Ideally, a tracking strategy should select portfolios with good out-of-sample replicating performance and a small number of constituents to limit transaction costs. Indeed, the GDL approach selects sparse portfolios with good out-of-sample performance, when considering the small values of TEVs and ERs close to zero. In our empirical study we found that the optimal GDL portfolios outperform the Lasso portfolios, by achieving a smaller out-of-sample TEV while investing in a much lower number of assets. The proposed approach also outperforms the equally-weighted strategy in terms of sparsity and tracking ability. Only for the S&P 500 dataset, the equally-weighted portfolio shows a lower out-of sample tracking volatility. This is not surprising, as the large diversification in the S&P 500 index implies that actual proportions of its assets are not much different from those of the 1/N portfolios. Still, the empirical analysis including data during and post-crisis points out that the GDL approach with normal and t- distribution can suffer from the presence of high correlation, extreme losses and volatility clustering

Our work might be extended in numerous ways. First, other distributional assumptions on f, besides the normal and t-, as well as different penalty functions, may be chosen according to specific user expectations on the data distribution, and to stylized facts of financial time series (Cont, 2001). Selecting a model that fits the data distribution well may significantly improve the performance of the resulting portfolio by decreasing the estimation errors and the sensitivity of the weights to parameter changes. Clearly, this would imply that the re-weighted algorithm should be extended to consider other parametric models. However, the general 2RE algorithm can be easily obtained for a large class of distributions, extending the scope of applications to numerous fields. Our empirical findings show that the overall behavior of the GDL criterion in terms of sparsity and robustness is based on the choice of the tuning parameters λ and q. Hence, it is a priority in our agenda to develop automatic methods for the optimal selection of the two values.

Finally, the analysis on real-world financial data could be extended in numerous ways. Our approach could be applied to a similar optimization setting, as the enhanced indexation problem (Canakgoz & Beasley, 2009), whose main objective is to outperform, rather than to reproduce the index performance with only a subset of its constituents. We could test the GDL method in a mean-variance framework in presence of a benchmark (Bernard & Vanduffel, 2014), in which the target is to achieve an optimal portfolio in terms of risk-return trade-off, which is also strongly correlated with a benchmark. Different target risk measures, as the ones reported by Gaivoronski, Krylov, and van der Wijst (2005), could be included in the index tracking problem, according to specific regulatory or user requirements. Additional constraints that explicitly control the risk contribution of different asset classes to the overall portfolio risk, as in risk-budgeting approaches, and allow to control the turnover could better taylor the portfolio framework to practitioners’ needs. In fact, one of the limitations of our approach is that the high level of correlation in the data and the portfolio sparsity result in asset weights estimates that might differ significantly from one period to another. This frequent re-balancing might limit the net returns of the strategies when explicitly taking transaction costs into account. Furthermore, the analysis should be performed on larger datasets including crises period by possibly extending the parametric assumptions behind GDL beyond the normal and t- distributions, to better deal with increased levels of correlation, high volatility and extreme losses.

@&#ACKNOWLEDGMENT@&#

We would like to thank the two anonymous referees and the Associate Editor for providing us with constructive and detailed comments that have improved the quality of our paper. Sandra Paterlini acknowledges financial support from CRoNos COST Action IC 1408.

In this section we discuss the potential sources of bias implied by Eq. (5). Suppose 
                        β
                     
                     0 and σ
                     0 are optimal parameter values such that the standardized variable 
                        
                           
                              Z
                              0
                           
                           =
                           
                              (
                              Y
                              −
                              
                                 
                                    X
                                 
                                 ′
                              
                              
                                 
                                    β
                                 
                                 0
                              
                              )
                           
                           /
                           
                              σ
                              0
                           
                        
                      follows exactly the assumed model f(z) (normal or t- models). The solution of Eq. (5) is generally biased for 
                        β
                     
                     0 and σ
                     0 as n → ∞. The following heuristic derivation illustrates how the bias can be controlled by appropriate selection of q and λ. Let λn
                      be a sequence such that λn
                      → ∞ as n → ∞. Let 
                        
                           
                              θ
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       β
                                    
                                    ′
                                 
                                 ,
                                 σ
                                 )
                              
                              ′
                           
                        
                      and 
                        
                           
                              
                                 θ
                              
                              ^
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       
                                          β
                                       
                                       ^
                                    
                                    ′
                                 
                                 ,
                                 
                                    σ
                                    ^
                                 
                                 )
                              
                              ′
                           
                        
                      denote the solution to the estimating Eq. (5). Appropriate regularity conditions on f and h yield the first-order Taylor expansion about 
                        
                           
                              
                                 θ
                              
                              0
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       β
                                    
                                    0
                                    ′
                                 
                                 ,
                                 
                                    σ
                                    0
                                 
                                 )
                              
                              ′
                           
                        
                     
                     
                        
                           
                              
                                 
                                    0
                                 
                                 =
                                 ∇
                                 
                                    
                                       D
                                       ^
                                    
                                    
                                       q
                                       ,
                                       λ
                                    
                                 
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       ^
                                    
                                    )
                                 
                                 =
                                 ∇
                                 
                                    
                                       D
                                       ^
                                    
                                    
                                       q
                                       ,
                                       λ
                                    
                                 
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       0
                                    
                                    )
                                 
                                 +
                                 
                                    ∇
                                    2
                                 
                                 
                                    
                                       D
                                       ^
                                    
                                    
                                       q
                                       ,
                                       λ
                                    
                                 
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       0
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       ^
                                    
                                    −
                                    
                                       
                                          θ
                                       
                                       0
                                    
                                    )
                                 
                                 +
                                 
                                    o
                                    (
                                    |
                                 
                                 
                                    
                                       θ
                                    
                                    ^
                                 
                                 −
                                 
                                    
                                       θ
                                    
                                    0
                                 
                                 
                                    |
                                    )
                                 
                                 ,
                              
                           
                        
                     Rearranging the above expression and applying the Law of Large Numbers gives the following approximation for the bias as n → ∞:

                        
                           (A.1)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                ^
                                             
                                             
                                                q
                                                ,
                                                
                                                   λ
                                                   n
                                                
                                             
                                          
                                          −
                                          
                                             
                                                θ
                                             
                                             0
                                          
                                          ≈
                                          
                                             A
                                             
                                                −
                                                1
                                             
                                          
                                          E
                                          
                                             [
                                             
                                                
                                                   D
                                                   ^
                                                
                                                
                                                   q
                                                   ,
                                                   λ
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   0
                                                
                                                )
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             A
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             {
                                             E
                                             
                                                [
                                                
                                                   w
                                                   
                                                      q
                                                      ,
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   Y
                                                   ,
                                                   X
                                                   ,
                                                   
                                                      
                                                         θ
                                                      
                                                      0
                                                   
                                                   )
                                                
                                                u
                                                
                                                   (
                                                   Y
                                                   ,
                                                   X
                                                   ,
                                                   
                                                      
                                                         θ
                                                      
                                                      0
                                                   
                                                   )
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             +
                                             ∇
                                             
                                                pen
                                                
                                                   q
                                                   ,
                                                   
                                                      λ
                                                      n
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   0
                                                
                                                )
                                             
                                             }
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              w
                              
                                 q
                                 ,
                                 i
                              
                           
                           
                              (
                              Y
                              ,
                              X
                              ,
                              
                                 θ
                              
                              )
                           
                           =
                           f
                           
                              
                                 (
                                 
                                    (
                                    Y
                                    −
                                    
                                       
                                          X
                                       
                                       ′
                                    
                                    
                                       β
                                    
                                    )
                                 
                                 /
                                 σ
                                 )
                              
                              
                                 1
                                 −
                                 q
                              
                           
                           ,
                        
                     
                     
                        
                           u
                           
                              (
                              Y
                              ,
                              X
                              ,
                              
                                 θ
                              
                              )
                           
                           =
                           ∇
                           log
                           f
                           (
                           
                              (
                              Y
                              −
                              
                                 
                                    X
                                 
                                 ′
                              
                              
                                 β
                              
                              )
                           
                           /
                           σ
                           )
                           ,
                        
                     
                     
                        
                           
                              pen
                              
                                 q
                                 ,
                                 
                                    λ
                                    n
                                 
                              
                           
                           
                              (
                              
                                 θ
                              
                              )
                           
                           =
                           −
                           
                              ∑
                              j
                           
                           
                              L
                              q
                           
                           f
                           
                              (
                              
                                 β
                                 j
                              
                              ;
                              
                                 λ
                                 n
                              
                              )
                           
                        
                      and 
                        
                           A
                           =
                           −
                           E
                           [
                           ∇
                           
                              w
                              
                                 q
                                 ,
                                 i
                              
                           
                           
                              (
                              Y
                              ,
                              X
                              ,
                              
                                 
                                    θ
                                 
                                 0
                              
                              )
                           
                        
                     
                     
                        
                           u
                           
                              (
                              Y
                              ,
                              X
                              ,
                              
                                 
                                    θ
                                 
                                 0
                              
                              )
                           
                           
                              ]
                              +
                           
                           
                              ∇
                              2
                           
                           
                              pen
                              
                                 λ
                                 n
                              
                           
                           
                              (
                              
                                 θ
                              
                              )
                           
                        
                      is typically a positive definite matrix (this the usual Fisher information matrix when 
                        
                           λ
                           =
                           0
                        
                      and 
                        
                           q
                           =
                           1
                        
                     ). From Eq. (A.1), we can distinguish two potential sources of asymptotic bias. The first source of bias is given by the term 
                        
                           
                              B
                              1
                           
                           =
                           E
                           
                              [
                              
                                 w
                                 
                                    q
                                    ,
                                    i
                                 
                              
                              
                                 (
                                 Y
                                 ,
                                 X
                                 ,
                                 
                                    
                                       θ
                                    
                                    0
                                 
                                 )
                              
                              u
                              
                                 (
                                 Y
                                 ,
                                 X
                                 ,
                                 
                                    
                                       θ
                                    
                                    0
                                 
                                 )
                              
                              ]
                           
                        
                     . For a similar estimator without the penalty term, Ferrari and La Vecchia (2012) show how to correct such a bias and obtain fisher consistency; following their Proposition 1, we have that 
                        
                           
                              B
                              1
                           
                           =
                           0
                        
                      if and only if we take values 
                        β
                      and σ such that 
                        
                           f
                           
                              (
                              
                                 (
                                 y
                                 −
                                 
                                    x
                                    ′
                                 
                                 
                                    β
                                 
                                 )
                              
                              /
                              σ
                              )
                           
                           =
                           
                              f
                              q
                           
                           
                              (
                              
                                 (
                                 y
                                 −
                                 
                                    x
                                    i
                                 
                                 
                                    
                                       β
                                    
                                    ^
                                 
                                 )
                              
                              /
                              
                                 σ
                                 ^
                              
                              )
                           
                           ,
                        
                      where fq
                      is the power-transformation of the pdf f given in Section 3.1. For example, if f is the normal pdf, then we take 
                        
                           
                              β
                           
                           =
                           
                              
                                 β
                              
                              ^
                           
                        
                      and 
                        
                           σ
                           =
                           
                              σ
                              ^
                           
                           /
                           
                              q
                           
                        
                      as final estimates. This transformation implies that the first summand in (5) is equal to zero when n → ∞.

The second source of bias arises from the term 
                        
                           ∇
                           
                              pen
                              
                                 q
                                 ,
                                 
                                    λ
                                    n
                                 
                              
                           
                           
                              (
                              
                                 θ
                              
                              )
                           
                        
                      which is generally necessary to prevent over-fitting in over-parametrized problems. We note, however, the bias becomes negligible when the tuning parameter λ is sufficiently large. For example h(β; λ) is the Laplace density function 
                        
                           h
                           
                              (
                              β
                              ;
                              λ
                              )
                           
                           =
                           
                              2
                              
                                 −
                                 1
                              
                           
                           λ
                           exp
                           
                              {
                              −
                              λ
                              |
                              β
                              |
                              }
                           
                           ,
                        
                      we have

                        
                           (A.2)
                           
                              
                                 
                                    
                                       
                                          |
                                          
                                          
                                             
                                                ∂
                                                
                                                   ∂
                                                   
                                                      β
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             pen
                                             
                                                q
                                                ,
                                                
                                                   λ
                                                   n
                                                
                                             
                                          
                                          
                                             (
                                             
                                                θ
                                             
                                             )
                                          
                                          |
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          |
                                          
                                             v
                                             
                                                q
                                                ,
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                β
                                                j
                                             
                                             ,
                                             
                                                λ
                                                n
                                             
                                             )
                                          
                                          s
                                          
                                             (
                                             
                                                β
                                                j
                                             
                                             ,
                                             
                                                λ
                                                n
                                             
                                             )
                                          
                                          |
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      λ
                                                      n
                                                      
                                                         2
                                                         −
                                                         q
                                                      
                                                   
                                                   
                                                      2
                                                      
                                                         1
                                                         −
                                                         q
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             e
                                             
                                                −
                                                
                                                   λ
                                                   n
                                                
                                                
                                                   |
                                                   
                                                      β
                                                      
                                                         0
                                                         ,
                                                         j
                                                      
                                                   
                                                   |
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   q
                                                   )
                                                
                                             
                                          
                                          sign
                                          
                                             (
                                             
                                                β
                                                
                                                   0
                                                   ,
                                                   j
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           sign
                           (
                           
                              β
                              
                                 0
                                 ,
                                 j
                              
                           
                           )
                           =
                           1
                        
                      if β
                     0, j
                      > 1, 
                        
                           sign
                           (
                           
                              β
                              
                                 0
                                 ,
                                 j
                              
                           
                           )
                           =
                           0
                        
                      if 
                        
                           
                              β
                              
                                 0
                                 ,
                                 j
                              
                           
                           =
                           0
                           ,
                        
                      and 
                        
                           sign
                           (
                           
                              β
                              
                                 0
                                 ,
                                 j
                              
                           
                           )
                           =
                           −
                           1
                        
                      if β
                     0, j
                      < 0 . Therefore 
                        
                           ∇
                           
                              pen
                              
                                 q
                                 ,
                                 
                                    λ
                                    n
                                 
                              
                           
                           
                              (
                              
                                 θ
                              
                              )
                           
                        
                      is close to zero if the tuning constant λn
                      is sufficiently large and q < 1, since the term 
                        
                           e
                           
                              −
                              
                                 λ
                                 n
                              
                              
                                 |
                                 
                                    β
                                    
                                       0
                                       ,
                                       j
                                    
                                 
                                 |
                              
                              
                                 (
                                 1
                                 −
                                 q
                                 )
                              
                           
                        
                      dominates the other terms in (A.2). Finally, Eq. (A.2) helps illustrate another important point: when q < 1 and min 
                        j
                     |β
                     0, j
                     | is large, the bias due to the penalty term tends to be automatically small. The same behavior, however, is not observed for the Lasso penalty since 
                        
                           q
                           =
                           1
                        
                      implies the presence of the biasing term λn
                     sign(β
                     0, j
                     ) in (A.2), which does not vanish as n → ∞ (unless λn
                      goes to zero at an appropriate rate, which would then imply absence of regularization).

An EM algorithm for t- portfolios can be derived by exploiting the well-known representation of the t- distribution as a mixture of heterogeneous normal densities with Gamma prior for the heterogeneity parameter. Let 
                        
                           Y
                           =
                           
                              
                                 (
                                 
                                    Y
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    Y
                                    n
                                 
                                 )
                              
                              ′
                           
                        
                      be the vector of returns of a target index and 
                        X
                     
                     
                        i
                      the vector of p asset returns at time 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     . Then, given the asset allocation weights 
                        β
                     , the variable 
                        
                           Z
                           =
                           (
                           Y
                           −
                           
                              
                                 X
                              
                              ′
                           
                           
                              β
                           
                           )
                           /
                           σ
                        
                      follows the t- distribution with ν degrees of freedom if and only if Zi
                      ∼ N(
                        
                           
                              
                                 X
                              
                              i
                              ′
                           
                           
                              β
                           
                        
                      
                     σ
                     2/Ui
                     ) and where Ui
                     , 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                           ,
                        
                      are independent variables following the Gamma distribution Γ(ν/2, ν/2). Let 
                        
                           U
                           =
                           
                              
                                 (
                                 
                                    U
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    U
                                    n
                                 
                                 )
                              
                              ′
                           
                        
                      and use f(·) and π(u; α, γ) to denote, respectively the standard normal and the Γ(α, γ) densities. The complete (re-weighted and penalized) log-likelihood function is

                        
                           (B.1)
                           
                              
                                 
                                    
                                       
                                          log
                                          L
                                          (
                                          X
                                          ,
                                          Y
                                          ,
                                          U
                                          ;
                                          
                                             β
                                          
                                          ,
                                          σ
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             w
                                             
                                                q
                                                ,
                                                i
                                             
                                          
                                          
                                             {
                                             log
                                             f
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            U
                                                            i
                                                         
                                                      
                                                      σ
                                                   
                                                
                                                
                                                   (
                                                   
                                                      Y
                                                      i
                                                   
                                                   −
                                                   
                                                      
                                                         X
                                                      
                                                      i
                                                      ′
                                                   
                                                   
                                                      β
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             +
                                             log
                                             π
                                             
                                                (
                                                
                                                   U
                                                   i
                                                
                                                ;
                                                
                                                   
                                                      ν
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      ν
                                                      2
                                                   
                                                
                                                )
                                             
                                             }
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             v
                                             
                                                q
                                                ,
                                                j
                                             
                                          
                                          log
                                          h
                                          
                                             (
                                             
                                                β
                                                j
                                             
                                             ;
                                             λ
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             w
                                             
                                                q
                                                ,
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   log
                                                   
                                                      σ
                                                      2
                                                   
                                                
                                                2
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             w
                                             
                                                q
                                                ,
                                                i
                                             
                                          
                                          
                                             U
                                             i
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         Y
                                                         i
                                                      
                                                      −
                                                      
                                                         X
                                                         i
                                                         ′
                                                      
                                                      
                                                         β
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                
                                                   2
                                                   
                                                      σ
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          λ
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             v
                                             
                                                q
                                                ,
                                                j
                                             
                                          
                                          
                                             |
                                             
                                                β
                                                j
                                             
                                             |
                                          
                                          +
                                          C
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where C is a term independent of the parameters 
                        β
                      or σ. Next, we compute the expected value of the complete log-likelihood function, with respect to the conditional distribution of U given Y under the current estimates of the parameters, denoted by 
                        β
                     
                     * and σ
                     *:

                        
                           (B.2)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             E
                                             
                                                U
                                                ;
                                                Y
                                             
                                          
                                          
                                             [
                                             log
                                             L
                                             
                                                (
                                                X
                                                ,
                                                Y
                                                ,
                                                U
                                                ;
                                                
                                                   β
                                                
                                                ,
                                                σ
                                                )
                                             
                                             ;
                                             
                                                
                                                   β
                                                
                                                *
                                             
                                             ,
                                             
                                                σ
                                                *
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          =
                                          log
                                          L
                                          
                                             (
                                             X
                                             ,
                                             Y
                                             ,
                                             
                                                E
                                                
                                                   U
                                                   ;
                                                   Y
                                                
                                             
                                             
                                                [
                                                U
                                                ;
                                                
                                                   
                                                      β
                                                   
                                                   *
                                                
                                                ,
                                                
                                                   σ
                                                   *
                                                
                                                ]
                                             
                                             ;
                                             
                                                β
                                             
                                             ,
                                             σ
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where the equality follows from the fact that (B.1) is linear in U. Since the Gamma distribution is the conjugate prior for the normal scale parameter, we have that the posterior distribution of Ui
                     , given 
                        
                           
                              Y
                              i
                           
                           −
                           
                              X
                              i
                              ′
                           
                           
                              
                                 β
                              
                              *
                           
                           ,
                        
                      is

                        
                           (B.3)
                           
                              
                                 
                                    
                                       
                                          
                                             U
                                             i
                                          
                                          ∼
                                          Γ
                                          
                                             (
                                             
                                                
                                                   
                                                      ν
                                                      +
                                                      1
                                                   
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   ν
                                                   2
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   q
                                                   ,
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            Y
                                                            i
                                                         
                                                         −
                                                         
                                                            X
                                                            i
                                                            ′
                                                         
                                                         
                                                            
                                                               β
                                                            
                                                            i
                                                            *
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            
                                                               σ
                                                               *
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     which implies

                        
                           (B.4)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                                i
                                             
                                             ^
                                          
                                          =
                                          
                                             E
                                             
                                                U
                                                i
                                             
                                          
                                          
                                             [
                                             
                                                U
                                                i
                                             
                                             ;
                                             
                                                
                                                   β
                                                
                                                *
                                             
                                             ,
                                             
                                                σ
                                                *
                                             
                                             ]
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      (
                                                      ν
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                            *
                                                         
                                                      
                                                      2
                                                   
                                                
                                                
                                                   ν
                                                   
                                                      
                                                         
                                                            σ
                                                            *
                                                         
                                                      
                                                      2
                                                   
                                                   +
                                                   
                                                      w
                                                      i
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            Y
                                                            i
                                                         
                                                         −
                                                         
                                                            X
                                                            i
                                                            ′
                                                         
                                                         
                                                            
                                                               β
                                                            
                                                            *
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The last expression is the E-Step in (18). The updating formulas for the parameters (16) and (17) in the M-Step are simply obtained by maximizing the complete log-likelihood (B.1) with Ui
                      replaced by its conditional expectation 
                        
                           
                              u
                              i
                           
                           ^
                        
                     .

@&#REFERENCES@&#

