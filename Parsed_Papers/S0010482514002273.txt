@&#MAIN-TITLE@&#Modeling of short-term mechanism of arterial pressure control in the cardiovascular system: Object-oriented and acausal approach

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We reimplemented model of hemodynamics of cardiovascular system.


                        
                        
                           
                           We recommend utilizing object-oriented and acausal features of Modelica language.


                        
                        
                           
                           The models of components focus on single phenomenon.


                        
                        
                           
                           The models of subsystems separate a subsystem behavior from a control mechanism.


                        
                        
                           
                           The whole model, its components and subsystems are more understandable and reusable.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Acausal modeling

MODELICA programming language

OPENMODELICA modeling environment

DYMOLA modeling environment

Cardiovascular system

@&#ABSTRACT@&#


               
               
                  This letter introduces an alternative approach to modeling the cardiovascular system with a short-term control mechanism published in Computers in Biology and Medicine, Vol. 47 (2014), pp. 104–112. We recommend using abstract components on a distinct physical level, separating the model into hydraulic components, subsystems of the cardiovascular system and individual subsystems of the control mechanism and scenario. We recommend utilizing an acausal modeling feature of Modelica language, which allows model variables to be expressed declaratively. Furthermore, the Modelica tool identifies which are the dependent and independent variables upon compilation. An example of our approach is introduced on several elementary components representing the hydraulic resistance to fluid flow and the elastic response of the vessel, among others.
                  The introduced model implementation can be more reusable and understandable for the general scientific community.
               
            

@&#INTRODUCTION@&#

Fernandez de Canete et al. [1] described a closed loop cardiovascular model and short-term and long-term mechanisms of arterial pressure control in the Modelica language and DYMOLA tool. The model is decomposed into several distinct components, which express computation of output volume, pressure and flow, based on elastance input, input flow and pressure. The basic blocks from standard Modelica libraries are composed together to model the whole hemodynamics with the control mechanism [1]. The process of computing of similar flowratevolume, pressure, elastance and resistance is repeated in multiple blocks of pulmonary circulation, systemic circulation and heart circulation [1].

Redundant definition of similar relations and the mixing of more phenomenon in a single component were identified as antipatterns (bad practices) by Tiller [2], who recommends expressing single phenomenon as a general component model. This should be conducted by composing a subsystem model with instances of component models and utilizing the object-oriented features of the Modelica language.

Additionally the model [1] defines the flow of the computation of output values from input values. It is identified as causal or signal-oriented modeling. Modelica allows the expression of models not only in the causal (signal) manner, but also in an acausal manner. The acausal modeling technique is based on the fact that model variables are expressed declaratively, and the Modelica tool identifies which are the dependent and independent variables upon compilation. We have shown that an acausal description captures the essence of the modeled reality much better, and the simulation models are much more legible and, thus, also less prone to mistakes [3]. With the greatest respect to the authors of the above-mentioned publication, we would like to introduce an alternative implementation of the original model with recommendations to reduce redundancy and utilize acausal and object-oriented modeling techniques. An example of our approach is shown with respect to an elastic vessel component with unstressed volume and external pressure.

As a result of the acausal approach we believe that the alternative implementation method introduced can be more reusable by the scientific community for educational as well as for research purposes.

Additionally, Modelica tools allow rich sets of numerical solving methods for further simulation and analysis, as well as export to third party tools used by computational physiologists.

Supplementary materials contain a full source code of the alternative model implementation derived from the original publication in the Modelica language together with dependent libraries.

@&#METHODS@&#

Model behavior (equations) can be expressed in Modelica in text form and in graphical form – diagram. Later in this paper we present text form as a source code listing and graphical form as detailed by the figures.

To introduce an alternative implementation of the original model, the following recommendations should be followed:
                        
                           (a)
                           Introduce an acausal connector for a hydraulic domain with “flow” variable q–flowrate and “non-flow” variable p–pressure. Introduce a single component for an elastic vessel, a hydraulic resistor and a cardiac valve with one or two acausal connectors and describe equations of volumetric flow, volume and pressure based on the parameters of elastance and resistance.

Separate a general model from a control model and a specific experiment. Utilize object-oriented features of the Modelica language to reuse the architecture model and replace the concrete implementation of the subsystem model with a derived model experiment.

Prefer the text form of Modelica notation to define equations on a component level model. Prefer the diagram form of Modelica notation to express relations between components on a higher subsystem and system level model.

We have recently published a Modelica library, referred to as Physiolibrary [4], to support modeling in the physiological domain. The library contains several hydraulic components that can be directly used to model the cardiovascular system following the recommendation (a). Table 1
                      contains icon, description and equations characterizing the components. The equations of these components are defined in Modelica using text form following the recommendation (c) and can be seen in supplementary materials. The models of the pulmonary circulation and the systemic circulation are defined by diagrams in Figs. 1 and 2
                     
                      utilizing the components from Physiolibrary (from Table 1). The models are almost equivalent to the pulmonary and systemic blocks from the original work [1], apart from the pulmonary and aortic valves, that we moved to the model of the heart subsystem described later.

Additionally the systemic circulation contains a block to measure blood properties in aorta, it extends the existing block from Physiolibrary that measures flow. Additionally it computes systolic, diastolic and mean pressure during a single cardiac cycle. The mean arterial pressure P
                     
                        mean
                      during the cardiac cycle is counted as the average of pressure going into the component (
                        
                           
                              q
                           
                           
                              
                                 
                                    in
                                 
                                 
                                    pressure
                                 
                              
                           
                        
                     ) from the beginning of the cardiac cycle (T
                     0) during the heart period (HP) by formula:
                        
                           (1)
                           
                              
                                 
                                    P
                                 
                                 
                                    mean
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          HP
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          
                                             
                                                in
                                             
                                             
                                                pressure
                                             
                                          
                                       
                                    
                                    
                                    d
                                    t
                                 
                                 
                                    HP
                                 
                              
                           
                        
                     The component is declared by icon (
                        
                           
                              
                           
                        
                     ) and by the statements and equations in the following Modelica listing (shortened): 
                        
                           
                              
                                 
                                    
                                 
                              
                           
                        
                     
                  

We separate out the variable elastance(compliance) generator from the heart subsystem in Fig. 3
                     .

The block “pulsos” (identified by icon (
                        
                           
                              
                           
                        
                     ) generates the relative heart phase within the heart period during a simulation time based on the heart rate signal [1]. However, in contrast to the original implementation we define it in text form per recommendation (c), and with the changed behavior: the heart period HP is changed per the input signal heart rate only at the moment when the new cardiac cycle begins. The output signal “heartphase” modeled in the original work can be presented as the following equation:
                        
                           (2)
                           
                              heartphase
                              =
                              
                                 
                                    time
                                    −
                                    
                                       
                                          T
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    HP
                                 
                              
                           
                        
                     Thus, the model behavior is defined by the following listing: 
                        
                           
                              
                                 
                                    
                                 
                              
                           
                        
                     
                  

The heart model in Fig. 4
                      consists of the left and right parts; they are driven separately by the appropriate elastance generator, but with the same heart rate signal.

Finally, the generic model of the hemodynamics without any control mechanism is shown in Fig. 5
                     . Note that the diagram looks very similar to the usual conceptual decomposition of the cardiovascular system.

Following recommendation (b), the model defines heart, systemicCirculation and pulmonaryCirculation components as “replaceable” to allow replacement with some derived subtype of the model as seen from the text form of the model in the following listing: 
                        
                           
                              
                                 
                                    
                                 
                              
                           
                        
                     
                  

To simulate a particular scenario or control mechanism, selected parameters of the model need to be manipulated externally during simulation. We introduced derived model SystemicCirculation_baro and redeclared the constant block with a compatible control block as seen in the following listing which allows manipulation with the model parameter by an external component. 
                        
                           
                              
                                 
                                    
                                 
                              
                           
                        
                     
                  

The subsystem SystemicCirculation_baro contains additional input connectors connected with the previously redeclared control blocks as shown in Fig. 6
                     .

A similar technique is used for the heart component in Fig. 7
                     . The model of controllable hemodynamics is an extension of the generic model of hemodynamics. The model uses new implementation of the controllable heart and systemic circulation and introduces input and output connectors specific for the baroreceptor control system, as seen in the following listing and in Fig. 8
                     . 
                        
                           
                              
                                 
                                    
                                 
                              
                           
                        
                     
                  

The controllable model of hemodynamics is connected with baroreceptor module and with the module driving the simulation of stenosis, as shown in Fig. 9
                     
                  

@&#RESULTS@&#

The implementation was changed in the case of block pulsos and block AortaFlowMeasurement. Other parts are equivalent to the original work and use the same initial values of state variables and parameters [1]. The model can be executed in a free OPENMODELICA tool developed by Open Source Modelica Consortium [5]. The dynamics of the aortic pressure during a sudden change of elastance of vena cava shown in Fig. 10
                      gives similar results as the original work. The evolution of heart rate and ventricle elastance is smoother because the mean arterial pressure and the heart period signals are changed only at the beginning of the next cardiac cycle.

We believe that the recommendation (a) applied to the model allows it to better capture the essence of the modeled reality, in contrast to the original “signal”-like approach where it might be hard to deduce the concept of the model for a user who is not familiar with this modeling technique. Additionally further modification or enhancements of the basic component, e.g., elastic vessel by adding non-linear compliance or active tone, will be propagated to the existing model using this component with no or minimal need for further modification of the model. Such modification will appear in the model within the modified components as modified behavior or new parameters which can be set.

For example, the original model expresses the pressure p, volume V and compliance C (reciprocal value of elastance) as equation 
                        p
                        =
                        V
                        /
                        C
                     . In contrast to the original model, the alternative implementation modifies the basic element of elastic compartment with unstressed volume V
                     0 and external pressure p
                     0 as Eq. (6). V
                     0 and p
                     0 are set to 0 by default and can be changed in further model experiments.

Such enhancement is propagated by inheritance to all elastic compartments used within the model. When the original model [1] needs to be enhanced with such features of unstressed volume or external pressure effect, then more than one component (compartment with valve, compartment without valve and systemic circulation) needs to be modified.

The recommendation (b) applied to the generic model brings the advantage of a major feature of object-oriented programming – polymorphism. A model (e.g. Hemodynamics_pure) comprises a subsystem model of a certain type (e.g. Heart) will work correctly with another subsystem that is compatible with the certain type (e.g. Heart_baro). The subsystem models might be reimplemented and replaced in an existing model without touching the generic model. Therefore, it may be appropriate for specific in silico experiments.

The Modelica standard library allows equations to be expressed using blocks in diagrams; however, it should not be overused. For example, the recommendation (c) applied to the component “pulsos” shows the Eq. (2) cleanly in the text form of Modelica notation (see the listing above). During the reimplementation of this block, we reformulated the method of changing the heart rate signal where heart period and pulse generation are updated at the beginning of the next cardiac cycle. This facilitates the computation. In the original work, the heart period and pulse generation are changed immediately. This difference is seen in simulating the baroreflex control, where the control mechanism is smoother, as seen in Fig. 10.

On the higher subsystem level, the recommendation (c) is optional. If there are more relations among components then a diagram form may be more understandable than a textual form. For example, the block VariableElasticityGenerator in Fig. 3 can be expressed in an equivalent text form as seen in the following model listing: 
                        
                           
                              
                                 
                                    
                                 
                              
                           
                        
                     
                  

The original work contains a long-term pressure control mechanism, which was not implemented within this alternative implementation. However, it can be done following the above recommendations similar to the presented short-term “baroreflex” pressure control.

We believe that the introduced alternative approach to modeling the cardiovascular system will enhance the understandability and reusability of the excellent work done by the authors of the original model.

None declared.

@&#ACKNOWLEDGMENTS@&#

This paper describes the outcome of research that has been accomplished as part of a research program funded by the Ministry of Industry and Trade of the Czech Republic via the grant FR-TI3/869; and by The Ministry of Education, Youth and Sports via the grant SVV-2014-260033.

Supplementary data associated with this article can be found in the online version at doi:10.1016/j.compbiomed.2014.08.025.


                     
                        
                           Application 1
                           
                        
                     
                  

@&#REFERENCES@&#

