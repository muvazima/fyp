@&#MAIN-TITLE@&#The traveling salesman problem with time-dependent service times

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We introduce and model the traveling salesman problem with time-dependent service times.


                        
                        
                           
                           The proposed model can handle several types of service time functions, such as linear and quadratic.


                        
                        
                           
                           We describe properties of the service time function and compute valid lower and upper bounds.


                        
                        
                           
                           We propose and compare several mathematical programming formulations for the problem.


                        
                        
                           
                           Comparative computational results indicate that a flow based formulation is superior the other three.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Traveling salesman problem

Time-dependency

Service times

Lower and upper bounds

@&#ABSTRACT@&#


               
               
                  This paper introduces a version of the classical traveling salesman problem with time-dependent service times. In our setting, the duration required to provide service to any customer is not fixed but defined as a function of the time at which service starts at that location. The objective is to minimize the total route duration, which consists of the total travel time plus the total service time. The proposed model can handle several types of service time functions, e.g., linear and quadratic functions. We describe basic properties for certain classes of service time functions, followed by the computation of valid lower and upper bounds. We apply several classes of subtour elimination constraints and measure their effect on the performance of our model. Numerical results obtained by implementing different linear and quadratic service time functions on several test instances are presented.
               
            

@&#INTRODUCTION@&#

The purpose of this paper is to introduce, model and solve a version of the classical traveling salesman problem (TSP) with time-dependent service times (TSP-TS), an extension of the asymmetric TSP. Öncan, Altınel, and Laporte (2009), and Roberti and Toth (2012) present comprehensive reviews of the available mathematical formulations for the asymmetric TSP, some of which will be extended to model the TSP-TS.

In most of the research on the TSP, service times are either ignored, or assumed to be constant and thus accounted for in travel times. However in practice, it can easily be observed that service times vary according to several factors which naturally depend on the time of day (e.g., availability of parking spaces, accessibility to the customer at its location, and so on). In the TSP-TS, the service time required at each customer is not fixed a priori, but depends on the start time of service. The TSP-TS aims to minimize the total route duration including the total travel time and the total service time. This problem can formally be defined on a connected digraph 
                        
                           G
                           =
                           (
                           N
                           ,
                           A
                           )
                        
                     . In this graph, 
                        
                           N
                           =
                           {
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                           ,
                           n
                           +
                           1
                           }
                        
                      is the set of nodes and 
                        
                           A
                           =
                           {
                           (
                           i
                           ,
                           j
                           )
                           
                           |
                           
                           i
                           ,
                           j
                           ∈
                           N
                           ,
                           i
                           ≠
                           j
                           }
                        
                      is the set of arcs. Nodes 0 and 
                        
                           n
                           +
                           1
                        
                      correspond to the starting and ending points of the salesman’s tour, respectively. Each node in 
                        
                           N
                           ∖
                           
                              {
                              0
                              ,
                              n
                              +
                              1
                              }
                           
                        
                      corresponds to a distinct customer. With each arc (i, j) in A is associated a travel time tij
                     . Each customer i has a service time defined as a continuous function si
                     (bi
                     ), where bi
                      corresponds to the start time of service at that customer location.

In the TSP literature, time-dependency is usually addressed in terms of travel times. The interested reader is referred to Gouveia and Voß (1995) who present a classification of formulations proposed for the time-dependent TSP. Picard and Queyranne (1978), Vander Wiel and Sahinidis (1996), and Bigras, Gamache, and Savard (2008) consider a time-dependent TSP in which the travel time between any two nodes depends on the time period of the day. It is further assumed that when the salesman starts traversing an arc, no transition from one time period to the next takes place during this travel, in other words there is no transient zone. More specifically, the travel time from node i to node j depends on the time period in which node i is visited. This problem with discrete travel times can be viewed as a single machine scheduling problem with sequence-dependent setup times. Picard and Queyranne (1978) provide three integer programming formulations for the time-dependent TSP. The authors analyze the relationships between the relaxations of these models by comparing their lower bounds. It is observed that the shortest path relaxation (related to the first model) is very similar to a formulation proposed by Hadley (1964) for the classical TSP. Vander Wiel and Sahinidis (1996) propose an algorithm for the time-dependent TSP, based on applying Benders decomposition to a mixed-integer linear programming formulation. The authors also develop a network-based algorithm to identify Pareto-optimal dual solutions of the highly degenerate subproblems. Results indicate that the performance of the algorithm is considerably improved by employing these Pareto-optimal solutions. In Bigras et al. (2008), the integer programming formulations of the time-dependent TSP are extended to solve a single machine scheduling problems with sequence-dependent setup times. Two separate objectives are considered: minimizing total flow time and minimizing total tardiness. Instances with 45 and 50 jobs can be solved exactly by the proposed branch-and-bound algorithm.

A main difference between our problem and those presented in the papers mentioned above (Bigras et al., 2008; Gouveia & Voß, 1995; Picard & Queyranne, 1978; Vander Wiel & Sahinidis, 1996) lies in the way of modeling the time-dependent component. In these papers, a discrete travel time matrix is employed, which defines the travel time along each arc with respect to the position of that arc in the tour. In other words, time-dependency is associated with the visiting order of customers, not with the arrival time or the departure time. In our problem, however, service duration is defined as a continuous function of the time at which service starts. This definition makes our problem different from the time-dependent versions studied in Bigras et al. (2008), Gouveia and Voß (1995), Picard and Queyranne (1978), Vander Wiel and Sahinidis (1996), and thus the methods proposed in these papers are not applicable to our problem.


                     Cordeau, Ghiani, and Guerriero (2014) consider a time-dependent TSP in which the predetermined time horizon is partitioned into a number of time intervals, and the average travel speed on each arc during each interval is known. The travel time on each arc is then computed by a procedure introduced by Ichoua, Gendreau, and Potvin (2003), and a branch-and-cut procedure is developed to solve the problem. The proposed algorithm is capable of solving instances with up to 40 nodes. In principle, a special case of our problem with linear service times can be solved by the algorithm of Cordeau et al. (2014). In that paper, travel speed functions are defined by employing the degradation of the congestion factors and the authors report that their algorithm works as long as the values of these factors are set within a given interval (approximately [0.7, 1.0]). In our case, if we consider a linear service time function, small service times occur early in the route and large service times occur towards the end. The former case translates into high degradation of congestion factors and the latter case translates into low degradation of congestion factors, which corresponds to values well outside the interval considered in Cordeau et al. (2014). Furthermore, our model can solve instances in which the FIFO property does not hold whereas this property is required for the algorithm proposed in Cordeau et al. (2014).

In terms of the service cost, Tagmouti, Gendreau, and Potvin (2007), Tagmouti, Gendreau, and Potvin (2010), Tagmouti, Gendreau, and Potvin (2011) consider time-dependency within the scope of the Capacitated Arc Routing Problem (CARP). The classical CARP aims to serve a set of required arcs at minimum cost, using a fleet of capacitated vehicles based at the depot. The three above-mentioned papers focus on a version of the CARP where each arc has a time-dependent service cost but a fixed service time. Tagmouti et al. (2007) develop a column generation algorithm, and Tagmouti et al. (2010, 2011) propose heuristics.

To the best of our knowledge, the TSP-TS has never been considered previously. In contrast to what is done in the papers just mentioned, we can handle several types of service time functions, such as linear and quadratic functions. Moreover, time-dependent service times are included into the model not only through the objective function (e.g., models with time-dependent travel times), but also through the constraints. More specifically, the service time cannot be incorporated into the arc durations.

The remainder of this paper is organized as follows. In Section 2, we describe properties of the service time function and provide the computation of a valid lower bound on the total service time of an optimal solution to our problem. In Section 3, we propose a formulation for the TSP-TS, together with three variants based on different forms of subtour elimination constraints. We also present the computation of a lower bound on the bigM which is employed in our model. Section 4 reports computational results corresponding to different subtour elimination constraints and different service time functions. This section also provides the computation of a valid upper bound on the total route duration of an optimal solution. Finally, our main findings and conclusions are highlighted in Section 5.

In this section, we present the certain properties of the service time function si
                     (bi
                     ) at node i.

The first property is related to the First-In-First-Out (FIFO) principle which states that if service at node i starts at a time bi
                        , any service starting at a later time 
                           
                              b
                              i
                              ′
                           
                         at that node cannot be completed earlier than 
                           
                              
                                 b
                                 i
                              
                              +
                              
                                 s
                                 i
                              
                              
                                 (
                                 
                                    b
                                    i
                                 
                                 )
                              
                           
                        .

                           Proposition 2.1
                           
                              si
                              (bi
                              ) satisfies the FIFO property if and only if
                              
                                 
                                    
                                       
                                          
                                             d
                                             
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   b
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             d
                                             
                                                b
                                                i
                                             
                                          
                                       
                                    
                                    ≥
                                    
                                       −
                                       1
                                    
                                 
                              
                              .
                           

(→ necessity)

If si
                              (bi
                              ) satisfies the FIFO property, then

                                 
                                    
                                       
                                          
                                             b
                                             i
                                          
                                          +
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          ≤
                                          
                                             
                                                b
                                                i
                                                ′
                                             
                                             +
                                             
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   b
                                                   i
                                                   ′
                                                
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                              for all 
                                 
                                    
                                       b
                                       i
                                       ′
                                    
                                    >
                                    
                                       b
                                       i
                                    
                                 
                              . The above statement can be rewritten as

                                 
                                    
                                       
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                b
                                                i
                                                ′
                                             
                                             )
                                          
                                          −
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          ≥
                                          
                                             −
                                             (
                                             
                                                b
                                                i
                                                ′
                                             
                                             −
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              where 
                                 
                                    
                                       b
                                       i
                                       ′
                                    
                                    =
                                    
                                       b
                                       i
                                    
                                    +
                                    δ
                                 
                               and δ > 0. The latter inequality yields

                                 
                                    
                                       
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                b
                                                i
                                             
                                             +
                                             δ
                                             )
                                          
                                          −
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          ≥
                                          
                                             −
                                             δ
                                          
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                      
                                                      +
                                                      δ
                                                      )
                                                   
                                                   −
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                      
                                                      )
                                                   
                                                
                                                δ
                                             
                                          
                                          ≥
                                          
                                             −
                                             1
                                          
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             lim
                                             
                                                δ
                                                →
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                      
                                                      +
                                                      δ
                                                      )
                                                   
                                                   −
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                      
                                                      )
                                                   
                                                
                                                δ
                                             
                                          
                                          ≥
                                          
                                             
                                                lim
                                                
                                                   δ
                                                   →
                                                   0
                                                
                                             
                                             −
                                             1
                                          
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                      
                                                      )
                                                   
                                                
                                                
                                                   d
                                                   
                                                      b
                                                      i
                                                   
                                                
                                             
                                          
                                          ≥
                                          
                                             −
                                             1
                                          
                                          .
                                       
                                    
                                 
                              (← sufficiency)

It is given that si
                              (bi
                              ) is continuous on [
                                 
                                    
                                       b
                                       i
                                    
                                    ,
                                    
                                       b
                                       i
                                       ′
                                    
                                 
                              ] where 
                                 
                                    
                                       b
                                       i
                                       ′
                                    
                                    >
                                    
                                       b
                                       i
                                    
                                 
                              . From the mean value theorem, we know that there exists at least one point 
                                 
                                    b
                                    i
                                    *
                                 
                               in (
                                 
                                    
                                       b
                                       i
                                    
                                    ,
                                    
                                       b
                                       i
                                       ′
                                    
                                 
                              ) such that

                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                         *
                                                      
                                                      )
                                                   
                                                
                                                
                                                   d
                                                   
                                                      b
                                                      i
                                                      *
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                         ′
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      b
                                                      i
                                                      ′
                                                   
                                                   −
                                                   
                                                      b
                                                      i
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              If 
                                 
                                    
                                       
                                          
                                             d
                                             
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   b
                                                   i
                                                   *
                                                
                                                )
                                             
                                          
                                          
                                             d
                                             
                                                b
                                                i
                                                *
                                             
                                          
                                       
                                    
                                    ≥
                                    
                                       −
                                       1
                                    
                                 
                               for all 
                                 
                                    b
                                    i
                                    *
                                 
                               in (
                                 
                                    
                                       b
                                       i
                                    
                                    ,
                                    
                                       b
                                       i
                                       ′
                                    
                                 
                              ), then

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                         ′
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      b
                                                      i
                                                      ′
                                                   
                                                   −
                                                   
                                                      b
                                                      i
                                                   
                                                
                                             
                                          
                                          ≥
                                          
                                             −
                                             1
                                          
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          −
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                b
                                                i
                                                ′
                                             
                                             )
                                          
                                          +
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          ≤
                                          
                                             
                                                b
                                                i
                                                ′
                                             
                                             −
                                             
                                                b
                                                i
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             b
                                             i
                                          
                                          +
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                b
                                                i
                                             
                                             )
                                          
                                          ≤
                                          
                                             
                                                b
                                                i
                                                ′
                                             
                                             +
                                             
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   b
                                                   i
                                                   ′
                                                
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                              which means that the FIFO property is satisfied.□

Note that Proposition 2.1 holds for any service time function. At this point, it is worth observing that a TSP solution is not always optimal for the TSP-TS, even when we apply a service time function that satisfies the FIFO property starting from the first customer in the route. To illustrate, suppose that there are three customers (denoted by nodes 1, 2 and 3) and one depot (denoted by nodes 0 and 4), with the travel time matrix of Table 1
                        . The classical TSP has the two optimal solutions (0, 3, 1, 2, 4) and (0, 2, 1, 3, 4), with a total travel time equal to 11.75.

Now assume that for the TSP-TS represented by the same graph, the service time function is defined as 
                           
                              
                                 s
                                 i
                              
                              
                                 (
                                 
                                    b
                                    i
                                 
                                 )
                              
                              =
                              
                                 b
                                 
                                    i
                                 
                                 2
                              
                              −
                              6
                              
                                 b
                                 i
                              
                              +
                              9
                           
                         for all 
                           
                              i
                              ∈
                              
                                 N
                                 ∖
                                 
                                    {
                                    0
                                    ,
                                    n
                                    +
                                    1
                                    }
                                 
                              
                           
                        . From Proposition 2.1, the FIFO property is satisfied for all bi
                         ≥ 2.50. Note that in the TSP solutions, the salesman arrives at the first customer after the earliest time at which the FIFO property starts holding. Moreover, it is obvious that waiting at the depot or at a customer location does not bring any reduction in the total route duration. When we evaluate the two TSP solutions with the time-dependent service times defined above, we observe that the total route durations of the corresponding routes substantially increase to 419.35 and 501.81. The arrival times (AT) and departure times (DT) at each node of the TSP solution (0, 3, 1, 2, 4), which has a lower total route duration, are provided in Table 2
                         where there is no waiting. This table also gives the total travel time (TT) and the total service time (ST) spent until the departure of the salesman from each node.

The optimal solution of the TSP-TS is (0, 2, 3, 1, 4), with a total route duration of 331.75. Table 3
                         provides the details of the corresponding route at each node. As in the TSP solutions, waiting is not needed since it does not bring any reduction in the total route duration.

In a TSP-TS setting, the solution (0, 2, 3, 1, 4) has a lower duration than that of the TSP solutions (0, 3, 1, 2, 4) and (0, 2, 1, 3, 4). This observation implies that a TSP solution may not be optimal for the TSP-TS even when all customers have the same service time function and waiting does not provide any reduction in the total service time. Moreover, it shows that our problem may not correspond to the TSP even when all customers have the same quadratic service time function (with a unique minimum).

The second property is related to waiting. If si
                        (bi
                        ) does not satisfy the FIFO property when the salesman arrives at customer i, then it may pay to wait at that customer before starting service. We first provide a small example to illustrate this property. The related propositions are then presented.

Suppose that there are three customers (denoted by nodes 1, 2 and 3) and one depot (denoted by nodes 0 and 4). In this setting, 
                           
                              
                                 t
                                 
                                    i
                                    j
                                 
                              
                              =
                              0.50
                           
                         for all (i, j) in A, and 
                           
                              
                                 s
                                 i
                              
                              
                                 (
                                 
                                    b
                                    i
                                 
                                 )
                              
                              =
                              
                                 b
                                 
                                    i
                                 
                                 2
                              
                              −
                              4
                              
                                 b
                                 i
                              
                              +
                              4
                           
                         for all i ∈ N∖{0, 4}. From Proposition 2.1, the FIFO property is satisfied for all bi
                         ≥ 1.50. Consider a route that visits customers in the order 1, 2 and 3. Tables 4
                         and 5
                         provide the arrival times and the departure times at each node in the current route if waiting is not allowed and if waiting is allowed, respectively. These tables also present the total travel time and the total service time spent until the departure of the salesman from each node. In Table 5, we also provide in the last column the start time of service at each customer. If there is no waiting, the total service time is equal to 14.79. When waiting is allowed at the first customer, the total service time is reduced to 0.97.

This example shows that when the FIFO property is not always satisfied by the service time function, then the total route duration may be decreased by waiting. The related proposition follows.

                           Proposition 2.2
                           
                              If the salesman arrives at a customer i before
                              
                                 
                                    b
                                    i
                                    ′
                                 
                               
                              (the earliest time at which the FIFO property starts holding at that customer), waiting at that location to begin service at time
                              
                                 
                                    b
                                    i
                                    ′
                                 
                               
                              is then beneficial.
                           

Suppose that in a given route, each customer 
                                 
                                    j
                                    ∈
                                    
                                       N
                                       ∖
                                       
                                          {
                                          0
                                          ,
                                          n
                                          +
                                          1
                                          }
                                       
                                    
                                 
                               has a service time function sj
                              (bj
                              ) and waiting is not considered. The latter structure implies that the arrival time at any customer i is equivalent to the start time of service at that customer, which is represented by 
                                 
                                    
                                       b
                                       i
                                    
                                    ^
                                 
                              .

Suppose that si
                              (bi
                              ) satisfies the FIFO property for all bi
                               where 
                                 
                                    
                                       b
                                       i
                                       ′
                                    
                                    ≤
                                    
                                       b
                                       i
                                    
                                    ≤
                                    
                                       
                                          b
                                          i
                                       
                                       ¯
                                    
                                 
                               and 
                                 
                                    
                                       
                                          b
                                          i
                                       
                                       ^
                                    
                                    <
                                    
                                       b
                                       i
                                       ′
                                    
                                 
                              . More specifically, 
                                 
                                    
                                       
                                          
                                             d
                                             
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   b
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             d
                                             
                                                b
                                                i
                                             
                                          
                                       
                                    
                                    <
                                    −
                                    1
                                 
                               for all bi
                               such that 
                                 
                                    0
                                    ≤
                                    
                                       b
                                       i
                                    
                                    <
                                    
                                       b
                                       i
                                       ′
                                    
                                    ,
                                 
                               and therefore such that 
                                 
                                    
                                       b
                                       i
                                    
                                    ∈
                                    
                                       [
                                       
                                          
                                             b
                                             i
                                          
                                          ^
                                       
                                       ,
                                       
                                          b
                                          i
                                          ′
                                       
                                       )
                                    
                                 
                              . From the mean value theorem, we know that there exists at least one point 
                                 
                                    b
                                    i
                                    *
                                 
                               in (
                                 
                                    
                                       
                                          b
                                          i
                                       
                                       ^
                                    
                                    ,
                                    
                                       b
                                       i
                                       ′
                                    
                                 
                              ) such that

                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                         *
                                                      
                                                      )
                                                   
                                                
                                                
                                                   d
                                                   
                                                      b
                                                      i
                                                      *
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                         ′
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            b
                                                            i
                                                         
                                                         ^
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      b
                                                      i
                                                      ′
                                                   
                                                   −
                                                   
                                                      
                                                         b
                                                         i
                                                      
                                                      ^
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              Since 
                                 
                                    
                                       
                                          
                                             d
                                             
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   b
                                                   i
                                                   *
                                                
                                                )
                                             
                                          
                                          
                                             d
                                             
                                                b
                                                i
                                                *
                                             
                                          
                                       
                                    
                                    <
                                    −
                                    1
                                 
                               for all 
                                 
                                    
                                       
                                          b
                                          i
                                       
                                       ^
                                    
                                    <
                                    
                                       b
                                       i
                                       *
                                    
                                    <
                                    
                                       b
                                       i
                                       ′
                                    
                                    ,
                                 
                               then

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         i
                                                         ′
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            b
                                                            i
                                                         
                                                         ^
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      b
                                                      i
                                                      ′
                                                   
                                                   −
                                                   
                                                      
                                                         b
                                                         i
                                                      
                                                      ^
                                                   
                                                
                                             
                                          
                                          <
                                          −
                                          1
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                b
                                                i
                                                ′
                                             
                                             )
                                          
                                          −
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   b
                                                   i
                                                
                                                ^
                                             
                                             )
                                          
                                          <
                                          −
                                          
                                             (
                                             
                                                b
                                                i
                                                ′
                                             
                                             −
                                             
                                                
                                                   b
                                                   i
                                                
                                                ^
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                b
                                                i
                                                ′
                                             
                                             )
                                          
                                          +
                                          
                                             b
                                             i
                                             ′
                                          
                                          <
                                          
                                             s
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   b
                                                   i
                                                
                                                ^
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                b
                                                i
                                             
                                             ^
                                          
                                          .
                                       
                                    
                                 
                              The last inequality implies that instead of beginning service immediately, waiting at customer i until 
                                 
                                    b
                                    i
                                    ′
                                 
                               (until si
                              (bi
                              ) starts satisfying the FIFO property) is beneficial.□


                        Proposition 2.2 also holds for any service time function, even if there may be several points at which the FIFO property starts holding. For example, a cubic function may have a structure in which the FIFO property does not always hold. In such a case, we should define 
                           
                              b
                              i
                              ′
                           
                         as the point closest to 
                           
                              
                                 b
                                 i
                              
                              ^
                           
                         at which the FIFO property starts holding, where 
                           
                              
                                 
                                    b
                                    i
                                 
                                 ^
                              
                              <
                              
                                 b
                                 i
                                 ′
                              
                           
                        . More specifically, if customer i has a cubic service time function and the salesman arrives at i before 
                           
                              b
                              i
                              ′
                           
                         (the point closest to the arrival time at which the FIFO property starts holding at that customer), waiting at that location to begin service at time 
                           
                              b
                              i
                              ′
                           
                         is still beneficial. Note that in the following propositions, it is assumed that the service time function has only one point at which the FIFO property starts holding (linear or quadratic service time functions).

From Proposition 2.2, we distinguish two categories of service times: (i) each customer has a distinct service time function, and (ii) all customers have the same service time function. In Proposition 2.3, we consider the latter case and prove that all the waiting time can be shifted to the depot (instead of spending idle times at customer locations).

                           Proposition 2.3
                           
                              If all customers have the same service time function, then the waiting time required to satisfy the FIFO property can be spent at the depot.
                           

Consider a service time function sj
                              (bj
                              ) for all 
                                 
                                    j
                                    ∈
                                    
                                       N
                                       ∖
                                       
                                          {
                                          0
                                          ,
                                          n
                                          +
                                          1
                                          }
                                       
                                    
                                    ,
                                 
                               satisfying the FIFO property for all 
                                 
                                    
                                       b
                                       j
                                    
                                    ≥
                                    
                                       b
                                       j
                                       ′
                                    
                                    ≥
                                    0
                                 
                              . In other words, 
                                 
                                    b
                                    j
                                    ′
                                 
                               is the earliest time at which the FIFO property starts holding at each customer j. Let i be the first customer in a given route. First, the arrival time at customer i is equivalent to the start time of service at that customer, i.e., 
                                 
                                    
                                       b
                                       i
                                    
                                    ^
                                 
                              . From Proposition 2.2, we know that it is beneficial to delay service at customer i until 
                                 
                                    b
                                    i
                                    ′
                                 
                              . Since all customers have the same service time function, waiting at the first customer is sufficient to satisfy the FIFO property for all other customers (no additional waiting is needed to satisfy the FIFO along the route). This waiting time can be shifted to the depot. More specifically, waiting is needed only at the depot to satisfy the FIFO property for all customers.□

In this section, we derive a lower bound on the total service time of the optimal solution for the case where all customers have the same linear service time function.

                           Proposition 2.4
                           
                              When all customers
                              
                                 
                                    i
                                    ∈
                                    
                                       N
                                       ∖
                                       {
                                       0
                                       ,
                                       n
                                       +
                                       1
                                       }
                                    
                                 
                               
                              have the same linear service time function,
                              
                                 
                                    
                                       s
                                       i
                                    
                                    
                                       (
                                       
                                          b
                                          i
                                       
                                       )
                                    
                                    =
                                    β
                                    
                                       b
                                       i
                                    
                                    +
                                    γ
                                 
                               
                              where β, γ > 0 and si
                              (bi
                              ) > 0, the total service time of a route, computed by considering the first
                              
                                 
                                    n
                                    +
                                    1
                                 
                               
                              smallest travel times, yields a valid lower bound value on the total service time of the optimal solution.
                           

Observe that for the service time function defined as 
                                 
                                    
                                       s
                                       i
                                    
                                    
                                       (
                                       
                                          b
                                          i
                                       
                                       )
                                    
                                    =
                                    β
                                    
                                       b
                                       i
                                    
                                    +
                                    γ
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             d
                                             
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   b
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             d
                                             
                                                b
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    β
                                    >
                                    0
                                 
                              . In other words, si
                              (bi
                              ) is an increasing function when bi
                               ∈ [0, ∞), and thus waiting at the depot or at customer locations does not bring any reduction in the total route duration. Therefore, we know that si
                              (bi
                              ) satisfies the FIFO property at each customer 
                                 
                                    i
                                    ∈
                                    
                                       N
                                       ∖
                                       {
                                       0
                                       ,
                                       n
                                       +
                                       1
                                       }
                                    
                                 
                               for all bi
                               ≥ 0. Moreover, the latest possible departure time from the depot in any route r in G is equal to 0 due to the behavior of si
                              (bi
                              ) for bi
                               ∈ [0, ∞). Let (r, i) denote the i
                              th node visited by route r. Note that (r, 1) and (
                                 
                                    r
                                    ,
                                    n
                                    +
                                    2
                                 
                              ) correspond to the depot in each route r.

We have a symmetric travel time matrix in which node 0 and node 
                                 
                                    n
                                    +
                                    1
                                 
                               both correspond to the depot. First define a list L of travel times tij
                               for all j > i and 
                                 
                                    j
                                    ≠
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              . When the graph comprises only one customer, the travel time between that customer and the depot needs to be considered twice in the list L (the connection from the depot to the customer, and the connection from the customer to the depot). The list is then sorted in ascending order so that k < m implies L[k] < L[m], where L[k] is the k
                              th element of list L. We then construct a new directed graph 
                                 
                                    
                                       G
                                       ˜
                                    
                                    =
                                    
                                       (
                                       
                                          N
                                          ˜
                                       
                                       ,
                                       
                                          A
                                          ˜
                                       
                                       )
                                    
                                 
                               where 
                                 
                                    
                                       N
                                       ˜
                                    
                                    =
                                    
                                       {
                                       n
                                       +
                                       2
                                       ,
                                       n
                                       +
                                       3
                                       ,
                                       …
                                       ,
                                       2
                                       n
                                       +
                                       3
                                       }
                                    
                                 
                               is the set of nodes, and 
                                 
                                    
                                       A
                                       ˜
                                    
                                    =
                                    
                                       {
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       
                                       |
                                       
                                       i
                                       ∈
                                       
                                          
                                             N
                                             ˜
                                          
                                          ∖
                                          
                                             {
                                             2
                                             n
                                             +
                                             3
                                             }
                                          
                                          ,
                                          j
                                          =
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ∈
                                          
                                             
                                                N
                                                ˜
                                             
                                             ∖
                                             
                                                {
                                                n
                                                +
                                                2
                                                }
                                             
                                          
                                       
                                       }
                                    
                                 
                               is the set of arcs. In this graph, nodes 
                                 
                                    n
                                    +
                                    2
                                 
                               and 
                                 
                                    2
                                    n
                                    +
                                    3
                                 
                               can be viewed as the starting and ending points of each route. Each node 
                                 
                                    i
                                    ∈
                                    
                                       
                                          N
                                          ˜
                                       
                                       ∖
                                       
                                          {
                                          n
                                          +
                                          2
                                          ,
                                          2
                                          n
                                          +
                                          3
                                          }
                                       
                                    
                                 
                               has a service time defined by the original function si
                              (bi
                              ). Moreover, the travel time on each arc (i, j) in 
                                 
                                    
                                       A
                                       ˜
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       t
                                       ˜
                                    
                                    
                                       i
                                       j
                                    
                                 
                               is equal to 
                                 
                                    L
                                    [
                                    i
                                    −
                                    n
                                    −
                                    1
                                    ]
                                 
                              . From the definition of 
                                 
                                    
                                       G
                                       ˜
                                    
                                    ,
                                 
                               it can be observed that only one route (route p) starts and ends at the depot and visits each node 
                                 
                                    i
                                    ∈
                                    
                                       N
                                       ˜
                                    
                                 
                               exactly once. Suppose that the start time of service at the first node of this route (node 
                                 
                                    n
                                    +
                                    2
                                 
                              ) is set to 0. With respect to 
                                 
                                    b
                                    
                                       n
                                       +
                                       2
                                    
                                 
                               and to the service time spent at node 
                                 
                                    n
                                    +
                                    2
                                    ,
                                 
                               which is equal to 0 by definition, 
                                 
                                    b
                                    
                                       n
                                       +
                                       3
                                    
                                 
                               is computed as 
                                 
                                    
                                       t
                                       ˜
                                    
                                    
                                       n
                                       +
                                       2
                                       ,
                                       n
                                       +
                                       3
                                    
                                 
                              . We know that 
                                 
                                    
                                       b
                                       
                                          n
                                          +
                                          3
                                       
                                    
                                    ≤
                                    
                                       b
                                       
                                          (
                                          r
                                          ,
                                          2
                                          )
                                       
                                    
                                 
                               for any possible route r generated for the original problem since 
                                 
                                    
                                       
                                          t
                                          ˜
                                       
                                       
                                          n
                                          +
                                          2
                                          ,
                                          n
                                          +
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          
                                             min
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             {
                                             
                                                t
                                                
                                                   i
                                                   j
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                               and 
                                 
                                    
                                       b
                                       
                                          (
                                          r
                                          ,
                                          1
                                          )
                                       
                                    
                                    =
                                    0
                                 
                               for all r. Similarly, 
                                 
                                    b
                                    
                                       n
                                       +
                                       4
                                    
                                 
                               is equal to 
                                 
                                    
                                       
                                          t
                                          ˜
                                       
                                       
                                          n
                                          +
                                          2
                                          ,
                                          n
                                          +
                                          3
                                       
                                    
                                    +
                                    
                                       s
                                       
                                          n
                                          +
                                          3
                                       
                                    
                                    
                                       (
                                       
                                          b
                                          
                                             n
                                             +
                                             3
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          t
                                          ˜
                                       
                                       
                                          n
                                          +
                                          3
                                          ,
                                          n
                                          +
                                          4
                                       
                                    
                                 
                              . It is clear that 
                                 
                                    
                                       b
                                       
                                          n
                                          +
                                          4
                                       
                                    
                                    ≤
                                    
                                       b
                                       
                                          (
                                          r
                                          ,
                                          3
                                          )
                                       
                                    
                                 
                               for any route r, since

                                 
                                    (i)
                                    
                                       
                                          
                                             
                                                s
                                                
                                                   n
                                                   +
                                                   3
                                                
                                             
                                             
                                                (
                                                
                                                   b
                                                   
                                                      n
                                                      +
                                                      3
                                                   
                                                
                                                )
                                             
                                             ≤
                                             
                                                
                                                   s
                                                   
                                                      (
                                                      r
                                                      ,
                                                      2
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      
                                                         (
                                                         r
                                                         ,
                                                         2
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                             ,
                                          
                                       
                                    


                                       
                                          
                                             
                                                
                                                   t
                                                   ˜
                                                
                                                
                                                   n
                                                   +
                                                   2
                                                   ,
                                                   n
                                                   +
                                                   3
                                                
                                             
                                             +
                                             
                                                
                                                   t
                                                   ˜
                                                
                                                
                                                   n
                                                   +
                                                   3
                                                   ,
                                                   n
                                                   +
                                                   4
                                                
                                             
                                             ≤
                                             
                                                
                                                   t
                                                   
                                                      (
                                                      r
                                                      ,
                                                      1
                                                      )
                                                      ,
                                                      (
                                                      r
                                                      ,
                                                      2
                                                      )
                                                   
                                                
                                                +
                                                
                                                   t
                                                   
                                                      (
                                                      r
                                                      ,
                                                      2
                                                      )
                                                      ,
                                                      (
                                                      r
                                                      ,
                                                      3
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    

the latest possible departure time from the starting point of any route r is equal to 0.

Reiterating this process, we observe that 
                                 
                                    
                                       b
                                       i
                                    
                                    ≤
                                    
                                       b
                                       
                                          (
                                          r
                                          ,
                                          i
                                          −
                                          n
                                          −
                                          1
                                          )
                                       
                                    
                                 
                               at each node 
                                 
                                    i
                                    ∈
                                    
                                       N
                                       ˜
                                    
                                 
                               in route p and for any possible route r generated for the original problem where 
                                 
                                    (
                                    r
                                    ,
                                    i
                                    −
                                    n
                                    −
                                    1
                                    )
                                    ∈
                                    N
                                    ,
                                 
                               since

                                 
                                    (i)
                                    
                                       
                                          
                                             
                                                b
                                                
                                                   n
                                                   +
                                                   2
                                                
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                    


                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   n
                                                   +
                                                   2
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   t
                                                   ˜
                                                
                                                
                                                   k
                                                   ,
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             ≤
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      n
                                                      +
                                                      2
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   t
                                                   
                                                      (
                                                      r
                                                      ,
                                                      k
                                                      −
                                                      n
                                                      −
                                                      1
                                                      )
                                                      ,
                                                      (
                                                      r
                                                      ,
                                                      k
                                                      −
                                                      n
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                   ˜
                                                
                                                ∖
                                                
                                                   {
                                                   n
                                                   +
                                                   2
                                                   }
                                                
                                             
                                             ,
                                          
                                       
                                    


                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   n
                                                   +
                                                   2
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   s
                                                   k
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      k
                                                   
                                                   )
                                                
                                             
                                             ≤
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      n
                                                      +
                                                      2
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      s
                                                      
                                                         (
                                                         r
                                                         ,
                                                         k
                                                         −
                                                         n
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         
                                                            (
                                                            r
                                                            ,
                                                            k
                                                            −
                                                            n
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                   ˜
                                                
                                                ∖
                                                
                                                   {
                                                   n
                                                   +
                                                   2
                                                   }
                                                
                                             
                                          
                                       .

Thus, the total service time of route p yields a valid lower bound on the total service time in an optimal solution to the original problem defined with a linear (increasing) service time function at each customer.□

We now present mathematical models for the TSP-TS, where bi
                      is a decision variable corresponding to the start time of service at customer i. If there is no waiting at customer i, then bi
                      is equal to the arrival time at that customer. Waiting is allowed in this problem setting since it may be helpful to reduce the total service time spent at each customer in the route. In this model, the decision variable xij
                      takes the value 1 if node j is served immediately after node i, and 0 otherwise.

A mathematical model considering time-dependent service times is then

                        
                           (1)
                           
                              
                                 minimize
                                 
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       N
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       N
                                    
                                 
                                 
                                    
                                       t
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       
                                          N
                                          ∖
                                          {
                                          0
                                          ,
                                          n
                                          +
                                          1
                                          }
                                       
                                    
                                 
                                 
                                    
                                       s
                                       i
                                    
                                    
                                       (
                                       
                                          b
                                          i
                                       
                                       )
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 s.t.
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       
                                          N
                                          ∖
                                          {
                                          i
                                          }
                                       
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 i
                                 ∈
                                 
                                    N
                                    ∖
                                    {
                                    n
                                    +
                                    1
                                    }
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       
                                          N
                                          ∖
                                          {
                                          j
                                          }
                                       
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    N
                                    ∖
                                    {
                                    0
                                    }
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    b
                                    i
                                 
                                 +
                                 
                                    s
                                    i
                                 
                                 
                                    (
                                    
                                       b
                                       i
                                    
                                    )
                                 
                                 +
                                 
                                    t
                                    
                                       i
                                       j
                                    
                                 
                                 −
                                 M
                                 
                                    (
                                    1
                                    −
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    b
                                    j
                                 
                                 ,
                                 
                                 i
                                 ∈
                                 N
                                 ,
                                 j
                                 ∈
                                 N
                                 ,
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    b
                                    i
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 i
                                 ∈
                                 N
                                 ,
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 ,
                                 
                                 i
                                 ∈
                                 N
                                 ,
                                 j
                                 ∈
                                 N
                                 .
                              
                           
                        
                     The objective (1) is to minimize the total route duration which consists of the sum of the total travel time and the total service time. Constraints (2) and (3) ensure that each customer is visited exactly once, and impose the degree requirements for the two depot nodes. Constraints (4) link the departure time from a node and the starting time of service at its successor, and act as subtour elimination constraints. Constraints (5) ensure that the start time of service at each customer is non-negative. Constraints (6) indicate that partial service at customers is not allowed.

In Section 3.1, we present a number of additional subtour elimination constraints which provide valid cuts to the model and will be compared in Section 4.1. In Section 3.2, we provide a procedure to compute a lower bound on the bigM.

We consider the three additional subtour elimination constraints, which are reported by Öncan et al. (2009) and Roberti and Toth (2012) as the best when the model is solved directly by CPLEX IBM (2015), to enhance the performance of our formulation. In other words, these constraints can be used as valid inequalities in the model (1)–(6) (they are not needed to eliminate subtours since constraints (4) inherently prevent them).


                           Miller, Tucker, and Zemlin (1960) proposed the following MTZ subtour elimination constraints:

                              
                                 (7)
                                 
                                    
                                       
                                          u
                                          i
                                       
                                       −
                                       
                                          u
                                          j
                                       
                                       +
                                       n
                                       
                                          x
                                          
                                             i
                                             j
                                          
                                       
                                       ≤
                                       
                                          n
                                          −
                                          1
                                       
                                       ,
                                       
                                       i
                                       ,
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ,
                                    
                                 
                              
                           where ui
                           , 
                              
                                 i
                                 ∈
                                 
                                    N
                                    ∖
                                    {
                                    0
                                    ,
                                    n
                                    +
                                    1
                                    }
                                 
                              
                            is an arbitrary real number identifying the visiting order of customer i in a tour. Note that in the original paper, Miller et al. (1960) define the ui
                            variables without any bound.

The MTZ subtour elimination constraints were lifted by Desrochers and Laporte (1990), resulting in a stronger LP relaxation. The lifted constraints are stated as follows:

                              
                                 (8)
                                 
                                    
                                       
                                          u
                                          i
                                       
                                       −
                                       
                                          u
                                          j
                                       
                                       +
                                       n
                                       
                                          x
                                          
                                             i
                                             j
                                          
                                       
                                       +
                                       
                                          (
                                          n
                                          −
                                          2
                                          )
                                       
                                       
                                          x
                                          
                                             j
                                             i
                                          
                                       
                                       ≤
                                       
                                          n
                                          −
                                          1
                                       
                                       ,
                                       
                                       i
                                       ,
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       −
                                       
                                          u
                                          i
                                       
                                       +
                                       
                                          (
                                          n
                                          −
                                          2
                                          )
                                       
                                       
                                          x
                                          
                                             i
                                             ,
                                             n
                                             +
                                             1
                                          
                                       
                                       +
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             
                                                N
                                                ∖
                                                {
                                                0
                                                ,
                                                n
                                                +
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          x
                                          
                                             j
                                             i
                                          
                                       
                                       ≤
                                       
                                          −
                                          1
                                       
                                       ,
                                       
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       
                                          u
                                          i
                                       
                                       +
                                       
                                          (
                                          n
                                          −
                                          2
                                          )
                                       
                                       
                                          x
                                          
                                             0
                                             i
                                          
                                       
                                       +
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             
                                                N
                                                ∖
                                                {
                                                0
                                                ,
                                                n
                                                +
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          x
                                          
                                             i
                                             j
                                          
                                       
                                       ≤
                                       n
                                       ,
                                       
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       .
                                    
                                 
                              
                           
                           Desrochers and Laporte (1990) also proved that constraints (8) are facet defining.

Several single-commodity, two-commodity and multi-commodity flow formulations were introduced for the asymmetric TSP. The interested reader is referred to Langevin, Soumis, and Desrosiers (1990) for a comprehensive classification on commodity flow formulations. Gavish and Graves (1978) developed a single-commodity flow formulation for which the LP relaxation of the resulting model is stronger than that of the MTZ formulation but weaker than that of the classical Dantzig, Fulkerson and Johnson formulation (Dantzig, Fulkerson, & Johnson, 1954) (see Gouveia, 1995). In the GG formulation, subtours are eliminated by using 
                              
                                 n
                                 (
                                 n
                                 +
                                 1
                                 )
                              
                            non-negative variables gij
                           , where 
                              
                                 i
                                 ∈
                                 
                                    N
                                    ∖
                                    {
                                    0
                                    ,
                                    n
                                    +
                                    1
                                    }
                                 
                              
                            and j ∈ N∖{0}. The GG subtour elimination constraints of this formulation are stated as follows:

                              
                                 (11)
                                 
                                    
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             
                                                N
                                                ∖
                                                {
                                                0
                                                }
                                             
                                          
                                       
                                       
                                          g
                                          
                                             i
                                             j
                                          
                                       
                                       
                                       
                                       −
                                       
                                       
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             
                                                N
                                                ∖
                                                {
                                                0
                                                ,
                                                n
                                                +
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          g
                                          
                                             j
                                             i
                                          
                                       
                                       =
                                       1
                                       ,
                                       
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    
                                       0
                                       ≤
                                       
                                          g
                                          
                                             i
                                             j
                                          
                                       
                                       ≤
                                       n
                                       
                                          x
                                          
                                             i
                                             j
                                          
                                       
                                       ,
                                       
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ,
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       +
                                       1
                                       .
                                    
                                 
                              
                           In (11) and (12), the gij
                            variables denote the number of arcs on a tour from the depot to arc (i, j). Note that the starting point of each tour is represented by node 0. These two sets of constraints yield a network flow model in which the gij
                            variables naturally take integer values for fixed values of xij
                            variables.

In this section, we provide the computation of a sufficiently large value for the bigM to be used in constraints (4) of the formulation (1)–(6), where all customers first have the same quadratic service time function (with a unique minimum).

                           Proposition 3.1
                           
                              When all customers have the same quadratic service time function (with a unique minimum), the arrival time of the salesman at the last node in a route, computed by considering the first
                              
                                 
                                    n
                                    +
                                    1
                                 
                               
                              largest travel times, yields a valid value for M in formulation 
                              
                                 (1)
                              
                              –
                              
                                 (6)
                              
                              .
                           

Suppose that each customer 
                                 
                                    i
                                    ∈
                                    
                                       N
                                       ∖
                                       {
                                       0
                                       ,
                                       n
                                       +
                                       1
                                       }
                                    
                                 
                               has the same service time function 
                                 
                                    
                                       s
                                       i
                                    
                                    
                                       (
                                       
                                          b
                                          i
                                       
                                       )
                                    
                                    =
                                    α
                                    
                                       
                                          
                                             b
                                             i
                                          
                                       
                                       2
                                    
                                    −
                                    β
                                    
                                       b
                                       i
                                    
                                    +
                                    γ
                                    ,
                                 
                               where α, β, γ > 0 and si
                              (bi
                              ) ≥ 0, and that si
                              (bi
                              ) has a unique minimum value (the minimum service time) at 
                                 
                                    
                                       b
                                       i
                                    
                                    =
                                    β
                                    /
                                    2
                                    α
                                 
                              . Since 
                                 
                                    
                                       
                                          
                                             d
                                             
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   b
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             d
                                             
                                                b
                                                i
                                             
                                          
                                       
                                    
                                    ≥
                                    0
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                d
                                                2
                                             
                                             
                                                s
                                                i
                                             
                                             
                                                (
                                                
                                                   b
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             d
                                             
                                                b
                                                
                                                   i
                                                
                                                2
                                             
                                          
                                       
                                    
                                    >
                                    0
                                 
                               for all bi
                               ≥ β/2α, si
                              (bi
                              ) is an increasing function with an increasing derivative for bi
                               ∈ [β/2α, ∞). From Proposition 2.1, we know that si
                              (bi
                              ) satisfies the FIFO property at each customer 
                                 
                                    i
                                    ∈
                                    
                                       N
                                       ∖
                                       {
                                       0
                                       ,
                                       n
                                       +
                                       1
                                       }
                                    
                                 
                               for all 
                                 
                                    
                                       b
                                       i
                                    
                                    ≥
                                    
                                       (
                                       β
                                       −
                                       1
                                       )
                                       /
                                       2
                                       α
                                    
                                 
                              . From Proposition 2.3, we know that for any route r in G (starting and ending at the depot, and visiting each node exactly once), waiting at the depot to arrive at the first customer at 
                                 
                                    (
                                    β
                                    −
                                    1
                                    )
                                    /
                                    2
                                    α
                                 
                               is sufficient to satisfy the FIFO property (no additional waiting is needed for the FIFO along the route r). Moreover, the latest possible arrival time at the first customer in any route r in G is equal to β/2α due to the behavior of si
                              (bi
                              ) for bi
                               ∈ [β/2α, ∞). Let (r, i) denote the ith node visited by route r. Note that (r, 1) and (
                                 
                                    r
                                    ,
                                    n
                                    +
                                    2
                                 
                              ) correspond to the depot in each route r.

We have a symmetric travel time matrix in which nodes 0 and 
                                 
                                    n
                                    +
                                    1
                                 
                               both correspond to the depot. In order to compute a lower bound on the bigM, we first define a list L that contains travel times tij
                               for all j > i and 
                                 
                                    j
                                    ≠
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              . When the graph comprises only one customer, the travel time between that customer and the depot needs to be considered twice in the list L, once in each direction. This list is then sorted in decreasing order so that L[k] > L[m] when k < m, where L[k] is the k
                              th element of list L. We then construct a new directed graph 
                                 
                                    
                                       
                                          G
                                          
                                             
                                                (
                                             
                                          
                                       
                                       ¯
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             N
                                             
                                                
                                                   (
                                                
                                             
                                          
                                          ¯
                                       
                                       ,
                                       
                                          
                                             A
                                             
                                                
                                                   (
                                                
                                             
                                          
                                          ¯
                                       
                                       )
                                    
                                    ,
                                 
                               where 
                                 
                                    
                                       
                                          N
                                          
                                             
                                                (
                                             
                                          
                                       
                                       ¯
                                    
                                    =
                                    
                                       {
                                       n
                                       +
                                       2
                                       ,
                                       n
                                       +
                                       3
                                       ,
                                       …
                                       ,
                                       2
                                       n
                                       +
                                       3
                                       }
                                    
                                 
                               is the set of nodes and 
                                 
                                    
                                       
                                          A
                                          
                                             
                                                (
                                             
                                          
                                       
                                       ¯
                                    
                                    =
                                    
                                       {
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       
                                       |
                                       
                                       i
                                       ∈
                                       
                                          
                                             
                                                N
                                                
                                                   
                                                      (
                                                   
                                                
                                             
                                             ¯
                                          
                                          ∖
                                          
                                             {
                                             2
                                             n
                                             +
                                             3
                                             }
                                          
                                          ,
                                          j
                                          =
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ∈
                                          
                                             
                                                
                                                   N
                                                   
                                                      
                                                         (
                                                      
                                                   
                                                
                                                ¯
                                             
                                             ∖
                                             
                                                {
                                                n
                                                +
                                                2
                                                }
                                             
                                          
                                       
                                       }
                                    
                                 
                               is the set of arcs. In this graph, nodes 
                                 
                                    n
                                    +
                                    2
                                 
                               and 
                                 
                                    2
                                    n
                                    +
                                    3
                                 
                               can be viewed as the starting and ending points of each route. Each node 
                                 
                                    i
                                    ∈
                                    
                                       
                                          
                                             N
                                             
                                                
                                                   (
                                                
                                             
                                          
                                          ¯
                                       
                                       ∖
                                       
                                          {
                                          n
                                          +
                                          2
                                          ,
                                          2
                                          n
                                          +
                                          3
                                          }
                                       
                                    
                                 
                               has a service time defined by the original function si
                              (bi
                              ). Moreover, the travel time on each arc (i, j) in 
                                 
                                    
                                       
                                          A
                                          
                                             
                                                (
                                             
                                          
                                       
                                       ¯
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          t
                                          
                                             
                                                (
                                             
                                          
                                       
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                 
                               is equal to 
                                 
                                    L
                                    [
                                    i
                                    −
                                    n
                                    −
                                    1
                                    ]
                                 
                              . From the definition of 
                                 
                                    
                                       
                                          G
                                          
                                             
                                                (
                                             
                                          
                                       
                                       ¯
                                    
                                    ,
                                 
                               it can be observed that there exists only one route (route p) starting and ending at the depot, and visiting each node 
                                 
                                    i
                                    ∈
                                    
                                       
                                          N
                                          
                                             
                                                (
                                             
                                          
                                       
                                       ¯
                                    
                                 
                               exactly once. Suppose that the starting time of service at node 
                                 
                                    n
                                    +
                                    2
                                 
                               is set to β/2α. More specifically, si
                              (bi
                              ) satisfies the FIFO property at each node i in route p and waiting along that route does not yield any reduction in the total service time. With respect to 
                                 
                                    b
                                    
                                       n
                                       +
                                       2
                                    
                                 
                               and the service time spent at node 
                                 
                                    n
                                    +
                                    2
                                    ,
                                 
                               which is equal to 0 by definition, 
                                 
                                    b
                                    
                                       n
                                       +
                                       3
                                    
                                 
                               is computed as 
                                 
                                    
                                       (
                                       β
                                       /
                                       2
                                       α
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             t
                                             
                                                
                                                   (
                                                
                                             
                                          
                                          ¯
                                       
                                       
                                          n
                                          +
                                          2
                                          ,
                                          n
                                          +
                                          3
                                       
                                    
                                 
                              . We know that 
                                 
                                    
                                       b
                                       
                                          n
                                          +
                                          3
                                       
                                    
                                    ≥
                                    
                                       b
                                       
                                          (
                                          r
                                          ,
                                          2
                                          )
                                       
                                    
                                 
                               for any possible route r generated for the original problem since 
                                 
                                    
                                       
                                          
                                             t
                                             
                                                
                                                   (
                                                
                                             
                                          
                                          ¯
                                       
                                       
                                          n
                                          +
                                          2
                                          ,
                                          n
                                          +
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          
                                             max
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             {
                                             
                                                t
                                                
                                                   i
                                                   j
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                               and (β/2α) ≥ b
                              (r, 1) for all r. Similarly, 
                                 
                                    b
                                    
                                       n
                                       +
                                       4
                                    
                                 
                               is equal to 
                                 
                                    
                                       (
                                       β
                                       /
                                       2
                                       α
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             t
                                             
                                                
                                                   (
                                                
                                             
                                          
                                          ¯
                                       
                                       
                                          n
                                          +
                                          2
                                          ,
                                          n
                                          +
                                          3
                                       
                                    
                                    +
                                    
                                       s
                                       
                                          n
                                          +
                                          3
                                       
                                    
                                    
                                       (
                                       
                                          b
                                          
                                             n
                                             +
                                             3
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             t
                                             
                                                
                                                   (
                                                
                                             
                                          
                                          ¯
                                       
                                       
                                          n
                                          +
                                          3
                                          ,
                                          n
                                          +
                                          4
                                       
                                    
                                 
                              . It is clear that 
                                 
                                    
                                       b
                                       
                                          n
                                          +
                                          4
                                       
                                    
                                    ≥
                                    
                                       b
                                       
                                          (
                                          r
                                          ,
                                          3
                                          )
                                       
                                    
                                 
                               for any route r, since

                                 
                                    (i)
                                    
                                       
                                          
                                             
                                                s
                                                
                                                   n
                                                   +
                                                   3
                                                
                                             
                                             
                                                (
                                                
                                                   b
                                                   
                                                      n
                                                      +
                                                      3
                                                   
                                                
                                                )
                                             
                                             ≥
                                             
                                                
                                                   s
                                                   
                                                      (
                                                      r
                                                      ,
                                                      2
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      
                                                         (
                                                         r
                                                         ,
                                                         2
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                             ,
                                          
                                       
                                    


                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                      
                                                         
                                                            (
                                                         
                                                      
                                                   
                                                   ¯
                                                
                                                
                                                   n
                                                   +
                                                   2
                                                   ,
                                                   n
                                                   +
                                                   3
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      t
                                                      
                                                         
                                                            (
                                                         
                                                      
                                                   
                                                   ¯
                                                
                                                
                                                   n
                                                   +
                                                   3
                                                   ,
                                                   n
                                                   +
                                                   4
                                                
                                             
                                             ≥
                                             
                                                
                                                   t
                                                   
                                                      (
                                                      r
                                                      ,
                                                      1
                                                      )
                                                      ,
                                                      (
                                                      r
                                                      ,
                                                      2
                                                      )
                                                   
                                                
                                                +
                                                
                                                   t
                                                   
                                                      (
                                                      r
                                                      ,
                                                      2
                                                      )
                                                      ,
                                                      (
                                                      r
                                                      ,
                                                      3
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    


                                       β/2α is the latest possible departure time from the starting point of any route r.

Continuing in this fashion, we observe that 
                                 
                                    
                                       b
                                       i
                                    
                                    ≥
                                    
                                       b
                                       
                                          (
                                          r
                                          ,
                                          i
                                          −
                                          n
                                          −
                                          1
                                          )
                                       
                                    
                                 
                               at each node 
                                 
                                    i
                                    ∈
                                    
                                       
                                          N
                                          
                                             
                                                (
                                             
                                          
                                       
                                       ¯
                                    
                                 
                               in route p and for any possible route r generated for the original problem where 
                                 
                                    (
                                    r
                                    ,
                                    i
                                    −
                                    n
                                    −
                                    1
                                    )
                                    ∈
                                    N
                                    ,
                                 
                               since

                                 
                                    (i)
                                    
                                       
                                          
                                             
                                                b
                                                
                                                   n
                                                   +
                                                   2
                                                
                                             
                                             =
                                             β
                                             /
                                             2
                                             α
                                             ,
                                          
                                       
                                    


                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   n
                                                   +
                                                   2
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                      
                                                         
                                                            (
                                                         
                                                      
                                                   
                                                   ¯
                                                
                                                
                                                   k
                                                   ,
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             ≥
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      n
                                                      +
                                                      2
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   t
                                                   
                                                      (
                                                      r
                                                      ,
                                                      k
                                                      −
                                                      n
                                                      −
                                                      1
                                                      )
                                                      ,
                                                      (
                                                      r
                                                      ,
                                                      k
                                                      −
                                                      n
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             i
                                             ∈
                                             
                                                
                                                   
                                                      N
                                                      
                                                         
                                                            (
                                                         
                                                      
                                                   
                                                   ¯
                                                
                                                ∖
                                                
                                                   {
                                                   n
                                                   +
                                                   2
                                                   }
                                                
                                             
                                             ,
                                          
                                       
                                    


                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   n
                                                   +
                                                   2
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   s
                                                   k
                                                
                                                
                                                   (
                                                   
                                                      b
                                                      k
                                                   
                                                   )
                                                
                                             
                                             ≥
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      n
                                                      +
                                                      2
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      s
                                                      
                                                         (
                                                         r
                                                         ,
                                                         k
                                                         −
                                                         n
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         
                                                            (
                                                            r
                                                            ,
                                                            k
                                                            −
                                                            n
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             i
                                             ∈
                                             
                                                
                                                   
                                                      N
                                                      
                                                         
                                                            (
                                                         
                                                      
                                                   
                                                   ¯
                                                
                                                ∖
                                                
                                                   {
                                                   n
                                                   +
                                                   2
                                                   }
                                                
                                             
                                          
                                       .

Thus, we can conclude that 
                                 
                                    
                                       b
                                       
                                          2
                                          n
                                          +
                                          3
                                       
                                    
                                    ≥
                                    
                                       b
                                       
                                          (
                                          r
                                          ,
                                          n
                                          +
                                          2
                                          )
                                       
                                    
                                 
                               for any possible route r generated for the original problem defined on G, where 
                                 
                                    (
                                    r
                                    ,
                                    n
                                    +
                                    2
                                    )
                                 
                               corresponds to the depot. Note that the departure time of each route r from the starting point is optimized. In other words, the arrival time of the salesman at the end of route p provides a valid and reasonable value for the bigM to be employed in the original problem defined with a quadratic service time function (with a unique minimum) at each customer.□

If we consider a linear service time function, the route constructed by using the first 
                           
                              n
                              +
                              1
                           
                         largest travel times is also valid to compute a value for bigM. Suppose that each customer 
                           
                              i
                              ∈
                              
                                 N
                                 ∖
                                 {
                                 0
                                 ,
                                 n
                                 +
                                 1
                                 }
                              
                           
                         has the same linear (increasing) service time function 
                           
                              
                                 s
                                 i
                              
                              
                                 (
                                 
                                    b
                                    i
                                 
                                 )
                              
                              =
                              β
                              
                                 b
                                 i
                              
                              +
                              γ
                              ,
                           
                         where β, γ > 0 and si
                        (bi
                        ) > 0. We know that si
                        (bi
                        ) satisfies the FIFO property at each customer 
                           
                              i
                              ∈
                              
                                 N
                                 ∖
                                 {
                                 0
                                 ,
                                 n
                                 +
                                 1
                                 }
                              
                           
                         for all bi
                         ≥ 0 (see the proof of Proposition 2.4). In other words, waiting at the depot or at customer locations does not yield any reduction in the total route duration. It is easy to observe that when we adjust the latest possible departure time from the depot with respect to the linear function considered at each customer, all properties provided in the proof of Proposition 3.1 hold. Thus, one can employ the computation of the bigM when all customers have the same quadratic service time function (with a unique minimum) or the same linear (increasing) service time function.

The model just described was coded in C++ and solved by using IBM ILOG CPLEX 12.5 (IBM, 2015). All experiments were conducted on an Intel(R) Xeon(R) CPU X5675 with 12-Core 3.07 Gigahertz and 96 Gigabyte of RAM (by using a single thread). We have experimented with data sets presented in the TSPLIB library of Reinelt (1991). We have focused on the instances with up to 45 nodes defined with a symmetric travel time matrix (burma14, ulysses16, gr17, gr21, ulysses22, gr24, fri26, bayg29, bays29, dantzig42 and swiss42). In addition to these 11 instances, we have generated 11 more instances by selecting (i) the first 30 nodes from dantzig42, swiss42, att48, gr48, hk48 and eil51, (ii) the first 35 nodes from swiss42, gr48 and eil51, (iii) the first 40 nodes from eil51, and (iv) the first 45 nodes from eil51. The original travel times were adjusted in such a way that we have the same average travel time per arc in each instance. Note that in all these instances, there exists one more node for the ending depot, e.g., burma14 includes 15 nodes.

Each instance was first solved directly by CPLEX with the basic model defined by (1)–(6). To assess the effect of the additional constraints on the performance of the model, we have then applied three types of subtour elimination constraints: (i) MTZ, (ii) DL and (iii) GG. Each of these four formulations was enhanced by implementing: (i) an upper bound on the total route duration (B1), (ii) a lower bound on the total service time (B2), and (iii) a lower and an upper bound on the start time of service at each customer (B3). A maximum of 7200 seconds was imposed on the solution time of any instance. A linear service time function 
                           
                              
                                 s
                                 i
                              
                              =
                              
                                 10
                                 
                                    −
                                    2
                                 
                              
                              
                                 b
                                 i
                              
                              +
                              6
                              
                                 (
                                 
                                    10
                                    
                                       −
                                       2
                                    
                                 
                                 )
                              
                           
                         was employed for each customer 
                           
                              i
                              ∈
                              
                                 N
                                 ∖
                                 {
                                 0
                                 ,
                                 n
                                 +
                                 1
                                 }
                              
                           
                        . Note that this function provides medium service times with respect to other functions employed in Section 4.2.

We first present the above-mentioned valid bounds, starting with an upper bound on the total route duration of the optimal solution for the case where all customers have the same linear or quadratic service time function. If each customer 
                           
                              i
                              ∈
                              
                                 N
                                 ∖
                                 {
                                 0
                                 ,
                                 n
                                 +
                                 1
                                 }
                              
                           
                         has the same quadratic service time function (with a unique minimum) or the same linear (increasing) service time function, then the total route duration of a route constructed by implementing the nearest-neighbor heuristic provides a valid upper bound value on the optimal total route duration. Suppose that each customer 
                           
                              i
                              ∈
                              
                                 N
                                 ∖
                                 {
                                 0
                                 ,
                                 n
                                 +
                                 1
                                 }
                              
                           
                         has the same service time function, which is either 
                           
                              
                                 s
                                 i
                              
                              
                                 (
                                 
                                    b
                                    i
                                 
                                 )
                              
                              =
                              α
                              
                                 
                                    
                                       b
                                       i
                                    
                                 
                                 2
                              
                              −
                              β
                              
                                 b
                                 i
                              
                              +
                              γ
                           
                         where α, β, γ > 0 and si
                        (bi
                        ) ≥ 0, or 
                           
                              
                                 s
                                 i
                              
                              
                                 (
                                 
                                    b
                                    i
                                 
                                 )
                              
                              =
                              β
                              
                                 b
                                 i
                              
                              +
                              γ
                           
                         where β, γ > 0 and si
                        (bi
                        ) > 0. When we consider the first case with the quadratic service time function, we know that si
                        (bi
                        ) satisfies the FIFO property at each customer 
                           
                              i
                              ∈
                              
                                 N
                                 ∖
                                 {
                                 0
                                 ,
                                 n
                                 +
                                 1
                                 }
                              
                           
                         for all 
                           
                              
                                 b
                                 i
                              
                              ≥
                              
                                 (
                                 β
                                 −
                                 1
                                 )
                                 /
                                 2
                                 α
                              
                           
                         (see the proof of Proposition 3.1). Moreover, waiting at the depot to arrive at the first customer at 
                           
                              (
                              β
                              −
                              1
                              )
                              /
                              2
                              α
                           
                         is sufficient to satisfy the FIFO property (no additional waiting is needed for the FIFO along the route). If the linear function is employed, then si
                        (bi
                        ) satisfies the FIFO property at each customer 
                           
                              i
                              ∈
                              
                                 N
                                 ∖
                                 {
                                 0
                                 ,
                                 n
                                 +
                                 1
                                 }
                              
                           
                         for all bi
                         ≥ 0 (see the proof of Proposition 2.4). The nearest-neighbor heuristic starts building the route by moving to the closest customer to the depot in terms of the travel time. At each iteration, the algorithm selects the closest customer to the last node in the partial route not yet visited. This step is reiterated until all customers are routed, and the resulting route r is a feasible solution to the TSP-TS. Thus, the total route duration of route r, where the departure time from the depot is arranged with respect to the FIFO property of the service time function considered, provides an upper bound on the total duration of an optimal TSP-TS solution.

To implement a lower bound on the total service time, we perform the procedure described in Section 2.3. In addition to the lower and upper bounds (on the total service time and on the total route duration of the optimal solution), we implement two bounds on the start time of service at each customer location. The first related constraint employs an upper bound equal to the bigM used in the formulation (1)–(6). The second related constraint employs a lower bound equal to the earliest time at which the FIFO property starts holding.

The solution values obtained within the time limit (7200 seconds) by the basic model, enhanced by employing the bounds just mentioned, are provided by Table 6
                        . Tables 7
                        , 8
                         and 9
                         present the solution values found within the time limit when MTZ, DL and GG constraints are respectively incorporated into the enhanced model with all valid bounds. In these tables, we provide the status of solutions (feasible or optimal), the objective function value (Obj), the percentage of the total travel time in Obj (TT percent), the percentage of the total service time in Obj (ST percent), and the final optimality gap in percentage (Gap
                           f
                         percent). Moreover, we also report average values (Avg) calculated over the instances solved suboptimally and over the instances solved optimally.


                        Table 6 shows that the basic model cannot yield a feasible solution to six instances within the time limit. Optimal solutions are obtained for nine instances with up to 31 nodes, and the remaining seven instances are solved suboptimally. The results given in Table 7 indicate that the model with the MTZ subtour elimination constraints cannot provide a feasible solution to three instances within the time limit. Eight instances with up to 31 nodes are solved to optimality, and a feasible solution is provided to the remaining 11 instances. Moreover, the optimal solutions for the seven instances, which are provided both by the basic model and by the model with the MTZ subtour elimination constraints, are obtained within computation times smaller by 47.28 percent on average. Table 8 shows that the model with the DL subtour elimination constraints performs better than the basic model and also better than the model with the MTZ subtour elimination constraints (a feasible solution is obtained for each instance). Nine instances with up to 31 nodes are solved to optimality. The optimal solutions for the eight instances, which are also provided by the model with the MTZ subtour elimination constraints, are obtained within computation times smaller by 11.58 percent on average. Furthermore, the optimal solutions for the eight instances, which are provided both by the basic model and by the model with the DL subtour elimination constraints, are obtained within computation times smaller by 41.10 percent on average. Table 9 indicates that the best performance is obtained by employing the model with the GG subtour elimination constraints. Optimal solutions are obtained for 13 instances with up to 36 nodes (on average within less than eight minutes). This model decreases the computation time required to solve the eight (nine) instances, which are also provided by the model with the MTZ (DL) subtour elimination constraints, on average by 89.81 percent (88.22 percent). Moreover, the optimal solutions for the nine instances, which are also provided by the basic model, are obtained within computation times smaller by 91.60 percent on average.

According to the results given in these four tables, we conclude that the model employing the GG subtour elimination constraints performs much better than the one that does not include additional subtour elimination constraints (the basic model) and than those with the MTZ and DL constraints, both in terms of the number of instances solved to optimality and of the required computation time.

We have also solved the instances given in the TSPLIB with different service time functions in order to assess the effect of the time-dependent component on the performance of the model. We have applied the GG subtour elimination constraints since it was shown in Section 4.1 that these constraints are the most effective.

This section aims to analyze the results obtained by implementing different linear service time functions. Tables 10
                            and 11
                            present solutions of the instances where 
                              
                                 
                                    s
                                    i
                                 
                                 =
                                 5
                                 
                                    (
                                    
                                       10
                                       
                                          −
                                          3
                                       
                                    
                                    )
                                 
                                 
                                    b
                                    i
                                 
                                 +
                                 3
                                 
                                    (
                                    
                                       10
                                       
                                          −
                                          2
                                       
                                    
                                    )
                                 
                              
                            for all 
                              
                                 i
                                 ∈
                                 
                                    N
                                    ∖
                                    {
                                    0
                                    ,
                                    n
                                    +
                                    1
                                    }
                                 
                              
                            (small service times), and where 
                              
                                 
                                    s
                                    i
                                 
                                 =
                                 2
                                 
                                    (
                                    
                                       10
                                       
                                          −
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    b
                                    i
                                 
                                 +
                                 1.2
                                 
                                    (
                                    
                                       10
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                            for all 
                              
                                 i
                                 ∈
                                 
                                    N
                                    ∖
                                    {
                                    0
                                    ,
                                    n
                                    +
                                    1
                                    }
                                 
                              
                            (large service times), respectively.

The results presented in Table 10 indicate that when we apply a small service time function, all instances with up to 46 nodes are solved to optimality within a reasonable amount of time (on average within less than eight minutes). Table 11 shows that six instances with up to 31 nodes are solved optimally by the model employing a large service time function for each customer. The average computation time required to solve these six instances is approximately 22 minutes. Comparing the solutions given in Table 9 (with a medium service time function) to those in Tables 10 and 11, we observe that the number of instances solved to optimality decreases as the coefficients in the service time function increase. In addition, more computation time is required to obtain an optimal solution for the same instance when using a larger service time function for each customer.

We now analyze the results obtained by employing a quadratic service time function for each customer. Recall that the lower bound on the total service time of the optimal solution is valid for the case where all customers have the same linear (increasing) service time function (see Section 2.3). We have thus implemented an upper bound on the total route duration of the optimal solution (B1), and a lower and an upper bound on the start time of service at each customer location (B3) for the model with a quadratic service time function. Since the quadratic model is inherently more difficult to solve than the linear one, we focus on the 13 instances for which the optimal solutions can be obtained by the model with a medium linear service time function. Table 12
                            presents the solutions of these 13 instances where 
                              
                                 
                                    s
                                    i
                                 
                                 =
                                 4
                                 
                                    (
                                    
                                       10
                                       
                                          −
                                          5
                                       
                                    
                                    )
                                 
                                 
                                    b
                                    
                                       i
                                    
                                    2
                                 
                                 −
                                 4
                                 
                                    (
                                    
                                       10
                                       
                                          −
                                          3
                                       
                                    
                                    )
                                 
                                 
                                    b
                                    i
                                 
                                 +
                                 
                                    10
                                    
                                       −
                                       1
                                    
                                 
                              
                            for all 
                              
                                 i
                                 ∈
                                 
                                    N
                                    ∖
                                    {
                                    0
                                    ,
                                    n
                                    +
                                    1
                                    }
                                 
                              
                           .

The results presented in Table 12 indicate that nine instances with up to 31 nodes are solved optimally when a quadratic service time function is considered. This model cannot provide a feasible solution to one instance within the 7200 seconds time limit, and the remaining three instances can be solved suboptimally. When we compare the solutions given in Table 12 to those of Table 9, we observe that the number of instances solved to optimality decreases when we use a quadratic service time function (even though the proportion of the service time in the total route duration decreases). In addition, the model with a linear service time function requires less computation time to obtain an optimal solution for the same instance (the difference is 66.95 percent on average).

In this section, we analyze the effects of the bounds on the performance of the proposed formulation. We focus on the GG subtour elimination constraints and on linear service times since we observe from Sections 4.1 and 4.2 that the model comprising these constraints and service times performs well on the considered instances. Recall that we apply the bounds in our model on three variables: (i) an upper bound on the total route duration (B1), (ii) a lower bound on the total service time (B2), and (iii) a lower and an upper bound on the start time of service at each customer (B3). Table 13
                         presents the solutions obtained within the 7200 seconds time limit by employing the model without any additional lower and upper bounds, where we consider the GG subtour elimination constraints and medium service times, 
                           
                              
                                 s
                                 i
                              
                              =
                              
                                 10
                                 
                                    −
                                    2
                                 
                              
                              
                                 b
                                 i
                              
                              +
                              6
                              
                                 (
                                 
                                    10
                                    
                                       −
                                       2
                                    
                                 
                                 )
                              
                           
                         for all 
                           
                              i
                              ∈
                              
                                 N
                                 ∖
                                 {
                                 0
                                 ,
                                 n
                                 +
                                 1
                                 }
                              
                           
                        . Comparing the results of Table 13 to those of Table 9 (the model with a medium service time function and all valid bounds), we observe that the number of instances solved to optimality decreases from 13 (with up to 36 nodes) to nine (with up to 31 nodes). These nine instances, where both models can obtain corresponding optimal solutions, are solved by the model with all bounds in smaller computation times (on average by 73.89 percent). The enhanced model also provides smaller final gaps for the instances
                        
                         which are suboptimally solved by the model without any additional lower and upper bounds (on average 76.64 percent).

In addition to the solutions obtained by the model including all bounds (B1, B2 and B3) and by the model without bounds, Table 14 presents the results for each case where the model includes (i) only B1, (ii) only B2, (iii) only B3, (iv) B2 and B1, and (v) B2 and B3. Note that the last two cases are considered since we observe that the performance of the model for case (ii) is better than that for cases (i) and (iii). In other words, when each bound is incorporated into the model separately, the lower bound on the total service time is the most effective one. For each formulation, we report the number of instances solved to optimality, the average corresponding computation times, and the average optimality gap over the instances solved suboptimally. The results presented in Table 14 indicate that the enhanced model including all bounds provides the best performance in terms of the number of instances solved to optimality and of the required computation time. The model with an upper bound on the total route duration and a lower bound on the total service time yields the smallest average final optimality gap (computed over the instances solved suboptimally); however, this value is slightly better than the value obtained with the enhanced model with all bounds.

We additionally compare the performance of the model including all bounds (B1, B2 and B3) to that of the model without bounds, where small and large service times are considered. Tables 15 and 16 present the solutions obtained within the 7200 seconds time limit by employing the model without any additional lower and upper bounds, where we consider the GG subtour elimination constraints with 
                           
                              
                                 s
                                 i
                              
                              =
                              5
                              
                                 (
                                 
                                    10
                                    
                                       −
                                       3
                                    
                                 
                                 )
                              
                              
                                 b
                                 i
                              
                              +
                              3
                              
                                 (
                                 
                                    10
                                    
                                       −
                                       2
                                    
                                 
                                 )
                              
                           
                         for all 
                           
                              i
                              ∈
                              
                                 N
                                 ∖
                                 {
                                 0
                                 ,
                                 n
                                 +
                                 1
                                 }
                              
                           
                         and with 
                           
                              
                                 s
                                 i
                              
                              =
                              2
                              
                                 (
                                 
                                    10
                                    
                                       −
                                       2
                                    
                                 
                                 )
                              
                              
                                 b
                                 i
                              
                              +
                              1.2
                              
                                 (
                                 
                                    10
                                    
                                       −
                                       1
                                    
                                 
                                 )
                              
                           
                         for all 
                           
                              i
                              ∈
                              
                                 N
                                 ∖
                                 {
                                 0
                                 ,
                                 n
                                 +
                                 1
                                 }
                              
                              ,
                           
                         respectively.

Comparing the results of Table 15 to those of Table 10 (the model with a small service time function and all valid bounds), we observe that the number of instances solved to optimality decreases from 22 (with up to 46 nodes) to 17 (with up to 36 nodes). These 17 instances, where both models can obtain corresponding optimal solutions, are solved by the model with all bounds in smaller computation times (on average by 87.29 percent). The enhanced model also provides smaller final gaps for the instances which are suboptimally solved by the model without any additional lower and upper bounds (on average 99.98 percent, leading to optimal solutions for all instances).

Comparing the results of Table 16 to those of Table 11 (the model with a large service time function and all valid bounds), we observe that the number of instances solved to optimality decreases from six (with up to 31 nodes) to four (with up to 22 nodes). These four instances, where both models can obtain corresponding optimal solutions, are solved by the model with all bounds in smaller computation times (on average by 33.61 percent). The enhanced model also provides smaller final gaps for the instances which are suboptimally solved by the model without any additional lower and upper bounds (on average 64.95 percent).

From the results given in Tables 13–16, we conclude that the model proposed in this paper performs much better with all bounds explained in Section 4.1.

@&#CONCLUSIONS@&#

We have considered a traveling salesman problem with time-dependent service times. Several analytical properties of the service time function were derived and a lower bound on the total service time of the optimal solution was computed. Examples were presented to illustrate properties. We then described a mathematical formulation capable of solving linear and quadratic service time functions. We have developed a procedure to compute a sufficiently large value for the bigM, which was then employed in the proposed mathematical model. In numerical experiments, a lower and an upper bound on the start time of service at each customer were also implemented. Computational results showed that our model (with the all valid bounds) can successfully solve instances with up to 46 nodes with a linear service time function, and with up to 31 nodes with a quadratic service time function.

@&#ACKNOWLEDGMENTS@&#

This research was partly supported by the Canadian Natural Sciences and Engineering Research Council under Grants 338816-10, 436014-2013 and 39682-10. This support is gratefully acknowledged. Thanks are due to Emanuela Guerriero and to the referees for their valuable comments.

@&#REFERENCES@&#

