@&#MAIN-TITLE@&#Conic epipolar constraints from affine correspondences

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Linear constraints on the fundamental matrix are derived from affine correspondences.


                        
                        
                           
                           It is shown that an affine correspondence is equivalent to 3 linear constraints.


                        
                        
                           
                           Two affine correspondences are shown to constrain the epipole location to a conic.


                        
                        
                           
                           A calculation method of the fundamental matrix by intersection of conics is proposed.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Epipolar geometry

Affine invariant regions

Fundamental matrix

Homographies

@&#ABSTRACT@&#


               
               
                  We derive an explicit relation between local affine approximations resulting from matching of affine invariant regions and the epipolar geometry in the case of a two view geometry. Most methods that employ the affine relations do so indirectly by generating pointwise correspondences from the affine relations. In this paper we derive an explicit relation between the local affine approximations and the epipolar geometry.
                  We show that each affine approximation between images is equivalent to 3 linear constraints on the fundamental matrix and that the linear conditions guarantee the existence of an homography, compatible with the fundamental matrix. We further show that two affine relations constrain the location of the epipole to a conic section. Therefore, the location of the epipole can be extracted from 3 regions by intersecting conics.
                  The result is further employed to derive a procedure for estimating the fundamental matrix, based on the estimated location of the epipole. It is shown to be more accurate and to require less iterations in LO-RANSAC based estimation, than the current point based approaches that employ the affine relation to generate pointwise correspondences and then calculate the fundamental matrix from the pointwise relations.
               
            

@&#INTRODUCTION@&#

Solving the geometry of a stereo rig is a preliminary step in solving many problems in computer vision such as image registration, structure from motion and object tracking. Luong and Faugeras [1] showed in 1995 that the geometry of two uncalibrated cameras can be described by a 
                        
                           3
                           ×
                           3
                        
                      singular matrix called the fundamental matrix. The fundamental matrix provides the correspondence between points in each image to lines in the other image and therefore greatly simplifies the task of finding correspondence points between images. Furthermore, once the fundamental matrix is known, a correspondence of points between the images allows for reconstruction of a 3D scene up to a projection ambiguity [2].

The fundamental matrix can be estimated from correspondence of points between two images [3]. Each point correspondence yields a linear constraint on the location of the epipole; since the matrix is only determined up to scale, a correspondence of 8 points [4] results in a linear estimation of the matrix. An estimation of the fundamental matrix based on a correspondence of 7 points can be calculated by exploiting the singularity of the matrix [2]. It was further shown by Faugeras [5] that a correspondence of 6 points limits the location of the epipole to a 3rd order rational curve.

In recent years, several methods have been proposed for matching of small regions between images [6–9]. Region correspondence methods usually assume that the geometric deformation between the images can be approximated locally by an affine transformation. Furthermore, affine normalization of the regions provides an approximation of a point correspondence and the local derivatives of the deformation between the images at the point of the correspondence [10]. We denote such a correspondence of points along with the derivatives of the deformation between the images at the point of correspondence by the name affine correspondence.

The additional information available in the affine correspondence is rarely used for the calculation of the fundamental matrix. Methods that do employ information from affine correspondences try to convert the affine correspondence into point correspondences. Generally, since an affine transformation is determined by 3 points, it seems that it is roughly equivalent to the matching of 3 points between images. In [11–14] local affine approximation is used for generation of additional points. However, affine correspondences and point correspondences are different mathematical entities; there is no equivalence between an affine correspondence and a certain number of point correspondences. For example, 4 points of correspondence between images fully determine an homography between the images [2] whereas an affine correspondence and a single point correspondence do not fully determine an homography (we show in Section 3 that the direction of the transformation of an arbitrary point by an homography relative to the center of the affine correspondence is known from the affine correspondence. Therefore, the point correspondence only contributes a single constraint instead of two).

A nonpointwise approach for calculating an affine fundamental matrix was presented in [15]. The method treats the affine correspondences as matched ellipses between the two images. It is shown that matching of two ellipses between images is sufficient for calculation of an affine fundamental matrix. However, the affine fundamental matrix has only 4 degrees of freedom as opposed to 7 in a general fundamental matrix. Such a model assumes that the camera centers are at infinity; it is therefore more suitable for narrow field of view cameras. Furthermore, notice that one degree of freedom is discarded from the affine correspondence as matched ellipses only determine an affine correspondence up to a rotation factor [10].

To the best of our knowledge, there is no theoretical work that derives explicit constraints from affine correspondences on the epipolar geometry. In this paper, we offer a different point of view on the relation between affine correspondences and the epipolar geometry. We treat the affine correspondence as the derivative of an homography caused by a plane tangent to the surface viewed by the two cameras at the point of correspondence. The compatibility requirement between an homography and a fundamental matrix [2] is then employed for deriving constraints on the fundamental matrix. We prove that an affine correspondence yields 3 linear constraints on the fundamental matrix; we further prove that the linear constraints are sufficient conditions for an homography compatible with the fundamental matrix to exist. Therefore, 3 affine correspondences are sufficient to fully determine the fundamental matrix.

In the case where two affine correspondences are known, a one dimensional family of solutions exists; we show that in this case the location of the epipole is constrained to a conic. We employ the result to calculate the location of the epipole from 3 pairs of affine correspondences by intersection of conics. The proposed method shows an improvement of up to an order of magnitude in the accuracy of estimating the fundamental matrix over using 3 points from each region with the traditional normalized 8 points algorithm. We also employ the proposed method for calculation of the fundamental matrix from matching hypotheses with low inliers rate by using Locally Optimized RANSAC [16]. In such cases the proposed methods showed comparable and slightly better results than the state of the art, point based, method [11].

A surface viewed by a pair of cameras induces a set of correspondence points between the viewed images. An affine correspondence 
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 0
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 0
                              
                           
                           )
                        
                      between a pair of images is a pair of corresponding pixel coordinates 
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 0
                              
                              
                                 ′
                              
                           
                           )
                        
                      along with the local derivatives at the point of correspondence, 
                        
                           
                              
                                 A
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 d
                                 
                                    
                                       u
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 d
                                 u
                              
                           
                           
                              
                                 |
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       o
                                    
                                 
                              
                           
                        
                     . The matrix 
                        
                           
                              
                                 A
                              
                              
                                 0
                              
                           
                        
                      may be regarded as the Jacobian matrix of the homography that represents the point correspondence on a 3D plane, tangent to the viewed surface at the correspondence point (see Fig. 1
                     ).

An homography, H, is said to be compatible with a fundamental matrix, F, if and only if 
                        
                           
                              
                                 H
                              
                              
                                 T
                              
                           
                           F
                        
                      is an anti-symmetric matrix [2]. Therefore, a known homography between a pair of images yields 6 linear constraints on the fundamental matrix. However, an affine correspondence does not fully determine an homography. In Section 2.2 we wish to determine the constraints on the fundamental matrix resulting from an homography which is not fully known, as only the affine correspondence 
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 0
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 0
                              
                           
                           )
                        
                      is known.

Let H be an homography that represents the image correspondence caused by a world plane viewed in a pair of images; also let 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                              ,
                              A
                              )
                           
                         be an affine correspondence between the images of the world plane. As shown next, the affine correspondence determines the terms of an homography H up to two unknowns terms. We denote the terms of A as
                           
                              (1)
                              
                                 A
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and the terms of the homography H, expanded in homogeneous coordinates, as
                           
                              (2)
                              
                                 H
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         7
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         9
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The relation between H and A is expressed by the derivatives of the homography H at 
                           
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                           
                        . Let 
                           
                              
                                 
                                    u
                                 
                                 
                                    x
                                 
                              
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    y
                                 
                              
                           
                         represent the first and second coordinates of 
                           
                              u
                           
                         (
                           
                              u
                              =
                              
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          y
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                        ) and 
                           
                              
                                 
                                    u
                                 
                                 
                                    ′
                                 
                              
                           
                         the transformation of u by H. The derivative 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      du
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      du
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           
                         is expressed as
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         du
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  7
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  6
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  y
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  9
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                             ,
                                             x
                                          
                                       
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             6
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                             ,
                                             y
                                          
                                       
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             9
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                             ,
                                             x
                                          
                                       
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             0
                                             ,
                                             y
                                          
                                       
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             7
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   h
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   0
                                                   ,
                                                   x
                                                
                                             
                                             +
                                             
                                                
                                                   h
                                                
                                                
                                                   6
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   0
                                                   ,
                                                   y
                                                
                                             
                                             +
                                             
                                                
                                                   h
                                                
                                                
                                                   9
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We limit the discussion to the case where 
                           
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                              =
                              0
                           
                         (the general case can be reduced to this case by a shift of coordinates). Since 
                           
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                              =
                              0
                           
                         then, using (2), 
                           
                              
                                 
                                    h
                                 
                                 
                                    7
                                 
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    8
                                 
                              
                              =
                              0
                           
                         and, using (1) we have
                           
                              (4)
                              
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         du
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         du
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             9
                                          
                                       
                                    
                                 
                              
                           
                        
                     

A similar calculation relates 
                           
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    4
                                 
                              
                           
                         to 
                           
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    h
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                                 
                                    h
                                 
                                 
                                    5
                                 
                              
                           
                         respectively. Since the matrix H is only determined up to a scale factor, we can set 
                           
                              
                                 
                                    h
                                 
                                 
                                    9
                                 
                              
                              =
                              1
                           
                        , therefore H takes the form
                           
                              (5)
                              
                                 H
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        leaving only 2 unknown parameters. In the general case where 
                           
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              
                              ≠
                              
                              0
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                              
                              ≠
                              
                              0
                           
                         the same relation applies after shifting the coordinates systems. Let 
                           
                              
                                 
                                    S
                                 
                                 
                                    u
                                 
                              
                           
                         be a shift of the coordinates system:
                           
                              (6)
                              
                                 
                                    
                                       S
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The homography in this case is achieved by shifting (5):
                           
                              (7)
                              
                                 H
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       -
                                       
                                          
                                             u
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We conclude that 
                           
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                           
                         and A explicitly determine the form of an homography, leaving two undetermined degrees of freedom.

As previously mentioned, an homography forms 6 linear constraints on the elements of the fundamental matrix. If only an affine correspondence is known, the 6 equations contain two parameters, 
                           
                              
                                 
                                    h
                                 
                                 
                                    3
                                 
                              
                           
                         and 
                           
                              
                                 
                                    h
                                 
                                 
                                    6
                                 
                              
                           
                        , that describe the unknown terms of the homography. We show next that the 6 equations are equivalent to 3 linear equations on F and one polynomial equation.

The derivation is performed for the case where 
                           
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                              =
                              0
                           
                         (as mentioned before, the general case can be reduced to this case by shifting the coordinate system). By (5) the anti-symmetric requirement on 
                           
                              
                                 
                                    H
                                 
                                 
                                    T
                                 
                              
                              F
                           
                         results in 6 equations:
                           
                              (8)
                              
                                 
                                    
                                       f
                                    
                                    
                                       9
                                    
                                 
                                 =
                                 0
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       f
                                    
                                    
                                       6
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       7
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       8
                                    
                                 
                                 +
                                 
                                    
                                       h
                                    
                                    
                                       6
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       9
                                    
                                 
                                 =
                                 0
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       7
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       8
                                    
                                 
                                 +
                                 
                                    
                                       h
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       9
                                    
                                 
                                 =
                                 0
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                                 +
                                 
                                    
                                       h
                                    
                                    
                                       6
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       6
                                    
                                 
                                 =
                                 0
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       h
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 0
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                                 +
                                 
                                    
                                       h
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       6
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       h
                                    
                                    
                                       6
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     

Substituting (8)–(10), the non linear terms vanish. Therefore, three linear equations are formed. The linear equations can be simply formulated as
                           
                              (14)
                              
                                 
                                    
                                       f
                                    
                                    
                                       9
                                    
                                 
                                 =
                                 0
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         7
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

An homography H, compliant with a fundamental matrix F, must also satisfy the non linear Eqs. (11)–(13). Note that 
                           
                              
                                 
                                    h
                                 
                                 
                                    3
                                 
                              
                           
                         and 
                           
                              
                                 
                                    h
                                 
                                 
                                    6
                                 
                              
                           
                         in (11) and (12) can be expressed as rational functions of the terms of F. They can therefore be substituted into Eq. (13) to yield
                           
                              (16)
                              
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             6
                                          
                                       
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             6
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                                 )
                                 =
                                 0
                              
                           
                        
                     

The rational equation can be expressed in a polynomial form by multiplying (16) by 
                           
                              
                                 
                                    f
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    6
                                 
                              
                           
                        :
                           
                              (17)
                              
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       6
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             6
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                                 )
                                 =
                                 0
                              
                           
                        
                     

Eqs. (11)–(13) therefore result in a single third order polynomial equation in the terms of F.

Since by definition 
                           
                              det
                              (
                              F
                              )
                              =
                              0
                           
                        , we next show that (17) is in fact redundant. Given a non singular homography matrix H, the anti-symmetric requirement imposed at the beginning of our derivation also implies that 
                           
                              det
                              (
                              
                                 
                                    H
                                 
                                 
                                    T
                                 
                              
                              F
                              )
                              =
                              0
                           
                         and therefore 
                           
                              det
                              (
                              F
                              )
                              =
                              0
                           
                        . The requirement that 
                           
                              det
                              (
                              F
                              )
                              =
                              0
                           
                         forms a third order polynomial equation in the terms of F. Therefore, any solution of (17) must result a singular F. Indeed, by substituting (14) and (15) into (17), Eq. (17) can be rewritten in the form
                           
                              (18)
                              
                                 det
                                 (
                                 A
                                 )
                                 det
                                 (
                                 F
                                 )
                                 =
                                 0
                              
                           
                        
                     

Again, since A is invertible, a solution only exists if 
                           
                              det
                              (
                              F
                              )
                              =
                              0
                           
                        . This is however a general property of the fundamental matrix as all fundamental matrices are singular. Therefore, the linear Eqs. (14) and (15) are sufficient to guarantee the existence of an homography, H, with derivatives A at 
                           
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                           
                         and a fundamental matrix F that is compatible with H. To conclude, each affine correspondence results in 3 linear equations on the terms on the fundamental matrix F. Moreover, an homography, compatible with a fundamental matrix can always be calculated from an affine correspondence if the linear constraints (14) and (15) are met.

As a result of the previous section, the fundamental matrix cannot be fully determined by a pair of affine correspondences: The fundamental matrix has 7 degrees of freedom. Since each affine correspondence yields 3 linear equations on the fundamental matrix, a pair of affine correspondences should result in a one dimensional family of solutions to the fundamental matrix. It was shown by Faugeras [5] that 6 points of correspondence constrain the location of the epipole to a cubic. An interesting question is: What does a pair of affine correspondences tell us about the geometry of the corresponding image pairs? In this section, we show that 2 affine correspondences constrain the location of the epipole to a second order rational curve.

Let 
                        
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           )
                        
                      and 
                        
                           (
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           )
                        
                      denote two affine correspondences. As shown in Section 2, each affine correspondence may be expressed through the derivatives of an homography at the specific point of correspondence. We denote the homographies as 
                        
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                        
                     . The line connecting 
                        
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        
                      plays an important role in the derivation of the epipolar constraint presented here; we denote the transformations of the vector 
                        
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           -
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        
                      by 
                        
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                        
                      as 
                        
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           -
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           -
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           )
                        
                     .

We denote a general point on the line connecting 
                        
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        
                      as
                        
                           (19)
                           
                              x
                              (
                              β
                              )
                              =
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              +
                              β
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        
                     
                  

A transformation of 
                        
                           x
                           (
                           β
                           )
                        
                      by 
                        
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                        
                      to the points 
                        
                           
                              
                                 x
                              
                              
                                 ′
                                 (
                                 1
                                 )
                              
                           
                           (
                           β
                           )
                        
                      and 
                        
                           
                              
                                 x
                              
                              
                                 ′
                                 (
                                 2
                                 )
                              
                           
                           (
                           β
                           )
                        
                      respectively, yields a linear constraint on the epipole location as by the definition of the epipolar line the epipole and the two points should be collinear (see Fig. 2
                     ). The epipolar line connecting 
                        
                           
                              
                                 x
                              
                              
                                 ′
                                 (
                                 1
                                 )
                              
                           
                           (
                           β
                           )
                        
                      and 
                        
                           
                              
                                 x
                              
                              
                                 ′
                                 (
                                 2
                                 )
                              
                           
                           (
                           β
                           )
                        
                      can therefore be formalized as
                        
                           (20)
                           
                              l
                              (
                              β
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                (
                                                β
                                                )
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                (
                                                β
                                                )
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     and the location of the epipole, 
                        
                           e
                        
                     , obeys the rule 
                        
                           
                              
                                 e
                              
                              
                                 T
                              
                           
                           l
                           (
                           β
                           )
                           =
                           0
                        
                     .

Eq. (20) forms a pointwise constraint on the location of the epipole. Since an affine correspondence also consists of derivatives we wish to exploit the derivatives to further constrain the location of the epipole. A second line is therefore generated by relating infinitesimal movements of 
                        
                           
                              
                                 x
                              
                              
                                 ′
                                 (
                                 1
                                 )
                              
                           
                           (
                           β
                           )
                        
                      and 
                        
                           
                              
                                 x
                              
                              
                                 ′
                                 (
                                 2
                                 )
                              
                           
                           (
                           β
                           )
                        
                      caused by an infinitesimal movement of 
                        
                           x
                           (
                           β
                           )
                        
                     . The configuration is illustrated in Fig. 3
                     . Since the epipole location does not depend on 
                        
                           β
                        
                     , the infinitesimal relation is formalized by taking the derivative of 
                        
                           
                              
                                 e
                              
                              
                                 T
                              
                           
                           l
                           (
                           β
                           )
                           =
                           0
                        
                     . Therefore, 
                        
                           
                              
                                 e
                              
                              
                                 T
                              
                           
                           
                              
                                 d
                                 l
                              
                              
                                 d
                                 β
                              
                           
                           (
                           β
                           )
                           =
                           0
                        
                      where
                        
                           (21)
                           
                              
                                 
                                    d
                                    l
                                 
                                 
                                    d
                                    β
                                 
                              
                              (
                              β
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                            (
                                                            1
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                      β
                                                   
                                                
                                                (
                                                β
                                                )
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                (
                                                β
                                                )
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                (
                                                β
                                                )
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                            (
                                                            2
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                      β
                                                   
                                                
                                                (
                                                β
                                                )
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

If all the terms of (20) and (21) were known, then the epipole location could be determined as the intersection of the two lines. In the following derivation we evaluate (20) and (21) at 
                        
                           β
                           =
                           0
                        
                     ; the quantities at 
                        
                           β
                           =
                           0
                        
                      correspond to the transformations of 
                        
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        
                      by the two homographies. The terms 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                             (
                                             1
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 β
                                 =
                                 0
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                          
                                             d
                                             β
                                          
                                       
                                    
                                 
                              
                              
                                 β
                                 =
                                 0
                              
                           
                        
                      can be expressed directly by the affine correspondence 
                        
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           )
                        
                      as:
                        
                           (22)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ′
                                                (
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    β
                                    =
                                    0
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                           
                        
                     
                     
                        
                           (23)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                             
                                                d
                                                β
                                             
                                          
                                       
                                    
                                 
                                 
                                    β
                                    =
                                    0
                                 
                              
                              =
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                           
                        
                     
                  

We therefore remain with two unknown terms 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                   (
                                                   2
                                                   )
                                                
                                             
                                          
                                          
                                             d
                                             β
                                          
                                       
                                    
                                 
                              
                              
                                 β
                                 =
                                 0
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                             (
                                             2
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 β
                                 =
                                 0
                              
                           
                        
                     . The remaining terms are calculated from the affine correspondence 
                        
                           (
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           )
                        
                     . Since the local derivatives of 
                        
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                        
                      at 
                        
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        
                      are known, the line connecting 
                        
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        
                      is transferred by 
                        
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                        
                      to the line that pass through 
                        
                           
                              
                                 u
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                        
                      in the direction of 
                        
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                        
                     . In Appendix A we show that given a parameterization to the line:
                        
                           (24)
                           
                              
                                 
                                    x
                                 
                                 
                                    ′
                                    (
                                    2
                                    )
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           
                        
                     the relation between the parameterizations (19) and (24) is a one dimensional homography; we denote it as 
                        
                           t
                           (
                           β
                           )
                           =
                           
                              
                                 β
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 (
                                 1
                                 +
                                 β
                                 )
                              
                              
                                 (
                                 1
                                 +
                                 β
                                 )
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       h
                                    
                                    
                                       6
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 +
                                 1
                              
                           
                        
                     . If the one dimensional homography, t, was known, we could easily extract the missing parameters for (20) and (21).

A one dimensional homography can be determined by two pairs of corresponding points and a derivative (see Appendix B). By the affine correspondence 
                        
                           (
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           )
                        
                      we have from (A.3) that 
                        
                           
                              
                                 
                                    
                                       t
                                    
                                 
                              
                              
                                 β
                                 =
                                 -
                                 1
                              
                           
                           =
                           0
                        
                      and 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             dt
                                          
                                          
                                             d
                                             β
                                          
                                       
                                    
                                 
                              
                              
                                 β
                                 =
                                 -
                                 1
                              
                           
                           =
                           1
                        
                     . In order to complete the puzzle, a single point correspondence on the line is still missing. However, as no more corresponding points along the line (24) are known, we set a parameter, 
                        
                           α
                        
                     , that determines the location of the transformation of 
                        
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        
                      by t. By defining the missing match as 
                        
                           
                              
                                 
                                    
                                       α
                                       =
                                       t
                                    
                                 
                              
                              
                                 β
                                 =
                                 0
                              
                           
                        
                      we have that
                        
                           (25)
                           
                              
                                 
                                    x
                                 
                                 
                                    ′
                                    (
                                    2
                                    )
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    β
                                    =
                                    0
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              +
                              α
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           
                        
                     
                  

In Appendix B, we explicitly calculate the homography and show that 
                        
                           
                              
                                 dt
                              
                              
                                 d
                                 β
                              
                           
                           
                              
                                 |
                              
                              
                                 β
                                 =
                                 0
                              
                           
                           =
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                        
                     . A simple use of the derivatives chain rule then yields
                        
                           (26)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                             
                                             
                                                d
                                                β
                                             
                                          
                                       
                                    
                                 
                                 
                                    β
                                    =
                                    0
                                 
                              
                              =
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           
                        
                     
                  

Eqs. (23), (22), (25) and (26) determine all the terms of (20) and (21) at 
                        
                           β
                           =
                           0
                        
                     . We can therefore write the location of the epipole as
                        
                           (27)
                           
                              e
                              =
                              l
                              (
                              0
                              )
                              ×
                              
                                 
                                    d
                                    l
                                 
                                 
                                    d
                                    β
                                 
                              
                              (
                              0
                              )
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                    
                                       
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                        
                                                                           ′
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                        
                                                                           ′
                                                                        
                                                                     
                                                                     +
                                                                     α
                                                                     
                                                                        
                                                                           v
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ×
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           v
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                        
                                                                           ′
                                                                        
                                                                     
                                                                     +
                                                                     α
                                                                     
                                                                        
                                                                           v
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                        
                                                                           ′
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           α
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           v
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

At a first glance, the curve may seem like a 3rd order rational curve. However, the third order term cancels out as a cross product of two vectors of the same direction. We show in Appendix C that the curve parameterization in equivalent to:
                        
                           (28)
                           
                              e
                              =
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              (
                              α
                              det
                              (
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              )
                              -
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              )
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                +
                                                α
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 k
                              
                              
                                 i
                              
                           
                           =
                           det
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           -
                           
                              
                                 u
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           )
                        
                     . The epipole is therefore located on a second order rational curve - a conic parameterized by 
                        
                           α
                        
                     . Note that we have only used partial information from the affine correspondence, as only the derivatives in the direction of the line connecting 
                        
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        
                      were used for the calculation of the conic constraint.

A classification of the conic (28) to an ellipse, hyperbola or parabola can be derived directly from the representation of the conic in non homogeneous coordinates:
                           
                              (29)
                              
                                 
                                    
                                       e
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       (
                                       α
                                       det
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       -
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       α
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       α
                                       det
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       -
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The denominator of (29) is a second order polynomial with discriminant
                           
                              (30)
                              
                                 Δ
                                 =
                                 det
                                 
                                    
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                     

A second order curve can be classified by the number of its intersections with the point at infinity (which is equal to the number of the distinct roots of the denominator). The conic is therefore an hyperbola if the denominator of (29) has two distinct roots (
                           
                              Δ
                              >
                              0
                           
                        ), a parabola in the case where the two roots are equal (
                           
                              Δ
                              =
                              0
                           
                        ) and an ellipse is no roots exist (
                           
                              Δ
                              <
                              0
                           
                        ).

Some interesting properties of the conic constraints can be derived from (28). We next show that the conic passes through 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                         and that the directions 
                           
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           
                         are tangents to the curve at the point 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                         respectively (see Fig. 4
                        ).

The point 
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                         is shown to be on the conic by setting 
                           
                              α
                              =
                              0
                           
                         in (29), hence 
                           
                              
                                 
                                    e
                                 
                                 
                                    n
                                 
                              
                              (
                              0
                              )
                              =
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                        . Also 
                           
                              
                                 
                                    e
                                 
                                 
                                    n
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    det
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              )
                              =
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                           
                        . The derivatives of the curve can be calculated from the inhomogeneous representation (29). By taking the derivatives of 
                           
                              
                                 
                                    e
                                 
                                 
                                    n
                                 
                              
                           
                         relative to 
                           
                              α
                           
                        , one can easily show that 
                           
                              
                                 
                                    d
                                    
                                       
                                          e
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    d
                                    α
                                 
                              
                              (
                              0
                              )
                              ≅
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    d
                                    
                                       
                                          e
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    d
                                    α
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    det
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              )
                              ≅
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                           
                         where the symbol 
                           
                              ≅
                           
                         represent equality up to a scale factor.

In this section we describe experiments for calculating the fundamental matrix using conic constraints. Given three affine correspondences, each affine correspondence contributes a conic constraint on the location of the epipole. The epipole can therefore be located by intersection of conics; the fundamental matrix is then calculated from the affine correspondences and the known location of the epipole.

We perform two sets of experiments. In Section 4.2 we test the accuracy of the proposed method in a synthetic scenario: 3 regions are placed on three planes viewed by 2 cameras. The measurements are then contaminated with additive noise. We measure the accuracy of the proposed method, compared with the results of the normalized 8 points algorithm [17] on 3 points extracted from each region. In Section 4.3 we compare the proposed method with the point based method described in [11] for estimating the fundamental matrix from matching regions extracted by MSER [7]. We use both methods in a Locally Optimized RANSAC (LO-RANSAC) [16] robust estimation process. The compared methods are used for initial estimation of the fundamental matrix; each time the number of inliers is increased, the fundamental matrix is re-estimated from the new set of inliers, using the normalized 8 points algorithm on a larger number of regions. We measure the average number of iterations required by LO-RANSAC with each of the methods.

We first describe the method we use for calculating the fundamental matrix.

Once the epipole location is known, we use the following method for calculating the fundamental matrix: Let 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                         be an homography and let 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         be an affine correspondence on the homography (the homography is not fully determined; the affine correspondence and the homography are related by (7)). Also let 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              )
                              ,
                              (
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         be two additional correspondences unrelated to 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                        . We employ the point correspondences 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         to determine two additional constraints on 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                         and therefore fully determine 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                        .

Each additional point correspondence on 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                         is determined by the intersection of two lines. The first line is the transformation of the line connecting 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                           
                         to 
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                           
                         by 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                        ; it is transformed to a line parameterized as 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              +
                              γ
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        . The second line is calculated by the epipolar geometry. According to the epipolar geometry, 
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                           
                         is transformed by 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                         to a location along the line connecting 
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                         and the epipole 
                           
                              
                                 
                                    e
                                 
                                 
                                    ′
                                 
                              
                           
                         (similarly to the scenario in Fig. 2). The intersection of the lines yields an additional point correspondence on 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                         (see Fig. 5
                        ); we denote it as 
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                    (
                                    1
                                    )
                                 
                              
                           
                        . An additional point 
                           
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                    (
                                    1
                                    )
                                 
                              
                           
                         is found by the same method applied to 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         . Once the additional correspondences are calculated, the homography 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                         can be calculated from (7) using the constraints implied by the affine correspondence 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         and the two points of correspondence 
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                    (
                                    1
                                    )
                                 
                              
                              )
                              ,
                              (
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                    (
                                    1
                                    )
                                 
                              
                              )
                           
                        . (Note that each of the point correspondences only contributes a single new constraint, as the direction of the transformation of the point by the homography relative to 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                           
                         is already known from the affine correspondence). Since the fundamental matrix is directly determined by the epipole and an homography [2], we therefore have an alternative method to the normalized 8 points for calculation of the fundamental matrix F as 
                           
                              F
                              =
                              
                                 
                                    [
                                    
                                       
                                          e
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                 
                                 
                                    x
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                        .

As mentioned above, most methods that do employ additional information from affine correspondences (such as [11,12]) do so by extracting additional point correspondences. A minimal number of 3 correspondences is required in order to represent the affine relation. Since an affine correspondence is only a local approximation of an homography, the simulated correspondence points are placed near the point of affine correspondence. We conducted a computer simulation to test the accuracy in calculating the fundamental matrix from points simulated by the affine transformation versus calculation from the conic constraints presented here.

In the experiment, three groups of nearby points are viewed by two cameras. Each group consists of three points and is located on a different plane. The angle between the first two planes varies in the simulations, the third plane is perpendicular to the two other planes. The configuration is illustrated in Fig. 6
                        . A fundamental matrix is estimated once from the nine points of correspondence using the normalized eight points method and once from the epipole location and an affine correspondence as described above.

We measure the accuracy in the estimation of the fundamental matrix in the presence of noise. The location of each group of points is shifted by a white Gaussian noise. The locations within the groups are also shifted by noise, relative to the distance between the points in the groups. Let 
                           
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                           
                         be the j point of the group i. Also let 
                           
                              ξ
                           
                         be the distance between the points in each group. The coordinates of each point are perturbed by noise so that
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 γ
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 ξ
                                 
                                    
                                       n
                                    
                                    
                                       j
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              γ
                           
                         determines the magnitude of the noise and 
                           
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              3
                           
                        , 
                           
                              
                                 
                                    n
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              3
                              ,
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              3
                           
                         are zero mean uncorrelated Gaussian random variables. The distance between the estimations of the fundamental matrix by each of the methods and the theoretical matrix is measured by normalizing each matrix to have a unit norm (since the matrices are only determined up to scale) and taking the Hilbert–Schmidt norm of the difference of the matrices. Our method produces up to 9 solutions (up to 12 intersections of the three conics where 3 of the intersections are located on the correspondence points); we therefore choose the fundamental matrix that minimizes the geometric distance between the 9 matched points and the corresponding epipolar lines by that fundamental matrix.

We conducted 1000 experiments for each value of 
                           
                              γ
                           
                        . The proposed method provides higher accuracy than the calculation of the fundamental matrix by the normalized 8 points algorithm using the 9 point correspondences. The results for angles of 60°, 120° and 180° between the first two planes are presented in Fig. 7
                        . The results obtained by the proposed method are more accurate than the point based method. The improvement depends on the angle between the planes; the greatest improvement was measured in the two planes scenario (180° between the first and second plane) where it reached an order of magnitude. An example of the calculated epipole location and the conics is displayed in Fig. 8
                        .

Calculation of the fundamental matrix requires correspondence of points or regions. In most cases, a correspondence between images is not known; only hypotheses for correspondences are known. A correct calculation of the fundamental matrix must rely only on correct hypotheses. The problem of separating the correct hypotheses (inliers) from the incorrect hypotheses (outliers) is usually tackled by robust statistical methods such as RANSAC[18].

In a RANSAC based solution, hypotheses are chosen at random and the fundamental matrix is calculated from the chosen hypotheses. The rest of the hypotheses are then used to vote for the correctness of the model. Since all hypotheses used for the calculation should be correct, the inliers rate and the number of hypotheses required for calculating the fundamental matrix greatly affect the number of attempts that should be done until a successful calculation is made. For example, point based methods that only employ the center of mass of the regions require a minimum of 7 points for calculation of the fundamental matrix; if the inliers rate is 10%, an average of 
                           
                              1
                              ×
                              
                                 
                                    10
                                 
                                 
                                    7
                                 
                              
                           
                         attempts are required for obtaining a successful guess. Therefore, such methods are only applicable when the inliers rate is high.

In this section we demonstrate the use of the epipolar conic constraint for calculating the fundamental matrix in the presence of low inliers rate. As the proposed method only relies on the correspondence of 3 regions, it is applicable to cases where the initial inliers rate is low. We compare the proposed method with [11]. The method presented in [11] also employs the affine approximation from the matched regions. It does so by representing each matched region by 3 points. Therefore, the fundamental matrix can be calculated from 3 corresponding regions (9 points).

As in [11], Locally Optimized RANSAC [16] is used for robust estimation of the fundamental matrix. In such an estimation scheme, in each iteration the model is calculated from 3 regions either by the proposed method or by [11]. If the number of inliers in the current iteration is higher than in all the previous iterations, the local optimization process is employed. The structure of the LO-RANSAC is described in Algorithm 1.
                           Algorithm 1
                           A general scheme of a LO-RANSAC robust estimation. 
                                 
                                    
                                       
                                       
                                          
                                             Repeat until the probability of missing a set of inliers falls under a predefined threshold (As in standard RANSAC)
                                          
                                          
                                             
                                                
                                                   
                                                      1.
                                                      Select a random sample of 3 matched regions and calculate the fundamental matrix from the regions.
                                                   
                                                   
                                                      2.
                                                      Calculate the number of inliers 
                                                            
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         , i.e., the data points their error is smaller than predefined threshold 
                                                            
                                                               θ
                                                            
                                                         .
                                                   
                                                   
                                                      3.
                                                      if a new maximum of inliers has occurred (
                                                            
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               >
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                          for all 
                                                            
                                                               j
                                                               <
                                                               k
                                                            
                                                         ), run local optimization and store the best model.
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The local optimization is performed in an iterative manner. In each iteration of the local optimization, a new model is calculated by performing RANSAC on all matched regions with error (distance of the center of mass of the regions from the corresponding epipolar line) lower than 
                           
                              K
                              ·
                              θ
                           
                         from the previous model. The value of K is decreased until the final model is calculated for 
                           
                              K
                              =
                              1
                           
                        . Since the inlier rate is high in this phase (we start from the initial model calculated from the 3 regions), we use more than 3 regions for the calculation. As advised in [16], 
                           
                              min
                              (
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              /
                              2
                              ,
                              14
                              )
                           
                         matches are used for calculating the fundamental matrix using the normalized 8 points algorithm. For compatibility with the experiment in [11], only the center of mass of the regions is used for the local optimization.

We use the Daisy dataset [19,20] and the Leuven city hall dataset [21,22] to compare the performance of the methods. The Daisy dataset contains 4 pairs of images. The Leuven city hall dataset contains a sequence of 6 images; we calculate the epipolar geometry of the first image with any other image.

We extracted MSER [7] regions from each image. Given a region 
                           
                              Ω
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         with a center of mass at 
                           
                              μ
                           
                        , it is shown in [10] that a coordinate system, 
                           
                              
                                 
                                    u
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                           
                        , invariant to affine transformations, can be determined from the second order moment matrix of the region, such that
                           
                              (32)
                              
                                 
                                    
                                       u
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       RM
                                    
                                    
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 u
                              
                           
                        where R is an unknown rotation matrix and 
                           
                              M
                              =
                              
                                 
                                    1
                                 
                                 
                                    |
                                    Ω
                                    |
                                 
                              
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              (
                              x
                              -
                              μ
                              )
                              
                                 
                                    (
                                    x
                                    -
                                    μ
                                    )
                                 
                                 
                                    T
                                 
                              
                              d
                              x
                           
                        . We use the SIFT descriptor [23] both to detect the unknown rotation (by the dominant gradient location of the image at 
                           
                              Ω
                           
                        ) and to describe the image in the affine normalized coordinates system. We then create match hypotheses by the similarity of the SIFT descriptor.

The affine normalization of the regions is also used to determine an affine transformation for each match hypotheses (for the proposed method) and to determine 3 points of correspondence (for [11]). The first point is the center of mass of the matched regions, two additional points of correspondence are the transformations of unit vectors in the directions of the x axis and the y axis in the normalized coordinate systems to the coordinate systems of the images.

We perform 100 experiments for each pair of images and measure the average number of iterations required by the LO-RANSAC algorithm. The results are summarized in Table 1
                        ; examples of the pairs of images with epipolar lines calculated using the proposed method are shown in Fig. 9
                        . The proposed method produces comparable and slightly better results than the state of the art, point based, method. Note that in this experiment the methods are not compared directly as an additional phase of estimation from more than three points is needed. Hence, the improvement over the point based method is not as big as in the synthetic experiment. The additional phase is required as the affine relations are not estimated with sufficient accuracy. Thus, comparison of the results of the synthetic experiment, to those obtained on real data leads to the conclusion that higher precision in estimating the local affine features is essential in order to achieve the potential performance gain of the proposed method, over the point the based method. Since the parameters of the local affine features are estimated by the MSER based procedure with only a limited accuracy, both the proposed method and the point based method can only serve as initializers in a Lo-RANSAC framework, and both provide comparable performance in this task. We are currently investigating new methodologies for improving the accuracy in estimating the parameters of local affine models from small image patches.

@&#CONCLUSIONS@&#

Although affine correspondences are widely used for obtaining matches between images, a comprehensive analysis of the constraints on epipolar geometry from affine correspondences has not been previously conducted. This paper provides a detailed analysis of the problem.

We have proved that each affine correspondence yields 3 linear constraints on the fundamental matrix. Furthermore, if the linear constraints are satisfied, the affine correspondence can be completed to an homography. By using the homography structure it is shown that although two affine correspondences do not fully determine the fundamental matrix, they constrain the location of the epipole to a conic. A simple parameterization of the conic by the affine correspondences was derived along with the properties of the conic. This further demonstrates that an affine correspondence is not equivalent to a 3 point correspondence, as in the case of 6 corresponding points (3 from each affine correspondence) it was shown by Faugeras [5] that the epipole is constrained to a cubic instead of a conic.

The conic constraint on the epipole was employed for calculation of the fundamental matrix from 3 affine correspondences. Experiments on synthetic data show that the calculation by intersection of conics is more accurate than the direct calculation by using the normalized 8 points method on points simulated from the affine correspondences. We further showed that since only 3 regions are required for calculating the fundamental matrix, the proposed method can be used for matching in scenarios where the inlier rate is low. However, as current affine estimation methods from small image patches are not accurate enough to enable accurate estimation of the fundamental matrix, on real data both the proposed and the simulated data methods can only serve as initializers for point based estimation from a larger number of points. Thus, comparison of the results of the synthetic experiments, to those obtained on real data leads to the conclusion that higher precision in estimating the local affine features is essential in order to achieve the potential performance gain of the proposed method, over the point the based methods.

We show here that the relation between the line parameterization 
                        
                           β
                        
                      and 
                        
                           
                              
                                 β
                              
                              
                                 ′
                              
                           
                        
                      in (19) and (24) is a one dimensional homography. As shown in (7) 
                     
                        
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                        
                      can be represented as
                        
                           (A.1)
                           
                              
                                 
                                    H
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    S
                                 
                                 
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 a
                              
                              
                                 4
                              
                           
                        
                      denote the terms of 
                        
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                        
                     . The image of a point 
                        
                           x
                           (
                           β
                           )
                           =
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           +
                           β
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           -
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           )
                        
                      by the homography 
                        
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                        
                      is
                        
                           (A.2)
                           
                              
                                 
                                    H
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                (
                                                β
                                                )
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                1
                                                +
                                                β
                                                )
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                -
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Recalling that 
                        
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           -
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           )
                        
                      we can rewrite (A.2) by treating 
                        
                           (
                           
                              
                                 h
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 6
                              
                           
                           )
                        
                      as a 2D vector as
                        
                           (A.3)
                           
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                1
                                                +
                                                β
                                                )
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                1
                                                +
                                                β
                                                )
                                                (
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      3
                                                   
                                                
                                                ,
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      6
                                                   
                                                
                                                )
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                -
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              ≅
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                +
                                                
                                                   
                                                      (
                                                      1
                                                      +
                                                      β
                                                      )
                                                   
                                                   
                                                      (
                                                      1
                                                      +
                                                      β
                                                      )
                                                      (
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            6
                                                         
                                                      
                                                      )
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           ≅
                        
                      represents equality up to a scale factor. The relation between 
                        
                           β
                        
                      to 
                        
                           
                              
                                 β
                              
                              
                                 ′
                              
                           
                        
                      is therefore a one dimensional homography.

We next show that a one dimensional homography can be calculated from 2 points and a derivative: A general form of a 1-D homography is given by
                        
                           (B.1)
                           
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    a
                                    β
                                    +
                                    b
                                 
                                 
                                    c
                                    β
                                    +
                                    1
                                 
                              
                           
                        
                     If 
                        
                           
                              
                                 β
                              
                              
                                 ′
                              
                           
                           =
                           0
                        
                      corresponds to 
                        
                           β
                           =
                           0
                        
                      , then 
                        
                           b
                           =
                           0
                        
                      and 
                        
                           
                              
                                 d
                                 
                                    
                                       β
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 d
                                 β
                              
                           
                           
                              
                                 |
                              
                              
                                 β
                                 =
                                 0
                              
                           
                           =
                           a
                        
                     . In the general case, where 
                        
                           
                              
                                 β
                              
                              
                                 0
                              
                           
                        
                      correspond to some 
                        
                           
                              
                                 β
                              
                              
                                 0
                              
                              
                                 ′
                              
                           
                        
                      and the derivative at 
                        
                           
                              
                                 β
                              
                              
                                 0
                              
                           
                        
                      is 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   β
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             d
                                             β
                                          
                                       
                                    
                                 
                              
                              
                                 β
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           =
                           a
                        
                     , we can express the one dimensional homography in homogeneous coordinates as
                        
                           (B.2)
                           
                              t
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                -
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

In Section 3, two parameterizations of a corresponding line by the homography 
                        
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                        
                      are given by (19) and (24). By the affine correspondence 
                        
                           (
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           )
                        
                      we have that 
                        
                           
                              
                                 β
                              
                              
                                 ′
                              
                           
                           (
                           
                              
                                 
                                    
                                       β
                                       =
                                       -
                                       1
                                       )
                                       =
                                       t
                                    
                                 
                              
                              
                                 β
                                 =
                                 -
                                 1
                              
                           
                           =
                           0
                        
                      and 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             dt
                                          
                                          
                                             d
                                             β
                                          
                                       
                                    
                                 
                              
                              
                                 β
                                 =
                                 -
                                 1
                              
                           
                           =
                           1
                        
                     . Substituting into the general homography (B.2), the homography t is therefore given by
                        
                           (B.3)
                           
                              t
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                c
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where c is yet to be determined. By the chosen parameterization 
                        
                           
                              
                                 
                                    
                                       t
                                    
                                 
                              
                              
                                 β
                                 =
                                 0
                              
                           
                           =
                           α
                        
                     , hence 
                        
                           c
                           =
                           
                              
                                 1
                              
                              
                                 α
                              
                           
                           -
                           1
                        
                     . Since the homography is now fully parameterized by 
                        
                           α
                        
                     , we can compute the derivative of t at 
                        
                           β
                           =
                           0
                        
                     ; we therefore have that 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             dt
                                          
                                          
                                             d
                                             β
                                          
                                       
                                    
                                 
                              
                              
                                 β
                                 =
                                 0
                              
                           
                           =
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                        
                     .

Let 
                        
                           a
                           ,
                           b
                           ,
                           c
                           ,
                           d
                        
                      be some known vectors in 
                        
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        
                     , where 
                        
                           e
                           =
                           (
                           a
                           ×
                           b
                           )
                           ×
                           (
                           (
                           c
                           ×
                           b
                           )
                           +
                           (
                           a
                           ×
                           d
                           )
                           )
                        
                     . A reformulation of 
                        
                           e
                        
                      can be written as
                        
                           (C.1)
                           
                              e
                              =
                              (
                              a
                              ×
                              b
                              )
                              ×
                              (
                              a
                              ×
                              d
                              )
                              +
                              (
                              b
                              ×
                              a
                              )
                              ×
                              (
                              b
                              ×
                              c
                              )
                              =
                              [
                              a
                              ·
                              (
                              b
                              ×
                              d
                              )
                              ]
                              a
                              +
                              [
                              b
                              ·
                              (
                              a
                              ×
                              c
                              )
                              ]
                              b
                           
                        
                     We can use the formulation to rewrite Eq. (27): Let 
                        
                           a
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                      , 
                        
                           b
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                                
                                                   ′
                                                
                                             
                                             +
                                             α
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                           ,
                           c
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           d
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                      , the term 
                        
                           b
                           ×
                           d
                        
                      is rewritten as
                        
                           (C.2)
                           
                              (
                              b
                              ×
                              d
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               2
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       α
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Thus the term that multiply 
                        
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                        
                      in (27) cancels out. Moreover, since 
                        
                           a
                           ·
                           (
                           b
                           ×
                           d
                           )
                           =
                           det
                           (
                           a
                           ,
                           b
                           ,
                           d
                           )
                           =
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                        
                      and 
                        
                           b
                           ·
                           (
                           a
                           ×
                           c
                           )
                           =
                           det
                           (
                           b
                           ,
                           a
                           ,
                           c
                           )
                           =
                           α
                           det
                           (
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           )
                           -
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                        
                      then Eq. (27) can be written more compactly as
                        
                           (C.3)
                           
                              e
                              =
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              (
                              α
                              det
                              (
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              )
                              -
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              )
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                +
                                                α
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

