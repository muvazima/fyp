@&#MAIN-TITLE@&#A confidence region for the ridge path in multiple response surface optimization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new approach to construct a confidence region for a multi-response surface is proposed.


                        
                        
                           
                           The proposed method overcomes the overfitting problem of the existing method.


                        
                        
                           
                           The proposed method outperforms the existing method when sample size is small.


                        
                        
                           
                           We get a more appropriate ridge path and confidence coverage than the existing method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Quality management

Conservative confidence region

Desirability function

Multi-response surface methodology

Seemingly unrelated regression model

@&#ABSTRACT@&#


               
               
                  Ridge analysis allows the analyst to explore the optimal operating conditions of the experimental factors. A confidence region is desirable for the estimated ridge path. Most literature concentrates on the univariate response situation. Little is known for the confidence region of the ridge path for the multivariate response; only a large-sample confidence interval for the ridge path is available. The simultaneous coverage rate for the existing interval is typically too conservative in practice, especially for small sample sizes. In this paper, the ridge path (via desirability function) is estimated based on the seemingly unrelated regression (SUR) model as well as standard multivariate regression (SMR) model, and a conservative confidence interval suitable for small sample sizes is proposed. It is shown that the proposed method outperforms the existing methods. Real-life examples and simulative study are given for illustration.
               
            

@&#INTRODUCTION@&#

Ridge analysis, first introduced by Hoerl (1959), is used to explore the optimal setting of the experimental variables. Consider the response surface model 
                        
                           y
                           =
                           f
                           (
                           x
                           ,
                           θ
                           )
                           +
                           
                              ɛ
                           
                           ,
                        
                      where y is the response variable, x is the vector of input variables, θ is the vector of model parameters, and ε is the error. Without loss of generality, suppose that maximization of the response is desirable. Let 
                        
                           g
                           
                              (
                              θ
                              ,
                              r
                              )
                           
                           =
                           
                              max
                              
                                 
                                    x
                                    ′
                                 
                                 x
                                 =
                                 
                                    r
                                    2
                                 
                              
                           
                           f
                           
                              (
                              x
                              ,
                              θ
                              )
                           
                        
                      represent the constrained optimal mean response value, where r is the distance from the center of the experiment region. A ridge path is the locus of the g(θ, r) on different radii (r) of the surface. The typical output of a ridge analysis is presented as two two-dimensional plots: a plot of g(θ, r) vs. r and an overlay plot of xir
                      vs. r
                     
                        
                           (
                           i
                           =
                           1
                           ,
                           …
                           ,
                           l
                           )
                           ,
                        
                      where l is the number of input variables. These are typically used to locate the optimal operating conditions.

The true value of the model parameter θ is unknown in practice, and the estimated value 
                        
                           θ
                           ^
                        
                      is used. Thus, the plot of 
                        
                           g
                           (
                           
                              θ
                              ^
                           
                           ,
                           r
                           )
                        
                      vs. r is only a statistical point estimate of the true ridge path. To construct the confidence region of the ridge path is obviously important since it can measure the accuracy of the estimation. Carter, Chinchilli, Myers, and Campbell (1986) proposed the use of simultaneous confidence bounds for a ridge path. Peterson (1993) gave a general approach to ridge analysis with confidence intervals. Both of them are limited to univariate responses. When multiple responses are involved in experiments, the common approach converts the multiple responses into a univariate index. Such a conversion is intentionally biased, however. Thus, it is desirable to investigate the standard error of the fitted parameters and their effects on optimization indices (See Hunter, 1999). Furthermore, the ridge path is well defined in univariate cases, but as by Lin (1999) it is hard to extend those ideas from univariate to multivariate cases straightforwardly. How to appropriately apply ridge analysis to multivariate cases deserves further study.


                     Ding, Lin, and Peterson (2005) applied the standard multivariate regression (SMR) model to fit the response surface model (RSM) and developed a large-sample simultaneous confidence interval for a multi-response ridge path based on the desirability function. However, their method may not be appropriate when the sample size is small. When the SMR model is used, it likely leads to overfitting for some responses because the design matrix is identical for each response in SMR but the significant terms for each response may be different. Here, a new approach to construct confidence intervals with multiple response surfaces is proposed. The seemingly unrelated regressions (SUR) model (Zellner, 1962) is employed in our method. The SUR model could fit the model with different experimental factors for each response, meanwhile it estimates the correlations among all responses. Compared with the existing methods, the proposed method using the SUR model, results in a smoother and more reliable confidence interval when the sample size is small. This will help experimenters to locate the optimal setting in an efficient manner.

The paper is organized as follows. In Section 2, a brief review of ridge analysis is presented. Estimating a ridge path based on SUR model and a conservative confidence approach are then proposed in Section 3. Section 3 also provides the algorithm of the proposed method and its general properties. In Section 4, the tire tread example (with small sample size) is used for illustration with comparisons to previous works, as well as a large sample case. A further simulation study is also provided. The conclusion is given in Section 5.


                        Peterson (1993) took f(x, θ) as z(x)′θ, where z(x) is a p × 1 vector-valued function of a k × 1 vector of factors. Thus, the response surface model 
                           
                              y
                              =
                              f
                              (
                              x
                              ,
                              θ
                              )
                              +
                              
                                 ɛ
                              
                           
                         can be represented as 
                           
                              y
                              =
                              z
                              
                                 
                                    (
                                    x
                                    )
                                 
                                 ′
                              
                              θ
                              +
                              
                                 ɛ
                              
                           
                        . Then, the ridge path g(θ, r) becomes 
                           
                              g
                              
                                 (
                                 θ
                                 ,
                                 r
                                 )
                              
                              =
                              
                                 max
                                 
                                    
                                       x
                                       ′
                                    
                                    x
                                    =
                                    
                                       r
                                       2
                                    
                                 
                              
                              z
                              
                                 
                                    (
                                    x
                                    )
                                 
                                 ′
                              
                              θ
                           
                        . Carter et al. (1986) proposed the simultaneous confidence bounds of the optimal responses for various r, and the form of the confidence bounds can be written as

                           
                              (1)
                              
                                 
                                    
                                       [
                                       
                                          min
                                          
                                             θ
                                             ∈
                                             C
                                          
                                       
                                       
                                          {
                                          
                                             max
                                             
                                                
                                                   x
                                                   ′
                                                
                                                x
                                                =
                                                
                                                   r
                                                   2
                                                
                                             
                                          
                                          z
                                          
                                             
                                                (
                                                x
                                                )
                                             
                                             ′
                                          
                                          θ
                                          }
                                       
                                       ,
                                       
                                          max
                                          
                                             θ
                                             ∈
                                             C
                                          
                                       
                                       
                                          {
                                          
                                             max
                                             
                                                
                                                   x
                                                   ′
                                                
                                                x
                                                =
                                                
                                                   r
                                                   2
                                                
                                             
                                          
                                          z
                                          
                                             
                                                (
                                                x
                                                )
                                             
                                             ′
                                          
                                          θ
                                          }
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        where C is a 
                           
                              100
                              (
                              1
                              −
                              α
                              )
                              %
                           
                         confidence region for θ. The confidence region C is defined as 
                           
                              C
                              =
                              {
                              θ
                              :
                              
                                 
                                    (
                                    θ
                                    −
                                    
                                       θ
                                       ^
                                    
                                    )
                                 
                                 ′
                              
                              
                                 V
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 θ
                                 −
                                 
                                    θ
                                    ^
                                 
                                 )
                              
                              ≤
                              
                                 c
                                 α
                                 2
                              
                              }
                              ,
                           
                         where 
                           
                              θ
                              ^
                           
                         is an estimate of θ, V is an estimate of 
                           
                              v
                              a
                              r
                              (
                              
                                 θ
                                 ^
                              
                              )
                              ,
                           
                         and 
                           
                              
                                 c
                                 α
                                 2
                              
                              =
                              p
                              F
                              
                                 (
                                 1
                                 −
                                 α
                                 ,
                                 p
                                 ,
                                 n
                                 −
                                 p
                                 )
                              
                              ,
                           
                         with n being the sample size and 
                           
                              F
                              (
                              1
                              −
                              α
                              ,
                              p
                              ,
                              n
                              −
                              p
                              )
                           
                         is the 
                           
                              100
                              (
                              1
                              −
                              α
                              )
                           
                        th percentile of the F distribution with p and 
                           
                              (
                              n
                              −
                              p
                              )
                           
                         degrees of freedom. Peterson (1993) proposed an alternative confidence bound as 
                           
                              [
                              
                                 max
                                 
                                    
                                       x
                                       ′
                                    
                                    x
                                    =
                                    
                                       r
                                       2
                                    
                                 
                              
                              
                                 {
                                 
                                    min
                                    
                                       θ
                                       ∈
                                       C
                                    
                                 
                                 z
                                 
                                    
                                       (
                                       x
                                       )
                                    
                                    ′
                                 
                                 θ
                                 }
                              
                              ,
                              
                                 max
                                 
                                    
                                       x
                                       ′
                                    
                                    x
                                    =
                                    
                                       r
                                       2
                                    
                                 
                              
                              
                                 {
                                 
                                    max
                                    
                                       θ
                                       ∈
                                       C
                                    
                                 
                                 z
                                 
                                    
                                       (
                                       x
                                       )
                                    
                                    ′
                                 
                                 θ
                                 }
                              
                              ]
                           
                        . Because z(x)′θ is linear in θ, the confidence interval can be written as 
                           
                              
                                 max
                                 
                                    
                                       x
                                       ′
                                    
                                    x
                                    =
                                    
                                       r
                                       2
                                    
                                 
                              
                              
                                 {
                                 z
                                 
                                    
                                       (
                                       x
                                       )
                                    
                                    ′
                                 
                                 
                                    θ
                                    ^
                                 
                                 ±
                                 
                                    c
                                    α
                                 
                                 
                                    
                                       (
                                       z
                                       
                                          
                                             (
                                             x
                                             )
                                          
                                          ′
                                       
                                       V
                                       z
                                       
                                          (
                                          x
                                          )
                                       
                                       )
                                    
                                    
                                       1
                                       2
                                    
                                 
                                 }
                              
                           
                        . For a rotatable design, this can be further simplified as 
                           
                              
                                 max
                                 
                                    
                                       x
                                       ′
                                    
                                    x
                                    =
                                    
                                       r
                                       2
                                    
                                 
                              
                              
                                 {
                                 z
                                 
                                    
                                       (
                                       x
                                       )
                                    
                                    ′
                                 
                                 
                                    θ
                                    ^
                                 
                                 }
                              
                              ±
                              
                                 c
                                 α
                              
                              
                                 σ
                                 ^
                              
                              v
                              
                                 
                                    (
                                    r
                                    )
                                 
                                 
                                    1
                                    2
                                 
                              
                              ,
                           
                         where 
                           
                              
                                 σ
                                 ^
                              
                              2
                           
                         is the sample-error mean square and 
                           
                              v
                              
                                 (
                                 r
                                 )
                              
                              =
                              z
                              
                                 
                                    (
                                    x
                                    )
                                 
                                 ′
                              
                              
                                 
                                    (
                                    
                                       Z
                                       ′
                                    
                                    Z
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              z
                              
                                 (
                                 x
                                 )
                              
                              ,
                           
                         with 
                           
                              
                                 x
                                 ′
                              
                              x
                              =
                              
                                 r
                                 2
                              
                           
                        . Z is the regression model matrix.

Note that the Carter et al. (1986) approach requires a nonlinear optimization solver for max z(x)′θ subject to 
                           
                              
                                 x
                                 ′
                              
                              x
                              =
                              
                                 r
                                 2
                              
                           
                         to obtain x
                        *, such that it maximize 
                           
                              z
                              
                                 
                                    (
                                    
                                       x
                                       *
                                    
                                    )
                                 
                                 ′
                              
                              
                                 θ
                                 ^
                              
                           
                        . One then applies another nonlinear solver for min  or max {z(x
                        *)′θ} subject to θ ∈ C. Peterson (1993) argued that solving 
                           
                              
                                 max
                                 
                                    
                                       x
                                       ′
                                    
                                    x
                                    =
                                    
                                       r
                                       2
                                    
                                 
                              
                              
                                 {
                                 z
                                 
                                    
                                       (
                                       x
                                       )
                                    
                                    ′
                                 
                                 
                                    θ
                                    ^
                                 
                                 ±
                                 
                                    C
                                    α
                                 
                                 
                                    
                                       (
                                       z
                                       
                                          
                                             (
                                             x
                                             )
                                          
                                          ′
                                       
                                       V
                                       z
                                       
                                          (
                                          x
                                          )
                                       
                                       )
                                    
                                    
                                       1
                                       2
                                    
                                 
                                 }
                              
                           
                         in reality is much more manageable than solving Eq. (1). However, his approach utilizes the property that z(x)′θ is linear in θ which is an unrealistic assumption for multivariate response problems in many situations. It is usually highly nonlinear in both θ and x in the desirability function.

A general multi-response problem can be written as

                           
                              (2)
                              
                                 
                                    
                                       y
                                       i
                                    
                                    =
                                    f
                                    
                                       (
                                       x
                                       ,
                                       
                                          θ
                                          i
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ɛ
                                       
                                       i
                                    
                                 
                              
                           
                        for 
                           
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              p
                              ,
                           
                         where yi
                         is the response vector, 
                           
                              x
                              =
                              (
                              
                                 x
                                 1
                              
                              ,
                              
                                 x
                                 2
                              
                              ,
                              …
                              ,
                              
                                 x
                                 k
                              
                              )
                           
                         is input variable vector, θi
                         is the vector of model parameters, and the ε
                           i
                         is random error term, typically assumed to be N(0, σ
                        2). The model function f(x, θi
                        ) represents the functional relation between the ith response and the input variables.

The parameters θ are usually estimated by fitting multivariate linear regression models in the matrix form (see, e.g., Arnold, 1981, p. 349),

                           
                              (3)
                              
                                 
                                    Y
                                    ∼
                                    
                                       N
                                       
                                          n
                                          ,
                                          p
                                       
                                    
                                    
                                       (
                                       X
                                       Θ
                                       ,
                                       Σ
                                       )
                                    
                                    ,
                                 
                              
                           
                        where n is the number of independent experiment runs, and m is the number of response variables in each run, with a fixed covariance matrix Σ. The matrices Y, X and Θ are the response matrix (n × p), design matrix (n × m) and parameter matrix (m × p), respectively.

The optimization for a multi-response issue is to find a set of operating conditions x
                        * that optimizes all responses in the given ranges. Many methods have been proposed for optimization of multiple responses (Bera & Mukherjee, 2015; Kim & Lin, 2006). See, for examples, the generalized distance measure (Khuri & Conlon, 1981), and the squared error loss approach (Ames, Mattucci, Macdonald, Szonyi, & Hawkins, 1997; Pignatiello, 1993; Vining, 1998). The most popular approach is probably the desirability function. The desirability function (Derringer & Suich, 1980; Harrington, 1965; He, Zhu, & Park, 2012; Jeong & Kim, 2009) transforms an estimated response yi
                         to a scale free value di
                        (·) ∈ [0, 1], called a desirability. The overall desirability function is then defined as the geometric mean

                           
                              (4)
                              
                                 
                                    D
                                    
                                       (
                                       x
                                       ,
                                       θ
                                       )
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             ∏
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             d
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   y
                                                   ^
                                                
                                                i
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          1
                                          /
                                          m
                                       
                                    
                                    .
                                 
                              
                           
                        
                        Kim and Lin (2000) used an exponential form of the desirability function and illustrated its application to the simultaneous optimization of mechanical properties of steel. This approach also considered the predictive of every individual response surface model. In general, any reasonable desirability function can be used here, as long as it is continuous and differentiable. Following Ding et al. (2005), we adapt the desirability functions of Gibb, Carter, and Myers (2001),

                           
                              (5)
                              
                                 
                                    
                                       d
                                       i
                                    
                                    
                                       (
                                       
                                          
                                             y
                                             ^
                                          
                                          i
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      [
                                                      1
                                                      +
                                                      
                                                         e
                                                         
                                                            −
                                                            
                                                               
                                                                  E
                                                                  
                                                                     (
                                                                     
                                                                        y
                                                                        i
                                                                     
                                                                     )
                                                                  
                                                                  −
                                                                  
                                                                     a
                                                                     i
                                                                  
                                                               
                                                               
                                                                  b
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      if
                                                   
                                                   
                                                   
                                                      y
                                                      i
                                                   
                                                   
                                                   
                                                      is
                                                      
                                                      LTB
                                                   
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                          
                                          
                                             
                                                
                                                   e
                                                   
                                                      −
                                                      0.5
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  E
                                                                  
                                                                     (
                                                                     
                                                                        y
                                                                        i
                                                                     
                                                                     )
                                                                  
                                                                  −
                                                                  
                                                                     a
                                                                     i
                                                                  
                                                               
                                                               
                                                                  b
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      if
                                                   
                                                   
                                                   
                                                      y
                                                      i
                                                   
                                                   
                                                   
                                                      is
                                                      
                                                      NTB
                                                   
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      [
                                                      1
                                                      +
                                                      
                                                         e
                                                         
                                                            
                                                               E
                                                               
                                                                  (
                                                                  
                                                                     y
                                                                     i
                                                                  
                                                                  )
                                                               
                                                               −
                                                               
                                                                  a
                                                                  i
                                                               
                                                            
                                                            
                                                               b
                                                               i
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      if
                                                   
                                                   
                                                   
                                                      y
                                                      i
                                                   
                                                   
                                                   
                                                      is
                                                      
                                                      STB
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        For the nominal-the-best (NTB) case, ai
                         is the target value of response, and 
                           
                              
                                 b
                                 i
                              
                              =
                              
                                 
                                    δ
                                    i
                                 
                                 
                                    
                                       −
                                       2
                                       l
                                       n
                                       (
                                       
                                          γ
                                          i
                                       
                                       )
                                    
                                 
                              
                           
                         is to control the spread of the function, where γi
                         ∈ (0, 1). For the larger-the-better (LTB) or the smaller-the-better (STB) case, 
                           
                              
                                 
                                 
                              
                              
                                 a
                                 i
                              
                              =
                              
                                 
                                    
                                       y
                                       i
                                       
                                          m
                                          a
                                          x
                                       
                                    
                                    −
                                    
                                       y
                                       i
                                       
                                          m
                                          i
                                          n
                                       
                                    
                                 
                                 2
                              
                           
                         and 
                           
                              
                                 b
                                 i
                              
                              =
                              
                                 
                                    
                                       y
                                       i
                                       
                                          m
                                          a
                                          x
                                       
                                    
                                    −
                                    
                                       y
                                       i
                                       
                                          m
                                          i
                                          n
                                       
                                    
                                 
                                 
                                    2
                                    l
                                    n
                                    (
                                    
                                       
                                          1
                                          −
                                          
                                             γ
                                             i
                                          
                                       
                                       
                                          γ
                                          i
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                         where 
                           
                              
                                 y
                                 i
                                 
                                    m
                                    a
                                    x
                                 
                              
                              >
                              
                                 y
                                 i
                                 
                                    m
                                    i
                                    n
                                 
                              
                              ,
                           
                         and γi
                         ∈ (0, 1). The values of δi
                         and γi
                         can be determined via the guideline given by Gibb et al. (2001).


                        Ding et al. (2005) developed a large-sample simultaneous confidence interval for a multi-response ridge path based on the desirability function. They defined the multi-response ridge path as the plot of g(θ, r) vs. radius r, where

                           
                              (6)
                              
                                 
                                    g
                                    
                                       (
                                       θ
                                       ,
                                       r
                                       )
                                    
                                    =
                                    
                                       max
                                       
                                          
                                             x
                                             ′
                                          
                                          x
                                          =
                                          
                                             r
                                             2
                                          
                                       
                                    
                                    D
                                    
                                       (
                                       θ
                                       ,
                                       x
                                       )
                                    
                                    ,
                                 
                              
                           
                        Assuming that 
                           
                              
                                 x
                                 0
                              
                              =
                              
                                 x
                                 0
                              
                              
                                 (
                                 θ
                                 ,
                                 r
                                 )
                              
                              =
                              a
                              r
                              g
                              
                                 max
                                 
                                    
                                       x
                                       ′
                                    
                                    x
                                    =
                                    
                                       r
                                       2
                                    
                                 
                              
                              D
                              
                                 (
                                 x
                                 ,
                                 θ
                                 )
                              
                           
                         is unique for each r, Ding et al. (2005) construct 
                           
                              100
                              (
                              1
                              −
                              α
                              )
                              %
                           
                         asymptotic simultaneous confidence intervals for g(θ, r) which have the form of

                           
                              (7)
                              
                                 
                                    
                                       [
                                       
                                          
                                             e
                                             L
                                          
                                          
                                             1
                                             +
                                             
                                                e
                                                L
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             e
                                             U
                                          
                                          
                                             1
                                             +
                                             
                                                e
                                                U
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 [
                                 L
                                 ,
                                 U
                                 ]
                              
                              =
                              log
                              it
                              
                                 (
                                 g
                                 
                                    (
                                    
                                       θ
                                       ^
                                    
                                    ,
                                    r
                                    )
                                 
                                 )
                              
                              ±
                              
                                 z
                                 
                                    α
                                    /
                                    2
                                    q
                                 
                              
                              
                                 c
                                 ^
                              
                              
                                 (
                                 r
                                 )
                              
                              ,
                           
                         where z
                        
                           α/2q
                         is the upper α/2q critical value of standard normal distribution, q is the number of radii. 
                           
                              
                                 c
                                 ^
                              
                              
                                 (
                                 r
                                 )
                              
                           
                         is the estimated standard error of 
                           
                              logit
                              (
                              g
                              
                                 (
                                 
                                    θ
                                    ^
                                 
                                 ,
                                 r
                                 )
                              
                              )
                              ,
                           
                         and 
                           
                              
                                 c
                                 ^
                              
                              
                                 
                                    (
                                    r
                                    )
                                 
                                 2
                              
                              =
                              
                                 
                                    
                                       D
                                       θ
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                                ^
                                             
                                             0
                                          
                                          ,
                                          
                                             θ
                                             ^
                                          
                                          )
                                       
                                       ′
                                    
                                    
                                       (
                                       
                                          Σ
                                          ^
                                       
                                       ⊗
                                       
                                          
                                             (
                                             
                                                X
                                                ′
                                             
                                             X
                                             )
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       D
                                       θ
                                    
                                    
                                       (
                                       
                                          
                                             x
                                             ^
                                          
                                          0
                                       
                                       ,
                                       
                                          θ
                                          ^
                                       
                                       )
                                    
                                 
                                 
                                    (
                                    D
                                    
                                       (
                                       
                                          
                                             x
                                             ^
                                          
                                          0
                                       
                                       ,
                                       
                                          θ
                                          ^
                                       
                                       )
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          D
                                          
                                             (
                                             
                                                
                                                   x
                                                   ^
                                                
                                                0
                                             
                                             ,
                                             
                                                θ
                                                ^
                                             
                                             )
                                          
                                          )
                                       
                                       2
                                    
                                 
                              
                              ,
                           
                         in which 
                           
                              
                                 
                                    x
                                    ^
                                 
                                 0
                              
                              =
                              
                                 x
                                 0
                              
                              
                                 (
                                 
                                    θ
                                    ^
                                 
                                 ,
                                 r
                                 )
                              
                           
                        . Logistic regression is popularly used in many areas, especially in bioscience (see Hosmer and Lemeshow (2005), for example). This results a Bonferroni’s z type confidence band, since the critical value is based on Bonferroni’s inequality.

One immediate question, however, is how to construct a confidence band of a path ridge of multiple responses for the small sample case. Here, we propose a new method to construct a confidence region for ridge path of multiple responses, and it is shown to be reliable when the sample size is small.

Since SMR model is likely to overfit for one or more of the responses, a SUR model proposed by Zellner (1962) is believed to be much more appropriate here. Suppose Xj
                         (for 
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              p
                           
                        ) is an n × qj
                         design matrix which includes all the selected significant terms. These significant terms can be identified from fitting the univariate model for the jth response. If we also assume that the Xj
                         have full column rank 
                           
                              
                                 q
                                 j
                              
                              
                                 (
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                                 )
                              
                              ,
                           
                         a SUR model can be written as

                           
                              (8)
                              
                                 
                                    y
                                    =
                                    G
                                    θ
                                    +
                                    
                                       ɛ
                                    
                                 
                              
                           
                        where 
                           
                              y
                              =
                              v
                              e
                              c
                              (
                              Y
                              )
                              ,
                           
                        
                        
                           
                              c
                              o
                              v
                              
                                 (
                                 y
                                 )
                              
                              =
                              Σ
                              ⊗
                              
                                 I
                                 n
                              
                              ,
                           
                        
                        
                           
                              θ
                              =
                              
                                 
                                    (
                                    
                                       θ
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       θ
                                       m
                                    
                                    )
                                 
                                 ′
                              
                              ,
                           
                        
                        
                           
                              
                                 ɛ
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          ɛ
                                       
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ɛ
                                       
                                       p
                                    
                                    )
                                 
                                 ′
                              
                              ,
                           
                         
                        G is the block-diagonal design matrix which can be written as

                           
                              
                                 
                                    
                                       G
                                       
                                          n
                                          p
                                          ×
                                          q
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   X
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                             
                                                ⋯
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   X
                                                   2
                                                
                                             
                                             
                                                …
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                             
                                                ⋱
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   X
                                                   p
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        and 
                           
                              q
                              =
                              
                                 q
                                 1
                              
                              +
                              
                                 q
                                 2
                              
                              +
                              ⋯
                              +
                              
                                 q
                                 p
                              
                           
                        . The estimation of θ in Eq. (8) can be obtained by Maximum Likelihood (ML) estimate as,

                           
                              (9)
                              
                                 
                                    
                                       θ
                                       ^
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             G
                                             ′
                                          
                                          
                                             
                                                (
                                                Ω
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          G
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       G
                                       ′
                                    
                                    
                                       Ω
                                       
                                          −
                                          1
                                       
                                    
                                    y
                                    ,
                                 
                              
                           
                        where 
                           
                              Ω
                              =
                              Σ
                              ⊗
                              
                                 I
                                 n
                              
                           
                        . However, the true covariance matrix Σ is generally unknown. The solution for this problem is a feasible generalized least squares (FGLS) estimation. Zellner and Huang (1962) estimated Σ via 
                           
                              
                                 Σ
                                 ^
                              
                              =
                              S
                              =
                              
                                 [
                                 
                                    s
                                    
                                       i
                                       j
                                    
                                 
                                 ]
                              
                           
                         , where 
                           
                              
                                 s
                                 
                                    i
                                    j
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             ɛ
                                          
                                          ^
                                       
                                       i
                                       ′
                                    
                                    
                                       
                                          
                                             ɛ
                                          
                                          ^
                                       
                                       j
                                    
                                 
                                 
                                    n
                                    −
                                    
                                       q
                                       i
                                    
                                    −
                                    
                                       q
                                       j
                                    
                                    +
                                    
                                       q
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 q
                                 
                                    i
                                    j
                                 
                              
                              =
                              t
                              r
                              a
                              c
                              e
                              
                                 [
                                 
                                    
                                       (
                                       
                                          X
                                          i
                                          ′
                                       
                                       
                                          X
                                          i
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    X
                                    i
                                    ′
                                 
                                 
                                    X
                                    j
                                 
                                 
                                    
                                       (
                                       
                                          X
                                          j
                                          ′
                                       
                                       
                                          X
                                          j
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    X
                                    j
                                    ′
                                 
                                 
                                    X
                                    i
                                 
                                 ]
                              
                           
                        . Substituting 
                           
                              Σ
                              ^
                           
                         for Σ in Eq. (9), the FGLS estimator of θ is 
                           
                              
                                 
                                    θ
                                    ^
                                 
                                 ^
                              
                              =
                              
                                 
                                    (
                                    
                                       G
                                       ′
                                    
                                    
                                       
                                          (
                                          
                                             Σ
                                             ^
                                          
                                          ⊗
                                          
                                             I
                                             n
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    G
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 G
                                 ′
                              
                              
                                 
                                    (
                                    
                                       Σ
                                       ^
                                    
                                    ⊗
                                    
                                       I
                                       n
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              y
                           
                        . Therefore, a two-stage process is applied to estimate θ: Σ is firstly estimated with 
                           
                              Σ
                              ^
                           
                         such that 
                           
                              
                                 Σ
                                 ^
                              
                              
                                 →
                                 p
                              
                              Σ
                              ,
                           
                         and then 
                           
                              
                                 θ
                                 ^
                              
                              ^
                           
                         is obtained. The ML estimate is obtained by iterating the process. The 
                           
                              Ω
                              =
                              Σ
                              ⊗
                              
                                 I
                                 n
                              
                           
                         can be re-estimated with 
                           
                              
                                 θ
                                 ^
                              
                              ^
                           
                         as 
                           
                              
                                 
                                    Ω
                                    ^
                                 
                                 2
                              
                              =
                              
                                 (
                                 y
                                 −
                                 G
                                 
                                    
                                       
                                          θ
                                          ^
                                       
                                       ^
                                    
                                    1
                                 
                                 )
                              
                              
                                 
                                    (
                                    y
                                    −
                                    G
                                    
                                       
                                          
                                             θ
                                             ^
                                          
                                          ^
                                       
                                       1
                                    
                                    )
                                 
                                 ′
                              
                              ,
                           
                         where 
                           
                              
                                 
                                    θ
                                    ^
                                 
                                 ^
                              
                              1
                           
                         is the two stage estimate. Then a revised estimate of θ is 
                           
                              
                                 
                                    
                                       θ
                                       ^
                                    
                                    ^
                                 
                                 2
                              
                              =
                              
                                 
                                    (
                                    
                                       G
                                       ′
                                    
                                    
                                       
                                          (
                                          
                                             
                                                Ω
                                                ^
                                             
                                             2
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    G
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 G
                                 ′
                              
                              
                                 
                                    Ω
                                    ^
                                 
                                 2
                                 
                                    −
                                    1
                                 
                              
                              y
                           
                        . Continuing in this manner, the ith iteration is 
                           
                              
                                 
                                    Ω
                                    ^
                                 
                                 i
                              
                              =
                              
                                 (
                                 y
                                 −
                                 G
                                 
                                    
                                       
                                          θ
                                          ^
                                       
                                       ^
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 )
                              
                              
                                 
                                    (
                                    y
                                    −
                                    G
                                    
                                       
                                          
                                             θ
                                             ^
                                          
                                          ^
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 ′
                              
                              ,
                           
                         and 
                           
                              
                                 
                                    
                                       θ
                                       ^
                                    
                                    ^
                                 
                                 i
                              
                              =
                              
                                 
                                    (
                                    
                                       G
                                       ′
                                    
                                    
                                       
                                          (
                                          
                                             
                                                Ω
                                                ^
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    G
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 G
                                 ′
                              
                              
                                 
                                    Ω
                                    ^
                                 
                                 
                                    i
                                    −
                                    1
                                 
                                 
                                    −
                                    1
                                 
                              
                              y
                           
                        . The process stops when 
                           
                              
                                 
                                    θ
                                    ^
                                 
                                 ^
                              
                              i
                           
                         converges such that 
                           
                              ∥
                              
                                 
                                    
                                       θ
                                       ^
                                    
                                    ^
                                 
                                 i
                              
                              −
                              
                                 
                                    
                                       θ
                                       ^
                                    
                                    ^
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              
                                 ∥
                                 2
                              
                              <
                              δ
                           
                         for some δ > 0. Such a δ is typically pre-specified.

We define the ridge path for the multiple response model based on the desirability function. A multi-response ridge path g(θ, r) can be defined on desirability function D as in Eq. (6). It should be noticed that the desirability function D(x, θ) is usually highly nonlinear in both θ and x: thus Peterson's (1993) approach may not be appropriate. Following Carter et al. (1986), a conservative 
                           
                              100
                              (
                              1
                              −
                              α
                              )
                              %
                           
                         confidence band for 
                           
                              
                                 max
                                 
                                    
                                       x
                                       ′
                                    
                                    x
                                    =
                                    
                                       r
                                       2
                                    
                                 
                              
                              D
                              
                                 (
                                 x
                                 ,
                                 θ
                                 )
                              
                           
                         can be defined as

                           
                              (10)
                              
                                 
                                    
                                       [
                                       
                                          min
                                          
                                             θ
                                             ∈
                                             C
                                          
                                       
                                       
                                          {
                                          
                                             max
                                             
                                                
                                                   x
                                                   ′
                                                
                                                x
                                                =
                                                
                                                   r
                                                   2
                                                
                                             
                                          
                                          D
                                          
                                             (
                                             x
                                             ,
                                             θ
                                             )
                                          
                                          }
                                       
                                       ,
                                       
                                          max
                                          
                                             θ
                                             ∈
                                             C
                                          
                                       
                                       
                                          {
                                          
                                             max
                                             
                                                
                                                   x
                                                   ′
                                                
                                                x
                                                =
                                                
                                                   r
                                                   2
                                                
                                             
                                          
                                          D
                                          
                                             (
                                             x
                                             ,
                                             θ
                                             )
                                          
                                          }
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        where C is a 
                           
                              100
                              (
                              1
                              −
                              α
                              )
                              %
                           
                         confidence region for θ.

The important next step is to find a closed form of C. From Timm (2002), a test of the hypothesis 
                           
                              
                                 H
                                 0
                              
                              :
                              θ
                              =
                              
                                 θ
                                 *
                              
                           
                         for SUR model (Eq. 8) can be conducted using the approximate F-test statistic of 
                           
                              
                                 F
                                 *
                              
                              =
                              
                                 (
                                 W
                                 /
                                 
                                    v
                                    h
                                 
                                 )
                              
                              /
                              M
                              S
                              e
                              ,
                           
                         where 
                           
                              M
                              S
                              e
                              =
                              
                                 
                                    
                                       
                                          (
                                          y
                                          −
                                          G
                                          
                                             
                                                θ
                                                ^
                                             
                                             ^
                                          
                                          )
                                       
                                       ′
                                    
                                    
                                       
                                          Ω
                                          ^
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       y
                                       −
                                       G
                                       
                                          
                                             θ
                                             ^
                                          
                                          ^
                                       
                                       )
                                    
                                 
                                 
                                    v
                                    e
                                 
                              
                              ,
                           
                         and 
                           
                              W
                              =
                              
                                 
                                    (
                                    
                                       
                                          θ
                                          ^
                                       
                                       ^
                                    
                                    −
                                    
                                       θ
                                       *
                                    
                                    )
                                 
                                 ′
                              
                              
                                 [
                                 
                                    G
                                    ′
                                 
                                 
                                    
                                       (
                                       
                                          Σ
                                          ^
                                       
                                       ⊗
                                       
                                          I
                                          n
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 G
                                 ]
                              
                              
                                 (
                                 
                                    
                                       θ
                                       ^
                                    
                                    ^
                                 
                                 −
                                 
                                    θ
                                    *
                                 
                                 )
                              
                           
                        . Henningsen and Hamann (2007) recommend using the degrees of freedom 
                           
                              
                                 v
                                 e
                              
                              =
                              n
                              p
                              −
                              q
                           
                         and 
                           
                              
                                 v
                                 h
                              
                              =
                              q
                           
                        . Here, 
                           
                              
                                 v
                                 h
                              
                              =
                              2
                           
                         is suggested instead of q. The rationale for using 
                           
                              
                                 v
                                 h
                              
                              =
                              2
                           
                         in ridge analysis was given by Peterson (1993) as follows. Define Z as the factor variable space. As the radius value r goes from 0, the optimal vector x
                        0 produces a ridge trace in Z extending from the origin. Suppose this ridge trace is a ray with only moderate curvature, a 
                           
                              100
                              (
                              1
                              −
                              α
                              )
                              %
                           
                         confidence band about a mean-response line corresponding to a straight line in Z uses a critical value of 2F(2, ve
                        ). This is because this one-dimensional straight-line ray is associated with a two-dimensional linear subspace of the Z-space (Miller, 1981). Simulation studies by Peterson (1993) and Peterson and Kuhn (2005) found that the 2F(2, ve
                        ) critical value worked well for all their ridge analysis examples. The close form of C can be created by F
                        * as 
                           
                              C
                              =
                              {
                              
                                 θ
                                 *
                              
                              :
                              
                                 F
                                 *
                              
                              ≤
                              
                                 F
                                 
                                    1
                                    −
                                    α
                                 
                              
                              
                                 (
                                 
                                    v
                                    h
                                 
                                 ,
                                 
                                    v
                                    e
                                 
                                 )
                              
                              }
                           
                        . Namely,

                           
                              (11)
                              
                                 
                                    C
                                    =
                                    
                                       {
                                       
                                          θ
                                          *
                                       
                                       :
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         θ
                                                         ^
                                                      
                                                      ^
                                                   
                                                   −
                                                   
                                                      θ
                                                      *
                                                   
                                                   )
                                                
                                                ′
                                             
                                             
                                                [
                                                
                                                   G
                                                   ′
                                                
                                                
                                                   
                                                      (
                                                      
                                                         Σ
                                                         ^
                                                      
                                                      ⊗
                                                      
                                                         I
                                                         n
                                                      
                                                      )
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                G
                                                ]
                                             
                                             
                                                (
                                                
                                                   
                                                      θ
                                                      ^
                                                   
                                                   ^
                                                
                                                −
                                                
                                                   θ
                                                   *
                                                
                                                )
                                             
                                          
                                          
                                             M
                                             S
                                             e
                                          
                                       
                                       ≤
                                       
                                          v
                                          h
                                       
                                       
                                          F
                                          
                                             1
                                             −
                                             α
                                          
                                       
                                       
                                          (
                                          
                                             v
                                             h
                                          
                                          ,
                                          
                                             v
                                             e
                                          
                                          )
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        
                     

The ridge path and its confidence bands can be constructed step-by-step. Basically it consists of three steps: (1) Model fitting; (2) Ridge path estimation; and (3) Confidence interval estimation.

There may exist some insignificant terms. The 
                                 
                                    R
                                    i
                                    2
                                 
                               and 
                                 
                                    R
                                    
                                       *
                                    
                                    2
                                 
                               (McElroy, 1977) criteria are recommended to select the final SUR model. 
                                 
                                    R
                                    i
                                    2
                                 
                               is to measure the goodness of fit for each 
                                 
                                    
                                       y
                                       i
                                    
                                    =
                                    f
                                    
                                       (
                                       x
                                       ,
                                       
                                          θ
                                          i
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ɛ
                                       
                                       i
                                    
                                    ,
                                 
                               while 
                                 
                                    R
                                    
                                       *
                                    
                                    2
                                 
                               is to measure the goodness of fit for the entire SUR model. They are defined as follows:

                                 
                                    (12)
                                    
                                       
                                          
                                             R
                                             i
                                             2
                                          
                                          =
                                          1
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         ɛ
                                                      
                                                      ^
                                                   
                                                   i
                                                   ′
                                                
                                                
                                                   
                                                      
                                                         ɛ
                                                      
                                                      ^
                                                   
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         y
                                                         i
                                                      
                                                      −
                                                      
                                                         
                                                            y
                                                            ¯
                                                         
                                                         i
                                                      
                                                      )
                                                   
                                                   ′
                                                
                                                
                                                   (
                                                   
                                                      y
                                                      i
                                                   
                                                   −
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      i
                                                   
                                                   )
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              and

                                 
                                    (13)
                                    
                                       
                                          
                                             R
                                             
                                                *
                                             
                                             2
                                          
                                          =
                                          1
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         ɛ
                                                      
                                                      ^
                                                   
                                                   ′
                                                
                                                
                                                   
                                                      Ω
                                                      ^
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ɛ
                                                   
                                                   ^
                                                
                                             
                                             
                                                
                                                   y
                                                   ′
                                                
                                                
                                                   [
                                                   
                                                      
                                                         Σ
                                                         ^
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   ⊗
                                                   
                                                      (
                                                      
                                                         I
                                                         n
                                                      
                                                      −
                                                      
                                                         
                                                            1
                                                            
                                                               1
                                                               ′
                                                            
                                                         
                                                         n
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                                y
                                             
                                          
                                          ,
                                       
                                    
                                 
                              where 
                                 
                                    
                                       y
                                       ¯
                                    
                                    i
                                 
                               is the mean value of yi
                              . 1 is a column vector of n ones. Note that 
                                 
                                    R
                                    
                                       *
                                    
                                    2
                                 
                               takes into account the correlation structure for the SUR model.

Choose the desirability function as the optimization measure for multiple responses. Estimate the ridge path by solving Eq. (6). The set 
                                 
                                    x
                                    :
                                    
                                       x
                                       ′
                                    
                                    x
                                    =
                                    
                                       r
                                       2
                                    
                                 
                               can be converted into a set of angles by using a polar-coordinate transformation 
                                 
                                    A
                                    =
                                    
                                       {
                                       a
                                       :
                                       −
                                       π
                                       /
                                       2
                                       <
                                       
                                          a
                                          i
                                       
                                       ≤
                                       π
                                       /
                                       2
                                       
                                          (
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          k
                                          −
                                          2
                                          )
                                       
                                       ,
                                       −
                                       π
                                       <
                                       
                                          a
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       ≤
                                       π
                                       }
                                    
                                    ,
                                 
                               such that we can obtain in polar coordinates 
                                 
                                    x
                                    =
                                    r
                                    t
                                    (
                                    a
                                    )
                                    ,
                                 
                               where a is a 
                                 
                                    (
                                    k
                                    −
                                    1
                                    )
                                    ×
                                    1
                                 
                               vector of A. The form of t(a) given by Peterson (1993) is:

                                 
                                    (14)
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         1
                                                      
                                                      =
                                                      r
                                                      sin
                                                      
                                                         a
                                                         1
                                                      
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         i
                                                      
                                                      =
                                                      r
                                                      
                                                         {
                                                         
                                                            ∏
                                                            
                                                               j
                                                               =
                                                               1
                                                            
                                                            
                                                               i
                                                               −
                                                               1
                                                            
                                                         
                                                         cos
                                                         
                                                            a
                                                            j
                                                         
                                                         }
                                                      
                                                      sin
                                                      
                                                         a
                                                         i
                                                      
                                                      ,
                                                      
                                                      i
                                                      =
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      k
                                                      −
                                                      1
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         k
                                                      
                                                      =
                                                      r
                                                      
                                                         ∏
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      cos
                                                      
                                                         a
                                                         j
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Then, the optimal desirability function with the constraints max 
                                 a ∈ A
                              
                              D(rt(a), θ) can be obtained by grid search once the desirability function is specified. As a result, two ridge path plots, i.e., max 
                                 a ∈ A
                              
                              D(rt(a), θ) vs. r and x vs. r, can be drawn. Due to many appealing theoretical properties, we choose Gibb’s desirability function as the optimization measure Eq. (5).

Through the ridge path, find 
                                 
                                    
                                       x
                                       0
                                    
                                    =
                                    
                                       x
                                       0
                                    
                                    
                                       (
                                       
                                          θ
                                          ^
                                       
                                       ,
                                       r
                                       )
                                    
                                    =
                                    a
                                    r
                                    g
                                    
                                       max
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    D
                                    
                                       (
                                       r
                                       t
                                       
                                          (
                                          a
                                          )
                                       
                                       ,
                                       θ
                                       )
                                    
                                 
                               for each r. A closed form of region C can be estimated by Eq. (11), then the confidence bands min 
                                 θ ∈ C
                              {max 
                                 a ∈ A
                              
                              D(rt(a), θ)} and max 
                                 θ ∈ C
                              {max 
                                 a ∈ A
                              
                              D(rt(a), θ)} can be obtained. Note that both min 
                                 θ ∈ C
                              {max 
                                 a ∈ A
                              
                              D(rt(a), θ)} and max 
                                 θ ∈ C
                              {max 
                                 a ∈ A
                              
                              D(rt(a), θ)} are optimized under nonlinear constraints. The sequential quadratic programming (SQP) approach is proposed because it is known to be the most effective method for the nonlinearly constrained optimization (Nocedal & Wright, 2006). SQP generates steps by solving quadratic subproblems, which are the optimization problems with a quadratic objective function and linear constraints. Boggs and Tolle (1995) describe the most popular manifestations of SQP, discuss their theoretical properties and comment on their practical implementations. The algorithm of SQP for nonlinear programming can refer to Nocedal and Wright (2006, page 546).


                        Derringer and Suich (1980) described the following tire-tread example. The objective of this study is to determine the best combination of three chemical components in a tire such that all four responses are optimized. The three chemical components are: hydrated silica level (x
                        1), silane coupling agent level (x
                        2) and sulfur level (x
                        3), denoted by 
                           
                              x
                              =
                              {
                              
                                 x
                                 1
                              
                              ,
                              
                                 x
                                 2
                              
                              ,
                              
                                 x
                                 3
                              
                              }
                           
                        . The four responses taken into account are: PICO abrasion index (y
                        1), 200 modulus (y
                        2), elongation at break (y
                        3) and hardness (y
                        4), denoted by 
                           
                              y
                              =
                              {
                              
                                 y
                                 1
                              
                              ,
                              
                                 y
                                 2
                              
                              ,
                              
                                 y
                                 3
                              
                              ,
                              
                                 y
                                 4
                              
                              }
                           
                        . The directions of optimization of those four responses are not the same, however. Among them, y
                        1 and y
                        2 are the larger-the-better (LTB), with their target values 170 and 1300, respectively, while y
                        3 and y
                        4 are the nominal-the-best (NTB), and the target values are 500 and 67.5.

A central composite design (CCD) with six center runs was conducted, and the design matrix and the result of this experiment are displayed in Table 1
                        . Following Derringer and Suich (1980), we assume that the true response functions are quadratic in x,

                           
                              
                                 
                                    E
                                    
                                       (
                                       
                                          y
                                          i
                                       
                                       )
                                    
                                    =
                                    
                                       θ
                                       
                                          i
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          l
                                          =
                                          1
                                       
                                       3
                                    
                                    
                                       θ
                                       
                                          i
                                          ,
                                          l
                                       
                                    
                                    
                                       x
                                       l
                                    
                                    +
                                    
                                       ∑
                                       
                                          
                                             
                                                
                                                   
                                                      l
                                                      ,
                                                      m
                                                      =
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      l
                                                      ≠
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                       3
                                    
                                    
                                       θ
                                       
                                          i
                                          ,
                                          l
                                          m
                                       
                                    
                                    
                                       x
                                       l
                                    
                                    
                                       x
                                       m
                                    
                                    +
                                    
                                       ∑
                                       
                                          l
                                          =
                                          1
                                       
                                       3
                                    
                                    
                                       θ
                                       
                                          i
                                          ,
                                          l
                                          l
                                       
                                    
                                    
                                       x
                                       l
                                       2
                                    
                                    .
                                 
                              
                           
                        where 
                           
                              i
                              =
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              4
                           
                        . To estimate the ridge path, we follow the steps mentioned in algorithm section.

Apply SUR to fit the whole model. Each of equations initially evaluated by p-values from SUR model fits, and all significant terms are kept in the model. The resulting model is obtained by Matlab with 
                                 
                                    
                                       R
                                       1
                                       2
                                    
                                    =
                                    96.91
                                    %
                                    ,
                                 
                              
                              
                                 
                                    
                                       R
                                       2
                                       2
                                    
                                    =
                                    67.33
                                    %
                                    ,
                                 
                              
                              
                                 
                                    
                                       R
                                       3
                                       2
                                    
                                    =
                                    97.37
                                    %
                                    ,
                                 
                              
                              
                                 
                                    
                                       R
                                       4
                                       2
                                    
                                    =
                                    95.28
                                    %
                                 
                               and 
                                 
                                    
                                       R
                                       
                                          *
                                       
                                       2
                                    
                                    =
                                    95.48
                                    %
                                 
                              . Note that the goodness of fit for y
                              2 is relatively low.

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                      ^
                                                   
                                                   1
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   137.9
                                                   +
                                                   16.5
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   17.9
                                                   
                                                      x
                                                      2
                                                   
                                                   +
                                                   10.9
                                                   
                                                      x
                                                      3
                                                   
                                                   +
                                                   5.2
                                                   
                                                      x
                                                      1
                                                   
                                                   
                                                      x
                                                      2
                                                   
                                                   +
                                                   7.0
                                                   
                                                      x
                                                      1
                                                   
                                                   
                                                      x
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   +
                                                   
                                                   8.2
                                                   
                                                      x
                                                      2
                                                   
                                                   
                                                      x
                                                      3
                                                   
                                                   −
                                                   3.8
                                                   
                                                      x
                                                      1
                                                      2
                                                   
                                                   −
                                                   3.4
                                                   
                                                      x
                                                      2
                                                      2
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                      ^
                                                   
                                                   2
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   1195.2
                                                   +
                                                   268.2
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   246.5
                                                   
                                                      x
                                                      2
                                                   
                                                   +
                                                   139.5
                                                   
                                                      x
                                                      3
                                                   
                                                   −
                                                   119.7
                                                   
                                                      x
                                                      2
                                                      2
                                                   
                                                   +
                                                   209.3
                                                   
                                                      x
                                                      3
                                                      2
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                      ^
                                                   
                                                   3
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   406.3
                                                   −
                                                   −
                                                   99.7
                                                   
                                                      x
                                                      1
                                                   
                                                   −
                                                   31.4
                                                   
                                                      x
                                                      2
                                                   
                                                   −
                                                   73.9
                                                   
                                                      x
                                                      3
                                                   
                                                   +
                                                   16.8
                                                   
                                                      x
                                                      2
                                                      2
                                                   
                                                   ,
                                                   
                                                   a
                                                   n
                                                   d
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                      ^
                                                   
                                                   4
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   68.7
                                                   −
                                                   −
                                                   1.4
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   4.3
                                                   
                                                      x
                                                      2
                                                   
                                                   +
                                                   1.6
                                                   
                                                      x
                                                      3
                                                   
                                                   −
                                                   1.6
                                                   
                                                      x
                                                      1
                                                   
                                                   
                                                      x
                                                      2
                                                   
                                                   +
                                                   1.6
                                                   
                                                      x
                                                      1
                                                      2
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              The estimated covariance matrix under SUR model can be obtained as

                                 
                                    
                                       
                                          
                                             Σ
                                             ^
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         31.69
                                                      
                                                   
                                                   
                                                      
                                                         49.04
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         4.48
                                                      
                                                   
                                                   
                                                      
                                                         1.70
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         49.04
                                                      
                                                   
                                                   
                                                      
                                                         97814.22
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         930.89
                                                      
                                                   
                                                   
                                                      
                                                         21.17
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         4.48
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         930.89
                                                      
                                                   
                                                   
                                                      
                                                         399.43
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         1.10
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1.70
                                                      
                                                   
                                                   
                                                      
                                                         21.17
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         1.10
                                                      
                                                   
                                                   
                                                      
                                                         1.29
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

Choosing a desirability function of Gibb et al. (2001) with 
                                 
                                    
                                       γ
                                       i
                                    
                                    =
                                    0.025
                                    ,
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    ,
                                    4
                                    ,
                                 
                               we can obtain the maximal desirability value for each r, max 
                                 a ∈ A
                              
                              D(rt(a), θ). The ridge path and the constrained optimal coordinates are shown in Figs. 1
                               and 2
                              , respectively. From Fig. 1, the ridge path shows that the overall desirability value is maximized when r is around 1.0. The corresponding setting is found to be 
                                 
                                    x
                                    =
                                    [
                                    −
                                    0.045
                                    ,
                                    0.318
                                    ,
                                    −
                                    0.947
                                    ]
                                 
                               as shown in Fig. 2.

This step constructs the confidence bounds for the ridge path. The 95% confidence region of 
                                 
                                    
                                       θ
                                       ^
                                    
                                    ,
                                 
                               
                              C, can be obtained through Eq. (11), where 
                                 
                                    
                                       v
                                       h
                                    
                                    =
                                    2
                                 
                               and 
                                 
                                    
                                       v
                                       h
                                    
                                    =
                                    10
                                 
                              . SQP is employed to solve min 
                                 θ ∈ C
                              {max 
                                 a ∈ A
                              
                              D(rt(a), θ)} and max 
                                 θ ∈ C
                              {max 
                                 a ∈ A
                              
                              D(rt(a), θ)}. The resulting ridge path is shown on Fig. 1, with a 95% conservative confidence band.

This is a typical multiple response surface methodology problem to locate the optimal treatment combinations. We use the Gibb et al. (2001) desirability function to measure overall optimal response, then follow the proposed algorithm to draw a desirability-based multi-response ridge path step by step. From the ridge path, we can see that the overall optimum desirability value will be achieved when r is around 1.0.

The SOVRING example by Eriksson, Johansson, Kettaneh-Wold, and Wold (2001) is discussed below to show a typical performance of the proposed method when the sample size is large. The term “SOVRING” was used by Tano (1996)–it is a Swiss word, meaning “screening”. The data originated from a mineral sorting plant. The purpose of the experiment is to test the effect of three input variables, raw material input Tonin (x
                        1), magnetic grinder speed variables HS1 (x
                        2) and HS2 (x
                        3). Two response variables of product output in a mine are PAR (y
                        1) and FAR (y
                        2). Both responses are larger-the-better. This data have been investigated by Ding et al. (2005) and their results will be served as a benchmark for comparison.

The models for both responses fitted by
                        
                         SUR are:

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                ^
                                             
                                             1
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             283.2
                                             +
                                             115.2
                                             
                                                x
                                                1
                                             
                                             +
                                             6.2
                                             
                                                x
                                                2
                                             
                                             +
                                             22.1
                                             
                                                x
                                                3
                                             
                                             +
                                             13.6
                                             
                                                x
                                                1
                                             
                                             
                                                x
                                                2
                                             
                                             +
                                             30.7
                                             
                                                x
                                                1
                                             
                                             
                                                x
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             18.4
                                             
                                                x
                                                2
                                             
                                             
                                                x
                                                3
                                             
                                             +
                                             24.7
                                             
                                                x
                                                1
                                                2
                                             
                                             −
                                             7.4
                                             
                                                x
                                                2
                                                2
                                             
                                             +
                                             10.1
                                             
                                                x
                                                3
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                y
                                                ^
                                             
                                             2
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             689.8
                                             +
                                             244.1
                                             
                                                x
                                                1
                                             
                                             +
                                             29.8
                                             
                                                x
                                                2
                                             
                                             −
                                             46.5
                                             
                                                x
                                                3
                                             
                                             +
                                             1.1
                                             
                                                x
                                                1
                                             
                                             
                                                x
                                                2
                                             
                                             −
                                             61.5
                                             
                                                x
                                                1
                                             
                                             
                                                x
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             55.8
                                             
                                                x
                                                2
                                             
                                             
                                                x
                                                3
                                             
                                             +
                                             6.8
                                             
                                                x
                                                1
                                                2
                                             
                                             −
                                             9.5
                                             
                                                x
                                                2
                                                2
                                             
                                             −
                                             35.4
                                             
                                                x
                                                3
                                                2
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The estimated covariance matrix under SUR model is

                           
                              
                                 
                                    
                                       Σ
                                       ^
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   195.13
                                                
                                             
                                             
                                                
                                                   101.91
                                                
                                             
                                          
                                          
                                             
                                                
                                                   101.91
                                                
                                             
                                             
                                                
                                                   1063.35
                                                
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     


                        Fig. 3 shows the ridge path, the confidence band via Bonferroni (Ding et al., 2005) as well as confidence band via the proposed method. It is shown that the confidence band of both approaches are nearly identical with the Bonferroni type confidence being a little bit wider (especially as r increases). This indicates that the proposed method also performs well when sample size is large.

To asses the performance of the proposed method in general, a thorough simulation study is employed. The general observations from the simulation are: (1) the proposed confidence region provides approximately 95% coverage; (2) the performance of the proposed method is more appropriate than the large-sample method for small sample situations; (3) the estimators which include confidence interval construction of the multiple response ridge path are instructive and meaningful for locating the optimal setting of experiments.

Assuming the fitted model and the related covariance in the tire-tread example as the true model, 1,000 simulated samples are generated in each setting where the error follows a multivariate normal distribution with the same mean and covariance structure. The ridge path and its confidence region can be easily obtained by following the proposed procedure. The simulation result is shown in Fig. 4.

In Fig. 4, the ridge path and its 95% confidence bands are plotted and they are used as the benchmark. Each simulated ridge path was estimated for each simulation sample and shown in the figure. The simultaneous coverage proportion of proposed confidence region is about 93.4%.

We compare our method with the large-sample method under three different scenarios: Scenario 1 includes all of the four responses, i.e. 
                           
                              y
                              =
                              (
                              
                                 y
                                 1
                              
                              ,
                              
                                 y
                                 2
                              
                              ,
                              
                                 y
                                 3
                              
                              ,
                              
                                 y
                                 4
                              
                              )
                           
                        ; Scenario 2 has three responses, i.e. 
                           
                              y
                              =
                              (
                              
                                 y
                                 1
                              
                              ,
                              
                                 y
                                 2
                              
                              ,
                              
                                 y
                                 3
                              
                              )
                           
                        ; while Scenario 3 has two responses of y
                        1 and y
                        3. Note that y
                        1 and y
                        2 are the LTB type responses, and y
                        3 as well as y
                        4 are NTB type responses. The simulation results of these scenarios are shown in Fig. 5. Fig. 5(a)–(c) are for Scenario 1, 2 and 3, respectively.

For each sub-figure in Fig. 5, the ridge path and its 95% confidence interval were obtained with the relative data set in Table 1. Both the Bonferroni type confidence and the proposed type confidence are displayed; 1,000 simulated ridge paths for each scenario are shown in the figure. Note that both of the Large-sample method and the proposed approach are based on the SUR model, while the ridge path is estimated based on both the SUR and the SMR models. It is shown that the Bonferroni z-type confidence are much more conservative than the proposed ones, and the proposed method provides much smoother confidence bands. Specifically, the coverage probability of the Bonferroni z-type intervals are 94.2%, 99.8% and 99.6%, respectively for Scenarios 1, 2 and 3, while the corresponding coverage probabilities of conservative confidence bands are 93.4%, 96.8% and 94.9%. Though the coverage probability of both approaches are almost same in Scenario 1, it is clearly shown in Fig. 5(a) that the confidence region from the large-sample approach is wider than that of the proposed method especially when radius ranges from 0.1 to 0.8. It also can be observed that the two types of estimated ridge paths are different in all scenarios. This indicates that including the non-significant terms in the model will result in a different prediction. For example, the maximal desirability value exists on the ridge path based on SUR model at 
                           
                              r
                              =
                              1.4
                           
                         in Scenario 2 (Fig. 5b), while it appears around at 
                           
                              r
                              =
                              1.6
                           
                         on the ridge path based on SMR model. Although the estimated ridge paths are different in each scenario, they are not very different from each other. That is, using the typical multivariate regression model versus SUR does not seem to give drastically differing results.

Through the estimate of the ridge path and its confidence interval, it is desirable that experimenters can locate the optimal combination of treatments within the experimental space or decide to run more experiments along certain directions. In Fig. 5(a), the optimal treatment combination takes place at 
                           
                              r
                              =
                              1.0
                           
                         in Scenario 1. Fig. 5(b) shows that the maximal desirability value is obtained at about 
                           
                              r
                              =
                              1.4
                           
                         in Scenario 2. For a ridge path in Fig. 5(c), it is monotone increasing along the radius and the confidence region gets wider, it can be expected that the optimal treatment combination may exist at a certain farther radius, which is beyond the current experimental space. To seek the potential optimal location, experimenters may conduct some experiments along the ridge path direction. Furthermore, it is shown that the optimal location is different in each scenario. This brings up another important issue that the experimenter must be cautious in choosing the number of responses, because different numbers of responses can produce very different ridge paths. The effects of this variation depend on the process of interest. This is mainly in the knowledge domain and should be explored by the practitioners.

@&#CONCLUSIONS@&#

A new approach for construction of a confidence region for multiple responses with small sample size is proposed. The proposed approach employs the SUR (seemingly unrelated regressions) model to estimate parameters and covariance, as opposed to the SMR (standard multivariate regression) model used in the large-sample case. The SMR model usually over-fits for some responses. The coverage rate is too conservative for small samples. The Gibb’s desirability function (to represent the overall desirability for all responses) uses a quadratic region for 
                        
                           θ
                           ^
                        
                      by the Lawley–Hotelling test, and conducts a three-step algorithm for constructing the desirability function-based ridge path confidence region. Gibb’s desirability function is merely one of these many to be applied. In fact, any continuous and differentiable desirability function can be applied to the proposed algorithm directly. Through real-life examples in the literature (both small and large sample cases) as well as decent simulations, the proposed approach performs significantly better than the existing method which is limited to large samples.

A confidence region for the ridge path had been studied in the literature, but mainly for univariate response problems. Little had been known about confidence regions for the ridge path for multiple response cases. The proposed method given here allows us to construct a (relatively tight) confidence region for the ridge path for multiple responses under small sample sizes. This will help experimenters to locate the optimal setting in an efficient manner.

@&#ACKNOWLEDGMENTS@&#

This research was supported by National Natural Science Foundation of China (Project No. 71102140), National Science Foundation for Distinguished Young Scholars of China (Project No. 71225006) and National Security Agent via Grant H98230-15-1-0253. We are grateful to the editor and referees, whose sharply focused comments were extremely helpful.

@&#REFERENCES@&#

