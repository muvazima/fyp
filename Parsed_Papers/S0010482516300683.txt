@&#MAIN-TITLE@&#Rhythm-based heartbeat duration normalization for atrial fibrillation detection

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We investigate rhythm-based heartbeat normalization for improved atrial fibrillation detection.


                        
                        
                           
                           Heartbeat durations are normalized based on estimated rhythm of heartbeats in a window.


                        
                        
                           
                           It allows to measure irregularity of heartbeats for both AF and non-AF rhythms in the same scale.


                        
                        
                           
                           The normalization is found helpful for improving performance and robustness of AF detection.


                        
                        
                           
                           The normalization could be crucial for developing a clinically acceptable screening device.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Atrial fibrillation

Electrocardiographic monitoring

Screening

Heartbeat rhythm

Heartbeat normalization

Entropy

@&#ABSTRACT@&#


               
               
                  Background
                  Screening of atrial fibrillation (AF) for high-risk patients including all patients aged 65 years and older is important for prevention of risk of stroke. Different technologies such as modified blood pressure monitor, single lead ECG-based finger-probe, and smart phone using plethysmogram signal have been emerging for this purpose. All these technologies use irregularity of heartbeat duration as a feature for AF detection. We have investigated a normalization method of heartbeat duration for improved AF detection.
               
               
                  Method
                  AF is an arrhythmia in which heartbeat duration generally becomes irregularly irregular. From a window of heartbeat duration, we estimate the possible rhythm of the majority of heartbeats and normalize duration of all heartbeats in the window based on the rhythm so that we can measure the irregularity of heartbeats for both AF and non-AF rhythms in the same scale. Irregularity is measured by the entropy of distribution of the normalized duration. Then we classify a window of heartbeats as AF or non-AF by thresholding the measured irregularity. The effect of this normalization is evaluated by comparing AF detection performances using duration with the normalization, without normalization, and with other existing normalizations.
               
               
                  Results
                  Sensitivity and specificity of AF detection using normalized heartbeat duration were tested on two landmark databases available online and compared with results of other methods (with/without normalization) by receiver operating characteristic (ROC) curves. ROC analysis showed that the normalization was able to improve the performance of AF detection and it was consistent for a wide range of sensitivity and specificity for use of different thresholds. Detection accuracy was also computed for equal rates of sensitivity and specificity for different methods. Using normalized heartbeat duration, we obtained 96.38% accuracy which is more than 4% improvement compared to AF detection without normalization.
               
               
                  Conclusions
                  The proposed normalization method was found useful for improving performance and robustness of AF detection. Incorporation of this method in a screening device could be crucial to reduce the risk of AF-related stroke. In general, the incorporation of the rhythm-based normalization in an AF detection method seems important for developing a robust AF screening device.
               
            

@&#INTRODUCTION@&#

Atrial fibrillation (AF) is the most common cardiac arrhythmia which is associated with high risk of stroke, dementia, and death. AF is affecting approximately 1% of people around the world [1,2]. The prevalence of AF increases with the increase of the age of patients. More than 5% of patients aged 65 years or older are found to have AF [3,4]. It is now recommended by practice guidelines for screening of AF in the primary care of high-risk patients including all patients aged 65 years and more [5,6]. AF is often paroxysmal and there is a good chance that AF is undetected during such an in-office screening [7]. Furthermore, a large number of potential patients may be undiagnosed as it can be asymptomatic [8]. Hence, a more effective AF screening strategy requires a readily available and cost-effective device that can be operated frequently by a patient himself, combined with an accurate, real-time, and automatic AF detection algorithm [9]. Although the ‘gold-standard’ for AF diagnosis is the detection of it on an electrocardiogram (ECG) by a trained clinician, but automatic screening is useful for primary detection of it [7,10]. Censi et al. [11] also found that daily short-term ECG monitoring with temporally-optimized ECG recording by a screen device [12] is more effective than day-long Holter monitoring to detect AF episodes. Hence, three different technologies have been emerging for the screen purpose: i) modified blood pressure (BP) monitor, ii) single lead ECG-based device, and iii) plethysmogram signal obtained by a smart phone.

Modifying a BP monitor to detect AF and using it in primary care setting could be a good opportunity for early detection of this arrhythmia. Wiesel et al. [13] and Stergiou et al. [2] proposed methods to modify a BP monitor using several heartbeats. In these methods, at first premature beats are removed by discarding heartbeats which have heartbeat duration (HBD) significantly different than average duration of measured heartbeats. Then the average and standard deviation of HBD of remaining heartbeats are calculated. A measure of heartbeat irregularity is obtained by dividing the standard deviation by the average. If the irregularity is more than a predetermined threshold then the device raises an alarm for possible AF. A recent study [6] showed that such an automatic BP monitor can achieve a reasonable accuracy (100% sensitivity and 92% specificity) for AF detection.

HBD information could also be obtained from a one lead ECG recording device and several such devices are already commercially available. Such a device could capture ECG signal form fingers or wrist [7,10,14] and a HBD could be computed from consecutive R peaks using an efficient R-peak detection method [15]. In fact, HBD obtained from ECG signal has been used during the last three decades by several methods for the automatic detection and classification of AF [14,16–22]. Most of these methods use a window of HBDs to compute the irregularities of HBD for AF detection and classification.

Another emerging technology for AF detection is to use plethysmogram signals obtained by a smartphone's camera to image a fingertip. The advantage of this approach is that it does not require additional hardware as the optical video monitoring of the skin with a standard digital camera provides accurate HBD time series. Jinseok et al. [9] have recently demonstrated that plethysmogram signals can be used for AF screening. A clinical validation with such an instrument showed good performance such as 100% sensitivity and 91.9% specificity [23]. Repeated measurements at home by such a device with capability of automatic transmission of data to a central database will be useful for the remote patient monitoring.

Enhancement of detection accuracy and robustness is very important for such devices to be clinically more acceptable. From the discussion in previous three paragraphs, it is obvious that irregularity of heartbeat duration has become the essential feature for AF detection in all three technologies. The objective of this paper is to normalize HBD in order to obtain a better measurement of irregularly and use it for improved and robust AF detection. To the best of our knowledge, only a few works on heartbeat duration normalization could be found in the literature. Rincon et al. [16] suggested a window-based normalization of HBD, where each of the HBDs was normalized based on average of a window centered at current heartbeat and average of heartbeats centered on the previous heartbeat. In fact, our experiments (Section 3) showed that this normalization had little effect on AF detection performance. In recent times, different other features such as a window of samples around QRS-complex [24,25], absence of P-wave [3,26], auto regressive coefficients [27], were used for AF detection. Several other methods transform ECG signal into frequency domain for feature extraction [24,28]. Although these methods reported good AF detection performance but such features cannot be obtained using BP monitor or plethysmogram signal. This has motivated us to investigate a method which is equally applicable for all technologies.

In this paper, we have proposed a novel heartbeat duration normalization method based on the estimation of rhythm of sequence of heartbeats. The method is applicable to all three technologies. It is well-known that AF is an arrhythmia with increased and irregular heartbeat rate [20,29,30]. In our method, each HBD in a window is normalized by an affine transformation using parameters estimated from the rhythms of heartbeats. The process of normalization is named as affine normalization and the normalized HBD is termed as HBA (HeartBeat with Affine-normalization) which is used for improved AF detection. This normalization allows us to measure the irregularity of heartbeats for both AF and non-AF rhythms in the same scale. The proposed normalization method was tested by two landmark databases available online. Experimental results showed that the normalization method was helpful to boost the AF detection accuracy. For example, using HBA we obtained 96.38% accuracy which was 92.13% without normalization of HBD. Hence, the proposed normalization method could be useful for improving AF detection accuracy in the initial screening stage and could help to reduce the risk of stroke.

The rest of the paper is organized as follows. In Section 2, we have presented the method of heartbeat normalization and classification. In Section 3, we have discussed about the databases used and presented the experimental results. Discussion about the results and conclusion is given is Section 4.

@&#METHODS@&#

During AF rhythm, the electrical impulses in the atria are originated from different parts rather than the usual sinoatrial (SA) node and spread throughout the atria in a rapid, disorganized way. Only some of these impulses get through the atrioventricular (AV) node and produce a ventricular rate which is highly irregular and often rapid. So if we measure heartbeat duration by consecutive ventricular waves (e.g. R-peaks for ECG signal), we obtain irregularly-irregular HBD. Moreover, during AF rhythm the heartbeat rate is generally higher than the normal rate of 60–100 beats a minute [29].

During normal sinus rhythm (NSR), HBD may also vary due to sympathetic, parasympathetic, and respiratory activities [29]. 
                     Table 1 shows the standard deviations of HBD for AF and non-AF rhythms for ten-hour ECG records of 10 patients obtain from MIT-BIH AF database [22,31]. Here, we used duration between two consecutive R-peaks (marked in the database) as a HBD. Although it is expected that standard deviation of HBD during AF rhythm is higher but it could be observed from the table that sometime the standard deviation for non-AF rhythms is also higher than that of AF rhythms. This is particularly true when the average HBD of AF rhythm is significantly lower than that of non-AF rhythm as for record ID 03665, and 04126 shown in Table 1. This is due to that fact that standard deviations for two rhythms are measured in two different scales. In other words, if the average of HBDs in one window (without AF) is significantly larger than that of a second window (with AF), then without any normalization the standard deviation of HBDs due to the randomness of HBD for the first window could be also higher than that of the second window for the irregularity due to AF. On the average, HBDs during AF rhythm is generally shorter than those of NSR rhythm as shown in 
                     Fig. 1. Existing methods [9,16,18,21] measure irregularity in different scale of HBD. Hence, it can be envisaged that when the heartbeat rate of AF rhythm is much higher than that of NSR or other rhythms then irregularity of HBDs due to AF may not be distinguishable from randomness of HBD during non-AF rhythms. Hence, normalization of HBD based on the rhythm is important so that the irregularity of heartbeats for both AF and non-AF rhythms could be measured in the same scale.

HBD could be measured in different ways by different technologies. Due to the availability of databases of ECG signals, we use interval between two consecutive R-peaks as the HBD and explained the method with ECG signal without loss of generality. Suppose x is a heartbeat (identified by the R-peak) as shown in 
                     Fig. 2. For AF detection, generally a window of HBDs is considered and decision is based on the measure of irregularity of HBDs in the window [9,16,18,21]. Fig. 2 shows a windows W={t
                     
                        i
                      | i=1…n} of n HBDs centered at x. We estimate the rhythm of heartbeats in the window and normalize each t
                     
                        i
                      based on the estimated rhythm.


                     
                     Fig. 3 shows the block diagram for heartbeat normalization and classification method. We first estimate the heartbeat rhythm of the given window as discussed in Section 2.1. Then the normalization is defined as an affine transformation of each HBD of the window as discussed in Section 2.2. The irregularity of HBAs (i.e. normalized HBDs) is measured by entropy of the distribution of HBDs as is discussed in Section 2.3. The classification of a heartbeat into AF or non-AF is simply a thresholding of the entropy. In Section 2.4, we discuss about implementation and integration of this method in existing technologies.

For the normalization process, we need to estimate the rhythm of the window of heartbeats. We may divide all possible rhythms into two categories: i) AF rhythm, and ii) non-AF rhythm. A window may contain HBDs from AF rhythm only, from non-AF rhythm only, or from both types of rhythms. The estimated rhythm R represents the characteristic of the majority of HBDs. If W
                        
                           r
                         is a subset of HBDs in a window W representing the rhythm R then R=ρ(W
                        
                           r
                        ) where ρ(W
                        
                           r
                        )∈{AF, nonAF}. For the estimation of rhythm, we utilize the fact that during AF the average of HBDs is generally different (smaller) than that of a non-AF rhythm. As HBD is random for each type of rhythms, we assume that HBDs belonging to each rhythm follows a different Gaussian distribution with different mean and standard-deviation.

In order to detect the rhythm, at first, we compute the average (x
                        
                           a
                        ) and median (x
                        
                           m
                        ) of the HBDs in the window (W) as follows
                           
                              (1)
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    
                                       1
                                       n
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    m
                                    e
                                    d
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    ..
                                    .
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    }
                                 
                              
                           
                        where the function med returns the median of HBDs.

According to the properties of a symmetric Gaussian distribution, if all HBDs are from same distribution then x
                        
                           a
                         and x
                        
                           m
                         are equal when the window size n is large enough. In practice, we should keep the window size small for better efficiency of the AF detection method. Hence, there may be a small difference (even for same distribution) between the average and median when computed from such a small window of noisy data. As shown in 
                        Fig. 4(a), we consider all HBDs in the window belong to the same rhythm (AF or non-AF) if the difference is less than a small constant ε, i.e.
                           
                              (3)
                              
                                 
                                    R
                                    =
                                    ρ
                                    (
                                    W
                                    )
                                    
                                    i
                                    f
                                    
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          m
                                       
                                    
                                    |
                                    <
                                    ε
                                 
                              
                           
                        
                     

Otherwise, they may come from two different rhythms as shown in Fig. 4(b). Hence, we divide all HBDs into two subsets W
                        1 and W
                        2 such that each element of first subset has HBDs smaller than x
                        
                           m
                         and each element of second subset has HBDs greater than or equal to x
                        
                           m
                        , i.e.
                           
                              (4)
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      <
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ≥
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Now, we compute the average of HBDs for both subsets. Suppose x
                        1 and x
                        2 are averages of HBDs of subsets W
                        1 and W
                        2 respectively as shown in Fig. 4(b). Then we select the one which has the average closer to the median x
                        
                           m
                        . This subset represents the rhythm of the majority of heartbeats, i.e.
                           
                              (5)
                              
                                 
                                    R
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      ρ
                                                      (
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ,
                                                      
                                                      
                                                      i
                                                      f
                                                      
                                                      |
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      |
                                                      <
                                                      |
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      −
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ρ
                                                      (
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                      ,
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      o
                                                      t
                                                      h
                                                      e
                                                      r
                                                      w
                                                      i
                                                      s
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Due to the difference of heart rate of AF and non-AF rhythms, they may have different average of HBDs. Objective of the normalization is to transform each t
                        
                           i
                         in a window such that we could measure the irregularity of HBDs in the same scale. The normalization process is defined as an affine transformation. The average of HBDs of the estimated rhythm R is considered as the scale factor s. Suppose the subset of HBDs representing the rhythm (R) W
                        
                           r
                        ⊆W has m HBDs i.e. W
                        
                           r
                        ={t
                        
                           j
                         | j=1…m; m≤n}. Then the scale factor is computed as follows
                           
                              (6)
                              
                                 
                                    s
                                    =
                                    
                                       1
                                       m
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       m
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Now, the affine normalization of t
                        
                           i
                         is defined as follows
                           
                              (7)
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    )
                                    ;
                                    i
                                    =
                                    1..
                                    .
                                    n
                                 
                              
                           
                        where x
                        
                           a
                         is obtained from Eq. (1) 
                        x
                        
                           r
                         is a constant which is equal to the duration of an average heartbeat in NSR and generally it is assumed as 0.8s [32]. We normalize all HBDs in the window using this affine transformation to obtain HBAs.

Due to the irregularly irregular nature, HBAs during AF rhythm should be sparsely distributed over the space than those of a non-AF rhythm. In order to measure the sparseness, we compute the probability distribution of HBAs by distributing them into a set of discrete probability spaces or bins [18,20]. The probability of k-th nonempty bin is defined as
                           
                              (8)
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                k
                                             
                                          
                                       
                                       n
                                    
                                    ;
                                    
                                    k
                                    =
                                    1..
                                    .
                                    r
                                 
                              
                           
                        where r is the number of nonempty bins and n
                        
                           k
                         is the number of HBAs in the k-th non-empty bin.

Now the sparseness is measured by normalized entropy (e) of the distribution of HBAs in the window [18,20] as follows
                           
                              (9)
                              
                                 
                                    e
                                    =
                                    −
                                    
                                       r
                                       n
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       r
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                       
                                       .
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

If the entropy e is greater than a threshold τ, then the window of heartbeats is classified as AF, otherwise it is classified as non-AF.

Implementation and integration of this method in existing and potential screening devices capable to detect HBD is very feasible. The rhythm estimation process, discussed in Section 2.1, requires the computation of average and median of a window of n HBDs. These require O(n) and O(n
                        2) computational time respectively. Since n is small and constant, any standard algorithm could be used to detect the average and the median in real time. Again for the normalization method as discussed in Section 2.2, we need to compute the scale factor which is again the average of the m≤n HBDs requiring O(m) time. For both of these steps, we need n HBDs to be stored and they are possible to be represented by n integers. Hence, for the computation of the normalization process the memory requirement is also limited by O(n). In fact, the proposed normalization method does not impose heavy computational burden and memory requirement to the device and hence it should be applicable to all existing technologies.

@&#EXPERIMENTS AND RESULTS@&#

We used two PhysioNet databases [31] such as MIT-BIH AF database and MIT-BIH Arrhythmia database to test the effectiveness of the proposed normalization method. All heartbeat are annotated in both database. We obtained the HBD by computing duration between two consecutive R-peaks from this annotation. The first database contains 25 ECG records of 10h each and an ECG signal was sampled at 250 samples per second. These records contain mainly two types of rhythms such as NSR and AF but there are some other rhythms as well. Among 1,223,145 heartbeats in total, 521,417 are annotated as AF and remaining heartbeats are annotated as non-AF. The second database contains 48 records of half-hour each with a sampling rate 360 samples per second. There are many varieties of rhythms, and 11,670 heartbeats are annotated as AF out of 112,598 heartbeats in total.

The AF detection method classifies a window of heartbeats of an ECG record into AF and non-AF and this result is verified with ground truth. This process is iterated using a sliding window by taking each heartbeat of a given ECG record as the center. The ground truth for a window can be obtained in three different ways: i) annotation of the heartbeat at the center [9,16,18], ii) annotation of the majority heartbeats in the window [21], and iii) if the percentage of annotated AF beats in the window is more than a constant [28]. The first approach was adopted by most of the reported works and we followed it. For a window of HBDs, we computed the probability distribution by using Eq. (8), entropy by using Eq. (9) and then applied the thresholding. In Eq. (3), we used the value of the constant ε=32ms for the estimation of rhythm. We divided the entire space of heartbeat duration into several bins with 40ms width. We empirically selected values of these two constants (ε and bin width) and noticed that they are not very sensitive for small changes. After thresholding, we obtained true positive (TP), false positive (FP), true negative (TN), and false negative (FN) detections. Then we computed the Sensitivity (Se=TP/(TP+FN)), Specificity (Sp=TN/(TN+FP)), positive predictive value (PPV=TP/(TP+FP)), and accuracy (ACC=(TP+TN)/TP+TN+FP+FN)) for AF detection for each database separately. A sequence of discrete values for τ (for range 1.0–3.5 with the step size 0.1) was used as thresholds and we computed the Se, Sp, PPV, and ACC for each value. ROC curves were obtained by plotting 1-Sp vs Se for the range of values for the threshold.

The main idea behind the proposed normalization method was to estimate rhythm of heartbeats in a window and then normalize the HBDs so that the irregularity of heartbeats could be measured in the same scale. The rhythm estimation process (Section 2.1) categorizes a window into one of two groups such as uniform (containing either AF or non-AF heartbeats) or mixed (containing both AF and non-AF heartbeats) rhythm. In the former case, when all heartbeats come from the same rhythm, the scale parameter, as computed in Eq. (6), is the average of HBDs in the window. In this case, the effect of normalization could be tested by comparing TP, TN, FP, and FN detections by using HBDs with normalization and without normalization. For this purpose, we have selected three records from MIT-BIH AF database (such as record 03665, 04126, and 04767) where the average HBD is significantly different in AF and non-AF rhythms as shown in Table 1. Then we computed TP, TN, FP, and FN detections for each record using HBDs with normalization and without normalization as shown in 
                     Fig. 5. It could be observed that TP and TN detections with normalization are much higher than those of without normalization for each record. On the Other hand, FP and FN detections are significantly lower with normalization.

In the latter case, when heartbeats in a window come from both AF and non-AF rhythm, the majority rhythm is determined by Eq. (5) and the scale parameter is the average of HBDs of majority rhythm as computed by Eq. (6). In this case, we tested the effect of normalization by using scale parameter computed from the average of all HBDs in the window and from HBDs of the majority rhythm. 
                     Fig. 6 shows results (for windows with mixed rhythms) for normalization with scale parameter computed from HBDs of the majority rhythm (denoted by scale4rhythm) and the whole window (denoted by scale4window) for three previous records. As before, it could be observed that superiority of rhythm based normalization for TP, TN, FP and FN detection. We also computed Se, Sp, PPV and ACC for each of these records for HBAs (with affine normalization) and HBDs (without normalization) as shown in 
                     Table 2. Significant improvement of detection performances could be observed for the normalization process.

We also compared AF detection performances for HBA and HBD without normalization and with other existing normalizations for all records in both databases. In fact, HBD without normalization was directly used in different works [9,33] and good detection performances were reported. We also compared the performance for the use of differences of two consecutive HBDs (dHB) [20,21] which is also popular for AF detection. As mentioned before, a window-based normalization of HBD (termed as HBN) was suggested by Rincon et al. [16], where each of the HBDs was normalized based on the average HBD'(i) of a window centered at current heartbeat and the average HBD'(i−1) of the window centered on the previous heartbeat as follows
                        
                           (10)
                           
                              
                                 H
                                 B
                                 N
                                 =
                                 H
                                 B
                                 D
                                 /
                                 (
                                 0.75
                                 H
                                 B
                                 
                                    D
                                    ′
                                 
                                 (
                                 i
                                 −
                                 1
                                 )
                                 +
                                 0.25
                                 H
                                 B
                                 
                                    D
                                    ′
                                 
                                 (
                                 i
                                 )
                                 )
                              
                           
                        
                     
                  


                     
                     
                     Figs. 7 and 8 compare the receiver operating characteristic (ROC) curves for all four types of durations (such as HBD, dHB, HBN, and HBA) for two databases. In order to compare the performances of different types of durations, we also computed Se, Sp, PPV, and ACC for the value of threshold for which Se is approximately equal to Sp. In fact, due to use of discrete thresholds, we may not obtain equal Se and Sp and hence we took the values for the threshold for which the difference between Se and Sp was minimum. 
                     
                     Tables 3 and 4 compare the performances for four types of durations for MIT-BIH AF and MIT-BIH Arrhythmia databases respectively. We also used different sizes of the window to show the effect of the window-size on the normalization method. In fact, we repeated this experiment for three times for each database for three different window sizes (n) such as 30, 50, 70 and all results are reported in Tables 3 and 4.

@&#DISCUSSION AND CONCLUSION@&#

In this work, we have investigated the effect of rhythm based normalization of heartbeat duration. The main idea behind this normalization is the transformation of heartbeat duration for both of AF and non-AF rhythms in the same scale based on the estimation of underling rhythm for a window of heartbeat duration. The normalization is important because in different rhythm, the heartbeat duration could have different distribution and without normalization the irregularity could not be correctly measured. As shown in Figs. 5 and 6 the normalization method was able to increase TP and TN and decrease FP and FN significantly for three selected records. The overall results for all records could be observed from ROC curves in Figs. 7 and 8. The proposed affine normalization method increased the AF detection performance consistently over a wide range of Se and Sp for both databases. This indicates that affine normalization helps to obtain better measurement of irregularity yielding better AF detection accuracy. This was not true for the existing normalization method (HBN). For dHB the performance was almost same for MIT-BIH AF database and there was a small increase for MIT-BIH Arrhythmia database.

We also compared Se, Sp, PPV, and ACC for four types of duration. We may obtain different Se and Sp for different thresholds. ROC curves in Figs. 7 and 8 show the ranges of Se for different Sp for the use of different thresholds. Tables 3 and 4 show these values for the threshold for which the difference of Se and Sp was minimum in order to make performances for different types of duration comparable. In fact, the ACC measured for such a threshold is optimum because we cannot increase of Se and Sp at the same time. It can be observed that the proposed normalization method improved ACC (detection accuracy) more than 4% for MIT-BIH AF database and almost 2% for MIT-BIH Arrhythmia database with respect to HBD without normalization. The corresponding improvements with respect to dRR are around 3% and 1%. Although improvement for the second database was not large but from the ROC curve in Fig. 8, we can observe that it was consistent over wide range of Se and Sp for use of different threshold. Hence, we consider this improvement of performance important because this database contains many different kinds of rhythms and the ratio of AF rhythm to non-AF rhythm is small.

We also tested the effect of three different window sizes on the AF detection method. It can be observed from Tables 3 and 4 that the affine normalization was useful to improve AF detection performances consistently irrespective of window size. With a reasonable small size [21], we obtained credible performance of AF detection (e.g. for a window size of 70 HBAs, Se=96.39%, Sp=96.38%, PPV=95.19%, and ACC=96.38%). For the proposed affine normalization, we need to compute the average and median of HBDs of a window. As the window size is a small constant (e.g. 70 HBDs) this does not increase the computing cost with respect to the method using HBD without normalization.

The main objective of this work was to improve the recognition performance of existing methods which utilize the irregularity of HBD as the feature for AF detection. This improvement is crucial as this is the common feature which is measurable by different technologies. However, it is possible to find many works in the literature which use ECG features but most of these methods are not applicable to other technologies. In the following 
                     Table 5, we have compared the performance and applicability of our method with some notable works for AF detection in recent times. MIT-BIH AF database was used for evaluation of all these works. From the table, it can be observed the proposed method needed a minimum preprocessing and training but yielded equivalent AF detection performance comparable to the existing works. Since, we did not use any preprocessing other that R-peak detection, this also indicates that the proposed method is robust to different kinds of noise. It could also be observed from the table that only a few other works are applicable to all different technologies but they require additional preprocessing. Although Martis et al. [24] reported relatively higher performance, but their method was tested with one only a small subset of selected heartbeats from the database for two classes such as normal and AF. In fact, experiment in this work does not reflect the real condition and not suitable for other technology such as blood Pressure Monitor and plethysmogram signal based system.

Experimental results and comparison with the state-of-the-art method indicate that rhythm-based normalization is useful for improving performance and robustness of AF detection. Further research is required to utilize this property for improved performance of AF detection methods. In fact, other existing methods [18,30] used different kinds of preprocessing techniques to increase performances. Hence incorporation of the proposed affine normalization in these AF detection methods could be recommended for implementation in existing screening devices such as BP monitor, ECG-based finger probe, and plethysmogram signal based device. Such a device with better performance and robustness would be more acceptable for screening and home surveillance of patients with high risk of stroke [6,14]. The use of such a device is likely to grow significantly not only among risk patients but also for continuous health monitoring in the entire population [14]. Hence, the propose normalization method could play an important role for improving AF detection accuracy in electrocardiographic monitoring and early detection of AF. In fact, the enhancement of performance by this normalization can be crucial to develop a real-time and robust AF detection process which is our possible future work.

None declared

@&#ACKNOWLEDGMENT@&#

This work has been supported by the Research Center, College of Computer and Information Sciences, King Saud University, Riyadh, Saudi Arabia. The authors are grateful for this support.

@&#REFERENCES@&#

